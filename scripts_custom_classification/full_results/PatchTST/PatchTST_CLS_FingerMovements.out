Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.914802074432373
Epoch: 1, Steps: 20 | Train Loss: 1.013 Vali Loss: 1.602 Vali Acc: 0.500 Test Loss: 1.602 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 4.344006776809692
Epoch: 2, Steps: 20 | Train Loss: 1.885 Vali Loss: 2.101 Vali Acc: 0.560 Test Loss: 2.101 Test Acc: 0.560
Validation loss decreased (-0.499984 --> -0.559979).  Saving model ...
Epoch: 3 cost time: 5.035681486129761
Epoch: 3, Steps: 20 | Train Loss: 1.053 Vali Loss: 2.846 Vali Acc: 0.500 Test Loss: 2.846 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.176781415939331
Epoch: 4, Steps: 20 | Train Loss: 2.388 Vali Loss: 3.317 Vali Acc: 0.550 Test Loss: 3.317 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7134451866149902
Epoch: 5, Steps: 20 | Train Loss: 1.066 Vali Loss: 3.787 Vali Acc: 0.520 Test Loss: 3.787 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8331387042999268
Epoch: 6, Steps: 20 | Train Loss: 1.405 Vali Loss: 3.552 Vali Acc: 0.530 Test Loss: 3.552 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.898045778274536
Epoch: 7, Steps: 20 | Train Loss: 1.040 Vali Loss: 3.316 Vali Acc: 0.550 Test Loss: 3.316 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.187886714935303
Epoch: 8, Steps: 20 | Train Loss: 1.481 Vali Loss: 3.797 Vali Acc: 0.480 Test Loss: 3.797 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.476263761520386
Epoch: 9, Steps: 20 | Train Loss: 1.280 Vali Loss: 4.720 Vali Acc: 0.520 Test Loss: 4.720 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.513859987258911
Epoch: 10, Steps: 20 | Train Loss: 1.146 Vali Loss: 3.296 Vali Acc: 0.540 Test Loss: 3.296 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.106977224349976
Epoch: 11, Steps: 20 | Train Loss: 0.816 Vali Loss: 4.004 Vali Acc: 0.460 Test Loss: 4.004 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.209661483764648
Epoch: 12, Steps: 20 | Train Loss: 0.600 Vali Loss: 4.632 Vali Acc: 0.510 Test Loss: 4.632 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 756354
model size : 5.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.049256324768066
Epoch: 1, Steps: 20 | Train Loss: 0.846 Vali Loss: 1.431 Vali Acc: 0.530 Test Loss: 1.431 Test Acc: 0.530
Validation loss decreased (inf --> -0.529986).  Saving model ...
Epoch: 2 cost time: 3.5550711154937744
Epoch: 2, Steps: 20 | Train Loss: 1.024 Vali Loss: 1.491 Vali Acc: 0.580 Test Loss: 1.491 Test Acc: 0.580
Validation loss decreased (-0.529986 --> -0.579985).  Saving model ...
Epoch: 3 cost time: 3.9065544605255127
Epoch: 3, Steps: 20 | Train Loss: 0.959 Vali Loss: 1.116 Vali Acc: 0.470 Test Loss: 1.116 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.940833568572998
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 1.583 Vali Acc: 0.520 Test Loss: 1.583 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8126003742218018
Epoch: 5, Steps: 20 | Train Loss: 1.233 Vali Loss: 2.728 Vali Acc: 0.510 Test Loss: 2.728 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.918613910675049
Epoch: 6, Steps: 20 | Train Loss: 0.706 Vali Loss: 2.061 Vali Acc: 0.430 Test Loss: 2.061 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.6379170417785645
Epoch: 7, Steps: 20 | Train Loss: 0.767 Vali Loss: 1.570 Vali Acc: 0.520 Test Loss: 1.570 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.0310540199279785
Epoch: 8, Steps: 20 | Train Loss: 0.542 Vali Loss: 2.005 Vali Acc: 0.490 Test Loss: 2.005 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.886502265930176
Epoch: 9, Steps: 20 | Train Loss: 0.423 Vali Loss: 2.387 Vali Acc: 0.550 Test Loss: 2.387 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.0627799034118652
Epoch: 10, Steps: 20 | Train Loss: 0.519 Vali Loss: 2.263 Vali Acc: 0.560 Test Loss: 2.263 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.982212543487549
Epoch: 11, Steps: 20 | Train Loss: 0.480 Vali Loss: 2.581 Vali Acc: 0.460 Test Loss: 2.581 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.24423885345459
Epoch: 12, Steps: 20 | Train Loss: 0.325 Vali Loss: 2.877 Vali Acc: 0.500 Test Loss: 2.877 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 577282
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.110072135925293
Epoch: 1, Steps: 20 | Train Loss: 0.806 Vali Loss: 0.916 Vali Acc: 0.540 Test Loss: 0.916 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 2.793801784515381
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.980 Vali Acc: 0.470 Test Loss: 0.980 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3399603366851807
Epoch: 3, Steps: 20 | Train Loss: 0.802 Vali Loss: 1.131 Vali Acc: 0.520 Test Loss: 1.131 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1185061931610107
Epoch: 4, Steps: 20 | Train Loss: 0.765 Vali Loss: 1.297 Vali Acc: 0.550 Test Loss: 1.297 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 2.695866584777832
Epoch: 5, Steps: 20 | Train Loss: 0.917 Vali Loss: 2.106 Vali Acc: 0.520 Test Loss: 2.106 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2865843772888184
Epoch: 6, Steps: 20 | Train Loss: 0.795 Vali Loss: 1.527 Vali Acc: 0.510 Test Loss: 1.527 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3273069858551025
Epoch: 7, Steps: 20 | Train Loss: 0.739 Vali Loss: 1.897 Vali Acc: 0.440 Test Loss: 1.897 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4694042205810547
Epoch: 8, Steps: 20 | Train Loss: 0.759 Vali Loss: 1.914 Vali Acc: 0.440 Test Loss: 1.914 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.133699417114258
Epoch: 9, Steps: 20 | Train Loss: 0.676 Vali Loss: 1.791 Vali Acc: 0.530 Test Loss: 1.791 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.511099338531494
Epoch: 10, Steps: 20 | Train Loss: 0.642 Vali Loss: 3.162 Vali Acc: 0.510 Test Loss: 3.162 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.811671018600464
Epoch: 11, Steps: 20 | Train Loss: 0.753 Vali Loss: 2.595 Vali Acc: 0.460 Test Loss: 2.595 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.350191831588745
Epoch: 12, Steps: 20 | Train Loss: 0.537 Vali Loss: 3.415 Vali Acc: 0.490 Test Loss: 3.415 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.5903141498565674
Epoch: 13, Steps: 20 | Train Loss: 0.655 Vali Loss: 3.368 Vali Acc: 0.420 Test Loss: 3.368 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.705122232437134
Epoch: 14, Steps: 20 | Train Loss: 0.473 Vali Loss: 3.467 Vali Acc: 0.500 Test Loss: 3.467 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 577410
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8907172679901123
Epoch: 1, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.934 Vali Acc: 0.540 Test Loss: 0.934 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 1.462404489517212
Epoch: 2, Steps: 20 | Train Loss: 0.815 Vali Loss: 0.917 Vali Acc: 0.480 Test Loss: 0.917 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4117839336395264
Epoch: 3, Steps: 20 | Train Loss: 0.813 Vali Loss: 1.492 Vali Acc: 0.520 Test Loss: 1.492 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5765390396118164
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 1.539 Vali Acc: 0.550 Test Loss: 1.539 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549985).  Saving model ...
Epoch: 5 cost time: 1.370420217514038
Epoch: 5, Steps: 20 | Train Loss: 0.700 Vali Loss: 1.321 Vali Acc: 0.550 Test Loss: 1.321 Test Acc: 0.550
Validation loss decreased (-0.549985 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 1.605750322341919
Epoch: 6, Steps: 20 | Train Loss: 0.660 Vali Loss: 1.252 Vali Acc: 0.480 Test Loss: 1.252 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6826672554016113
Epoch: 7, Steps: 20 | Train Loss: 0.507 Vali Loss: 1.639 Vali Acc: 0.560 Test Loss: 1.639 Test Acc: 0.560
Validation loss decreased (-0.549987 --> -0.559984).  Saving model ...
Epoch: 8 cost time: 1.4694032669067383
Epoch: 8, Steps: 20 | Train Loss: 0.564 Vali Loss: 1.938 Vali Acc: 0.510 Test Loss: 1.938 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4815356731414795
Epoch: 9, Steps: 20 | Train Loss: 0.519 Vali Loss: 1.876 Vali Acc: 0.470 Test Loss: 1.876 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9945738315582275
Epoch: 10, Steps: 20 | Train Loss: 0.390 Vali Loss: 2.617 Vali Acc: 0.490 Test Loss: 2.617 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5030279159545898
Epoch: 11, Steps: 20 | Train Loss: 0.434 Vali Loss: 2.287 Vali Acc: 0.450 Test Loss: 2.287 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4258317947387695
Epoch: 12, Steps: 20 | Train Loss: 0.447 Vali Loss: 2.746 Vali Acc: 0.520 Test Loss: 2.746 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3777375221252441
Epoch: 13, Steps: 20 | Train Loss: 0.346 Vali Loss: 2.254 Vali Acc: 0.500 Test Loss: 2.254 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5294458866119385
Epoch: 14, Steps: 20 | Train Loss: 0.351 Vali Loss: 3.240 Vali Acc: 0.500 Test Loss: 3.240 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5306854248046875
Epoch: 15, Steps: 20 | Train Loss: 0.341 Vali Loss: 2.781 Vali Acc: 0.500 Test Loss: 2.781 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4209129810333252
Epoch: 16, Steps: 20 | Train Loss: 0.326 Vali Loss: 4.211 Vali Acc: 0.480 Test Loss: 4.211 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3292064666748047
Epoch: 17, Steps: 20 | Train Loss: 0.413 Vali Loss: 3.162 Vali Acc: 0.490 Test Loss: 3.162 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 520194
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1283116340637207
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 1.014 Vali Acc: 0.530 Test Loss: 1.014 Test Acc: 0.530
Validation loss decreased (inf --> -0.529990).  Saving model ...
Epoch: 2 cost time: 1.142024278640747
Epoch: 2, Steps: 20 | Train Loss: 0.749 Vali Loss: 1.025 Vali Acc: 0.460 Test Loss: 1.025 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3254146575927734
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 1.092 Vali Acc: 0.510 Test Loss: 1.092 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2372255325317383
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.930 Vali Acc: 0.490 Test Loss: 0.930 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2371714115142822
Epoch: 5, Steps: 20 | Train Loss: 0.620 Vali Loss: 1.500 Vali Acc: 0.480 Test Loss: 1.500 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.425821304321289
Epoch: 6, Steps: 20 | Train Loss: 0.570 Vali Loss: 1.009 Vali Acc: 0.540 Test Loss: 1.009 Test Acc: 0.540
Validation loss decreased (-0.529990 --> -0.539990).  Saving model ...
Epoch: 7 cost time: 2.491598606109619
Epoch: 7, Steps: 20 | Train Loss: 0.489 Vali Loss: 1.375 Vali Acc: 0.550 Test Loss: 1.375 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549986).  Saving model ...
Epoch: 8 cost time: 2.4963693618774414
Epoch: 8, Steps: 20 | Train Loss: 0.489 Vali Loss: 1.130 Vali Acc: 0.550 Test Loss: 1.130 Test Acc: 0.550
Validation loss decreased (-0.549986 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 2.589320421218872
Epoch: 9, Steps: 20 | Train Loss: 0.446 Vali Loss: 1.558 Vali Acc: 0.430 Test Loss: 1.558 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.445561170578003
Epoch: 10, Steps: 20 | Train Loss: 0.508 Vali Loss: 1.762 Vali Acc: 0.500 Test Loss: 1.762 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.636812210083008
Epoch: 11, Steps: 20 | Train Loss: 0.315 Vali Loss: 1.676 Vali Acc: 0.480 Test Loss: 1.676 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4963505268096924
Epoch: 12, Steps: 20 | Train Loss: 0.341 Vali Loss: 1.449 Vali Acc: 0.610 Test Loss: 1.449 Test Acc: 0.610
Validation loss decreased (-0.549989 --> -0.609986).  Saving model ...
Epoch: 13 cost time: 2.473318576812744
Epoch: 13, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.691 Vali Acc: 0.500 Test Loss: 1.691 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5459582805633545
Epoch: 14, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.956 Vali Acc: 0.590 Test Loss: 1.956 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5246081352233887
Epoch: 15, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.717 Vali Acc: 0.540 Test Loss: 1.717 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3105430603027344
Epoch: 16, Steps: 20 | Train Loss: 0.202 Vali Loss: 2.121 Vali Acc: 0.560 Test Loss: 2.121 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4090499877929688
Epoch: 17, Steps: 20 | Train Loss: 0.272 Vali Loss: 2.364 Vali Acc: 0.450 Test Loss: 2.364 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2025396823883057
Epoch: 18, Steps: 20 | Train Loss: 0.133 Vali Loss: 3.255 Vali Acc: 0.460 Test Loss: 3.255 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5337822437286377
Epoch: 19, Steps: 20 | Train Loss: 0.394 Vali Loss: 2.271 Vali Acc: 0.520 Test Loss: 2.271 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.643242120742798
Epoch: 20, Steps: 20 | Train Loss: 0.320 Vali Loss: 2.585 Vali Acc: 0.480 Test Loss: 2.585 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.860421657562256
Epoch: 21, Steps: 20 | Train Loss: 0.221 Vali Loss: 2.216 Vali Acc: 0.550 Test Loss: 2.216 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.76403546333313
Epoch: 22, Steps: 20 | Train Loss: 0.121 Vali Loss: 2.796 Vali Acc: 0.490 Test Loss: 2.796 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 484738
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.056396007537842
Epoch: 1, Steps: 20 | Train Loss: 0.818 Vali Loss: 0.833 Vali Acc: 0.500 Test Loss: 0.833 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.484907627105713
Epoch: 2, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.978 Vali Acc: 0.500 Test Loss: 0.978 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.423286199569702
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.993 Vali Acc: 0.520 Test Loss: 0.993 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519990).  Saving model ...
Epoch: 4 cost time: 2.405365467071533
Epoch: 4, Steps: 20 | Train Loss: 0.745 Vali Loss: 1.111 Vali Acc: 0.510 Test Loss: 1.111 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6003012657165527
Epoch: 5, Steps: 20 | Train Loss: 0.678 Vali Loss: 1.026 Vali Acc: 0.480 Test Loss: 1.026 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4498162269592285
Epoch: 6, Steps: 20 | Train Loss: 0.576 Vali Loss: 1.136 Vali Acc: 0.530 Test Loss: 1.136 Test Acc: 0.530
Validation loss decreased (-0.519990 --> -0.529989).  Saving model ...
Epoch: 7 cost time: 2.56650447845459
Epoch: 7, Steps: 20 | Train Loss: 0.574 Vali Loss: 1.160 Vali Acc: 0.520 Test Loss: 1.160 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.583625078201294
Epoch: 8, Steps: 20 | Train Loss: 0.478 Vali Loss: 1.548 Vali Acc: 0.460 Test Loss: 1.548 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7877957820892334
Epoch: 9, Steps: 20 | Train Loss: 0.489 Vali Loss: 1.517 Vali Acc: 0.510 Test Loss: 1.517 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7265632152557373
Epoch: 10, Steps: 20 | Train Loss: 0.385 Vali Loss: 1.396 Vali Acc: 0.490 Test Loss: 1.396 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.617257595062256
Epoch: 11, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.684 Vali Acc: 0.500 Test Loss: 1.684 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5130715370178223
Epoch: 12, Steps: 20 | Train Loss: 0.461 Vali Loss: 2.464 Vali Acc: 0.560 Test Loss: 2.464 Test Acc: 0.560
Validation loss decreased (-0.529989 --> -0.559975).  Saving model ...
Epoch: 13 cost time: 2.521873712539673
Epoch: 13, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.769 Vali Acc: 0.430 Test Loss: 1.769 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2876815795898438
Epoch: 14, Steps: 20 | Train Loss: 0.260 Vali Loss: 2.234 Vali Acc: 0.420 Test Loss: 2.234 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.198049306869507
Epoch: 15, Steps: 20 | Train Loss: 0.331 Vali Loss: 1.755 Vali Acc: 0.530 Test Loss: 1.755 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1880059242248535
Epoch: 16, Steps: 20 | Train Loss: 0.364 Vali Loss: 2.441 Vali Acc: 0.520 Test Loss: 2.441 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3799264430999756
Epoch: 17, Steps: 20 | Train Loss: 0.330 Vali Loss: 2.701 Vali Acc: 0.500 Test Loss: 2.701 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3976762294769287
Epoch: 18, Steps: 20 | Train Loss: 0.278 Vali Loss: 2.707 Vali Acc: 0.500 Test Loss: 2.707 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4231793880462646
Epoch: 19, Steps: 20 | Train Loss: 0.298 Vali Loss: 3.010 Vali Acc: 0.480 Test Loss: 3.010 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.524848461151123
Epoch: 20, Steps: 20 | Train Loss: 0.341 Vali Loss: 3.071 Vali Acc: 0.550 Test Loss: 3.071 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.595231771469116
Epoch: 21, Steps: 20 | Train Loss: 0.164 Vali Loss: 2.769 Vali Acc: 0.550 Test Loss: 2.769 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4132328033447266
Epoch: 22, Steps: 20 | Train Loss: 0.235 Vali Loss: 2.905 Vali Acc: 0.460 Test Loss: 2.905 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 470658
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.1678221225738525
Epoch: 1, Steps: 20 | Train Loss: 0.795 Vali Loss: 0.768 Vali Acc: 0.580 Test Loss: 0.768 Test Acc: 0.580
Validation loss decreased (inf --> -0.579992).  Saving model ...
Epoch: 2 cost time: 2.5568978786468506
Epoch: 2, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.947 Vali Acc: 0.500 Test Loss: 0.947 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4433863162994385
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3251914978027344
Epoch: 4, Steps: 20 | Train Loss: 0.596 Vali Loss: 1.075 Vali Acc: 0.510 Test Loss: 1.075 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1863136291503906
Epoch: 5, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.955 Vali Acc: 0.500 Test Loss: 0.955 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2244713306427
Epoch: 6, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.933 Vali Acc: 0.500 Test Loss: 0.933 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.864715576171875
Epoch: 7, Steps: 20 | Train Loss: 0.600 Vali Loss: 1.258 Vali Acc: 0.490 Test Loss: 1.258 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.478008270263672
Epoch: 8, Steps: 20 | Train Loss: 0.519 Vali Loss: 1.312 Vali Acc: 0.480 Test Loss: 1.312 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.3764305114746094
Epoch: 9, Steps: 20 | Train Loss: 0.518 Vali Loss: 1.081 Vali Acc: 0.500 Test Loss: 1.081 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6234543323516846
Epoch: 10, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.318 Vali Acc: 0.530 Test Loss: 1.318 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6116206645965576
Epoch: 11, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.153 Vali Acc: 0.530 Test Loss: 1.153 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 449538
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.610530853271484
Epoch: 1, Steps: 20 | Train Loss: 0.866 Vali Loss: 0.947 Vali Acc: 0.510 Test Loss: 0.947 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 5.871638774871826
Epoch: 2, Steps: 20 | Train Loss: 1.203 Vali Loss: 2.689 Vali Acc: 0.500 Test Loss: 2.689 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.998966217041016
Epoch: 3, Steps: 20 | Train Loss: 1.360 Vali Loss: 1.904 Vali Acc: 0.510 Test Loss: 1.904 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.733930587768555
Epoch: 4, Steps: 20 | Train Loss: 1.106 Vali Loss: 2.102 Vali Acc: 0.580 Test Loss: 2.102 Test Acc: 0.580
Validation loss decreased (-0.509991 --> -0.579979).  Saving model ...
Epoch: 5 cost time: 5.7047810554504395
Epoch: 5, Steps: 20 | Train Loss: 1.166 Vali Loss: 2.621 Vali Acc: 0.530 Test Loss: 2.621 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.818490743637085
Epoch: 6, Steps: 20 | Train Loss: 1.013 Vali Loss: 2.484 Vali Acc: 0.530 Test Loss: 2.484 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.749586582183838
Epoch: 7, Steps: 20 | Train Loss: 0.791 Vali Loss: 2.558 Vali Acc: 0.560 Test Loss: 2.558 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.84760308265686
Epoch: 8, Steps: 20 | Train Loss: 1.492 Vali Loss: 6.628 Vali Acc: 0.510 Test Loss: 6.628 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.93167519569397
Epoch: 9, Steps: 20 | Train Loss: 1.199 Vali Loss: 6.084 Vali Acc: 0.510 Test Loss: 6.084 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.155763387680054
Epoch: 10, Steps: 20 | Train Loss: 1.977 Vali Loss: 3.992 Vali Acc: 0.460 Test Loss: 3.992 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.879030704498291
Epoch: 11, Steps: 20 | Train Loss: 0.941 Vali Loss: 4.541 Vali Acc: 0.490 Test Loss: 4.541 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.9512104988098145
Epoch: 12, Steps: 20 | Train Loss: 0.891 Vali Loss: 4.883 Vali Acc: 0.510 Test Loss: 4.883 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.047725439071655
Epoch: 13, Steps: 20 | Train Loss: 1.680 Vali Loss: 5.322 Vali Acc: 0.460 Test Loss: 5.322 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.966585874557495
Epoch: 14, Steps: 20 | Train Loss: 0.600 Vali Loss: 6.992 Vali Acc: 0.490 Test Loss: 6.992 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 657666
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.113709449768066
Epoch: 1, Steps: 20 | Train Loss: 0.878 Vali Loss: 1.039 Vali Acc: 0.510 Test Loss: 1.039 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 3.2861483097076416
Epoch: 2, Steps: 20 | Train Loss: 0.765 Vali Loss: 1.026 Vali Acc: 0.470 Test Loss: 1.026 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.300685167312622
Epoch: 3, Steps: 20 | Train Loss: 0.745 Vali Loss: 1.345 Vali Acc: 0.540 Test Loss: 1.345 Test Acc: 0.540
Validation loss decreased (-0.509990 --> -0.539987).  Saving model ...
Epoch: 4 cost time: 3.1779448986053467
Epoch: 4, Steps: 20 | Train Loss: 0.864 Vali Loss: 1.085 Vali Acc: 0.580 Test Loss: 1.085 Test Acc: 0.580
Validation loss decreased (-0.539987 --> -0.579989).  Saving model ...
Epoch: 5 cost time: 3.1867337226867676
Epoch: 5, Steps: 20 | Train Loss: 0.567 Vali Loss: 1.679 Vali Acc: 0.480 Test Loss: 1.679 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.44055438041687
Epoch: 6, Steps: 20 | Train Loss: 0.806 Vali Loss: 3.046 Vali Acc: 0.530 Test Loss: 3.046 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1228864192962646
Epoch: 7, Steps: 20 | Train Loss: 0.999 Vali Loss: 2.255 Vali Acc: 0.470 Test Loss: 2.255 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0258595943450928
Epoch: 8, Steps: 20 | Train Loss: 0.917 Vali Loss: 2.406 Vali Acc: 0.550 Test Loss: 2.406 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.0607423782348633
Epoch: 9, Steps: 20 | Train Loss: 0.436 Vali Loss: 2.011 Vali Acc: 0.510 Test Loss: 2.011 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.3038246631622314
Epoch: 10, Steps: 20 | Train Loss: 0.455 Vali Loss: 3.261 Vali Acc: 0.510 Test Loss: 3.261 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2916154861450195
Epoch: 11, Steps: 20 | Train Loss: 0.443 Vali Loss: 2.586 Vali Acc: 0.500 Test Loss: 2.586 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.236570119857788
Epoch: 12, Steps: 20 | Train Loss: 0.617 Vali Loss: 3.271 Vali Acc: 0.540 Test Loss: 3.271 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.223210096359253
Epoch: 13, Steps: 20 | Train Loss: 0.881 Vali Loss: 3.512 Vali Acc: 0.500 Test Loss: 3.512 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.272019863128662
Epoch: 14, Steps: 20 | Train Loss: 0.824 Vali Loss: 5.672 Vali Acc: 0.460 Test Loss: 5.672 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 478594
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.306062459945679
Epoch: 1, Steps: 20 | Train Loss: 1.092 Vali Loss: 1.772 Vali Acc: 0.490 Test Loss: 1.772 Test Acc: 0.490
Validation loss decreased (inf --> -0.489982).  Saving model ...
Epoch: 2 cost time: 4.528481483459473
Epoch: 2, Steps: 20 | Train Loss: 0.850 Vali Loss: 1.462 Vali Acc: 0.520 Test Loss: 1.462 Test Acc: 0.520
Validation loss decreased (-0.489982 --> -0.519985).  Saving model ...
Epoch: 3 cost time: 4.666814088821411
Epoch: 3, Steps: 20 | Train Loss: 0.735 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.649349927902222
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 1.512 Vali Acc: 0.500 Test Loss: 1.512 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.643688678741455
Epoch: 5, Steps: 20 | Train Loss: 0.591 Vali Loss: 1.410 Vali Acc: 0.470 Test Loss: 1.410 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.460694789886475
Epoch: 6, Steps: 20 | Train Loss: 1.233 Vali Loss: 1.714 Vali Acc: 0.550 Test Loss: 1.714 Test Acc: 0.550
Validation loss decreased (-0.519985 --> -0.549983).  Saving model ...
Epoch: 7 cost time: 4.428828001022339
Epoch: 7, Steps: 20 | Train Loss: 0.867 Vali Loss: 1.539 Vali Acc: 0.550 Test Loss: 1.539 Test Acc: 0.550
Validation loss decreased (-0.549983 --> -0.549985).  Saving model ...
Epoch: 8 cost time: 4.472170352935791
Epoch: 8, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.900 Vali Acc: 0.500 Test Loss: 1.900 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.412248849868774
Epoch: 9, Steps: 20 | Train Loss: 0.734 Vali Loss: 1.817 Vali Acc: 0.580 Test Loss: 1.817 Test Acc: 0.580
Validation loss decreased (-0.549985 --> -0.579982).  Saving model ...
Epoch: 10 cost time: 4.465285062789917
Epoch: 10, Steps: 20 | Train Loss: 0.492 Vali Loss: 2.378 Vali Acc: 0.440 Test Loss: 2.378 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.349781274795532
Epoch: 11, Steps: 20 | Train Loss: 0.456 Vali Loss: 2.518 Vali Acc: 0.470 Test Loss: 2.518 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.387357711791992
Epoch: 12, Steps: 20 | Train Loss: 0.438 Vali Loss: 3.023 Vali Acc: 0.450 Test Loss: 3.023 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.446666717529297
Epoch: 13, Steps: 20 | Train Loss: 0.551 Vali Loss: 3.597 Vali Acc: 0.490 Test Loss: 3.597 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.277621269226074
Epoch: 14, Steps: 20 | Train Loss: 0.539 Vali Loss: 2.854 Vali Acc: 0.550 Test Loss: 2.854 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.525212526321411
Epoch: 15, Steps: 20 | Train Loss: 0.643 Vali Loss: 5.306 Vali Acc: 0.540 Test Loss: 5.306 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.8033061027526855
Epoch: 16, Steps: 20 | Train Loss: 0.512 Vali Loss: 3.620 Vali Acc: 0.530 Test Loss: 3.620 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.281173229217529
Epoch: 17, Steps: 20 | Train Loss: 0.355 Vali Loss: 5.360 Vali Acc: 0.560 Test Loss: 5.360 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.255819082260132
Epoch: 18, Steps: 20 | Train Loss: 0.703 Vali Loss: 3.549 Vali Acc: 0.550 Test Loss: 3.549 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.210586071014404
Epoch: 19, Steps: 20 | Train Loss: 0.385 Vali Loss: 4.732 Vali Acc: 0.540 Test Loss: 4.732 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 478722
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.760726451873779
Epoch: 1, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 4.067426919937134
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.914 Vali Acc: 0.510 Test Loss: 0.914 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.179255485534668
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.963 Vali Acc: 0.520 Test Loss: 0.963 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.187368869781494
Epoch: 4, Steps: 20 | Train Loss: 0.721 Vali Loss: 1.615 Vali Acc: 0.550 Test Loss: 1.615 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549984).  Saving model ...
Epoch: 5 cost time: 4.056126356124878
Epoch: 5, Steps: 20 | Train Loss: 0.656 Vali Loss: 1.208 Vali Acc: 0.430 Test Loss: 1.208 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9655237197875977
Epoch: 6, Steps: 20 | Train Loss: 0.600 Vali Loss: 2.170 Vali Acc: 0.510 Test Loss: 2.170 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5753438472747803
Epoch: 7, Steps: 20 | Train Loss: 0.967 Vali Loss: 1.748 Vali Acc: 0.460 Test Loss: 1.748 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.3426945209503174
Epoch: 8, Steps: 20 | Train Loss: 0.584 Vali Loss: 1.482 Vali Acc: 0.520 Test Loss: 1.482 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.504483938217163
Epoch: 9, Steps: 20 | Train Loss: 0.687 Vali Loss: 1.953 Vali Acc: 0.510 Test Loss: 1.953 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.5825226306915283
Epoch: 10, Steps: 20 | Train Loss: 0.723 Vali Loss: 2.595 Vali Acc: 0.520 Test Loss: 2.595 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.6366477012634277
Epoch: 11, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.950 Vali Acc: 0.530 Test Loss: 1.950 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.703657865524292
Epoch: 12, Steps: 20 | Train Loss: 0.417 Vali Loss: 1.859 Vali Acc: 0.520 Test Loss: 1.859 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.980644464492798
Epoch: 13, Steps: 20 | Train Loss: 0.480 Vali Loss: 3.235 Vali Acc: 0.540 Test Loss: 3.235 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.034912347793579
Epoch: 14, Steps: 20 | Train Loss: 0.394 Vali Loss: 2.334 Vali Acc: 0.530 Test Loss: 2.334 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 421506
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.604415416717529
Epoch: 1, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.975 Vali Acc: 0.540 Test Loss: 0.975 Test Acc: 0.540
Validation loss decreased (inf --> -0.539990).  Saving model ...
Epoch: 2 cost time: 4.769638538360596
Epoch: 2, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.951 Vali Acc: 0.530 Test Loss: 0.951 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.835302114486694
Epoch: 3, Steps: 20 | Train Loss: 0.803 Vali Loss: 1.020 Vali Acc: 0.470 Test Loss: 1.020 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.4409849643707275
Epoch: 4, Steps: 20 | Train Loss: 0.608 Vali Loss: 1.153 Vali Acc: 0.460 Test Loss: 1.153 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.59810471534729
Epoch: 5, Steps: 20 | Train Loss: 0.688 Vali Loss: 1.346 Vali Acc: 0.540 Test Loss: 1.346 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.698011159896851
Epoch: 6, Steps: 20 | Train Loss: 0.617 Vali Loss: 1.258 Vali Acc: 0.540 Test Loss: 1.258 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.591426372528076
Epoch: 7, Steps: 20 | Train Loss: 0.545 Vali Loss: 1.304 Vali Acc: 0.510 Test Loss: 1.304 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.606549501419067
Epoch: 8, Steps: 20 | Train Loss: 0.550 Vali Loss: 1.613 Vali Acc: 0.540 Test Loss: 1.613 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.3724000453948975
Epoch: 9, Steps: 20 | Train Loss: 0.592 Vali Loss: 1.341 Vali Acc: 0.490 Test Loss: 1.341 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.208581209182739
Epoch: 10, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.225 Vali Acc: 0.490 Test Loss: 1.225 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.239549875259399
Epoch: 11, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.359 Vali Acc: 0.520 Test Loss: 1.359 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 386050
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.250639915466309
Epoch: 1, Steps: 20 | Train Loss: 0.805 Vali Loss: 0.842 Vali Acc: 0.490 Test Loss: 0.842 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 4.436647415161133
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 1.095 Vali Acc: 0.510 Test Loss: 1.095 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509989).  Saving model ...
Epoch: 3 cost time: 4.535975456237793
Epoch: 3, Steps: 20 | Train Loss: 0.830 Vali Loss: 0.808 Vali Acc: 0.550 Test Loss: 0.808 Test Acc: 0.550
Validation loss decreased (-0.509989 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 4.344682693481445
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.954 Vali Acc: 0.490 Test Loss: 0.954 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.604450464248657
Epoch: 5, Steps: 20 | Train Loss: 0.655 Vali Loss: 1.092 Vali Acc: 0.550 Test Loss: 1.092 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.379751443862915
Epoch: 6, Steps: 20 | Train Loss: 0.679 Vali Loss: 1.062 Vali Acc: 0.460 Test Loss: 1.062 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.339793920516968
Epoch: 7, Steps: 20 | Train Loss: 0.574 Vali Loss: 1.395 Vali Acc: 0.500 Test Loss: 1.395 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.706985950469971
Epoch: 8, Steps: 20 | Train Loss: 0.788 Vali Loss: 1.268 Vali Acc: 0.490 Test Loss: 1.268 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.485912799835205
Epoch: 9, Steps: 20 | Train Loss: 0.476 Vali Loss: 1.404 Vali Acc: 0.560 Test Loss: 1.404 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559986).  Saving model ...
Epoch: 10 cost time: 4.377991199493408
Epoch: 10, Steps: 20 | Train Loss: 0.799 Vali Loss: 1.705 Vali Acc: 0.510 Test Loss: 1.705 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.614687919616699
Epoch: 11, Steps: 20 | Train Loss: 0.724 Vali Loss: 1.681 Vali Acc: 0.510 Test Loss: 1.681 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.985955238342285
Epoch: 12, Steps: 20 | Train Loss: 0.594 Vali Loss: 1.840 Vali Acc: 0.540 Test Loss: 1.840 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.472187519073486
Epoch: 13, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.828 Vali Acc: 0.460 Test Loss: 1.828 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.499892950057983
Epoch: 14, Steps: 20 | Train Loss: 0.637 Vali Loss: 2.501 Vali Acc: 0.530 Test Loss: 2.501 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.142925024032593
Epoch: 15, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.994 Vali Acc: 0.530 Test Loss: 1.994 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.209347248077393
Epoch: 16, Steps: 20 | Train Loss: 0.369 Vali Loss: 2.386 Vali Acc: 0.500 Test Loss: 2.386 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.980055570602417
Epoch: 17, Steps: 20 | Train Loss: 0.315 Vali Loss: 2.704 Vali Acc: 0.510 Test Loss: 2.704 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.612843036651611
Epoch: 18, Steps: 20 | Train Loss: 0.304 Vali Loss: 2.009 Vali Acc: 0.500 Test Loss: 2.009 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.794907808303833
Epoch: 19, Steps: 20 | Train Loss: 0.328 Vali Loss: 2.767 Vali Acc: 0.490 Test Loss: 2.767 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 371970
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.808509826660156
Epoch: 1, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 4.858766078948975
Epoch: 2, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.886 Vali Acc: 0.460 Test Loss: 0.886 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.65185022354126
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 1.013 Vali Acc: 0.440 Test Loss: 1.013 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.607650518417358
Epoch: 4, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.899 Vali Acc: 0.550 Test Loss: 0.899 Test Acc: 0.550
Validation loss decreased (-0.489991 --> -0.549991).  Saving model ...
Epoch: 5 cost time: 4.339725732803345
Epoch: 5, Steps: 20 | Train Loss: 0.591 Vali Loss: 1.071 Vali Acc: 0.470 Test Loss: 1.071 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.2591376304626465
Epoch: 6, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.948 Vali Acc: 0.460 Test Loss: 0.948 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.400161504745483
Epoch: 7, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.975 Vali Acc: 0.530 Test Loss: 0.975 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.887596607208252
Epoch: 8, Steps: 20 | Train Loss: 0.438 Vali Loss: 1.056 Vali Acc: 0.570 Test Loss: 1.056 Test Acc: 0.570
Validation loss decreased (-0.549991 --> -0.569989).  Saving model ...
Epoch: 9 cost time: 4.4891862869262695
Epoch: 9, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.407 Vali Acc: 0.440 Test Loss: 1.407 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.057230234146118
Epoch: 10, Steps: 20 | Train Loss: 0.442 Vali Loss: 1.571 Vali Acc: 0.490 Test Loss: 1.571 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.174532175064087
Epoch: 11, Steps: 20 | Train Loss: 0.351 Vali Loss: 1.280 Vali Acc: 0.510 Test Loss: 1.280 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.66244649887085
Epoch: 12, Steps: 20 | Train Loss: 0.449 Vali Loss: 1.800 Vali Acc: 0.540 Test Loss: 1.800 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.338066816329956
Epoch: 13, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.504 Vali Acc: 0.530 Test Loss: 1.504 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.577869415283203
Epoch: 14, Steps: 20 | Train Loss: 0.319 Vali Loss: 1.336 Vali Acc: 0.520 Test Loss: 1.336 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.9315760135650635
Epoch: 15, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.736 Vali Acc: 0.510 Test Loss: 1.736 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.0540807247161865
Epoch: 16, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.941 Vali Acc: 0.520 Test Loss: 1.941 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.0715250968933105
Epoch: 17, Steps: 20 | Train Loss: 0.261 Vali Loss: 2.184 Vali Acc: 0.490 Test Loss: 2.184 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.82573390007019
Epoch: 18, Steps: 20 | Train Loss: 0.315 Vali Loss: 1.864 Vali Acc: 0.490 Test Loss: 1.864 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 350850
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.095487594604492
Epoch: 1, Steps: 20 | Train Loss: 0.993 Vali Loss: 1.121 Vali Acc: 0.490 Test Loss: 1.121 Test Acc: 0.490
Validation loss decreased (inf --> -0.489989).  Saving model ...
Epoch: 2 cost time: 7.3295605182647705
Epoch: 2, Steps: 20 | Train Loss: 1.055 Vali Loss: 1.442 Vali Acc: 0.480 Test Loss: 1.442 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.130608320236206
Epoch: 3, Steps: 20 | Train Loss: 1.186 Vali Loss: 2.556 Vali Acc: 0.500 Test Loss: 2.556 Test Acc: 0.500
Validation loss decreased (-0.489989 --> -0.499974).  Saving model ...
Epoch: 4 cost time: 7.338752508163452
Epoch: 4, Steps: 20 | Train Loss: 1.049 Vali Loss: 2.605 Vali Acc: 0.500 Test Loss: 2.605 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.77632474899292
Epoch: 5, Steps: 20 | Train Loss: 0.998 Vali Loss: 5.108 Vali Acc: 0.530 Test Loss: 5.108 Test Acc: 0.530
Validation loss decreased (-0.499974 --> -0.529949).  Saving model ...
Epoch: 6 cost time: 7.010051250457764
Epoch: 6, Steps: 20 | Train Loss: 1.615 Vali Loss: 3.034 Vali Acc: 0.440 Test Loss: 3.034 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.725029468536377
Epoch: 7, Steps: 20 | Train Loss: 1.211 Vali Loss: 3.464 Vali Acc: 0.500 Test Loss: 3.464 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.5405261516571045
Epoch: 8, Steps: 20 | Train Loss: 1.055 Vali Loss: 2.163 Vali Acc: 0.580 Test Loss: 2.163 Test Acc: 0.580
Validation loss decreased (-0.529949 --> -0.579978).  Saving model ...
Epoch: 9 cost time: 6.904306411743164
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 3.420 Vali Acc: 0.520 Test Loss: 3.420 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.759932279586792
Epoch: 10, Steps: 20 | Train Loss: 1.047 Vali Loss: 4.258 Vali Acc: 0.490 Test Loss: 4.258 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.68828272819519
Epoch: 11, Steps: 20 | Train Loss: 0.610 Vali Loss: 4.055 Vali Acc: 0.500 Test Loss: 4.055 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.615651607513428
Epoch: 12, Steps: 20 | Train Loss: 1.200 Vali Loss: 3.930 Vali Acc: 0.520 Test Loss: 3.930 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.1847405433654785
Epoch: 13, Steps: 20 | Train Loss: 0.840 Vali Loss: 5.463 Vali Acc: 0.470 Test Loss: 5.463 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.1052234172821045
Epoch: 14, Steps: 20 | Train Loss: 0.927 Vali Loss: 5.652 Vali Acc: 0.450 Test Loss: 5.652 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.60812783241272
Epoch: 15, Steps: 20 | Train Loss: 0.619 Vali Loss: 5.987 Vali Acc: 0.420 Test Loss: 5.987 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.378718137741089
Epoch: 16, Steps: 20 | Train Loss: 0.979 Vali Loss: 7.976 Vali Acc: 0.520 Test Loss: 7.976 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.991662979125977
Epoch: 17, Steps: 20 | Train Loss: 0.457 Vali Loss: 7.313 Vali Acc: 0.510 Test Loss: 7.313 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.884430885314941
Epoch: 18, Steps: 20 | Train Loss: 0.592 Vali Loss: 6.939 Vali Acc: 0.470 Test Loss: 6.939 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 608322
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.540556192398071
Epoch: 1, Steps: 20 | Train Loss: 0.847 Vali Loss: 0.884 Vali Acc: 0.480 Test Loss: 0.884 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 4.124744415283203
Epoch: 2, Steps: 20 | Train Loss: 0.789 Vali Loss: 1.139 Vali Acc: 0.530 Test Loss: 1.139 Test Acc: 0.530
Validation loss decreased (-0.479991 --> -0.529989).  Saving model ...
Epoch: 3 cost time: 3.69518780708313
Epoch: 3, Steps: 20 | Train Loss: 0.749 Vali Loss: 1.166 Vali Acc: 0.470 Test Loss: 1.166 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9862287044525146
Epoch: 4, Steps: 20 | Train Loss: 0.711 Vali Loss: 1.514 Vali Acc: 0.430 Test Loss: 1.514 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.592803955078125
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 1.598 Vali Acc: 0.520 Test Loss: 1.598 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.421961784362793
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 1.374 Vali Acc: 0.560 Test Loss: 1.374 Test Acc: 0.560
Validation loss decreased (-0.529989 --> -0.559986).  Saving model ...
Epoch: 7 cost time: 4.652822017669678
Epoch: 7, Steps: 20 | Train Loss: 0.531 Vali Loss: 1.737 Vali Acc: 0.510 Test Loss: 1.737 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.430041313171387
Epoch: 8, Steps: 20 | Train Loss: 0.936 Vali Loss: 2.158 Vali Acc: 0.570 Test Loss: 2.158 Test Acc: 0.570
Validation loss decreased (-0.559986 --> -0.569978).  Saving model ...
Epoch: 9 cost time: 4.405805349349976
Epoch: 9, Steps: 20 | Train Loss: 0.516 Vali Loss: 2.137 Vali Acc: 0.440 Test Loss: 2.137 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.838328123092651
Epoch: 10, Steps: 20 | Train Loss: 0.371 Vali Loss: 2.349 Vali Acc: 0.510 Test Loss: 2.349 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.742597818374634
Epoch: 11, Steps: 20 | Train Loss: 0.464 Vali Loss: 2.944 Vali Acc: 0.490 Test Loss: 2.944 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.147021770477295
Epoch: 12, Steps: 20 | Train Loss: 0.584 Vali Loss: 3.230 Vali Acc: 0.490 Test Loss: 3.230 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.783895969390869
Epoch: 13, Steps: 20 | Train Loss: 0.602 Vali Loss: 3.769 Vali Acc: 0.500 Test Loss: 3.769 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.958289384841919
Epoch: 14, Steps: 20 | Train Loss: 0.436 Vali Loss: 3.235 Vali Acc: 0.630 Test Loss: 3.235 Test Acc: 0.630
Validation loss decreased (-0.569978 --> -0.629968).  Saving model ...
Epoch: 15 cost time: 4.60624885559082
Epoch: 15, Steps: 20 | Train Loss: 0.424 Vali Loss: 3.755 Vali Acc: 0.490 Test Loss: 3.755 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.685078144073486
Epoch: 16, Steps: 20 | Train Loss: 0.583 Vali Loss: 3.809 Vali Acc: 0.520 Test Loss: 3.809 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.036863088607788
Epoch: 17, Steps: 20 | Train Loss: 0.926 Vali Loss: 3.439 Vali Acc: 0.610 Test Loss: 3.439 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.947094678878784
Epoch: 18, Steps: 20 | Train Loss: 0.255 Vali Loss: 4.304 Vali Acc: 0.540 Test Loss: 4.304 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.444488286972046
Epoch: 19, Steps: 20 | Train Loss: 0.490 Vali Loss: 3.838 Vali Acc: 0.530 Test Loss: 3.838 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.408417463302612
Epoch: 20, Steps: 20 | Train Loss: 0.249 Vali Loss: 4.906 Vali Acc: 0.470 Test Loss: 4.906 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.620970964431763
Epoch: 21, Steps: 20 | Train Loss: 0.454 Vali Loss: 6.262 Vali Acc: 0.560 Test Loss: 6.262 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.527895927429199
Epoch: 22, Steps: 20 | Train Loss: 0.425 Vali Loss: 5.028 Vali Acc: 0.520 Test Loss: 5.028 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.558399677276611
Epoch: 23, Steps: 20 | Train Loss: 0.343 Vali Loss: 5.034 Vali Acc: 0.530 Test Loss: 5.034 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.745130300521851
Epoch: 24, Steps: 20 | Train Loss: 0.124 Vali Loss: 7.255 Vali Acc: 0.490 Test Loss: 7.255 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 429250
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.829669713973999
Epoch: 1, Steps: 20 | Train Loss: 0.864 Vali Loss: 0.935 Vali Acc: 0.540 Test Loss: 0.935 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 4.774169921875
Epoch: 2, Steps: 20 | Train Loss: 1.023 Vali Loss: 1.347 Vali Acc: 0.540 Test Loss: 1.347 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.740620851516724
Epoch: 3, Steps: 20 | Train Loss: 0.882 Vali Loss: 1.451 Vali Acc: 0.510 Test Loss: 1.451 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.7055747509002686
Epoch: 4, Steps: 20 | Train Loss: 0.932 Vali Loss: 1.266 Vali Acc: 0.490 Test Loss: 1.266 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.230701208114624
Epoch: 5, Steps: 20 | Train Loss: 0.958 Vali Loss: 2.143 Vali Acc: 0.560 Test Loss: 2.143 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559979).  Saving model ...
Epoch: 6 cost time: 4.216084003448486
Epoch: 6, Steps: 20 | Train Loss: 0.774 Vali Loss: 2.607 Vali Acc: 0.540 Test Loss: 2.607 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.292025327682495
Epoch: 7, Steps: 20 | Train Loss: 0.734 Vali Loss: 1.930 Vali Acc: 0.460 Test Loss: 1.930 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.801149129867554
Epoch: 8, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.641 Vali Acc: 0.500 Test Loss: 1.641 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.657595634460449
Epoch: 9, Steps: 20 | Train Loss: 0.486 Vali Loss: 3.251 Vali Acc: 0.520 Test Loss: 3.251 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.975590229034424
Epoch: 10, Steps: 20 | Train Loss: 0.658 Vali Loss: 2.514 Vali Acc: 0.490 Test Loss: 2.514 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.775623798370361
Epoch: 11, Steps: 20 | Train Loss: 0.484 Vali Loss: 2.279 Vali Acc: 0.580 Test Loss: 2.279 Test Acc: 0.580
Validation loss decreased (-0.559979 --> -0.579977).  Saving model ...
Epoch: 12 cost time: 4.737319469451904
Epoch: 12, Steps: 20 | Train Loss: 0.701 Vali Loss: 4.011 Vali Acc: 0.540 Test Loss: 4.011 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.041917085647583
Epoch: 13, Steps: 20 | Train Loss: 0.979 Vali Loss: 3.173 Vali Acc: 0.470 Test Loss: 3.173 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.895536661148071
Epoch: 14, Steps: 20 | Train Loss: 0.883 Vali Loss: 5.785 Vali Acc: 0.500 Test Loss: 5.785 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.265872478485107
Epoch: 15, Steps: 20 | Train Loss: 0.680 Vali Loss: 4.852 Vali Acc: 0.470 Test Loss: 4.852 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.1935060024261475
Epoch: 16, Steps: 20 | Train Loss: 0.625 Vali Loss: 3.700 Vali Acc: 0.560 Test Loss: 3.700 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.2815916538238525
Epoch: 17, Steps: 20 | Train Loss: 0.464 Vali Loss: 4.129 Vali Acc: 0.470 Test Loss: 4.129 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.82707405090332
Epoch: 18, Steps: 20 | Train Loss: 0.437 Vali Loss: 3.520 Vali Acc: 0.550 Test Loss: 3.520 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.207468509674072
Epoch: 19, Steps: 20 | Train Loss: 0.288 Vali Loss: 5.740 Vali Acc: 0.480 Test Loss: 5.740 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.5352232456207275
Epoch: 20, Steps: 20 | Train Loss: 1.168 Vali Loss: 6.651 Vali Acc: 0.590 Test Loss: 6.651 Test Acc: 0.590
Validation loss decreased (-0.579977 --> -0.589933).  Saving model ...
Epoch: 21 cost time: 4.42803692817688
Epoch: 21, Steps: 20 | Train Loss: 0.550 Vali Loss: 5.274 Vali Acc: 0.470 Test Loss: 5.274 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.76998233795166
Epoch: 22, Steps: 20 | Train Loss: 0.184 Vali Loss: 6.073 Vali Acc: 0.510 Test Loss: 6.073 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.847711086273193
Epoch: 23, Steps: 20 | Train Loss: 0.366 Vali Loss: 5.952 Vali Acc: 0.500 Test Loss: 5.952 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.19523549079895
Epoch: 24, Steps: 20 | Train Loss: 0.299 Vali Loss: 5.951 Vali Acc: 0.490 Test Loss: 5.951 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.896933078765869
Epoch: 25, Steps: 20 | Train Loss: 0.120 Vali Loss: 6.041 Vali Acc: 0.510 Test Loss: 6.041 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.255535840988159
Epoch: 26, Steps: 20 | Train Loss: 0.172 Vali Loss: 5.694 Vali Acc: 0.510 Test Loss: 5.694 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.5967841148376465
Epoch: 27, Steps: 20 | Train Loss: 0.129 Vali Loss: 7.280 Vali Acc: 0.490 Test Loss: 7.280 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.604264736175537
Epoch: 28, Steps: 20 | Train Loss: 0.168 Vali Loss: 6.498 Vali Acc: 0.530 Test Loss: 6.498 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.322079658508301
Epoch: 29, Steps: 20 | Train Loss: 0.216 Vali Loss: 6.391 Vali Acc: 0.450 Test Loss: 6.391 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.683462381362915
Epoch: 30, Steps: 20 | Train Loss: 0.399 Vali Loss: 10.623 Vali Acc: 0.520 Test Loss: 10.623 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 429378
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.267112731933594
Epoch: 1, Steps: 20 | Train Loss: 0.834 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 4.111566543579102
Epoch: 2, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.942 Vali Acc: 0.510 Test Loss: 0.942 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5351521968841553
Epoch: 3, Steps: 20 | Train Loss: 0.703 Vali Loss: 1.181 Vali Acc: 0.430 Test Loss: 1.181 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3505449295043945
Epoch: 4, Steps: 20 | Train Loss: 0.938 Vali Loss: 1.319 Vali Acc: 0.540 Test Loss: 1.319 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539987).  Saving model ...
Epoch: 5 cost time: 3.1551244258880615
Epoch: 5, Steps: 20 | Train Loss: 0.598 Vali Loss: 1.206 Vali Acc: 0.490 Test Loss: 1.206 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3764123916625977
Epoch: 6, Steps: 20 | Train Loss: 0.562 Vali Loss: 1.514 Vali Acc: 0.430 Test Loss: 1.514 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.91440749168396
Epoch: 7, Steps: 20 | Train Loss: 0.535 Vali Loss: 1.691 Vali Acc: 0.470 Test Loss: 1.691 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6526243686676025
Epoch: 8, Steps: 20 | Train Loss: 0.488 Vali Loss: 1.579 Vali Acc: 0.480 Test Loss: 1.579 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.548283338546753
Epoch: 9, Steps: 20 | Train Loss: 0.540 Vali Loss: 2.820 Vali Acc: 0.530 Test Loss: 2.820 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.1650121212005615
Epoch: 10, Steps: 20 | Train Loss: 0.804 Vali Loss: 1.652 Vali Acc: 0.540 Test Loss: 1.652 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.183480262756348
Epoch: 11, Steps: 20 | Train Loss: 0.765 Vali Loss: 2.330 Vali Acc: 0.400 Test Loss: 2.330 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.215539932250977
Epoch: 12, Steps: 20 | Train Loss: 0.399 Vali Loss: 1.665 Vali Acc: 0.460 Test Loss: 1.665 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.163068532943726
Epoch: 13, Steps: 20 | Train Loss: 0.446 Vali Loss: 2.039 Vali Acc: 0.570 Test Loss: 2.039 Test Acc: 0.570
Validation loss decreased (-0.539987 --> -0.569980).  Saving model ...
Epoch: 14 cost time: 4.32866096496582
Epoch: 14, Steps: 20 | Train Loss: 0.360 Vali Loss: 2.358 Vali Acc: 0.460 Test Loss: 2.358 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.509609222412109
Epoch: 15, Steps: 20 | Train Loss: 0.301 Vali Loss: 2.529 Vali Acc: 0.540 Test Loss: 2.529 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.07283091545105
Epoch: 16, Steps: 20 | Train Loss: 0.218 Vali Loss: 2.512 Vali Acc: 0.560 Test Loss: 2.512 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.9437179565429688
Epoch: 17, Steps: 20 | Train Loss: 0.423 Vali Loss: 2.687 Vali Acc: 0.520 Test Loss: 2.687 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.31678318977356
Epoch: 18, Steps: 20 | Train Loss: 0.334 Vali Loss: 2.792 Vali Acc: 0.550 Test Loss: 2.792 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.9690370559692383
Epoch: 19, Steps: 20 | Train Loss: 0.303 Vali Loss: 3.492 Vali Acc: 0.490 Test Loss: 3.492 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.001087188720703
Epoch: 20, Steps: 20 | Train Loss: 0.307 Vali Loss: 3.399 Vali Acc: 0.440 Test Loss: 3.399 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.5111849308013916
Epoch: 21, Steps: 20 | Train Loss: 0.377 Vali Loss: 3.734 Vali Acc: 0.520 Test Loss: 3.734 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.228649139404297
Epoch: 22, Steps: 20 | Train Loss: 0.226 Vali Loss: 5.144 Vali Acc: 0.470 Test Loss: 5.144 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.1578075885772705
Epoch: 23, Steps: 20 | Train Loss: 0.275 Vali Loss: 5.388 Vali Acc: 0.430 Test Loss: 5.388 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 372162
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.679215431213379
Epoch: 1, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.776 Vali Acc: 0.540 Test Loss: 0.776 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 5.206897735595703
Epoch: 2, Steps: 20 | Train Loss: 0.765 Vali Loss: 1.009 Vali Acc: 0.440 Test Loss: 1.009 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.05159854888916
Epoch: 3, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.845 Vali Acc: 0.490 Test Loss: 0.845 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.329126596450806
Epoch: 4, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.993 Vali Acc: 0.530 Test Loss: 0.993 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.902362823486328
Epoch: 5, Steps: 20 | Train Loss: 0.592 Vali Loss: 1.091 Vali Acc: 0.530 Test Loss: 1.091 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.73622989654541
Epoch: 6, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.045 Vali Acc: 0.490 Test Loss: 1.045 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.505221128463745
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 1.620 Vali Acc: 0.430 Test Loss: 1.620 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.9351155757904053
Epoch: 8, Steps: 20 | Train Loss: 0.558 Vali Loss: 1.286 Vali Acc: 0.480 Test Loss: 1.286 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.51590371131897
Epoch: 9, Steps: 20 | Train Loss: 0.669 Vali Loss: 2.244 Vali Acc: 0.520 Test Loss: 2.244 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.219174146652222
Epoch: 10, Steps: 20 | Train Loss: 0.844 Vali Loss: 1.433 Vali Acc: 0.530 Test Loss: 1.433 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.19304895401001
Epoch: 11, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.572 Vali Acc: 0.510 Test Loss: 1.572 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 336706
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.1803178787231445
Epoch: 1, Steps: 20 | Train Loss: 0.788 Vali Loss: 0.779 Vali Acc: 0.530 Test Loss: 0.779 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 5.307314872741699
Epoch: 2, Steps: 20 | Train Loss: 0.829 Vali Loss: 0.983 Vali Acc: 0.470 Test Loss: 0.983 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.170246124267578
Epoch: 3, Steps: 20 | Train Loss: 0.712 Vali Loss: 1.003 Vali Acc: 0.490 Test Loss: 1.003 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.854578971862793
Epoch: 4, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.972 Vali Acc: 0.480 Test Loss: 0.972 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.402022838592529
Epoch: 5, Steps: 20 | Train Loss: 0.594 Vali Loss: 1.035 Vali Acc: 0.500 Test Loss: 1.035 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.169314861297607
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 1.169 Vali Acc: 0.480 Test Loss: 1.169 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.4974143505096436
Epoch: 7, Steps: 20 | Train Loss: 0.514 Vali Loss: 1.415 Vali Acc: 0.460 Test Loss: 1.415 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.137473821640015
Epoch: 8, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.984531879425049
Epoch: 9, Steps: 20 | Train Loss: 0.456 Vali Loss: 1.206 Vali Acc: 0.540 Test Loss: 1.206 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539988).  Saving model ...
Epoch: 10 cost time: 4.647013187408447
Epoch: 10, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.567 Vali Acc: 0.510 Test Loss: 1.567 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.801317930221558
Epoch: 11, Steps: 20 | Train Loss: 0.485 Vali Loss: 1.251 Vali Acc: 0.530 Test Loss: 1.251 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.691728115081787
Epoch: 12, Steps: 20 | Train Loss: 0.514 Vali Loss: 1.486 Vali Acc: 0.500 Test Loss: 1.486 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.385451078414917
Epoch: 13, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.646 Vali Acc: 0.510 Test Loss: 1.646 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.2718141078948975
Epoch: 14, Steps: 20 | Train Loss: 0.404 Vali Loss: 1.661 Vali Acc: 0.500 Test Loss: 1.661 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.541962623596191
Epoch: 15, Steps: 20 | Train Loss: 0.299 Vali Loss: 1.720 Vali Acc: 0.520 Test Loss: 1.720 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.001047611236572
Epoch: 16, Steps: 20 | Train Loss: 0.266 Vali Loss: 2.524 Vali Acc: 0.420 Test Loss: 2.524 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.114168643951416
Epoch: 17, Steps: 20 | Train Loss: 0.164 Vali Loss: 2.187 Vali Acc: 0.580 Test Loss: 2.187 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579978).  Saving model ...
Epoch: 18 cost time: 5.032430171966553
Epoch: 18, Steps: 20 | Train Loss: 0.213 Vali Loss: 3.035 Vali Acc: 0.490 Test Loss: 3.035 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.083898067474365
Epoch: 19, Steps: 20 | Train Loss: 0.185 Vali Loss: 2.484 Vali Acc: 0.490 Test Loss: 2.484 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.627000570297241
Epoch: 20, Steps: 20 | Train Loss: 0.193 Vali Loss: 2.447 Vali Acc: 0.530 Test Loss: 2.447 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.759014129638672
Epoch: 21, Steps: 20 | Train Loss: 0.144 Vali Loss: 3.175 Vali Acc: 0.530 Test Loss: 3.175 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.397468090057373
Epoch: 22, Steps: 20 | Train Loss: 0.314 Vali Loss: 2.893 Vali Acc: 0.560 Test Loss: 2.893 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.86603307723999
Epoch: 23, Steps: 20 | Train Loss: 0.120 Vali Loss: 3.152 Vali Acc: 0.460 Test Loss: 3.152 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.747602224349976
Epoch: 24, Steps: 20 | Train Loss: 0.157 Vali Loss: 3.156 Vali Acc: 0.560 Test Loss: 3.156 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.5791730880737305
Epoch: 25, Steps: 20 | Train Loss: 0.362 Vali Loss: 3.613 Vali Acc: 0.480 Test Loss: 3.613 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.066751718521118
Epoch: 26, Steps: 20 | Train Loss: 0.291 Vali Loss: 3.656 Vali Acc: 0.420 Test Loss: 3.656 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.441473960876465
Epoch: 27, Steps: 20 | Train Loss: 0.212 Vali Loss: 3.591 Vali Acc: 0.480 Test Loss: 3.591 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 322626
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.216376304626465
Epoch: 1, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 4.616008281707764
Epoch: 2, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.871 Vali Acc: 0.490 Test Loss: 0.871 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.450725793838501
Epoch: 3, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.907 Vali Acc: 0.500 Test Loss: 0.907 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 4.096848249435425
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 1.015 Vali Acc: 0.510 Test Loss: 1.015 Test Acc: 0.510
Validation loss decreased (-0.499991 --> -0.509990).  Saving model ...
Epoch: 5 cost time: 4.389822721481323
Epoch: 5, Steps: 20 | Train Loss: 0.615 Vali Loss: 1.010 Vali Acc: 0.420 Test Loss: 1.010 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.254436731338501
Epoch: 6, Steps: 20 | Train Loss: 0.562 Vali Loss: 1.018 Vali Acc: 0.530 Test Loss: 1.018 Test Acc: 0.530
Validation loss decreased (-0.509990 --> -0.529990).  Saving model ...
Epoch: 7 cost time: 4.242467641830444
Epoch: 7, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.979 Vali Acc: 0.550 Test Loss: 0.979 Test Acc: 0.550
Validation loss decreased (-0.529990 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 4.344776630401611
Epoch: 8, Steps: 20 | Train Loss: 0.560 Vali Loss: 1.152 Vali Acc: 0.450 Test Loss: 1.152 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.326817035675049
Epoch: 9, Steps: 20 | Train Loss: 0.509 Vali Loss: 1.255 Vali Acc: 0.510 Test Loss: 1.255 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.4388017654418945
Epoch: 10, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.293 Vali Acc: 0.440 Test Loss: 1.293 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.479574918746948
Epoch: 11, Steps: 20 | Train Loss: 0.471 Vali Loss: 1.375 Vali Acc: 0.540 Test Loss: 1.375 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.56467342376709
Epoch: 12, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.408 Vali Acc: 0.530 Test Loss: 1.408 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.37043023109436
Epoch: 13, Steps: 20 | Train Loss: 0.354 Vali Loss: 1.720 Vali Acc: 0.430 Test Loss: 1.720 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.176167726516724
Epoch: 14, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.337 Vali Acc: 0.590 Test Loss: 1.337 Test Acc: 0.590
Validation loss decreased (-0.549990 --> -0.589987).  Saving model ...
Epoch: 15 cost time: 4.0790300369262695
Epoch: 15, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.640 Vali Acc: 0.470 Test Loss: 1.640 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.630859851837158
Epoch: 16, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.713 Vali Acc: 0.500 Test Loss: 1.713 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.0396599769592285
Epoch: 17, Steps: 20 | Train Loss: 0.305 Vali Loss: 2.106 Vali Acc: 0.560 Test Loss: 2.106 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.400091171264648
Epoch: 18, Steps: 20 | Train Loss: 0.277 Vali Loss: 2.044 Vali Acc: 0.550 Test Loss: 2.044 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.288249969482422
Epoch: 19, Steps: 20 | Train Loss: 0.207 Vali Loss: 2.101 Vali Acc: 0.540 Test Loss: 2.101 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.833379745483398
Epoch: 20, Steps: 20 | Train Loss: 0.124 Vali Loss: 2.028 Vali Acc: 0.550 Test Loss: 2.028 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.574894428253174
Epoch: 21, Steps: 20 | Train Loss: 0.128 Vali Loss: 2.268 Vali Acc: 0.550 Test Loss: 2.268 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.778321266174316
Epoch: 22, Steps: 20 | Train Loss: 0.102 Vali Loss: 2.160 Vali Acc: 0.530 Test Loss: 2.160 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.8493547439575195
Epoch: 23, Steps: 20 | Train Loss: 0.177 Vali Loss: 2.644 Vali Acc: 0.470 Test Loss: 2.644 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.9411139488220215
Epoch: 24, Steps: 20 | Train Loss: 0.102 Vali Loss: 2.489 Vali Acc: 0.460 Test Loss: 2.489 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm128_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 301506
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 10.51868462562561
Epoch: 1, Steps: 20 | Train Loss: 0.837 Vali Loss: 1.006 Vali Acc: 0.530 Test Loss: 1.006 Test Acc: 0.530
Validation loss decreased (inf --> -0.529990).  Saving model ...
Epoch: 2 cost time: 8.52672004699707
Epoch: 2, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.816 Vali Acc: 0.560 Test Loss: 0.816 Test Acc: 0.560
Validation loss decreased (-0.529990 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 8.31251859664917
Epoch: 3, Steps: 20 | Train Loss: 0.860 Vali Loss: 1.267 Vali Acc: 0.410 Test Loss: 1.267 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.154367208480835
Epoch: 4, Steps: 20 | Train Loss: 1.306 Vali Loss: 1.444 Vali Acc: 0.480 Test Loss: 1.444 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.103161334991455
Epoch: 5, Steps: 20 | Train Loss: 0.772 Vali Loss: 1.395 Vali Acc: 0.530 Test Loss: 1.395 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.307337522506714
Epoch: 6, Steps: 20 | Train Loss: 1.139 Vali Loss: 2.372 Vali Acc: 0.520 Test Loss: 2.372 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.4171013832092285
Epoch: 7, Steps: 20 | Train Loss: 0.788 Vali Loss: 2.573 Vali Acc: 0.530 Test Loss: 2.573 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.729881525039673
Epoch: 8, Steps: 20 | Train Loss: 0.544 Vali Loss: 2.044 Vali Acc: 0.490 Test Loss: 2.044 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.802978277206421
Epoch: 9, Steps: 20 | Train Loss: 0.634 Vali Loss: 1.809 Vali Acc: 0.560 Test Loss: 1.809 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.263235807418823
Epoch: 10, Steps: 20 | Train Loss: 0.534 Vali Loss: 2.250 Vali Acc: 0.470 Test Loss: 2.250 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.326311588287354
Epoch: 11, Steps: 20 | Train Loss: 0.443 Vali Loss: 2.785 Vali Acc: 0.470 Test Loss: 2.785 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.167174577713013
Epoch: 12, Steps: 20 | Train Loss: 0.393 Vali Loss: 3.303 Vali Acc: 0.490 Test Loss: 3.303 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 329410
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.460197687149048
Epoch: 1, Steps: 20 | Train Loss: 0.786 Vali Loss: 0.833 Vali Acc: 0.530 Test Loss: 0.833 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 4.557218313217163
Epoch: 2, Steps: 20 | Train Loss: 0.976 Vali Loss: 0.982 Vali Acc: 0.520 Test Loss: 0.982 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.491215467453003
Epoch: 3, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.988 Vali Acc: 0.550 Test Loss: 0.988 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549990).  Saving model ...
Epoch: 4 cost time: 4.850573301315308
Epoch: 4, Steps: 20 | Train Loss: 0.735 Vali Loss: 1.318 Vali Acc: 0.460 Test Loss: 1.318 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.926442861557007
Epoch: 5, Steps: 20 | Train Loss: 0.739 Vali Loss: 1.164 Vali Acc: 0.530 Test Loss: 1.164 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.942475318908691
Epoch: 6, Steps: 20 | Train Loss: 0.593 Vali Loss: 1.219 Vali Acc: 0.420 Test Loss: 1.219 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.127198696136475
Epoch: 7, Steps: 20 | Train Loss: 0.488 Vali Loss: 2.256 Vali Acc: 0.520 Test Loss: 2.256 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.354367971420288
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 1.538 Vali Acc: 0.510 Test Loss: 1.538 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.131015300750732
Epoch: 9, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.353 Vali Acc: 0.440 Test Loss: 1.353 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.21084451675415
Epoch: 10, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.523 Vali Acc: 0.480 Test Loss: 1.523 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.258320569992065
Epoch: 11, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.597 Vali Acc: 0.470 Test Loss: 1.597 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.241550445556641
Epoch: 12, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.981 Vali Acc: 0.550 Test Loss: 1.981 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.004179239273071
Epoch: 13, Steps: 20 | Train Loss: 0.248 Vali Loss: 2.515 Vali Acc: 0.470 Test Loss: 2.515 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 239874
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.132789850234985
Epoch: 1, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.738 Vali Acc: 0.540 Test Loss: 0.738 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 4.257401466369629
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.931 Vali Acc: 0.490 Test Loss: 0.931 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.2569966316223145
Epoch: 3, Steps: 20 | Train Loss: 0.785 Vali Loss: 0.977 Vali Acc: 0.450 Test Loss: 0.977 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.282450914382935
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.956 Vali Acc: 0.540 Test Loss: 0.956 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.007042169570923
Epoch: 5, Steps: 20 | Train Loss: 0.607 Vali Loss: 1.158 Vali Acc: 0.540 Test Loss: 1.158 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.984522819519043
Epoch: 6, Steps: 20 | Train Loss: 0.697 Vali Loss: 1.440 Vali Acc: 0.490 Test Loss: 1.440 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.9171295166015625
Epoch: 7, Steps: 20 | Train Loss: 0.506 Vali Loss: 1.188 Vali Acc: 0.550 Test Loss: 1.188 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 5.080921649932861
Epoch: 8, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.427 Vali Acc: 0.480 Test Loss: 1.427 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.17664098739624
Epoch: 9, Steps: 20 | Train Loss: 0.517 Vali Loss: 1.560 Vali Acc: 0.470 Test Loss: 1.560 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.2123799324035645
Epoch: 10, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.753 Vali Acc: 0.440 Test Loss: 1.753 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.966257333755493
Epoch: 11, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.724 Vali Acc: 0.500 Test Loss: 1.724 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.938796043395996
Epoch: 12, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.673 Vali Acc: 0.460 Test Loss: 1.673 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.08089280128479
Epoch: 13, Steps: 20 | Train Loss: 0.244 Vali Loss: 2.096 Vali Acc: 0.480 Test Loss: 2.096 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.046988487243652
Epoch: 14, Steps: 20 | Train Loss: 0.250 Vali Loss: 2.432 Vali Acc: 0.510 Test Loss: 2.432 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.131835699081421
Epoch: 15, Steps: 20 | Train Loss: 0.215 Vali Loss: 2.213 Vali Acc: 0.510 Test Loss: 2.213 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.200122833251953
Epoch: 16, Steps: 20 | Train Loss: 0.221 Vali Loss: 3.228 Vali Acc: 0.490 Test Loss: 3.228 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.207662105560303
Epoch: 17, Steps: 20 | Train Loss: 0.335 Vali Loss: 2.778 Vali Acc: 0.490 Test Loss: 2.778 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 239938
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.579100608825684
Epoch: 1, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.921552896499634
Epoch: 2, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.886 Vali Acc: 0.470 Test Loss: 0.886 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9944961071014404
Epoch: 3, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.848 Vali Acc: 0.530 Test Loss: 0.848 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 4.063198804855347
Epoch: 4, Steps: 20 | Train Loss: 0.619 Vali Loss: 1.094 Vali Acc: 0.500 Test Loss: 1.094 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.204070329666138
Epoch: 5, Steps: 20 | Train Loss: 0.616 Vali Loss: 1.049 Vali Acc: 0.480 Test Loss: 1.049 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.103375434875488
Epoch: 6, Steps: 20 | Train Loss: 0.490 Vali Loss: 1.097 Vali Acc: 0.460 Test Loss: 1.097 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.935534715652466
Epoch: 7, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.148 Vali Acc: 0.520 Test Loss: 1.148 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.093889951705933
Epoch: 8, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.157 Vali Acc: 0.480 Test Loss: 1.157 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.8834288120269775
Epoch: 9, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.466 Vali Acc: 0.480 Test Loss: 1.466 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.824068307876587
Epoch: 10, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.387 Vali Acc: 0.500 Test Loss: 1.387 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.763584852218628
Epoch: 11, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.417 Vali Acc: 0.530 Test Loss: 1.417 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.806241035461426
Epoch: 12, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.484 Vali Acc: 0.490 Test Loss: 1.484 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.6841890811920166
Epoch: 13, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.504 Vali Acc: 0.500 Test Loss: 1.504 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 211330
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.363160610198975
Epoch: 1, Steps: 20 | Train Loss: 0.809 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 3.9514081478118896
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.790 Vali Acc: 0.500 Test Loss: 0.790 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.6072962284088135
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.854 Vali Acc: 0.480 Test Loss: 0.854 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.834860563278198
Epoch: 4, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.973 Vali Acc: 0.520 Test Loss: 0.973 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.954670429229736
Epoch: 5, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.970 Vali Acc: 0.520 Test Loss: 0.970 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.936595439910889
Epoch: 6, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.941 Vali Acc: 0.480 Test Loss: 0.941 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.891581296920776
Epoch: 7, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.972 Vali Acc: 0.510 Test Loss: 0.972 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.037469387054443
Epoch: 8, Steps: 20 | Train Loss: 0.449 Vali Loss: 1.023 Vali Acc: 0.580 Test Loss: 1.023 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579990).  Saving model ...
Epoch: 9 cost time: 5.0727503299713135
Epoch: 9, Steps: 20 | Train Loss: 0.450 Vali Loss: 1.175 Vali Acc: 0.450 Test Loss: 1.175 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.026079177856445
Epoch: 10, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.332 Vali Acc: 0.490 Test Loss: 1.332 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.760349273681641
Epoch: 11, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.156 Vali Acc: 0.450 Test Loss: 1.156 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.728653430938721
Epoch: 12, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.342 Vali Acc: 0.590 Test Loss: 1.342 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589987).  Saving model ...
Epoch: 13 cost time: 4.413921117782593
Epoch: 13, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.576 Vali Acc: 0.550 Test Loss: 1.576 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.365912675857544
Epoch: 14, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.274 Vali Acc: 0.520 Test Loss: 1.274 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.191887617111206
Epoch: 15, Steps: 20 | Train Loss: 0.235 Vali Loss: 1.246 Vali Acc: 0.510 Test Loss: 1.246 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.1943299770355225
Epoch: 16, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.325 Vali Acc: 0.540 Test Loss: 1.325 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.122250556945801
Epoch: 17, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.632 Vali Acc: 0.530 Test Loss: 1.632 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.240366697311401
Epoch: 18, Steps: 20 | Train Loss: 0.136 Vali Loss: 1.689 Vali Acc: 0.510 Test Loss: 1.689 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.800961256027222
Epoch: 19, Steps: 20 | Train Loss: 0.154 Vali Loss: 2.202 Vali Acc: 0.540 Test Loss: 2.202 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.845503330230713
Epoch: 20, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.727 Vali Acc: 0.460 Test Loss: 1.727 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.800799131393433
Epoch: 21, Steps: 20 | Train Loss: 0.160 Vali Loss: 1.936 Vali Acc: 0.450 Test Loss: 1.936 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.8484344482421875
Epoch: 22, Steps: 20 | Train Loss: 0.117 Vali Loss: 1.953 Vali Acc: 0.520 Test Loss: 1.953 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 193602
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.318798303604126
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 4.471132278442383
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.845 Vali Acc: 0.530 Test Loss: 0.845 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 4.416551113128662
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.847 Vali Acc: 0.470 Test Loss: 0.847 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.537500858306885
Epoch: 4, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.849 Vali Acc: 0.520 Test Loss: 0.849 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.876971960067749
Epoch: 5, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.900 Vali Acc: 0.460 Test Loss: 0.900 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.971064567565918
Epoch: 6, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.957 Vali Acc: 0.500 Test Loss: 0.957 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.1831374168396
Epoch: 7, Steps: 20 | Train Loss: 0.539 Vali Loss: 1.008 Vali Acc: 0.460 Test Loss: 1.008 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.014747619628906
Epoch: 8, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.893 Vali Acc: 0.530 Test Loss: 0.893 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.033676862716675
Epoch: 9, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.911 Vali Acc: 0.470 Test Loss: 0.911 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.219011306762695
Epoch: 10, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.180 Vali Acc: 0.490 Test Loss: 1.180 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.167169094085693
Epoch: 11, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.384 Vali Acc: 0.480 Test Loss: 1.384 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.149934530258179
Epoch: 12, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.283 Vali Acc: 0.490 Test Loss: 1.283 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 186562
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.509592771530151
Epoch: 1, Steps: 20 | Train Loss: 0.849 Vali Loss: 0.737 Vali Acc: 0.460 Test Loss: 0.737 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 4.656479358673096
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.808 Vali Acc: 0.470 Test Loss: 0.808 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 4.517826080322266
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.904 Vali Acc: 0.500 Test Loss: 0.904 Test Acc: 0.500
Validation loss decreased (-0.469992 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 5.0030598640441895
Epoch: 4, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 4.958738327026367
Epoch: 5, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 4.626484632492065
Epoch: 6, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.964 Vali Acc: 0.560 Test Loss: 0.964 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559990).  Saving model ...
Epoch: 7 cost time: 5.051904678344727
Epoch: 7, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.857 Vali Acc: 0.520 Test Loss: 0.857 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.8769073486328125
Epoch: 8, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.927 Vali Acc: 0.510 Test Loss: 0.927 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.7776758670806885
Epoch: 9, Steps: 20 | Train Loss: 0.471 Vali Loss: 1.067 Vali Acc: 0.550 Test Loss: 1.067 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.735165596008301
Epoch: 10, Steps: 20 | Train Loss: 0.529 Vali Loss: 1.023 Vali Acc: 0.510 Test Loss: 1.023 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.876511573791504
Epoch: 11, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.865 Vali Acc: 0.540 Test Loss: 0.865 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.20525336265564
Epoch: 12, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.992 Vali Acc: 0.540 Test Loss: 0.992 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.140511989593506
Epoch: 13, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.179 Vali Acc: 0.510 Test Loss: 1.179 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.707751989364624
Epoch: 14, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.064 Vali Acc: 0.540 Test Loss: 1.064 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.4023520946502686
Epoch: 15, Steps: 20 | Train Loss: 0.350 Vali Loss: 1.210 Vali Acc: 0.550 Test Loss: 1.210 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.465108633041382
Epoch: 16, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.169 Vali Acc: 0.530 Test Loss: 1.169 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 176002
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.956252098083496
Epoch: 1, Steps: 20 | Train Loss: 0.900 Vali Loss: 0.819 Vali Acc: 0.450 Test Loss: 0.819 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 6.329289436340332
Epoch: 2, Steps: 20 | Train Loss: 0.869 Vali Loss: 1.536 Vali Acc: 0.510 Test Loss: 1.536 Test Acc: 0.510
Validation loss decreased (-0.449992 --> -0.509985).  Saving model ...
Epoch: 3 cost time: 6.313179969787598
Epoch: 3, Steps: 20 | Train Loss: 0.822 Vali Loss: 0.920 Vali Acc: 0.540 Test Loss: 0.920 Test Acc: 0.540
Validation loss decreased (-0.509985 --> -0.539991).  Saving model ...
Epoch: 4 cost time: 5.719375371932983
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 1.190 Vali Acc: 0.510 Test Loss: 1.190 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.717347860336304
Epoch: 5, Steps: 20 | Train Loss: 0.797 Vali Loss: 1.427 Vali Acc: 0.530 Test Loss: 1.427 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.578150272369385
Epoch: 6, Steps: 20 | Train Loss: 0.796 Vali Loss: 1.930 Vali Acc: 0.430 Test Loss: 1.930 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.226897478103638
Epoch: 7, Steps: 20 | Train Loss: 0.679 Vali Loss: 1.364 Vali Acc: 0.550 Test Loss: 1.364 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549986).  Saving model ...
Epoch: 8 cost time: 5.940077781677246
Epoch: 8, Steps: 20 | Train Loss: 0.773 Vali Loss: 2.786 Vali Acc: 0.510 Test Loss: 2.786 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.588855504989624
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 2.869 Vali Acc: 0.520 Test Loss: 2.869 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.370155334472656
Epoch: 10, Steps: 20 | Train Loss: 0.480 Vali Loss: 2.483 Vali Acc: 0.500 Test Loss: 2.483 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.507063865661621
Epoch: 11, Steps: 20 | Train Loss: 0.495 Vali Loss: 2.834 Vali Acc: 0.540 Test Loss: 2.834 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.473541259765625
Epoch: 12, Steps: 20 | Train Loss: 0.494 Vali Loss: 3.337 Vali Acc: 0.510 Test Loss: 3.337 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.515789985656738
Epoch: 13, Steps: 20 | Train Loss: 0.544 Vali Loss: 2.864 Vali Acc: 0.530 Test Loss: 2.864 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.23063850402832
Epoch: 14, Steps: 20 | Train Loss: 0.430 Vali Loss: 3.452 Vali Acc: 0.500 Test Loss: 3.452 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.216917514801025
Epoch: 15, Steps: 20 | Train Loss: 0.379 Vali Loss: 3.411 Vali Acc: 0.490 Test Loss: 3.411 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.011104583740234
Epoch: 16, Steps: 20 | Train Loss: 0.182 Vali Loss: 3.704 Vali Acc: 0.540 Test Loss: 3.704 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.135430574417114
Epoch: 17, Steps: 20 | Train Loss: 0.496 Vali Loss: 6.806 Vali Acc: 0.520 Test Loss: 6.806 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 279874
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.4859747886657715
Epoch: 1, Steps: 20 | Train Loss: 0.837 Vali Loss: 0.815 Vali Acc: 0.460 Test Loss: 0.815 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 3.7699620723724365
Epoch: 2, Steps: 20 | Train Loss: 0.839 Vali Loss: 0.888 Vali Acc: 0.530 Test Loss: 0.888 Test Acc: 0.530
Validation loss decreased (-0.459992 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 3.7280972003936768
Epoch: 3, Steps: 20 | Train Loss: 0.665 Vali Loss: 1.157 Vali Acc: 0.520 Test Loss: 1.157 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8770060539245605
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.941 Vali Acc: 0.470 Test Loss: 0.941 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8855485916137695
Epoch: 5, Steps: 20 | Train Loss: 0.593 Vali Loss: 1.025 Vali Acc: 0.510 Test Loss: 1.025 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.892620086669922
Epoch: 6, Steps: 20 | Train Loss: 0.541 Vali Loss: 1.014 Vali Acc: 0.500 Test Loss: 1.014 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.877056121826172
Epoch: 7, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.060 Vali Acc: 0.540 Test Loss: 1.060 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539989).  Saving model ...
Epoch: 8 cost time: 3.628898859024048
Epoch: 8, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.800218105316162
Epoch: 9, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.393 Vali Acc: 0.520 Test Loss: 1.393 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5376548767089844
Epoch: 10, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.578 Vali Acc: 0.470 Test Loss: 1.578 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.568707227706909
Epoch: 11, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.966 Vali Acc: 0.550 Test Loss: 1.966 Test Acc: 0.550
Validation loss decreased (-0.539989 --> -0.549980).  Saving model ...
Epoch: 12 cost time: 3.7226767539978027
Epoch: 12, Steps: 20 | Train Loss: 0.621 Vali Loss: 2.412 Vali Acc: 0.500 Test Loss: 2.412 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5893402099609375
Epoch: 13, Steps: 20 | Train Loss: 0.207 Vali Loss: 2.253 Vali Acc: 0.530 Test Loss: 2.253 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4511525630950928
Epoch: 14, Steps: 20 | Train Loss: 0.277 Vali Loss: 2.056 Vali Acc: 0.490 Test Loss: 2.056 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2445454597473145
Epoch: 15, Steps: 20 | Train Loss: 0.305 Vali Loss: 2.506 Vali Acc: 0.530 Test Loss: 2.506 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.5281763076782227
Epoch: 16, Steps: 20 | Train Loss: 0.288 Vali Loss: 3.420 Vali Acc: 0.500 Test Loss: 3.420 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.7280454635620117
Epoch: 17, Steps: 20 | Train Loss: 0.334 Vali Loss: 2.866 Vali Acc: 0.500 Test Loss: 2.866 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.269091367721558
Epoch: 18, Steps: 20 | Train Loss: 0.193 Vali Loss: 3.147 Vali Acc: 0.480 Test Loss: 3.147 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.217293739318848
Epoch: 19, Steps: 20 | Train Loss: 0.193 Vali Loss: 3.235 Vali Acc: 0.470 Test Loss: 3.235 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.252901792526245
Epoch: 20, Steps: 20 | Train Loss: 0.149 Vali Loss: 3.548 Vali Acc: 0.490 Test Loss: 3.548 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.233981132507324
Epoch: 21, Steps: 20 | Train Loss: 0.152 Vali Loss: 3.457 Vali Acc: 0.480 Test Loss: 3.457 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 190338
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.991816997528076
Epoch: 1, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.832 Vali Acc: 0.490 Test Loss: 0.832 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 4.04219388961792
Epoch: 2, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.851 Vali Acc: 0.490 Test Loss: 0.851 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.781318187713623
Epoch: 3, Steps: 20 | Train Loss: 0.803 Vali Loss: 1.185 Vali Acc: 0.440 Test Loss: 1.185 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.993274211883545
Epoch: 4, Steps: 20 | Train Loss: 0.940 Vali Loss: 1.279 Vali Acc: 0.460 Test Loss: 1.279 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7958357334136963
Epoch: 5, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.997 Vali Acc: 0.510 Test Loss: 0.997 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509990).  Saving model ...
Epoch: 6 cost time: 3.4675915241241455
Epoch: 6, Steps: 20 | Train Loss: 0.597 Vali Loss: 1.132 Vali Acc: 0.490 Test Loss: 1.132 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.567392587661743
Epoch: 7, Steps: 20 | Train Loss: 0.571 Vali Loss: 1.272 Vali Acc: 0.520 Test Loss: 1.272 Test Acc: 0.520
Validation loss decreased (-0.509990 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 3.5544445514678955
Epoch: 8, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.246 Vali Acc: 0.470 Test Loss: 1.246 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.33522367477417
Epoch: 9, Steps: 20 | Train Loss: 0.514 Vali Loss: 1.402 Vali Acc: 0.480 Test Loss: 1.402 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7840209007263184
Epoch: 10, Steps: 20 | Train Loss: 0.452 Vali Loss: 1.657 Vali Acc: 0.530 Test Loss: 1.657 Test Acc: 0.530
Validation loss decreased (-0.519987 --> -0.529983).  Saving model ...
Epoch: 11 cost time: 3.735436201095581
Epoch: 11, Steps: 20 | Train Loss: 0.479 Vali Loss: 1.464 Vali Acc: 0.460 Test Loss: 1.464 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.00740909576416
Epoch: 12, Steps: 20 | Train Loss: 0.436 Vali Loss: 2.014 Vali Acc: 0.500 Test Loss: 2.014 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.064066171646118
Epoch: 13, Steps: 20 | Train Loss: 0.299 Vali Loss: 2.011 Vali Acc: 0.500 Test Loss: 2.011 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.134173393249512
Epoch: 14, Steps: 20 | Train Loss: 0.264 Vali Loss: 2.162 Vali Acc: 0.500 Test Loss: 2.162 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.9243202209472656
Epoch: 15, Steps: 20 | Train Loss: 0.261 Vali Loss: 2.009 Vali Acc: 0.500 Test Loss: 2.009 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.06307053565979
Epoch: 16, Steps: 20 | Train Loss: 0.176 Vali Loss: 2.180 Vali Acc: 0.520 Test Loss: 2.180 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.918947219848633
Epoch: 17, Steps: 20 | Train Loss: 0.189 Vali Loss: 2.434 Vali Acc: 0.500 Test Loss: 2.434 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.653928279876709
Epoch: 18, Steps: 20 | Train Loss: 0.268 Vali Loss: 2.459 Vali Acc: 0.510 Test Loss: 2.459 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.769578456878662
Epoch: 19, Steps: 20 | Train Loss: 0.135 Vali Loss: 2.806 Vali Acc: 0.520 Test Loss: 2.806 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.8607351779937744
Epoch: 20, Steps: 20 | Train Loss: 0.294 Vali Loss: 2.575 Vali Acc: 0.550 Test Loss: 2.575 Test Acc: 0.550
Validation loss decreased (-0.529983 --> -0.549974).  Saving model ...
Epoch: 21 cost time: 4.0036280155181885
Epoch: 21, Steps: 20 | Train Loss: 0.105 Vali Loss: 4.091 Vali Acc: 0.480 Test Loss: 4.091 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4729676246643066
Epoch: 22, Steps: 20 | Train Loss: 0.100 Vali Loss: 3.500 Vali Acc: 0.500 Test Loss: 3.500 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.6539602279663086
Epoch: 23, Steps: 20 | Train Loss: 0.094 Vali Loss: 4.325 Vali Acc: 0.520 Test Loss: 4.325 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.622603178024292
Epoch: 24, Steps: 20 | Train Loss: 0.103 Vali Loss: 4.070 Vali Acc: 0.460 Test Loss: 4.070 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.4549593925476074
Epoch: 25, Steps: 20 | Train Loss: 0.153 Vali Loss: 4.510 Vali Acc: 0.460 Test Loss: 4.510 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.7042717933654785
Epoch: 26, Steps: 20 | Train Loss: 0.128 Vali Loss: 4.062 Vali Acc: 0.570 Test Loss: 4.062 Test Acc: 0.570
Validation loss decreased (-0.549974 --> -0.569959).  Saving model ...
Epoch: 27 cost time: 3.9749958515167236
Epoch: 27, Steps: 20 | Train Loss: 0.110 Vali Loss: 4.763 Vali Acc: 0.490 Test Loss: 4.763 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.989152193069458
Epoch: 28, Steps: 20 | Train Loss: 0.221 Vali Loss: 5.246 Vali Acc: 0.470 Test Loss: 5.246 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.744107961654663
Epoch: 29, Steps: 20 | Train Loss: 0.092 Vali Loss: 4.302 Vali Acc: 0.540 Test Loss: 4.302 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.776968479156494
Epoch: 30, Steps: 20 | Train Loss: 0.071 Vali Loss: 5.894 Vali Acc: 0.460 Test Loss: 5.894 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.010124444961548
Epoch: 31, Steps: 20 | Train Loss: 0.093 Vali Loss: 5.974 Vali Acc: 0.450 Test Loss: 5.974 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.9823222160339355
Epoch: 32, Steps: 20 | Train Loss: 0.087 Vali Loss: 4.999 Vali Acc: 0.470 Test Loss: 4.999 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.9101595878601074
Epoch: 33, Steps: 20 | Train Loss: 0.102 Vali Loss: 4.743 Vali Acc: 0.550 Test Loss: 4.743 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.6732146739959717
Epoch: 34, Steps: 20 | Train Loss: 0.052 Vali Loss: 5.172 Vali Acc: 0.440 Test Loss: 5.172 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.774651527404785
Epoch: 35, Steps: 20 | Train Loss: 0.041 Vali Loss: 5.259 Vali Acc: 0.480 Test Loss: 5.259 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.044629812240601
Epoch: 36, Steps: 20 | Train Loss: 0.077 Vali Loss: 5.684 Vali Acc: 0.480 Test Loss: 5.684 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 190402
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.910391807556152
Epoch: 1, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.782 Vali Acc: 0.480 Test Loss: 0.782 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 3.182060956954956
Epoch: 2, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.841 Vali Acc: 0.490 Test Loss: 0.841 Test Acc: 0.490
Validation loss decreased (-0.479992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 3.0033364295959473
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.898 Vali Acc: 0.540 Test Loss: 0.898 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539991).  Saving model ...
Epoch: 4 cost time: 2.059800624847412
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 1.035 Vali Acc: 0.540 Test Loss: 1.035 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.555584192276001
Epoch: 5, Steps: 20 | Train Loss: 0.642 Vali Loss: 1.157 Vali Acc: 0.520 Test Loss: 1.157 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4742560386657715
Epoch: 6, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.932 Vali Acc: 0.540 Test Loss: 0.932 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5816004276275635
Epoch: 7, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.021 Vali Acc: 0.550 Test Loss: 1.021 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 3.102489948272705
Epoch: 8, Steps: 20 | Train Loss: 0.468 Vali Loss: 1.441 Vali Acc: 0.490 Test Loss: 1.441 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9924919605255127
Epoch: 9, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.419 Vali Acc: 0.510 Test Loss: 1.419 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9339237213134766
Epoch: 10, Steps: 20 | Train Loss: 0.452 Vali Loss: 1.729 Vali Acc: 0.510 Test Loss: 1.729 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8779702186584473
Epoch: 11, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.514 Vali Acc: 0.550 Test Loss: 1.514 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8068346977233887
Epoch: 12, Steps: 20 | Train Loss: 0.399 Vali Loss: 1.682 Vali Acc: 0.470 Test Loss: 1.682 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.643242597579956
Epoch: 13, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.686 Vali Acc: 0.440 Test Loss: 1.686 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.958101511001587
Epoch: 14, Steps: 20 | Train Loss: 0.210 Vali Loss: 1.455 Vali Acc: 0.540 Test Loss: 1.455 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.782113552093506
Epoch: 15, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.731 Vali Acc: 0.510 Test Loss: 1.731 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.0771358013153076
Epoch: 16, Steps: 20 | Train Loss: 0.262 Vali Loss: 2.239 Vali Acc: 0.460 Test Loss: 2.239 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.1834664344787598
Epoch: 17, Steps: 20 | Train Loss: 0.172 Vali Loss: 1.854 Vali Acc: 0.480 Test Loss: 1.854 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 161794
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.537159204483032
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.845 Vali Acc: 0.480 Test Loss: 0.845 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 3.5099682807922363
Epoch: 2, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 3.511880874633789
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.903 Vali Acc: 0.500 Test Loss: 0.903 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5009615421295166
Epoch: 4, Steps: 20 | Train Loss: 0.643 Vali Loss: 1.090 Vali Acc: 0.500 Test Loss: 1.090 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.761512041091919
Epoch: 5, Steps: 20 | Train Loss: 0.649 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.649998426437378
Epoch: 6, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.937 Vali Acc: 0.500 Test Loss: 0.937 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.714535713195801
Epoch: 7, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.6723177433013916
Epoch: 8, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529991).  Saving model ...
Epoch: 9 cost time: 3.6291697025299072
Epoch: 9, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.078 Vali Acc: 0.440 Test Loss: 1.078 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.217710256576538
Epoch: 10, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.012 Vali Acc: 0.510 Test Loss: 1.012 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.184473752975464
Epoch: 11, Steps: 20 | Train Loss: 0.398 Vali Loss: 1.142 Vali Acc: 0.480 Test Loss: 1.142 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.937378406524658
Epoch: 12, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.387 Vali Acc: 0.540 Test Loss: 1.387 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539986).  Saving model ...
Epoch: 13 cost time: 3.3664588928222656
Epoch: 13, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.483 Vali Acc: 0.530 Test Loss: 1.483 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0673577785491943
Epoch: 14, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.235 Vali Acc: 0.480 Test Loss: 1.235 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7079315185546875
Epoch: 15, Steps: 20 | Train Loss: 0.350 Vali Loss: 1.713 Vali Acc: 0.510 Test Loss: 1.713 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.623090982437134
Epoch: 16, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.661 Vali Acc: 0.480 Test Loss: 1.661 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.649054765701294
Epoch: 17, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.370 Vali Acc: 0.520 Test Loss: 1.370 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.687211036682129
Epoch: 18, Steps: 20 | Train Loss: 0.231 Vali Loss: 1.625 Vali Acc: 0.530 Test Loss: 1.625 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.808828115463257
Epoch: 19, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.592 Vali Acc: 0.490 Test Loss: 1.592 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.5824520587921143
Epoch: 20, Steps: 20 | Train Loss: 0.117 Vali Loss: 1.676 Vali Acc: 0.530 Test Loss: 1.676 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.8444724082946777
Epoch: 21, Steps: 20 | Train Loss: 0.099 Vali Loss: 1.892 Vali Acc: 0.480 Test Loss: 1.892 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.7627220153808594
Epoch: 22, Steps: 20 | Train Loss: 0.151 Vali Loss: 1.653 Vali Acc: 0.590 Test Loss: 1.653 Test Acc: 0.590
Validation loss decreased (-0.539986 --> -0.589983).  Saving model ...
Epoch: 23 cost time: 3.6556081771850586
Epoch: 23, Steps: 20 | Train Loss: 0.122 Vali Loss: 2.140 Vali Acc: 0.450 Test Loss: 2.140 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.183568000793457
Epoch: 24, Steps: 20 | Train Loss: 0.143 Vali Loss: 1.822 Vali Acc: 0.540 Test Loss: 1.822 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.471144914627075
Epoch: 25, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.882 Vali Acc: 0.530 Test Loss: 1.882 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.630802869796753
Epoch: 26, Steps: 20 | Train Loss: 0.060 Vali Loss: 2.071 Vali Acc: 0.470 Test Loss: 2.071 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.4572293758392334
Epoch: 27, Steps: 20 | Train Loss: 0.181 Vali Loss: 2.547 Vali Acc: 0.560 Test Loss: 2.547 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.7008283138275146
Epoch: 28, Steps: 20 | Train Loss: 0.205 Vali Loss: 2.852 Vali Acc: 0.530 Test Loss: 2.852 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.4865617752075195
Epoch: 29, Steps: 20 | Train Loss: 0.114 Vali Loss: 2.353 Vali Acc: 0.550 Test Loss: 2.353 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.623176097869873
Epoch: 30, Steps: 20 | Train Loss: 0.097 Vali Loss: 3.048 Vali Acc: 0.510 Test Loss: 3.048 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.4935407638549805
Epoch: 31, Steps: 20 | Train Loss: 0.081 Vali Loss: 2.412 Vali Acc: 0.490 Test Loss: 2.412 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.2319014072418213
Epoch: 32, Steps: 20 | Train Loss: 0.087 Vali Loss: 2.055 Vali Acc: 0.520 Test Loss: 2.055 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 144066
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.077409982681274
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.737 Vali Acc: 0.540 Test Loss: 0.737 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 3.169450521469116
Epoch: 2, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.784 Vali Acc: 0.480 Test Loss: 0.784 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2442524433135986
Epoch: 3, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.826 Vali Acc: 0.550 Test Loss: 0.826 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 3.21958065032959
Epoch: 4, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.774 Vali Acc: 0.560 Test Loss: 0.774 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 5 cost time: 3.0654501914978027
Epoch: 5, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.924 Vali Acc: 0.460 Test Loss: 0.924 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.133059024810791
Epoch: 6, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.882 Vali Acc: 0.560 Test Loss: 0.882 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2376279830932617
Epoch: 7, Steps: 20 | Train Loss: 0.583 Vali Loss: 1.046 Vali Acc: 0.470 Test Loss: 1.046 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.357490301132202
Epoch: 8, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.016 Vali Acc: 0.520 Test Loss: 1.016 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.638963460922241
Epoch: 9, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.917 Vali Acc: 0.500 Test Loss: 0.917 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.7189853191375732
Epoch: 10, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.196 Vali Acc: 0.470 Test Loss: 1.196 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.722566604614258
Epoch: 11, Steps: 20 | Train Loss: 0.395 Vali Loss: 1.171 Vali Acc: 0.530 Test Loss: 1.171 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.6666183471679688
Epoch: 12, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.098 Vali Acc: 0.530 Test Loss: 1.098 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1704013347625732
Epoch: 13, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.133 Vali Acc: 0.550 Test Loss: 1.133 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.7861080169677734
Epoch: 14, Steps: 20 | Train Loss: 0.296 Vali Loss: 0.958 Vali Acc: 0.520 Test Loss: 0.958 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 137026
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.193593978881836
Epoch: 1, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.781 Vali Acc: 0.510 Test Loss: 0.781 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.6258702278137207
Epoch: 2, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.853 Vali Acc: 0.550 Test Loss: 0.853 Test Acc: 0.550
Validation loss decreased (-0.509992 --> -0.549991).  Saving model ...
Epoch: 3 cost time: 3.6805195808410645
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.889 Vali Acc: 0.520 Test Loss: 0.889 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.912208318710327
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.634035348892212
Epoch: 5, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.784 Vali Acc: 0.540 Test Loss: 0.784 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.740841865539551
Epoch: 6, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.910 Vali Acc: 0.520 Test Loss: 0.910 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.746661901473999
Epoch: 7, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.868 Vali Acc: 0.530 Test Loss: 0.868 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.6459507942199707
Epoch: 8, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.882 Vali Acc: 0.510 Test Loss: 0.882 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.4201393127441406
Epoch: 9, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.844 Vali Acc: 0.560 Test Loss: 0.844 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 3.424184560775757
Epoch: 10, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.912 Vali Acc: 0.500 Test Loss: 0.912 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.506026029586792
Epoch: 11, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.122 Vali Acc: 0.520 Test Loss: 1.122 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.630340814590454
Epoch: 12, Steps: 20 | Train Loss: 0.448 Vali Loss: 1.069 Vali Acc: 0.540 Test Loss: 1.069 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.439004898071289
Epoch: 13, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.034 Vali Acc: 0.550 Test Loss: 1.034 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.5098190307617188
Epoch: 14, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.158 Vali Acc: 0.560 Test Loss: 1.158 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.799131155014038
Epoch: 15, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.080 Vali Acc: 0.550 Test Loss: 1.080 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.514432191848755
Epoch: 16, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.146 Vali Acc: 0.540 Test Loss: 1.146 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.3357534408569336
Epoch: 17, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.186 Vali Acc: 0.520 Test Loss: 1.186 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.3403799533843994
Epoch: 18, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.130 Vali Acc: 0.570 Test Loss: 1.130 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569989).  Saving model ...
Epoch: 19 cost time: 3.447044849395752
Epoch: 19, Steps: 20 | Train Loss: 0.240 Vali Loss: 1.263 Vali Acc: 0.530 Test Loss: 1.263 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.769106864929199
Epoch: 20, Steps: 20 | Train Loss: 0.231 Vali Loss: 1.747 Vali Acc: 0.480 Test Loss: 1.747 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.8918256759643555
Epoch: 21, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.746 Vali Acc: 0.560 Test Loss: 1.746 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.639345645904541
Epoch: 22, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.437 Vali Acc: 0.540 Test Loss: 1.437 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.67872953414917
Epoch: 23, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.476 Vali Acc: 0.490 Test Loss: 1.476 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.7143759727478027
Epoch: 24, Steps: 20 | Train Loss: 0.163 Vali Loss: 1.416 Vali Acc: 0.530 Test Loss: 1.416 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.548588991165161
Epoch: 25, Steps: 20 | Train Loss: 0.101 Vali Loss: 1.580 Vali Acc: 0.500 Test Loss: 1.580 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.2168009281158447
Epoch: 26, Steps: 20 | Train Loss: 0.073 Vali Loss: 1.770 Vali Acc: 0.500 Test Loss: 1.770 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.715693235397339
Epoch: 27, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.935 Vali Acc: 0.560 Test Loss: 1.935 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.2502646446228027
Epoch: 28, Steps: 20 | Train Loss: 0.073 Vali Loss: 1.951 Vali Acc: 0.500 Test Loss: 1.951 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 126466
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.93369460105896
Epoch: 1, Steps: 20 | Train Loss: 0.985 Vali Loss: 0.928 Vali Acc: 0.550 Test Loss: 0.928 Test Acc: 0.550
Validation loss decreased (inf --> -0.549991).  Saving model ...
Epoch: 2 cost time: 6.176632881164551
Epoch: 2, Steps: 20 | Train Loss: 0.884 Vali Loss: 1.040 Vali Acc: 0.490 Test Loss: 1.040 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.182788848876953
Epoch: 3, Steps: 20 | Train Loss: 0.838 Vali Loss: 1.512 Vali Acc: 0.470 Test Loss: 1.512 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.981992721557617
Epoch: 4, Steps: 20 | Train Loss: 0.602 Vali Loss: 1.179 Vali Acc: 0.570 Test Loss: 1.179 Test Acc: 0.570
Validation loss decreased (-0.549991 --> -0.569988).  Saving model ...
Epoch: 5 cost time: 6.1149420738220215
Epoch: 5, Steps: 20 | Train Loss: 1.014 Vali Loss: 3.435 Vali Acc: 0.510 Test Loss: 3.435 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.715012788772583
Epoch: 6, Steps: 20 | Train Loss: 0.877 Vali Loss: 1.577 Vali Acc: 0.550 Test Loss: 1.577 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.183568000793457
Epoch: 7, Steps: 20 | Train Loss: 0.758 Vali Loss: 1.735 Vali Acc: 0.540 Test Loss: 1.735 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.365342140197754
Epoch: 8, Steps: 20 | Train Loss: 0.622 Vali Loss: 2.268 Vali Acc: 0.480 Test Loss: 2.268 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.613171577453613
Epoch: 9, Steps: 20 | Train Loss: 1.023 Vali Loss: 2.674 Vali Acc: 0.520 Test Loss: 2.674 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.65453577041626
Epoch: 10, Steps: 20 | Train Loss: 0.726 Vali Loss: 3.426 Vali Acc: 0.450 Test Loss: 3.426 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.310881853103638
Epoch: 11, Steps: 20 | Train Loss: 0.512 Vali Loss: 2.573 Vali Acc: 0.500 Test Loss: 2.573 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.287893533706665
Epoch: 12, Steps: 20 | Train Loss: 0.576 Vali Loss: 4.230 Vali Acc: 0.520 Test Loss: 4.230 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.453906774520874
Epoch: 13, Steps: 20 | Train Loss: 0.838 Vali Loss: 2.505 Vali Acc: 0.510 Test Loss: 2.505 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.837728500366211
Epoch: 14, Steps: 20 | Train Loss: 0.266 Vali Loss: 3.501 Vali Acc: 0.530 Test Loss: 3.501 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 255106
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.296313047409058
Epoch: 1, Steps: 20 | Train Loss: 0.859 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 5.5456929206848145
Epoch: 2, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.862 Vali Acc: 0.500 Test Loss: 0.862 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.49886155128479
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.74889874458313
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 1.141 Vali Acc: 0.520 Test Loss: 1.141 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.753255605697632
Epoch: 5, Steps: 20 | Train Loss: 0.526 Vali Loss: 1.057 Vali Acc: 0.520 Test Loss: 1.057 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.780160665512085
Epoch: 6, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.278 Vali Acc: 0.530 Test Loss: 1.278 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529987).  Saving model ...
Epoch: 7 cost time: 4.480309963226318
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 1.103 Vali Acc: 0.510 Test Loss: 1.103 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.962097644805908
Epoch: 8, Steps: 20 | Train Loss: 0.920 Vali Loss: 2.907 Vali Acc: 0.510 Test Loss: 2.907 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.160831451416016
Epoch: 9, Steps: 20 | Train Loss: 0.701 Vali Loss: 1.474 Vali Acc: 0.510 Test Loss: 1.474 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.800248384475708
Epoch: 10, Steps: 20 | Train Loss: 0.479 Vali Loss: 1.574 Vali Acc: 0.460 Test Loss: 1.574 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.9651408195495605
Epoch: 11, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.710 Vali Acc: 0.460 Test Loss: 1.710 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.468693733215332
Epoch: 12, Steps: 20 | Train Loss: 0.333 Vali Loss: 2.028 Vali Acc: 0.490 Test Loss: 2.028 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.551860809326172
Epoch: 13, Steps: 20 | Train Loss: 0.430 Vali Loss: 2.000 Vali Acc: 0.510 Test Loss: 2.000 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.807375192642212
Epoch: 14, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.981 Vali Acc: 0.520 Test Loss: 1.981 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.015775203704834
Epoch: 15, Steps: 20 | Train Loss: 0.261 Vali Loss: 2.192 Vali Acc: 0.520 Test Loss: 2.192 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.197881698608398
Epoch: 16, Steps: 20 | Train Loss: 0.300 Vali Loss: 2.739 Vali Acc: 0.460 Test Loss: 2.739 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 165570
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.668042421340942
Epoch: 1, Steps: 20 | Train Loss: 0.798 Vali Loss: 0.880 Vali Acc: 0.500 Test Loss: 0.880 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 4.960648775100708
Epoch: 2, Steps: 20 | Train Loss: 0.791 Vali Loss: 1.235 Vali Acc: 0.520 Test Loss: 1.235 Test Acc: 0.520
Validation loss decreased (-0.499991 --> -0.519988).  Saving model ...
Epoch: 3 cost time: 4.841342210769653
Epoch: 3, Steps: 20 | Train Loss: 0.799 Vali Loss: 1.165 Vali Acc: 0.500 Test Loss: 1.165 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.818737030029297
Epoch: 4, Steps: 20 | Train Loss: 0.639 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.16180157661438
Epoch: 5, Steps: 20 | Train Loss: 0.832 Vali Loss: 1.112 Vali Acc: 0.430 Test Loss: 1.112 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.297349691390991
Epoch: 6, Steps: 20 | Train Loss: 0.935 Vali Loss: 1.351 Vali Acc: 0.480 Test Loss: 1.351 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.32182765007019
Epoch: 7, Steps: 20 | Train Loss: 0.667 Vali Loss: 1.531 Vali Acc: 0.530 Test Loss: 1.531 Test Acc: 0.530
Validation loss decreased (-0.519988 --> -0.529985).  Saving model ...
Epoch: 8 cost time: 5.072414398193359
Epoch: 8, Steps: 20 | Train Loss: 0.607 Vali Loss: 2.069 Vali Acc: 0.450 Test Loss: 2.069 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.770940542221069
Epoch: 9, Steps: 20 | Train Loss: 0.561 Vali Loss: 1.307 Vali Acc: 0.470 Test Loss: 1.307 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.786115407943726
Epoch: 10, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.599 Vali Acc: 0.490 Test Loss: 1.599 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.650943279266357
Epoch: 11, Steps: 20 | Train Loss: 0.406 Vali Loss: 1.970 Vali Acc: 0.500 Test Loss: 1.970 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.536946535110474
Epoch: 12, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.950 Vali Acc: 0.390 Test Loss: 1.950 Test Acc: 0.390
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.481858730316162
Epoch: 13, Steps: 20 | Train Loss: 0.312 Vali Loss: 2.094 Vali Acc: 0.520 Test Loss: 2.094 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.712045907974243
Epoch: 14, Steps: 20 | Train Loss: 0.322 Vali Loss: 2.392 Vali Acc: 0.540 Test Loss: 2.392 Test Acc: 0.540
Validation loss decreased (-0.529985 --> -0.539976).  Saving model ...
Epoch: 15 cost time: 4.8859028816223145
Epoch: 15, Steps: 20 | Train Loss: 0.249 Vali Loss: 2.065 Vali Acc: 0.520 Test Loss: 2.065 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.883108854293823
Epoch: 16, Steps: 20 | Train Loss: 0.213 Vali Loss: 2.346 Vali Acc: 0.490 Test Loss: 2.346 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.56386661529541
Epoch: 17, Steps: 20 | Train Loss: 0.311 Vali Loss: 2.657 Vali Acc: 0.510 Test Loss: 2.657 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.2498321533203125
Epoch: 18, Steps: 20 | Train Loss: 0.175 Vali Loss: 2.261 Vali Acc: 0.560 Test Loss: 2.261 Test Acc: 0.560
Validation loss decreased (-0.539976 --> -0.559977).  Saving model ...
Epoch: 19 cost time: 4.60282301902771
Epoch: 19, Steps: 20 | Train Loss: 0.282 Vali Loss: 3.419 Vali Acc: 0.500 Test Loss: 3.419 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.7491090297698975
Epoch: 20, Steps: 20 | Train Loss: 0.199 Vali Loss: 3.632 Vali Acc: 0.530 Test Loss: 3.632 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.722651481628418
Epoch: 21, Steps: 20 | Train Loss: 0.177 Vali Loss: 3.716 Vali Acc: 0.460 Test Loss: 3.716 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.755683422088623
Epoch: 22, Steps: 20 | Train Loss: 0.172 Vali Loss: 3.676 Vali Acc: 0.450 Test Loss: 3.676 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.784672021865845
Epoch: 23, Steps: 20 | Train Loss: 0.217 Vali Loss: 4.123 Vali Acc: 0.520 Test Loss: 4.123 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.720548152923584
Epoch: 24, Steps: 20 | Train Loss: 0.144 Vali Loss: 3.572 Vali Acc: 0.510 Test Loss: 3.572 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.596872806549072
Epoch: 25, Steps: 20 | Train Loss: 0.195 Vali Loss: 4.410 Vali Acc: 0.470 Test Loss: 4.410 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.430458068847656
Epoch: 26, Steps: 20 | Train Loss: 0.081 Vali Loss: 4.095 Vali Acc: 0.480 Test Loss: 4.095 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.277907848358154
Epoch: 27, Steps: 20 | Train Loss: 0.152 Vali Loss: 3.864 Vali Acc: 0.520 Test Loss: 3.864 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.07651948928833
Epoch: 28, Steps: 20 | Train Loss: 0.159 Vali Loss: 4.532 Vali Acc: 0.530 Test Loss: 4.532 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 165634
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.992917060852051
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.909 Vali Acc: 0.500 Test Loss: 0.909 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 4.411869764328003
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.880 Vali Acc: 0.430 Test Loss: 0.880 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.675676584243774
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.861 Vali Acc: 0.530 Test Loss: 0.861 Test Acc: 0.530
Validation loss decreased (-0.499991 --> -0.529991).  Saving model ...
Epoch: 4 cost time: 4.686699628829956
Epoch: 4, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.906 Vali Acc: 0.500 Test Loss: 0.906 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.442960023880005
Epoch: 5, Steps: 20 | Train Loss: 0.555 Vali Loss: 1.289 Vali Acc: 0.500 Test Loss: 1.289 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.314399242401123
Epoch: 6, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.925 Vali Acc: 0.560 Test Loss: 0.925 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559991).  Saving model ...
Epoch: 7 cost time: 4.571038246154785
Epoch: 7, Steps: 20 | Train Loss: 0.523 Vali Loss: 1.371 Vali Acc: 0.410 Test Loss: 1.371 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.7587573528289795
Epoch: 8, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.226 Vali Acc: 0.520 Test Loss: 1.226 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.5181097984313965
Epoch: 9, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.169 Vali Acc: 0.520 Test Loss: 1.169 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.311249494552612
Epoch: 10, Steps: 20 | Train Loss: 0.427 Vali Loss: 1.520 Vali Acc: 0.470 Test Loss: 1.520 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.417608737945557
Epoch: 11, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.335 Vali Acc: 0.510 Test Loss: 1.335 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.1909565925598145
Epoch: 12, Steps: 20 | Train Loss: 0.273 Vali Loss: 1.525 Vali Acc: 0.500 Test Loss: 1.525 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.062053442001343
Epoch: 13, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.285 Vali Acc: 0.560 Test Loss: 1.285 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.275942802429199
Epoch: 14, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.321 Vali Acc: 0.550 Test Loss: 1.321 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.2728400230407715
Epoch: 15, Steps: 20 | Train Loss: 0.275 Vali Loss: 1.682 Vali Acc: 0.520 Test Loss: 1.682 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.3573973178863525
Epoch: 16, Steps: 20 | Train Loss: 0.351 Vali Loss: 2.005 Vali Acc: 0.570 Test Loss: 2.005 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569980).  Saving model ...
Epoch: 17 cost time: 4.397787570953369
Epoch: 17, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.956 Vali Acc: 0.520 Test Loss: 1.956 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.514692783355713
Epoch: 18, Steps: 20 | Train Loss: 0.195 Vali Loss: 2.096 Vali Acc: 0.490 Test Loss: 2.096 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.539533615112305
Epoch: 19, Steps: 20 | Train Loss: 0.190 Vali Loss: 1.953 Vali Acc: 0.510 Test Loss: 1.953 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.464601993560791
Epoch: 20, Steps: 20 | Train Loss: 0.123 Vali Loss: 1.907 Vali Acc: 0.520 Test Loss: 1.907 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.395113945007324
Epoch: 21, Steps: 20 | Train Loss: 0.157 Vali Loss: 2.111 Vali Acc: 0.570 Test Loss: 2.111 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.96988844871521
Epoch: 22, Steps: 20 | Train Loss: 0.100 Vali Loss: 2.541 Vali Acc: 0.510 Test Loss: 2.541 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.12493896484375
Epoch: 23, Steps: 20 | Train Loss: 0.163 Vali Loss: 2.448 Vali Acc: 0.570 Test Loss: 2.448 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.4260571002960205
Epoch: 24, Steps: 20 | Train Loss: 0.071 Vali Loss: 2.585 Vali Acc: 0.520 Test Loss: 2.585 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.3411383628845215
Epoch: 25, Steps: 20 | Train Loss: 0.090 Vali Loss: 3.106 Vali Acc: 0.430 Test Loss: 3.106 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.449889898300171
Epoch: 26, Steps: 20 | Train Loss: 0.049 Vali Loss: 2.906 Vali Acc: 0.520 Test Loss: 2.906 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 137026
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.8011322021484375
Epoch: 1, Steps: 20 | Train Loss: 0.798 Vali Loss: 0.839 Vali Acc: 0.520 Test Loss: 0.839 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 3.8494653701782227
Epoch: 2, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.737373113632202
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.842 Vali Acc: 0.530 Test Loss: 0.842 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 3.967747211456299
Epoch: 4, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.994 Vali Acc: 0.580 Test Loss: 0.994 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579990).  Saving model ...
Epoch: 5 cost time: 3.6012818813323975
Epoch: 5, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.850 Vali Acc: 0.560 Test Loss: 0.850 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.13031268119812
Epoch: 6, Steps: 20 | Train Loss: 0.580 Vali Loss: 1.170 Vali Acc: 0.530 Test Loss: 1.170 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.040520429611206
Epoch: 7, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.947 Vali Acc: 0.560 Test Loss: 0.947 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.115890741348267
Epoch: 8, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.932 Vali Acc: 0.560 Test Loss: 0.932 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.079921722412109
Epoch: 9, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.452 Vali Acc: 0.520 Test Loss: 1.452 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.195937633514404
Epoch: 10, Steps: 20 | Train Loss: 0.516 Vali Loss: 1.312 Vali Acc: 0.530 Test Loss: 1.312 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.1085524559021
Epoch: 11, Steps: 20 | Train Loss: 0.414 Vali Loss: 1.384 Vali Acc: 0.490 Test Loss: 1.384 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.9728176593780518
Epoch: 12, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.267 Vali Acc: 0.490 Test Loss: 1.267 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.9632058143615723
Epoch: 13, Steps: 20 | Train Loss: 0.552 Vali Loss: 1.401 Vali Acc: 0.520 Test Loss: 1.401 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.8302292823791504
Epoch: 14, Steps: 20 | Train Loss: 0.389 Vali Loss: 1.618 Vali Acc: 0.450 Test Loss: 1.618 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 119298
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.538561582565308
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.684 Vali Acc: 0.600 Test Loss: 0.684 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 3.3271639347076416
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.746 Vali Acc: 0.530 Test Loss: 0.746 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5719399452209473
Epoch: 3, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.832 Vali Acc: 0.570 Test Loss: 0.832 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5531747341156006
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.513497829437256
Epoch: 5, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.863 Vali Acc: 0.570 Test Loss: 0.863 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.6408815383911133
Epoch: 6, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.931 Vali Acc: 0.480 Test Loss: 0.931 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.514061212539673
Epoch: 7, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.984 Vali Acc: 0.510 Test Loss: 0.984 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.616940975189209
Epoch: 8, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.878 Vali Acc: 0.520 Test Loss: 0.878 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.527019739151001
Epoch: 9, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.929 Vali Acc: 0.530 Test Loss: 0.929 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.647408962249756
Epoch: 10, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.964 Vali Acc: 0.500 Test Loss: 0.964 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.5791444778442383
Epoch: 11, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.975 Vali Acc: 0.520 Test Loss: 0.975 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 112258
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.236279726028442
Epoch: 1, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.024536371231079
Epoch: 2, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.453486442565918
Epoch: 3, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.862 Vali Acc: 0.490 Test Loss: 0.862 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.382908821105957
Epoch: 4, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.896 Vali Acc: 0.490 Test Loss: 0.896 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.034487009048462
Epoch: 5, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.908 Vali Acc: 0.500 Test Loss: 0.908 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.472673177719116
Epoch: 6, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.895 Vali Acc: 0.570 Test Loss: 0.895 Test Acc: 0.570
Validation loss decreased (-0.499992 --> -0.569991).  Saving model ...
Epoch: 7 cost time: 2.9144909381866455
Epoch: 7, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.940 Vali Acc: 0.530 Test Loss: 0.940 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6975514888763428
Epoch: 8, Steps: 20 | Train Loss: 0.581 Vali Loss: 1.008 Vali Acc: 0.570 Test Loss: 1.008 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.019874334335327
Epoch: 9, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.958 Vali Acc: 0.560 Test Loss: 0.958 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1527509689331055
Epoch: 10, Steps: 20 | Train Loss: 0.514 Vali Loss: 1.097 Vali Acc: 0.560 Test Loss: 1.097 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.1966216564178467
Epoch: 11, Steps: 20 | Train Loss: 0.509 Vali Loss: 1.007 Vali Acc: 0.570 Test Loss: 1.007 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.4685444831848145
Epoch: 12, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.078 Vali Acc: 0.470 Test Loss: 1.078 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9653329849243164
Epoch: 13, Steps: 20 | Train Loss: 0.414 Vali Loss: 1.124 Vali Acc: 0.470 Test Loss: 1.124 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.0555665493011475
Epoch: 14, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.468 Vali Acc: 0.540 Test Loss: 1.468 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.2972025871276855
Epoch: 15, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.083 Vali Acc: 0.520 Test Loss: 1.083 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.769019842147827
Epoch: 16, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.404 Vali Acc: 0.530 Test Loss: 1.404 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm64_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 101698
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.809279441833496
Epoch: 1, Steps: 20 | Train Loss: 0.842 Vali Loss: 0.933 Vali Acc: 0.490 Test Loss: 0.933 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 2.9825620651245117
Epoch: 2, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.898 Vali Acc: 0.500 Test Loss: 0.898 Test Acc: 0.500
Validation loss decreased (-0.489991 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 3.038180112838745
Epoch: 3, Steps: 20 | Train Loss: 0.943 Vali Loss: 1.833 Vali Acc: 0.500 Test Loss: 1.833 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0212361812591553
Epoch: 4, Steps: 20 | Train Loss: 0.978 Vali Loss: 1.341 Vali Acc: 0.400 Test Loss: 1.341 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0705792903900146
Epoch: 5, Steps: 20 | Train Loss: 0.651 Vali Loss: 1.229 Vali Acc: 0.520 Test Loss: 1.229 Test Acc: 0.520
Validation loss decreased (-0.499991 --> -0.519988).  Saving model ...
Epoch: 6 cost time: 2.8740127086639404
Epoch: 6, Steps: 20 | Train Loss: 0.682 Vali Loss: 1.206 Vali Acc: 0.510 Test Loss: 1.206 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7040765285491943
Epoch: 7, Steps: 20 | Train Loss: 0.582 Vali Loss: 1.220 Vali Acc: 0.420 Test Loss: 1.220 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7028603553771973
Epoch: 8, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.887 Vali Acc: 0.550 Test Loss: 1.887 Test Acc: 0.550
Validation loss decreased (-0.519988 --> -0.549981).  Saving model ...
Epoch: 9 cost time: 2.9056789875030518
Epoch: 9, Steps: 20 | Train Loss: 0.499 Vali Loss: 1.722 Vali Acc: 0.490 Test Loss: 1.722 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7085719108581543
Epoch: 10, Steps: 20 | Train Loss: 0.446 Vali Loss: 1.707 Vali Acc: 0.480 Test Loss: 1.707 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.096644878387451
Epoch: 11, Steps: 20 | Train Loss: 0.259 Vali Loss: 2.168 Vali Acc: 0.450 Test Loss: 2.168 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.134187698364258
Epoch: 12, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.538 Vali Acc: 0.540 Test Loss: 1.538 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.027958869934082
Epoch: 13, Steps: 20 | Train Loss: 0.348 Vali Loss: 2.332 Vali Acc: 0.540 Test Loss: 2.332 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.835081100463867
Epoch: 14, Steps: 20 | Train Loss: 0.354 Vali Loss: 2.683 Vali Acc: 0.510 Test Loss: 2.683 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.1336536407470703
Epoch: 15, Steps: 20 | Train Loss: 0.213 Vali Loss: 2.531 Vali Acc: 0.440 Test Loss: 2.531 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9562156200408936
Epoch: 16, Steps: 20 | Train Loss: 0.150 Vali Loss: 2.313 Vali Acc: 0.470 Test Loss: 2.313 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.0200541019439697
Epoch: 17, Steps: 20 | Train Loss: 0.096 Vali Loss: 2.956 Vali Acc: 0.490 Test Loss: 2.956 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.156677007675171
Epoch: 18, Steps: 20 | Train Loss: 0.108 Vali Loss: 3.282 Vali Acc: 0.500 Test Loss: 3.282 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 152802
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.660791873931885
Epoch: 1, Steps: 20 | Train Loss: 0.782 Vali Loss: 0.809 Vali Acc: 0.500 Test Loss: 0.809 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.427684783935547
Epoch: 2, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.848 Vali Acc: 0.560 Test Loss: 0.848 Test Acc: 0.560
Validation loss decreased (-0.499992 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 2.395911455154419
Epoch: 3, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.824 Vali Acc: 0.570 Test Loss: 0.824 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 2.4399702548980713
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.861 Vali Acc: 0.500 Test Loss: 0.861 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.573800802230835
Epoch: 5, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.935 Vali Acc: 0.530 Test Loss: 0.935 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5699048042297363
Epoch: 6, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.968 Vali Acc: 0.550 Test Loss: 0.968 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.484954833984375
Epoch: 7, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.954 Vali Acc: 0.470 Test Loss: 0.954 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5189626216888428
Epoch: 8, Steps: 20 | Train Loss: 0.487 Vali Loss: 1.251 Vali Acc: 0.480 Test Loss: 1.251 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.4864108562469482
Epoch: 9, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.138 Vali Acc: 0.490 Test Loss: 1.138 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.484220266342163
Epoch: 10, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.071 Vali Acc: 0.490 Test Loss: 1.071 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.551959753036499
Epoch: 11, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.203 Vali Acc: 0.460 Test Loss: 1.203 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5456559658050537
Epoch: 12, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.200 Vali Acc: 0.520 Test Loss: 1.200 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7828481197357178
Epoch: 13, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.283 Vali Acc: 0.470 Test Loss: 1.283 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 108034
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.414015054702759
Epoch: 1, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.758 Vali Acc: 0.530 Test Loss: 0.758 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.329075574874878
Epoch: 2, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.887 Vali Acc: 0.490 Test Loss: 0.887 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4150350093841553
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.820 Vali Acc: 0.490 Test Loss: 0.820 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6411778926849365
Epoch: 4, Steps: 20 | Train Loss: 0.604 Vali Loss: 1.001 Vali Acc: 0.480 Test Loss: 1.001 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.649397850036621
Epoch: 5, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.878 Vali Acc: 0.520 Test Loss: 0.878 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5873773097991943
Epoch: 6, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.985 Vali Acc: 0.470 Test Loss: 0.985 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5227203369140625
Epoch: 7, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.942 Vali Acc: 0.490 Test Loss: 0.942 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.621246576309204
Epoch: 8, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.162 Vali Acc: 0.530 Test Loss: 1.162 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.5467917919158936
Epoch: 9, Steps: 20 | Train Loss: 0.398 Vali Loss: 1.028 Vali Acc: 0.530 Test Loss: 1.028 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.638467788696289
Epoch: 10, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.241 Vali Acc: 0.510 Test Loss: 1.241 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4044156074523926
Epoch: 11, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 108066
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5282773971557617
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.943223237991333
Epoch: 2, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.715 Vali Acc: 0.560 Test Loss: 0.715 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.0254065990448
Epoch: 3, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.961 Vali Acc: 0.520 Test Loss: 0.961 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9955389499664307
Epoch: 4, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.950 Vali Acc: 0.480 Test Loss: 0.950 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.888913869857788
Epoch: 5, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.817 Vali Acc: 0.480 Test Loss: 0.817 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9168546199798584
Epoch: 6, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.809 Vali Acc: 0.520 Test Loss: 0.809 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.753049612045288
Epoch: 7, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.841 Vali Acc: 0.480 Test Loss: 0.841 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8044753074645996
Epoch: 8, Steps: 20 | Train Loss: 0.446 Vali Loss: 1.114 Vali Acc: 0.530 Test Loss: 1.114 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8112585544586182
Epoch: 9, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.130 Vali Acc: 0.510 Test Loss: 1.130 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8877108097076416
Epoch: 10, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.140 Vali Acc: 0.540 Test Loss: 1.140 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.97996187210083
Epoch: 11, Steps: 20 | Train Loss: 0.394 Vali Loss: 0.989 Vali Acc: 0.550 Test Loss: 0.989 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0596935749053955
Epoch: 12, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.148 Vali Acc: 0.460 Test Loss: 1.148 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 93762
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.868919372558594
Epoch: 1, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.572464942932129
Epoch: 2, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 2.962329626083374
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.842 Vali Acc: 0.500 Test Loss: 0.842 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1637330055236816
Epoch: 4, Steps: 20 | Train Loss: 0.640 Vali Loss: 1.055 Vali Acc: 0.490 Test Loss: 1.055 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3880770206451416
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.163450002670288
Epoch: 6, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.907 Vali Acc: 0.460 Test Loss: 0.907 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.179241418838501
Epoch: 7, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.918 Vali Acc: 0.500 Test Loss: 0.918 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.028029680252075
Epoch: 8, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.890 Vali Acc: 0.480 Test Loss: 0.890 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.8485710620880127
Epoch: 9, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.892 Vali Acc: 0.510 Test Loss: 0.892 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.083669424057007
Epoch: 10, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.957 Vali Acc: 0.470 Test Loss: 0.957 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.3222646713256836
Epoch: 11, Steps: 20 | Train Loss: 0.427 Vali Loss: 1.007 Vali Acc: 0.470 Test Loss: 1.007 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.0816097259521484
Epoch: 12, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.881 Vali Acc: 0.570 Test Loss: 0.881 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 13 cost time: 3.021130323410034
Epoch: 13, Steps: 20 | Train Loss: 0.370 Vali Loss: 1.018 Vali Acc: 0.510 Test Loss: 1.018 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6391470432281494
Epoch: 14, Steps: 20 | Train Loss: 0.339 Vali Loss: 0.982 Vali Acc: 0.500 Test Loss: 0.982 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1269774436950684
Epoch: 15, Steps: 20 | Train Loss: 0.317 Vali Loss: 0.955 Vali Acc: 0.560 Test Loss: 0.955 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.4827451705932617
Epoch: 16, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.655780076980591
Epoch: 17, Steps: 20 | Train Loss: 0.254 Vali Loss: 1.279 Vali Acc: 0.480 Test Loss: 1.279 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.8168094158172607
Epoch: 18, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.045 Vali Acc: 0.560 Test Loss: 1.045 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.190911054611206
Epoch: 19, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.172 Vali Acc: 0.510 Test Loss: 1.172 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.187664747238159
Epoch: 20, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.264 Vali Acc: 0.480 Test Loss: 1.264 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.687817096710205
Epoch: 21, Steps: 20 | Train Loss: 0.158 Vali Loss: 1.280 Vali Acc: 0.540 Test Loss: 1.280 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.0789413452148438
Epoch: 22, Steps: 20 | Train Loss: 0.172 Vali Loss: 1.282 Vali Acc: 0.490 Test Loss: 1.282 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 84898
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.497824668884277
Epoch: 1, Steps: 20 | Train Loss: 0.805 Vali Loss: 0.734 Vali Acc: 0.580 Test Loss: 0.734 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.785785436630249
Epoch: 2, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1089394092559814
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.781 Vali Acc: 0.490 Test Loss: 0.781 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2584073543548584
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.810 Vali Acc: 0.530 Test Loss: 0.810 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.332617998123169
Epoch: 5, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.659623622894287
Epoch: 6, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.846 Vali Acc: 0.520 Test Loss: 0.846 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.600879192352295
Epoch: 7, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.859 Vali Acc: 0.510 Test Loss: 0.859 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.5577104091644287
Epoch: 8, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.912 Vali Acc: 0.530 Test Loss: 0.912 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.9002840518951416
Epoch: 9, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.845 Vali Acc: 0.460 Test Loss: 0.845 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.09622859954834
Epoch: 10, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.830 Vali Acc: 0.530 Test Loss: 0.830 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.380635976791382
Epoch: 11, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.994 Vali Acc: 0.450 Test Loss: 0.994 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 81378
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5847764015197754
Epoch: 1, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.697 Vali Acc: 0.560 Test Loss: 0.697 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.6389009952545166
Epoch: 2, Steps: 20 | Train Loss: 0.782 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7157151699066162
Epoch: 3, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.710 Vali Acc: 0.540 Test Loss: 0.710 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8505361080169678
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8641998767852783
Epoch: 5, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8750176429748535
Epoch: 6, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7256464958190918
Epoch: 7, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.782 Vali Acc: 0.530 Test Loss: 0.782 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8746209144592285
Epoch: 8, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8281865119934082
Epoch: 9, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8102436065673828
Epoch: 10, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.802 Vali Acc: 0.490 Test Loss: 0.802 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.92604660987854
Epoch: 11, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 76098
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.558529615402222
Epoch: 1, Steps: 20 | Train Loss: 0.850 Vali Loss: 0.904 Vali Acc: 0.500 Test Loss: 0.904 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 2.4536097049713135
Epoch: 2, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.898 Vali Acc: 0.560 Test Loss: 0.898 Test Acc: 0.560
Validation loss decreased (-0.499991 --> -0.559991).  Saving model ...
Epoch: 3 cost time: 2.7251553535461426
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 1.125 Vali Acc: 0.510 Test Loss: 1.125 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.344637870788574
Epoch: 4, Steps: 20 | Train Loss: 0.646 Vali Loss: 1.033 Vali Acc: 0.500 Test Loss: 1.033 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5020532608032227
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.970 Vali Acc: 0.450 Test Loss: 0.970 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5317554473876953
Epoch: 6, Steps: 20 | Train Loss: 0.506 Vali Loss: 1.569 Vali Acc: 0.520 Test Loss: 1.569 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3103556632995605
Epoch: 7, Steps: 20 | Train Loss: 0.488 Vali Loss: 1.151 Vali Acc: 0.490 Test Loss: 1.151 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6255781650543213
Epoch: 8, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.918 Vali Acc: 0.510 Test Loss: 1.918 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.468130350112915
Epoch: 9, Steps: 20 | Train Loss: 0.506 Vali Loss: 1.432 Vali Acc: 0.480 Test Loss: 1.432 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.837784767150879
Epoch: 10, Steps: 20 | Train Loss: 0.577 Vali Loss: 1.525 Vali Acc: 0.490 Test Loss: 1.525 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.624850273132324
Epoch: 11, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.854 Vali Acc: 0.460 Test Loss: 1.854 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.7881968021392822
Epoch: 12, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.964 Vali Acc: 0.490 Test Loss: 1.964 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 127842
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.754031181335449
Epoch: 1, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 2.0795159339904785
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.775 Vali Acc: 0.470 Test Loss: 0.775 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0500879287719727
Epoch: 3, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.846 Vali Acc: 0.490 Test Loss: 0.846 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.121249198913574
Epoch: 4, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.976 Vali Acc: 0.510 Test Loss: 0.976 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1692147254943848
Epoch: 5, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.915 Vali Acc: 0.550 Test Loss: 0.915 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 2.2246124744415283
Epoch: 6, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.916 Vali Acc: 0.470 Test Loss: 0.916 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.125594139099121
Epoch: 7, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.898 Vali Acc: 0.470 Test Loss: 0.898 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2761287689208984
Epoch: 8, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.192 Vali Acc: 0.490 Test Loss: 1.192 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0183191299438477
Epoch: 9, Steps: 20 | Train Loss: 0.574 Vali Loss: 1.047 Vali Acc: 0.420 Test Loss: 1.047 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.064516544342041
Epoch: 10, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.021 Vali Acc: 0.460 Test Loss: 1.021 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.158719778060913
Epoch: 11, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.097 Vali Acc: 0.490 Test Loss: 1.097 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2025229930877686
Epoch: 12, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.358 Vali Acc: 0.490 Test Loss: 1.358 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.075106143951416
Epoch: 13, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.144 Vali Acc: 0.470 Test Loss: 1.144 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2237913608551025
Epoch: 14, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.552 Vali Acc: 0.500 Test Loss: 1.552 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1578547954559326
Epoch: 15, Steps: 20 | Train Loss: 0.196 Vali Loss: 1.578 Vali Acc: 0.490 Test Loss: 1.578 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 83074
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6845295429229736
Epoch: 1, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.915501594543457
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.803 Vali Acc: 0.440 Test Loss: 0.803 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0398435592651367
Epoch: 3, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 2.1010899543762207
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 1.016 Vali Acc: 0.450 Test Loss: 1.016 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9504423141479492
Epoch: 5, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.958 Vali Acc: 0.540 Test Loss: 0.958 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539990).  Saving model ...
Epoch: 6 cost time: 1.9568543434143066
Epoch: 6, Steps: 20 | Train Loss: 0.530 Vali Loss: 1.000 Vali Acc: 0.500 Test Loss: 1.000 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9541964530944824
Epoch: 7, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.875 Vali Acc: 0.510 Test Loss: 0.875 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0714354515075684
Epoch: 8, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.033 Vali Acc: 0.520 Test Loss: 1.033 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0571656227111816
Epoch: 9, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.084 Vali Acc: 0.510 Test Loss: 1.084 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.097902774810791
Epoch: 10, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.059 Vali Acc: 0.510 Test Loss: 1.059 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.122265338897705
Epoch: 11, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.049 Vali Acc: 0.520 Test Loss: 1.049 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.174269676208496
Epoch: 12, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.319 Vali Acc: 0.540 Test Loss: 1.319 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2642319202423096
Epoch: 13, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.183 Vali Acc: 0.560 Test Loss: 1.183 Test Acc: 0.560
Validation loss decreased (-0.539990 --> -0.559988).  Saving model ...
Epoch: 14 cost time: 2.1131207942962646
Epoch: 14, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.470 Vali Acc: 0.490 Test Loss: 1.470 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9312779903411865
Epoch: 15, Steps: 20 | Train Loss: 0.182 Vali Loss: 1.224 Vali Acc: 0.550 Test Loss: 1.224 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1729042530059814
Epoch: 16, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.482 Vali Acc: 0.460 Test Loss: 1.482 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0697181224823
Epoch: 17, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.447 Vali Acc: 0.460 Test Loss: 1.447 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9406044483184814
Epoch: 18, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.954 Vali Acc: 0.530 Test Loss: 1.954 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9726080894470215
Epoch: 19, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.690 Vali Acc: 0.560 Test Loss: 1.690 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.074692487716675
Epoch: 20, Steps: 20 | Train Loss: 0.109 Vali Loss: 1.908 Vali Acc: 0.510 Test Loss: 1.908 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.00108003616333
Epoch: 21, Steps: 20 | Train Loss: 0.118 Vali Loss: 1.941 Vali Acc: 0.550 Test Loss: 1.941 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0037808418273926
Epoch: 22, Steps: 20 | Train Loss: 0.094 Vali Loss: 1.943 Vali Acc: 0.530 Test Loss: 1.943 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1345672607421875
Epoch: 23, Steps: 20 | Train Loss: 0.112 Vali Loss: 2.588 Vali Acc: 0.530 Test Loss: 2.588 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 83106
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.921084403991699
Epoch: 1, Steps: 20 | Train Loss: 0.784 Vali Loss: 0.682 Vali Acc: 0.540 Test Loss: 0.682 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.7400000095367432
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.767 Vali Acc: 0.570 Test Loss: 0.767 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 1.7773184776306152
Epoch: 3, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.790 Vali Acc: 0.490 Test Loss: 0.790 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9807584285736084
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.891 Vali Acc: 0.510 Test Loss: 0.891 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9375455379486084
Epoch: 5, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.828 Vali Acc: 0.520 Test Loss: 0.828 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9425048828125
Epoch: 6, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.894 Vali Acc: 0.470 Test Loss: 0.894 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7341008186340332
Epoch: 7, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.882 Vali Acc: 0.540 Test Loss: 0.882 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6640331745147705
Epoch: 8, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.865 Vali Acc: 0.520 Test Loss: 0.865 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.879274606704712
Epoch: 9, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.906 Vali Acc: 0.510 Test Loss: 0.906 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.722071886062622
Epoch: 10, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.092 Vali Acc: 0.560 Test Loss: 1.092 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8410563468933105
Epoch: 11, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.139 Vali Acc: 0.480 Test Loss: 1.139 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7504808902740479
Epoch: 12, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.045 Vali Acc: 0.560 Test Loss: 1.045 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 68802
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.892138719558716
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 3.6045262813568115
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.680 Vali Acc: 0.520 Test Loss: 0.680 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5557143688201904
Epoch: 3, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5465471744537354
Epoch: 4, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.868 Vali Acc: 0.510 Test Loss: 0.868 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.418544292449951
Epoch: 5, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.792 Vali Acc: 0.530 Test Loss: 0.792 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.20843243598938
Epoch: 6, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.4927313327789307
Epoch: 7, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.803 Vali Acc: 0.470 Test Loss: 0.803 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.110680341720581
Epoch: 8, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.343585968017578
Epoch: 9, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.896 Vali Acc: 0.530 Test Loss: 0.896 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.612560749053955
Epoch: 10, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.820 Vali Acc: 0.490 Test Loss: 0.820 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.678154230117798
Epoch: 11, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.997 Vali Acc: 0.460 Test Loss: 0.997 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 59938
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.118015289306641
Epoch: 1, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.179835557937622
Epoch: 2, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.762 Vali Acc: 0.480 Test Loss: 0.762 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.565690279006958
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.809 Vali Acc: 0.460 Test Loss: 0.809 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1634044647216797
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.810 Vali Acc: 0.490 Test Loss: 0.810 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2661123275756836
Epoch: 5, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.883 Vali Acc: 0.490 Test Loss: 0.883 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.4175169467926025
Epoch: 6, Steps: 20 | Train Loss: 0.615 Vali Loss: 1.043 Vali Acc: 0.500 Test Loss: 1.043 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.709742307662964
Epoch: 7, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.864 Vali Acc: 0.480 Test Loss: 0.864 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.6878716945648193
Epoch: 8, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.822 Vali Acc: 0.510 Test Loss: 0.822 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 9 cost time: 3.507253885269165
Epoch: 9, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.876 Vali Acc: 0.470 Test Loss: 0.876 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4838526248931885
Epoch: 10, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.949 Vali Acc: 0.540 Test Loss: 0.949 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539991).  Saving model ...
Epoch: 11 cost time: 3.9042911529541016
Epoch: 11, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.973 Vali Acc: 0.560 Test Loss: 0.973 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559990).  Saving model ...
Epoch: 12 cost time: 3.833655834197998
Epoch: 12, Steps: 20 | Train Loss: 0.466 Vali Loss: 1.033 Vali Acc: 0.500 Test Loss: 1.033 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.652421474456787
Epoch: 13, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.875 Vali Acc: 0.540 Test Loss: 0.875 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.72012996673584
Epoch: 14, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.839 Vali Acc: 0.530 Test Loss: 0.839 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.157452583312988
Epoch: 15, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.976 Vali Acc: 0.510 Test Loss: 0.976 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.157975196838379
Epoch: 16, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.001 Vali Acc: 0.500 Test Loss: 1.001 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.6582131385803223
Epoch: 17, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.980 Vali Acc: 0.510 Test Loss: 0.980 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.4231011867523193
Epoch: 18, Steps: 20 | Train Loss: 0.299 Vali Loss: 1.176 Vali Acc: 0.520 Test Loss: 1.176 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.5384368896484375
Epoch: 19, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.123 Vali Acc: 0.490 Test Loss: 1.123 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.864011287689209
Epoch: 20, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.098 Vali Acc: 0.480 Test Loss: 1.098 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.3607614040374756
Epoch: 21, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.067 Vali Acc: 0.470 Test Loss: 1.067 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 56418
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.37955904006958
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.7585558891296387
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.755 Vali Acc: 0.480 Test Loss: 0.755 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.011507987976074
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.8450736999511719
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.759 Vali Acc: 0.540 Test Loss: 0.759 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 2.082469940185547
Epoch: 5, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7743241786956787
Epoch: 6, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8261663913726807
Epoch: 7, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.792 Vali Acc: 0.510 Test Loss: 0.792 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.831709861755371
Epoch: 8, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.898 Vali Acc: 0.550 Test Loss: 0.898 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549991).  Saving model ...
Epoch: 9 cost time: 1.794865608215332
Epoch: 9, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8252460956573486
Epoch: 10, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7621686458587646
Epoch: 11, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.852 Vali Acc: 0.540 Test Loss: 0.852 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.825336217880249
Epoch: 12, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.866 Vali Acc: 0.550 Test Loss: 0.866 Test Acc: 0.550
Validation loss decreased (-0.549991 --> -0.549991).  Saving model ...
Epoch: 13 cost time: 1.7359404563903809
Epoch: 13, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.892 Vali Acc: 0.540 Test Loss: 0.892 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7960216999053955
Epoch: 14, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.858 Vali Acc: 0.570 Test Loss: 0.858 Test Acc: 0.570
Validation loss decreased (-0.549991 --> -0.569991).  Saving model ...
Epoch: 15 cost time: 1.8882238864898682
Epoch: 15, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.851 Vali Acc: 0.560 Test Loss: 0.851 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8956489562988281
Epoch: 16, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.890 Vali Acc: 0.570 Test Loss: 0.890 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.884751319885254
Epoch: 17, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.184 Vali Acc: 0.570 Test Loss: 1.184 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9611718654632568
Epoch: 18, Steps: 20 | Train Loss: 0.374 Vali Loss: 0.913 Vali Acc: 0.550 Test Loss: 0.913 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.840341567993164
Epoch: 19, Steps: 20 | Train Loss: 0.345 Vali Loss: 0.933 Vali Acc: 0.550 Test Loss: 0.933 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8586387634277344
Epoch: 20, Steps: 20 | Train Loss: 0.350 Vali Loss: 0.997 Vali Acc: 0.510 Test Loss: 0.997 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8230595588684082
Epoch: 21, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.160 Vali Acc: 0.490 Test Loss: 1.160 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8603613376617432
Epoch: 22, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.039 Vali Acc: 0.490 Test Loss: 1.039 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8030273914337158
Epoch: 23, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.091 Vali Acc: 0.510 Test Loss: 1.091 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7607603073120117
Epoch: 24, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.187 Vali Acc: 0.550 Test Loss: 1.187 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 51138
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.860684871673584
Epoch: 1, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.916 Vali Acc: 0.530 Test Loss: 0.916 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 3.271660089492798
Epoch: 2, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.851 Vali Acc: 0.510 Test Loss: 0.851 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.007960081100464
Epoch: 3, Steps: 20 | Train Loss: 0.641 Vali Loss: 1.190 Vali Acc: 0.490 Test Loss: 1.190 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.266129732131958
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.826 Vali Acc: 0.570 Test Loss: 0.826 Test Acc: 0.570
Validation loss decreased (-0.529991 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 4.343317747116089
Epoch: 5, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.969 Vali Acc: 0.420 Test Loss: 0.969 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.138524293899536
Epoch: 6, Steps: 20 | Train Loss: 0.516 Vali Loss: 1.027 Vali Acc: 0.570 Test Loss: 1.027 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.122086524963379
Epoch: 7, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.191 Vali Acc: 0.520 Test Loss: 1.191 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.9497718811035156
Epoch: 8, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.381 Vali Acc: 0.580 Test Loss: 1.381 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579986).  Saving model ...
Epoch: 9 cost time: 3.8551790714263916
Epoch: 9, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.342 Vali Acc: 0.550 Test Loss: 1.342 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9114017486572266
Epoch: 10, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.624 Vali Acc: 0.580 Test Loss: 1.624 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.322930812835693
Epoch: 11, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.452 Vali Acc: 0.500 Test Loss: 1.452 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.46484899520874
Epoch: 12, Steps: 20 | Train Loss: 0.315 Vali Loss: 1.686 Vali Acc: 0.510 Test Loss: 1.686 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.199171543121338
Epoch: 13, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.783 Vali Acc: 0.460 Test Loss: 1.783 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.021892547607422
Epoch: 14, Steps: 20 | Train Loss: 0.161 Vali Loss: 2.042 Vali Acc: 0.530 Test Loss: 2.042 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.897519111633301
Epoch: 15, Steps: 20 | Train Loss: 0.387 Vali Loss: 2.741 Vali Acc: 0.540 Test Loss: 2.741 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.059643745422363
Epoch: 16, Steps: 20 | Train Loss: 0.286 Vali Loss: 2.333 Vali Acc: 0.530 Test Loss: 2.333 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.310060262680054
Epoch: 17, Steps: 20 | Train Loss: 0.365 Vali Loss: 2.681 Vali Acc: 0.550 Test Loss: 2.681 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.427319288253784
Epoch: 18, Steps: 20 | Train Loss: 0.168 Vali Loss: 3.360 Vali Acc: 0.550 Test Loss: 3.360 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 115362
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.485450267791748
Epoch: 1, Steps: 20 | Train Loss: 0.785 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 4.231848478317261
Epoch: 2, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.854051113128662
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.995 Vali Acc: 0.510 Test Loss: 0.995 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.285757303237915
Epoch: 4, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.799 Vali Acc: 0.520 Test Loss: 0.799 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 3.6361703872680664
Epoch: 5, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.837 Vali Acc: 0.510 Test Loss: 0.837 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.1348772048950195
Epoch: 6, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 7 cost time: 2.6921682357788086
Epoch: 7, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.990 Vali Acc: 0.530 Test Loss: 0.990 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529990).  Saving model ...
Epoch: 8 cost time: 3.056891679763794
Epoch: 8, Steps: 20 | Train Loss: 0.500 Vali Loss: 1.237 Vali Acc: 0.590 Test Loss: 1.237 Test Acc: 0.590
Validation loss decreased (-0.529990 --> -0.589988).  Saving model ...
Epoch: 9 cost time: 3.5001370906829834
Epoch: 9, Steps: 20 | Train Loss: 0.444 Vali Loss: 1.445 Vali Acc: 0.540 Test Loss: 1.445 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7757651805877686
Epoch: 10, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.012 Vali Acc: 0.470 Test Loss: 1.012 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6841278076171875
Epoch: 11, Steps: 20 | Train Loss: 0.395 Vali Loss: 1.494 Vali Acc: 0.540 Test Loss: 1.494 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.7288577556610107
Epoch: 12, Steps: 20 | Train Loss: 0.460 Vali Loss: 1.233 Vali Acc: 0.450 Test Loss: 1.233 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.9045393466949463
Epoch: 13, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.732 Vali Acc: 0.510 Test Loss: 1.732 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.6974241733551025
Epoch: 14, Steps: 20 | Train Loss: 0.241 Vali Loss: 1.252 Vali Acc: 0.450 Test Loss: 1.252 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.4005157947540283
Epoch: 15, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.346 Vali Acc: 0.480 Test Loss: 1.346 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.002720355987549
Epoch: 16, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.476 Vali Acc: 0.480 Test Loss: 1.476 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.175904273986816
Epoch: 17, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.603 Vali Acc: 0.470 Test Loss: 1.603 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.8376007080078125
Epoch: 18, Steps: 20 | Train Loss: 0.156 Vali Loss: 1.635 Vali Acc: 0.440 Test Loss: 1.635 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 70594
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.830704927444458
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.875 Vali Acc: 0.480 Test Loss: 0.875 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 3.771167039871216
Epoch: 2, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.790 Vali Acc: 0.430 Test Loss: 0.790 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6078052520751953
Epoch: 3, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.942 Vali Acc: 0.500 Test Loss: 0.942 Test Acc: 0.500
Validation loss decreased (-0.479991 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 3.7938766479492188
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
Validation loss decreased (-0.499991 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 4.012887001037598
Epoch: 5, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.949 Vali Acc: 0.410 Test Loss: 0.949 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8410253524780273
Epoch: 6, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.865 Vali Acc: 0.460 Test Loss: 0.865 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.562166929244995
Epoch: 7, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.952 Vali Acc: 0.470 Test Loss: 0.952 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.5874149799346924
Epoch: 8, Steps: 20 | Train Loss: 0.526 Vali Loss: 1.039 Vali Acc: 0.420 Test Loss: 1.039 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.6967790126800537
Epoch: 9, Steps: 20 | Train Loss: 0.443 Vali Loss: 1.224 Vali Acc: 0.490 Test Loss: 1.224 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.392200469970703
Epoch: 10, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.044 Vali Acc: 0.480 Test Loss: 1.044 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.087998867034912
Epoch: 11, Steps: 20 | Train Loss: 0.395 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.9079067707061768
Epoch: 12, Steps: 20 | Train Loss: 0.299 Vali Loss: 1.224 Vali Acc: 0.480 Test Loss: 1.224 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.8182709217071533
Epoch: 13, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.494 Vali Acc: 0.480 Test Loss: 1.494 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.736741542816162
Epoch: 14, Steps: 20 | Train Loss: 0.276 Vali Loss: 1.113 Vali Acc: 0.530 Test Loss: 1.113 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529989).  Saving model ...
Epoch: 15 cost time: 3.6367626190185547
Epoch: 15, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.468 Vali Acc: 0.490 Test Loss: 1.468 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8827614784240723
Epoch: 16, Steps: 20 | Train Loss: 0.304 Vali Loss: 1.372 Vali Acc: 0.490 Test Loss: 1.372 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.518397808074951
Epoch: 17, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.549 Vali Acc: 0.560 Test Loss: 1.549 Test Acc: 0.560
Validation loss decreased (-0.529989 --> -0.559985).  Saving model ...
Epoch: 18 cost time: 3.3438665866851807
Epoch: 18, Steps: 20 | Train Loss: 0.169 Vali Loss: 1.560 Vali Acc: 0.520 Test Loss: 1.560 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6791417598724365
Epoch: 19, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.964 Vali Acc: 0.470 Test Loss: 1.964 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.665070056915283
Epoch: 20, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.791 Vali Acc: 0.520 Test Loss: 1.791 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.3377132415771484
Epoch: 21, Steps: 20 | Train Loss: 0.156 Vali Loss: 1.644 Vali Acc: 0.520 Test Loss: 1.644 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.498634099960327
Epoch: 22, Steps: 20 | Train Loss: 0.178 Vali Loss: 2.187 Vali Acc: 0.540 Test Loss: 2.187 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.059798240661621
Epoch: 23, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.816 Vali Acc: 0.530 Test Loss: 1.816 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.7363107204437256
Epoch: 24, Steps: 20 | Train Loss: 0.176 Vali Loss: 2.443 Vali Acc: 0.520 Test Loss: 2.443 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.0835084915161133
Epoch: 25, Steps: 20 | Train Loss: 0.092 Vali Loss: 2.082 Vali Acc: 0.540 Test Loss: 2.082 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.214759588241577
Epoch: 26, Steps: 20 | Train Loss: 0.094 Vali Loss: 1.936 Vali Acc: 0.460 Test Loss: 1.936 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.791954278945923
Epoch: 27, Steps: 20 | Train Loss: 0.076 Vali Loss: 2.457 Vali Acc: 0.430 Test Loss: 2.457 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 70626
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.0300188064575195
Epoch: 1, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.9424309730529785
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.904 Vali Acc: 0.460 Test Loss: 0.904 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9061129093170166
Epoch: 3, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.834 Vali Acc: 0.450 Test Loss: 0.834 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7758562564849854
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 1.046 Vali Acc: 0.510 Test Loss: 1.046 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.610133171081543
Epoch: 5, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.879 Vali Acc: 0.490 Test Loss: 0.879 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9285755157470703
Epoch: 6, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.885 Vali Acc: 0.490 Test Loss: 0.885 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.808612108230591
Epoch: 7, Steps: 20 | Train Loss: 0.524 Vali Loss: 1.013 Vali Acc: 0.480 Test Loss: 1.013 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.50656795501709
Epoch: 8, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.972 Vali Acc: 0.510 Test Loss: 0.972 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.460846424102783
Epoch: 9, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.179 Vali Acc: 0.510 Test Loss: 1.179 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.5762457847595215
Epoch: 10, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.861 Vali Acc: 0.540 Test Loss: 0.861 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.5097644329071045
Epoch: 11, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.133 Vali Acc: 0.530 Test Loss: 1.133 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 56322
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.14232873916626
Epoch: 1, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.765 Vali Acc: 0.530 Test Loss: 0.765 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 3.0914416313171387
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.93798565864563
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0967886447906494
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.802 Vali Acc: 0.510 Test Loss: 0.802 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1836187839508057
Epoch: 5, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.839 Vali Acc: 0.540 Test Loss: 0.839 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.2313380241394043
Epoch: 6, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.883 Vali Acc: 0.530 Test Loss: 0.883 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.77881121635437
Epoch: 7, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.885 Vali Acc: 0.480 Test Loss: 0.885 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.837968587875366
Epoch: 8, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.829 Vali Acc: 0.500 Test Loss: 0.829 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.889852523803711
Epoch: 9, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.890 Vali Acc: 0.460 Test Loss: 0.890 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.9686901569366455
Epoch: 10, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.900 Vali Acc: 0.490 Test Loss: 0.900 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.9782612323760986
Epoch: 11, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.974 Vali Acc: 0.470 Test Loss: 0.974 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.133260726928711
Epoch: 12, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.958 Vali Acc: 0.560 Test Loss: 0.958 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559990).  Saving model ...
Epoch: 13 cost time: 3.073608160018921
Epoch: 13, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.020 Vali Acc: 0.420 Test Loss: 1.020 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8891894817352295
Epoch: 14, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.882 Vali Acc: 0.510 Test Loss: 0.882 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.788306713104248
Epoch: 15, Steps: 20 | Train Loss: 0.364 Vali Loss: 0.992 Vali Acc: 0.510 Test Loss: 0.992 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2504665851593018
Epoch: 16, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.071 Vali Acc: 0.540 Test Loss: 1.071 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6079678535461426
Epoch: 17, Steps: 20 | Train Loss: 0.320 Vali Loss: 0.962 Vali Acc: 0.510 Test Loss: 0.962 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.8435676097869873
Epoch: 18, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.044 Vali Acc: 0.540 Test Loss: 1.044 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.1731104850769043
Epoch: 19, Steps: 20 | Train Loss: 0.270 Vali Loss: 1.194 Vali Acc: 0.540 Test Loss: 1.194 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.9650065898895264
Epoch: 20, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.036 Vali Acc: 0.510 Test Loss: 1.036 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.0616073608398438
Epoch: 21, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.160 Vali Acc: 0.430 Test Loss: 1.160 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.176908254623413
Epoch: 22, Steps: 20 | Train Loss: 0.231 Vali Loss: 1.213 Vali Acc: 0.520 Test Loss: 1.213 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 47458
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.675652265548706
Epoch: 1, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 2.6211495399475098
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.716 Vali Acc: 0.590 Test Loss: 0.716 Test Acc: 0.590
Validation loss decreased (-0.519992 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 2.9478726387023926
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.769 Vali Acc: 0.600 Test Loss: 0.769 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 4 cost time: 2.8867127895355225
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.971487045288086
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.773 Vali Acc: 0.530 Test Loss: 0.773 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1938185691833496
Epoch: 6, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.866 Vali Acc: 0.530 Test Loss: 0.866 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.1522586345672607
Epoch: 7, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.163358688354492
Epoch: 8, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.779 Vali Acc: 0.520 Test Loss: 0.779 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.276899576187134
Epoch: 9, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.848 Vali Acc: 0.490 Test Loss: 0.848 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.4082329273223877
Epoch: 10, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.966 Vali Acc: 0.530 Test Loss: 0.966 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7904253005981445
Epoch: 11, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.861 Vali Acc: 0.530 Test Loss: 0.861 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.892153739929199
Epoch: 12, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.936 Vali Acc: 0.530 Test Loss: 0.936 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8912642002105713
Epoch: 13, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.881 Vali Acc: 0.500 Test Loss: 0.881 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 43938
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.758436441421509
Epoch: 1, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.7999696731567383
Epoch: 2, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.714879035949707
Epoch: 3, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.770 Vali Acc: 0.490 Test Loss: 0.770 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7706334590911865
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.823 Vali Acc: 0.460 Test Loss: 0.823 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6544957160949707
Epoch: 5, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.853 Vali Acc: 0.430 Test Loss: 0.853 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6174232959747314
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.852 Vali Acc: 0.520 Test Loss: 0.852 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519991).  Saving model ...
Epoch: 7 cost time: 1.6923997402191162
Epoch: 7, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.827 Vali Acc: 0.510 Test Loss: 0.827 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6796338558197021
Epoch: 8, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.812 Vali Acc: 0.560 Test Loss: 0.812 Test Acc: 0.560
Validation loss decreased (-0.519991 --> -0.559992).  Saving model ...
Epoch: 9 cost time: 1.5500209331512451
Epoch: 9, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.830 Vali Acc: 0.480 Test Loss: 0.830 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6590704917907715
Epoch: 10, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.884 Vali Acc: 0.490 Test Loss: 0.884 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7337627410888672
Epoch: 11, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.845 Vali Acc: 0.490 Test Loss: 0.845 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6673955917358398
Epoch: 12, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.834 Vali Acc: 0.580 Test Loss: 0.834 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 13 cost time: 1.6929492950439453
Epoch: 13, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.919 Vali Acc: 0.510 Test Loss: 0.919 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7323970794677734
Epoch: 14, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.877 Vali Acc: 0.530 Test Loss: 0.877 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7108914852142334
Epoch: 15, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.881 Vali Acc: 0.570 Test Loss: 0.881 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8099439144134521
Epoch: 16, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.902 Vali Acc: 0.510 Test Loss: 0.902 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7094082832336426
Epoch: 17, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.902 Vali Acc: 0.560 Test Loss: 0.902 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6020045280456543
Epoch: 18, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.814 Vali Acc: 0.610 Test Loss: 0.814 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609992).  Saving model ...
Epoch: 19 cost time: 1.6475915908813477
Epoch: 19, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.997 Vali Acc: 0.510 Test Loss: 0.997 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5540211200714111
Epoch: 20, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.011 Vali Acc: 0.500 Test Loss: 1.011 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.664140224456787
Epoch: 21, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.014 Vali Acc: 0.520 Test Loss: 1.014 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6268644332885742
Epoch: 22, Steps: 20 | Train Loss: 0.336 Vali Loss: 1.030 Vali Acc: 0.540 Test Loss: 1.030 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.662287712097168
Epoch: 23, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.000 Vali Acc: 0.520 Test Loss: 1.000 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6871657371520996
Epoch: 24, Steps: 20 | Train Loss: 0.261 Vali Loss: 0.997 Vali Acc: 0.540 Test Loss: 0.997 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5886714458465576
Epoch: 25, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.066 Vali Acc: 0.540 Test Loss: 1.066 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7437009811401367
Epoch: 26, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.062 Vali Acc: 0.540 Test Loss: 1.062 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6410939693450928
Epoch: 27, Steps: 20 | Train Loss: 0.240 Vali Loss: 1.155 Vali Acc: 0.560 Test Loss: 1.155 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6235954761505127
Epoch: 28, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.324 Vali Acc: 0.500 Test Loss: 1.324 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm32_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 38658
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.241832494735718
Epoch: 1, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.3602476119995117
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.840 Vali Acc: 0.500 Test Loss: 0.840 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.751866102218628
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.920 Vali Acc: 0.510 Test Loss: 0.920 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.756361246109009
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.831 Vali Acc: 0.460 Test Loss: 0.831 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.606459140777588
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.858 Vali Acc: 0.510 Test Loss: 0.858 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3094420433044434
Epoch: 6, Steps: 20 | Train Loss: 0.589 Vali Loss: 1.018 Vali Acc: 0.540 Test Loss: 1.018 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539990).  Saving model ...
Epoch: 7 cost time: 2.605592966079712
Epoch: 7, Steps: 20 | Train Loss: 0.464 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1711738109588623
Epoch: 8, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.078 Vali Acc: 0.470 Test Loss: 1.078 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5225958824157715
Epoch: 9, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.020 Vali Acc: 0.520 Test Loss: 1.020 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6963326930999756
Epoch: 10, Steps: 20 | Train Loss: 0.357 Vali Loss: 0.931 Vali Acc: 0.520 Test Loss: 0.931 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7180864810943604
Epoch: 11, Steps: 20 | Train Loss: 0.307 Vali Loss: 1.291 Vali Acc: 0.490 Test Loss: 1.291 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4513533115386963
Epoch: 12, Steps: 20 | Train Loss: 0.241 Vali Loss: 1.113 Vali Acc: 0.490 Test Loss: 1.113 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.71413516998291
Epoch: 13, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.317 Vali Acc: 0.510 Test Loss: 1.317 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6669201850891113
Epoch: 14, Steps: 20 | Train Loss: 0.160 Vali Loss: 1.447 Vali Acc: 0.520 Test Loss: 1.447 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.6704041957855225
Epoch: 15, Steps: 20 | Train Loss: 0.188 Vali Loss: 1.480 Vali Acc: 0.470 Test Loss: 1.480 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.594285249710083
Epoch: 16, Steps: 20 | Train Loss: 0.151 Vali Loss: 1.533 Vali Acc: 0.450 Test Loss: 1.533 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 73714
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.000036001205444
Epoch: 1, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.812 Vali Acc: 0.490 Test Loss: 0.812 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.1638057231903076
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.843 Vali Acc: 0.520 Test Loss: 0.843 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 2.1452717781066895
Epoch: 3, Steps: 20 | Train Loss: 0.733 Vali Loss: 1.045 Vali Acc: 0.520 Test Loss: 1.045 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0976383686065674
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1225714683532715
Epoch: 5, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1490910053253174
Epoch: 6, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.923 Vali Acc: 0.500 Test Loss: 0.923 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0515997409820557
Epoch: 7, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.07373046875
Epoch: 8, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.993 Vali Acc: 0.440 Test Loss: 0.993 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.047724723815918
Epoch: 9, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.804 Vali Acc: 0.510 Test Loss: 0.804 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1022305488586426
Epoch: 10, Steps: 20 | Train Loss: 0.414 Vali Loss: 1.033 Vali Acc: 0.500 Test Loss: 1.033 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.061577558517456
Epoch: 11, Steps: 20 | Train Loss: 0.370 Vali Loss: 0.958 Vali Acc: 0.460 Test Loss: 0.958 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.122631788253784
Epoch: 12, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.009 Vali Acc: 0.490 Test Loss: 1.009 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 51330
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.376005172729492
Epoch: 1, Steps: 20 | Train Loss: 0.794 Vali Loss: 0.798 Vali Acc: 0.440 Test Loss: 0.798 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 1.9056916236877441
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.779 Vali Acc: 0.460 Test Loss: 0.779 Test Acc: 0.460
Validation loss decreased (-0.439992 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 1.9786314964294434
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
Validation loss decreased (-0.459992 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 1.9979755878448486
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.964 Vali Acc: 0.480 Test Loss: 0.964 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.885392189025879
Epoch: 5, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.824 Vali Acc: 0.460 Test Loss: 0.824 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0296385288238525
Epoch: 6, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.874 Vali Acc: 0.410 Test Loss: 0.874 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.18790864944458
Epoch: 7, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.924 Vali Acc: 0.510 Test Loss: 0.924 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1444830894470215
Epoch: 8, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.941 Vali Acc: 0.470 Test Loss: 0.941 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.156038761138916
Epoch: 9, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.927 Vali Acc: 0.450 Test Loss: 0.927 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2329750061035156
Epoch: 10, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.989 Vali Acc: 0.480 Test Loss: 0.989 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.281052350997925
Epoch: 11, Steps: 20 | Train Loss: 0.454 Vali Loss: 1.076 Vali Acc: 0.410 Test Loss: 1.076 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0871341228485107
Epoch: 12, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.057 Vali Acc: 0.450 Test Loss: 1.057 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1137290000915527
Epoch: 13, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.025 Vali Acc: 0.450 Test Loss: 1.025 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 51346
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3141167163848877
Epoch: 1, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 1.4637846946716309
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.751 Vali Acc: 0.460 Test Loss: 0.751 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5851271152496338
Epoch: 3, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.802 Vali Acc: 0.510 Test Loss: 0.802 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 1.6104793548583984
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5830237865447998
Epoch: 5, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.818 Vali Acc: 0.520 Test Loss: 0.818 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 1.65041184425354
Epoch: 6, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.828 Vali Acc: 0.500 Test Loss: 0.828 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5778110027313232
Epoch: 7, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.854 Vali Acc: 0.500 Test Loss: 0.854 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4792284965515137
Epoch: 8, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.791 Vali Acc: 0.470 Test Loss: 0.791 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3950891494750977
Epoch: 9, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.822 Vali Acc: 0.570 Test Loss: 0.822 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 1.4368939399719238
Epoch: 10, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.893 Vali Acc: 0.500 Test Loss: 0.893 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5393550395965576
Epoch: 11, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.978 Vali Acc: 0.470 Test Loss: 0.978 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5402648448944092
Epoch: 12, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.963 Vali Acc: 0.510 Test Loss: 0.963 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4274587631225586
Epoch: 13, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.901 Vali Acc: 0.560 Test Loss: 0.901 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5373692512512207
Epoch: 14, Steps: 20 | Train Loss: 0.397 Vali Loss: 1.078 Vali Acc: 0.510 Test Loss: 1.078 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4480457305908203
Epoch: 15, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.014 Vali Acc: 0.490 Test Loss: 1.014 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5252459049224854
Epoch: 16, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.061 Vali Acc: 0.520 Test Loss: 1.061 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5184447765350342
Epoch: 17, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.094 Vali Acc: 0.540 Test Loss: 1.094 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.546401023864746
Epoch: 18, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.085 Vali Acc: 0.530 Test Loss: 1.085 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7908954620361328
Epoch: 19, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.052 Vali Acc: 0.560 Test Loss: 1.052 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 44194
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.635453701019287
Epoch: 1, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.841 Vali Acc: 0.500 Test Loss: 0.841 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.8203685283660889
Epoch: 2, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.730 Vali Acc: 0.560 Test Loss: 0.730 Test Acc: 0.560
Validation loss decreased (-0.499992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.7299420833587646
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.731 Vali Acc: 0.590 Test Loss: 0.731 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 1.862992286682129
Epoch: 4, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7889692783355713
Epoch: 5, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.797 Vali Acc: 0.510 Test Loss: 0.797 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.020176410675049
Epoch: 6, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.939 Vali Acc: 0.510 Test Loss: 0.939 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.019158363342285
Epoch: 7, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.105428695678711
Epoch: 8, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.871 Vali Acc: 0.490 Test Loss: 0.871 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.046543598175049
Epoch: 9, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.024793863296509
Epoch: 10, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7293617725372314
Epoch: 11, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.828 Vali Acc: 0.500 Test Loss: 0.828 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7212867736816406
Epoch: 12, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.835181474685669
Epoch: 13, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 39762
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.379075765609741
Epoch: 1, Steps: 20 | Train Loss: 0.801 Vali Loss: 0.751 Vali Acc: 0.470 Test Loss: 0.751 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 1.834287166595459
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.773 Vali Acc: 0.510 Test Loss: 0.773 Test Acc: 0.510
Validation loss decreased (-0.469992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.6764636039733887
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.779 Vali Acc: 0.540 Test Loss: 0.779 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 1.804760456085205
Epoch: 4, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.869 Vali Acc: 0.480 Test Loss: 0.869 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6697545051574707
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.754887580871582
Epoch: 6, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.799 Vali Acc: 0.500 Test Loss: 0.799 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8133087158203125
Epoch: 7, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.838 Vali Acc: 0.490 Test Loss: 0.838 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8258559703826904
Epoch: 8, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.870924949645996
Epoch: 9, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7021117210388184
Epoch: 10, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.856 Vali Acc: 0.520 Test Loss: 0.856 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.711362361907959
Epoch: 11, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.853 Vali Acc: 0.560 Test Loss: 0.853 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559991).  Saving model ...
Epoch: 12 cost time: 1.6123993396759033
Epoch: 12, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6890356540679932
Epoch: 13, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.897 Vali Acc: 0.530 Test Loss: 0.897 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7600538730621338
Epoch: 14, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.862 Vali Acc: 0.480 Test Loss: 0.862 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8505961894989014
Epoch: 15, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.943 Vali Acc: 0.490 Test Loss: 0.943 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8771562576293945
Epoch: 16, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.905 Vali Acc: 0.470 Test Loss: 0.905 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9457616806030273
Epoch: 17, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.966 Vali Acc: 0.520 Test Loss: 0.966 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8843307495117188
Epoch: 18, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.979 Vali Acc: 0.490 Test Loss: 0.979 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8304457664489746
Epoch: 19, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.943 Vali Acc: 0.480 Test Loss: 0.943 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.865452527999878
Epoch: 20, Steps: 20 | Train Loss: 0.330 Vali Loss: 0.957 Vali Acc: 0.540 Test Loss: 0.957 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9357266426086426
Epoch: 21, Steps: 20 | Train Loss: 0.314 Vali Loss: 0.974 Vali Acc: 0.520 Test Loss: 0.974 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 38002
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5491342544555664
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.807 Vali Acc: 0.410 Test Loss: 0.807 Test Acc: 0.410
Validation loss decreased (inf --> -0.409992).  Saving model ...
Epoch: 2 cost time: 1.6628541946411133
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.803 Vali Acc: 0.430 Test Loss: 0.803 Test Acc: 0.430
Validation loss decreased (-0.409992 --> -0.429992).  Saving model ...
Epoch: 3 cost time: 1.608344554901123
Epoch: 3, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.789 Vali Acc: 0.460 Test Loss: 0.789 Test Acc: 0.460
Validation loss decreased (-0.429992 --> -0.459992).  Saving model ...
Epoch: 4 cost time: 1.7624337673187256
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.816 Vali Acc: 0.470 Test Loss: 0.816 Test Acc: 0.470
Validation loss decreased (-0.459992 --> -0.469992).  Saving model ...
Epoch: 5 cost time: 1.6097075939178467
Epoch: 5, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.776 Vali Acc: 0.550 Test Loss: 0.776 Test Acc: 0.550
Validation loss decreased (-0.469992 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 1.7678720951080322
Epoch: 6, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.877 Vali Acc: 0.520 Test Loss: 0.877 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.803394079208374
Epoch: 7, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.801 Vali Acc: 0.510 Test Loss: 0.801 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.63572359085083
Epoch: 8, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7031033039093018
Epoch: 9, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.841 Vali Acc: 0.480 Test Loss: 0.841 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.626408576965332
Epoch: 10, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.807 Vali Acc: 0.520 Test Loss: 0.807 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6254875659942627
Epoch: 11, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7143933773040771
Epoch: 12, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.798 Vali Acc: 0.550 Test Loss: 0.798 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.825930118560791
Epoch: 13, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.893 Vali Acc: 0.580 Test Loss: 0.893 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579991).  Saving model ...
Epoch: 14 cost time: 1.7524259090423584
Epoch: 14, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.830 Vali Acc: 0.500 Test Loss: 0.830 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.555326223373413
Epoch: 15, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.832 Vali Acc: 0.520 Test Loss: 0.832 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6924498081207275
Epoch: 16, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.834 Vali Acc: 0.540 Test Loss: 0.834 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6529335975646973
Epoch: 17, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.845 Vali Acc: 0.520 Test Loss: 0.845 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8669795989990234
Epoch: 18, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.842 Vali Acc: 0.520 Test Loss: 0.842 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7872567176818848
Epoch: 19, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.817 Vali Acc: 0.540 Test Loss: 0.817 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6856169700622559
Epoch: 20, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.854 Vali Acc: 0.550 Test Loss: 0.854 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.68316650390625
Epoch: 21, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.848 Vali Acc: 0.540 Test Loss: 0.848 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.670661449432373
Epoch: 22, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.910 Vali Acc: 0.530 Test Loss: 0.910 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6277527809143066
Epoch: 23, Steps: 20 | Train Loss: 0.413 Vali Loss: 1.012 Vali Acc: 0.550 Test Loss: 1.012 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 35362
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.95284104347229
Epoch: 1, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.733 Vali Acc: 0.510 Test Loss: 0.733 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.3316268920898438
Epoch: 2, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.2842817306518555
Epoch: 3, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.821 Vali Acc: 0.530 Test Loss: 0.821 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.114936113357544
Epoch: 4, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 2.515071153640747
Epoch: 5, Steps: 20 | Train Loss: 0.631 Vali Loss: 1.073 Vali Acc: 0.510 Test Loss: 1.073 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3622946739196777
Epoch: 6, Steps: 20 | Train Loss: 0.598 Vali Loss: 1.261 Vali Acc: 0.510 Test Loss: 1.261 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4384632110595703
Epoch: 7, Steps: 20 | Train Loss: 0.656 Vali Loss: 1.037 Vali Acc: 0.510 Test Loss: 1.037 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3719067573547363
Epoch: 8, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.842 Vali Acc: 0.530 Test Loss: 0.842 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.331862449645996
Epoch: 9, Steps: 20 | Train Loss: 0.563 Vali Loss: 1.090 Vali Acc: 0.460 Test Loss: 1.090 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.237502098083496
Epoch: 10, Steps: 20 | Train Loss: 0.556 Vali Loss: 1.594 Vali Acc: 0.530 Test Loss: 1.594 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.487476348876953
Epoch: 11, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.162 Vali Acc: 0.480 Test Loss: 1.162 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2889060974121094
Epoch: 12, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.443 Vali Acc: 0.530 Test Loss: 1.443 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.5164294242858887
Epoch: 13, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.285 Vali Acc: 0.490 Test Loss: 1.285 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2454466819763184
Epoch: 14, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.220 Vali Acc: 0.490 Test Loss: 1.220 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 61042
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.765136241912842
Epoch: 1, Steps: 20 | Train Loss: 0.799 Vali Loss: 0.708 Vali Acc: 0.550 Test Loss: 0.708 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.7530755996704102
Epoch: 2, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.731 Vali Acc: 0.540 Test Loss: 0.731 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7911286354064941
Epoch: 3, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.877 Vali Acc: 0.530 Test Loss: 0.877 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9469075202941895
Epoch: 4, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.803 Vali Acc: 0.530 Test Loss: 0.803 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0738613605499268
Epoch: 5, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8478519916534424
Epoch: 6, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.813 Vali Acc: 0.550 Test Loss: 0.813 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.799100637435913
Epoch: 7, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.812 Vali Acc: 0.490 Test Loss: 0.812 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8159770965576172
Epoch: 8, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.814 Vali Acc: 0.470 Test Loss: 0.814 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9275691509246826
Epoch: 9, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.902 Vali Acc: 0.470 Test Loss: 0.902 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7160437107086182
Epoch: 10, Steps: 20 | Train Loss: 0.446 Vali Loss: 1.040 Vali Acc: 0.500 Test Loss: 1.040 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.046746015548706
Epoch: 11, Steps: 20 | Train Loss: 0.389 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 38658
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6139180660247803
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.8082478046417236
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.93788480758667
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.771 Vali Acc: 0.450 Test Loss: 0.771 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.826582670211792
Epoch: 4, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.775 Vali Acc: 0.580 Test Loss: 0.775 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579992).  Saving model ...
Epoch: 5 cost time: 1.94307541847229
Epoch: 5, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.829 Vali Acc: 0.540 Test Loss: 0.829 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9956605434417725
Epoch: 6, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.845 Vali Acc: 0.480 Test Loss: 0.845 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8375332355499268
Epoch: 7, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.938 Vali Acc: 0.540 Test Loss: 0.938 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9687926769256592
Epoch: 8, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.909 Vali Acc: 0.510 Test Loss: 0.909 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.87736177444458
Epoch: 9, Steps: 20 | Train Loss: 0.502 Vali Loss: 1.167 Vali Acc: 0.480 Test Loss: 1.167 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9432477951049805
Epoch: 10, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.956 Vali Acc: 0.550 Test Loss: 0.956 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.898463249206543
Epoch: 11, Steps: 20 | Train Loss: 0.439 Vali Loss: 1.042 Vali Acc: 0.460 Test Loss: 1.042 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8062434196472168
Epoch: 12, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.019 Vali Acc: 0.540 Test Loss: 1.019 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.114582061767578
Epoch: 13, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.966 Vali Acc: 0.490 Test Loss: 0.966 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9849498271942139
Epoch: 14, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.029 Vali Acc: 0.460 Test Loss: 1.029 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 38674
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.128420114517212
Epoch: 1, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.769 Vali Acc: 0.520 Test Loss: 0.769 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.3731920719146729
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 1.3887333869934082
Epoch: 3, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.975 Vali Acc: 0.510 Test Loss: 0.975 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.415065050125122
Epoch: 4, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.965 Vali Acc: 0.490 Test Loss: 0.965 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.430330514907837
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.889 Vali Acc: 0.500 Test Loss: 0.889 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5726075172424316
Epoch: 6, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.812 Vali Acc: 0.490 Test Loss: 0.812 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4769392013549805
Epoch: 7, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.842 Vali Acc: 0.560 Test Loss: 0.842 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 1.4341559410095215
Epoch: 8, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.854 Vali Acc: 0.530 Test Loss: 0.854 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3785207271575928
Epoch: 9, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.976 Vali Acc: 0.570 Test Loss: 0.976 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569990).  Saving model ...
Epoch: 10 cost time: 1.4393885135650635
Epoch: 10, Steps: 20 | Train Loss: 0.579 Vali Loss: 1.004 Vali Acc: 0.530 Test Loss: 1.004 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3021528720855713
Epoch: 11, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.869 Vali Acc: 0.520 Test Loss: 0.869 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3858888149261475
Epoch: 12, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.894 Vali Acc: 0.520 Test Loss: 0.894 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4693799018859863
Epoch: 13, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.943 Vali Acc: 0.460 Test Loss: 0.943 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4587407112121582
Epoch: 14, Steps: 20 | Train Loss: 0.385 Vali Loss: 0.898 Vali Acc: 0.510 Test Loss: 0.898 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4954628944396973
Epoch: 15, Steps: 20 | Train Loss: 0.378 Vali Loss: 0.930 Vali Acc: 0.500 Test Loss: 0.930 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6308214664459229
Epoch: 16, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.150 Vali Acc: 0.520 Test Loss: 1.150 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7055554389953613
Epoch: 17, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.055 Vali Acc: 0.490 Test Loss: 1.055 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5807929039001465
Epoch: 18, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.064 Vali Acc: 0.530 Test Loss: 1.064 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4726688861846924
Epoch: 19, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.065 Vali Acc: 0.460 Test Loss: 1.065 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 31522
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.865750789642334
Epoch: 1, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.917809247970581
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.778 Vali Acc: 0.480 Test Loss: 0.778 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9750730991363525
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 1.7537946701049805
Epoch: 4, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.781 Vali Acc: 0.470 Test Loss: 0.781 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6956110000610352
Epoch: 5, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.805 Vali Acc: 0.430 Test Loss: 0.805 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.711244821548462
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.812 Vali Acc: 0.440 Test Loss: 0.812 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.633873462677002
Epoch: 7, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.791 Vali Acc: 0.480 Test Loss: 0.791 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.755890130996704
Epoch: 8, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5398149490356445
Epoch: 9, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.822 Vali Acc: 0.490 Test Loss: 0.822 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5574748516082764
Epoch: 10, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539992).  Saving model ...
Epoch: 11 cost time: 1.5449769496917725
Epoch: 11, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.849 Vali Acc: 0.430 Test Loss: 0.849 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5715820789337158
Epoch: 12, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.882 Vali Acc: 0.470 Test Loss: 0.882 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6249654293060303
Epoch: 13, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.856 Vali Acc: 0.390 Test Loss: 0.856 Test Acc: 0.390
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5966906547546387
Epoch: 14, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.899 Vali Acc: 0.470 Test Loss: 0.899 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.611572265625
Epoch: 15, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.891 Vali Acc: 0.430 Test Loss: 0.891 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6317808628082275
Epoch: 16, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.911 Vali Acc: 0.460 Test Loss: 0.911 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6698181629180908
Epoch: 17, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.930 Vali Acc: 0.500 Test Loss: 0.930 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6928400993347168
Epoch: 18, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.967 Vali Acc: 0.430 Test Loss: 0.967 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6548359394073486
Epoch: 19, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.933 Vali Acc: 0.440 Test Loss: 0.933 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8830888271331787
Epoch: 20, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.006 Vali Acc: 0.460 Test Loss: 1.006 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 27090
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4981706142425537
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.686 Vali Acc: 0.560 Test Loss: 0.686 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.768883466720581
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.721 Vali Acc: 0.570 Test Loss: 0.721 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 1.7214715480804443
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.746 Vali Acc: 0.560 Test Loss: 0.746 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.76416015625
Epoch: 4, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.788 Vali Acc: 0.530 Test Loss: 0.788 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6696372032165527
Epoch: 5, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.749 Vali Acc: 0.560 Test Loss: 0.749 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8238024711608887
Epoch: 6, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.792 Vali Acc: 0.590 Test Loss: 0.792 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 1.7648212909698486
Epoch: 7, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6384954452514648
Epoch: 8, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.777 Vali Acc: 0.570 Test Loss: 0.777 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6192026138305664
Epoch: 9, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.826 Vali Acc: 0.550 Test Loss: 0.826 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5989468097686768
Epoch: 10, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.755 Vali Acc: 0.620 Test Loss: 0.755 Test Acc: 0.620
Validation loss decreased (-0.589992 --> -0.619992).  Saving model ...
Epoch: 11 cost time: 1.5571024417877197
Epoch: 11, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8752477169036865
Epoch: 12, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.795 Vali Acc: 0.550 Test Loss: 0.795 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6223745346069336
Epoch: 13, Steps: 20 | Train Loss: 0.494 Vali Loss: 1.006 Vali Acc: 0.520 Test Loss: 1.006 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6826910972595215
Epoch: 14, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7025034427642822
Epoch: 15, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8585140705108643
Epoch: 16, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.840 Vali Acc: 0.530 Test Loss: 0.840 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7373645305633545
Epoch: 17, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.936 Vali Acc: 0.500 Test Loss: 0.936 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7528343200683594
Epoch: 18, Steps: 20 | Train Loss: 0.438 Vali Loss: 1.041 Vali Acc: 0.490 Test Loss: 1.041 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6242926120758057
Epoch: 19, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.909 Vali Acc: 0.530 Test Loss: 0.909 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.634239673614502
Epoch: 20, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.959 Vali Acc: 0.450 Test Loss: 0.959 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 25330
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6926605701446533
Epoch: 1, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.423884630203247
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.6363496780395508
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.739 Vali Acc: 0.570 Test Loss: 0.739 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 1.6153197288513184
Epoch: 4, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.741 Vali Acc: 0.560 Test Loss: 0.741 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7059597969055176
Epoch: 5, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.754 Vali Acc: 0.560 Test Loss: 0.754 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5222291946411133
Epoch: 6, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.774 Vali Acc: 0.560 Test Loss: 0.774 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5317509174346924
Epoch: 7, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.763 Vali Acc: 0.590 Test Loss: 0.763 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 8 cost time: 1.5571274757385254
Epoch: 8, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8000905513763428
Epoch: 9, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6283338069915771
Epoch: 10, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.794 Vali Acc: 0.550 Test Loss: 0.794 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6954119205474854
Epoch: 11, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.817 Vali Acc: 0.560 Test Loss: 0.817 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5153429508209229
Epoch: 12, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.813 Vali Acc: 0.560 Test Loss: 0.813 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6357982158660889
Epoch: 13, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6354937553405762
Epoch: 14, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.823 Vali Acc: 0.560 Test Loss: 0.823 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5223922729492188
Epoch: 15, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.826 Vali Acc: 0.560 Test Loss: 0.826 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.403568983078003
Epoch: 16, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.814 Vali Acc: 0.550 Test Loss: 0.814 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7101075649261475
Epoch: 17, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.839 Vali Acc: 0.540 Test Loss: 0.839 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 22690
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.734950304031372
Epoch: 1, Steps: 20 | Train Loss: 0.816 Vali Loss: 0.851 Vali Acc: 0.500 Test Loss: 0.851 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 2.915787696838379
Epoch: 2, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9468698501586914
Epoch: 3, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.808 Vali Acc: 0.490 Test Loss: 0.808 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7798800468444824
Epoch: 4, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.873 Vali Acc: 0.450 Test Loss: 0.873 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.436170816421509
Epoch: 5, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.820 Vali Acc: 0.550 Test Loss: 0.820 Test Acc: 0.550
Validation loss decreased (-0.499991 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 2.7962169647216797
Epoch: 6, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.940 Vali Acc: 0.530 Test Loss: 0.940 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.259006977081299
Epoch: 7, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.937 Vali Acc: 0.510 Test Loss: 0.937 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.103877067565918
Epoch: 8, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.912 Vali Acc: 0.560 Test Loss: 0.912 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 9 cost time: 3.2329304218292236
Epoch: 9, Steps: 20 | Train Loss: 0.556 Vali Loss: 1.132 Vali Acc: 0.520 Test Loss: 1.132 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8263614177703857
Epoch: 10, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.090 Vali Acc: 0.530 Test Loss: 1.090 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6031267642974854
Epoch: 11, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.981 Vali Acc: 0.530 Test Loss: 0.981 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5825910568237305
Epoch: 12, Steps: 20 | Train Loss: 0.385 Vali Loss: 1.139 Vali Acc: 0.460 Test Loss: 1.139 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7381465435028076
Epoch: 13, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.118 Vali Acc: 0.490 Test Loss: 1.118 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.390073537826538
Epoch: 14, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.239 Vali Acc: 0.510 Test Loss: 1.239 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.8603827953338623
Epoch: 15, Steps: 20 | Train Loss: 0.247 Vali Loss: 1.686 Vali Acc: 0.480 Test Loss: 1.686 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7420527935028076
Epoch: 16, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.603 Vali Acc: 0.520 Test Loss: 1.603 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.824601650238037
Epoch: 17, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.794 Vali Acc: 0.490 Test Loss: 1.794 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.9255290031433105
Epoch: 18, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.758 Vali Acc: 0.510 Test Loss: 1.758 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 54706
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.723588705062866
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 2.3182594776153564
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.826 Vali Acc: 0.510 Test Loss: 0.826 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.272883892059326
Epoch: 3, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.807 Vali Acc: 0.490 Test Loss: 0.807 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6339354515075684
Epoch: 4, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.804 Vali Acc: 0.520 Test Loss: 0.804 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 2.4409422874450684
Epoch: 5, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 2.514665126800537
Epoch: 6, Steps: 20 | Train Loss: 0.600 Vali Loss: 1.060 Vali Acc: 0.510 Test Loss: 1.060 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6946425437927246
Epoch: 7, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.905 Vali Acc: 0.470 Test Loss: 0.905 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.686760902404785
Epoch: 8, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.829 Vali Acc: 0.550 Test Loss: 0.829 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 2.5963644981384277
Epoch: 9, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.906 Vali Acc: 0.500 Test Loss: 0.906 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.628225803375244
Epoch: 10, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.887 Vali Acc: 0.510 Test Loss: 0.887 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.066253662109375
Epoch: 11, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.915 Vali Acc: 0.520 Test Loss: 0.915 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.284247636795044
Epoch: 12, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.982 Vali Acc: 0.510 Test Loss: 0.982 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.153456449508667
Epoch: 13, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.980 Vali Acc: 0.530 Test Loss: 0.980 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.641793966293335
Epoch: 14, Steps: 20 | Train Loss: 0.331 Vali Loss: 0.988 Vali Acc: 0.450 Test Loss: 0.988 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4255683422088623
Epoch: 15, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.091 Vali Acc: 0.540 Test Loss: 1.091 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.456860303878784
Epoch: 16, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.361 Vali Acc: 0.500 Test Loss: 1.361 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.8930070400238037
Epoch: 17, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.096 Vali Acc: 0.540 Test Loss: 1.096 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7734053134918213
Epoch: 18, Steps: 20 | Train Loss: 0.237 Vali Loss: 1.189 Vali Acc: 0.490 Test Loss: 1.189 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 32322
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.837572336196899
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.783 Vali Acc: 0.450 Test Loss: 0.783 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 2.606044292449951
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.776 Vali Acc: 0.490 Test Loss: 0.776 Test Acc: 0.490
Validation loss decreased (-0.449992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 2.555441379547119
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.781 Vali Acc: 0.470 Test Loss: 0.781 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.881438970565796
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.939 Vali Acc: 0.470 Test Loss: 0.939 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7680552005767822
Epoch: 5, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.908 Vali Acc: 0.460 Test Loss: 0.908 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.884312391281128
Epoch: 6, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.844 Vali Acc: 0.540 Test Loss: 0.844 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 2.984480857849121
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 1.116 Vali Acc: 0.530 Test Loss: 1.116 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.912688732147217
Epoch: 8, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.933 Vali Acc: 0.500 Test Loss: 0.933 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6926498413085938
Epoch: 9, Steps: 20 | Train Loss: 0.517 Vali Loss: 1.006 Vali Acc: 0.490 Test Loss: 1.006 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.747591257095337
Epoch: 10, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.953 Vali Acc: 0.420 Test Loss: 0.953 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.1165621280670166
Epoch: 11, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.894 Vali Acc: 0.480 Test Loss: 0.894 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.623769521713257
Epoch: 12, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.010 Vali Acc: 0.480 Test Loss: 1.010 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.197843074798584
Epoch: 13, Steps: 20 | Train Loss: 0.409 Vali Loss: 1.047 Vali Acc: 0.520 Test Loss: 1.047 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6659867763519287
Epoch: 14, Steps: 20 | Train Loss: 0.440 Vali Loss: 1.125 Vali Acc: 0.490 Test Loss: 1.125 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7054967880249023
Epoch: 15, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.256 Vali Acc: 0.510 Test Loss: 1.256 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.4729182720184326
Epoch: 16, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.191 Vali Acc: 0.470 Test Loss: 1.191 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 32338
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4382803440093994
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.612323522567749
Epoch: 2, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.5674755573272705
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4748969078063965
Epoch: 4, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.807 Vali Acc: 0.480 Test Loss: 0.807 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.562424659729004
Epoch: 5, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.816 Vali Acc: 0.520 Test Loss: 0.816 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 1.5005435943603516
Epoch: 6, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.968 Vali Acc: 0.490 Test Loss: 0.968 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4761767387390137
Epoch: 7, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.61594820022583
Epoch: 8, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 1.6524031162261963
Epoch: 9, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.975 Vali Acc: 0.510 Test Loss: 0.975 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8095312118530273
Epoch: 10, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.815 Vali Acc: 0.520 Test Loss: 0.815 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5412752628326416
Epoch: 11, Steps: 20 | Train Loss: 0.485 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.716796875
Epoch: 12, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.829 Vali Acc: 0.510 Test Loss: 0.829 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.620265245437622
Epoch: 13, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.868 Vali Acc: 0.520 Test Loss: 0.868 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7086842060089111
Epoch: 14, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.922 Vali Acc: 0.480 Test Loss: 0.922 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4951703548431396
Epoch: 15, Steps: 20 | Train Loss: 0.385 Vali Loss: 0.910 Vali Acc: 0.530 Test Loss: 0.910 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4407682418823242
Epoch: 16, Steps: 20 | Train Loss: 0.374 Vali Loss: 0.977 Vali Acc: 0.480 Test Loss: 0.977 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5841209888458252
Epoch: 17, Steps: 20 | Train Loss: 0.345 Vali Loss: 0.902 Vali Acc: 0.560 Test Loss: 0.902 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 18 cost time: 1.3737807273864746
Epoch: 18, Steps: 20 | Train Loss: 0.336 Vali Loss: 1.042 Vali Acc: 0.460 Test Loss: 1.042 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.560488224029541
Epoch: 19, Steps: 20 | Train Loss: 0.324 Vali Loss: 1.045 Vali Acc: 0.530 Test Loss: 1.045 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5686490535736084
Epoch: 20, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.140 Vali Acc: 0.510 Test Loss: 1.140 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2022168636322021
Epoch: 21, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.208 Vali Acc: 0.510 Test Loss: 1.208 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6537072658538818
Epoch: 22, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.042 Vali Acc: 0.560 Test Loss: 1.042 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6902532577514648
Epoch: 23, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.141 Vali Acc: 0.570 Test Loss: 1.141 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569989).  Saving model ...
Epoch: 24 cost time: 1.5749690532684326
Epoch: 24, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.175 Vali Acc: 0.540 Test Loss: 1.175 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5579149723052979
Epoch: 25, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.275 Vali Acc: 0.530 Test Loss: 1.275 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6695497035980225
Epoch: 26, Steps: 20 | Train Loss: 0.124 Vali Loss: 1.328 Vali Acc: 0.520 Test Loss: 1.328 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.682079553604126
Epoch: 27, Steps: 20 | Train Loss: 0.120 Vali Loss: 1.299 Vali Acc: 0.510 Test Loss: 1.299 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.817070722579956
Epoch: 28, Steps: 20 | Train Loss: 0.105 Vali Loss: 1.343 Vali Acc: 0.520 Test Loss: 1.343 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5673136711120605
Epoch: 29, Steps: 20 | Train Loss: 0.088 Vali Loss: 1.586 Vali Acc: 0.510 Test Loss: 1.586 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6666648387908936
Epoch: 30, Steps: 20 | Train Loss: 0.108 Vali Loss: 1.486 Vali Acc: 0.510 Test Loss: 1.486 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7678358554840088
Epoch: 31, Steps: 20 | Train Loss: 0.076 Vali Loss: 1.612 Vali Acc: 0.490 Test Loss: 1.612 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.9288082122802734
Epoch: 32, Steps: 20 | Train Loss: 0.087 Vali Loss: 1.573 Vali Acc: 0.570 Test Loss: 1.573 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.8160436153411865
Epoch: 33, Steps: 20 | Train Loss: 0.094 Vali Loss: 1.567 Vali Acc: 0.520 Test Loss: 1.567 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 25186
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.800107479095459
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.5750107765197754
Epoch: 2, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.8195011615753174
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.790 Vali Acc: 0.540 Test Loss: 0.790 Test Acc: 0.540
Validation loss decreased (-0.489993 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 1.4742729663848877
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.816 Vali Acc: 0.540 Test Loss: 0.816 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6009981632232666
Epoch: 5, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.769 Vali Acc: 0.560 Test Loss: 0.769 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 1.5104167461395264
Epoch: 6, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.805 Vali Acc: 0.530 Test Loss: 0.805 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5077128410339355
Epoch: 7, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.792 Vali Acc: 0.510 Test Loss: 0.792 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.38651442527771
Epoch: 8, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.849 Vali Acc: 0.520 Test Loss: 0.849 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4883971214294434
Epoch: 9, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.859 Vali Acc: 0.530 Test Loss: 0.859 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5943362712860107
Epoch: 10, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8935768604278564
Epoch: 11, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.818 Vali Acc: 0.560 Test Loss: 0.818 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6327431201934814
Epoch: 12, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.956 Vali Acc: 0.510 Test Loss: 0.956 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7729134559631348
Epoch: 13, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.914 Vali Acc: 0.530 Test Loss: 0.914 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8183894157409668
Epoch: 14, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.901 Vali Acc: 0.490 Test Loss: 0.901 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6272969245910645
Epoch: 15, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.968 Vali Acc: 0.490 Test Loss: 0.968 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 20754
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5372204780578613
Epoch: 1, Steps: 20 | Train Loss: 0.805 Vali Loss: 0.732 Vali Acc: 0.530 Test Loss: 0.732 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.776421308517456
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6787354946136475
Epoch: 3, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.745 Vali Acc: 0.480 Test Loss: 0.745 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9075312614440918
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8677606582641602
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.809 Vali Acc: 0.470 Test Loss: 0.809 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7570621967315674
Epoch: 6, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.820 Vali Acc: 0.480 Test Loss: 0.820 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.581925868988037
Epoch: 7, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.795 Vali Acc: 0.470 Test Loss: 0.795 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7915623188018799
Epoch: 8, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.870 Vali Acc: 0.530 Test Loss: 0.870 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6324071884155273
Epoch: 9, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.890 Vali Acc: 0.560 Test Loss: 0.890 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559991).  Saving model ...
Epoch: 10 cost time: 1.5736956596374512
Epoch: 10, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.972 Vali Acc: 0.510 Test Loss: 0.972 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6244680881500244
Epoch: 11, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.925 Vali Acc: 0.500 Test Loss: 0.925 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5760948657989502
Epoch: 12, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.865 Vali Acc: 0.520 Test Loss: 0.865 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7093007564544678
Epoch: 13, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.956 Vali Acc: 0.470 Test Loss: 0.956 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.746586561203003
Epoch: 14, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.853 Vali Acc: 0.530 Test Loss: 0.853 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5646753311157227
Epoch: 15, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.897 Vali Acc: 0.520 Test Loss: 0.897 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6120977401733398
Epoch: 16, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.917 Vali Acc: 0.560 Test Loss: 0.917 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.580850601196289
Epoch: 17, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.937 Vali Acc: 0.460 Test Loss: 0.937 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5803196430206299
Epoch: 18, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.004 Vali Acc: 0.490 Test Loss: 1.004 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6304888725280762
Epoch: 19, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.967 Vali Acc: 0.500 Test Loss: 0.967 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 18994
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8229384422302246
Epoch: 1, Steps: 20 | Train Loss: 0.818 Vali Loss: 0.670 Vali Acc: 0.540 Test Loss: 0.670 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.6895751953125
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.683 Vali Acc: 0.570 Test Loss: 0.683 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 1.5581064224243164
Epoch: 3, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.715 Vali Acc: 0.540 Test Loss: 0.715 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6969997882843018
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.732 Vali Acc: 0.530 Test Loss: 0.732 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7867498397827148
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.785 Vali Acc: 0.530 Test Loss: 0.785 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7903945446014404
Epoch: 6, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6970100402832031
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7239747047424316
Epoch: 8, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.810 Vali Acc: 0.520 Test Loss: 0.810 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7523324489593506
Epoch: 9, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4425556659698486
Epoch: 10, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.777 Vali Acc: 0.560 Test Loss: 0.777 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.565734624862671
Epoch: 11, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4379396438598633
Epoch: 12, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.796 Vali Acc: 0.530 Test Loss: 0.796 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el3_dm16_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 16354
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.213066339492798
Epoch: 1, Steps: 20 | Train Loss: 0.984 Vali Loss: 1.314 Vali Acc: 0.470 Test Loss: 1.314 Test Acc: 0.470
Validation loss decreased (inf --> -0.469987).  Saving model ...
Epoch: 2 cost time: 4.416795492172241
Epoch: 2, Steps: 20 | Train Loss: 1.299 Vali Loss: 3.544 Vali Acc: 0.490 Test Loss: 3.544 Test Acc: 0.490
Validation loss decreased (-0.469987 --> -0.489965).  Saving model ...
Epoch: 3 cost time: 4.346308946609497
Epoch: 3, Steps: 20 | Train Loss: 1.490 Vali Loss: 1.844 Vali Acc: 0.520 Test Loss: 1.844 Test Acc: 0.520
Validation loss decreased (-0.489965 --> -0.519982).  Saving model ...
Epoch: 4 cost time: 4.382107496261597
Epoch: 4, Steps: 20 | Train Loss: 1.420 Vali Loss: 1.959 Vali Acc: 0.500 Test Loss: 1.959 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.275842666625977
Epoch: 5, Steps: 20 | Train Loss: 1.346 Vali Loss: 2.457 Vali Acc: 0.600 Test Loss: 2.457 Test Acc: 0.600
Validation loss decreased (-0.519982 --> -0.599975).  Saving model ...
Epoch: 6 cost time: 4.137324810028076
Epoch: 6, Steps: 20 | Train Loss: 1.517 Vali Loss: 2.994 Vali Acc: 0.480 Test Loss: 2.994 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.253333330154419
Epoch: 7, Steps: 20 | Train Loss: 1.422 Vali Loss: 5.939 Vali Acc: 0.510 Test Loss: 5.939 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.121540546417236
Epoch: 8, Steps: 20 | Train Loss: 2.152 Vali Loss: 8.245 Vali Acc: 0.500 Test Loss: 8.245 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.204126834869385
Epoch: 9, Steps: 20 | Train Loss: 2.082 Vali Loss: 6.832 Vali Acc: 0.540 Test Loss: 6.832 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.9573216438293457
Epoch: 10, Steps: 20 | Train Loss: 1.902 Vali Loss: 3.699 Vali Acc: 0.510 Test Loss: 3.699 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.544234991073608
Epoch: 11, Steps: 20 | Train Loss: 1.447 Vali Loss: 4.711 Vali Acc: 0.540 Test Loss: 4.711 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.3081512451171875
Epoch: 12, Steps: 20 | Train Loss: 0.821 Vali Loss: 5.080 Vali Acc: 0.460 Test Loss: 5.080 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.358152151107788
Epoch: 13, Steps: 20 | Train Loss: 1.140 Vali Loss: 5.974 Vali Acc: 0.440 Test Loss: 5.974 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.250942230224609
Epoch: 14, Steps: 20 | Train Loss: 0.652 Vali Loss: 4.022 Vali Acc: 0.540 Test Loss: 4.022 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.062322616577148
Epoch: 15, Steps: 20 | Train Loss: 0.673 Vali Loss: 6.576 Vali Acc: 0.500 Test Loss: 6.576 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 623874
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.8199238777160645
Epoch: 1, Steps: 20 | Train Loss: 0.981 Vali Loss: 0.950 Vali Acc: 0.430 Test Loss: 0.950 Test Acc: 0.430
Validation loss decreased (inf --> -0.429991).  Saving model ...
Epoch: 2 cost time: 2.852046489715576
Epoch: 2, Steps: 20 | Train Loss: 0.978 Vali Loss: 1.195 Vali Acc: 0.490 Test Loss: 1.195 Test Acc: 0.490
Validation loss decreased (-0.429991 --> -0.489988).  Saving model ...
Epoch: 3 cost time: 3.079434394836426
Epoch: 3, Steps: 20 | Train Loss: 1.159 Vali Loss: 1.644 Vali Acc: 0.560 Test Loss: 1.644 Test Acc: 0.560
Validation loss decreased (-0.489988 --> -0.559984).  Saving model ...
Epoch: 4 cost time: 3.4239635467529297
Epoch: 4, Steps: 20 | Train Loss: 0.893 Vali Loss: 1.067 Vali Acc: 0.550 Test Loss: 1.067 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4628500938415527
Epoch: 5, Steps: 20 | Train Loss: 0.921 Vali Loss: 3.113 Vali Acc: 0.560 Test Loss: 3.113 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.562840223312378
Epoch: 6, Steps: 20 | Train Loss: 1.090 Vali Loss: 1.984 Vali Acc: 0.520 Test Loss: 1.984 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.3650577068328857
Epoch: 7, Steps: 20 | Train Loss: 0.813 Vali Loss: 2.093 Vali Acc: 0.490 Test Loss: 2.093 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.44581937789917
Epoch: 8, Steps: 20 | Train Loss: 1.126 Vali Loss: 1.892 Vali Acc: 0.470 Test Loss: 1.892 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.5831568241119385
Epoch: 9, Steps: 20 | Train Loss: 0.560 Vali Loss: 1.976 Vali Acc: 0.510 Test Loss: 1.976 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.5012900829315186
Epoch: 10, Steps: 20 | Train Loss: 0.547 Vali Loss: 3.438 Vali Acc: 0.500 Test Loss: 3.438 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.3291525840759277
Epoch: 11, Steps: 20 | Train Loss: 0.694 Vali Loss: 3.232 Vali Acc: 0.500 Test Loss: 3.232 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.6589035987854004
Epoch: 12, Steps: 20 | Train Loss: 0.612 Vali Loss: 3.718 Vali Acc: 0.500 Test Loss: 3.718 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.205246925354004
Epoch: 13, Steps: 20 | Train Loss: 0.571 Vali Loss: 3.174 Vali Acc: 0.480 Test Loss: 3.174 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 444802
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.777421712875366
Epoch: 1, Steps: 20 | Train Loss: 0.814 Vali Loss: 1.001 Vali Acc: 0.500 Test Loss: 1.001 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 2.829052448272705
Epoch: 2, Steps: 20 | Train Loss: 0.972 Vali Loss: 1.156 Vali Acc: 0.530 Test Loss: 1.156 Test Acc: 0.530
Validation loss decreased (-0.499990 --> -0.529988).  Saving model ...
Epoch: 3 cost time: 3.21622371673584
Epoch: 3, Steps: 20 | Train Loss: 0.959 Vali Loss: 1.242 Vali Acc: 0.520 Test Loss: 1.242 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.227700710296631
Epoch: 4, Steps: 20 | Train Loss: 0.924 Vali Loss: 1.617 Vali Acc: 0.450 Test Loss: 1.617 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0289573669433594
Epoch: 5, Steps: 20 | Train Loss: 0.875 Vali Loss: 1.225 Vali Acc: 0.550 Test Loss: 1.225 Test Acc: 0.550
Validation loss decreased (-0.529988 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 3.040079116821289
Epoch: 6, Steps: 20 | Train Loss: 0.704 Vali Loss: 1.722 Vali Acc: 0.500 Test Loss: 1.722 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9598889350891113
Epoch: 7, Steps: 20 | Train Loss: 0.953 Vali Loss: 1.830 Vali Acc: 0.550 Test Loss: 1.830 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0236332416534424
Epoch: 8, Steps: 20 | Train Loss: 0.920 Vali Loss: 2.069 Vali Acc: 0.520 Test Loss: 2.069 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.025672197341919
Epoch: 9, Steps: 20 | Train Loss: 0.576 Vali Loss: 2.073 Vali Acc: 0.520 Test Loss: 2.073 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2485105991363525
Epoch: 10, Steps: 20 | Train Loss: 0.607 Vali Loss: 2.416 Vali Acc: 0.480 Test Loss: 2.416 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1446259021759033
Epoch: 11, Steps: 20 | Train Loss: 1.283 Vali Loss: 4.871 Vali Acc: 0.510 Test Loss: 4.871 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.176058292388916
Epoch: 12, Steps: 20 | Train Loss: 1.362 Vali Loss: 3.260 Vali Acc: 0.510 Test Loss: 3.260 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8574812412261963
Epoch: 13, Steps: 20 | Train Loss: 0.660 Vali Loss: 3.344 Vali Acc: 0.540 Test Loss: 3.344 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.005647897720337
Epoch: 14, Steps: 20 | Train Loss: 0.423 Vali Loss: 4.281 Vali Acc: 0.500 Test Loss: 4.281 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.9569053649902344
Epoch: 15, Steps: 20 | Train Loss: 0.525 Vali Loss: 5.263 Vali Acc: 0.480 Test Loss: 5.263 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 444930
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.074148893356323
Epoch: 1, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.888 Vali Acc: 0.510 Test Loss: 0.888 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 2.3307104110717773
Epoch: 2, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.881 Vali Acc: 0.410 Test Loss: 0.881 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.335881233215332
Epoch: 3, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.960 Vali Acc: 0.440 Test Loss: 0.960 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.249518394470215
Epoch: 4, Steps: 20 | Train Loss: 0.611 Vali Loss: 1.149 Vali Acc: 0.530 Test Loss: 1.149 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529989).  Saving model ...
Epoch: 5 cost time: 2.367922067642212
Epoch: 5, Steps: 20 | Train Loss: 0.710 Vali Loss: 1.234 Vali Acc: 0.540 Test Loss: 1.234 Test Acc: 0.540
Validation loss decreased (-0.529989 --> -0.539988).  Saving model ...
Epoch: 6 cost time: 2.317918539047241
Epoch: 6, Steps: 20 | Train Loss: 0.648 Vali Loss: 1.749 Vali Acc: 0.500 Test Loss: 1.749 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3739099502563477
Epoch: 7, Steps: 20 | Train Loss: 0.556 Vali Loss: 2.787 Vali Acc: 0.530 Test Loss: 2.787 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.330962657928467
Epoch: 8, Steps: 20 | Train Loss: 0.733 Vali Loss: 1.521 Vali Acc: 0.480 Test Loss: 1.521 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3383238315582275
Epoch: 9, Steps: 20 | Train Loss: 0.507 Vali Loss: 2.437 Vali Acc: 0.500 Test Loss: 2.437 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.265056610107422
Epoch: 10, Steps: 20 | Train Loss: 0.650 Vali Loss: 2.137 Vali Acc: 0.440 Test Loss: 2.137 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2747485637664795
Epoch: 11, Steps: 20 | Train Loss: 0.569 Vali Loss: 2.339 Vali Acc: 0.490 Test Loss: 2.339 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2519211769104004
Epoch: 12, Steps: 20 | Train Loss: 0.510 Vali Loss: 2.328 Vali Acc: 0.480 Test Loss: 2.328 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.30196475982666
Epoch: 13, Steps: 20 | Train Loss: 0.287 Vali Loss: 2.144 Vali Acc: 0.480 Test Loss: 2.144 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.165726900100708
Epoch: 14, Steps: 20 | Train Loss: 0.380 Vali Loss: 2.850 Vali Acc: 0.510 Test Loss: 2.850 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1158649921417236
Epoch: 15, Steps: 20 | Train Loss: 0.271 Vali Loss: 2.633 Vali Acc: 0.450 Test Loss: 2.633 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 387714
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9083993434906006
Epoch: 1, Steps: 20 | Train Loss: 0.837 Vali Loss: 0.834 Vali Acc: 0.540 Test Loss: 0.834 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 2.1925694942474365
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.827 Vali Acc: 0.480 Test Loss: 0.827 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.180821418762207
Epoch: 3, Steps: 20 | Train Loss: 0.706 Vali Loss: 1.060 Vali Acc: 0.450 Test Loss: 1.060 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.037320375442505
Epoch: 4, Steps: 20 | Train Loss: 0.753 Vali Loss: 1.002 Vali Acc: 0.530 Test Loss: 1.002 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9896161556243896
Epoch: 5, Steps: 20 | Train Loss: 0.621 Vali Loss: 1.139 Vali Acc: 0.450 Test Loss: 1.139 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0730912685394287
Epoch: 6, Steps: 20 | Train Loss: 0.623 Vali Loss: 1.262 Vali Acc: 0.530 Test Loss: 1.262 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2173235416412354
Epoch: 7, Steps: 20 | Train Loss: 0.527 Vali Loss: 1.183 Vali Acc: 0.520 Test Loss: 1.183 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0393295288085938
Epoch: 8, Steps: 20 | Train Loss: 0.539 Vali Loss: 1.298 Vali Acc: 0.520 Test Loss: 1.298 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1607842445373535
Epoch: 9, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.508 Vali Acc: 0.520 Test Loss: 1.508 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.112773895263672
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 1.581 Vali Acc: 0.520 Test Loss: 1.581 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.280301332473755
Epoch: 11, Steps: 20 | Train Loss: 0.503 Vali Loss: 1.556 Vali Acc: 0.510 Test Loss: 1.556 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 352258
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9593145847320557
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.901 Vali Acc: 0.530 Test Loss: 0.901 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 2.0779008865356445
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.948 Vali Acc: 0.450 Test Loss: 0.948 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9993159770965576
Epoch: 3, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.939 Vali Acc: 0.550 Test Loss: 0.939 Test Acc: 0.550
Validation loss decreased (-0.529991 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 2.037855863571167
Epoch: 4, Steps: 20 | Train Loss: 0.603 Vali Loss: 1.097 Vali Acc: 0.540 Test Loss: 1.097 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.040400266647339
Epoch: 5, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.979 Vali Acc: 0.510 Test Loss: 0.979 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.061328172683716
Epoch: 6, Steps: 20 | Train Loss: 0.513 Vali Loss: 1.073 Vali Acc: 0.540 Test Loss: 1.073 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0318634510040283
Epoch: 7, Steps: 20 | Train Loss: 0.696 Vali Loss: 1.728 Vali Acc: 0.500 Test Loss: 1.728 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.083719253540039
Epoch: 8, Steps: 20 | Train Loss: 0.589 Vali Loss: 1.076 Vali Acc: 0.500 Test Loss: 1.076 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.166221857070923
Epoch: 9, Steps: 20 | Train Loss: 0.533 Vali Loss: 1.538 Vali Acc: 0.470 Test Loss: 1.538 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.090312957763672
Epoch: 10, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.732 Vali Acc: 0.500 Test Loss: 1.732 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.110851287841797
Epoch: 11, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.760 Vali Acc: 0.450 Test Loss: 1.760 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.174769163131714
Epoch: 12, Steps: 20 | Train Loss: 0.464 Vali Loss: 1.764 Vali Acc: 0.510 Test Loss: 1.764 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0810515880584717
Epoch: 13, Steps: 20 | Train Loss: 0.478 Vali Loss: 1.686 Vali Acc: 0.470 Test Loss: 1.686 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 338178
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7851619720458984
Epoch: 1, Steps: 20 | Train Loss: 0.770 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.07175874710083
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.848 Vali Acc: 0.520 Test Loss: 0.848 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 1.8305699825286865
Epoch: 3, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.882 Vali Acc: 0.520 Test Loss: 0.882 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7782392501831055
Epoch: 4, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.876 Vali Acc: 0.540 Test Loss: 0.876 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539991).  Saving model ...
Epoch: 5 cost time: 1.7500154972076416
Epoch: 5, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.901 Vali Acc: 0.520 Test Loss: 0.901 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.970806360244751
Epoch: 6, Steps: 20 | Train Loss: 0.552 Vali Loss: 1.144 Vali Acc: 0.470 Test Loss: 1.144 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7429289817810059
Epoch: 7, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.997 Vali Acc: 0.560 Test Loss: 0.997 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559990).  Saving model ...
Epoch: 8 cost time: 2.097560405731201
Epoch: 8, Steps: 20 | Train Loss: 0.494 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.931842565536499
Epoch: 9, Steps: 20 | Train Loss: 0.503 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8728423118591309
Epoch: 10, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.624 Vali Acc: 0.510 Test Loss: 1.624 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8665499687194824
Epoch: 11, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.420 Vali Acc: 0.520 Test Loss: 1.420 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.049006223678589
Epoch: 12, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.252 Vali Acc: 0.530 Test Loss: 1.252 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.938415288925171
Epoch: 13, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.559 Vali Acc: 0.490 Test Loss: 1.559 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0339436531066895
Epoch: 14, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.299 Vali Acc: 0.550 Test Loss: 1.299 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7087249755859375
Epoch: 15, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.435 Vali Acc: 0.510 Test Loss: 1.435 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.836136817932129
Epoch: 16, Steps: 20 | Train Loss: 0.230 Vali Loss: 1.593 Vali Acc: 0.510 Test Loss: 1.593 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6118032932281494
Epoch: 17, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.951 Vali Acc: 0.470 Test Loss: 1.951 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 317058
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.37650990486145
Epoch: 1, Steps: 20 | Train Loss: 1.051 Vali Loss: 1.457 Vali Acc: 0.460 Test Loss: 1.457 Test Acc: 0.460
Validation loss decreased (inf --> -0.459985).  Saving model ...
Epoch: 2 cost time: 3.1930041313171387
Epoch: 2, Steps: 20 | Train Loss: 1.222 Vali Loss: 1.241 Vali Acc: 0.560 Test Loss: 1.241 Test Acc: 0.560
Validation loss decreased (-0.459985 --> -0.559988).  Saving model ...
Epoch: 3 cost time: 3.386434555053711
Epoch: 3, Steps: 20 | Train Loss: 1.252 Vali Loss: 2.551 Vali Acc: 0.470 Test Loss: 2.551 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8711228370666504
Epoch: 4, Steps: 20 | Train Loss: 1.409 Vali Loss: 3.593 Vali Acc: 0.480 Test Loss: 3.593 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.573758125305176
Epoch: 5, Steps: 20 | Train Loss: 1.194 Vali Loss: 3.966 Vali Acc: 0.500 Test Loss: 3.966 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.7108640670776367
Epoch: 6, Steps: 20 | Train Loss: 2.003 Vali Loss: 2.828 Vali Acc: 0.610 Test Loss: 2.828 Test Acc: 0.610
Validation loss decreased (-0.559988 --> -0.609972).  Saving model ...
Epoch: 7 cost time: 3.4497017860412598
Epoch: 7, Steps: 20 | Train Loss: 1.320 Vali Loss: 2.875 Vali Acc: 0.540 Test Loss: 2.875 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.063292980194092
Epoch: 8, Steps: 20 | Train Loss: 1.236 Vali Loss: 2.710 Vali Acc: 0.510 Test Loss: 2.710 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7659199237823486
Epoch: 9, Steps: 20 | Train Loss: 1.036 Vali Loss: 3.909 Vali Acc: 0.480 Test Loss: 3.909 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7389719486236572
Epoch: 10, Steps: 20 | Train Loss: 0.821 Vali Loss: 4.050 Vali Acc: 0.510 Test Loss: 4.050 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.694831609725952
Epoch: 11, Steps: 20 | Train Loss: 0.695 Vali Loss: 6.671 Vali Acc: 0.500 Test Loss: 6.671 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.6984174251556396
Epoch: 12, Steps: 20 | Train Loss: 0.932 Vali Loss: 5.140 Vali Acc: 0.550 Test Loss: 5.140 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.468604326248169
Epoch: 13, Steps: 20 | Train Loss: 1.527 Vali Loss: 5.647 Vali Acc: 0.470 Test Loss: 5.647 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.114201068878174
Epoch: 14, Steps: 20 | Train Loss: 1.184 Vali Loss: 6.388 Vali Acc: 0.500 Test Loss: 6.388 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.648331880569458
Epoch: 15, Steps: 20 | Train Loss: 1.005 Vali Loss: 7.852 Vali Acc: 0.510 Test Loss: 7.852 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.174407243728638
Epoch: 16, Steps: 20 | Train Loss: 1.169 Vali Loss: 6.103 Vali Acc: 0.570 Test Loss: 6.103 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 558082
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.683449745178223
Epoch: 1, Steps: 20 | Train Loss: 0.871 Vali Loss: 0.900 Vali Acc: 0.510 Test Loss: 0.900 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 2.6480960845947266
Epoch: 2, Steps: 20 | Train Loss: 0.878 Vali Loss: 1.053 Vali Acc: 0.460 Test Loss: 1.053 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.665351390838623
Epoch: 3, Steps: 20 | Train Loss: 1.072 Vali Loss: 2.040 Vali Acc: 0.510 Test Loss: 2.040 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.565800666809082
Epoch: 4, Steps: 20 | Train Loss: 0.999 Vali Loss: 1.496 Vali Acc: 0.500 Test Loss: 1.496 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5528249740600586
Epoch: 5, Steps: 20 | Train Loss: 0.659 Vali Loss: 1.618 Vali Acc: 0.410 Test Loss: 1.618 Test Acc: 0.410
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.731337785720825
Epoch: 6, Steps: 20 | Train Loss: 0.683 Vali Loss: 1.446 Vali Acc: 0.540 Test Loss: 1.446 Test Acc: 0.540
Validation loss decreased (-0.509991 --> -0.539986).  Saving model ...
Epoch: 7 cost time: 2.658705949783325
Epoch: 7, Steps: 20 | Train Loss: 0.719 Vali Loss: 2.197 Vali Acc: 0.540 Test Loss: 2.197 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.599740743637085
Epoch: 8, Steps: 20 | Train Loss: 0.725 Vali Loss: 2.160 Vali Acc: 0.560 Test Loss: 2.160 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559978).  Saving model ...
Epoch: 9 cost time: 2.661653995513916
Epoch: 9, Steps: 20 | Train Loss: 0.888 Vali Loss: 2.583 Vali Acc: 0.550 Test Loss: 2.583 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6316912174224854
Epoch: 10, Steps: 20 | Train Loss: 0.800 Vali Loss: 2.793 Vali Acc: 0.450 Test Loss: 2.793 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7219743728637695
Epoch: 11, Steps: 20 | Train Loss: 0.442 Vali Loss: 2.390 Vali Acc: 0.480 Test Loss: 2.390 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7809293270111084
Epoch: 12, Steps: 20 | Train Loss: 0.544 Vali Loss: 2.562 Vali Acc: 0.480 Test Loss: 2.562 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.01328706741333
Epoch: 13, Steps: 20 | Train Loss: 0.696 Vali Loss: 4.014 Vali Acc: 0.540 Test Loss: 4.014 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5116310119628906
Epoch: 14, Steps: 20 | Train Loss: 0.700 Vali Loss: 5.254 Vali Acc: 0.490 Test Loss: 5.254 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.469531774520874
Epoch: 15, Steps: 20 | Train Loss: 0.781 Vali Loss: 5.247 Vali Acc: 0.510 Test Loss: 5.247 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7376809120178223
Epoch: 16, Steps: 20 | Train Loss: 0.722 Vali Loss: 4.552 Vali Acc: 0.440 Test Loss: 4.552 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.78312349319458
Epoch: 17, Steps: 20 | Train Loss: 0.305 Vali Loss: 4.032 Vali Acc: 0.500 Test Loss: 4.032 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6783597469329834
Epoch: 18, Steps: 20 | Train Loss: 0.288 Vali Loss: 4.513 Vali Acc: 0.500 Test Loss: 4.513 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 379010
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.380129814147949
Epoch: 1, Steps: 20 | Train Loss: 0.832 Vali Loss: 1.132 Vali Acc: 0.520 Test Loss: 1.132 Test Acc: 0.520
Validation loss decreased (inf --> -0.519989).  Saving model ...
Epoch: 2 cost time: 2.4764816761016846
Epoch: 2, Steps: 20 | Train Loss: 0.849 Vali Loss: 1.358 Vali Acc: 0.490 Test Loss: 1.358 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5560355186462402
Epoch: 3, Steps: 20 | Train Loss: 0.929 Vali Loss: 1.478 Vali Acc: 0.520 Test Loss: 1.478 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.27618145942688
Epoch: 4, Steps: 20 | Train Loss: 0.728 Vali Loss: 1.355 Vali Acc: 0.500 Test Loss: 1.355 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3621273040771484
Epoch: 5, Steps: 20 | Train Loss: 0.817 Vali Loss: 1.706 Vali Acc: 0.530 Test Loss: 1.706 Test Acc: 0.530
Validation loss decreased (-0.519989 --> -0.529983).  Saving model ...
Epoch: 6 cost time: 2.5937905311584473
Epoch: 6, Steps: 20 | Train Loss: 0.755 Vali Loss: 2.078 Vali Acc: 0.510 Test Loss: 2.078 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9752159118652344
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 1.705 Vali Acc: 0.500 Test Loss: 1.705 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9205260276794434
Epoch: 8, Steps: 20 | Train Loss: 0.716 Vali Loss: 2.561 Vali Acc: 0.510 Test Loss: 2.561 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8231401443481445
Epoch: 9, Steps: 20 | Train Loss: 0.768 Vali Loss: 2.208 Vali Acc: 0.460 Test Loss: 2.208 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6743171215057373
Epoch: 10, Steps: 20 | Train Loss: 0.616 Vali Loss: 2.393 Vali Acc: 0.520 Test Loss: 2.393 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.6431398391723633
Epoch: 11, Steps: 20 | Train Loss: 0.597 Vali Loss: 3.480 Vali Acc: 0.460 Test Loss: 3.480 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.652456045150757
Epoch: 12, Steps: 20 | Train Loss: 0.471 Vali Loss: 2.932 Vali Acc: 0.510 Test Loss: 2.932 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3850090503692627
Epoch: 13, Steps: 20 | Train Loss: 0.603 Vali Loss: 4.664 Vali Acc: 0.480 Test Loss: 4.664 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.010199785232544
Epoch: 14, Steps: 20 | Train Loss: 0.629 Vali Loss: 2.964 Vali Acc: 0.490 Test Loss: 2.964 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.647921562194824
Epoch: 15, Steps: 20 | Train Loss: 0.460 Vali Loss: 3.841 Vali Acc: 0.560 Test Loss: 3.841 Test Acc: 0.560
Validation loss decreased (-0.529983 --> -0.559962).  Saving model ...
Epoch: 16 cost time: 2.818469524383545
Epoch: 16, Steps: 20 | Train Loss: 0.572 Vali Loss: 3.836 Vali Acc: 0.520 Test Loss: 3.836 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.738701581954956
Epoch: 17, Steps: 20 | Train Loss: 0.285 Vali Loss: 3.814 Vali Acc: 0.470 Test Loss: 3.814 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.489441394805908
Epoch: 18, Steps: 20 | Train Loss: 0.440 Vali Loss: 4.027 Vali Acc: 0.530 Test Loss: 4.027 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.7639307975769043
Epoch: 19, Steps: 20 | Train Loss: 0.148 Vali Loss: 4.725 Vali Acc: 0.520 Test Loss: 4.725 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5661706924438477
Epoch: 20, Steps: 20 | Train Loss: 0.338 Vali Loss: 5.134 Vali Acc: 0.490 Test Loss: 5.134 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.667663097381592
Epoch: 21, Steps: 20 | Train Loss: 0.263 Vali Loss: 5.534 Vali Acc: 0.510 Test Loss: 5.534 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5673367977142334
Epoch: 22, Steps: 20 | Train Loss: 0.285 Vali Loss: 5.692 Vali Acc: 0.540 Test Loss: 5.692 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.592860221862793
Epoch: 23, Steps: 20 | Train Loss: 0.242 Vali Loss: 6.766 Vali Acc: 0.480 Test Loss: 6.766 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.502432346343994
Epoch: 24, Steps: 20 | Train Loss: 0.137 Vali Loss: 6.349 Vali Acc: 0.560 Test Loss: 6.349 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.7931745052337646
Epoch: 25, Steps: 20 | Train Loss: 0.432 Vali Loss: 6.259 Vali Acc: 0.520 Test Loss: 6.259 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 379138
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8612701892852783
Epoch: 1, Steps: 20 | Train Loss: 0.850 Vali Loss: 0.854 Vali Acc: 0.410 Test Loss: 0.854 Test Acc: 0.410
Validation loss decreased (inf --> -0.409991).  Saving model ...
Epoch: 2 cost time: 2.146204948425293
Epoch: 2, Steps: 20 | Train Loss: 0.902 Vali Loss: 1.260 Vali Acc: 0.580 Test Loss: 1.260 Test Acc: 0.580
Validation loss decreased (-0.409991 --> -0.579987).  Saving model ...
Epoch: 3 cost time: 2.2020723819732666
Epoch: 3, Steps: 20 | Train Loss: 0.893 Vali Loss: 1.272 Vali Acc: 0.440 Test Loss: 1.272 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.075420379638672
Epoch: 4, Steps: 20 | Train Loss: 0.772 Vali Loss: 1.428 Vali Acc: 0.520 Test Loss: 1.428 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9937865734100342
Epoch: 5, Steps: 20 | Train Loss: 0.819 Vali Loss: 1.353 Vali Acc: 0.510 Test Loss: 1.353 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.013514757156372
Epoch: 6, Steps: 20 | Train Loss: 0.694 Vali Loss: 1.792 Vali Acc: 0.500 Test Loss: 1.792 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6931819915771484
Epoch: 7, Steps: 20 | Train Loss: 0.629 Vali Loss: 1.960 Vali Acc: 0.470 Test Loss: 1.960 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7642645835876465
Epoch: 8, Steps: 20 | Train Loss: 0.545 Vali Loss: 1.583 Vali Acc: 0.500 Test Loss: 1.583 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.050043821334839
Epoch: 9, Steps: 20 | Train Loss: 0.468 Vali Loss: 1.776 Vali Acc: 0.490 Test Loss: 1.776 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.2150843143463135
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 2.508 Vali Acc: 0.450 Test Loss: 2.508 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1374473571777344
Epoch: 11, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.967 Vali Acc: 0.510 Test Loss: 1.967 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.26163911819458
Epoch: 12, Steps: 20 | Train Loss: 0.380 Vali Loss: 2.295 Vali Acc: 0.520 Test Loss: 2.295 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 321922
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8880529403686523
Epoch: 1, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.9413833618164062
Epoch: 2, Steps: 20 | Train Loss: 0.805 Vali Loss: 1.063 Vali Acc: 0.430 Test Loss: 1.063 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.210559844970703
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.912 Vali Acc: 0.540 Test Loss: 0.912 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539991).  Saving model ...
Epoch: 4 cost time: 2.4084105491638184
Epoch: 4, Steps: 20 | Train Loss: 0.750 Vali Loss: 1.173 Vali Acc: 0.530 Test Loss: 1.173 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.017559766769409
Epoch: 5, Steps: 20 | Train Loss: 0.806 Vali Loss: 1.463 Vali Acc: 0.440 Test Loss: 1.463 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8790247440338135
Epoch: 6, Steps: 20 | Train Loss: 0.714 Vali Loss: 1.316 Vali Acc: 0.510 Test Loss: 1.316 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9793901443481445
Epoch: 7, Steps: 20 | Train Loss: 0.509 Vali Loss: 1.366 Vali Acc: 0.520 Test Loss: 1.366 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7117037773132324
Epoch: 8, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.444 Vali Acc: 0.400 Test Loss: 1.444 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.02292537689209
Epoch: 9, Steps: 20 | Train Loss: 0.521 Vali Loss: 2.180 Vali Acc: 0.520 Test Loss: 2.180 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.941527843475342
Epoch: 10, Steps: 20 | Train Loss: 0.592 Vali Loss: 1.567 Vali Acc: 0.550 Test Loss: 1.567 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549984).  Saving model ...
Epoch: 11 cost time: 2.93603777885437
Epoch: 11, Steps: 20 | Train Loss: 0.533 Vali Loss: 2.014 Vali Acc: 0.460 Test Loss: 2.014 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.169731855392456
Epoch: 12, Steps: 20 | Train Loss: 0.607 Vali Loss: 2.144 Vali Acc: 0.570 Test Loss: 2.144 Test Acc: 0.570
Validation loss decreased (-0.549984 --> -0.569979).  Saving model ...
Epoch: 13 cost time: 3.185551404953003
Epoch: 13, Steps: 20 | Train Loss: 0.444 Vali Loss: 1.708 Vali Acc: 0.520 Test Loss: 1.708 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1359024047851562
Epoch: 14, Steps: 20 | Train Loss: 0.400 Vali Loss: 2.379 Vali Acc: 0.580 Test Loss: 2.379 Test Acc: 0.580
Validation loss decreased (-0.569979 --> -0.579976).  Saving model ...
Epoch: 15 cost time: 3.024245262145996
Epoch: 15, Steps: 20 | Train Loss: 0.383 Vali Loss: 2.420 Vali Acc: 0.470 Test Loss: 2.420 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9990811347961426
Epoch: 16, Steps: 20 | Train Loss: 0.281 Vali Loss: 2.475 Vali Acc: 0.470 Test Loss: 2.475 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.991837739944458
Epoch: 17, Steps: 20 | Train Loss: 0.325 Vali Loss: 2.154 Vali Acc: 0.470 Test Loss: 2.154 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.982142686843872
Epoch: 18, Steps: 20 | Train Loss: 0.257 Vali Loss: 2.150 Vali Acc: 0.600 Test Loss: 2.150 Test Acc: 0.600
Validation loss decreased (-0.579976 --> -0.599978).  Saving model ...
Epoch: 19 cost time: 2.8315672874450684
Epoch: 19, Steps: 20 | Train Loss: 0.180 Vali Loss: 2.315 Vali Acc: 0.500 Test Loss: 2.315 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.990149736404419
Epoch: 20, Steps: 20 | Train Loss: 0.181 Vali Loss: 2.604 Vali Acc: 0.550 Test Loss: 2.604 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6574344635009766
Epoch: 21, Steps: 20 | Train Loss: 0.251 Vali Loss: 3.077 Vali Acc: 0.490 Test Loss: 3.077 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.612551689147949
Epoch: 22, Steps: 20 | Train Loss: 0.250 Vali Loss: 2.823 Vali Acc: 0.520 Test Loss: 2.823 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.550135850906372
Epoch: 23, Steps: 20 | Train Loss: 0.213 Vali Loss: 2.967 Vali Acc: 0.490 Test Loss: 2.967 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.7715446949005127
Epoch: 24, Steps: 20 | Train Loss: 0.333 Vali Loss: 3.160 Vali Acc: 0.450 Test Loss: 3.160 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5389633178710938
Epoch: 25, Steps: 20 | Train Loss: 0.118 Vali Loss: 3.843 Vali Acc: 0.480 Test Loss: 3.843 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.8583250045776367
Epoch: 26, Steps: 20 | Train Loss: 0.102 Vali Loss: 3.199 Vali Acc: 0.530 Test Loss: 3.199 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.880831718444824
Epoch: 27, Steps: 20 | Train Loss: 0.300 Vali Loss: 3.548 Vali Acc: 0.540 Test Loss: 3.548 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.791002035140991
Epoch: 28, Steps: 20 | Train Loss: 0.077 Vali Loss: 3.601 Vali Acc: 0.550 Test Loss: 3.601 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 286466
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.620814561843872
Epoch: 1, Steps: 20 | Train Loss: 0.802 Vali Loss: 0.846 Vali Acc: 0.480 Test Loss: 0.846 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 3.068216562271118
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.898 Vali Acc: 0.530 Test Loss: 0.898 Test Acc: 0.530
Validation loss decreased (-0.479992 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 3.0216071605682373
Epoch: 3, Steps: 20 | Train Loss: 0.740 Vali Loss: 1.079 Vali Acc: 0.540 Test Loss: 1.079 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539989).  Saving model ...
Epoch: 4 cost time: 2.5465893745422363
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.992 Vali Acc: 0.530 Test Loss: 0.992 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.771766424179077
Epoch: 5, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.998 Vali Acc: 0.540 Test Loss: 0.998 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539990).  Saving model ...
Epoch: 6 cost time: 2.5022146701812744
Epoch: 6, Steps: 20 | Train Loss: 0.530 Vali Loss: 1.141 Vali Acc: 0.550 Test Loss: 1.141 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 2.5034666061401367
Epoch: 7, Steps: 20 | Train Loss: 0.488 Vali Loss: 1.182 Vali Acc: 0.460 Test Loss: 1.182 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.688046455383301
Epoch: 8, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.197 Vali Acc: 0.460 Test Loss: 1.197 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6590240001678467
Epoch: 9, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.597 Vali Acc: 0.520 Test Loss: 1.597 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9465677738189697
Epoch: 10, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.370 Vali Acc: 0.480 Test Loss: 1.370 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0275533199310303
Epoch: 11, Steps: 20 | Train Loss: 0.411 Vali Loss: 1.508 Vali Acc: 0.460 Test Loss: 1.508 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.893200159072876
Epoch: 12, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.720 Vali Acc: 0.570 Test Loss: 1.720 Test Acc: 0.570
Validation loss decreased (-0.549989 --> -0.569983).  Saving model ...
Epoch: 13 cost time: 2.7620370388031006
Epoch: 13, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.765 Vali Acc: 0.510 Test Loss: 1.765 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7918918132781982
Epoch: 14, Steps: 20 | Train Loss: 0.534 Vali Loss: 2.489 Vali Acc: 0.470 Test Loss: 2.489 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6461329460144043
Epoch: 15, Steps: 20 | Train Loss: 0.336 Vali Loss: 1.820 Vali Acc: 0.510 Test Loss: 1.820 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.033257484436035
Epoch: 16, Steps: 20 | Train Loss: 0.306 Vali Loss: 2.187 Vali Acc: 0.510 Test Loss: 2.187 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.95146107673645
Epoch: 17, Steps: 20 | Train Loss: 0.353 Vali Loss: 2.218 Vali Acc: 0.500 Test Loss: 2.218 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.879237174987793
Epoch: 18, Steps: 20 | Train Loss: 0.287 Vali Loss: 2.362 Vali Acc: 0.440 Test Loss: 2.362 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.0565454959869385
Epoch: 19, Steps: 20 | Train Loss: 0.169 Vali Loss: 2.210 Vali Acc: 0.500 Test Loss: 2.210 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.890878438949585
Epoch: 20, Steps: 20 | Train Loss: 0.274 Vali Loss: 3.191 Vali Acc: 0.490 Test Loss: 3.191 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.704775094985962
Epoch: 21, Steps: 20 | Train Loss: 0.210 Vali Loss: 3.406 Vali Acc: 0.460 Test Loss: 3.406 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.556755542755127
Epoch: 22, Steps: 20 | Train Loss: 0.168 Vali Loss: 3.262 Vali Acc: 0.520 Test Loss: 3.262 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 272386
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.785091876983643
Epoch: 1, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.803 Vali Acc: 0.540 Test Loss: 0.803 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 2.948011636734009
Epoch: 2, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.861 Vali Acc: 0.530 Test Loss: 0.861 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.184375286102295
Epoch: 3, Steps: 20 | Train Loss: 0.642 Vali Loss: 1.038 Vali Acc: 0.500 Test Loss: 1.038 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1381726264953613
Epoch: 4, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.995 Vali Acc: 0.480 Test Loss: 0.995 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.958028554916382
Epoch: 5, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.880 Vali Acc: 0.500 Test Loss: 0.880 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.734741449356079
Epoch: 6, Steps: 20 | Train Loss: 0.556 Vali Loss: 1.043 Vali Acc: 0.530 Test Loss: 1.043 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8660080432891846
Epoch: 7, Steps: 20 | Train Loss: 0.510 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 2.669990062713623
Epoch: 8, Steps: 20 | Train Loss: 0.576 Vali Loss: 1.382 Vali Acc: 0.540 Test Loss: 1.382 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4225783348083496
Epoch: 9, Steps: 20 | Train Loss: 0.527 Vali Loss: 1.085 Vali Acc: 0.540 Test Loss: 1.085 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.424896717071533
Epoch: 10, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.526 Vali Acc: 0.440 Test Loss: 1.526 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3223628997802734
Epoch: 11, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.097 Vali Acc: 0.540 Test Loss: 1.097 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5818819999694824
Epoch: 12, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.880 Vali Acc: 0.530 Test Loss: 1.880 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9556822776794434
Epoch: 13, Steps: 20 | Train Loss: 0.491 Vali Loss: 1.402 Vali Acc: 0.560 Test Loss: 1.402 Test Acc: 0.560
Validation loss decreased (-0.549988 --> -0.559986).  Saving model ...
Epoch: 14 cost time: 3.036569595336914
Epoch: 14, Steps: 20 | Train Loss: 0.471 Vali Loss: 1.543 Vali Acc: 0.560 Test Loss: 1.543 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.963242292404175
Epoch: 15, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.558 Vali Acc: 0.540 Test Loss: 1.558 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9857921600341797
Epoch: 16, Steps: 20 | Train Loss: 0.350 Vali Loss: 1.735 Vali Acc: 0.540 Test Loss: 1.735 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.013631582260132
Epoch: 17, Steps: 20 | Train Loss: 0.260 Vali Loss: 1.807 Vali Acc: 0.540 Test Loss: 1.807 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.921522617340088
Epoch: 18, Steps: 20 | Train Loss: 0.272 Vali Loss: 2.101 Vali Acc: 0.460 Test Loss: 2.101 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8700497150421143
Epoch: 19, Steps: 20 | Train Loss: 0.260 Vali Loss: 2.213 Vali Acc: 0.540 Test Loss: 2.213 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.017713785171509
Epoch: 20, Steps: 20 | Train Loss: 0.204 Vali Loss: 2.124 Vali Acc: 0.490 Test Loss: 2.124 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.860588550567627
Epoch: 21, Steps: 20 | Train Loss: 0.215 Vali Loss: 2.350 Vali Acc: 0.470 Test Loss: 2.350 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.847407341003418
Epoch: 22, Steps: 20 | Train Loss: 0.290 Vali Loss: 2.927 Vali Acc: 0.510 Test Loss: 2.927 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.7772419452667236
Epoch: 23, Steps: 20 | Train Loss: 0.210 Vali Loss: 2.283 Vali Acc: 0.570 Test Loss: 2.283 Test Acc: 0.570
Validation loss decreased (-0.559986 --> -0.569977).  Saving model ...
Epoch: 24 cost time: 2.7019684314727783
Epoch: 24, Steps: 20 | Train Loss: 0.205 Vali Loss: 3.022 Vali Acc: 0.500 Test Loss: 3.022 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.6225624084472656
Epoch: 25, Steps: 20 | Train Loss: 0.311 Vali Loss: 2.522 Vali Acc: 0.570 Test Loss: 2.522 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.5987699031829834
Epoch: 26, Steps: 20 | Train Loss: 0.079 Vali Loss: 2.731 Vali Acc: 0.510 Test Loss: 2.731 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.7451465129852295
Epoch: 27, Steps: 20 | Train Loss: 0.062 Vali Loss: 2.638 Vali Acc: 0.530 Test Loss: 2.638 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.3943724632263184
Epoch: 28, Steps: 20 | Train Loss: 0.076 Vali Loss: 3.002 Vali Acc: 0.530 Test Loss: 3.002 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.8743324279785156
Epoch: 29, Steps: 20 | Train Loss: 0.130 Vali Loss: 2.998 Vali Acc: 0.540 Test Loss: 2.998 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.021013021469116
Epoch: 30, Steps: 20 | Train Loss: 0.142 Vali Loss: 3.157 Vali Acc: 0.530 Test Loss: 3.157 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.8730976581573486
Epoch: 31, Steps: 20 | Train Loss: 0.058 Vali Loss: 3.135 Vali Acc: 0.600 Test Loss: 3.135 Test Acc: 0.600
Validation loss decreased (-0.569977 --> -0.599969).  Saving model ...
Epoch: 32 cost time: 2.679468870162964
Epoch: 32, Steps: 20 | Train Loss: 0.075 Vali Loss: 3.170 Vali Acc: 0.580 Test Loss: 3.170 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.7719171047210693
Epoch: 33, Steps: 20 | Train Loss: 0.080 Vali Loss: 3.325 Vali Acc: 0.600 Test Loss: 3.325 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.7622694969177246
Epoch: 34, Steps: 20 | Train Loss: 0.037 Vali Loss: 2.979 Vali Acc: 0.610 Test Loss: 2.979 Test Acc: 0.610
Validation loss decreased (-0.599969 --> -0.609970).  Saving model ...
Epoch: 35 cost time: 2.7917513847351074
Epoch: 35, Steps: 20 | Train Loss: 0.051 Vali Loss: 3.763 Vali Acc: 0.550 Test Loss: 3.763 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.702375888824463
Epoch: 36, Steps: 20 | Train Loss: 0.029 Vali Loss: 4.231 Vali Acc: 0.600 Test Loss: 4.231 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.820539712905884
Epoch: 37, Steps: 20 | Train Loss: 0.069 Vali Loss: 3.659 Vali Acc: 0.610 Test Loss: 3.659 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.5680582523345947
Epoch: 38, Steps: 20 | Train Loss: 0.032 Vali Loss: 3.349 Vali Acc: 0.530 Test Loss: 3.349 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.829993963241577
Epoch: 39, Steps: 20 | Train Loss: 0.050 Vali Loss: 3.572 Vali Acc: 0.540 Test Loss: 3.572 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.806558609008789
Epoch: 40, Steps: 20 | Train Loss: 0.074 Vali Loss: 4.431 Vali Acc: 0.510 Test Loss: 4.431 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.29616379737854
Epoch: 41, Steps: 20 | Train Loss: 0.040 Vali Loss: 3.915 Vali Acc: 0.580 Test Loss: 3.915 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.395390272140503
Epoch: 42, Steps: 20 | Train Loss: 0.024 Vali Loss: 3.719 Vali Acc: 0.560 Test Loss: 3.719 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.4178390502929688
Epoch: 43, Steps: 20 | Train Loss: 0.034 Vali Loss: 3.940 Vali Acc: 0.550 Test Loss: 3.940 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.8159613609313965
Epoch: 44, Steps: 20 | Train Loss: 0.034 Vali Loss: 4.072 Vali Acc: 0.550 Test Loss: 4.072 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 251266
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.877944707870483
Epoch: 1, Steps: 20 | Train Loss: 0.986 Vali Loss: 1.111 Vali Acc: 0.410 Test Loss: 1.111 Test Acc: 0.410
Validation loss decreased (inf --> -0.409989).  Saving model ...
Epoch: 2 cost time: 4.140671968460083
Epoch: 2, Steps: 20 | Train Loss: 1.086 Vali Loss: 1.724 Vali Acc: 0.470 Test Loss: 1.724 Test Acc: 0.470
Validation loss decreased (-0.409989 --> -0.469983).  Saving model ...
Epoch: 3 cost time: 4.523965835571289
Epoch: 3, Steps: 20 | Train Loss: 1.039 Vali Loss: 1.434 Vali Acc: 0.510 Test Loss: 1.434 Test Acc: 0.510
Validation loss decreased (-0.469983 --> -0.509986).  Saving model ...
Epoch: 4 cost time: 4.446570158004761
Epoch: 4, Steps: 20 | Train Loss: 1.268 Vali Loss: 5.634 Vali Acc: 0.550 Test Loss: 5.634 Test Acc: 0.550
Validation loss decreased (-0.509986 --> -0.549944).  Saving model ...
Epoch: 5 cost time: 4.678228139877319
Epoch: 5, Steps: 20 | Train Loss: 1.445 Vali Loss: 2.436 Vali Acc: 0.510 Test Loss: 2.436 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.161160469055176
Epoch: 6, Steps: 20 | Train Loss: 1.330 Vali Loss: 2.654 Vali Acc: 0.530 Test Loss: 2.654 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.035606145858765
Epoch: 7, Steps: 20 | Train Loss: 1.664 Vali Loss: 3.681 Vali Acc: 0.580 Test Loss: 3.681 Test Acc: 0.580
Validation loss decreased (-0.549944 --> -0.579963).  Saving model ...
Epoch: 8 cost time: 3.855952024459839
Epoch: 8, Steps: 20 | Train Loss: 1.719 Vali Loss: 5.273 Vali Acc: 0.530 Test Loss: 5.273 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.206329822540283
Epoch: 9, Steps: 20 | Train Loss: 1.611 Vali Loss: 4.343 Vali Acc: 0.540 Test Loss: 4.343 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.343541383743286
Epoch: 10, Steps: 20 | Train Loss: 1.256 Vali Loss: 3.671 Vali Acc: 0.480 Test Loss: 3.671 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.191477060317993
Epoch: 11, Steps: 20 | Train Loss: 1.020 Vali Loss: 3.835 Vali Acc: 0.440 Test Loss: 3.835 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.308914422988892
Epoch: 12, Steps: 20 | Train Loss: 0.496 Vali Loss: 4.631 Vali Acc: 0.550 Test Loss: 4.631 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.380674362182617
Epoch: 13, Steps: 20 | Train Loss: 0.846 Vali Loss: 4.881 Vali Acc: 0.460 Test Loss: 4.881 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.29344630241394
Epoch: 14, Steps: 20 | Train Loss: 0.815 Vali Loss: 5.236 Vali Acc: 0.480 Test Loss: 5.236 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.318931341171265
Epoch: 15, Steps: 20 | Train Loss: 1.027 Vali Loss: 5.643 Vali Acc: 0.580 Test Loss: 5.643 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.26759934425354
Epoch: 16, Steps: 20 | Train Loss: 0.828 Vali Loss: 7.564 Vali Acc: 0.490 Test Loss: 7.564 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.9873194694519043
Epoch: 17, Steps: 20 | Train Loss: 0.690 Vali Loss: 5.471 Vali Acc: 0.450 Test Loss: 5.471 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 525186
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.981676816940308
Epoch: 1, Steps: 20 | Train Loss: 0.842 Vali Loss: 0.810 Vali Acc: 0.580 Test Loss: 0.810 Test Acc: 0.580
Validation loss decreased (inf --> -0.579992).  Saving model ...
Epoch: 2 cost time: 2.9966812133789062
Epoch: 2, Steps: 20 | Train Loss: 1.109 Vali Loss: 1.819 Vali Acc: 0.490 Test Loss: 1.819 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9888455867767334
Epoch: 3, Steps: 20 | Train Loss: 0.865 Vali Loss: 1.797 Vali Acc: 0.450 Test Loss: 1.797 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9522571563720703
Epoch: 4, Steps: 20 | Train Loss: 0.838 Vali Loss: 1.544 Vali Acc: 0.450 Test Loss: 1.544 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9291036128997803
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 1.618 Vali Acc: 0.500 Test Loss: 1.618 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.273364782333374
Epoch: 6, Steps: 20 | Train Loss: 0.939 Vali Loss: 2.346 Vali Acc: 0.540 Test Loss: 2.346 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.092421054840088
Epoch: 7, Steps: 20 | Train Loss: 1.655 Vali Loss: 2.278 Vali Acc: 0.510 Test Loss: 2.278 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.068129777908325
Epoch: 8, Steps: 20 | Train Loss: 0.815 Vali Loss: 1.777 Vali Acc: 0.550 Test Loss: 1.777 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.096950054168701
Epoch: 9, Steps: 20 | Train Loss: 0.598 Vali Loss: 3.820 Vali Acc: 0.540 Test Loss: 3.820 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.905017137527466
Epoch: 10, Steps: 20 | Train Loss: 1.262 Vali Loss: 3.998 Vali Acc: 0.480 Test Loss: 3.998 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7853851318359375
Epoch: 11, Steps: 20 | Train Loss: 1.063 Vali Loss: 3.185 Vali Acc: 0.500 Test Loss: 3.185 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 346114
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.631479501724243
Epoch: 1, Steps: 20 | Train Loss: 0.916 Vali Loss: 1.393 Vali Acc: 0.500 Test Loss: 1.393 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 2.935645580291748
Epoch: 2, Steps: 20 | Train Loss: 1.068 Vali Loss: 1.282 Vali Acc: 0.540 Test Loss: 1.282 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539987).  Saving model ...
Epoch: 3 cost time: 2.9948842525482178
Epoch: 3, Steps: 20 | Train Loss: 0.728 Vali Loss: 1.160 Vali Acc: 0.520 Test Loss: 1.160 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.935636043548584
Epoch: 4, Steps: 20 | Train Loss: 0.973 Vali Loss: 1.968 Vali Acc: 0.480 Test Loss: 1.968 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9510858058929443
Epoch: 5, Steps: 20 | Train Loss: 0.807 Vali Loss: 1.527 Vali Acc: 0.520 Test Loss: 1.527 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.916469097137451
Epoch: 6, Steps: 20 | Train Loss: 0.657 Vali Loss: 2.036 Vali Acc: 0.430 Test Loss: 2.036 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0145492553710938
Epoch: 7, Steps: 20 | Train Loss: 0.719 Vali Loss: 1.797 Vali Acc: 0.530 Test Loss: 1.797 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9579036235809326
Epoch: 8, Steps: 20 | Train Loss: 0.554 Vali Loss: 1.710 Vali Acc: 0.540 Test Loss: 1.710 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9636213779449463
Epoch: 9, Steps: 20 | Train Loss: 0.549 Vali Loss: 2.646 Vali Acc: 0.430 Test Loss: 2.646 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.7126903533935547
Epoch: 10, Steps: 20 | Train Loss: 0.506 Vali Loss: 2.808 Vali Acc: 0.470 Test Loss: 2.808 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.757234573364258
Epoch: 11, Steps: 20 | Train Loss: 0.665 Vali Loss: 2.621 Vali Acc: 0.500 Test Loss: 2.621 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.8342339992523193
Epoch: 12, Steps: 20 | Train Loss: 0.787 Vali Loss: 2.576 Vali Acc: 0.500 Test Loss: 2.576 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 346242
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.287877798080444
Epoch: 1, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.750 Vali Acc: 0.590 Test Loss: 0.750 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 2.5112268924713135
Epoch: 2, Steps: 20 | Train Loss: 0.805 Vali Loss: 1.232 Vali Acc: 0.440 Test Loss: 1.232 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.637218952178955
Epoch: 3, Steps: 20 | Train Loss: 0.726 Vali Loss: 1.037 Vali Acc: 0.520 Test Loss: 1.037 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.618803024291992
Epoch: 4, Steps: 20 | Train Loss: 0.585 Vali Loss: 1.117 Vali Acc: 0.470 Test Loss: 1.117 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6747374534606934
Epoch: 5, Steps: 20 | Train Loss: 0.604 Vali Loss: 1.022 Vali Acc: 0.540 Test Loss: 1.022 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.661991834640503
Epoch: 6, Steps: 20 | Train Loss: 0.690 Vali Loss: 1.381 Vali Acc: 0.500 Test Loss: 1.381 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.876624584197998
Epoch: 7, Steps: 20 | Train Loss: 0.559 Vali Loss: 1.425 Vali Acc: 0.480 Test Loss: 1.425 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.551630735397339
Epoch: 8, Steps: 20 | Train Loss: 0.531 Vali Loss: 1.679 Vali Acc: 0.500 Test Loss: 1.679 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.5442256927490234
Epoch: 9, Steps: 20 | Train Loss: 0.494 Vali Loss: 1.828 Vali Acc: 0.530 Test Loss: 1.828 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.5451111793518066
Epoch: 10, Steps: 20 | Train Loss: 0.480 Vali Loss: 2.278 Vali Acc: 0.520 Test Loss: 2.278 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.1393773555755615
Epoch: 11, Steps: 20 | Train Loss: 0.459 Vali Loss: 1.657 Vali Acc: 0.500 Test Loss: 1.657 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 289026
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.615074396133423
Epoch: 1, Steps: 20 | Train Loss: 0.826 Vali Loss: 0.884 Vali Acc: 0.530 Test Loss: 0.884 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 2.6986372470855713
Epoch: 2, Steps: 20 | Train Loss: 0.757 Vali Loss: 1.236 Vali Acc: 0.480 Test Loss: 1.236 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.783710479736328
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.920 Vali Acc: 0.530 Test Loss: 0.920 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.997159242630005
Epoch: 4, Steps: 20 | Train Loss: 0.652 Vali Loss: 1.135 Vali Acc: 0.480 Test Loss: 1.135 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.765105962753296
Epoch: 5, Steps: 20 | Train Loss: 0.690 Vali Loss: 1.641 Vali Acc: 0.510 Test Loss: 1.641 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.898503065109253
Epoch: 6, Steps: 20 | Train Loss: 0.660 Vali Loss: 1.151 Vali Acc: 0.540 Test Loss: 1.151 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539988).  Saving model ...
Epoch: 7 cost time: 2.9834651947021484
Epoch: 7, Steps: 20 | Train Loss: 0.847 Vali Loss: 1.514 Vali Acc: 0.490 Test Loss: 1.514 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9137394428253174
Epoch: 8, Steps: 20 | Train Loss: 0.600 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5509190559387207
Epoch: 9, Steps: 20 | Train Loss: 0.449 Vali Loss: 1.369 Vali Acc: 0.510 Test Loss: 1.369 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5950000286102295
Epoch: 10, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.363 Vali Acc: 0.480 Test Loss: 1.363 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5203518867492676
Epoch: 11, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.319 Vali Acc: 0.550 Test Loss: 1.319 Test Acc: 0.550
Validation loss decreased (-0.539988 --> -0.549987).  Saving model ...
Epoch: 12 cost time: 2.425142288208008
Epoch: 12, Steps: 20 | Train Loss: 0.345 Vali Loss: 1.620 Vali Acc: 0.500 Test Loss: 1.620 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.704253911972046
Epoch: 13, Steps: 20 | Train Loss: 0.272 Vali Loss: 2.095 Vali Acc: 0.520 Test Loss: 2.095 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.920888662338257
Epoch: 14, Steps: 20 | Train Loss: 0.624 Vali Loss: 1.979 Vali Acc: 0.480 Test Loss: 1.979 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8378193378448486
Epoch: 15, Steps: 20 | Train Loss: 0.388 Vali Loss: 2.078 Vali Acc: 0.450 Test Loss: 2.078 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.7403759956359863
Epoch: 16, Steps: 20 | Train Loss: 0.405 Vali Loss: 2.108 Vali Acc: 0.480 Test Loss: 2.108 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.8810784816741943
Epoch: 17, Steps: 20 | Train Loss: 0.319 Vali Loss: 2.515 Vali Acc: 0.480 Test Loss: 2.515 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.72925066947937
Epoch: 18, Steps: 20 | Train Loss: 0.352 Vali Loss: 2.577 Vali Acc: 0.500 Test Loss: 2.577 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.787172555923462
Epoch: 19, Steps: 20 | Train Loss: 0.469 Vali Loss: 2.580 Vali Acc: 0.540 Test Loss: 2.580 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.8372178077697754
Epoch: 20, Steps: 20 | Train Loss: 0.404 Vali Loss: 2.825 Vali Acc: 0.490 Test Loss: 2.825 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.945632219314575
Epoch: 21, Steps: 20 | Train Loss: 0.201 Vali Loss: 2.846 Vali Acc: 0.470 Test Loss: 2.846 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 253570
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.46087384223938
Epoch: 1, Steps: 20 | Train Loss: 0.786 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 2.7252259254455566
Epoch: 2, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.869 Vali Acc: 0.510 Test Loss: 0.869 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.946218729019165
Epoch: 3, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.905 Vali Acc: 0.470 Test Loss: 0.905 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.933354377746582
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 1.131 Vali Acc: 0.540 Test Loss: 1.131 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6330525875091553
Epoch: 5, Steps: 20 | Train Loss: 0.629 Vali Loss: 1.004 Vali Acc: 0.520 Test Loss: 1.004 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7137649059295654
Epoch: 6, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.008 Vali Acc: 0.470 Test Loss: 1.008 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.630444288253784
Epoch: 7, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.094 Vali Acc: 0.500 Test Loss: 1.094 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8123605251312256
Epoch: 8, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.145 Vali Acc: 0.460 Test Loss: 1.145 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.9304986000061035
Epoch: 9, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.335 Vali Acc: 0.480 Test Loss: 1.335 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8331828117370605
Epoch: 10, Steps: 20 | Train Loss: 0.419 Vali Loss: 1.328 Vali Acc: 0.540 Test Loss: 1.328 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.700190544128418
Epoch: 11, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.385 Vali Acc: 0.490 Test Loss: 1.385 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 239490
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.797752618789673
Epoch: 1, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 1.955502986907959
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.746 Vali Acc: 0.440 Test Loss: 0.746 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7690610885620117
Epoch: 3, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.891 Vali Acc: 0.520 Test Loss: 0.891 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6026930809020996
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.840 Vali Acc: 0.560 Test Loss: 0.840 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 5 cost time: 2.0390195846557617
Epoch: 5, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.916 Vali Acc: 0.470 Test Loss: 0.916 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0102736949920654
Epoch: 6, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.814 Vali Acc: 0.530 Test Loss: 0.814 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9021070003509521
Epoch: 7, Steps: 20 | Train Loss: 0.562 Vali Loss: 1.060 Vali Acc: 0.520 Test Loss: 1.060 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0714893341064453
Epoch: 8, Steps: 20 | Train Loss: 0.589 Vali Loss: 1.187 Vali Acc: 0.520 Test Loss: 1.187 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0136523246765137
Epoch: 9, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.013 Vali Acc: 0.540 Test Loss: 1.013 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5654327869415283
Epoch: 10, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.137 Vali Acc: 0.560 Test Loss: 1.137 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.154719352722168
Epoch: 11, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.170 Vali Acc: 0.490 Test Loss: 1.170 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.5071661472320557
Epoch: 12, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.288 Vali Acc: 0.520 Test Loss: 1.288 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.3430192470550537
Epoch: 13, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3333566188812256
Epoch: 14, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.373 Vali Acc: 0.520 Test Loss: 1.373 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm128_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 218370
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.268190145492554
Epoch: 1, Steps: 20 | Train Loss: 0.936 Vali Loss: 0.930 Vali Acc: 0.480 Test Loss: 0.930 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 3.5643365383148193
Epoch: 2, Steps: 20 | Train Loss: 0.840 Vali Loss: 1.063 Vali Acc: 0.430 Test Loss: 1.063 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.911492109298706
Epoch: 3, Steps: 20 | Train Loss: 0.771 Vali Loss: 1.220 Vali Acc: 0.490 Test Loss: 1.220 Test Acc: 0.490
Validation loss decreased (-0.479991 --> -0.489988).  Saving model ...
Epoch: 4 cost time: 3.6935999393463135
Epoch: 4, Steps: 20 | Train Loss: 0.613 Vali Loss: 1.717 Vali Acc: 0.470 Test Loss: 1.717 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7137973308563232
Epoch: 5, Steps: 20 | Train Loss: 0.777 Vali Loss: 1.838 Vali Acc: 0.530 Test Loss: 1.838 Test Acc: 0.530
Validation loss decreased (-0.489988 --> -0.529982).  Saving model ...
Epoch: 6 cost time: 3.754934310913086
Epoch: 6, Steps: 20 | Train Loss: 0.811 Vali Loss: 1.755 Vali Acc: 0.530 Test Loss: 1.755 Test Acc: 0.530
Validation loss decreased (-0.529982 --> -0.529982).  Saving model ...
Epoch: 7 cost time: 3.64225172996521
Epoch: 7, Steps: 20 | Train Loss: 0.585 Vali Loss: 1.711 Vali Acc: 0.470 Test Loss: 1.711 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.542914628982544
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 3.332 Vali Acc: 0.500 Test Loss: 3.332 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.677532434463501
Epoch: 9, Steps: 20 | Train Loss: 1.344 Vali Loss: 3.152 Vali Acc: 0.520 Test Loss: 3.152 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7891037464141846
Epoch: 10, Steps: 20 | Train Loss: 0.288 Vali Loss: 3.193 Vali Acc: 0.430 Test Loss: 3.193 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.8415815830230713
Epoch: 11, Steps: 20 | Train Loss: 0.796 Vali Loss: 4.321 Vali Acc: 0.540 Test Loss: 4.321 Test Acc: 0.540
Validation loss decreased (-0.529982 --> -0.539957).  Saving model ...
Epoch: 12 cost time: 3.7831130027770996
Epoch: 12, Steps: 20 | Train Loss: 0.493 Vali Loss: 2.841 Vali Acc: 0.540 Test Loss: 2.841 Test Acc: 0.540
Validation loss decreased (-0.539957 --> -0.539972).  Saving model ...
Epoch: 13 cost time: 3.7224485874176025
Epoch: 13, Steps: 20 | Train Loss: 0.688 Vali Loss: 3.956 Vali Acc: 0.500 Test Loss: 3.956 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.410393476486206
Epoch: 14, Steps: 20 | Train Loss: 0.597 Vali Loss: 2.916 Vali Acc: 0.510 Test Loss: 2.916 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6178486347198486
Epoch: 15, Steps: 20 | Train Loss: 0.408 Vali Loss: 3.254 Vali Acc: 0.500 Test Loss: 3.254 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.4076082706451416
Epoch: 16, Steps: 20 | Train Loss: 0.271 Vali Loss: 3.662 Vali Acc: 0.530 Test Loss: 3.662 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.6135735511779785
Epoch: 17, Steps: 20 | Train Loss: 0.463 Vali Loss: 3.820 Vali Acc: 0.530 Test Loss: 3.820 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.8972597122192383
Epoch: 18, Steps: 20 | Train Loss: 0.261 Vali Loss: 5.927 Vali Acc: 0.560 Test Loss: 5.927 Test Acc: 0.560
Validation loss decreased (-0.539972 --> -0.559941).  Saving model ...
Epoch: 19 cost time: 3.7218821048736572
Epoch: 19, Steps: 20 | Train Loss: 0.652 Vali Loss: 4.480 Vali Acc: 0.500 Test Loss: 4.480 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9000442028045654
Epoch: 20, Steps: 20 | Train Loss: 0.451 Vali Loss: 4.219 Vali Acc: 0.560 Test Loss: 4.219 Test Acc: 0.560
Validation loss decreased (-0.559941 --> -0.559958).  Saving model ...
Epoch: 21 cost time: 3.55623722076416
Epoch: 21, Steps: 20 | Train Loss: 0.303 Vali Loss: 7.623 Vali Acc: 0.500 Test Loss: 7.623 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4480140209198
Epoch: 22, Steps: 20 | Train Loss: 0.342 Vali Loss: 5.897 Vali Acc: 0.510 Test Loss: 5.897 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.379577159881592
Epoch: 23, Steps: 20 | Train Loss: 0.479 Vali Loss: 4.894 Vali Acc: 0.530 Test Loss: 4.894 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.5784387588500977
Epoch: 24, Steps: 20 | Train Loss: 0.302 Vali Loss: 5.900 Vali Acc: 0.510 Test Loss: 5.900 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.737100124359131
Epoch: 25, Steps: 20 | Train Loss: 0.212 Vali Loss: 5.291 Vali Acc: 0.500 Test Loss: 5.291 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.4712867736816406
Epoch: 26, Steps: 20 | Train Loss: 0.130 Vali Loss: 5.897 Vali Acc: 0.530 Test Loss: 5.897 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.668684720993042
Epoch: 27, Steps: 20 | Train Loss: 0.161 Vali Loss: 7.527 Vali Acc: 0.510 Test Loss: 7.527 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.3658783435821533
Epoch: 28, Steps: 20 | Train Loss: 0.002 Vali Loss: 6.551 Vali Acc: 0.550 Test Loss: 6.551 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.1902964115142822
Epoch: 29, Steps: 20 | Train Loss: 0.163 Vali Loss: 7.153 Vali Acc: 0.520 Test Loss: 7.153 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.578486680984497
Epoch: 30, Steps: 20 | Train Loss: 0.035 Vali Loss: 7.519 Vali Acc: 0.450 Test Loss: 7.519 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 279426
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.264037609100342
Epoch: 1, Steps: 20 | Train Loss: 0.818 Vali Loss: 1.041 Vali Acc: 0.500 Test Loss: 1.041 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 2.2389397621154785
Epoch: 2, Steps: 20 | Train Loss: 0.962 Vali Loss: 0.964 Vali Acc: 0.470 Test Loss: 0.964 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3481974601745605
Epoch: 3, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.943 Vali Acc: 0.440 Test Loss: 0.943 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4820523262023926
Epoch: 4, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.999 Vali Acc: 0.490 Test Loss: 0.999 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4709632396698
Epoch: 5, Steps: 20 | Train Loss: 0.594 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6267008781433105
Epoch: 6, Steps: 20 | Train Loss: 0.604 Vali Loss: 1.037 Vali Acc: 0.550 Test Loss: 1.037 Test Acc: 0.550
Validation loss decreased (-0.499990 --> -0.549990).  Saving model ...
Epoch: 7 cost time: 2.5941789150238037
Epoch: 7, Steps: 20 | Train Loss: 0.549 Vali Loss: 1.094 Vali Acc: 0.460 Test Loss: 1.094 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5548954010009766
Epoch: 8, Steps: 20 | Train Loss: 0.410 Vali Loss: 1.193 Vali Acc: 0.520 Test Loss: 1.193 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.518185615539551
Epoch: 9, Steps: 20 | Train Loss: 0.639 Vali Loss: 1.368 Vali Acc: 0.410 Test Loss: 1.368 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3675620555877686
Epoch: 10, Steps: 20 | Train Loss: 0.414 Vali Loss: 1.678 Vali Acc: 0.440 Test Loss: 1.678 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.128164291381836
Epoch: 11, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.538 Vali Acc: 0.520 Test Loss: 1.538 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6207075119018555
Epoch: 12, Steps: 20 | Train Loss: 0.471 Vali Loss: 1.609 Vali Acc: 0.520 Test Loss: 1.609 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6715445518493652
Epoch: 13, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.900 Vali Acc: 0.450 Test Loss: 1.900 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6521799564361572
Epoch: 14, Steps: 20 | Train Loss: 0.244 Vali Loss: 2.180 Vali Acc: 0.520 Test Loss: 2.180 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5369160175323486
Epoch: 15, Steps: 20 | Train Loss: 0.187 Vali Loss: 2.453 Vali Acc: 0.480 Test Loss: 2.453 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.54540753364563
Epoch: 16, Steps: 20 | Train Loss: 0.360 Vali Loss: 2.742 Vali Acc: 0.480 Test Loss: 2.742 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 189890
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.224823474884033
Epoch: 1, Steps: 20 | Train Loss: 0.795 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 2.2438244819641113
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.856 Vali Acc: 0.520 Test Loss: 0.856 Test Acc: 0.520
Validation loss decreased (-0.469992 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 2.7359633445739746
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.964 Vali Acc: 0.550 Test Loss: 0.964 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549990).  Saving model ...
Epoch: 4 cost time: 2.2821836471557617
Epoch: 4, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.916 Vali Acc: 0.530 Test Loss: 0.916 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.580457925796509
Epoch: 5, Steps: 20 | Train Loss: 0.562 Vali Loss: 1.439 Vali Acc: 0.500 Test Loss: 1.439 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.513859987258911
Epoch: 6, Steps: 20 | Train Loss: 0.622 Vali Loss: 1.316 Vali Acc: 0.470 Test Loss: 1.316 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5134263038635254
Epoch: 7, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.248 Vali Acc: 0.450 Test Loss: 1.248 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.247694492340088
Epoch: 8, Steps: 20 | Train Loss: 0.461 Vali Loss: 1.823 Vali Acc: 0.540 Test Loss: 1.823 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.376173734664917
Epoch: 9, Steps: 20 | Train Loss: 0.575 Vali Loss: 1.399 Vali Acc: 0.480 Test Loss: 1.399 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6465766429901123
Epoch: 10, Steps: 20 | Train Loss: 0.575 Vali Loss: 1.601 Vali Acc: 0.490 Test Loss: 1.601 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5624608993530273
Epoch: 11, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.744 Vali Acc: 0.550 Test Loss: 1.744 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4446961879730225
Epoch: 12, Steps: 20 | Train Loss: 0.369 Vali Loss: 1.720 Vali Acc: 0.530 Test Loss: 1.720 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5679798126220703
Epoch: 13, Steps: 20 | Train Loss: 0.433 Vali Loss: 1.841 Vali Acc: 0.540 Test Loss: 1.841 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 189954
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.102240085601807
Epoch: 1, Steps: 20 | Train Loss: 0.782 Vali Loss: 0.944 Vali Acc: 0.520 Test Loss: 0.944 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 2.4053189754486084
Epoch: 2, Steps: 20 | Train Loss: 0.816 Vali Loss: 0.924 Vali Acc: 0.490 Test Loss: 0.924 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9568707942962646
Epoch: 3, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.812 Vali Acc: 0.460 Test Loss: 0.812 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9068646430969238
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 1.025 Vali Acc: 0.490 Test Loss: 1.025 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.874096155166626
Epoch: 5, Steps: 20 | Train Loss: 0.580 Vali Loss: 1.079 Vali Acc: 0.510 Test Loss: 1.079 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8276135921478271
Epoch: 6, Steps: 20 | Train Loss: 0.549 Vali Loss: 1.213 Vali Acc: 0.470 Test Loss: 1.213 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9593076705932617
Epoch: 7, Steps: 20 | Train Loss: 0.508 Vali Loss: 1.068 Vali Acc: 0.480 Test Loss: 1.068 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.03066349029541
Epoch: 8, Steps: 20 | Train Loss: 0.479 Vali Loss: 1.725 Vali Acc: 0.540 Test Loss: 1.725 Test Acc: 0.540
Validation loss decreased (-0.519991 --> -0.539983).  Saving model ...
Epoch: 9 cost time: 2.4811103343963623
Epoch: 9, Steps: 20 | Train Loss: 0.532 Vali Loss: 1.083 Vali Acc: 0.590 Test Loss: 1.083 Test Acc: 0.590
Validation loss decreased (-0.539983 --> -0.589989).  Saving model ...
Epoch: 10 cost time: 2.5477709770202637
Epoch: 10, Steps: 20 | Train Loss: 0.479 Vali Loss: 2.278 Vali Acc: 0.540 Test Loss: 2.278 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.560467004776001
Epoch: 11, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.207 Vali Acc: 0.520 Test Loss: 1.207 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5218617916107178
Epoch: 12, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.460 Vali Acc: 0.580 Test Loss: 1.460 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5770671367645264
Epoch: 13, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.569 Vali Acc: 0.490 Test Loss: 1.569 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.572072982788086
Epoch: 14, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.643 Vali Acc: 0.470 Test Loss: 1.643 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.526946544647217
Epoch: 15, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.903 Vali Acc: 0.560 Test Loss: 1.903 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.4869766235351562
Epoch: 16, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.659 Vali Acc: 0.560 Test Loss: 1.659 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1877048015594482
Epoch: 17, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.862 Vali Acc: 0.470 Test Loss: 1.862 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.349246025085449
Epoch: 18, Steps: 20 | Train Loss: 0.171 Vali Loss: 2.120 Vali Acc: 0.490 Test Loss: 2.120 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.298753261566162
Epoch: 19, Steps: 20 | Train Loss: 0.178 Vali Loss: 2.307 Vali Acc: 0.490 Test Loss: 2.307 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 161346
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.323695421218872
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.788 Vali Acc: 0.430 Test Loss: 0.788 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 3.2098987102508545
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.888 Vali Acc: 0.480 Test Loss: 0.888 Test Acc: 0.480
Validation loss decreased (-0.429992 --> -0.479991).  Saving model ...
Epoch: 3 cost time: 3.030510425567627
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.827 Vali Acc: 0.460 Test Loss: 0.827 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1659281253814697
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 1.216 Vali Acc: 0.520 Test Loss: 1.216 Test Acc: 0.520
Validation loss decreased (-0.479991 --> -0.519988).  Saving model ...
Epoch: 5 cost time: 3.1053757667541504
Epoch: 5, Steps: 20 | Train Loss: 0.651 Vali Loss: 1.017 Vali Acc: 0.450 Test Loss: 1.017 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.130906343460083
Epoch: 6, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.862 Vali Acc: 0.540 Test Loss: 0.862 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539991).  Saving model ...
Epoch: 7 cost time: 3.104138135910034
Epoch: 7, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.863 Vali Acc: 0.490 Test Loss: 0.863 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4008874893188477
Epoch: 8, Steps: 20 | Train Loss: 0.517 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3587679862976074
Epoch: 9, Steps: 20 | Train Loss: 0.417 Vali Loss: 1.044 Vali Acc: 0.480 Test Loss: 1.044 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9477176666259766
Epoch: 10, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.056 Vali Acc: 0.480 Test Loss: 1.056 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.792484760284424
Epoch: 11, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.112 Vali Acc: 0.510 Test Loss: 1.112 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.010803461074829
Epoch: 12, Steps: 20 | Train Loss: 0.407 Vali Loss: 1.564 Vali Acc: 0.510 Test Loss: 1.564 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7822165489196777
Epoch: 13, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.477 Vali Acc: 0.490 Test Loss: 1.477 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7644999027252197
Epoch: 14, Steps: 20 | Train Loss: 0.341 Vali Loss: 1.720 Vali Acc: 0.530 Test Loss: 1.720 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.6525161266326904
Epoch: 15, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.486 Vali Acc: 0.470 Test Loss: 1.486 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8400537967681885
Epoch: 16, Steps: 20 | Train Loss: 0.366 Vali Loss: 2.226 Vali Acc: 0.470 Test Loss: 2.226 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 143618
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.736433267593384
Epoch: 1, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.704 Vali Acc: 0.570 Test Loss: 0.704 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 3.0124220848083496
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0874385833740234
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.893 Vali Acc: 0.430 Test Loss: 0.893 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2581582069396973
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.836 Vali Acc: 0.490 Test Loss: 0.836 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9438629150390625
Epoch: 5, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.963 Vali Acc: 0.520 Test Loss: 0.963 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.910712242126465
Epoch: 6, Steps: 20 | Train Loss: 0.596 Vali Loss: 1.086 Vali Acc: 0.490 Test Loss: 1.086 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.9175901412963867
Epoch: 7, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.532513380050659
Epoch: 8, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.894 Vali Acc: 0.530 Test Loss: 0.894 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.394974946975708
Epoch: 9, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.927 Vali Acc: 0.470 Test Loss: 0.927 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.802424430847168
Epoch: 10, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.101 Vali Acc: 0.520 Test Loss: 1.101 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.685955762863159
Epoch: 11, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.988 Vali Acc: 0.520 Test Loss: 0.988 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 136578
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.98180365562439
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.808 Vali Acc: 0.490 Test Loss: 0.808 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.9545669555664062
Epoch: 2, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.901 Vali Acc: 0.510 Test Loss: 0.901 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509991).  Saving model ...
Epoch: 3 cost time: 2.9928812980651855
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 1.013 Vali Acc: 0.500 Test Loss: 1.013 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1541996002197266
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.894 Vali Acc: 0.470 Test Loss: 0.894 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0555202960968018
Epoch: 5, Steps: 20 | Train Loss: 0.632 Vali Loss: 1.010 Vali Acc: 0.490 Test Loss: 1.010 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8826794624328613
Epoch: 6, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.870 Vali Acc: 0.440 Test Loss: 0.870 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7583982944488525
Epoch: 7, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.891 Vali Acc: 0.510 Test Loss: 0.891 Test Acc: 0.510
Validation loss decreased (-0.509991 --> -0.509991).  Saving model ...
Epoch: 8 cost time: 2.788111686706543
Epoch: 8, Steps: 20 | Train Loss: 0.546 Vali Loss: 1.048 Vali Acc: 0.490 Test Loss: 1.048 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7824208736419678
Epoch: 9, Steps: 20 | Train Loss: 0.508 Vali Loss: 1.078 Vali Acc: 0.500 Test Loss: 1.078 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.823056697845459
Epoch: 10, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.283 Vali Acc: 0.520 Test Loss: 1.283 Test Acc: 0.520
Validation loss decreased (-0.509991 --> -0.519987).  Saving model ...
Epoch: 11 cost time: 2.6683990955352783
Epoch: 11, Steps: 20 | Train Loss: 0.466 Vali Loss: 1.128 Vali Acc: 0.490 Test Loss: 1.128 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.736839532852173
Epoch: 12, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.140 Vali Acc: 0.490 Test Loss: 1.140 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5349996089935303
Epoch: 13, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.365 Vali Acc: 0.500 Test Loss: 1.365 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.782776355743408
Epoch: 14, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.161 Vali Acc: 0.480 Test Loss: 1.161 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.015347480773926
Epoch: 15, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.066 Vali Acc: 0.560 Test Loss: 1.066 Test Acc: 0.560
Validation loss decreased (-0.519987 --> -0.559989).  Saving model ...
Epoch: 16 cost time: 2.860184907913208
Epoch: 16, Steps: 20 | Train Loss: 0.433 Vali Loss: 1.347 Vali Acc: 0.490 Test Loss: 1.347 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.975264310836792
Epoch: 17, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.215 Vali Acc: 0.560 Test Loss: 1.215 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8815839290618896
Epoch: 18, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.397 Vali Acc: 0.560 Test Loss: 1.397 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0097815990448
Epoch: 19, Steps: 20 | Train Loss: 0.254 Vali Loss: 1.347 Vali Acc: 0.500 Test Loss: 1.347 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1596052646636963
Epoch: 20, Steps: 20 | Train Loss: 0.211 Vali Loss: 1.410 Vali Acc: 0.460 Test Loss: 1.410 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.1096644401550293
Epoch: 21, Steps: 20 | Train Loss: 0.182 Vali Loss: 1.640 Vali Acc: 0.470 Test Loss: 1.640 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.776413917541504
Epoch: 22, Steps: 20 | Train Loss: 0.188 Vali Loss: 1.433 Vali Acc: 0.530 Test Loss: 1.433 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7618050575256348
Epoch: 23, Steps: 20 | Train Loss: 0.186 Vali Loss: 1.684 Vali Acc: 0.500 Test Loss: 1.684 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.6363582611083984
Epoch: 24, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.696 Vali Acc: 0.540 Test Loss: 1.696 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.5500316619873047
Epoch: 25, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.963 Vali Acc: 0.540 Test Loss: 1.963 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 126018
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.766745090484619
Epoch: 1, Steps: 20 | Train Loss: 0.853 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 3.706401824951172
Epoch: 2, Steps: 20 | Train Loss: 1.014 Vali Loss: 1.198 Vali Acc: 0.520 Test Loss: 1.198 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519988).  Saving model ...
Epoch: 3 cost time: 3.8691158294677734
Epoch: 3, Steps: 20 | Train Loss: 0.971 Vali Loss: 1.606 Vali Acc: 0.510 Test Loss: 1.606 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.704451560974121
Epoch: 4, Steps: 20 | Train Loss: 0.915 Vali Loss: 3.804 Vali Acc: 0.480 Test Loss: 3.804 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7311384677886963
Epoch: 5, Steps: 20 | Train Loss: 1.015 Vali Loss: 1.829 Vali Acc: 0.450 Test Loss: 1.829 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8271231651306152
Epoch: 6, Steps: 20 | Train Loss: 0.901 Vali Loss: 2.980 Vali Acc: 0.510 Test Loss: 2.980 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.7662925720214844
Epoch: 7, Steps: 20 | Train Loss: 0.751 Vali Loss: 2.712 Vali Acc: 0.490 Test Loss: 2.712 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.6905627250671387
Epoch: 8, Steps: 20 | Train Loss: 0.967 Vali Loss: 2.422 Vali Acc: 0.490 Test Loss: 2.422 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.755622625350952
Epoch: 9, Steps: 20 | Train Loss: 0.535 Vali Loss: 2.331 Vali Acc: 0.490 Test Loss: 2.331 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.6616199016571045
Epoch: 10, Steps: 20 | Train Loss: 0.641 Vali Loss: 2.498 Vali Acc: 0.440 Test Loss: 2.498 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.6283087730407715
Epoch: 11, Steps: 20 | Train Loss: 0.323 Vali Loss: 2.199 Vali Acc: 0.560 Test Loss: 2.199 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559978).  Saving model ...
Epoch: 12 cost time: 3.8157312870025635
Epoch: 12, Steps: 20 | Train Loss: 0.764 Vali Loss: 5.124 Vali Acc: 0.560 Test Loss: 5.124 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9486818313598633
Epoch: 13, Steps: 20 | Train Loss: 0.531 Vali Loss: 2.894 Vali Acc: 0.460 Test Loss: 2.894 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.724641799926758
Epoch: 14, Steps: 20 | Train Loss: 0.679 Vali Loss: 3.088 Vali Acc: 0.500 Test Loss: 3.088 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.908578634262085
Epoch: 15, Steps: 20 | Train Loss: 0.403 Vali Loss: 3.754 Vali Acc: 0.480 Test Loss: 3.754 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.998196601867676
Epoch: 16, Steps: 20 | Train Loss: 0.727 Vali Loss: 3.595 Vali Acc: 0.470 Test Loss: 3.595 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.177277088165283
Epoch: 17, Steps: 20 | Train Loss: 0.489 Vali Loss: 3.936 Vali Acc: 0.560 Test Loss: 3.936 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.118521451950073
Epoch: 18, Steps: 20 | Train Loss: 0.325 Vali Loss: 4.258 Vali Acc: 0.600 Test Loss: 4.258 Test Acc: 0.600
Validation loss decreased (-0.559978 --> -0.599957).  Saving model ...
Epoch: 19 cost time: 4.1405909061431885
Epoch: 19, Steps: 20 | Train Loss: 0.297 Vali Loss: 4.847 Vali Acc: 0.430 Test Loss: 4.847 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.281066179275513
Epoch: 20, Steps: 20 | Train Loss: 0.573 Vali Loss: 5.049 Vali Acc: 0.530 Test Loss: 5.049 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.176785230636597
Epoch: 21, Steps: 20 | Train Loss: 0.212 Vali Loss: 4.841 Vali Acc: 0.480 Test Loss: 4.841 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.0777881145477295
Epoch: 22, Steps: 20 | Train Loss: 0.197 Vali Loss: 5.551 Vali Acc: 0.550 Test Loss: 5.551 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.021991968154907
Epoch: 23, Steps: 20 | Train Loss: 0.283 Vali Loss: 5.320 Vali Acc: 0.470 Test Loss: 5.320 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.9976766109466553
Epoch: 24, Steps: 20 | Train Loss: 0.395 Vali Loss: 6.287 Vali Acc: 0.490 Test Loss: 6.287 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.8413264751434326
Epoch: 25, Steps: 20 | Train Loss: 0.122 Vali Loss: 5.871 Vali Acc: 0.490 Test Loss: 5.871 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.566023826599121
Epoch: 26, Steps: 20 | Train Loss: 0.087 Vali Loss: 5.638 Vali Acc: 0.490 Test Loss: 5.638 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.5250611305236816
Epoch: 27, Steps: 20 | Train Loss: 0.091 Vali Loss: 7.124 Vali Acc: 0.510 Test Loss: 7.124 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.54367995262146
Epoch: 28, Steps: 20 | Train Loss: 0.639 Vali Loss: 7.079 Vali Acc: 0.490 Test Loss: 7.079 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 246402
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.802565097808838
Epoch: 1, Steps: 20 | Train Loss: 0.895 Vali Loss: 0.970 Vali Acc: 0.500 Test Loss: 0.970 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 2.9366061687469482
Epoch: 2, Steps: 20 | Train Loss: 0.833 Vali Loss: 0.909 Vali Acc: 0.540 Test Loss: 0.909 Test Acc: 0.540
Validation loss decreased (-0.499990 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 2.977938652038574
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.786 Vali Acc: 0.450 Test Loss: 0.786 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9505627155303955
Epoch: 4, Steps: 20 | Train Loss: 0.611 Vali Loss: 1.169 Vali Acc: 0.530 Test Loss: 1.169 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0472636222839355
Epoch: 5, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.937 Vali Acc: 0.520 Test Loss: 0.937 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8825132846832275
Epoch: 6, Steps: 20 | Train Loss: 0.768 Vali Loss: 3.232 Vali Acc: 0.520 Test Loss: 3.232 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.951115846633911
Epoch: 7, Steps: 20 | Train Loss: 0.899 Vali Loss: 1.354 Vali Acc: 0.400 Test Loss: 1.354 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8717641830444336
Epoch: 8, Steps: 20 | Train Loss: 0.548 Vali Loss: 1.364 Vali Acc: 0.500 Test Loss: 1.364 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.8512868881225586
Epoch: 9, Steps: 20 | Train Loss: 0.401 Vali Loss: 1.471 Vali Acc: 0.530 Test Loss: 1.471 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.586528778076172
Epoch: 10, Steps: 20 | Train Loss: 0.443 Vali Loss: 1.572 Vali Acc: 0.430 Test Loss: 1.572 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.7045164108276367
Epoch: 11, Steps: 20 | Train Loss: 0.488 Vali Loss: 1.722 Vali Acc: 0.480 Test Loss: 1.722 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.741783618927002
Epoch: 12, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.795 Vali Acc: 0.520 Test Loss: 1.795 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 156866
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.5682854652404785
Epoch: 1, Steps: 20 | Train Loss: 0.788 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.9894394874572754
Epoch: 2, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.963 Vali Acc: 0.490 Test Loss: 0.963 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.004883050918579
Epoch: 3, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.878 Vali Acc: 0.530 Test Loss: 0.878 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0889952182769775
Epoch: 4, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.997 Vali Acc: 0.560 Test Loss: 0.997 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559990).  Saving model ...
Epoch: 5 cost time: 3.0288703441619873
Epoch: 5, Steps: 20 | Train Loss: 0.600 Vali Loss: 1.291 Vali Acc: 0.560 Test Loss: 1.291 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9168267250061035
Epoch: 6, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.013 Vali Acc: 0.490 Test Loss: 1.013 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7163307666778564
Epoch: 7, Steps: 20 | Train Loss: 0.485 Vali Loss: 1.640 Vali Acc: 0.510 Test Loss: 1.640 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8581700325012207
Epoch: 8, Steps: 20 | Train Loss: 0.508 Vali Loss: 1.304 Vali Acc: 0.510 Test Loss: 1.304 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6402008533477783
Epoch: 9, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.578 Vali Acc: 0.510 Test Loss: 1.578 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.602097988128662
Epoch: 10, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.497 Vali Acc: 0.490 Test Loss: 1.497 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.574897289276123
Epoch: 11, Steps: 20 | Train Loss: 0.341 Vali Loss: 1.454 Vali Acc: 0.510 Test Loss: 1.454 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7543978691101074
Epoch: 12, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.720 Vali Acc: 0.490 Test Loss: 1.720 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.6819405555725098
Epoch: 13, Steps: 20 | Train Loss: 0.404 Vali Loss: 1.992 Vali Acc: 0.490 Test Loss: 1.992 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.702826738357544
Epoch: 14, Steps: 20 | Train Loss: 0.335 Vali Loss: 2.016 Vali Acc: 0.510 Test Loss: 2.016 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 156930
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.223009824752808
Epoch: 1, Steps: 20 | Train Loss: 0.840 Vali Loss: 0.821 Vali Acc: 0.570 Test Loss: 0.821 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 2.3892741203308105
Epoch: 2, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.823 Vali Acc: 0.490 Test Loss: 0.823 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.450885772705078
Epoch: 3, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.840 Vali Acc: 0.480 Test Loss: 0.840 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4720661640167236
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 1.028 Vali Acc: 0.510 Test Loss: 1.028 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.211942434310913
Epoch: 5, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.958 Vali Acc: 0.520 Test Loss: 0.958 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.421849489212036
Epoch: 6, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.928 Vali Acc: 0.490 Test Loss: 0.928 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.440995931625366
Epoch: 7, Steps: 20 | Train Loss: 0.489 Vali Loss: 1.148 Vali Acc: 0.460 Test Loss: 1.148 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.3768835067749023
Epoch: 8, Steps: 20 | Train Loss: 0.413 Vali Loss: 1.085 Vali Acc: 0.510 Test Loss: 1.085 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.20033860206604
Epoch: 9, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.409 Vali Acc: 0.500 Test Loss: 1.409 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.3143579959869385
Epoch: 10, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.091 Vali Acc: 0.540 Test Loss: 1.091 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.218623399734497
Epoch: 11, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.481 Vali Acc: 0.470 Test Loss: 1.481 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 128322
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.725388288497925
Epoch: 1, Steps: 20 | Train Loss: 0.785 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 3.1242756843566895
Epoch: 2, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.858 Vali Acc: 0.520 Test Loss: 0.858 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2771425247192383
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.958 Vali Acc: 0.490 Test Loss: 0.958 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4355101585388184
Epoch: 4, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.845 Vali Acc: 0.510 Test Loss: 0.845 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.3863015174865723
Epoch: 5, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.946 Vali Acc: 0.530 Test Loss: 0.946 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2557952404022217
Epoch: 6, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.999 Vali Acc: 0.460 Test Loss: 0.999 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.013273239135742
Epoch: 7, Steps: 20 | Train Loss: 0.626 Vali Loss: 1.433 Vali Acc: 0.510 Test Loss: 1.433 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.9546446800231934
Epoch: 8, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.964 Vali Acc: 0.510 Test Loss: 0.964 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.1286275386810303
Epoch: 9, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.986 Vali Acc: 0.500 Test Loss: 0.986 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.9054691791534424
Epoch: 10, Steps: 20 | Train Loss: 0.464 Vali Loss: 1.207 Vali Acc: 0.530 Test Loss: 1.207 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.0392985343933105
Epoch: 11, Steps: 20 | Train Loss: 0.450 Vali Loss: 1.571 Vali Acc: 0.530 Test Loss: 1.571 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 110594
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.6445653438568115
Epoch: 1, Steps: 20 | Train Loss: 0.809 Vali Loss: 0.781 Vali Acc: 0.460 Test Loss: 0.781 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 2.8468449115753174
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.833 Vali Acc: 0.480 Test Loss: 0.833 Test Acc: 0.480
Validation loss decreased (-0.459992 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 2.9462709426879883
Epoch: 3, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.921 Vali Acc: 0.470 Test Loss: 0.921 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.738621950149536
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.992 Vali Acc: 0.480 Test Loss: 0.992 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0347471237182617
Epoch: 5, Steps: 20 | Train Loss: 0.643 Vali Loss: 1.287 Vali Acc: 0.510 Test Loss: 1.287 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509987).  Saving model ...
Epoch: 6 cost time: 2.9655706882476807
Epoch: 6, Steps: 20 | Train Loss: 0.590 Vali Loss: 1.073 Vali Acc: 0.500 Test Loss: 1.073 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.825420618057251
Epoch: 7, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.938 Vali Acc: 0.510 Test Loss: 0.938 Test Acc: 0.510
Validation loss decreased (-0.509987 --> -0.509991).  Saving model ...
Epoch: 8 cost time: 2.8190221786499023
Epoch: 8, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.980 Vali Acc: 0.530 Test Loss: 0.980 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529990).  Saving model ...
Epoch: 9 cost time: 2.790283679962158
Epoch: 9, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.104 Vali Acc: 0.480 Test Loss: 1.104 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9112026691436768
Epoch: 10, Steps: 20 | Train Loss: 0.460 Vali Loss: 1.153 Vali Acc: 0.430 Test Loss: 1.153 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9945313930511475
Epoch: 11, Steps: 20 | Train Loss: 0.503 Vali Loss: 1.269 Vali Acc: 0.450 Test Loss: 1.269 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0245797634124756
Epoch: 12, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.137 Vali Acc: 0.510 Test Loss: 1.137 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9819812774658203
Epoch: 13, Steps: 20 | Train Loss: 0.326 Vali Loss: 1.270 Vali Acc: 0.430 Test Loss: 1.270 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9179530143737793
Epoch: 14, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.729778289794922
Epoch: 15, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.361 Vali Acc: 0.490 Test Loss: 1.361 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.1024749279022217
Epoch: 16, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.270 Vali Acc: 0.490 Test Loss: 1.270 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.9980521202087402
Epoch: 17, Steps: 20 | Train Loss: 0.276 Vali Loss: 1.392 Vali Acc: 0.490 Test Loss: 1.392 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.1565933227539062
Epoch: 18, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.485 Vali Acc: 0.500 Test Loss: 1.485 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 103554
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.816897392272949
Epoch: 1, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.526611804962158
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 2.703394651412964
Epoch: 3, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.891 Vali Acc: 0.490 Test Loss: 0.891 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.691693067550659
Epoch: 4, Steps: 20 | Train Loss: 0.622 Vali Loss: 1.015 Vali Acc: 0.540 Test Loss: 1.015 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539990).  Saving model ...
Epoch: 5 cost time: 2.688934803009033
Epoch: 5, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.947 Vali Acc: 0.520 Test Loss: 0.947 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.451850414276123
Epoch: 6, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.892 Vali Acc: 0.480 Test Loss: 0.892 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.564807891845703
Epoch: 7, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.981 Vali Acc: 0.510 Test Loss: 0.981 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5678462982177734
Epoch: 8, Steps: 20 | Train Loss: 0.587 Vali Loss: 1.044 Vali Acc: 0.480 Test Loss: 1.044 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.599095582962036
Epoch: 9, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.926 Vali Acc: 0.510 Test Loss: 0.926 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4230971336364746
Epoch: 10, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.929 Vali Acc: 0.550 Test Loss: 0.929 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549991).  Saving model ...
Epoch: 11 cost time: 2.7979114055633545
Epoch: 11, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.058 Vali Acc: 0.490 Test Loss: 1.058 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.742936134338379
Epoch: 12, Steps: 20 | Train Loss: 0.419 Vali Loss: 1.198 Vali Acc: 0.540 Test Loss: 1.198 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.756057024002075
Epoch: 13, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.032 Vali Acc: 0.550 Test Loss: 1.032 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9444987773895264
Epoch: 14, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.146 Vali Acc: 0.430 Test Loss: 1.146 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.8832921981811523
Epoch: 15, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.115 Vali Acc: 0.530 Test Loss: 1.115 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7980098724365234
Epoch: 16, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.140 Vali Acc: 0.520 Test Loss: 1.140 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.695345401763916
Epoch: 17, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.228 Vali Acc: 0.560 Test Loss: 1.228 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559988).  Saving model ...
Epoch: 18 cost time: 2.979804039001465
Epoch: 18, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.340 Vali Acc: 0.510 Test Loss: 1.340 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4809389114379883
Epoch: 19, Steps: 20 | Train Loss: 0.241 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.590223789215088
Epoch: 20, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.283 Vali Acc: 0.540 Test Loss: 1.283 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.7780070304870605
Epoch: 21, Steps: 20 | Train Loss: 0.174 Vali Loss: 1.479 Vali Acc: 0.510 Test Loss: 1.479 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.807765245437622
Epoch: 22, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.845 Vali Acc: 0.540 Test Loss: 1.845 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.528893232345581
Epoch: 23, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.542 Vali Acc: 0.540 Test Loss: 1.542 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.6612331867218018
Epoch: 24, Steps: 20 | Train Loss: 0.123 Vali Loss: 1.640 Vali Acc: 0.490 Test Loss: 1.640 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8101789951324463
Epoch: 25, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.707 Vali Acc: 0.550 Test Loss: 1.707 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.750020980834961
Epoch: 26, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.760 Vali Acc: 0.500 Test Loss: 1.760 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.5124285221099854
Epoch: 27, Steps: 20 | Train Loss: 0.104 Vali Loss: 1.794 Vali Acc: 0.510 Test Loss: 1.794 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 92994
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.6016645431518555
Epoch: 1, Steps: 20 | Train Loss: 0.893 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 4.44570779800415
Epoch: 2, Steps: 20 | Train Loss: 0.864 Vali Loss: 0.751 Vali Acc: 0.600 Test Loss: 0.751 Test Acc: 0.600
Validation loss decreased (-0.519992 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 4.5713324546813965
Epoch: 3, Steps: 20 | Train Loss: 0.827 Vali Loss: 1.160 Vali Acc: 0.540 Test Loss: 1.160 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.325763463973999
Epoch: 4, Steps: 20 | Train Loss: 1.070 Vali Loss: 1.708 Vali Acc: 0.490 Test Loss: 1.708 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9418699741363525
Epoch: 5, Steps: 20 | Train Loss: 1.210 Vali Loss: 1.489 Vali Acc: 0.510 Test Loss: 1.489 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.136841058731079
Epoch: 6, Steps: 20 | Train Loss: 0.635 Vali Loss: 1.359 Vali Acc: 0.510 Test Loss: 1.359 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.9017791748046875
Epoch: 7, Steps: 20 | Train Loss: 0.606 Vali Loss: 1.409 Vali Acc: 0.520 Test Loss: 1.409 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.612759590148926
Epoch: 8, Steps: 20 | Train Loss: 0.430 Vali Loss: 2.552 Vali Acc: 0.530 Test Loss: 2.552 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.940213680267334
Epoch: 9, Steps: 20 | Train Loss: 1.023 Vali Loss: 3.195 Vali Acc: 0.510 Test Loss: 3.195 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.236363410949707
Epoch: 10, Steps: 20 | Train Loss: 0.643 Vali Loss: 2.065 Vali Acc: 0.570 Test Loss: 2.065 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.2602880001068115
Epoch: 11, Steps: 20 | Train Loss: 1.498 Vali Loss: 2.959 Vali Acc: 0.460 Test Loss: 2.959 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.347893714904785
Epoch: 12, Steps: 20 | Train Loss: 0.617 Vali Loss: 3.039 Vali Acc: 0.500 Test Loss: 3.039 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 229890
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.830028772354126
Epoch: 1, Steps: 20 | Train Loss: 0.818 Vali Loss: 1.070 Vali Acc: 0.510 Test Loss: 1.070 Test Acc: 0.510
Validation loss decreased (inf --> -0.509989).  Saving model ...
Epoch: 2 cost time: 2.8894317150115967
Epoch: 2, Steps: 20 | Train Loss: 0.793 Vali Loss: 0.858 Vali Acc: 0.510 Test Loss: 0.858 Test Acc: 0.510
Validation loss decreased (-0.509989 --> -0.509991).  Saving model ...
Epoch: 3 cost time: 2.955160140991211
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 1.453 Vali Acc: 0.500 Test Loss: 1.453 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7444095611572266
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 1.034 Vali Acc: 0.580 Test Loss: 1.034 Test Acc: 0.580
Validation loss decreased (-0.509991 --> -0.579990).  Saving model ...
Epoch: 5 cost time: 2.933823585510254
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.147834539413452
Epoch: 6, Steps: 20 | Train Loss: 0.622 Vali Loss: 1.364 Vali Acc: 0.490 Test Loss: 1.364 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.056753396987915
Epoch: 7, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.305 Vali Acc: 0.510 Test Loss: 1.305 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.5572259426116943
Epoch: 8, Steps: 20 | Train Loss: 0.470 Vali Loss: 1.203 Vali Acc: 0.530 Test Loss: 1.203 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.6076674461364746
Epoch: 9, Steps: 20 | Train Loss: 0.409 Vali Loss: 1.886 Vali Acc: 0.530 Test Loss: 1.886 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.430785894393921
Epoch: 10, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.896 Vali Acc: 0.520 Test Loss: 1.896 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.483595371246338
Epoch: 11, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.759 Vali Acc: 0.520 Test Loss: 1.759 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.76845121383667
Epoch: 12, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.826 Vali Acc: 0.490 Test Loss: 1.826 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.602268695831299
Epoch: 13, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.926 Vali Acc: 0.460 Test Loss: 1.926 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.6825520992279053
Epoch: 14, Steps: 20 | Train Loss: 0.410 Vali Loss: 2.000 Vali Acc: 0.500 Test Loss: 2.000 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 140354
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.263912916183472
Epoch: 1, Steps: 20 | Train Loss: 0.866 Vali Loss: 0.868 Vali Acc: 0.520 Test Loss: 0.868 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 3.2283079624176025
Epoch: 2, Steps: 20 | Train Loss: 0.814 Vali Loss: 0.906 Vali Acc: 0.500 Test Loss: 0.906 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6520638465881348
Epoch: 3, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.557192087173462
Epoch: 4, Steps: 20 | Train Loss: 0.740 Vali Loss: 1.139 Vali Acc: 0.520 Test Loss: 1.139 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.594031810760498
Epoch: 5, Steps: 20 | Train Loss: 0.647 Vali Loss: 2.138 Vali Acc: 0.510 Test Loss: 2.138 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.4476840496063232
Epoch: 6, Steps: 20 | Train Loss: 0.753 Vali Loss: 1.142 Vali Acc: 0.520 Test Loss: 1.142 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.5545754432678223
Epoch: 7, Steps: 20 | Train Loss: 0.446 Vali Loss: 1.761 Vali Acc: 0.520 Test Loss: 1.761 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.4642512798309326
Epoch: 8, Steps: 20 | Train Loss: 0.546 Vali Loss: 1.269 Vali Acc: 0.510 Test Loss: 1.269 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.3722314834594727
Epoch: 9, Steps: 20 | Train Loss: 0.447 Vali Loss: 2.174 Vali Acc: 0.420 Test Loss: 2.174 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.1472890377044678
Epoch: 10, Steps: 20 | Train Loss: 0.671 Vali Loss: 1.798 Vali Acc: 0.530 Test Loss: 1.798 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529982).  Saving model ...
Epoch: 11 cost time: 3.1211907863616943
Epoch: 11, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.841 Vali Acc: 0.470 Test Loss: 1.841 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1894724369049072
Epoch: 12, Steps: 20 | Train Loss: 0.642 Vali Loss: 2.676 Vali Acc: 0.560 Test Loss: 2.676 Test Acc: 0.560
Validation loss decreased (-0.529982 --> -0.559973).  Saving model ...
Epoch: 13 cost time: 3.247014045715332
Epoch: 13, Steps: 20 | Train Loss: 0.747 Vali Loss: 2.167 Vali Acc: 0.630 Test Loss: 2.167 Test Acc: 0.630
Validation loss decreased (-0.559973 --> -0.629978).  Saving model ...
Epoch: 14 cost time: 3.0558884143829346
Epoch: 14, Steps: 20 | Train Loss: 0.621 Vali Loss: 2.492 Vali Acc: 0.460 Test Loss: 2.492 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8597922325134277
Epoch: 15, Steps: 20 | Train Loss: 0.354 Vali Loss: 2.768 Vali Acc: 0.540 Test Loss: 2.768 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2203686237335205
Epoch: 16, Steps: 20 | Train Loss: 0.539 Vali Loss: 2.500 Vali Acc: 0.460 Test Loss: 2.500 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.271502733230591
Epoch: 17, Steps: 20 | Train Loss: 0.268 Vali Loss: 2.367 Vali Acc: 0.490 Test Loss: 2.367 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3855226039886475
Epoch: 18, Steps: 20 | Train Loss: 0.253 Vali Loss: 2.651 Vali Acc: 0.440 Test Loss: 2.651 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.7395365238189697
Epoch: 19, Steps: 20 | Train Loss: 0.289 Vali Loss: 2.730 Vali Acc: 0.510 Test Loss: 2.730 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.4101486206054688
Epoch: 20, Steps: 20 | Train Loss: 0.218 Vali Loss: 3.009 Vali Acc: 0.570 Test Loss: 3.009 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.5356271266937256
Epoch: 21, Steps: 20 | Train Loss: 0.116 Vali Loss: 3.304 Vali Acc: 0.480 Test Loss: 3.304 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.6073453426361084
Epoch: 22, Steps: 20 | Train Loss: 0.147 Vali Loss: 3.109 Vali Acc: 0.470 Test Loss: 3.109 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.3945162296295166
Epoch: 23, Steps: 20 | Train Loss: 0.198 Vali Loss: 3.324 Vali Acc: 0.480 Test Loss: 3.324 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 140418
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.9888246059417725
Epoch: 1, Steps: 20 | Train Loss: 0.850 Vali Loss: 0.802 Vali Acc: 0.510 Test Loss: 0.802 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.130631923675537
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.869 Vali Acc: 0.480 Test Loss: 0.869 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1243109703063965
Epoch: 3, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.905 Vali Acc: 0.520 Test Loss: 0.905 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519991).  Saving model ...
Epoch: 4 cost time: 2.605618715286255
Epoch: 4, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.875 Vali Acc: 0.470 Test Loss: 0.875 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6469712257385254
Epoch: 5, Steps: 20 | Train Loss: 0.591 Vali Loss: 1.527 Vali Acc: 0.510 Test Loss: 1.527 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4412972927093506
Epoch: 6, Steps: 20 | Train Loss: 0.715 Vali Loss: 1.141 Vali Acc: 0.510 Test Loss: 1.141 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.484098196029663
Epoch: 7, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.621570348739624
Epoch: 8, Steps: 20 | Train Loss: 0.555 Vali Loss: 1.105 Vali Acc: 0.530 Test Loss: 1.105 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529989).  Saving model ...
Epoch: 9 cost time: 3.703172445297241
Epoch: 9, Steps: 20 | Train Loss: 0.479 Vali Loss: 1.271 Vali Acc: 0.520 Test Loss: 1.271 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6323301792144775
Epoch: 10, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.184 Vali Acc: 0.470 Test Loss: 1.184 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.630139112472534
Epoch: 11, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.568 Vali Acc: 0.530 Test Loss: 1.568 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0957422256469727
Epoch: 12, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.533 Vali Acc: 0.500 Test Loss: 1.533 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.048335313796997
Epoch: 13, Steps: 20 | Train Loss: 0.397 Vali Loss: 1.436 Vali Acc: 0.500 Test Loss: 1.436 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.944957733154297
Epoch: 14, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.397 Vali Acc: 0.540 Test Loss: 1.397 Test Acc: 0.540
Validation loss decreased (-0.529989 --> -0.539986).  Saving model ...
Epoch: 15 cost time: 3.1486544609069824
Epoch: 15, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.442 Vali Acc: 0.500 Test Loss: 1.442 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2256786823272705
Epoch: 16, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.742 Vali Acc: 0.530 Test Loss: 1.742 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9358890056610107
Epoch: 17, Steps: 20 | Train Loss: 0.315 Vali Loss: 2.280 Vali Acc: 0.550 Test Loss: 2.280 Test Acc: 0.550
Validation loss decreased (-0.539986 --> -0.549977).  Saving model ...
Epoch: 18 cost time: 2.8091421127319336
Epoch: 18, Steps: 20 | Train Loss: 0.431 Vali Loss: 2.420 Vali Acc: 0.510 Test Loss: 2.420 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1213221549987793
Epoch: 19, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.831 Vali Acc: 0.510 Test Loss: 1.831 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.279968738555908
Epoch: 20, Steps: 20 | Train Loss: 0.223 Vali Loss: 2.018 Vali Acc: 0.500 Test Loss: 2.018 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.386186122894287
Epoch: 21, Steps: 20 | Train Loss: 0.187 Vali Loss: 2.265 Vali Acc: 0.500 Test Loss: 2.265 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.2423598766326904
Epoch: 22, Steps: 20 | Train Loss: 0.200 Vali Loss: 2.049 Vali Acc: 0.570 Test Loss: 2.049 Test Acc: 0.570
Validation loss decreased (-0.549977 --> -0.569980).  Saving model ...
Epoch: 23 cost time: 3.3688108921051025
Epoch: 23, Steps: 20 | Train Loss: 0.110 Vali Loss: 2.279 Vali Acc: 0.490 Test Loss: 2.279 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.8488073348999023
Epoch: 24, Steps: 20 | Train Loss: 0.106 Vali Loss: 2.292 Vali Acc: 0.530 Test Loss: 2.292 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.212207794189453
Epoch: 25, Steps: 20 | Train Loss: 0.196 Vali Loss: 2.467 Vali Acc: 0.500 Test Loss: 2.467 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.3080337047576904
Epoch: 26, Steps: 20 | Train Loss: 0.102 Vali Loss: 2.430 Vali Acc: 0.480 Test Loss: 2.430 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.87751841545105
Epoch: 27, Steps: 20 | Train Loss: 0.101 Vali Loss: 2.426 Vali Acc: 0.530 Test Loss: 2.426 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.643275737762451
Epoch: 28, Steps: 20 | Train Loss: 0.050 Vali Loss: 2.286 Vali Acc: 0.500 Test Loss: 2.286 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.864043712615967
Epoch: 29, Steps: 20 | Train Loss: 0.106 Vali Loss: 2.896 Vali Acc: 0.540 Test Loss: 2.896 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.910902500152588
Epoch: 30, Steps: 20 | Train Loss: 0.042 Vali Loss: 2.697 Vali Acc: 0.480 Test Loss: 2.697 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.041429042816162
Epoch: 31, Steps: 20 | Train Loss: 0.144 Vali Loss: 3.489 Vali Acc: 0.500 Test Loss: 3.489 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.992363214492798
Epoch: 32, Steps: 20 | Train Loss: 0.115 Vali Loss: 3.082 Vali Acc: 0.510 Test Loss: 3.082 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 111810
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.599654912948608
Epoch: 1, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.910 Vali Acc: 0.450 Test Loss: 0.910 Test Acc: 0.450
Validation loss decreased (inf --> -0.449991).  Saving model ...
Epoch: 2 cost time: 2.7627131938934326
Epoch: 2, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.860 Vali Acc: 0.490 Test Loss: 0.860 Test Acc: 0.490
Validation loss decreased (-0.449991 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 2.7460415363311768
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.815 Vali Acc: 0.540 Test Loss: 0.815 Test Acc: 0.540
Validation loss decreased (-0.489991 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 2.6012840270996094
Epoch: 4, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.871 Vali Acc: 0.500 Test Loss: 0.871 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.180894136428833
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.470839500427246
Epoch: 6, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.915 Vali Acc: 0.570 Test Loss: 0.915 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569991).  Saving model ...
Epoch: 7 cost time: 2.1942052841186523
Epoch: 7, Steps: 20 | Train Loss: 0.523 Vali Loss: 1.186 Vali Acc: 0.550 Test Loss: 1.186 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2092506885528564
Epoch: 8, Steps: 20 | Train Loss: 0.602 Vali Loss: 1.219 Vali Acc: 0.490 Test Loss: 1.219 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9644992351531982
Epoch: 9, Steps: 20 | Train Loss: 0.546 Vali Loss: 1.155 Vali Acc: 0.470 Test Loss: 1.155 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.321593761444092
Epoch: 10, Steps: 20 | Train Loss: 0.502 Vali Loss: 1.125 Vali Acc: 0.460 Test Loss: 1.125 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4464073181152344
Epoch: 11, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.999 Vali Acc: 0.530 Test Loss: 0.999 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2518746852874756
Epoch: 12, Steps: 20 | Train Loss: 0.443 Vali Loss: 1.281 Vali Acc: 0.530 Test Loss: 1.281 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1773459911346436
Epoch: 13, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.432 Vali Acc: 0.470 Test Loss: 1.432 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8580970764160156
Epoch: 14, Steps: 20 | Train Loss: 0.368 Vali Loss: 1.193 Vali Acc: 0.470 Test Loss: 1.193 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8086791038513184
Epoch: 15, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.275 Vali Acc: 0.490 Test Loss: 1.275 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5623726844787598
Epoch: 16, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.556 Vali Acc: 0.450 Test Loss: 1.556 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 94082
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9288947582244873
Epoch: 1, Steps: 20 | Train Loss: 0.786 Vali Loss: 0.754 Vali Acc: 0.550 Test Loss: 0.754 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 2.4009687900543213
Epoch: 2, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.237180709838867
Epoch: 3, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.832 Vali Acc: 0.440 Test Loss: 0.832 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.322774648666382
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.843 Vali Acc: 0.530 Test Loss: 0.843 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1482155323028564
Epoch: 5, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.956 Vali Acc: 0.450 Test Loss: 0.956 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9610931873321533
Epoch: 6, Steps: 20 | Train Loss: 0.565 Vali Loss: 1.017 Vali Acc: 0.520 Test Loss: 1.017 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2069807052612305
Epoch: 7, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.886 Vali Acc: 0.450 Test Loss: 0.886 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2784037590026855
Epoch: 8, Steps: 20 | Train Loss: 0.531 Vali Loss: 1.041 Vali Acc: 0.530 Test Loss: 1.041 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.768110513687134
Epoch: 9, Steps: 20 | Train Loss: 0.467 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.637795925140381
Epoch: 10, Steps: 20 | Train Loss: 0.519 Vali Loss: 1.175 Vali Acc: 0.580 Test Loss: 1.175 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579988).  Saving model ...
Epoch: 11 cost time: 2.6434166431427
Epoch: 11, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.311 Vali Acc: 0.530 Test Loss: 1.311 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8420627117156982
Epoch: 12, Steps: 20 | Train Loss: 0.512 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7641732692718506
Epoch: 13, Steps: 20 | Train Loss: 0.439 Vali Loss: 1.173 Vali Acc: 0.460 Test Loss: 1.173 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7069883346557617
Epoch: 14, Steps: 20 | Train Loss: 0.364 Vali Loss: 1.273 Vali Acc: 0.460 Test Loss: 1.273 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6131701469421387
Epoch: 15, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.469 Vali Acc: 0.480 Test Loss: 1.469 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7730348110198975
Epoch: 16, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.426 Vali Acc: 0.480 Test Loss: 1.426 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.270594358444214
Epoch: 17, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.358 Vali Acc: 0.450 Test Loss: 1.358 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2983131408691406
Epoch: 18, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.483 Vali Acc: 0.450 Test Loss: 1.483 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.225545644760132
Epoch: 19, Steps: 20 | Train Loss: 0.354 Vali Loss: 2.294 Vali Acc: 0.480 Test Loss: 2.294 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.426635265350342
Epoch: 20, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.795 Vali Acc: 0.500 Test Loss: 1.795 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 87042
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.404871940612793
Epoch: 1, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.628899335861206
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.765 Vali Acc: 0.470 Test Loss: 0.765 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.360774278640747
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.905 Vali Acc: 0.530 Test Loss: 0.905 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529991).  Saving model ...
Epoch: 4 cost time: 2.571810245513916
Epoch: 4, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.801 Vali Acc: 0.510 Test Loss: 0.801 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.610983371734619
Epoch: 5, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.645282506942749
Epoch: 6, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.885 Vali Acc: 0.560 Test Loss: 0.885 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559991).  Saving model ...
Epoch: 7 cost time: 2.7899258136749268
Epoch: 7, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.918 Vali Acc: 0.510 Test Loss: 0.918 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4032273292541504
Epoch: 8, Steps: 20 | Train Loss: 0.540 Vali Loss: 1.078 Vali Acc: 0.520 Test Loss: 1.078 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.107757329940796
Epoch: 9, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.841 Vali Acc: 0.500 Test Loss: 0.841 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4362354278564453
Epoch: 10, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.953 Vali Acc: 0.520 Test Loss: 0.953 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.390673875808716
Epoch: 11, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.983 Vali Acc: 0.520 Test Loss: 0.983 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5615293979644775
Epoch: 12, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.013 Vali Acc: 0.560 Test Loss: 1.013 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.442201852798462
Epoch: 13, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.023 Vali Acc: 0.490 Test Loss: 1.023 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.611069440841675
Epoch: 14, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.032 Vali Acc: 0.550 Test Loss: 1.032 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3425652980804443
Epoch: 15, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8190183639526367
Epoch: 16, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm64_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 76482
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.064850568771362
Epoch: 1, Steps: 20 | Train Loss: 0.860 Vali Loss: 0.847 Vali Acc: 0.540 Test Loss: 0.847 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 2.6369078159332275
Epoch: 2, Steps: 20 | Train Loss: 0.836 Vali Loss: 0.802 Vali Acc: 0.590 Test Loss: 0.802 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589992).  Saving model ...
Epoch: 3 cost time: 2.6133856773376465
Epoch: 3, Steps: 20 | Train Loss: 0.827 Vali Loss: 0.959 Vali Acc: 0.420 Test Loss: 0.959 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.673356294631958
Epoch: 4, Steps: 20 | Train Loss: 0.620 Vali Loss: 1.061 Vali Acc: 0.500 Test Loss: 1.061 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6012461185455322
Epoch: 5, Steps: 20 | Train Loss: 0.581 Vali Loss: 1.260 Vali Acc: 0.540 Test Loss: 1.260 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4387917518615723
Epoch: 6, Steps: 20 | Train Loss: 0.615 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5904107093811035
Epoch: 7, Steps: 20 | Train Loss: 0.461 Vali Loss: 1.325 Vali Acc: 0.490 Test Loss: 1.325 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.537170886993408
Epoch: 8, Steps: 20 | Train Loss: 0.458 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4386942386627197
Epoch: 9, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.595 Vali Acc: 0.540 Test Loss: 1.595 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.490769863128662
Epoch: 10, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.261 Vali Acc: 0.520 Test Loss: 1.261 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5209100246429443
Epoch: 11, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.495 Vali Acc: 0.540 Test Loss: 1.495 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6941299438476562
Epoch: 12, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.891 Vali Acc: 0.510 Test Loss: 1.891 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 131778
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8300669193267822
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.771 Vali Acc: 0.530 Test Loss: 0.771 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.1219677925109863
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.876 Vali Acc: 0.530 Test Loss: 0.876 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.177456855773926
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.876 Vali Acc: 0.510 Test Loss: 0.876 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2232000827789307
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.868 Vali Acc: 0.540 Test Loss: 0.868 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539991).  Saving model ...
Epoch: 5 cost time: 2.2259609699249268
Epoch: 5, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.841 Vali Acc: 0.480 Test Loss: 0.841 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9560623168945312
Epoch: 6, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.898 Vali Acc: 0.540 Test Loss: 0.898 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1659576892852783
Epoch: 7, Steps: 20 | Train Loss: 0.522 Vali Loss: 1.187 Vali Acc: 0.480 Test Loss: 1.187 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.299912452697754
Epoch: 8, Steps: 20 | Train Loss: 0.531 Vali Loss: 1.038 Vali Acc: 0.450 Test Loss: 1.038 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.301807165145874
Epoch: 9, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.153 Vali Acc: 0.460 Test Loss: 1.153 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8986871242523193
Epoch: 10, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.176 Vali Acc: 0.460 Test Loss: 1.176 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1021432876586914
Epoch: 11, Steps: 20 | Train Loss: 0.479 Vali Loss: 1.223 Vali Acc: 0.420 Test Loss: 1.223 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1107165813446045
Epoch: 12, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.240 Vali Acc: 0.460 Test Loss: 1.240 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1856729984283447
Epoch: 13, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.387 Vali Acc: 0.470 Test Loss: 1.387 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1126163005828857
Epoch: 14, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.327 Vali Acc: 0.460 Test Loss: 1.327 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 87010
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.497537851333618
Epoch: 1, Steps: 20 | Train Loss: 0.762 Vali Loss: 0.799 Vali Acc: 0.510 Test Loss: 0.799 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.7887942790985107
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
Validation loss decreased (-0.509992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 1.8333382606506348
Epoch: 3, Steps: 20 | Train Loss: 0.657 Vali Loss: 1.031 Vali Acc: 0.510 Test Loss: 1.031 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0655629634857178
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 1.022 Vali Acc: 0.470 Test Loss: 1.022 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.175691843032837
Epoch: 5, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.979 Vali Acc: 0.510 Test Loss: 0.979 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0845024585723877
Epoch: 6, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.949 Vali Acc: 0.460 Test Loss: 0.949 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.026859998703003
Epoch: 7, Steps: 20 | Train Loss: 0.514 Vali Loss: 1.019 Vali Acc: 0.470 Test Loss: 1.019 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2252299785614014
Epoch: 8, Steps: 20 | Train Loss: 0.568 Vali Loss: 1.251 Vali Acc: 0.420 Test Loss: 1.251 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.157376766204834
Epoch: 9, Steps: 20 | Train Loss: 0.433 Vali Loss: 1.223 Vali Acc: 0.460 Test Loss: 1.223 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.089874267578125
Epoch: 10, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.158 Vali Acc: 0.460 Test Loss: 1.158 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.914862871170044
Epoch: 11, Steps: 20 | Train Loss: 0.494 Vali Loss: 1.336 Vali Acc: 0.510 Test Loss: 1.336 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.095475912094116
Epoch: 12, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.230 Vali Acc: 0.480 Test Loss: 1.230 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 87042
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7571616172790527
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.7284736633300781
Epoch: 2, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 1.915046215057373
Epoch: 3, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.814 Vali Acc: 0.510 Test Loss: 0.814 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.627788782119751
Epoch: 4, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.839 Vali Acc: 0.520 Test Loss: 0.839 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7546961307525635
Epoch: 5, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.849 Vali Acc: 0.550 Test Loss: 0.849 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 1.577148675918579
Epoch: 6, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.900 Vali Acc: 0.470 Test Loss: 0.900 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7049291133880615
Epoch: 7, Steps: 20 | Train Loss: 0.523 Vali Loss: 1.013 Vali Acc: 0.540 Test Loss: 1.013 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6427505016326904
Epoch: 8, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.050 Vali Acc: 0.490 Test Loss: 1.050 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7726283073425293
Epoch: 9, Steps: 20 | Train Loss: 0.458 Vali Loss: 1.044 Vali Acc: 0.550 Test Loss: 1.044 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8195462226867676
Epoch: 10, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.041 Vali Acc: 0.470 Test Loss: 1.041 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8099780082702637
Epoch: 11, Steps: 20 | Train Loss: 0.345 Vali Loss: 1.003 Vali Acc: 0.510 Test Loss: 1.003 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7692196369171143
Epoch: 12, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.292 Vali Acc: 0.510 Test Loss: 1.292 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9443323612213135
Epoch: 13, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.164 Vali Acc: 0.490 Test Loss: 1.164 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7228834629058838
Epoch: 14, Steps: 20 | Train Loss: 0.230 Vali Loss: 1.026 Vali Acc: 0.540 Test Loss: 1.026 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.893146276473999
Epoch: 15, Steps: 20 | Train Loss: 0.234 Vali Loss: 1.191 Vali Acc: 0.540 Test Loss: 1.191 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 72738
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.380694389343262
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.765 Vali Acc: 0.490 Test Loss: 0.765 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.2910895347595215
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.793 Vali Acc: 0.460 Test Loss: 0.793 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3264248371124268
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.876 Vali Acc: 0.450 Test Loss: 0.876 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3347558975219727
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.806 Vali Acc: 0.520 Test Loss: 0.806 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 2.5092239379882812
Epoch: 5, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.821 Vali Acc: 0.540 Test Loss: 0.821 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 2.439797878265381
Epoch: 6, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.934 Vali Acc: 0.490 Test Loss: 0.934 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4773364067077637
Epoch: 7, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.917 Vali Acc: 0.490 Test Loss: 0.917 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.60233736038208
Epoch: 8, Steps: 20 | Train Loss: 0.542 Vali Loss: 1.075 Vali Acc: 0.490 Test Loss: 1.075 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.786433219909668
Epoch: 9, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.860 Vali Acc: 0.520 Test Loss: 0.860 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.285668134689331
Epoch: 10, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.897 Vali Acc: 0.480 Test Loss: 0.897 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.448784589767456
Epoch: 11, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.894 Vali Acc: 0.520 Test Loss: 0.894 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5014758110046387
Epoch: 12, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.961 Vali Acc: 0.510 Test Loss: 0.961 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.7546896934509277
Epoch: 13, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.962 Vali Acc: 0.560 Test Loss: 0.962 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559990).  Saving model ...
Epoch: 14 cost time: 2.7204647064208984
Epoch: 14, Steps: 20 | Train Loss: 0.442 Vali Loss: 1.129 Vali Acc: 0.480 Test Loss: 1.129 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.736762523651123
Epoch: 15, Steps: 20 | Train Loss: 0.339 Vali Loss: 0.916 Vali Acc: 0.530 Test Loss: 0.916 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7925174236297607
Epoch: 16, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.098 Vali Acc: 0.460 Test Loss: 1.098 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.624607563018799
Epoch: 17, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.075 Vali Acc: 0.500 Test Loss: 1.075 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5508923530578613
Epoch: 18, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.353 Vali Acc: 0.530 Test Loss: 1.353 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.633021116256714
Epoch: 19, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.61688494682312
Epoch: 20, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.201 Vali Acc: 0.470 Test Loss: 1.201 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.4938063621520996
Epoch: 21, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.359 Vali Acc: 0.490 Test Loss: 1.359 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.318753242492676
Epoch: 22, Steps: 20 | Train Loss: 0.181 Vali Loss: 1.393 Vali Acc: 0.450 Test Loss: 1.393 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.568942070007324
Epoch: 23, Steps: 20 | Train Loss: 0.224 Vali Loss: 1.208 Vali Acc: 0.540 Test Loss: 1.208 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 63874
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.064307451248169
Epoch: 1, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.750 Vali Acc: 0.450 Test Loss: 0.750 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 2.6027164459228516
Epoch: 2, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
Validation loss decreased (-0.449992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 2.2862155437469482
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.845 Vali Acc: 0.480 Test Loss: 0.845 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7120866775512695
Epoch: 4, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.964 Vali Acc: 0.480 Test Loss: 0.964 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6300530433654785
Epoch: 5, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.867 Vali Acc: 0.500 Test Loss: 0.867 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6514689922332764
Epoch: 6, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.843 Vali Acc: 0.520 Test Loss: 0.843 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3413400650024414
Epoch: 7, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.804 Vali Acc: 0.520 Test Loss: 0.804 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4107139110565186
Epoch: 8, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.872 Vali Acc: 0.490 Test Loss: 0.872 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.461409330368042
Epoch: 9, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.899 Vali Acc: 0.510 Test Loss: 0.899 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6948397159576416
Epoch: 10, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.996 Vali Acc: 0.510 Test Loss: 0.996 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6263115406036377
Epoch: 11, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.936 Vali Acc: 0.490 Test Loss: 0.936 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.567227363586426
Epoch: 12, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.935 Vali Acc: 0.450 Test Loss: 0.935 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 60354
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2094802856445312
Epoch: 1, Steps: 20 | Train Loss: 0.793 Vali Loss: 0.752 Vali Acc: 0.460 Test Loss: 0.752 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.5042755603790283
Epoch: 2, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
Validation loss decreased (-0.459992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 1.3637115955352783
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.797 Vali Acc: 0.440 Test Loss: 0.797 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.405329942703247
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 1.3659093379974365
Epoch: 5, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.828 Vali Acc: 0.480 Test Loss: 0.828 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2716624736785889
Epoch: 6, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 1.4114468097686768
Epoch: 7, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.481309413909912
Epoch: 8, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4482214450836182
Epoch: 9, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.805 Vali Acc: 0.570 Test Loss: 0.805 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 1.537865400314331
Epoch: 10, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.843 Vali Acc: 0.520 Test Loss: 0.843 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4994902610778809
Epoch: 11, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.925 Vali Acc: 0.570 Test Loss: 0.925 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4275093078613281
Epoch: 12, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.008 Vali Acc: 0.500 Test Loss: 1.008 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4928312301635742
Epoch: 13, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.985 Vali Acc: 0.500 Test Loss: 0.985 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3915185928344727
Epoch: 14, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.47139573097229
Epoch: 15, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.985 Vali Acc: 0.560 Test Loss: 0.985 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3754067420959473
Epoch: 16, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.990 Vali Acc: 0.450 Test Loss: 0.990 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4493703842163086
Epoch: 17, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.978 Vali Acc: 0.520 Test Loss: 0.978 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6511483192443848
Epoch: 18, Steps: 20 | Train Loss: 0.369 Vali Loss: 1.018 Vali Acc: 0.580 Test Loss: 1.018 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579990).  Saving model ...
Epoch: 19 cost time: 1.3992266654968262
Epoch: 19, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.028 Vali Acc: 0.500 Test Loss: 1.028 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.251307725906372
Epoch: 20, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.082 Vali Acc: 0.540 Test Loss: 1.082 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.373314619064331
Epoch: 21, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.131 Vali Acc: 0.580 Test Loss: 1.131 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4145927429199219
Epoch: 22, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.167 Vali Acc: 0.560 Test Loss: 1.167 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5868678092956543
Epoch: 23, Steps: 20 | Train Loss: 0.241 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8009998798370361
Epoch: 24, Steps: 20 | Train Loss: 0.264 Vali Loss: 1.092 Vali Acc: 0.520 Test Loss: 1.092 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.516374111175537
Epoch: 25, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.176 Vali Acc: 0.520 Test Loss: 1.176 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5572056770324707
Epoch: 26, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.321 Vali Acc: 0.510 Test Loss: 1.321 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.49476957321167
Epoch: 27, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.254 Vali Acc: 0.560 Test Loss: 1.254 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3716802597045898
Epoch: 28, Steps: 20 | Train Loss: 0.188 Vali Loss: 1.473 Vali Acc: 0.500 Test Loss: 1.473 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 55074
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6596813201904297
Epoch: 1, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.333768129348755
Epoch: 2, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.813 Vali Acc: 0.630 Test Loss: 0.813 Test Acc: 0.630
Validation loss decreased (-0.539993 --> -0.629992).  Saving model ...
Epoch: 3 cost time: 2.356229305267334
Epoch: 3, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.820 Vali Acc: 0.560 Test Loss: 0.820 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1928486824035645
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.893 Vali Acc: 0.530 Test Loss: 0.893 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.317073106765747
Epoch: 5, Steps: 20 | Train Loss: 0.770 Vali Loss: 1.073 Vali Acc: 0.550 Test Loss: 1.073 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2219760417938232
Epoch: 6, Steps: 20 | Train Loss: 0.624 Vali Loss: 1.431 Vali Acc: 0.530 Test Loss: 1.431 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2207694053649902
Epoch: 7, Steps: 20 | Train Loss: 0.662 Vali Loss: 1.063 Vali Acc: 0.550 Test Loss: 1.063 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2355287075042725
Epoch: 8, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.519 Vali Acc: 0.440 Test Loss: 1.519 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0972068309783936
Epoch: 9, Steps: 20 | Train Loss: 0.482 Vali Loss: 1.483 Vali Acc: 0.500 Test Loss: 1.483 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1188700199127197
Epoch: 10, Steps: 20 | Train Loss: 0.622 Vali Loss: 2.077 Vali Acc: 0.500 Test Loss: 2.077 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1754722595214844
Epoch: 11, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.645 Vali Acc: 0.520 Test Loss: 1.645 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.3023107051849365
Epoch: 12, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.650 Vali Acc: 0.470 Test Loss: 1.650 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 115138
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3430542945861816
Epoch: 1, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.801 Vali Acc: 0.480 Test Loss: 0.801 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 1.7193286418914795
Epoch: 2, Steps: 20 | Train Loss: 0.735 Vali Loss: 1.073 Vali Acc: 0.500 Test Loss: 1.073 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 1.7247474193572998
Epoch: 3, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.843 Vali Acc: 0.530 Test Loss: 0.843 Test Acc: 0.530
Validation loss decreased (-0.499989 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.771972894668579
Epoch: 4, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.801 Vali Acc: 0.500 Test Loss: 0.801 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.816610336303711
Epoch: 5, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.896 Vali Acc: 0.500 Test Loss: 0.896 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7866103649139404
Epoch: 6, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.935 Vali Acc: 0.510 Test Loss: 0.935 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8529093265533447
Epoch: 7, Steps: 20 | Train Loss: 0.609 Vali Loss: 1.051 Vali Acc: 0.420 Test Loss: 1.051 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7645890712738037
Epoch: 8, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.904 Vali Acc: 0.470 Test Loss: 0.904 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7088592052459717
Epoch: 9, Steps: 20 | Train Loss: 0.433 Vali Loss: 1.166 Vali Acc: 0.480 Test Loss: 1.166 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.758373498916626
Epoch: 10, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.278 Vali Acc: 0.540 Test Loss: 1.278 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539987).  Saving model ...
Epoch: 11 cost time: 1.7923319339752197
Epoch: 11, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.137 Vali Acc: 0.520 Test Loss: 1.137 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8222689628601074
Epoch: 12, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.116 Vali Acc: 0.480 Test Loss: 1.116 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7895522117614746
Epoch: 13, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.551 Vali Acc: 0.520 Test Loss: 1.551 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.718932867050171
Epoch: 14, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.269 Vali Acc: 0.490 Test Loss: 1.269 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7455742359161377
Epoch: 15, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.422 Vali Acc: 0.470 Test Loss: 1.422 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7848951816558838
Epoch: 16, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.313 Vali Acc: 0.510 Test Loss: 1.313 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7281394004821777
Epoch: 17, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.540 Vali Acc: 0.460 Test Loss: 1.540 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7914938926696777
Epoch: 18, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.443 Vali Acc: 0.430 Test Loss: 1.443 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.744267463684082
Epoch: 19, Steps: 20 | Train Loss: 0.126 Vali Loss: 1.590 Vali Acc: 0.520 Test Loss: 1.590 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8052613735198975
Epoch: 20, Steps: 20 | Train Loss: 0.108 Vali Loss: 1.998 Vali Acc: 0.450 Test Loss: 1.998 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 70370
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.52229380607605
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.824 Vali Acc: 0.480 Test Loss: 0.824 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 1.7343308925628662
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
Validation loss decreased (-0.479992 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.7926125526428223
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.945 Vali Acc: 0.500 Test Loss: 0.945 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 1.744291067123413
Epoch: 4, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.835 Vali Acc: 0.500 Test Loss: 0.835 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 1.717397689819336
Epoch: 5, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.975 Vali Acc: 0.450 Test Loss: 0.975 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8068385124206543
Epoch: 6, Steps: 20 | Train Loss: 0.562 Vali Loss: 1.048 Vali Acc: 0.520 Test Loss: 1.048 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519990).  Saving model ...
Epoch: 7 cost time: 1.7988641262054443
Epoch: 7, Steps: 20 | Train Loss: 0.560 Vali Loss: 1.077 Vali Acc: 0.510 Test Loss: 1.077 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6389226913452148
Epoch: 8, Steps: 20 | Train Loss: 0.523 Vali Loss: 1.043 Vali Acc: 0.500 Test Loss: 1.043 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6090140342712402
Epoch: 9, Steps: 20 | Train Loss: 0.439 Vali Loss: 1.126 Vali Acc: 0.490 Test Loss: 1.126 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8204548358917236
Epoch: 10, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.285 Vali Acc: 0.430 Test Loss: 1.285 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7639789581298828
Epoch: 11, Steps: 20 | Train Loss: 0.326 Vali Loss: 1.320 Vali Acc: 0.470 Test Loss: 1.320 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8069791793823242
Epoch: 12, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.140 Vali Acc: 0.520 Test Loss: 1.140 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6285479068756104
Epoch: 13, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.280 Vali Acc: 0.540 Test Loss: 1.280 Test Acc: 0.540
Validation loss decreased (-0.519990 --> -0.539987).  Saving model ...
Epoch: 14 cost time: 1.737093210220337
Epoch: 14, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.250 Vali Acc: 0.510 Test Loss: 1.250 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7748775482177734
Epoch: 15, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.800 Vali Acc: 0.500 Test Loss: 1.800 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.660876989364624
Epoch: 16, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.413 Vali Acc: 0.500 Test Loss: 1.413 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.030487060546875
Epoch: 17, Steps: 20 | Train Loss: 0.160 Vali Loss: 1.576 Vali Acc: 0.550 Test Loss: 1.576 Test Acc: 0.550
Validation loss decreased (-0.539987 --> -0.549984).  Saving model ...
Epoch: 18 cost time: 1.7779486179351807
Epoch: 18, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.643 Vali Acc: 0.510 Test Loss: 1.643 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7385776042938232
Epoch: 19, Steps: 20 | Train Loss: 0.170 Vali Loss: 1.796 Vali Acc: 0.490 Test Loss: 1.796 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.718996286392212
Epoch: 20, Steps: 20 | Train Loss: 0.149 Vali Loss: 1.976 Vali Acc: 0.510 Test Loss: 1.976 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7937955856323242
Epoch: 21, Steps: 20 | Train Loss: 0.180 Vali Loss: 1.893 Vali Acc: 0.540 Test Loss: 1.893 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7439134120941162
Epoch: 22, Steps: 20 | Train Loss: 0.096 Vali Loss: 1.857 Vali Acc: 0.500 Test Loss: 1.857 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.685903787612915
Epoch: 23, Steps: 20 | Train Loss: 0.052 Vali Loss: 2.182 Vali Acc: 0.480 Test Loss: 2.182 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5802762508392334
Epoch: 24, Steps: 20 | Train Loss: 0.094 Vali Loss: 2.618 Vali Acc: 0.490 Test Loss: 2.618 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6380572319030762
Epoch: 25, Steps: 20 | Train Loss: 0.105 Vali Loss: 2.540 Vali Acc: 0.530 Test Loss: 2.540 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.859928846359253
Epoch: 26, Steps: 20 | Train Loss: 0.126 Vali Loss: 2.120 Vali Acc: 0.580 Test Loss: 2.120 Test Acc: 0.580
Validation loss decreased (-0.549984 --> -0.579979).  Saving model ...
Epoch: 27 cost time: 1.6896116733551025
Epoch: 27, Steps: 20 | Train Loss: 0.179 Vali Loss: 2.733 Vali Acc: 0.490 Test Loss: 2.733 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6728084087371826
Epoch: 28, Steps: 20 | Train Loss: 0.099 Vali Loss: 2.221 Vali Acc: 0.550 Test Loss: 2.221 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.634077548980713
Epoch: 29, Steps: 20 | Train Loss: 0.122 Vali Loss: 3.089 Vali Acc: 0.500 Test Loss: 3.089 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7097532749176025
Epoch: 30, Steps: 20 | Train Loss: 0.189 Vali Loss: 2.747 Vali Acc: 0.520 Test Loss: 2.747 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8477997779846191
Epoch: 31, Steps: 20 | Train Loss: 0.083 Vali Loss: 3.076 Vali Acc: 0.500 Test Loss: 3.076 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.774017333984375
Epoch: 32, Steps: 20 | Train Loss: 0.065 Vali Loss: 2.975 Vali Acc: 0.570 Test Loss: 2.975 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.8461127281188965
Epoch: 33, Steps: 20 | Train Loss: 0.079 Vali Loss: 3.129 Vali Acc: 0.540 Test Loss: 3.129 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7601377964019775
Epoch: 34, Steps: 20 | Train Loss: 0.021 Vali Loss: 3.423 Vali Acc: 0.480 Test Loss: 3.423 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.779569387435913
Epoch: 35, Steps: 20 | Train Loss: 0.012 Vali Loss: 3.032 Vali Acc: 0.480 Test Loss: 3.032 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5928688049316406
Epoch: 36, Steps: 20 | Train Loss: 0.051 Vali Loss: 3.034 Vali Acc: 0.500 Test Loss: 3.034 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 70402
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3908274173736572
Epoch: 1, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.521606683731079
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.858 Vali Acc: 0.470 Test Loss: 0.858 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4402120113372803
Epoch: 3, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.851 Vali Acc: 0.550 Test Loss: 0.851 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5254943370819092
Epoch: 4, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.839 Vali Acc: 0.520 Test Loss: 0.839 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4148902893066406
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.827 Vali Acc: 0.520 Test Loss: 0.827 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.412102460861206
Epoch: 6, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.847 Vali Acc: 0.470 Test Loss: 0.847 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6196277141571045
Epoch: 7, Steps: 20 | Train Loss: 0.619 Vali Loss: 1.443 Vali Acc: 0.510 Test Loss: 1.443 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.600393533706665
Epoch: 8, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.921 Vali Acc: 0.580 Test Loss: 0.921 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579991).  Saving model ...
Epoch: 9 cost time: 1.5449705123901367
Epoch: 9, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.968 Vali Acc: 0.530 Test Loss: 0.968 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4506042003631592
Epoch: 10, Steps: 20 | Train Loss: 0.456 Vali Loss: 1.062 Vali Acc: 0.500 Test Loss: 1.062 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5337231159210205
Epoch: 11, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.913 Vali Acc: 0.540 Test Loss: 0.913 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6330721378326416
Epoch: 12, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.063 Vali Acc: 0.520 Test Loss: 1.063 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6280150413513184
Epoch: 13, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5411436557769775
Epoch: 14, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.326 Vali Acc: 0.540 Test Loss: 1.326 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5541713237762451
Epoch: 15, Steps: 20 | Train Loss: 0.260 Vali Loss: 1.096 Vali Acc: 0.540 Test Loss: 1.096 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5685110092163086
Epoch: 16, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.797 Vali Acc: 0.540 Test Loss: 1.797 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.522291660308838
Epoch: 17, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.240 Vali Acc: 0.540 Test Loss: 1.240 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.511749505996704
Epoch: 18, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.329 Vali Acc: 0.500 Test Loss: 1.329 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 56098
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.955965042114258
Epoch: 1, Steps: 20 | Train Loss: 0.789 Vali Loss: 0.758 Vali Acc: 0.450 Test Loss: 0.758 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 2.080622911453247
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.789 Vali Acc: 0.430 Test Loss: 0.789 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.23649263381958
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.803 Vali Acc: 0.520 Test Loss: 0.803 Test Acc: 0.520
Validation loss decreased (-0.449992 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 2.1367785930633545
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.822 Vali Acc: 0.460 Test Loss: 0.822 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.204291343688965
Epoch: 5, Steps: 20 | Train Loss: 0.656 Vali Loss: 1.088 Vali Acc: 0.490 Test Loss: 1.088 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.068726062774658
Epoch: 6, Steps: 20 | Train Loss: 0.615 Vali Loss: 1.048 Vali Acc: 0.510 Test Loss: 1.048 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0023252964019775
Epoch: 7, Steps: 20 | Train Loss: 0.605 Vali Loss: 1.001 Vali Acc: 0.530 Test Loss: 1.001 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529990).  Saving model ...
Epoch: 8 cost time: 2.2236642837524414
Epoch: 8, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
Validation loss decreased (-0.529990 --> -0.529991).  Saving model ...
Epoch: 9 cost time: 2.3412628173828125
Epoch: 9, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.893 Vali Acc: 0.430 Test Loss: 0.893 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1031136512756348
Epoch: 10, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.891 Vali Acc: 0.500 Test Loss: 0.891 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9603397846221924
Epoch: 11, Steps: 20 | Train Loss: 0.440 Vali Loss: 1.177 Vali Acc: 0.510 Test Loss: 1.177 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3294920921325684
Epoch: 12, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.894 Vali Acc: 0.480 Test Loss: 0.894 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.230314254760742
Epoch: 13, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.910 Vali Acc: 0.510 Test Loss: 0.910 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0689897537231445
Epoch: 14, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.939 Vali Acc: 0.530 Test Loss: 0.939 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1926872730255127
Epoch: 15, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.121 Vali Acc: 0.510 Test Loss: 1.121 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.200655698776245
Epoch: 16, Steps: 20 | Train Loss: 0.406 Vali Loss: 1.053 Vali Acc: 0.490 Test Loss: 1.053 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.210941791534424
Epoch: 17, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9607431888580322
Epoch: 18, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.113 Vali Acc: 0.450 Test Loss: 1.113 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 47234
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5806803703308105
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.753 Vali Acc: 0.480 Test Loss: 0.753 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 1.7409701347351074
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.773 Vali Acc: 0.530 Test Loss: 0.773 Test Acc: 0.530
Validation loss decreased (-0.479992 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 2.0451788902282715
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.822 Vali Acc: 0.490 Test Loss: 0.822 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1253788471221924
Epoch: 4, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.862 Vali Acc: 0.490 Test Loss: 0.862 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.073300838470459
Epoch: 5, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.813 Vali Acc: 0.480 Test Loss: 0.813 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9902374744415283
Epoch: 6, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.843 Vali Acc: 0.500 Test Loss: 0.843 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.781219720840454
Epoch: 7, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.835 Vali Acc: 0.470 Test Loss: 0.835 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7930803298950195
Epoch: 8, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.897 Vali Acc: 0.540 Test Loss: 0.897 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539991).  Saving model ...
Epoch: 9 cost time: 1.8820161819458008
Epoch: 9, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.863 Vali Acc: 0.550 Test Loss: 0.863 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549991).  Saving model ...
Epoch: 10 cost time: 1.763174057006836
Epoch: 10, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.910 Vali Acc: 0.520 Test Loss: 0.910 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8411216735839844
Epoch: 11, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.092942953109741
Epoch: 12, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.962 Vali Acc: 0.480 Test Loss: 0.962 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.125481605529785
Epoch: 13, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.867 Vali Acc: 0.580 Test Loss: 0.867 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579991).  Saving model ...
Epoch: 14 cost time: 2.0495409965515137
Epoch: 14, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.063 Vali Acc: 0.510 Test Loss: 1.063 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.092714309692383
Epoch: 15, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.977 Vali Acc: 0.480 Test Loss: 0.977 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.109706163406372
Epoch: 16, Steps: 20 | Train Loss: 0.403 Vali Loss: 0.953 Vali Acc: 0.540 Test Loss: 0.953 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.078090190887451
Epoch: 17, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.049 Vali Acc: 0.490 Test Loss: 1.049 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5867063999176025
Epoch: 18, Steps: 20 | Train Loss: 0.369 Vali Loss: 1.220 Vali Acc: 0.480 Test Loss: 1.220 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8360137939453125
Epoch: 19, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.030 Vali Acc: 0.520 Test Loss: 1.030 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9539365768432617
Epoch: 20, Steps: 20 | Train Loss: 0.275 Vali Loss: 0.973 Vali Acc: 0.510 Test Loss: 0.973 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3901188373565674
Epoch: 21, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.175 Vali Acc: 0.490 Test Loss: 1.175 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8868675231933594
Epoch: 22, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.812875747680664
Epoch: 23, Steps: 20 | Train Loss: 0.299 Vali Loss: 1.091 Vali Acc: 0.490 Test Loss: 1.091 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 43714
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.93550181388855
Epoch: 1, Steps: 20 | Train Loss: 0.783 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.3189902305603027
Epoch: 2, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.739 Vali Acc: 0.590 Test Loss: 0.739 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 1.3293461799621582
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.791 Vali Acc: 0.590 Test Loss: 0.791 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3430569171905518
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.804 Vali Acc: 0.580 Test Loss: 0.804 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.330571174621582
Epoch: 5, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.787 Vali Acc: 0.560 Test Loss: 0.787 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5679941177368164
Epoch: 6, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.891 Vali Acc: 0.600 Test Loss: 0.891 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599991).  Saving model ...
Epoch: 7 cost time: 1.3170390129089355
Epoch: 7, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.795 Vali Acc: 0.500 Test Loss: 0.795 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.269129991531372
Epoch: 8, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.793 Vali Acc: 0.570 Test Loss: 0.793 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3287765979766846
Epoch: 9, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2756166458129883
Epoch: 10, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.837 Vali Acc: 0.520 Test Loss: 0.837 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.29581880569458
Epoch: 11, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2923016548156738
Epoch: 12, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.897 Vali Acc: 0.490 Test Loss: 0.897 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.258681058883667
Epoch: 13, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3265655040740967
Epoch: 14, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2957158088684082
Epoch: 15, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.876 Vali Acc: 0.500 Test Loss: 0.876 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3627185821533203
Epoch: 16, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.871 Vali Acc: 0.540 Test Loss: 0.871 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 38434
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.201493740081787
Epoch: 1, Steps: 20 | Train Loss: 0.794 Vali Loss: 0.788 Vali Acc: 0.450 Test Loss: 0.788 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 2.0495145320892334
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.861 Vali Acc: 0.550 Test Loss: 0.861 Test Acc: 0.550
Validation loss decreased (-0.449992 --> -0.549991).  Saving model ...
Epoch: 3 cost time: 2.3715147972106934
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.877 Vali Acc: 0.490 Test Loss: 0.877 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2229928970336914
Epoch: 4, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.958 Vali Acc: 0.520 Test Loss: 0.958 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5080769062042236
Epoch: 5, Steps: 20 | Train Loss: 0.619 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1222097873687744
Epoch: 6, Steps: 20 | Train Loss: 0.733 Vali Loss: 2.675 Vali Acc: 0.520 Test Loss: 2.675 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.07405424118042
Epoch: 7, Steps: 20 | Train Loss: 1.082 Vali Loss: 1.669 Vali Acc: 0.540 Test Loss: 1.669 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1102840900421143
Epoch: 8, Steps: 20 | Train Loss: 0.632 Vali Loss: 1.265 Vali Acc: 0.540 Test Loss: 1.265 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2620410919189453
Epoch: 9, Steps: 20 | Train Loss: 0.582 Vali Loss: 1.298 Vali Acc: 0.520 Test Loss: 1.298 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.199995517730713
Epoch: 10, Steps: 20 | Train Loss: 0.550 Vali Loss: 1.436 Vali Acc: 0.490 Test Loss: 1.436 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.2017838954925537
Epoch: 11, Steps: 20 | Train Loss: 0.389 Vali Loss: 1.971 Vali Acc: 0.510 Test Loss: 1.971 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.301290273666382
Epoch: 12, Steps: 20 | Train Loss: 0.516 Vali Loss: 1.866 Vali Acc: 0.400 Test Loss: 1.866 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 106818
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.0075390338897705
Epoch: 1, Steps: 20 | Train Loss: 0.783 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 1.9461088180541992
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.903 Vali Acc: 0.440 Test Loss: 0.903 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9382503032684326
Epoch: 3, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.138533115386963
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.995 Vali Acc: 0.500 Test Loss: 0.995 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9801857471466064
Epoch: 5, Steps: 20 | Train Loss: 0.611 Vali Loss: 1.032 Vali Acc: 0.450 Test Loss: 1.032 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.080476999282837
Epoch: 6, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.877 Vali Acc: 0.580 Test Loss: 0.877 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579991).  Saving model ...
Epoch: 7 cost time: 2.1601345539093018
Epoch: 7, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.987 Vali Acc: 0.510 Test Loss: 0.987 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1132967472076416
Epoch: 8, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.976 Vali Acc: 0.530 Test Loss: 0.976 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2359158992767334
Epoch: 9, Steps: 20 | Train Loss: 0.427 Vali Loss: 1.051 Vali Acc: 0.530 Test Loss: 1.051 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.12438702583313
Epoch: 10, Steps: 20 | Train Loss: 0.470 Vali Loss: 1.307 Vali Acc: 0.430 Test Loss: 1.307 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0865275859832764
Epoch: 11, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.066 Vali Acc: 0.490 Test Loss: 1.066 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0249664783477783
Epoch: 12, Steps: 20 | Train Loss: 0.338 Vali Loss: 1.222 Vali Acc: 0.490 Test Loss: 1.222 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8991475105285645
Epoch: 13, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.226 Vali Acc: 0.460 Test Loss: 1.226 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8339145183563232
Epoch: 14, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.106 Vali Acc: 0.540 Test Loss: 1.106 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9743714332580566
Epoch: 15, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.299 Vali Acc: 0.540 Test Loss: 1.299 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1454339027404785
Epoch: 16, Steps: 20 | Train Loss: 0.288 Vali Loss: 1.473 Vali Acc: 0.520 Test Loss: 1.473 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 62050
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.811767816543579
Epoch: 1, Steps: 20 | Train Loss: 0.807 Vali Loss: 0.761 Vali Acc: 0.460 Test Loss: 0.761 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 2.221876382827759
Epoch: 2, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.884 Vali Acc: 0.540 Test Loss: 0.884 Test Acc: 0.540
Validation loss decreased (-0.459992 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 2.0971179008483887
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.519822597503662
Epoch: 4, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.871 Vali Acc: 0.520 Test Loss: 0.871 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3763043880462646
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.928 Vali Acc: 0.540 Test Loss: 0.928 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2473978996276855
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 1.115 Vali Acc: 0.510 Test Loss: 1.115 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3075919151306152
Epoch: 7, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.179 Vali Acc: 0.490 Test Loss: 1.179 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1972954273223877
Epoch: 8, Steps: 20 | Train Loss: 0.478 Vali Loss: 1.112 Vali Acc: 0.530 Test Loss: 1.112 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5441837310791016
Epoch: 9, Steps: 20 | Train Loss: 0.421 Vali Loss: 1.097 Vali Acc: 0.510 Test Loss: 1.097 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1748158931732178
Epoch: 10, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.998 Vali Acc: 0.490 Test Loss: 0.998 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3392751216888428
Epoch: 11, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.009 Vali Acc: 0.530 Test Loss: 1.009 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.3170061111450195
Epoch: 12, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.020 Vali Acc: 0.520 Test Loss: 1.020 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 62082
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.5744829177856445
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.4625892639160156
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 2.613037347793579
Epoch: 3, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.619990587234497
Epoch: 4, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.913 Vali Acc: 0.510 Test Loss: 0.913 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.449209451675415
Epoch: 5, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.909 Vali Acc: 0.520 Test Loss: 0.909 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.546813726425171
Epoch: 6, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.836 Vali Acc: 0.450 Test Loss: 0.836 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5677847862243652
Epoch: 7, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.928 Vali Acc: 0.510 Test Loss: 0.928 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4083328247070312
Epoch: 8, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.950 Vali Acc: 0.520 Test Loss: 0.950 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.408560037612915
Epoch: 9, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.849 Vali Acc: 0.550 Test Loss: 0.849 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 2.4713821411132812
Epoch: 10, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.001 Vali Acc: 0.490 Test Loss: 1.001 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3575429916381836
Epoch: 11, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.024 Vali Acc: 0.510 Test Loss: 1.024 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.318986177444458
Epoch: 12, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.095 Vali Acc: 0.520 Test Loss: 1.095 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.38946270942688
Epoch: 13, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2237420082092285
Epoch: 14, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.057 Vali Acc: 0.500 Test Loss: 1.057 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.528028726577759
Epoch: 15, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.190 Vali Acc: 0.490 Test Loss: 1.190 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.514159917831421
Epoch: 16, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.201 Vali Acc: 0.520 Test Loss: 1.201 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3513286113739014
Epoch: 17, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.160 Vali Acc: 0.530 Test Loss: 1.160 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.8907129764556885
Epoch: 18, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.234 Vali Acc: 0.490 Test Loss: 1.234 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.155123472213745
Epoch: 19, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.143 Vali Acc: 0.520 Test Loss: 1.143 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 47778
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.0361902713775635
Epoch: 1, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.2975711822509766
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.779 Vali Acc: 0.490 Test Loss: 0.779 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2781641483306885
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.888 Vali Acc: 0.470 Test Loss: 0.888 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.248314619064331
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 2.2099058628082275
Epoch: 5, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.814 Vali Acc: 0.470 Test Loss: 0.814 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0590548515319824
Epoch: 6, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.829 Vali Acc: 0.530 Test Loss: 0.829 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9317786693573
Epoch: 7, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.837 Vali Acc: 0.480 Test Loss: 0.837 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.062004327774048
Epoch: 8, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.805 Vali Acc: 0.520 Test Loss: 0.805 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9462966918945312
Epoch: 9, Steps: 20 | Train Loss: 0.501 Vali Loss: 1.025 Vali Acc: 0.450 Test Loss: 1.025 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.319335460662842
Epoch: 10, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.910 Vali Acc: 0.500 Test Loss: 0.910 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.4055285453796387
Epoch: 11, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.005 Vali Acc: 0.520 Test Loss: 1.005 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.3839316368103027
Epoch: 12, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.948 Vali Acc: 0.430 Test Loss: 0.948 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1745975017547607
Epoch: 13, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.987 Vali Acc: 0.470 Test Loss: 0.987 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.1244122982025146
Epoch: 14, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.983 Vali Acc: 0.490 Test Loss: 0.983 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 38914
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.967144966125488
Epoch: 1, Steps: 20 | Train Loss: 0.782 Vali Loss: 0.759 Vali Acc: 0.460 Test Loss: 0.759 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 3.0097525119781494
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.828 Vali Acc: 0.500 Test Loss: 0.828 Test Acc: 0.500
Validation loss decreased (-0.459992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 3.292739152908325
Epoch: 3, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.814 Vali Acc: 0.480 Test Loss: 0.814 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4116933345794678
Epoch: 4, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.793 Vali Acc: 0.470 Test Loss: 0.793 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.922499418258667
Epoch: 5, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.867 Vali Acc: 0.530 Test Loss: 0.867 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529991).  Saving model ...
Epoch: 6 cost time: 2.702232599258423
Epoch: 6, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.777 Vali Acc: 0.480 Test Loss: 0.777 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3186357021331787
Epoch: 7, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.848 Vali Acc: 0.520 Test Loss: 0.848 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.165724992752075
Epoch: 8, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.173438310623169
Epoch: 9, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.915 Vali Acc: 0.500 Test Loss: 0.915 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3831303119659424
Epoch: 10, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.849 Vali Acc: 0.510 Test Loss: 0.849 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.25848126411438
Epoch: 11, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.962 Vali Acc: 0.490 Test Loss: 0.962 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2789089679718018
Epoch: 12, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.103 Vali Acc: 0.520 Test Loss: 1.103 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.2047741413116455
Epoch: 13, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.893 Vali Acc: 0.510 Test Loss: 0.893 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.268373489379883
Epoch: 14, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.917 Vali Acc: 0.510 Test Loss: 0.917 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.520559310913086
Epoch: 15, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.012 Vali Acc: 0.530 Test Loss: 1.012 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 35394
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7664480209350586
Epoch: 1, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.7424678802490234
Epoch: 2, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7364871501922607
Epoch: 3, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.773 Vali Acc: 0.560 Test Loss: 0.773 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 1.6700019836425781
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4942739009857178
Epoch: 5, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6335012912750244
Epoch: 6, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9945759773254395
Epoch: 7, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.824 Vali Acc: 0.540 Test Loss: 0.824 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9999685287475586
Epoch: 8, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.843 Vali Acc: 0.520 Test Loss: 0.843 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9248440265655518
Epoch: 9, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.829 Vali Acc: 0.510 Test Loss: 0.829 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8456451892852783
Epoch: 10, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.836 Vali Acc: 0.510 Test Loss: 0.836 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8543133735656738
Epoch: 11, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.852 Vali Acc: 0.530 Test Loss: 0.852 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6537787914276123
Epoch: 12, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.904 Vali Acc: 0.520 Test Loss: 0.904 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8049638271331787
Epoch: 13, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.870 Vali Acc: 0.470 Test Loss: 0.870 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm32_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 30114
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.060216903686523
Epoch: 1, Steps: 20 | Train Loss: 0.784 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 3.574702501296997
Epoch: 2, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.911 Vali Acc: 0.500 Test Loss: 0.911 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3798084259033203
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.825 Vali Acc: 0.530 Test Loss: 0.825 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5309860706329346
Epoch: 4, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.805 Vali Acc: 0.530 Test Loss: 0.805 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.8789305686950684
Epoch: 5, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.960 Vali Acc: 0.500 Test Loss: 0.960 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9262001514434814
Epoch: 6, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.967 Vali Acc: 0.500 Test Loss: 0.967 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.531167507171631
Epoch: 7, Steps: 20 | Train Loss: 0.530 Vali Loss: 1.070 Vali Acc: 0.520 Test Loss: 1.070 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.329573154449463
Epoch: 8, Steps: 20 | Train Loss: 0.536 Vali Loss: 1.307 Vali Acc: 0.580 Test Loss: 1.307 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579987).  Saving model ...
Epoch: 9 cost time: 3.2067604064941406
Epoch: 9, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.900 Vali Acc: 0.570 Test Loss: 0.900 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.681495428085327
Epoch: 10, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.030 Vali Acc: 0.500 Test Loss: 1.030 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6071791648864746
Epoch: 11, Steps: 20 | Train Loss: 0.416 Vali Loss: 1.709 Vali Acc: 0.520 Test Loss: 1.709 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.818655490875244
Epoch: 12, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.477 Vali Acc: 0.530 Test Loss: 1.477 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8161652088165283
Epoch: 13, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.245 Vali Acc: 0.480 Test Loss: 1.245 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1380374431610107
Epoch: 14, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.284 Vali Acc: 0.480 Test Loss: 1.284 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.530656099319458
Epoch: 15, Steps: 20 | Train Loss: 0.235 Vali Loss: 1.721 Vali Acc: 0.490 Test Loss: 1.721 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.279917001724243
Epoch: 16, Steps: 20 | Train Loss: 0.209 Vali Loss: 2.170 Vali Acc: 0.490 Test Loss: 2.170 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.627450466156006
Epoch: 17, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.996 Vali Acc: 0.490 Test Loss: 1.996 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.337038278579712
Epoch: 18, Steps: 20 | Train Loss: 0.239 Vali Loss: 2.179 Vali Acc: 0.460 Test Loss: 2.179 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 64098
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.230725526809692
Epoch: 1, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.732 Vali Acc: 0.540 Test Loss: 0.732 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.408186435699463
Epoch: 2, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.787 Vali Acc: 0.480 Test Loss: 0.787 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5752835273742676
Epoch: 3, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.796 Vali Acc: 0.490 Test Loss: 0.796 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4552676677703857
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.399322032928467
Epoch: 5, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4916481971740723
Epoch: 6, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.787 Vali Acc: 0.560 Test Loss: 0.787 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 2.4242568016052246
Epoch: 7, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.832 Vali Acc: 0.510 Test Loss: 0.832 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2460947036743164
Epoch: 8, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.911 Vali Acc: 0.500 Test Loss: 0.911 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5638344287872314
Epoch: 9, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.941 Vali Acc: 0.440 Test Loss: 0.941 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.510700225830078
Epoch: 10, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.916 Vali Acc: 0.490 Test Loss: 0.916 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2274534702301025
Epoch: 11, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.964 Vali Acc: 0.530 Test Loss: 0.964 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.64410138130188
Epoch: 12, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.091 Vali Acc: 0.440 Test Loss: 1.091 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6639184951782227
Epoch: 13, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.344 Vali Acc: 0.500 Test Loss: 1.344 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2342448234558105
Epoch: 14, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.157 Vali Acc: 0.470 Test Loss: 1.157 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.616652011871338
Epoch: 15, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.288 Vali Acc: 0.450 Test Loss: 1.288 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.627647638320923
Epoch: 16, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.219 Vali Acc: 0.460 Test Loss: 1.219 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 41714
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.264954090118408
Epoch: 1, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.2435572147369385
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.762 Vali Acc: 0.490 Test Loss: 0.762 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.174769878387451
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.853 Vali Acc: 0.460 Test Loss: 0.853 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1832377910614014
Epoch: 4, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0107533931732178
Epoch: 5, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.811 Vali Acc: 0.520 Test Loss: 0.811 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7104074954986572
Epoch: 6, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.887 Vali Acc: 0.420 Test Loss: 0.887 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9643659591674805
Epoch: 7, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.880 Vali Acc: 0.490 Test Loss: 0.880 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8243193626403809
Epoch: 8, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.904 Vali Acc: 0.450 Test Loss: 0.904 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7703049182891846
Epoch: 9, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.869 Vali Acc: 0.470 Test Loss: 0.869 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.443284749984741
Epoch: 10, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.990 Vali Acc: 0.410 Test Loss: 0.990 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.046246290206909
Epoch: 11, Steps: 20 | Train Loss: 0.420 Vali Loss: 1.071 Vali Acc: 0.430 Test Loss: 1.071 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 41730
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.485588312149048
Epoch: 1, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.718 Vali Acc: 0.470 Test Loss: 0.718 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.5178697109222412
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.6126830577850342
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.751 Vali Acc: 0.540 Test Loss: 0.751 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 1.4887042045593262
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.762 Vali Acc: 0.520 Test Loss: 0.762 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4335947036743164
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.753 Vali Acc: 0.530 Test Loss: 0.753 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4330406188964844
Epoch: 6, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.777 Vali Acc: 0.540 Test Loss: 0.777 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5035643577575684
Epoch: 7, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.813 Vali Acc: 0.530 Test Loss: 0.813 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4892122745513916
Epoch: 8, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.787 Vali Acc: 0.540 Test Loss: 0.787 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5593218803405762
Epoch: 9, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.870 Vali Acc: 0.450 Test Loss: 0.870 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4831154346466064
Epoch: 10, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3826959133148193
Epoch: 11, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.929 Vali Acc: 0.450 Test Loss: 0.929 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.391817569732666
Epoch: 12, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.901 Vali Acc: 0.480 Test Loss: 0.901 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8158953189849854
Epoch: 13, Steps: 20 | Train Loss: 0.442 Vali Loss: 1.105 Vali Acc: 0.570 Test Loss: 1.105 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569989).  Saving model ...
Epoch: 14 cost time: 1.4406983852386475
Epoch: 14, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.013 Vali Acc: 0.490 Test Loss: 1.013 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4605674743652344
Epoch: 15, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.967 Vali Acc: 0.530 Test Loss: 0.967 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5941681861877441
Epoch: 16, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.020 Vali Acc: 0.500 Test Loss: 1.020 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5102007389068604
Epoch: 17, Steps: 20 | Train Loss: 0.304 Vali Loss: 1.074 Vali Acc: 0.480 Test Loss: 1.074 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3036139011383057
Epoch: 18, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.117 Vali Acc: 0.520 Test Loss: 1.117 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5488183498382568
Epoch: 19, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.121 Vali Acc: 0.470 Test Loss: 1.121 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.467449426651001
Epoch: 20, Steps: 20 | Train Loss: 0.207 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4173376560211182
Epoch: 21, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.298 Vali Acc: 0.490 Test Loss: 1.298 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5165033340454102
Epoch: 22, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.168 Vali Acc: 0.560 Test Loss: 1.168 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4325850009918213
Epoch: 23, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.224 Vali Acc: 0.480 Test Loss: 1.224 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 34578
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.957493305206299
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.7363507747650146
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.819 Vali Acc: 0.440 Test Loss: 0.819 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8419272899627686
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.822 Vali Acc: 0.470 Test Loss: 0.822 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8176038265228271
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 1.7729098796844482
Epoch: 5, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.814 Vali Acc: 0.470 Test Loss: 0.814 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9015910625457764
Epoch: 6, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.831 Vali Acc: 0.490 Test Loss: 0.831 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6726887226104736
Epoch: 7, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.877 Vali Acc: 0.530 Test Loss: 0.877 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529991).  Saving model ...
Epoch: 8 cost time: 1.4851219654083252
Epoch: 8, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.866 Vali Acc: 0.530 Test Loss: 0.866 Test Acc: 0.530
Validation loss decreased (-0.529991 --> -0.529991).  Saving model ...
Epoch: 9 cost time: 1.3827764987945557
Epoch: 9, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.897 Vali Acc: 0.490 Test Loss: 0.897 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.579221487045288
Epoch: 10, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.937 Vali Acc: 0.470 Test Loss: 0.937 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3805222511291504
Epoch: 11, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.853 Vali Acc: 0.520 Test Loss: 0.853 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5882823467254639
Epoch: 12, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.935 Vali Acc: 0.500 Test Loss: 0.935 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7640037536621094
Epoch: 13, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.857 Vali Acc: 0.450 Test Loss: 0.857 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8347406387329102
Epoch: 14, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.870 Vali Acc: 0.470 Test Loss: 0.870 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8450684547424316
Epoch: 15, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.899 Vali Acc: 0.490 Test Loss: 0.899 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6192703247070312
Epoch: 16, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.946 Vali Acc: 0.510 Test Loss: 0.946 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7685399055480957
Epoch: 17, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.867 Vali Acc: 0.540 Test Loss: 0.867 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539991).  Saving model ...
Epoch: 18 cost time: 1.8441431522369385
Epoch: 18, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.913 Vali Acc: 0.500 Test Loss: 0.913 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.937363624572754
Epoch: 19, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.970 Vali Acc: 0.510 Test Loss: 0.970 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9921865463256836
Epoch: 20, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.960 Vali Acc: 0.520 Test Loss: 0.960 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1077373027801514
Epoch: 21, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.011 Vali Acc: 0.520 Test Loss: 1.011 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9822630882263184
Epoch: 22, Steps: 20 | Train Loss: 0.267 Vali Loss: 0.989 Vali Acc: 0.480 Test Loss: 0.989 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.885314702987671
Epoch: 23, Steps: 20 | Train Loss: 0.274 Vali Loss: 0.977 Vali Acc: 0.510 Test Loss: 0.977 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7586438655853271
Epoch: 24, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.039 Vali Acc: 0.500 Test Loss: 1.039 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7866177558898926
Epoch: 25, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.127 Vali Acc: 0.480 Test Loss: 1.127 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5635309219360352
Epoch: 26, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6558868885040283
Epoch: 27, Steps: 20 | Train Loss: 0.254 Vali Loss: 1.046 Vali Acc: 0.530 Test Loss: 1.046 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 30146
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.453425168991089
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.6497595310211182
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.724 Vali Acc: 0.570 Test Loss: 0.724 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 1.4946701526641846
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.765 Vali Acc: 0.560 Test Loss: 0.765 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.942136526107788
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.691953420639038
Epoch: 5, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.796 Vali Acc: 0.480 Test Loss: 0.796 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7767302989959717
Epoch: 6, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.829 Vali Acc: 0.460 Test Loss: 0.829 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6557762622833252
Epoch: 7, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.818 Vali Acc: 0.470 Test Loss: 0.818 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6336328983306885
Epoch: 8, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.786 Vali Acc: 0.520 Test Loss: 0.786 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.440802812576294
Epoch: 9, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.795 Vali Acc: 0.520 Test Loss: 0.795 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4463880062103271
Epoch: 10, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.859 Vali Acc: 0.530 Test Loss: 0.859 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3662829399108887
Epoch: 11, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.839 Vali Acc: 0.520 Test Loss: 0.839 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4715769290924072
Epoch: 12, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 28386
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7693068981170654
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.750 Vali Acc: 0.550 Test Loss: 0.750 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.898970603942871
Epoch: 2, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4663844108581543
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4791851043701172
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.443190097808838
Epoch: 5, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5279629230499268
Epoch: 6, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.790 Vali Acc: 0.500 Test Loss: 0.790 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7473640441894531
Epoch: 7, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.780 Vali Acc: 0.470 Test Loss: 0.780 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6090261936187744
Epoch: 8, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.827 Vali Acc: 0.530 Test Loss: 0.827 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7661185264587402
Epoch: 9, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.834 Vali Acc: 0.520 Test Loss: 0.834 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6171810626983643
Epoch: 10, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.818 Vali Acc: 0.490 Test Loss: 0.818 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7477009296417236
Epoch: 11, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.805 Vali Acc: 0.520 Test Loss: 0.805 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 25746
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.253582239151001
Epoch: 1, Steps: 20 | Train Loss: 0.834 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.5064704418182373
Epoch: 2, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.331563711166382
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.834 Vali Acc: 0.550 Test Loss: 0.834 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1611154079437256
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.782 Vali Acc: 0.550 Test Loss: 0.782 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.465116262435913
Epoch: 5, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.795 Vali Acc: 0.540 Test Loss: 0.795 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3344314098358154
Epoch: 6, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.954 Vali Acc: 0.520 Test Loss: 0.954 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.209059715270996
Epoch: 7, Steps: 20 | Train Loss: 0.524 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4496219158172607
Epoch: 8, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.789 Vali Acc: 0.580 Test Loss: 0.789 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579992).  Saving model ...
Epoch: 9 cost time: 2.2620718479156494
Epoch: 9, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.868 Vali Acc: 0.510 Test Loss: 0.868 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2509210109710693
Epoch: 10, Steps: 20 | Train Loss: 0.418 Vali Loss: 1.045 Vali Acc: 0.510 Test Loss: 1.045 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.335848808288574
Epoch: 11, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.016 Vali Acc: 0.560 Test Loss: 1.016 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3450934886932373
Epoch: 12, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.077 Vali Acc: 0.490 Test Loss: 1.077 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.001471519470215
Epoch: 13, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.939 Vali Acc: 0.480 Test Loss: 1.939 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.017920732498169
Epoch: 14, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.993 Vali Acc: 0.520 Test Loss: 1.993 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8984653949737549
Epoch: 15, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.134 Vali Acc: 0.510 Test Loss: 1.134 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8400585651397705
Epoch: 16, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.498 Vali Acc: 0.490 Test Loss: 1.498 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9233627319335938
Epoch: 17, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.444 Vali Acc: 0.550 Test Loss: 1.444 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1445915699005127
Epoch: 18, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.826 Vali Acc: 0.540 Test Loss: 1.826 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 55650
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.963646173477173
Epoch: 1, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.9461171627044678
Epoch: 2, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.6147825717926025
Epoch: 3, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.844 Vali Acc: 0.500 Test Loss: 0.844 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0495262145996094
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.833 Vali Acc: 0.530 Test Loss: 0.833 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8618316650390625
Epoch: 5, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.871 Vali Acc: 0.490 Test Loss: 0.871 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.894249439239502
Epoch: 6, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9918758869171143
Epoch: 7, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.808 Vali Acc: 0.530 Test Loss: 0.808 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1662354469299316
Epoch: 8, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.851 Vali Acc: 0.480 Test Loss: 0.851 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8920085430145264
Epoch: 9, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.875 Vali Acc: 0.530 Test Loss: 0.875 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0216333866119385
Epoch: 10, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.945 Vali Acc: 0.500 Test Loss: 0.945 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9212465286254883
Epoch: 11, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.933 Vali Acc: 0.460 Test Loss: 0.933 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6334493160247803
Epoch: 12, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.938 Vali Acc: 0.530 Test Loss: 0.938 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 33266
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.775116205215454
Epoch: 1, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.755 Vali Acc: 0.520 Test Loss: 0.755 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.921339988708496
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.889 Vali Acc: 0.470 Test Loss: 0.889 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9753830432891846
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.877 Vali Acc: 0.440 Test Loss: 0.877 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8982973098754883
Epoch: 4, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.795 Vali Acc: 0.550 Test Loss: 0.795 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 1.7924094200134277
Epoch: 5, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.786 Vali Acc: 0.530 Test Loss: 0.786 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9218127727508545
Epoch: 6, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.821 Vali Acc: 0.450 Test Loss: 0.821 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9683399200439453
Epoch: 7, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.886 Vali Acc: 0.470 Test Loss: 0.886 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8810667991638184
Epoch: 8, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.944 Vali Acc: 0.420 Test Loss: 0.944 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8299453258514404
Epoch: 9, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.899 Vali Acc: 0.490 Test Loss: 0.899 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9978349208831787
Epoch: 10, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.898 Vali Acc: 0.520 Test Loss: 0.898 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8616607189178467
Epoch: 11, Steps: 20 | Train Loss: 0.466 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.027556896209717
Epoch: 12, Steps: 20 | Train Loss: 0.548 Vali Loss: 1.058 Vali Acc: 0.490 Test Loss: 1.058 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0184013843536377
Epoch: 13, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.992 Vali Acc: 0.500 Test Loss: 0.992 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.846750020980835
Epoch: 14, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.104 Vali Acc: 0.550 Test Loss: 1.104 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 33282
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2499349117279053
Epoch: 1, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.376021385192871
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.3705418109893799
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.774 Vali Acc: 0.540 Test Loss: 0.774 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 1.52791166305542
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.795 Vali Acc: 0.550 Test Loss: 0.795 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 1.4938676357269287
Epoch: 5, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.797 Vali Acc: 0.490 Test Loss: 0.797 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4476263523101807
Epoch: 6, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.853 Vali Acc: 0.530 Test Loss: 0.853 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3774547576904297
Epoch: 7, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3342299461364746
Epoch: 8, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.785 Vali Acc: 0.530 Test Loss: 0.785 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.413999080657959
Epoch: 9, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.849 Vali Acc: 0.460 Test Loss: 0.849 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.463463306427002
Epoch: 10, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.780 Vali Acc: 0.520 Test Loss: 0.780 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4087178707122803
Epoch: 11, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.485131025314331
Epoch: 12, Steps: 20 | Train Loss: 0.456 Vali Loss: 1.124 Vali Acc: 0.510 Test Loss: 1.124 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.357722520828247
Epoch: 13, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.915 Vali Acc: 0.550 Test Loss: 0.915 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6362569332122803
Epoch: 14, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.932 Vali Acc: 0.490 Test Loss: 0.932 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 26130
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.674835681915283
Epoch: 1, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.670 Vali Acc: 0.590 Test Loss: 0.670 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.6822969913482666
Epoch: 2, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5603141784667969
Epoch: 3, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.691 Vali Acc: 0.570 Test Loss: 0.691 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6127901077270508
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.719 Vali Acc: 0.570 Test Loss: 0.719 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5483078956604004
Epoch: 5, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.698211431503296
Epoch: 6, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.798 Vali Acc: 0.510 Test Loss: 0.798 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.600637435913086
Epoch: 7, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5752243995666504
Epoch: 8, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.787 Vali Acc: 0.570 Test Loss: 0.787 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6023344993591309
Epoch: 9, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6760163307189941
Epoch: 10, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.807 Vali Acc: 0.530 Test Loss: 0.807 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8208630084991455
Epoch: 11, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.806 Vali Acc: 0.490 Test Loss: 0.806 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 21698
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4622600078582764
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.732 Vali Acc: 0.540 Test Loss: 0.732 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.296229362487793
Epoch: 2, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.766 Vali Acc: 0.550 Test Loss: 0.766 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 1.527397632598877
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8530642986297607
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6531968116760254
Epoch: 5, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.800 Vali Acc: 0.490 Test Loss: 0.800 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.828212022781372
Epoch: 6, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6125338077545166
Epoch: 7, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6939830780029297
Epoch: 8, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.875 Vali Acc: 0.460 Test Loss: 0.875 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8377573490142822
Epoch: 9, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.829 Vali Acc: 0.540 Test Loss: 0.829 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6223835945129395
Epoch: 10, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.786 Vali Acc: 0.550 Test Loss: 0.786 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8012959957122803
Epoch: 11, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.852 Vali Acc: 0.520 Test Loss: 0.852 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.577219009399414
Epoch: 12, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.874 Vali Acc: 0.470 Test Loss: 0.874 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 19938
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4126009941101074
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.7391479015350342
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.713261604309082
Epoch: 3, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6153194904327393
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.763 Vali Acc: 0.540 Test Loss: 0.763 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4122447967529297
Epoch: 5, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6626362800598145
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.784 Vali Acc: 0.550 Test Loss: 0.784 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 1.611682653427124
Epoch: 7, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.763 Vali Acc: 0.560 Test Loss: 0.763 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 1.7378768920898438
Epoch: 8, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.777 Vali Acc: 0.560 Test Loss: 0.777 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6051182746887207
Epoch: 9, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.757 Vali Acc: 0.590 Test Loss: 0.757 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589992).  Saving model ...
Epoch: 10 cost time: 1.5456457138061523
Epoch: 10, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.798 Vali Acc: 0.530 Test Loss: 0.798 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6232037544250488
Epoch: 11, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.814 Vali Acc: 0.540 Test Loss: 0.814 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6949045658111572
Epoch: 12, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.757 Vali Acc: 0.570 Test Loss: 0.757 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7396020889282227
Epoch: 13, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.792 Vali Acc: 0.560 Test Loss: 0.792 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6558969020843506
Epoch: 14, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.781 Vali Acc: 0.580 Test Loss: 0.781 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3475723266601562
Epoch: 15, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.809 Vali Acc: 0.570 Test Loss: 0.809 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4573595523834229
Epoch: 16, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.765 Vali Acc: 0.570 Test Loss: 0.765 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.709266185760498
Epoch: 17, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.804 Vali Acc: 0.540 Test Loss: 0.804 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.432119607925415
Epoch: 18, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.518204689025879
Epoch: 19, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.822 Vali Acc: 0.570 Test Loss: 0.822 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 17298
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.686249017715454
Epoch: 1, Steps: 20 | Train Loss: 0.814 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.277658700942993
Epoch: 2, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.845 Vali Acc: 0.490 Test Loss: 0.845 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7167069911956787
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.508923053741455
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9970970153808594
Epoch: 5, Steps: 20 | Train Loss: 0.727 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.279587507247925
Epoch: 6, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.901 Vali Acc: 0.540 Test Loss: 0.901 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539991).  Saving model ...
Epoch: 7 cost time: 2.716770887374878
Epoch: 7, Steps: 20 | Train Loss: 0.500 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4067392349243164
Epoch: 8, Steps: 20 | Train Loss: 0.484 Vali Loss: 1.024 Vali Acc: 0.490 Test Loss: 1.024 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4297306537628174
Epoch: 9, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.154 Vali Acc: 0.470 Test Loss: 1.154 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0788073539733887
Epoch: 10, Steps: 20 | Train Loss: 0.404 Vali Loss: 1.141 Vali Acc: 0.440 Test Loss: 1.141 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.605830192565918
Epoch: 11, Steps: 20 | Train Loss: 0.479 Vali Loss: 1.097 Vali Acc: 0.460 Test Loss: 1.097 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.209959030151367
Epoch: 12, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.167 Vali Acc: 0.530 Test Loss: 1.167 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.5546979904174805
Epoch: 13, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.154 Vali Acc: 0.460 Test Loss: 1.154 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.0986874103546143
Epoch: 14, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.075 Vali Acc: 0.510 Test Loss: 1.075 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.0216145515441895
Epoch: 15, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.660 Vali Acc: 0.490 Test Loss: 1.660 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.599799633026123
Epoch: 16, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.430 Vali Acc: 0.450 Test Loss: 1.430 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 51426
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.856014966964722
Epoch: 1, Steps: 20 | Train Loss: 0.793 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.7396020889282227
Epoch: 2, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.849 Vali Acc: 0.530 Test Loss: 0.849 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 2.4067840576171875
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.760 Vali Acc: 0.460 Test Loss: 0.760 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.141221046447754
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.821 Vali Acc: 0.530 Test Loss: 0.821 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 2.449338912963867
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.845 Vali Acc: 0.450 Test Loss: 0.845 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4651966094970703
Epoch: 6, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 7 cost time: 2.857496976852417
Epoch: 7, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.800 Vali Acc: 0.490 Test Loss: 0.800 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9049973487854004
Epoch: 8, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.873 Vali Acc: 0.460 Test Loss: 0.873 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8271572589874268
Epoch: 9, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.025 Vali Acc: 0.490 Test Loss: 1.025 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.470031976699829
Epoch: 10, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.933 Vali Acc: 0.510 Test Loss: 0.933 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.867255449295044
Epoch: 11, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.984 Vali Acc: 0.440 Test Loss: 0.984 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.955559730529785
Epoch: 12, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.979 Vali Acc: 0.470 Test Loss: 0.979 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9031033515930176
Epoch: 13, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.107 Vali Acc: 0.490 Test Loss: 1.107 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.960635185241699
Epoch: 14, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.332 Vali Acc: 0.510 Test Loss: 1.332 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.6118991374969482
Epoch: 15, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.050 Vali Acc: 0.450 Test Loss: 1.050 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.95558500289917
Epoch: 16, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.181 Vali Acc: 0.450 Test Loss: 1.181 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 29042
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.7929558753967285
Epoch: 1, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.754 Vali Acc: 0.530 Test Loss: 0.754 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 3.364809513092041
Epoch: 2, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.148447275161743
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.790 Vali Acc: 0.480 Test Loss: 0.790 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.819488763809204
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 2.408316135406494
Epoch: 5, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.884 Vali Acc: 0.530 Test Loss: 0.884 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.738067865371704
Epoch: 6, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.819 Vali Acc: 0.480 Test Loss: 0.819 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.355452299118042
Epoch: 7, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.894 Vali Acc: 0.480 Test Loss: 0.894 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8731472492218018
Epoch: 8, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.925 Vali Acc: 0.530 Test Loss: 0.925 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.186513900756836
Epoch: 9, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.848 Vali Acc: 0.540 Test Loss: 0.848 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9604120254516602
Epoch: 10, Steps: 20 | Train Loss: 0.518 Vali Loss: 1.013 Vali Acc: 0.520 Test Loss: 1.013 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.035982131958008
Epoch: 11, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.025 Vali Acc: 0.480 Test Loss: 1.025 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8059113025665283
Epoch: 12, Steps: 20 | Train Loss: 0.499 Vali Loss: 1.069 Vali Acc: 0.430 Test Loss: 1.069 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.5928409099578857
Epoch: 13, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.979 Vali Acc: 0.500 Test Loss: 0.979 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.570896863937378
Epoch: 14, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 29058
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.17526912689209
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.751 Vali Acc: 0.460 Test Loss: 0.751 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.6551833152770996
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.769 Vali Acc: 0.470 Test Loss: 0.769 Test Acc: 0.470
Validation loss decreased (-0.459992 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 1.5345163345336914
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
Validation loss decreased (-0.469992 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 1.7335658073425293
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.862 Vali Acc: 0.530 Test Loss: 0.862 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529991).  Saving model ...
Epoch: 5 cost time: 1.484105110168457
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8094899654388428
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.808 Vali Acc: 0.480 Test Loss: 0.808 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.46663236618042
Epoch: 7, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.823 Vali Acc: 0.490 Test Loss: 0.823 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6504626274108887
Epoch: 8, Steps: 20 | Train Loss: 0.618 Vali Loss: 1.015 Vali Acc: 0.520 Test Loss: 1.015 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.442922830581665
Epoch: 9, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.868 Vali Acc: 0.520 Test Loss: 0.868 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8445639610290527
Epoch: 10, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
Validation loss decreased (-0.529991 --> -0.529992).  Saving model ...
Epoch: 11 cost time: 1.6311850547790527
Epoch: 11, Steps: 20 | Train Loss: 0.502 Vali Loss: 1.004 Vali Acc: 0.540 Test Loss: 1.004 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539990).  Saving model ...
Epoch: 12 cost time: 1.7782440185546875
Epoch: 12, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.976 Vali Acc: 0.500 Test Loss: 0.976 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6152989864349365
Epoch: 13, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.858 Vali Acc: 0.550 Test Loss: 0.858 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549991).  Saving model ...
Epoch: 14 cost time: 1.6413564682006836
Epoch: 14, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.904 Vali Acc: 0.520 Test Loss: 0.904 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.452143669128418
Epoch: 15, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.910 Vali Acc: 0.480 Test Loss: 0.910 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4014410972595215
Epoch: 16, Steps: 20 | Train Loss: 0.364 Vali Loss: 0.895 Vali Acc: 0.510 Test Loss: 0.895 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4406862258911133
Epoch: 17, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.908 Vali Acc: 0.480 Test Loss: 0.908 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4275648593902588
Epoch: 18, Steps: 20 | Train Loss: 0.388 Vali Loss: 0.976 Vali Acc: 0.510 Test Loss: 0.976 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4252212047576904
Epoch: 19, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.038 Vali Acc: 0.530 Test Loss: 1.038 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4910430908203125
Epoch: 20, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.139 Vali Acc: 0.530 Test Loss: 1.139 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.615236759185791
Epoch: 21, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.110 Vali Acc: 0.520 Test Loss: 1.110 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5457408428192139
Epoch: 22, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.038 Vali Acc: 0.540 Test Loss: 1.038 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6323201656341553
Epoch: 23, Steps: 20 | Train Loss: 0.247 Vali Loss: 1.118 Vali Acc: 0.530 Test Loss: 1.118 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 21906
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2165720462799072
Epoch: 1, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.5306434631347656
Epoch: 2, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.737 Vali Acc: 0.410 Test Loss: 0.737 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4861345291137695
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.770 Vali Acc: 0.470 Test Loss: 0.770 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6245453357696533
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.772 Vali Acc: 0.470 Test Loss: 0.772 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3956589698791504
Epoch: 5, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.769 Vali Acc: 0.530 Test Loss: 0.769 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 1.4248147010803223
Epoch: 6, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5985352993011475
Epoch: 7, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.798 Vali Acc: 0.470 Test Loss: 0.798 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4291863441467285
Epoch: 8, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.843 Vali Acc: 0.420 Test Loss: 0.843 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.72151517868042
Epoch: 9, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.826 Vali Acc: 0.450 Test Loss: 0.826 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5280945301055908
Epoch: 10, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.923 Vali Acc: 0.510 Test Loss: 0.923 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5295383930206299
Epoch: 11, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.843 Vali Acc: 0.470 Test Loss: 0.843 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.573469638824463
Epoch: 12, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.872 Vali Acc: 0.490 Test Loss: 0.872 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.447235345840454
Epoch: 13, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.847 Vali Acc: 0.460 Test Loss: 0.847 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.669332504272461
Epoch: 14, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.860 Vali Acc: 0.520 Test Loss: 0.860 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5264718532562256
Epoch: 15, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.940 Vali Acc: 0.450 Test Loss: 0.940 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 17474
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1888585090637207
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.747 Vali Acc: 0.450 Test Loss: 0.747 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.4073407649993896
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
Validation loss decreased (-0.449993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 1.4033176898956299
Epoch: 3, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.776 Vali Acc: 0.470 Test Loss: 0.776 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3910017013549805
Epoch: 4, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 1.3910987377166748
Epoch: 5, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.835 Vali Acc: 0.460 Test Loss: 0.835 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3865981101989746
Epoch: 6, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.820 Vali Acc: 0.490 Test Loss: 0.820 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4212162494659424
Epoch: 7, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.821 Vali Acc: 0.520 Test Loss: 0.821 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4658868312835693
Epoch: 8, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.800 Vali Acc: 0.550 Test Loss: 0.800 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 1.412381649017334
Epoch: 9, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5526432991027832
Epoch: 10, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.893 Vali Acc: 0.500 Test Loss: 0.893 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3664331436157227
Epoch: 11, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.863 Vali Acc: 0.510 Test Loss: 0.863 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.480109691619873
Epoch: 12, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.865 Vali Acc: 0.460 Test Loss: 0.865 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6664843559265137
Epoch: 13, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.892 Vali Acc: 0.470 Test Loss: 0.892 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4819176197052002
Epoch: 14, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.868 Vali Acc: 0.490 Test Loss: 0.868 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4775338172912598
Epoch: 15, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.899 Vali Acc: 0.460 Test Loss: 0.899 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6763718128204346
Epoch: 16, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.869 Vali Acc: 0.480 Test Loss: 0.869 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4404122829437256
Epoch: 17, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.890 Vali Acc: 0.460 Test Loss: 0.890 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4436097145080566
Epoch: 18, Steps: 20 | Train Loss: 0.401 Vali Loss: 1.044 Vali Acc: 0.460 Test Loss: 1.044 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 15714
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2051727771759033
Epoch: 1, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.700 Vali Acc: 0.530 Test Loss: 0.700 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.2242872714996338
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.720 Vali Acc: 0.550 Test Loss: 0.720 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.4248466491699219
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.749 Vali Acc: 0.530 Test Loss: 0.749 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3847315311431885
Epoch: 4, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.762 Vali Acc: 0.570 Test Loss: 0.762 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 1.3749854564666748
Epoch: 5, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.333845853805542
Epoch: 6, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.283907413482666
Epoch: 7, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.799 Vali Acc: 0.560 Test Loss: 0.799 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6371066570281982
Epoch: 8, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3724651336669922
Epoch: 9, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5317115783691406
Epoch: 10, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.829 Vali Acc: 0.530 Test Loss: 0.829 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5029711723327637
Epoch: 11, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.777 Vali Acc: 0.540 Test Loss: 0.777 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5798444747924805
Epoch: 12, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.802 Vali Acc: 0.580 Test Loss: 0.802 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 13 cost time: 1.536790370941162
Epoch: 13, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.809 Vali Acc: 0.500 Test Loss: 0.809 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.716839075088501
Epoch: 14, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.815 Vali Acc: 0.530 Test Loss: 0.815 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.485849142074585
Epoch: 15, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.787 Vali Acc: 0.560 Test Loss: 0.787 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5418057441711426
Epoch: 16, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.884 Vali Acc: 0.500 Test Loss: 0.884 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4909584522247314
Epoch: 17, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.810 Vali Acc: 0.540 Test Loss: 0.810 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.497969388961792
Epoch: 18, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.799 Vali Acc: 0.550 Test Loss: 0.799 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5012803077697754
Epoch: 19, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.858 Vali Acc: 0.600 Test Loss: 0.858 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599991).  Saving model ...
Epoch: 20 cost time: 1.6539008617401123
Epoch: 20, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.883 Vali Acc: 0.540 Test Loss: 0.883 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.513136386871338
Epoch: 21, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.874 Vali Acc: 0.550 Test Loss: 0.874 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5247819423675537
Epoch: 22, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3932721614837646
Epoch: 23, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.868 Vali Acc: 0.500 Test Loss: 0.868 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4640564918518066
Epoch: 24, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.819 Vali Acc: 0.550 Test Loss: 0.819 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5013952255249023
Epoch: 25, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.868 Vali Acc: 0.510 Test Loss: 0.868 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4756126403808594
Epoch: 26, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.836 Vali Acc: 0.550 Test Loss: 0.836 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.34130859375
Epoch: 27, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.973 Vali Acc: 0.520 Test Loss: 0.973 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6912479400634766
Epoch: 28, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.923 Vali Acc: 0.510 Test Loss: 0.923 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4957330226898193
Epoch: 29, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.927 Vali Acc: 0.560 Test Loss: 0.927 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el2_dm16_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 13074
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.450648546218872
Epoch: 1, Steps: 20 | Train Loss: 1.076 Vali Loss: 1.638 Vali Acc: 0.490 Test Loss: 1.638 Test Acc: 0.490
Validation loss decreased (inf --> -0.489984).  Saving model ...
Epoch: 2 cost time: 3.791677951812744
Epoch: 2, Steps: 20 | Train Loss: 1.546 Vali Loss: 2.816 Vali Acc: 0.520 Test Loss: 2.816 Test Acc: 0.520
Validation loss decreased (-0.489984 --> -0.519972).  Saving model ...
Epoch: 3 cost time: 3.6827447414398193
Epoch: 3, Steps: 20 | Train Loss: 1.281 Vali Loss: 2.073 Vali Acc: 0.470 Test Loss: 2.073 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.875507116317749
Epoch: 4, Steps: 20 | Train Loss: 1.347 Vali Loss: 2.475 Vali Acc: 0.560 Test Loss: 2.475 Test Acc: 0.560
Validation loss decreased (-0.519972 --> -0.559975).  Saving model ...
Epoch: 5 cost time: 3.871600389480591
Epoch: 5, Steps: 20 | Train Loss: 1.453 Vali Loss: 2.430 Vali Acc: 0.550 Test Loss: 2.430 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6435530185699463
Epoch: 6, Steps: 20 | Train Loss: 1.061 Vali Loss: 2.478 Vali Acc: 0.520 Test Loss: 2.478 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.867971181869507
Epoch: 7, Steps: 20 | Train Loss: 0.906 Vali Loss: 3.207 Vali Acc: 0.580 Test Loss: 3.207 Test Acc: 0.580
Validation loss decreased (-0.559975 --> -0.579968).  Saving model ...
Epoch: 8 cost time: 3.8724658489227295
Epoch: 8, Steps: 20 | Train Loss: 1.492 Vali Loss: 4.860 Vali Acc: 0.510 Test Loss: 4.860 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6132795810699463
Epoch: 9, Steps: 20 | Train Loss: 1.378 Vali Loss: 4.820 Vali Acc: 0.550 Test Loss: 4.820 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6348321437835693
Epoch: 10, Steps: 20 | Train Loss: 2.023 Vali Loss: 6.268 Vali Acc: 0.530 Test Loss: 6.268 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.706009864807129
Epoch: 11, Steps: 20 | Train Loss: 1.535 Vali Loss: 4.863 Vali Acc: 0.550 Test Loss: 4.863 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.6247966289520264
Epoch: 12, Steps: 20 | Train Loss: 0.820 Vali Loss: 5.867 Vali Acc: 0.520 Test Loss: 5.867 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.6961894035339355
Epoch: 13, Steps: 20 | Train Loss: 1.632 Vali Loss: 5.666 Vali Acc: 0.510 Test Loss: 5.666 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.6561193466186523
Epoch: 14, Steps: 20 | Train Loss: 0.998 Vali Loss: 5.312 Vali Acc: 0.580 Test Loss: 5.312 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7258105278015137
Epoch: 15, Steps: 20 | Train Loss: 0.911 Vali Loss: 6.434 Vali Acc: 0.520 Test Loss: 6.434 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1301167011260986
Epoch: 16, Steps: 20 | Train Loss: 0.751 Vali Loss: 7.915 Vali Acc: 0.490 Test Loss: 7.915 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.4705183506011963
Epoch: 17, Steps: 20 | Train Loss: 1.007 Vali Loss: 10.010 Vali Acc: 0.520 Test Loss: 10.010 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 491394
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.818743467330933
Epoch: 1, Steps: 20 | Train Loss: 0.898 Vali Loss: 1.347 Vali Acc: 0.530 Test Loss: 1.347 Test Acc: 0.530
Validation loss decreased (inf --> -0.529987).  Saving model ...
Epoch: 2 cost time: 2.6767685413360596
Epoch: 2, Steps: 20 | Train Loss: 0.896 Vali Loss: 1.180 Vali Acc: 0.430 Test Loss: 1.180 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5589916706085205
Epoch: 3, Steps: 20 | Train Loss: 0.948 Vali Loss: 1.240 Vali Acc: 0.590 Test Loss: 1.240 Test Acc: 0.590
Validation loss decreased (-0.529987 --> -0.589988).  Saving model ...
Epoch: 4 cost time: 2.8878824710845947
Epoch: 4, Steps: 20 | Train Loss: 0.736 Vali Loss: 1.130 Vali Acc: 0.550 Test Loss: 1.130 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9856560230255127
Epoch: 5, Steps: 20 | Train Loss: 0.934 Vali Loss: 2.188 Vali Acc: 0.560 Test Loss: 2.188 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9404163360595703
Epoch: 6, Steps: 20 | Train Loss: 1.253 Vali Loss: 2.915 Vali Acc: 0.530 Test Loss: 2.915 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8433518409729004
Epoch: 7, Steps: 20 | Train Loss: 1.358 Vali Loss: 2.472 Vali Acc: 0.470 Test Loss: 2.472 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.9368574619293213
Epoch: 8, Steps: 20 | Train Loss: 0.769 Vali Loss: 1.776 Vali Acc: 0.480 Test Loss: 1.776 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.76914644241333
Epoch: 9, Steps: 20 | Train Loss: 0.632 Vali Loss: 2.017 Vali Acc: 0.520 Test Loss: 2.017 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0370006561279297
Epoch: 10, Steps: 20 | Train Loss: 0.655 Vali Loss: 2.855 Vali Acc: 0.590 Test Loss: 2.855 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9731509685516357
Epoch: 11, Steps: 20 | Train Loss: 0.639 Vali Loss: 2.264 Vali Acc: 0.490 Test Loss: 2.264 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9782779216766357
Epoch: 12, Steps: 20 | Train Loss: 0.557 Vali Loss: 3.724 Vali Acc: 0.540 Test Loss: 3.724 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.9531352519989014
Epoch: 13, Steps: 20 | Train Loss: 0.463 Vali Loss: 3.464 Vali Acc: 0.490 Test Loss: 3.464 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 312322
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.681801795959473
Epoch: 1, Steps: 20 | Train Loss: 0.825 Vali Loss: 0.912 Vali Acc: 0.520 Test Loss: 0.912 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 2.580594062805176
Epoch: 2, Steps: 20 | Train Loss: 0.964 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7793915271759033
Epoch: 3, Steps: 20 | Train Loss: 0.808 Vali Loss: 1.567 Vali Acc: 0.570 Test Loss: 1.567 Test Acc: 0.570
Validation loss decreased (-0.519991 --> -0.569984).  Saving model ...
Epoch: 4 cost time: 3.120833158493042
Epoch: 4, Steps: 20 | Train Loss: 0.837 Vali Loss: 1.934 Vali Acc: 0.470 Test Loss: 1.934 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0253536701202393
Epoch: 5, Steps: 20 | Train Loss: 1.036 Vali Loss: 1.697 Vali Acc: 0.580 Test Loss: 1.697 Test Acc: 0.580
Validation loss decreased (-0.569984 --> -0.579983).  Saving model ...
Epoch: 6 cost time: 2.7935616970062256
Epoch: 6, Steps: 20 | Train Loss: 0.971 Vali Loss: 1.959 Vali Acc: 0.540 Test Loss: 1.959 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7744269371032715
Epoch: 7, Steps: 20 | Train Loss: 0.622 Vali Loss: 1.398 Vali Acc: 0.550 Test Loss: 1.398 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.995830774307251
Epoch: 8, Steps: 20 | Train Loss: 0.609 Vali Loss: 2.140 Vali Acc: 0.480 Test Loss: 2.140 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9675445556640625
Epoch: 9, Steps: 20 | Train Loss: 0.599 Vali Loss: 2.114 Vali Acc: 0.510 Test Loss: 2.114 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0342445373535156
Epoch: 10, Steps: 20 | Train Loss: 0.709 Vali Loss: 2.313 Vali Acc: 0.490 Test Loss: 2.313 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2314610481262207
Epoch: 11, Steps: 20 | Train Loss: 0.634 Vali Loss: 2.612 Vali Acc: 0.490 Test Loss: 2.612 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.211860179901123
Epoch: 12, Steps: 20 | Train Loss: 0.681 Vali Loss: 2.519 Vali Acc: 0.530 Test Loss: 2.519 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.9837448596954346
Epoch: 13, Steps: 20 | Train Loss: 1.059 Vali Loss: 4.767 Vali Acc: 0.540 Test Loss: 4.767 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9177911281585693
Epoch: 14, Steps: 20 | Train Loss: 0.774 Vali Loss: 2.628 Vali Acc: 0.550 Test Loss: 2.628 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.674285411834717
Epoch: 15, Steps: 20 | Train Loss: 0.467 Vali Loss: 3.242 Vali Acc: 0.460 Test Loss: 3.242 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 312450
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8913168907165527
Epoch: 1, Steps: 20 | Train Loss: 0.744 Vali Loss: 1.048 Vali Acc: 0.510 Test Loss: 1.048 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 2.247960329055786
Epoch: 2, Steps: 20 | Train Loss: 0.830 Vali Loss: 0.927 Vali Acc: 0.510 Test Loss: 0.927 Test Acc: 0.510
Validation loss decreased (-0.509990 --> -0.509991).  Saving model ...
Epoch: 3 cost time: 2.269021987915039
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 1.138 Vali Acc: 0.540 Test Loss: 1.138 Test Acc: 0.540
Validation loss decreased (-0.509991 --> -0.539989).  Saving model ...
Epoch: 4 cost time: 2.347827434539795
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 1.296 Vali Acc: 0.480 Test Loss: 1.296 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1147868633270264
Epoch: 5, Steps: 20 | Train Loss: 0.758 Vali Loss: 1.572 Vali Acc: 0.490 Test Loss: 1.572 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.101180076599121
Epoch: 6, Steps: 20 | Train Loss: 0.702 Vali Loss: 1.277 Vali Acc: 0.520 Test Loss: 1.277 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4010307788848877
Epoch: 7, Steps: 20 | Train Loss: 0.652 Vali Loss: 1.365 Vali Acc: 0.510 Test Loss: 1.365 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9725127220153809
Epoch: 8, Steps: 20 | Train Loss: 0.582 Vali Loss: 2.684 Vali Acc: 0.470 Test Loss: 2.684 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.805511713027954
Epoch: 9, Steps: 20 | Train Loss: 0.694 Vali Loss: 1.869 Vali Acc: 0.440 Test Loss: 1.869 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7954216003417969
Epoch: 10, Steps: 20 | Train Loss: 0.565 Vali Loss: 1.747 Vali Acc: 0.520 Test Loss: 1.747 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7239775657653809
Epoch: 11, Steps: 20 | Train Loss: 0.701 Vali Loss: 4.471 Vali Acc: 0.550 Test Loss: 4.471 Test Acc: 0.550
Validation loss decreased (-0.539989 --> -0.549955).  Saving model ...
Epoch: 12 cost time: 2.1366796493530273
Epoch: 12, Steps: 20 | Train Loss: 1.129 Vali Loss: 3.420 Vali Acc: 0.530 Test Loss: 3.420 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.409926652908325
Epoch: 13, Steps: 20 | Train Loss: 0.833 Vali Loss: 4.505 Vali Acc: 0.530 Test Loss: 4.505 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1557767391204834
Epoch: 14, Steps: 20 | Train Loss: 0.621 Vali Loss: 2.718 Vali Acc: 0.510 Test Loss: 2.718 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.884563684463501
Epoch: 15, Steps: 20 | Train Loss: 0.231 Vali Loss: 2.673 Vali Acc: 0.510 Test Loss: 2.673 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4492976665496826
Epoch: 16, Steps: 20 | Train Loss: 0.353 Vali Loss: 3.065 Vali Acc: 0.490 Test Loss: 3.065 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1788065433502197
Epoch: 17, Steps: 20 | Train Loss: 0.249 Vali Loss: 2.659 Vali Acc: 0.530 Test Loss: 2.659 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4165663719177246
Epoch: 18, Steps: 20 | Train Loss: 0.557 Vali Loss: 3.602 Vali Acc: 0.480 Test Loss: 3.602 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.370737314224243
Epoch: 19, Steps: 20 | Train Loss: 0.689 Vali Loss: 3.565 Vali Acc: 0.390 Test Loss: 3.565 Test Acc: 0.390
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.332794427871704
Epoch: 20, Steps: 20 | Train Loss: 0.192 Vali Loss: 3.753 Vali Acc: 0.500 Test Loss: 3.753 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.38301682472229
Epoch: 21, Steps: 20 | Train Loss: 0.466 Vali Loss: 3.752 Vali Acc: 0.470 Test Loss: 3.752 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 255234
model size : 3.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.876779079437256
Epoch: 1, Steps: 20 | Train Loss: 0.800 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 1.8268446922302246
Epoch: 2, Steps: 20 | Train Loss: 0.808 Vali Loss: 0.959 Vali Acc: 0.420 Test Loss: 0.959 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9392178058624268
Epoch: 3, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.929 Vali Acc: 0.570 Test Loss: 0.929 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 4 cost time: 2.0246195793151855
Epoch: 4, Steps: 20 | Train Loss: 0.734 Vali Loss: 1.065 Vali Acc: 0.500 Test Loss: 1.065 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7915401458740234
Epoch: 5, Steps: 20 | Train Loss: 0.648 Vali Loss: 1.248 Vali Acc: 0.450 Test Loss: 1.248 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8913953304290771
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 1.493 Vali Acc: 0.490 Test Loss: 1.493 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9516396522521973
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 1.862 Vali Acc: 0.490 Test Loss: 1.862 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.77097749710083
Epoch: 8, Steps: 20 | Train Loss: 0.595 Vali Loss: 1.110 Vali Acc: 0.540 Test Loss: 1.110 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0216264724731445
Epoch: 9, Steps: 20 | Train Loss: 0.527 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9052307605743408
Epoch: 10, Steps: 20 | Train Loss: 0.514 Vali Loss: 1.551 Vali Acc: 0.450 Test Loss: 1.551 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.084822177886963
Epoch: 11, Steps: 20 | Train Loss: 0.454 Vali Loss: 2.005 Vali Acc: 0.590 Test Loss: 2.005 Test Acc: 0.590
Validation loss decreased (-0.569991 --> -0.589980).  Saving model ...
Epoch: 12 cost time: 2.1423046588897705
Epoch: 12, Steps: 20 | Train Loss: 0.670 Vali Loss: 1.751 Vali Acc: 0.510 Test Loss: 1.751 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.003962278366089
Epoch: 13, Steps: 20 | Train Loss: 0.547 Vali Loss: 2.025 Vali Acc: 0.540 Test Loss: 2.025 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9720726013183594
Epoch: 14, Steps: 20 | Train Loss: 0.456 Vali Loss: 2.283 Vali Acc: 0.470 Test Loss: 2.283 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.146038770675659
Epoch: 15, Steps: 20 | Train Loss: 0.322 Vali Loss: 2.044 Vali Acc: 0.550 Test Loss: 2.044 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9296541213989258
Epoch: 16, Steps: 20 | Train Loss: 0.722 Vali Loss: 4.392 Vali Acc: 0.530 Test Loss: 4.392 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7930164337158203
Epoch: 17, Steps: 20 | Train Loss: 0.926 Vali Loss: 3.070 Vali Acc: 0.480 Test Loss: 3.070 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.17464280128479
Epoch: 18, Steps: 20 | Train Loss: 0.589 Vali Loss: 2.276 Vali Acc: 0.520 Test Loss: 2.276 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9329545497894287
Epoch: 19, Steps: 20 | Train Loss: 0.282 Vali Loss: 2.633 Vali Acc: 0.470 Test Loss: 2.633 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5435223579406738
Epoch: 20, Steps: 20 | Train Loss: 0.298 Vali Loss: 2.055 Vali Acc: 0.550 Test Loss: 2.055 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.3311607837677
Epoch: 21, Steps: 20 | Train Loss: 0.323 Vali Loss: 2.655 Vali Acc: 0.470 Test Loss: 2.655 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 219778
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.168741226196289
Epoch: 1, Steps: 20 | Train Loss: 0.786 Vali Loss: 0.887 Vali Acc: 0.510 Test Loss: 0.887 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 1.8583369255065918
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.909 Vali Acc: 0.500 Test Loss: 0.909 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5945897102355957
Epoch: 3, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.896 Vali Acc: 0.520 Test Loss: 0.896 Test Acc: 0.520
Validation loss decreased (-0.509991 --> -0.519991).  Saving model ...
Epoch: 4 cost time: 1.553900957107544
Epoch: 4, Steps: 20 | Train Loss: 0.694 Vali Loss: 1.042 Vali Acc: 0.530 Test Loss: 1.042 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529990).  Saving model ...
Epoch: 5 cost time: 1.5371155738830566
Epoch: 5, Steps: 20 | Train Loss: 0.657 Vali Loss: 1.283 Vali Acc: 0.530 Test Loss: 1.283 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5255138874053955
Epoch: 6, Steps: 20 | Train Loss: 0.595 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5725672245025635
Epoch: 7, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.226 Vali Acc: 0.560 Test Loss: 1.226 Test Acc: 0.560
Validation loss decreased (-0.529990 --> -0.559988).  Saving model ...
Epoch: 8 cost time: 1.7069272994995117
Epoch: 8, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.287 Vali Acc: 0.470 Test Loss: 1.287 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8304743766784668
Epoch: 9, Steps: 20 | Train Loss: 0.571 Vali Loss: 1.938 Vali Acc: 0.490 Test Loss: 1.938 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9963877201080322
Epoch: 10, Steps: 20 | Train Loss: 0.671 Vali Loss: 1.505 Vali Acc: 0.630 Test Loss: 1.505 Test Acc: 0.630
Validation loss decreased (-0.559988 --> -0.629985).  Saving model ...
Epoch: 11 cost time: 1.6803865432739258
Epoch: 11, Steps: 20 | Train Loss: 0.617 Vali Loss: 1.442 Vali Acc: 0.530 Test Loss: 1.442 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.882120132446289
Epoch: 12, Steps: 20 | Train Loss: 0.550 Vali Loss: 1.488 Vali Acc: 0.530 Test Loss: 1.488 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.811455488204956
Epoch: 13, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.751 Vali Acc: 0.530 Test Loss: 1.751 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7980890274047852
Epoch: 14, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.766 Vali Acc: 0.460 Test Loss: 1.766 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6570556163787842
Epoch: 15, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.588 Vali Acc: 0.510 Test Loss: 1.588 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6276049613952637
Epoch: 16, Steps: 20 | Train Loss: 0.448 Vali Loss: 2.589 Vali Acc: 0.490 Test Loss: 2.589 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.934828758239746
Epoch: 17, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.757 Vali Acc: 0.550 Test Loss: 1.757 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.96513032913208
Epoch: 18, Steps: 20 | Train Loss: 0.273 Vali Loss: 1.817 Vali Acc: 0.550 Test Loss: 1.817 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8901176452636719
Epoch: 19, Steps: 20 | Train Loss: 0.248 Vali Loss: 2.573 Vali Acc: 0.520 Test Loss: 2.573 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.618095874786377
Epoch: 20, Steps: 20 | Train Loss: 0.397 Vali Loss: 2.555 Vali Acc: 0.560 Test Loss: 2.555 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 205698
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7640645503997803
Epoch: 1, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.7562975883483887
Epoch: 2, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.878 Vali Acc: 0.510 Test Loss: 0.878 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9557995796203613
Epoch: 3, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.831 Vali Acc: 0.530 Test Loss: 0.831 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.8180692195892334
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.888 Vali Acc: 0.500 Test Loss: 0.888 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8719427585601807
Epoch: 5, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.993 Vali Acc: 0.480 Test Loss: 0.993 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8108201026916504
Epoch: 6, Steps: 20 | Train Loss: 0.627 Vali Loss: 1.146 Vali Acc: 0.530 Test Loss: 1.146 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6783831119537354
Epoch: 7, Steps: 20 | Train Loss: 0.611 Vali Loss: 1.095 Vali Acc: 0.460 Test Loss: 1.095 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8362627029418945
Epoch: 8, Steps: 20 | Train Loss: 0.523 Vali Loss: 1.225 Vali Acc: 0.440 Test Loss: 1.225 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8488929271697998
Epoch: 9, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.232 Vali Acc: 0.510 Test Loss: 1.232 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.925023078918457
Epoch: 10, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.098 Vali Acc: 0.540 Test Loss: 1.098 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539989).  Saving model ...
Epoch: 11 cost time: 1.6101021766662598
Epoch: 11, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.155 Vali Acc: 0.570 Test Loss: 1.155 Test Acc: 0.570
Validation loss decreased (-0.539989 --> -0.569988).  Saving model ...
Epoch: 12 cost time: 1.7413914203643799
Epoch: 12, Steps: 20 | Train Loss: 0.345 Vali Loss: 1.214 Vali Acc: 0.550 Test Loss: 1.214 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.521397352218628
Epoch: 13, Steps: 20 | Train Loss: 0.421 Vali Loss: 1.370 Vali Acc: 0.540 Test Loss: 1.370 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3412625789642334
Epoch: 14, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.426 Vali Acc: 0.430 Test Loss: 1.426 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4564132690429688
Epoch: 15, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.773 Vali Acc: 0.460 Test Loss: 1.773 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4149069786071777
Epoch: 16, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.605 Vali Acc: 0.500 Test Loss: 1.605 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4079840183258057
Epoch: 17, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.563 Vali Acc: 0.480 Test Loss: 1.563 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4496188163757324
Epoch: 18, Steps: 20 | Train Loss: 0.220 Vali Loss: 2.252 Vali Acc: 0.510 Test Loss: 2.252 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5308053493499756
Epoch: 19, Steps: 20 | Train Loss: 0.450 Vali Loss: 1.846 Vali Acc: 0.520 Test Loss: 1.846 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.633366346359253
Epoch: 20, Steps: 20 | Train Loss: 0.253 Vali Loss: 2.336 Vali Acc: 0.520 Test Loss: 2.336 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5512759685516357
Epoch: 21, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.852 Vali Acc: 0.580 Test Loss: 1.852 Test Acc: 0.580
Validation loss decreased (-0.569988 --> -0.579981).  Saving model ...
Epoch: 22 cost time: 1.6130475997924805
Epoch: 22, Steps: 20 | Train Loss: 0.201 Vali Loss: 2.329 Vali Acc: 0.490 Test Loss: 2.329 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.690434455871582
Epoch: 23, Steps: 20 | Train Loss: 0.181 Vali Loss: 2.101 Vali Acc: 0.550 Test Loss: 2.101 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6356146335601807
Epoch: 24, Steps: 20 | Train Loss: 0.157 Vali Loss: 2.110 Vali Acc: 0.530 Test Loss: 2.110 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6540682315826416
Epoch: 25, Steps: 20 | Train Loss: 0.075 Vali Loss: 2.416 Vali Acc: 0.510 Test Loss: 2.416 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7479596138000488
Epoch: 26, Steps: 20 | Train Loss: 0.085 Vali Loss: 2.282 Vali Acc: 0.560 Test Loss: 2.282 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6075057983398438
Epoch: 27, Steps: 20 | Train Loss: 0.102 Vali Loss: 2.289 Vali Acc: 0.560 Test Loss: 2.289 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.643953561782837
Epoch: 28, Steps: 20 | Train Loss: 0.083 Vali Loss: 2.517 Vali Acc: 0.510 Test Loss: 2.517 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.619222640991211
Epoch: 29, Steps: 20 | Train Loss: 0.063 Vali Loss: 3.204 Vali Acc: 0.610 Test Loss: 3.204 Test Acc: 0.610
Validation loss decreased (-0.579981 --> -0.609968).  Saving model ...
Epoch: 30 cost time: 1.0595002174377441
Epoch: 30, Steps: 20 | Train Loss: 0.127 Vali Loss: 2.829 Vali Acc: 0.580 Test Loss: 2.829 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6427943706512451
Epoch: 31, Steps: 20 | Train Loss: 0.116 Vali Loss: 3.172 Vali Acc: 0.470 Test Loss: 3.172 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.851043939590454
Epoch: 32, Steps: 20 | Train Loss: 0.035 Vali Loss: 3.113 Vali Acc: 0.560 Test Loss: 3.113 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.788003921508789
Epoch: 33, Steps: 20 | Train Loss: 0.049 Vali Loss: 2.774 Vali Acc: 0.580 Test Loss: 2.774 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5518651008605957
Epoch: 34, Steps: 20 | Train Loss: 0.042 Vali Loss: 3.124 Vali Acc: 0.590 Test Loss: 3.124 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.741898536682129
Epoch: 35, Steps: 20 | Train Loss: 0.058 Vali Loss: 3.813 Vali Acc: 0.570 Test Loss: 3.813 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.791501522064209
Epoch: 36, Steps: 20 | Train Loss: 0.149 Vali Loss: 3.356 Vali Acc: 0.500 Test Loss: 3.356 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.578498363494873
Epoch: 37, Steps: 20 | Train Loss: 0.048 Vali Loss: 3.636 Vali Acc: 0.560 Test Loss: 3.636 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.8427560329437256
Epoch: 38, Steps: 20 | Train Loss: 0.055 Vali Loss: 3.909 Vali Acc: 0.560 Test Loss: 3.909 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.5331499576568604
Epoch: 39, Steps: 20 | Train Loss: 0.041 Vali Loss: 3.423 Vali Acc: 0.570 Test Loss: 3.423 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 184578
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.026366949081421
Epoch: 1, Steps: 20 | Train Loss: 0.923 Vali Loss: 1.091 Vali Acc: 0.410 Test Loss: 1.091 Test Acc: 0.410
Validation loss decreased (inf --> -0.409989).  Saving model ...
Epoch: 2 cost time: 3.1209914684295654
Epoch: 2, Steps: 20 | Train Loss: 1.009 Vali Loss: 1.348 Vali Acc: 0.410 Test Loss: 1.348 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.075576066970825
Epoch: 3, Steps: 20 | Train Loss: 1.539 Vali Loss: 3.414 Vali Acc: 0.500 Test Loss: 3.414 Test Acc: 0.500
Validation loss decreased (-0.409989 --> -0.499966).  Saving model ...
Epoch: 4 cost time: 3.2142653465270996
Epoch: 4, Steps: 20 | Train Loss: 1.916 Vali Loss: 2.103 Vali Acc: 0.550 Test Loss: 2.103 Test Acc: 0.550
Validation loss decreased (-0.499966 --> -0.549979).  Saving model ...
Epoch: 5 cost time: 2.9200611114501953
Epoch: 5, Steps: 20 | Train Loss: 1.712 Vali Loss: 2.637 Vali Acc: 0.550 Test Loss: 2.637 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.984297513961792
Epoch: 6, Steps: 20 | Train Loss: 1.080 Vali Loss: 4.307 Vali Acc: 0.550 Test Loss: 4.307 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1656980514526367
Epoch: 7, Steps: 20 | Train Loss: 1.100 Vali Loss: 3.806 Vali Acc: 0.460 Test Loss: 3.806 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.913358449935913
Epoch: 8, Steps: 20 | Train Loss: 1.104 Vali Loss: 3.215 Vali Acc: 0.500 Test Loss: 3.215 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9804306030273438
Epoch: 9, Steps: 20 | Train Loss: 1.494 Vali Loss: 5.039 Vali Acc: 0.540 Test Loss: 5.039 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4166886806488037
Epoch: 10, Steps: 20 | Train Loss: 1.119 Vali Loss: 3.610 Vali Acc: 0.500 Test Loss: 3.610 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.4715957641601562
Epoch: 11, Steps: 20 | Train Loss: 1.131 Vali Loss: 5.415 Vali Acc: 0.540 Test Loss: 5.415 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7961854934692383
Epoch: 12, Steps: 20 | Train Loss: 1.132 Vali Loss: 5.042 Vali Acc: 0.470 Test Loss: 5.042 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.6036665439605713
Epoch: 13, Steps: 20 | Train Loss: 1.321 Vali Loss: 6.639 Vali Acc: 0.460 Test Loss: 6.639 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.922013282775879
Epoch: 14, Steps: 20 | Train Loss: 1.032 Vali Loss: 6.685 Vali Acc: 0.530 Test Loss: 6.685 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 458498
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.981255292892456
Epoch: 1, Steps: 20 | Train Loss: 0.803 Vali Loss: 0.910 Vali Acc: 0.540 Test Loss: 0.910 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 1.8455636501312256
Epoch: 2, Steps: 20 | Train Loss: 0.884 Vali Loss: 1.121 Vali Acc: 0.560 Test Loss: 1.121 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559989).  Saving model ...
Epoch: 3 cost time: 2.0135185718536377
Epoch: 3, Steps: 20 | Train Loss: 0.827 Vali Loss: 1.520 Vali Acc: 0.520 Test Loss: 1.520 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4615559577941895
Epoch: 4, Steps: 20 | Train Loss: 0.643 Vali Loss: 1.555 Vali Acc: 0.430 Test Loss: 1.555 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.203320026397705
Epoch: 5, Steps: 20 | Train Loss: 0.868 Vali Loss: 1.388 Vali Acc: 0.580 Test Loss: 1.388 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579986).  Saving model ...
Epoch: 6 cost time: 2.172731876373291
Epoch: 6, Steps: 20 | Train Loss: 0.631 Vali Loss: 1.841 Vali Acc: 0.550 Test Loss: 1.841 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4122185707092285
Epoch: 7, Steps: 20 | Train Loss: 0.865 Vali Loss: 3.187 Vali Acc: 0.540 Test Loss: 3.187 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1083924770355225
Epoch: 8, Steps: 20 | Train Loss: 1.236 Vali Loss: 3.131 Vali Acc: 0.490 Test Loss: 3.131 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.260023832321167
Epoch: 9, Steps: 20 | Train Loss: 0.943 Vali Loss: 2.078 Vali Acc: 0.550 Test Loss: 2.078 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1124258041381836
Epoch: 10, Steps: 20 | Train Loss: 0.773 Vali Loss: 3.317 Vali Acc: 0.500 Test Loss: 3.317 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1577394008636475
Epoch: 11, Steps: 20 | Train Loss: 0.803 Vali Loss: 2.544 Vali Acc: 0.500 Test Loss: 2.544 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9991674423217773
Epoch: 12, Steps: 20 | Train Loss: 0.596 Vali Loss: 4.098 Vali Acc: 0.560 Test Loss: 4.098 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.1922848224639893
Epoch: 13, Steps: 20 | Train Loss: 1.574 Vali Loss: 3.457 Vali Acc: 0.500 Test Loss: 3.457 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2582852840423584
Epoch: 14, Steps: 20 | Train Loss: 0.830 Vali Loss: 5.447 Vali Acc: 0.520 Test Loss: 5.447 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.05159068107605
Epoch: 15, Steps: 20 | Train Loss: 0.744 Vali Loss: 3.858 Vali Acc: 0.510 Test Loss: 3.858 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 279426
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.355316400527954
Epoch: 1, Steps: 20 | Train Loss: 0.951 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 2.1001455783843994
Epoch: 2, Steps: 20 | Train Loss: 0.955 Vali Loss: 1.337 Vali Acc: 0.440 Test Loss: 1.337 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.042807102203369
Epoch: 3, Steps: 20 | Train Loss: 0.778 Vali Loss: 1.158 Vali Acc: 0.480 Test Loss: 1.158 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1778929233551025
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 1.268 Vali Acc: 0.510 Test Loss: 1.268 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2239580154418945
Epoch: 5, Steps: 20 | Train Loss: 0.824 Vali Loss: 2.198 Vali Acc: 0.490 Test Loss: 2.198 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0774331092834473
Epoch: 6, Steps: 20 | Train Loss: 0.983 Vali Loss: 2.214 Vali Acc: 0.550 Test Loss: 2.214 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549978).  Saving model ...
Epoch: 7 cost time: 1.9308247566223145
Epoch: 7, Steps: 20 | Train Loss: 0.607 Vali Loss: 2.146 Vali Acc: 0.590 Test Loss: 2.146 Test Acc: 0.590
Validation loss decreased (-0.549978 --> -0.589979).  Saving model ...
Epoch: 8 cost time: 2.062497615814209
Epoch: 8, Steps: 20 | Train Loss: 0.854 Vali Loss: 2.188 Vali Acc: 0.510 Test Loss: 2.188 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3386502265930176
Epoch: 9, Steps: 20 | Train Loss: 0.583 Vali Loss: 2.317 Vali Acc: 0.480 Test Loss: 2.317 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.15515398979187
Epoch: 10, Steps: 20 | Train Loss: 0.898 Vali Loss: 2.416 Vali Acc: 0.490 Test Loss: 2.416 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2420003414154053
Epoch: 11, Steps: 20 | Train Loss: 0.635 Vali Loss: 3.395 Vali Acc: 0.500 Test Loss: 3.395 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1032495498657227
Epoch: 12, Steps: 20 | Train Loss: 0.585 Vali Loss: 2.626 Vali Acc: 0.530 Test Loss: 2.626 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.374122381210327
Epoch: 13, Steps: 20 | Train Loss: 0.761 Vali Loss: 3.631 Vali Acc: 0.500 Test Loss: 3.631 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.149273633956909
Epoch: 14, Steps: 20 | Train Loss: 0.870 Vali Loss: 3.250 Vali Acc: 0.500 Test Loss: 3.250 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.2225730419158936
Epoch: 15, Steps: 20 | Train Loss: 0.706 Vali Loss: 3.167 Vali Acc: 0.550 Test Loss: 3.167 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.234501838684082
Epoch: 16, Steps: 20 | Train Loss: 0.280 Vali Loss: 3.590 Vali Acc: 0.560 Test Loss: 3.590 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4784491062164307
Epoch: 17, Steps: 20 | Train Loss: 0.411 Vali Loss: 4.620 Vali Acc: 0.440 Test Loss: 4.620 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 279554
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.80938458442688
Epoch: 1, Steps: 20 | Train Loss: 0.860 Vali Loss: 0.904 Vali Acc: 0.490 Test Loss: 0.904 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 1.7182645797729492
Epoch: 2, Steps: 20 | Train Loss: 0.857 Vali Loss: 0.917 Vali Acc: 0.550 Test Loss: 0.917 Test Acc: 0.550
Validation loss decreased (-0.489991 --> -0.549991).  Saving model ...
Epoch: 3 cost time: 1.5518062114715576
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 1.225 Vali Acc: 0.520 Test Loss: 1.225 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5278184413909912
Epoch: 4, Steps: 20 | Train Loss: 0.769 Vali Loss: 1.002 Vali Acc: 0.570 Test Loss: 1.002 Test Acc: 0.570
Validation loss decreased (-0.549991 --> -0.569990).  Saving model ...
Epoch: 5 cost time: 1.592175006866455
Epoch: 5, Steps: 20 | Train Loss: 0.748 Vali Loss: 1.193 Vali Acc: 0.510 Test Loss: 1.193 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.250927448272705
Epoch: 6, Steps: 20 | Train Loss: 0.645 Vali Loss: 1.716 Vali Acc: 0.530 Test Loss: 1.716 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7037343978881836
Epoch: 7, Steps: 20 | Train Loss: 0.602 Vali Loss: 1.519 Vali Acc: 0.540 Test Loss: 1.519 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6710147857666016
Epoch: 8, Steps: 20 | Train Loss: 0.547 Vali Loss: 1.642 Vali Acc: 0.510 Test Loss: 1.642 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8604867458343506
Epoch: 9, Steps: 20 | Train Loss: 0.582 Vali Loss: 1.583 Vali Acc: 0.480 Test Loss: 1.583 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5365242958068848
Epoch: 10, Steps: 20 | Train Loss: 0.690 Vali Loss: 2.859 Vali Acc: 0.540 Test Loss: 2.859 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7716243267059326
Epoch: 11, Steps: 20 | Train Loss: 0.536 Vali Loss: 2.332 Vali Acc: 0.530 Test Loss: 2.332 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6162848472595215
Epoch: 12, Steps: 20 | Train Loss: 0.679 Vali Loss: 2.362 Vali Acc: 0.460 Test Loss: 2.362 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6474661827087402
Epoch: 13, Steps: 20 | Train Loss: 0.626 Vali Loss: 3.445 Vali Acc: 0.450 Test Loss: 3.445 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6928353309631348
Epoch: 14, Steps: 20 | Train Loss: 0.537 Vali Loss: 3.279 Vali Acc: 0.500 Test Loss: 3.279 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 222338
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8788671493530273
Epoch: 1, Steps: 20 | Train Loss: 0.811 Vali Loss: 0.870 Vali Acc: 0.490 Test Loss: 0.870 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 1.8525056838989258
Epoch: 2, Steps: 20 | Train Loss: 0.798 Vali Loss: 1.155 Vali Acc: 0.480 Test Loss: 1.155 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7275681495666504
Epoch: 3, Steps: 20 | Train Loss: 0.765 Vali Loss: 1.140 Vali Acc: 0.480 Test Loss: 1.140 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7572534084320068
Epoch: 4, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.983 Vali Acc: 0.500 Test Loss: 0.983 Test Acc: 0.500
Validation loss decreased (-0.489991 --> -0.499990).  Saving model ...
Epoch: 5 cost time: 1.6933388710021973
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 1.096 Vali Acc: 0.570 Test Loss: 1.096 Test Acc: 0.570
Validation loss decreased (-0.499990 --> -0.569989).  Saving model ...
Epoch: 6 cost time: 1.6562154293060303
Epoch: 6, Steps: 20 | Train Loss: 0.584 Vali Loss: 1.004 Vali Acc: 0.480 Test Loss: 1.004 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6928844451904297
Epoch: 7, Steps: 20 | Train Loss: 0.575 Vali Loss: 1.613 Vali Acc: 0.480 Test Loss: 1.613 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5129001140594482
Epoch: 8, Steps: 20 | Train Loss: 0.957 Vali Loss: 1.962 Vali Acc: 0.490 Test Loss: 1.962 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8141112327575684
Epoch: 9, Steps: 20 | Train Loss: 0.661 Vali Loss: 1.271 Vali Acc: 0.480 Test Loss: 1.271 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6614296436309814
Epoch: 10, Steps: 20 | Train Loss: 0.504 Vali Loss: 1.226 Vali Acc: 0.490 Test Loss: 1.226 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.031738758087158
Epoch: 11, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.279 Vali Acc: 0.510 Test Loss: 1.279 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.20715594291687
Epoch: 12, Steps: 20 | Train Loss: 0.353 Vali Loss: 2.190 Vali Acc: 0.480 Test Loss: 2.190 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.349752187728882
Epoch: 13, Steps: 20 | Train Loss: 0.695 Vali Loss: 2.009 Vali Acc: 0.520 Test Loss: 2.009 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2575881481170654
Epoch: 14, Steps: 20 | Train Loss: 0.553 Vali Loss: 2.213 Vali Acc: 0.530 Test Loss: 2.213 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0416078567504883
Epoch: 15, Steps: 20 | Train Loss: 0.491 Vali Loss: 1.847 Vali Acc: 0.480 Test Loss: 1.847 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 186882
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.1698291301727295
Epoch: 1, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.756 Vali Acc: 0.560 Test Loss: 0.756 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 2.153917074203491
Epoch: 2, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.986 Vali Acc: 0.530 Test Loss: 0.986 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.171470880508423
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.144566774368286
Epoch: 4, Steps: 20 | Train Loss: 0.775 Vali Loss: 1.205 Vali Acc: 0.460 Test Loss: 1.205 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.070692777633667
Epoch: 5, Steps: 20 | Train Loss: 0.690 Vali Loss: 1.033 Vali Acc: 0.540 Test Loss: 1.033 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1452720165252686
Epoch: 6, Steps: 20 | Train Loss: 0.695 Vali Loss: 1.324 Vali Acc: 0.490 Test Loss: 1.324 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.043318510055542
Epoch: 7, Steps: 20 | Train Loss: 0.734 Vali Loss: 1.321 Vali Acc: 0.480 Test Loss: 1.321 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8661110401153564
Epoch: 8, Steps: 20 | Train Loss: 0.547 Vali Loss: 1.167 Vali Acc: 0.570 Test Loss: 1.167 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569988).  Saving model ...
Epoch: 9 cost time: 1.9167370796203613
Epoch: 9, Steps: 20 | Train Loss: 0.490 Vali Loss: 1.289 Vali Acc: 0.530 Test Loss: 1.289 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.172456979751587
Epoch: 10, Steps: 20 | Train Loss: 0.588 Vali Loss: 1.373 Vali Acc: 0.510 Test Loss: 1.373 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.089823007583618
Epoch: 11, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.847 Vali Acc: 0.480 Test Loss: 1.847 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5817720890045166
Epoch: 12, Steps: 20 | Train Loss: 0.540 Vali Loss: 1.736 Vali Acc: 0.510 Test Loss: 1.736 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7248823642730713
Epoch: 13, Steps: 20 | Train Loss: 0.467 Vali Loss: 1.498 Vali Acc: 0.560 Test Loss: 1.498 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.036919355392456
Epoch: 14, Steps: 20 | Train Loss: 0.416 Vali Loss: 1.808 Vali Acc: 0.520 Test Loss: 1.808 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2976644039154053
Epoch: 15, Steps: 20 | Train Loss: 0.383 Vali Loss: 2.309 Vali Acc: 0.510 Test Loss: 2.309 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0094172954559326
Epoch: 16, Steps: 20 | Train Loss: 0.556 Vali Loss: 1.844 Vali Acc: 0.500 Test Loss: 1.844 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0902297496795654
Epoch: 17, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.709 Vali Acc: 0.500 Test Loss: 1.709 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0667660236358643
Epoch: 18, Steps: 20 | Train Loss: 0.252 Vali Loss: 3.258 Vali Acc: 0.460 Test Loss: 3.258 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 172802
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7460880279541016
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.741 Vali Acc: 0.530 Test Loss: 0.741 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.759596824645996
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.863 Vali Acc: 0.410 Test Loss: 0.863 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7489917278289795
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9773292541503906
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 1.074 Vali Acc: 0.460 Test Loss: 1.074 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9388022422790527
Epoch: 5, Steps: 20 | Train Loss: 0.552 Vali Loss: 1.124 Vali Acc: 0.530 Test Loss: 1.124 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9086692333221436
Epoch: 6, Steps: 20 | Train Loss: 0.630 Vali Loss: 1.106 Vali Acc: 0.520 Test Loss: 1.106 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9555718898773193
Epoch: 7, Steps: 20 | Train Loss: 0.593 Vali Loss: 1.065 Vali Acc: 0.490 Test Loss: 1.065 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0256972312927246
Epoch: 8, Steps: 20 | Train Loss: 0.604 Vali Loss: 1.324 Vali Acc: 0.520 Test Loss: 1.324 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1410582065582275
Epoch: 9, Steps: 20 | Train Loss: 0.533 Vali Loss: 1.332 Vali Acc: 0.560 Test Loss: 1.332 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559987).  Saving model ...
Epoch: 10 cost time: 1.797065258026123
Epoch: 10, Steps: 20 | Train Loss: 0.514 Vali Loss: 1.396 Vali Acc: 0.550 Test Loss: 1.396 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5544226169586182
Epoch: 11, Steps: 20 | Train Loss: 0.506 Vali Loss: 1.433 Vali Acc: 0.490 Test Loss: 1.433 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5362133979797363
Epoch: 12, Steps: 20 | Train Loss: 0.536 Vali Loss: 1.352 Vali Acc: 0.550 Test Loss: 1.352 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.141835927963257
Epoch: 13, Steps: 20 | Train Loss: 0.456 Vali Loss: 1.350 Vali Acc: 0.500 Test Loss: 1.350 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.055196523666382
Epoch: 14, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.757 Vali Acc: 0.450 Test Loss: 1.757 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8916304111480713
Epoch: 15, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.646 Vali Acc: 0.480 Test Loss: 1.646 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9443786144256592
Epoch: 16, Steps: 20 | Train Loss: 0.314 Vali Loss: 2.229 Vali Acc: 0.540 Test Loss: 2.229 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2120754718780518
Epoch: 17, Steps: 20 | Train Loss: 0.414 Vali Loss: 1.651 Vali Acc: 0.490 Test Loss: 1.651 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9321768283843994
Epoch: 18, Steps: 20 | Train Loss: 0.300 Vali Loss: 2.615 Vali Acc: 0.510 Test Loss: 2.615 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8472168445587158
Epoch: 19, Steps: 20 | Train Loss: 0.394 Vali Loss: 2.258 Vali Acc: 0.450 Test Loss: 2.258 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 151682
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.073720455169678
Epoch: 1, Steps: 20 | Train Loss: 1.118 Vali Loss: 3.034 Vali Acc: 0.480 Test Loss: 3.034 Test Acc: 0.480
Validation loss decreased (inf --> -0.479970).  Saving model ...
Epoch: 2 cost time: 2.2371301651000977
Epoch: 2, Steps: 20 | Train Loss: 1.235 Vali Loss: 1.650 Vali Acc: 0.560 Test Loss: 1.650 Test Acc: 0.560
Validation loss decreased (-0.479970 --> -0.559984).  Saving model ...
Epoch: 3 cost time: 2.981455087661743
Epoch: 3, Steps: 20 | Train Loss: 1.197 Vali Loss: 2.440 Vali Acc: 0.430 Test Loss: 2.440 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9980628490448
Epoch: 4, Steps: 20 | Train Loss: 2.074 Vali Loss: 1.991 Vali Acc: 0.590 Test Loss: 1.991 Test Acc: 0.590
Validation loss decreased (-0.559984 --> -0.589980).  Saving model ...
Epoch: 5 cost time: 3.302032709121704
Epoch: 5, Steps: 20 | Train Loss: 1.387 Vali Loss: 4.242 Vali Acc: 0.510 Test Loss: 4.242 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.698441505432129
Epoch: 6, Steps: 20 | Train Loss: 1.458 Vali Loss: 3.785 Vali Acc: 0.440 Test Loss: 3.785 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3705384731292725
Epoch: 7, Steps: 20 | Train Loss: 1.357 Vali Loss: 3.544 Vali Acc: 0.500 Test Loss: 3.544 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.777863025665283
Epoch: 8, Steps: 20 | Train Loss: 1.009 Vali Loss: 4.239 Vali Acc: 0.490 Test Loss: 4.239 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7172789573669434
Epoch: 9, Steps: 20 | Train Loss: 1.494 Vali Loss: 5.499 Vali Acc: 0.490 Test Loss: 5.499 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.442230463027954
Epoch: 10, Steps: 20 | Train Loss: 1.765 Vali Loss: 4.423 Vali Acc: 0.490 Test Loss: 4.423 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.069800853729248
Epoch: 11, Steps: 20 | Train Loss: 1.515 Vali Loss: 4.490 Vali Acc: 0.530 Test Loss: 4.490 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.1595845222473145
Epoch: 12, Steps: 20 | Train Loss: 0.844 Vali Loss: 4.075 Vali Acc: 0.530 Test Loss: 4.075 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.749727249145508
Epoch: 13, Steps: 20 | Train Loss: 0.785 Vali Loss: 6.628 Vali Acc: 0.510 Test Loss: 6.628 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8893327713012695
Epoch: 14, Steps: 20 | Train Loss: 0.777 Vali Loss: 6.123 Vali Acc: 0.510 Test Loss: 6.123 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 442050
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.90523362159729
Epoch: 1, Steps: 20 | Train Loss: 0.835 Vali Loss: 1.012 Vali Acc: 0.500 Test Loss: 1.012 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 2.000427722930908
Epoch: 2, Steps: 20 | Train Loss: 0.877 Vali Loss: 1.033 Vali Acc: 0.490 Test Loss: 1.033 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1463513374328613
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 2.168 Vali Acc: 0.500 Test Loss: 2.168 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8153715133666992
Epoch: 4, Steps: 20 | Train Loss: 1.090 Vali Loss: 1.604 Vali Acc: 0.500 Test Loss: 1.604 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.257652759552002
Epoch: 5, Steps: 20 | Train Loss: 0.850 Vali Loss: 2.213 Vali Acc: 0.500 Test Loss: 2.213 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0983734130859375
Epoch: 6, Steps: 20 | Train Loss: 1.540 Vali Loss: 3.926 Vali Acc: 0.530 Test Loss: 3.926 Test Acc: 0.530
Validation loss decreased (-0.499990 --> -0.529961).  Saving model ...
Epoch: 7 cost time: 1.8900458812713623
Epoch: 7, Steps: 20 | Train Loss: 0.919 Vali Loss: 2.475 Vali Acc: 0.470 Test Loss: 2.475 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4129464626312256
Epoch: 8, Steps: 20 | Train Loss: 0.812 Vali Loss: 3.464 Vali Acc: 0.490 Test Loss: 3.464 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0048904418945312
Epoch: 9, Steps: 20 | Train Loss: 0.687 Vali Loss: 3.004 Vali Acc: 0.450 Test Loss: 3.004 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.420607089996338
Epoch: 10, Steps: 20 | Train Loss: 0.521 Vali Loss: 2.441 Vali Acc: 0.490 Test Loss: 2.441 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.122070074081421
Epoch: 11, Steps: 20 | Train Loss: 0.674 Vali Loss: 2.630 Vali Acc: 0.560 Test Loss: 2.630 Test Acc: 0.560
Validation loss decreased (-0.529961 --> -0.559974).  Saving model ...
Epoch: 12 cost time: 2.082585334777832
Epoch: 12, Steps: 20 | Train Loss: 0.825 Vali Loss: 2.730 Vali Acc: 0.550 Test Loss: 2.730 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.160414695739746
Epoch: 13, Steps: 20 | Train Loss: 0.510 Vali Loss: 2.682 Vali Acc: 0.480 Test Loss: 2.682 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.128110647201538
Epoch: 14, Steps: 20 | Train Loss: 1.021 Vali Loss: 3.589 Vali Acc: 0.530 Test Loss: 3.589 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0107321739196777
Epoch: 15, Steps: 20 | Train Loss: 0.434 Vali Loss: 3.070 Vali Acc: 0.480 Test Loss: 3.070 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.953413963317871
Epoch: 16, Steps: 20 | Train Loss: 0.696 Vali Loss: 3.519 Vali Acc: 0.550 Test Loss: 3.519 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8912229537963867
Epoch: 17, Steps: 20 | Train Loss: 0.398 Vali Loss: 5.157 Vali Acc: 0.510 Test Loss: 5.157 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8539788722991943
Epoch: 18, Steps: 20 | Train Loss: 0.463 Vali Loss: 5.249 Vali Acc: 0.540 Test Loss: 5.249 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.809882640838623
Epoch: 19, Steps: 20 | Train Loss: 0.593 Vali Loss: 4.682 Vali Acc: 0.540 Test Loss: 4.682 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.697519302368164
Epoch: 20, Steps: 20 | Train Loss: 0.452 Vali Loss: 4.535 Vali Acc: 0.530 Test Loss: 4.535 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1525254249572754
Epoch: 21, Steps: 20 | Train Loss: 0.303 Vali Loss: 5.800 Vali Acc: 0.480 Test Loss: 5.800 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 262978
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.249922752380371
Epoch: 1, Steps: 20 | Train Loss: 0.827 Vali Loss: 0.974 Vali Acc: 0.470 Test Loss: 0.974 Test Acc: 0.470
Validation loss decreased (inf --> -0.469990).  Saving model ...
Epoch: 2 cost time: 2.217191457748413
Epoch: 2, Steps: 20 | Train Loss: 0.837 Vali Loss: 1.016 Vali Acc: 0.500 Test Loss: 1.016 Test Acc: 0.500
Validation loss decreased (-0.469990 --> -0.499990).  Saving model ...
Epoch: 3 cost time: 2.0709116458892822
Epoch: 3, Steps: 20 | Train Loss: 0.830 Vali Loss: 1.563 Vali Acc: 0.510 Test Loss: 1.563 Test Acc: 0.510
Validation loss decreased (-0.499990 --> -0.509984).  Saving model ...
Epoch: 4 cost time: 2.324622392654419
Epoch: 4, Steps: 20 | Train Loss: 0.874 Vali Loss: 1.332 Vali Acc: 0.610 Test Loss: 1.332 Test Acc: 0.610
Validation loss decreased (-0.509984 --> -0.609987).  Saving model ...
Epoch: 5 cost time: 2.2102437019348145
Epoch: 5, Steps: 20 | Train Loss: 1.058 Vali Loss: 1.581 Vali Acc: 0.500 Test Loss: 1.581 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.511345863342285
Epoch: 6, Steps: 20 | Train Loss: 1.136 Vali Loss: 2.220 Vali Acc: 0.500 Test Loss: 2.220 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2663156986236572
Epoch: 7, Steps: 20 | Train Loss: 1.030 Vali Loss: 2.075 Vali Acc: 0.500 Test Loss: 2.075 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6186883449554443
Epoch: 8, Steps: 20 | Train Loss: 0.827 Vali Loss: 2.291 Vali Acc: 0.490 Test Loss: 2.291 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2218761444091797
Epoch: 9, Steps: 20 | Train Loss: 0.948 Vali Loss: 2.853 Vali Acc: 0.560 Test Loss: 2.853 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.610429286956787
Epoch: 10, Steps: 20 | Train Loss: 0.819 Vali Loss: 1.664 Vali Acc: 0.580 Test Loss: 1.664 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.088366746902466
Epoch: 11, Steps: 20 | Train Loss: 0.745 Vali Loss: 2.342 Vali Acc: 0.490 Test Loss: 2.342 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6164016723632812
Epoch: 12, Steps: 20 | Train Loss: 0.423 Vali Loss: 2.794 Vali Acc: 0.460 Test Loss: 2.794 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.13464093208313
Epoch: 13, Steps: 20 | Train Loss: 0.484 Vali Loss: 2.809 Vali Acc: 0.550 Test Loss: 2.809 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.4449620246887207
Epoch: 14, Steps: 20 | Train Loss: 1.047 Vali Loss: 3.614 Vali Acc: 0.550 Test Loss: 3.614 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 263106
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.133551359176636
Epoch: 1, Steps: 20 | Train Loss: 0.918 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.7979884147644043
Epoch: 2, Steps: 20 | Train Loss: 0.815 Vali Loss: 1.151 Vali Acc: 0.470 Test Loss: 1.151 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7959585189819336
Epoch: 3, Steps: 20 | Train Loss: 0.839 Vali Loss: 1.488 Vali Acc: 0.510 Test Loss: 1.488 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8827910423278809
Epoch: 4, Steps: 20 | Train Loss: 0.882 Vali Loss: 1.816 Vali Acc: 0.530 Test Loss: 1.816 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529982).  Saving model ...
Epoch: 5 cost time: 1.7093415260314941
Epoch: 5, Steps: 20 | Train Loss: 0.846 Vali Loss: 1.959 Vali Acc: 0.480 Test Loss: 1.959 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.274986743927002
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 1.307 Vali Acc: 0.540 Test Loss: 1.307 Test Acc: 0.540
Validation loss decreased (-0.529982 --> -0.539987).  Saving model ...
Epoch: 7 cost time: 2.1734466552734375
Epoch: 7, Steps: 20 | Train Loss: 0.584 Vali Loss: 1.482 Vali Acc: 0.530 Test Loss: 1.482 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.41182017326355
Epoch: 8, Steps: 20 | Train Loss: 0.614 Vali Loss: 1.501 Vali Acc: 0.570 Test Loss: 1.501 Test Acc: 0.570
Validation loss decreased (-0.539987 --> -0.569985).  Saving model ...
Epoch: 9 cost time: 2.217561721801758
Epoch: 9, Steps: 20 | Train Loss: 0.610 Vali Loss: 2.482 Vali Acc: 0.470 Test Loss: 2.482 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2084097862243652
Epoch: 10, Steps: 20 | Train Loss: 0.651 Vali Loss: 1.920 Vali Acc: 0.560 Test Loss: 1.920 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1147007942199707
Epoch: 11, Steps: 20 | Train Loss: 0.661 Vali Loss: 2.199 Vali Acc: 0.450 Test Loss: 2.199 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.069880723953247
Epoch: 12, Steps: 20 | Train Loss: 0.721 Vali Loss: 2.385 Vali Acc: 0.460 Test Loss: 2.385 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.376162528991699
Epoch: 13, Steps: 20 | Train Loss: 0.537 Vali Loss: 3.948 Vali Acc: 0.520 Test Loss: 3.948 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8744168281555176
Epoch: 14, Steps: 20 | Train Loss: 0.517 Vali Loss: 2.753 Vali Acc: 0.550 Test Loss: 2.753 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4866161346435547
Epoch: 15, Steps: 20 | Train Loss: 0.391 Vali Loss: 2.182 Vali Acc: 0.540 Test Loss: 2.182 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.305241346359253
Epoch: 16, Steps: 20 | Train Loss: 0.520 Vali Loss: 2.942 Vali Acc: 0.500 Test Loss: 2.942 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.126371145248413
Epoch: 17, Steps: 20 | Train Loss: 0.395 Vali Loss: 3.454 Vali Acc: 0.520 Test Loss: 3.454 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4804985523223877
Epoch: 18, Steps: 20 | Train Loss: 0.418 Vali Loss: 3.398 Vali Acc: 0.480 Test Loss: 3.398 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 205890
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6915178298950195
Epoch: 1, Steps: 20 | Train Loss: 0.847 Vali Loss: 0.872 Vali Acc: 0.520 Test Loss: 0.872 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 2.0513951778411865
Epoch: 2, Steps: 20 | Train Loss: 0.766 Vali Loss: 1.096 Vali Acc: 0.490 Test Loss: 1.096 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8657886981964111
Epoch: 3, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.879 Vali Acc: 0.550 Test Loss: 0.879 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 1.8677208423614502
Epoch: 4, Steps: 20 | Train Loss: 0.621 Vali Loss: 1.591 Vali Acc: 0.530 Test Loss: 1.591 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.819237470626831
Epoch: 5, Steps: 20 | Train Loss: 0.917 Vali Loss: 1.271 Vali Acc: 0.530 Test Loss: 1.271 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.891855001449585
Epoch: 6, Steps: 20 | Train Loss: 0.692 Vali Loss: 1.027 Vali Acc: 0.530 Test Loss: 1.027 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7545533180236816
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 1.293 Vali Acc: 0.480 Test Loss: 1.293 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.760045051574707
Epoch: 8, Steps: 20 | Train Loss: 0.796 Vali Loss: 2.653 Vali Acc: 0.510 Test Loss: 2.653 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9797425270080566
Epoch: 9, Steps: 20 | Train Loss: 0.766 Vali Loss: 1.365 Vali Acc: 0.500 Test Loss: 1.365 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8397176265716553
Epoch: 10, Steps: 20 | Train Loss: 0.684 Vali Loss: 1.943 Vali Acc: 0.550 Test Loss: 1.943 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9891934394836426
Epoch: 11, Steps: 20 | Train Loss: 0.552 Vali Loss: 1.528 Vali Acc: 0.530 Test Loss: 1.528 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8699042797088623
Epoch: 12, Steps: 20 | Train Loss: 0.576 Vali Loss: 1.572 Vali Acc: 0.550 Test Loss: 1.572 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0013716220855713
Epoch: 13, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.402 Vali Acc: 0.500 Test Loss: 1.402 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 170434
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4442780017852783
Epoch: 1, Steps: 20 | Train Loss: 0.828 Vali Loss: 0.880 Vali Acc: 0.460 Test Loss: 0.880 Test Acc: 0.460
Validation loss decreased (inf --> -0.459991).  Saving model ...
Epoch: 2 cost time: 1.7053382396697998
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.825 Vali Acc: 0.530 Test Loss: 0.825 Test Acc: 0.530
Validation loss decreased (-0.459991 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 1.614898920059204
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.924 Vali Acc: 0.440 Test Loss: 0.924 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5271594524383545
Epoch: 4, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.983 Vali Acc: 0.520 Test Loss: 0.983 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.916959285736084
Epoch: 5, Steps: 20 | Train Loss: 0.646 Vali Loss: 1.030 Vali Acc: 0.510 Test Loss: 1.030 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7368547916412354
Epoch: 6, Steps: 20 | Train Loss: 0.658 Vali Loss: 1.580 Vali Acc: 0.500 Test Loss: 1.580 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6802210807800293
Epoch: 7, Steps: 20 | Train Loss: 0.675 Vali Loss: 1.313 Vali Acc: 0.480 Test Loss: 1.313 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6109414100646973
Epoch: 8, Steps: 20 | Train Loss: 0.607 Vali Loss: 1.213 Vali Acc: 0.480 Test Loss: 1.213 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6453039646148682
Epoch: 9, Steps: 20 | Train Loss: 0.479 Vali Loss: 1.347 Vali Acc: 0.540 Test Loss: 1.347 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539987).  Saving model ...
Epoch: 10 cost time: 1.8635852336883545
Epoch: 10, Steps: 20 | Train Loss: 0.491 Vali Loss: 1.623 Vali Acc: 0.570 Test Loss: 1.623 Test Acc: 0.570
Validation loss decreased (-0.539987 --> -0.569984).  Saving model ...
Epoch: 11 cost time: 1.672370195388794
Epoch: 11, Steps: 20 | Train Loss: 0.704 Vali Loss: 1.719 Vali Acc: 0.570 Test Loss: 1.719 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6929502487182617
Epoch: 12, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.599 Vali Acc: 0.500 Test Loss: 1.599 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9059092998504639
Epoch: 13, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.734 Vali Acc: 0.550 Test Loss: 1.734 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5356037616729736
Epoch: 14, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.644 Vali Acc: 0.510 Test Loss: 1.644 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8564107418060303
Epoch: 15, Steps: 20 | Train Loss: 0.573 Vali Loss: 2.301 Vali Acc: 0.490 Test Loss: 2.301 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7867400646209717
Epoch: 16, Steps: 20 | Train Loss: 0.412 Vali Loss: 1.773 Vali Acc: 0.500 Test Loss: 1.773 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8266615867614746
Epoch: 17, Steps: 20 | Train Loss: 0.368 Vali Loss: 2.320 Vali Acc: 0.500 Test Loss: 2.320 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9962694644927979
Epoch: 18, Steps: 20 | Train Loss: 0.275 Vali Loss: 2.229 Vali Acc: 0.470 Test Loss: 2.229 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.754760503768921
Epoch: 19, Steps: 20 | Train Loss: 0.283 Vali Loss: 2.454 Vali Acc: 0.490 Test Loss: 2.454 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7236645221710205
Epoch: 20, Steps: 20 | Train Loss: 0.260 Vali Loss: 2.198 Vali Acc: 0.500 Test Loss: 2.198 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 156354
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2422938346862793
Epoch: 1, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.834 Vali Acc: 0.550 Test Loss: 0.834 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 1.6539580821990967
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.826 Vali Acc: 0.490 Test Loss: 0.826 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8390376567840576
Epoch: 3, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.800 Vali Acc: 0.520 Test Loss: 0.800 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6478183269500732
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 1.017 Vali Acc: 0.550 Test Loss: 1.017 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7012238502502441
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.909 Vali Acc: 0.570 Test Loss: 0.909 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 6 cost time: 1.7815418243408203
Epoch: 6, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.823 Vali Acc: 0.580 Test Loss: 0.823 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579992).  Saving model ...
Epoch: 7 cost time: 1.6498548984527588
Epoch: 7, Steps: 20 | Train Loss: 0.604 Vali Loss: 1.131 Vali Acc: 0.530 Test Loss: 1.131 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6327691078186035
Epoch: 8, Steps: 20 | Train Loss: 0.632 Vali Loss: 1.220 Vali Acc: 0.470 Test Loss: 1.220 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.836648941040039
Epoch: 9, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.050 Vali Acc: 0.560 Test Loss: 1.050 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.665090799331665
Epoch: 10, Steps: 20 | Train Loss: 0.448 Vali Loss: 1.446 Vali Acc: 0.530 Test Loss: 1.446 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5557489395141602
Epoch: 11, Steps: 20 | Train Loss: 0.476 Vali Loss: 1.302 Vali Acc: 0.500 Test Loss: 1.302 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6546669006347656
Epoch: 12, Steps: 20 | Train Loss: 0.510 Vali Loss: 1.567 Vali Acc: 0.510 Test Loss: 1.567 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6081585884094238
Epoch: 13, Steps: 20 | Train Loss: 0.406 Vali Loss: 1.575 Vali Acc: 0.480 Test Loss: 1.575 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4760050773620605
Epoch: 14, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.599 Vali Acc: 0.470 Test Loss: 1.599 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.730116605758667
Epoch: 15, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.367 Vali Acc: 0.540 Test Loss: 1.367 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9131720066070557
Epoch: 16, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.430 Vali Acc: 0.470 Test Loss: 1.430 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm128_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 135234
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.916092872619629
Epoch: 1, Steps: 20 | Train Loss: 0.828 Vali Loss: 1.312 Vali Acc: 0.490 Test Loss: 1.312 Test Acc: 0.490
Validation loss decreased (inf --> -0.489987).  Saving model ...
Epoch: 2 cost time: 2.3539462089538574
Epoch: 2, Steps: 20 | Train Loss: 0.999 Vali Loss: 1.002 Vali Acc: 0.500 Test Loss: 1.002 Test Acc: 0.500
Validation loss decreased (-0.489987 --> -0.499990).  Saving model ...
Epoch: 3 cost time: 2.9399032592773438
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.983 Vali Acc: 0.570 Test Loss: 0.983 Test Acc: 0.570
Validation loss decreased (-0.499990 --> -0.569990).  Saving model ...
Epoch: 4 cost time: 2.617049217224121
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 1.266 Vali Acc: 0.520 Test Loss: 1.266 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5467991828918457
Epoch: 5, Steps: 20 | Train Loss: 0.778 Vali Loss: 1.126 Vali Acc: 0.510 Test Loss: 1.126 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.775728225708008
Epoch: 6, Steps: 20 | Train Loss: 0.585 Vali Loss: 1.452 Vali Acc: 0.520 Test Loss: 1.452 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.563354253768921
Epoch: 7, Steps: 20 | Train Loss: 0.557 Vali Loss: 1.437 Vali Acc: 0.550 Test Loss: 1.437 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.622342109680176
Epoch: 8, Steps: 20 | Train Loss: 0.580 Vali Loss: 1.620 Vali Acc: 0.470 Test Loss: 1.620 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7263009548187256
Epoch: 9, Steps: 20 | Train Loss: 0.600 Vali Loss: 2.585 Vali Acc: 0.530 Test Loss: 2.585 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8297133445739746
Epoch: 10, Steps: 20 | Train Loss: 0.532 Vali Loss: 3.016 Vali Acc: 0.510 Test Loss: 3.016 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.70664381980896
Epoch: 11, Steps: 20 | Train Loss: 0.907 Vali Loss: 2.864 Vali Acc: 0.420 Test Loss: 2.864 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.60213041305542
Epoch: 12, Steps: 20 | Train Loss: 0.539 Vali Loss: 2.761 Vali Acc: 0.510 Test Loss: 2.761 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.763429641723633
Epoch: 13, Steps: 20 | Train Loss: 0.510 Vali Loss: 2.734 Vali Acc: 0.560 Test Loss: 2.734 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 229442
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.811215400695801
Epoch: 1, Steps: 20 | Train Loss: 0.885 Vali Loss: 1.060 Vali Acc: 0.530 Test Loss: 1.060 Test Acc: 0.530
Validation loss decreased (inf --> -0.529989).  Saving model ...
Epoch: 2 cost time: 1.8875088691711426
Epoch: 2, Steps: 20 | Train Loss: 0.834 Vali Loss: 0.904 Vali Acc: 0.470 Test Loss: 0.904 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8287672996520996
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.880 Vali Acc: 0.510 Test Loss: 0.880 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.344557046890259
Epoch: 4, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.922 Vali Acc: 0.430 Test Loss: 0.922 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.414295196533203
Epoch: 5, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.947 Vali Acc: 0.600 Test Loss: 0.947 Test Acc: 0.600
Validation loss decreased (-0.529989 --> -0.599991).  Saving model ...
Epoch: 6 cost time: 2.437220335006714
Epoch: 6, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.971 Vali Acc: 0.560 Test Loss: 0.971 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5235815048217773
Epoch: 7, Steps: 20 | Train Loss: 0.506 Vali Loss: 1.129 Vali Acc: 0.580 Test Loss: 1.129 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3326549530029297
Epoch: 8, Steps: 20 | Train Loss: 0.572 Vali Loss: 1.411 Vali Acc: 0.560 Test Loss: 1.411 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.275106906890869
Epoch: 9, Steps: 20 | Train Loss: 0.484 Vali Loss: 1.886 Vali Acc: 0.530 Test Loss: 1.886 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3052871227264404
Epoch: 10, Steps: 20 | Train Loss: 0.528 Vali Loss: 1.407 Vali Acc: 0.470 Test Loss: 1.407 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.42729115486145
Epoch: 11, Steps: 20 | Train Loss: 0.368 Vali Loss: 2.662 Vali Acc: 0.510 Test Loss: 2.662 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4075567722320557
Epoch: 12, Steps: 20 | Train Loss: 0.635 Vali Loss: 2.270 Vali Acc: 0.470 Test Loss: 2.270 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.478952407836914
Epoch: 13, Steps: 20 | Train Loss: 0.467 Vali Loss: 1.924 Vali Acc: 0.500 Test Loss: 1.924 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4029927253723145
Epoch: 14, Steps: 20 | Train Loss: 0.382 Vali Loss: 2.500 Vali Acc: 0.460 Test Loss: 2.500 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.53751277923584
Epoch: 15, Steps: 20 | Train Loss: 0.235 Vali Loss: 2.411 Vali Acc: 0.500 Test Loss: 2.411 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 139906
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.237623453140259
Epoch: 1, Steps: 20 | Train Loss: 0.798 Vali Loss: 0.932 Vali Acc: 0.530 Test Loss: 0.932 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 2.2125420570373535
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.959 Vali Acc: 0.480 Test Loss: 0.959 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2346928119659424
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.948 Vali Acc: 0.490 Test Loss: 0.948 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1268348693847656
Epoch: 4, Steps: 20 | Train Loss: 0.611 Vali Loss: 1.519 Vali Acc: 0.520 Test Loss: 1.519 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.235597610473633
Epoch: 5, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.994 Vali Acc: 0.480 Test Loss: 0.994 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1958608627319336
Epoch: 6, Steps: 20 | Train Loss: 0.561 Vali Loss: 1.283 Vali Acc: 0.480 Test Loss: 1.283 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8955142498016357
Epoch: 7, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.320 Vali Acc: 0.510 Test Loss: 1.320 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0827624797821045
Epoch: 8, Steps: 20 | Train Loss: 0.450 Vali Loss: 1.502 Vali Acc: 0.450 Test Loss: 1.502 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.268280506134033
Epoch: 9, Steps: 20 | Train Loss: 0.484 Vali Loss: 1.814 Vali Acc: 0.490 Test Loss: 1.814 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.2371764183044434
Epoch: 10, Steps: 20 | Train Loss: 0.610 Vali Loss: 2.365 Vali Acc: 0.490 Test Loss: 2.365 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.955855131149292
Epoch: 11, Steps: 20 | Train Loss: 0.696 Vali Loss: 2.137 Vali Acc: 0.500 Test Loss: 2.137 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 139970
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.06279993057251
Epoch: 1, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.0627636909484863
Epoch: 2, Steps: 20 | Train Loss: 0.771 Vali Loss: 1.456 Vali Acc: 0.510 Test Loss: 1.456 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8962328433990479
Epoch: 3, Steps: 20 | Train Loss: 0.879 Vali Loss: 0.839 Vali Acc: 0.530 Test Loss: 0.839 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.905440092086792
Epoch: 4, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.946 Vali Acc: 0.510 Test Loss: 0.946 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1477200984954834
Epoch: 5, Steps: 20 | Train Loss: 0.504 Vali Loss: 1.003 Vali Acc: 0.500 Test Loss: 1.003 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9705212116241455
Epoch: 6, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.115 Vali Acc: 0.560 Test Loss: 1.115 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559989).  Saving model ...
Epoch: 7 cost time: 1.7083399295806885
Epoch: 7, Steps: 20 | Train Loss: 0.603 Vali Loss: 1.067 Vali Acc: 0.480 Test Loss: 1.067 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8842623233795166
Epoch: 8, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.387 Vali Acc: 0.450 Test Loss: 1.387 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2974414825439453
Epoch: 9, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.053 Vali Acc: 0.520 Test Loss: 1.053 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1436638832092285
Epoch: 10, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.501 Vali Acc: 0.520 Test Loss: 1.501 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.786792516708374
Epoch: 11, Steps: 20 | Train Loss: 0.527 Vali Loss: 1.226 Vali Acc: 0.580 Test Loss: 1.226 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579988).  Saving model ...
Epoch: 12 cost time: 2.145364999771118
Epoch: 12, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.604 Vali Acc: 0.550 Test Loss: 1.604 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2713911533355713
Epoch: 13, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.364 Vali Acc: 0.480 Test Loss: 1.364 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0472891330718994
Epoch: 14, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.600 Vali Acc: 0.530 Test Loss: 1.600 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8669264316558838
Epoch: 15, Steps: 20 | Train Loss: 0.290 Vali Loss: 1.499 Vali Acc: 0.500 Test Loss: 1.499 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.97064208984375
Epoch: 16, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.575 Vali Acc: 0.520 Test Loss: 1.575 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2521352767944336
Epoch: 17, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.526 Vali Acc: 0.530 Test Loss: 1.526 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0916736125946045
Epoch: 18, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.951 Vali Acc: 0.490 Test Loss: 1.951 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3331620693206787
Epoch: 19, Steps: 20 | Train Loss: 0.178 Vali Loss: 2.232 Vali Acc: 0.510 Test Loss: 2.232 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1895883083343506
Epoch: 20, Steps: 20 | Train Loss: 0.232 Vali Loss: 2.021 Vali Acc: 0.510 Test Loss: 2.021 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2285754680633545
Epoch: 21, Steps: 20 | Train Loss: 0.163 Vali Loss: 2.209 Vali Acc: 0.480 Test Loss: 2.209 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 111362
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.316164255142212
Epoch: 1, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.801 Vali Acc: 0.500 Test Loss: 0.801 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.6472201347351074
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.895 Vali Acc: 0.510 Test Loss: 0.895 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509991).  Saving model ...
Epoch: 3 cost time: 1.614300012588501
Epoch: 3, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.897 Vali Acc: 0.460 Test Loss: 0.897 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8475992679595947
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.946 Vali Acc: 0.430 Test Loss: 0.946 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8744001388549805
Epoch: 5, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.899 Vali Acc: 0.500 Test Loss: 0.899 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.810481071472168
Epoch: 6, Steps: 20 | Train Loss: 0.565 Vali Loss: 1.009 Vali Acc: 0.460 Test Loss: 1.009 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8139455318450928
Epoch: 7, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.973 Vali Acc: 0.460 Test Loss: 0.973 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.677685022354126
Epoch: 8, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.072 Vali Acc: 0.460 Test Loss: 1.072 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9529366493225098
Epoch: 9, Steps: 20 | Train Loss: 0.622 Vali Loss: 1.473 Vali Acc: 0.510 Test Loss: 1.473 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6489343643188477
Epoch: 10, Steps: 20 | Train Loss: 0.481 Vali Loss: 1.232 Vali Acc: 0.550 Test Loss: 1.232 Test Acc: 0.550
Validation loss decreased (-0.509991 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 1.8666467666625977
Epoch: 11, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.608 Vali Acc: 0.500 Test Loss: 1.608 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9205164909362793
Epoch: 12, Steps: 20 | Train Loss: 0.560 Vali Loss: 1.338 Vali Acc: 0.490 Test Loss: 1.338 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7619338035583496
Epoch: 13, Steps: 20 | Train Loss: 0.409 Vali Loss: 1.160 Vali Acc: 0.480 Test Loss: 1.160 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7130565643310547
Epoch: 14, Steps: 20 | Train Loss: 0.304 Vali Loss: 1.137 Vali Acc: 0.530 Test Loss: 1.137 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8529078960418701
Epoch: 15, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.358 Vali Acc: 0.440 Test Loss: 1.358 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.092111587524414
Epoch: 16, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.430 Vali Acc: 0.500 Test Loss: 1.430 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8180530071258545
Epoch: 17, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.587 Vali Acc: 0.570 Test Loss: 1.587 Test Acc: 0.570
Validation loss decreased (-0.549988 --> -0.569984).  Saving model ...
Epoch: 18 cost time: 1.8349225521087646
Epoch: 18, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.618 Vali Acc: 0.490 Test Loss: 1.618 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8303780555725098
Epoch: 19, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.462 Vali Acc: 0.490 Test Loss: 1.462 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9981460571289062
Epoch: 20, Steps: 20 | Train Loss: 0.234 Vali Loss: 1.667 Vali Acc: 0.480 Test Loss: 1.667 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8390040397644043
Epoch: 21, Steps: 20 | Train Loss: 0.186 Vali Loss: 1.540 Vali Acc: 0.490 Test Loss: 1.540 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5379679203033447
Epoch: 22, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.517 Vali Acc: 0.520 Test Loss: 1.517 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.853790521621704
Epoch: 23, Steps: 20 | Train Loss: 0.181 Vali Loss: 1.838 Vali Acc: 0.470 Test Loss: 1.838 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6793327331542969
Epoch: 24, Steps: 20 | Train Loss: 0.138 Vali Loss: 1.869 Vali Acc: 0.470 Test Loss: 1.869 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8924272060394287
Epoch: 25, Steps: 20 | Train Loss: 0.084 Vali Loss: 2.035 Vali Acc: 0.480 Test Loss: 2.035 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.525099515914917
Epoch: 26, Steps: 20 | Train Loss: 0.094 Vali Loss: 2.214 Vali Acc: 0.500 Test Loss: 2.214 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.0792481899261475
Epoch: 27, Steps: 20 | Train Loss: 0.129 Vali Loss: 2.089 Vali Acc: 0.470 Test Loss: 2.089 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 93634
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.454425811767578
Epoch: 1, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.3246145248413086
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.889 Vali Acc: 0.520 Test Loss: 0.889 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 1.368520736694336
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3034420013427734
Epoch: 4, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.877 Vali Acc: 0.490 Test Loss: 0.877 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.42755126953125
Epoch: 5, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 1.5441412925720215
Epoch: 6, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.851 Vali Acc: 0.540 Test Loss: 0.851 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539991).  Saving model ...
Epoch: 7 cost time: 1.568769931793213
Epoch: 7, Steps: 20 | Train Loss: 0.593 Vali Loss: 1.155 Vali Acc: 0.480 Test Loss: 1.155 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4583156108856201
Epoch: 8, Steps: 20 | Train Loss: 0.546 Vali Loss: 1.027 Vali Acc: 0.510 Test Loss: 1.027 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.545393705368042
Epoch: 9, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.888 Vali Acc: 0.520 Test Loss: 0.888 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6064791679382324
Epoch: 10, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.939 Vali Acc: 0.560 Test Loss: 0.939 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559991).  Saving model ...
Epoch: 11 cost time: 1.577373743057251
Epoch: 11, Steps: 20 | Train Loss: 0.346 Vali Loss: 0.982 Vali Acc: 0.580 Test Loss: 0.982 Test Acc: 0.580
Validation loss decreased (-0.559991 --> -0.579990).  Saving model ...
Epoch: 12 cost time: 1.5584840774536133
Epoch: 12, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.056 Vali Acc: 0.480 Test Loss: 1.056 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4317917823791504
Epoch: 13, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.137 Vali Acc: 0.550 Test Loss: 1.137 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6026849746704102
Epoch: 14, Steps: 20 | Train Loss: 0.395 Vali Loss: 1.152 Vali Acc: 0.510 Test Loss: 1.152 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5949056148529053
Epoch: 15, Steps: 20 | Train Loss: 0.325 Vali Loss: 1.227 Vali Acc: 0.510 Test Loss: 1.227 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7417113780975342
Epoch: 16, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.197 Vali Acc: 0.510 Test Loss: 1.197 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7259421348571777
Epoch: 17, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.330 Vali Acc: 0.500 Test Loss: 1.330 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7016746997833252
Epoch: 18, Steps: 20 | Train Loss: 0.237 Vali Loss: 1.291 Vali Acc: 0.540 Test Loss: 1.291 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5966858863830566
Epoch: 19, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.450 Vali Acc: 0.490 Test Loss: 1.450 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.547774076461792
Epoch: 20, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.689 Vali Acc: 0.500 Test Loss: 1.689 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7560930252075195
Epoch: 21, Steps: 20 | Train Loss: 0.443 Vali Loss: 1.408 Vali Acc: 0.520 Test Loss: 1.408 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 86594
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.294729232788086
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 1.5421264171600342
Epoch: 2, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.22003173828125
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4362339973449707
Epoch: 4, Steps: 20 | Train Loss: 0.697 Vali Loss: 1.094 Vali Acc: 0.520 Test Loss: 1.094 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3057668209075928
Epoch: 5, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.800 Vali Acc: 0.550 Test Loss: 0.800 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 1.1806435585021973
Epoch: 6, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.897 Vali Acc: 0.520 Test Loss: 0.897 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.455765724182129
Epoch: 7, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3264830112457275
Epoch: 8, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.903 Vali Acc: 0.490 Test Loss: 0.903 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2346761226654053
Epoch: 9, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.998 Vali Acc: 0.420 Test Loss: 0.998 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8429195880889893
Epoch: 10, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.941 Vali Acc: 0.560 Test Loss: 0.941 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 11 cost time: 1.6173768043518066
Epoch: 11, Steps: 20 | Train Loss: 0.471 Vali Loss: 1.021 Vali Acc: 0.560 Test Loss: 1.021 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5303640365600586
Epoch: 12, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.027 Vali Acc: 0.510 Test Loss: 1.027 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8319311141967773
Epoch: 13, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.943 Vali Acc: 0.560 Test Loss: 0.943 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5564463138580322
Epoch: 14, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.042 Vali Acc: 0.550 Test Loss: 1.042 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.874645709991455
Epoch: 15, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.263 Vali Acc: 0.470 Test Loss: 1.263 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6908226013183594
Epoch: 16, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.402 Vali Acc: 0.490 Test Loss: 1.402 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2869296073913574
Epoch: 17, Steps: 20 | Train Loss: 0.338 Vali Loss: 1.175 Vali Acc: 0.490 Test Loss: 1.175 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2579565048217773
Epoch: 18, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.154 Vali Acc: 0.550 Test Loss: 1.154 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5553691387176514
Epoch: 19, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.220 Vali Acc: 0.510 Test Loss: 1.220 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8235769271850586
Epoch: 20, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.203 Vali Acc: 0.470 Test Loss: 1.203 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 76034
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.762104034423828
Epoch: 1, Steps: 20 | Train Loss: 0.789 Vali Loss: 0.934 Vali Acc: 0.430 Test Loss: 0.934 Test Acc: 0.430
Validation loss decreased (inf --> -0.429991).  Saving model ...
Epoch: 2 cost time: 1.9130935668945312
Epoch: 2, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.930 Vali Acc: 0.520 Test Loss: 0.930 Test Acc: 0.520
Validation loss decreased (-0.429991 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 1.471635103225708
Epoch: 3, Steps: 20 | Train Loss: 0.880 Vali Loss: 1.314 Vali Acc: 0.510 Test Loss: 1.314 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5792176723480225
Epoch: 4, Steps: 20 | Train Loss: 0.758 Vali Loss: 1.291 Vali Acc: 0.490 Test Loss: 1.291 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0426783561706543
Epoch: 5, Steps: 20 | Train Loss: 0.880 Vali Loss: 2.062 Vali Acc: 0.530 Test Loss: 2.062 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529979).  Saving model ...
Epoch: 6 cost time: 1.8133454322814941
Epoch: 6, Steps: 20 | Train Loss: 1.117 Vali Loss: 2.201 Vali Acc: 0.480 Test Loss: 2.201 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.995309829711914
Epoch: 7, Steps: 20 | Train Loss: 0.966 Vali Loss: 3.216 Vali Acc: 0.520 Test Loss: 3.216 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.809953212738037
Epoch: 8, Steps: 20 | Train Loss: 1.379 Vali Loss: 2.743 Vali Acc: 0.500 Test Loss: 2.743 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7313735485076904
Epoch: 9, Steps: 20 | Train Loss: 0.951 Vali Loss: 2.512 Vali Acc: 0.500 Test Loss: 2.512 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.882833480834961
Epoch: 10, Steps: 20 | Train Loss: 1.082 Vali Loss: 4.258 Vali Acc: 0.510 Test Loss: 4.258 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.436100482940674
Epoch: 11, Steps: 20 | Train Loss: 0.826 Vali Loss: 2.566 Vali Acc: 0.500 Test Loss: 2.566 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.278177499771118
Epoch: 12, Steps: 20 | Train Loss: 0.751 Vali Loss: 3.039 Vali Acc: 0.580 Test Loss: 3.039 Test Acc: 0.580
Validation loss decreased (-0.529979 --> -0.579970).  Saving model ...
Epoch: 13 cost time: 2.03151535987854
Epoch: 13, Steps: 20 | Train Loss: 0.648 Vali Loss: 3.018 Vali Acc: 0.490 Test Loss: 3.018 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9252748489379883
Epoch: 14, Steps: 20 | Train Loss: 0.561 Vali Loss: 3.829 Vali Acc: 0.450 Test Loss: 3.829 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9393081665039062
Epoch: 15, Steps: 20 | Train Loss: 0.625 Vali Loss: 3.688 Vali Acc: 0.490 Test Loss: 3.688 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0427963733673096
Epoch: 16, Steps: 20 | Train Loss: 0.694 Vali Loss: 3.435 Vali Acc: 0.520 Test Loss: 3.435 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.019354820251465
Epoch: 17, Steps: 20 | Train Loss: 0.279 Vali Loss: 4.111 Vali Acc: 0.550 Test Loss: 4.111 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9968631267547607
Epoch: 18, Steps: 20 | Train Loss: 0.483 Vali Loss: 4.084 Vali Acc: 0.500 Test Loss: 4.084 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8139159679412842
Epoch: 19, Steps: 20 | Train Loss: 0.435 Vali Loss: 6.020 Vali Acc: 0.500 Test Loss: 6.020 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8186519145965576
Epoch: 20, Steps: 20 | Train Loss: 0.533 Vali Loss: 4.751 Vali Acc: 0.500 Test Loss: 4.751 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9471032619476318
Epoch: 21, Steps: 20 | Train Loss: 0.528 Vali Loss: 5.554 Vali Acc: 0.510 Test Loss: 5.554 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9619407653808594
Epoch: 22, Steps: 20 | Train Loss: 0.482 Vali Loss: 4.645 Vali Acc: 0.470 Test Loss: 4.645 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 212930
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7298824787139893
Epoch: 1, Steps: 20 | Train Loss: 0.822 Vali Loss: 0.964 Vali Acc: 0.520 Test Loss: 0.964 Test Acc: 0.520
Validation loss decreased (inf --> -0.519990).  Saving model ...
Epoch: 2 cost time: 1.5604641437530518
Epoch: 2, Steps: 20 | Train Loss: 0.829 Vali Loss: 1.026 Vali Acc: 0.480 Test Loss: 1.026 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8413898944854736
Epoch: 3, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.981 Vali Acc: 0.540 Test Loss: 0.981 Test Acc: 0.540
Validation loss decreased (-0.519990 --> -0.539990).  Saving model ...
Epoch: 4 cost time: 1.904127597808838
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.957 Vali Acc: 0.420 Test Loss: 0.957 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7102234363555908
Epoch: 5, Steps: 20 | Train Loss: 0.588 Vali Loss: 1.121 Vali Acc: 0.540 Test Loss: 1.121 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6140892505645752
Epoch: 6, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.992 Vali Acc: 0.540 Test Loss: 0.992 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6630115509033203
Epoch: 7, Steps: 20 | Train Loss: 0.677 Vali Loss: 1.311 Vali Acc: 0.450 Test Loss: 1.311 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9262471199035645
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 1.637 Vali Acc: 0.540 Test Loss: 1.637 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8528928756713867
Epoch: 9, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.379 Vali Acc: 0.510 Test Loss: 1.379 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5727217197418213
Epoch: 10, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.510 Vali Acc: 0.460 Test Loss: 1.510 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.636847734451294
Epoch: 11, Steps: 20 | Train Loss: 0.509 Vali Loss: 1.506 Vali Acc: 0.520 Test Loss: 1.506 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5786597728729248
Epoch: 12, Steps: 20 | Train Loss: 0.465 Vali Loss: 2.021 Vali Acc: 0.540 Test Loss: 2.021 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7247681617736816
Epoch: 13, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.709 Vali Acc: 0.480 Test Loss: 1.709 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 123394
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3119778633117676
Epoch: 1, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 1.6272826194763184
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5807678699493408
Epoch: 3, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.864 Vali Acc: 0.560 Test Loss: 0.864 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559991).  Saving model ...
Epoch: 4 cost time: 1.5046794414520264
Epoch: 4, Steps: 20 | Train Loss: 0.585 Vali Loss: 1.210 Vali Acc: 0.570 Test Loss: 1.210 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569988).  Saving model ...
Epoch: 5 cost time: 1.4103457927703857
Epoch: 5, Steps: 20 | Train Loss: 0.651 Vali Loss: 1.027 Vali Acc: 0.510 Test Loss: 1.027 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6429593563079834
Epoch: 6, Steps: 20 | Train Loss: 0.550 Vali Loss: 1.162 Vali Acc: 0.540 Test Loss: 1.162 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7531378269195557
Epoch: 7, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.215 Vali Acc: 0.460 Test Loss: 1.215 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.584531545639038
Epoch: 8, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.340 Vali Acc: 0.490 Test Loss: 1.340 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4840030670166016
Epoch: 9, Steps: 20 | Train Loss: 0.499 Vali Loss: 1.792 Vali Acc: 0.480 Test Loss: 1.792 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6028311252593994
Epoch: 10, Steps: 20 | Train Loss: 0.635 Vali Loss: 1.882 Vali Acc: 0.490 Test Loss: 1.882 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5784080028533936
Epoch: 11, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.455 Vali Acc: 0.540 Test Loss: 1.455 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5186254978179932
Epoch: 12, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.589 Vali Acc: 0.500 Test Loss: 1.589 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7677946090698242
Epoch: 13, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.758 Vali Acc: 0.590 Test Loss: 1.758 Test Acc: 0.590
Validation loss decreased (-0.569988 --> -0.589982).  Saving model ...
Epoch: 14 cost time: 1.4258341789245605
Epoch: 14, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.824 Vali Acc: 0.490 Test Loss: 1.824 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5246875286102295
Epoch: 15, Steps: 20 | Train Loss: 0.303 Vali Loss: 2.014 Vali Acc: 0.510 Test Loss: 2.014 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.64943528175354
Epoch: 16, Steps: 20 | Train Loss: 0.309 Vali Loss: 2.008 Vali Acc: 0.570 Test Loss: 2.008 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.568833351135254
Epoch: 17, Steps: 20 | Train Loss: 0.264 Vali Loss: 2.250 Vali Acc: 0.480 Test Loss: 2.250 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5507910251617432
Epoch: 18, Steps: 20 | Train Loss: 0.370 Vali Loss: 2.397 Vali Acc: 0.520 Test Loss: 2.397 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7051210403442383
Epoch: 19, Steps: 20 | Train Loss: 0.516 Vali Loss: 3.162 Vali Acc: 0.510 Test Loss: 3.162 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.432218313217163
Epoch: 20, Steps: 20 | Train Loss: 0.222 Vali Loss: 2.542 Vali Acc: 0.480 Test Loss: 2.542 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4040377140045166
Epoch: 21, Steps: 20 | Train Loss: 0.306 Vali Loss: 2.181 Vali Acc: 0.550 Test Loss: 2.181 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5620944499969482
Epoch: 22, Steps: 20 | Train Loss: 0.233 Vali Loss: 2.753 Vali Acc: 0.530 Test Loss: 2.753 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.509328842163086
Epoch: 23, Steps: 20 | Train Loss: 0.277 Vali Loss: 4.019 Vali Acc: 0.530 Test Loss: 4.019 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 123458
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6594889163970947
Epoch: 1, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.760 Vali Acc: 0.540 Test Loss: 0.760 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 1.9083292484283447
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549991).  Saving model ...
Epoch: 3 cost time: 1.8678762912750244
Epoch: 3, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.939 Vali Acc: 0.570 Test Loss: 0.939 Test Acc: 0.570
Validation loss decreased (-0.549991 --> -0.569991).  Saving model ...
Epoch: 4 cost time: 1.9301376342773438
Epoch: 4, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.852 Vali Acc: 0.530 Test Loss: 0.852 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.561795711517334
Epoch: 5, Steps: 20 | Train Loss: 0.598 Vali Loss: 1.136 Vali Acc: 0.470 Test Loss: 1.136 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5947792530059814
Epoch: 6, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.883 Vali Acc: 0.530 Test Loss: 0.883 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.771927833557129
Epoch: 7, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.113 Vali Acc: 0.440 Test Loss: 1.113 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9655652046203613
Epoch: 8, Steps: 20 | Train Loss: 0.544 Vali Loss: 1.497 Vali Acc: 0.480 Test Loss: 1.497 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7544167041778564
Epoch: 9, Steps: 20 | Train Loss: 0.566 Vali Loss: 1.363 Vali Acc: 0.450 Test Loss: 1.363 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.86527681350708
Epoch: 10, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.474 Vali Acc: 0.530 Test Loss: 1.474 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8885488510131836
Epoch: 11, Steps: 20 | Train Loss: 0.529 Vali Loss: 1.398 Vali Acc: 0.530 Test Loss: 1.398 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8948783874511719
Epoch: 12, Steps: 20 | Train Loss: 0.503 Vali Loss: 1.688 Vali Acc: 0.520 Test Loss: 1.688 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8180639743804932
Epoch: 13, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.612 Vali Acc: 0.470 Test Loss: 1.612 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 94850
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2594962120056152
Epoch: 1, Steps: 20 | Train Loss: 0.780 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.7784912586212158
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7765307426452637
Epoch: 3, Steps: 20 | Train Loss: 0.640 Vali Loss: 1.010 Vali Acc: 0.490 Test Loss: 1.010 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7050814628601074
Epoch: 4, Steps: 20 | Train Loss: 0.646 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8138453960418701
Epoch: 5, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.847 Vali Acc: 0.490 Test Loss: 0.847 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.100004196166992
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.937 Vali Acc: 0.460 Test Loss: 0.937 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9026365280151367
Epoch: 7, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.950 Vali Acc: 0.530 Test Loss: 0.950 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529991).  Saving model ...
Epoch: 8 cost time: 1.7539479732513428
Epoch: 8, Steps: 20 | Train Loss: 0.482 Vali Loss: 1.022 Vali Acc: 0.480 Test Loss: 1.022 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6599462032318115
Epoch: 9, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.253 Vali Acc: 0.460 Test Loss: 1.253 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1026151180267334
Epoch: 10, Steps: 20 | Train Loss: 0.456 Vali Loss: 1.043 Vali Acc: 0.480 Test Loss: 1.043 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.005646228790283
Epoch: 11, Steps: 20 | Train Loss: 0.415 Vali Loss: 1.076 Vali Acc: 0.500 Test Loss: 1.076 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.77610445022583
Epoch: 12, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.052 Vali Acc: 0.550 Test Loss: 1.052 Test Acc: 0.550
Validation loss decreased (-0.529991 --> -0.549989).  Saving model ...
Epoch: 13 cost time: 1.8389770984649658
Epoch: 13, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.319 Vali Acc: 0.490 Test Loss: 1.319 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.141840696334839
Epoch: 14, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.325 Vali Acc: 0.490 Test Loss: 1.325 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.804748773574829
Epoch: 15, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.316 Vali Acc: 0.450 Test Loss: 1.316 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8127009868621826
Epoch: 16, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.381 Vali Acc: 0.530 Test Loss: 1.381 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.919095516204834
Epoch: 17, Steps: 20 | Train Loss: 0.354 Vali Loss: 1.443 Vali Acc: 0.510 Test Loss: 1.443 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.026577949523926
Epoch: 18, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.349 Vali Acc: 0.490 Test Loss: 1.349 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9412708282470703
Epoch: 19, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.923 Vali Acc: 0.500 Test Loss: 1.923 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9750666618347168
Epoch: 20, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.581 Vali Acc: 0.470 Test Loss: 1.581 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9175655841827393
Epoch: 21, Steps: 20 | Train Loss: 0.237 Vali Loss: 1.360 Vali Acc: 0.520 Test Loss: 1.360 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.02756667137146
Epoch: 22, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.633 Vali Acc: 0.520 Test Loss: 1.633 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 77122
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.595426321029663
Epoch: 1, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.787736415863037
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.842 Vali Acc: 0.490 Test Loss: 0.842 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8883962631225586
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.806 Vali Acc: 0.540 Test Loss: 0.806 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 1.841019630432129
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.861 Vali Acc: 0.510 Test Loss: 0.861 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0353684425354004
Epoch: 5, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.986 Vali Acc: 0.520 Test Loss: 0.986 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9751536846160889
Epoch: 6, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.988 Vali Acc: 0.480 Test Loss: 0.988 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0255672931671143
Epoch: 7, Steps: 20 | Train Loss: 0.571 Vali Loss: 1.056 Vali Acc: 0.480 Test Loss: 1.056 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8902721405029297
Epoch: 8, Steps: 20 | Train Loss: 0.566 Vali Loss: 1.171 Vali Acc: 0.540 Test Loss: 1.171 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.165785312652588
Epoch: 9, Steps: 20 | Train Loss: 0.550 Vali Loss: 1.026 Vali Acc: 0.470 Test Loss: 1.026 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.999511480331421
Epoch: 10, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.956 Vali Acc: 0.510 Test Loss: 0.956 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.112046957015991
Epoch: 11, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.167 Vali Acc: 0.460 Test Loss: 1.167 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.47031569480896
Epoch: 12, Steps: 20 | Train Loss: 0.464 Vali Loss: 1.226 Vali Acc: 0.460 Test Loss: 1.226 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6046924591064453
Epoch: 13, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.058 Vali Acc: 0.560 Test Loss: 1.058 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559989).  Saving model ...
Epoch: 14 cost time: 1.6350860595703125
Epoch: 14, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.078 Vali Acc: 0.520 Test Loss: 1.078 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6071181297302246
Epoch: 15, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.155 Vali Acc: 0.540 Test Loss: 1.155 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5364863872528076
Epoch: 16, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.228 Vali Acc: 0.510 Test Loss: 1.228 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9096271991729736
Epoch: 17, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.431 Vali Acc: 0.530 Test Loss: 1.431 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8698310852050781
Epoch: 18, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.444 Vali Acc: 0.560 Test Loss: 1.444 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9604837894439697
Epoch: 19, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.342 Vali Acc: 0.500 Test Loss: 1.342 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.103039503097534
Epoch: 20, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.751 Vali Acc: 0.540 Test Loss: 1.751 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.938859462738037
Epoch: 21, Steps: 20 | Train Loss: 0.476 Vali Loss: 1.440 Vali Acc: 0.500 Test Loss: 1.440 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8730952739715576
Epoch: 22, Steps: 20 | Train Loss: 0.319 Vali Loss: 1.586 Vali Acc: 0.500 Test Loss: 1.586 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6129136085510254
Epoch: 23, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.531 Vali Acc: 0.510 Test Loss: 1.531 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 70082
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6133415699005127
Epoch: 1, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.6376543045043945
Epoch: 2, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9085195064544678
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9015567302703857
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.928 Vali Acc: 0.490 Test Loss: 0.928 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7821390628814697
Epoch: 5, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.844 Vali Acc: 0.440 Test Loss: 0.844 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5597267150878906
Epoch: 6, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.832 Vali Acc: 0.480 Test Loss: 0.832 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6901676654815674
Epoch: 7, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.931 Vali Acc: 0.590 Test Loss: 0.931 Test Acc: 0.590
Validation loss decreased (-0.509992 --> -0.589991).  Saving model ...
Epoch: 8 cost time: 1.7271621227264404
Epoch: 8, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.849 Vali Acc: 0.520 Test Loss: 0.849 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5105080604553223
Epoch: 9, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.937 Vali Acc: 0.540 Test Loss: 0.937 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7808072566986084
Epoch: 10, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.964 Vali Acc: 0.450 Test Loss: 0.964 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6963539123535156
Epoch: 11, Steps: 20 | Train Loss: 0.518 Vali Loss: 1.132 Vali Acc: 0.470 Test Loss: 1.132 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6479101181030273
Epoch: 12, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.985 Vali Acc: 0.590 Test Loss: 0.985 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7081952095031738
Epoch: 13, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.972 Vali Acc: 0.520 Test Loss: 0.972 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6855568885803223
Epoch: 14, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.091 Vali Acc: 0.480 Test Loss: 1.091 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.902801275253296
Epoch: 15, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.025 Vali Acc: 0.570 Test Loss: 1.025 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.590144395828247
Epoch: 16, Steps: 20 | Train Loss: 0.319 Vali Loss: 1.078 Vali Acc: 0.460 Test Loss: 1.078 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8927075862884521
Epoch: 17, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.151 Vali Acc: 0.560 Test Loss: 1.151 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 59522
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.224454402923584
Epoch: 1, Steps: 20 | Train Loss: 0.832 Vali Loss: 0.934 Vali Acc: 0.450 Test Loss: 0.934 Test Acc: 0.450
Validation loss decreased (inf --> -0.449991).  Saving model ...
Epoch: 2 cost time: 2.2834854125976562
Epoch: 2, Steps: 20 | Train Loss: 1.295 Vali Loss: 1.837 Vali Acc: 0.500 Test Loss: 1.837 Test Acc: 0.500
Validation loss decreased (-0.449991 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 2.3346877098083496
Epoch: 3, Steps: 20 | Train Loss: 1.048 Vali Loss: 2.298 Vali Acc: 0.500 Test Loss: 2.298 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0971388816833496
Epoch: 4, Steps: 20 | Train Loss: 1.215 Vali Loss: 2.524 Vali Acc: 0.490 Test Loss: 2.524 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.158665895462036
Epoch: 5, Steps: 20 | Train Loss: 0.812 Vali Loss: 2.175 Vali Acc: 0.560 Test Loss: 2.175 Test Acc: 0.560
Validation loss decreased (-0.499982 --> -0.559978).  Saving model ...
Epoch: 6 cost time: 2.215137481689453
Epoch: 6, Steps: 20 | Train Loss: 0.885 Vali Loss: 2.162 Vali Acc: 0.470 Test Loss: 2.162 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1117992401123047
Epoch: 7, Steps: 20 | Train Loss: 0.855 Vali Loss: 2.161 Vali Acc: 0.550 Test Loss: 2.161 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3637943267822266
Epoch: 8, Steps: 20 | Train Loss: 0.995 Vali Loss: 1.821 Vali Acc: 0.550 Test Loss: 1.821 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2841708660125732
Epoch: 9, Steps: 20 | Train Loss: 1.645 Vali Loss: 4.538 Vali Acc: 0.550 Test Loss: 4.538 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.505354166030884
Epoch: 10, Steps: 20 | Train Loss: 0.960 Vali Loss: 2.316 Vali Acc: 0.540 Test Loss: 2.316 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.326690435409546
Epoch: 11, Steps: 20 | Train Loss: 1.038 Vali Loss: 3.510 Vali Acc: 0.570 Test Loss: 3.510 Test Acc: 0.570
Validation loss decreased (-0.559978 --> -0.569965).  Saving model ...
Epoch: 12 cost time: 2.4143834114074707
Epoch: 12, Steps: 20 | Train Loss: 1.537 Vali Loss: 4.031 Vali Acc: 0.450 Test Loss: 4.031 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4061055183410645
Epoch: 13, Steps: 20 | Train Loss: 0.498 Vali Loss: 2.657 Vali Acc: 0.540 Test Loss: 2.657 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4526641368865967
Epoch: 14, Steps: 20 | Train Loss: 0.596 Vali Loss: 2.719 Vali Acc: 0.530 Test Loss: 2.719 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2216761112213135
Epoch: 15, Steps: 20 | Train Loss: 0.354 Vali Loss: 3.427 Vali Acc: 0.540 Test Loss: 3.427 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.274350881576538
Epoch: 16, Steps: 20 | Train Loss: 0.619 Vali Loss: 3.605 Vali Acc: 0.520 Test Loss: 3.605 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.37371826171875
Epoch: 17, Steps: 20 | Train Loss: 0.373 Vali Loss: 3.255 Vali Acc: 0.520 Test Loss: 3.255 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1510093212127686
Epoch: 18, Steps: 20 | Train Loss: 0.225 Vali Loss: 3.825 Vali Acc: 0.460 Test Loss: 3.825 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2323482036590576
Epoch: 19, Steps: 20 | Train Loss: 0.277 Vali Loss: 3.866 Vali Acc: 0.540 Test Loss: 3.866 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.363558769226074
Epoch: 20, Steps: 20 | Train Loss: 0.456 Vali Loss: 5.250 Vali Acc: 0.500 Test Loss: 5.250 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.497163772583008
Epoch: 21, Steps: 20 | Train Loss: 0.329 Vali Loss: 3.545 Vali Acc: 0.540 Test Loss: 3.545 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 204674
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.663360118865967
Epoch: 1, Steps: 20 | Train Loss: 0.850 Vali Loss: 1.018 Vali Acc: 0.480 Test Loss: 1.018 Test Acc: 0.480
Validation loss decreased (inf --> -0.479990).  Saving model ...
Epoch: 2 cost time: 1.9366986751556396
Epoch: 2, Steps: 20 | Train Loss: 0.801 Vali Loss: 0.989 Vali Acc: 0.520 Test Loss: 0.989 Test Acc: 0.520
Validation loss decreased (-0.479990 --> -0.519990).  Saving model ...
Epoch: 3 cost time: 2.215548515319824
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.895 Vali Acc: 0.510 Test Loss: 0.895 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9407782554626465
Epoch: 4, Steps: 20 | Train Loss: 0.625 Vali Loss: 1.127 Vali Acc: 0.490 Test Loss: 1.127 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.172605514526367
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 1.022 Vali Acc: 0.490 Test Loss: 1.022 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9777772426605225
Epoch: 6, Steps: 20 | Train Loss: 0.564 Vali Loss: 1.129 Vali Acc: 0.460 Test Loss: 1.129 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0383050441741943
Epoch: 7, Steps: 20 | Train Loss: 0.584 Vali Loss: 1.283 Vali Acc: 0.540 Test Loss: 1.283 Test Acc: 0.540
Validation loss decreased (-0.519990 --> -0.539987).  Saving model ...
Epoch: 8 cost time: 1.8591632843017578
Epoch: 8, Steps: 20 | Train Loss: 0.627 Vali Loss: 1.301 Vali Acc: 0.570 Test Loss: 1.301 Test Acc: 0.570
Validation loss decreased (-0.539987 --> -0.569987).  Saving model ...
Epoch: 9 cost time: 2.134371280670166
Epoch: 9, Steps: 20 | Train Loss: 0.591 Vali Loss: 1.411 Vali Acc: 0.600 Test Loss: 1.411 Test Acc: 0.600
Validation loss decreased (-0.569987 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 1.852828025817871
Epoch: 10, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.649 Vali Acc: 0.550 Test Loss: 1.649 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.240675687789917
Epoch: 11, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.500 Vali Acc: 0.520 Test Loss: 1.500 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.125486135482788
Epoch: 12, Steps: 20 | Train Loss: 0.427 Vali Loss: 1.728 Vali Acc: 0.460 Test Loss: 1.728 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1453213691711426
Epoch: 13, Steps: 20 | Train Loss: 0.504 Vali Loss: 1.785 Vali Acc: 0.520 Test Loss: 1.785 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9942889213562012
Epoch: 14, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.832 Vali Acc: 0.450 Test Loss: 1.832 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1658072471618652
Epoch: 15, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.887 Vali Acc: 0.550 Test Loss: 1.887 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9112458229064941
Epoch: 16, Steps: 20 | Train Loss: 0.262 Vali Loss: 2.138 Vali Acc: 0.480 Test Loss: 2.138 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.039956569671631
Epoch: 17, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.915 Vali Acc: 0.560 Test Loss: 1.915 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9444324970245361
Epoch: 18, Steps: 20 | Train Loss: 0.244 Vali Loss: 2.924 Vali Acc: 0.510 Test Loss: 2.924 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8160839080810547
Epoch: 19, Steps: 20 | Train Loss: 0.218 Vali Loss: 2.314 Vali Acc: 0.480 Test Loss: 2.314 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 115138
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.740396022796631
Epoch: 1, Steps: 20 | Train Loss: 0.815 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.8433473110198975
Epoch: 2, Steps: 20 | Train Loss: 0.787 Vali Loss: 0.929 Vali Acc: 0.580 Test Loss: 0.929 Test Acc: 0.580
Validation loss decreased (-0.519992 --> -0.579991).  Saving model ...
Epoch: 3 cost time: 1.9666197299957275
Epoch: 3, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.900 Vali Acc: 0.540 Test Loss: 0.900 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9585566520690918
Epoch: 4, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.989 Vali Acc: 0.480 Test Loss: 0.989 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0170345306396484
Epoch: 5, Steps: 20 | Train Loss: 0.711 Vali Loss: 1.172 Vali Acc: 0.450 Test Loss: 1.172 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1763525009155273
Epoch: 6, Steps: 20 | Train Loss: 0.572 Vali Loss: 1.228 Vali Acc: 0.550 Test Loss: 1.228 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.110971450805664
Epoch: 7, Steps: 20 | Train Loss: 0.530 Vali Loss: 1.217 Vali Acc: 0.510 Test Loss: 1.217 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1333789825439453
Epoch: 8, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.402 Vali Acc: 0.500 Test Loss: 1.402 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.924971342086792
Epoch: 9, Steps: 20 | Train Loss: 0.419 Vali Loss: 1.546 Vali Acc: 0.470 Test Loss: 1.546 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.094747304916382
Epoch: 10, Steps: 20 | Train Loss: 0.405 Vali Loss: 2.019 Vali Acc: 0.460 Test Loss: 2.019 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9187309741973877
Epoch: 11, Steps: 20 | Train Loss: 0.412 Vali Loss: 1.381 Vali Acc: 0.460 Test Loss: 1.381 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.084332227706909
Epoch: 12, Steps: 20 | Train Loss: 0.325 Vali Loss: 1.900 Vali Acc: 0.460 Test Loss: 1.900 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 115202
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.535130023956299
Epoch: 1, Steps: 20 | Train Loss: 0.834 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 2.0482139587402344
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 1.078 Vali Acc: 0.490 Test Loss: 1.078 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9533658027648926
Epoch: 3, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.832 Vali Acc: 0.470 Test Loss: 0.832 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6736512184143066
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.947 Vali Acc: 0.500 Test Loss: 0.947 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7331538200378418
Epoch: 5, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.914 Vali Acc: 0.550 Test Loss: 0.914 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 1.715005874633789
Epoch: 6, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.893 Vali Acc: 0.480 Test Loss: 0.893 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6133477687835693
Epoch: 7, Steps: 20 | Train Loss: 0.530 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.025745391845703
Epoch: 8, Steps: 20 | Train Loss: 0.495 Vali Loss: 1.116 Vali Acc: 0.460 Test Loss: 1.116 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7128255367279053
Epoch: 9, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.103 Vali Acc: 0.480 Test Loss: 1.103 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.018754720687866
Epoch: 10, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.582 Vali Acc: 0.560 Test Loss: 1.582 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559984).  Saving model ...
Epoch: 11 cost time: 1.9325270652770996
Epoch: 11, Steps: 20 | Train Loss: 0.503 Vali Loss: 1.345 Vali Acc: 0.450 Test Loss: 1.345 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8343255519866943
Epoch: 12, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.200 Vali Acc: 0.470 Test Loss: 1.200 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9504952430725098
Epoch: 13, Steps: 20 | Train Loss: 0.418 Vali Loss: 1.436 Vali Acc: 0.490 Test Loss: 1.436 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9546451568603516
Epoch: 14, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.577 Vali Acc: 0.500 Test Loss: 1.577 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.048701286315918
Epoch: 15, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.934 Vali Acc: 0.470 Test Loss: 1.934 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8452537059783936
Epoch: 16, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.634 Vali Acc: 0.530 Test Loss: 1.634 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0092735290527344
Epoch: 17, Steps: 20 | Train Loss: 0.231 Vali Loss: 1.754 Vali Acc: 0.490 Test Loss: 1.754 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.992678165435791
Epoch: 18, Steps: 20 | Train Loss: 0.275 Vali Loss: 1.779 Vali Acc: 0.510 Test Loss: 1.779 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.794351577758789
Epoch: 19, Steps: 20 | Train Loss: 0.311 Vali Loss: 2.286 Vali Acc: 0.520 Test Loss: 2.286 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.2196807861328125
Epoch: 20, Steps: 20 | Train Loss: 0.247 Vali Loss: 2.605 Vali Acc: 0.490 Test Loss: 2.605 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 86594
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.547255039215088
Epoch: 1, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.879 Vali Acc: 0.490 Test Loss: 0.879 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 1.6558637619018555
Epoch: 2, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.794 Vali Acc: 0.460 Test Loss: 0.794 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4608314037322998
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.946 Vali Acc: 0.520 Test Loss: 0.946 Test Acc: 0.520
Validation loss decreased (-0.489991 --> -0.519991).  Saving model ...
Epoch: 4 cost time: 1.6635375022888184
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.955 Vali Acc: 0.490 Test Loss: 0.955 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4224650859832764
Epoch: 5, Steps: 20 | Train Loss: 0.604 Vali Loss: 1.161 Vali Acc: 0.510 Test Loss: 1.161 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4884357452392578
Epoch: 6, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.954 Vali Acc: 0.420 Test Loss: 0.954 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5147392749786377
Epoch: 7, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.091 Vali Acc: 0.480 Test Loss: 1.091 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6364758014678955
Epoch: 8, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.938 Vali Acc: 0.530 Test Loss: 0.938 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529991).  Saving model ...
Epoch: 9 cost time: 1.5288329124450684
Epoch: 9, Steps: 20 | Train Loss: 0.459 Vali Loss: 1.039 Vali Acc: 0.530 Test Loss: 1.039 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5786857604980469
Epoch: 10, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.210 Vali Acc: 0.520 Test Loss: 1.210 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4648923873901367
Epoch: 11, Steps: 20 | Train Loss: 0.468 Vali Loss: 1.048 Vali Acc: 0.520 Test Loss: 1.048 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7857558727264404
Epoch: 12, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.039 Vali Acc: 0.510 Test Loss: 1.039 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5466012954711914
Epoch: 13, Steps: 20 | Train Loss: 0.456 Vali Loss: 1.475 Vali Acc: 0.540 Test Loss: 1.475 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539985).  Saving model ...
Epoch: 14 cost time: 1.5807793140411377
Epoch: 14, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.311 Vali Acc: 0.510 Test Loss: 1.311 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6149890422821045
Epoch: 15, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.645 Vali Acc: 0.500 Test Loss: 1.645 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5485994815826416
Epoch: 16, Steps: 20 | Train Loss: 0.415 Vali Loss: 1.463 Vali Acc: 0.500 Test Loss: 1.463 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6054754257202148
Epoch: 17, Steps: 20 | Train Loss: 0.378 Vali Loss: 1.371 Vali Acc: 0.530 Test Loss: 1.371 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3464601039886475
Epoch: 18, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.590 Vali Acc: 0.510 Test Loss: 1.590 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5233232975006104
Epoch: 19, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.391 Vali Acc: 0.540 Test Loss: 1.391 Test Acc: 0.540
Validation loss decreased (-0.539985 --> -0.539986).  Saving model ...
Epoch: 20 cost time: 1.681760311126709
Epoch: 20, Steps: 20 | Train Loss: 0.224 Vali Loss: 1.521 Vali Acc: 0.510 Test Loss: 1.521 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.703324317932129
Epoch: 21, Steps: 20 | Train Loss: 0.209 Vali Loss: 1.390 Vali Acc: 0.540 Test Loss: 1.390 Test Acc: 0.540
Validation loss decreased (-0.539986 --> -0.539986).  Saving model ...
Epoch: 22 cost time: 1.4836058616638184
Epoch: 22, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.964 Vali Acc: 0.500 Test Loss: 1.964 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7701315879821777
Epoch: 23, Steps: 20 | Train Loss: 0.295 Vali Loss: 2.149 Vali Acc: 0.540 Test Loss: 2.149 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5728175640106201
Epoch: 24, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.746 Vali Acc: 0.490 Test Loss: 1.746 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6600615978240967
Epoch: 25, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.656 Vali Acc: 0.490 Test Loss: 1.656 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5695433616638184
Epoch: 26, Steps: 20 | Train Loss: 0.313 Vali Loss: 2.057 Vali Acc: 0.560 Test Loss: 2.057 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559979).  Saving model ...
Epoch: 27 cost time: 1.492952585220337
Epoch: 27, Steps: 20 | Train Loss: 0.362 Vali Loss: 2.469 Vali Acc: 0.510 Test Loss: 2.469 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.528944969177246
Epoch: 28, Steps: 20 | Train Loss: 0.244 Vali Loss: 2.238 Vali Acc: 0.470 Test Loss: 2.238 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5685367584228516
Epoch: 29, Steps: 20 | Train Loss: 0.158 Vali Loss: 2.273 Vali Acc: 0.510 Test Loss: 2.273 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4244773387908936
Epoch: 30, Steps: 20 | Train Loss: 0.156 Vali Loss: 2.165 Vali Acc: 0.490 Test Loss: 2.165 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4564249515533447
Epoch: 31, Steps: 20 | Train Loss: 0.103 Vali Loss: 2.216 Vali Acc: 0.480 Test Loss: 2.216 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5950863361358643
Epoch: 32, Steps: 20 | Train Loss: 0.217 Vali Loss: 2.275 Vali Acc: 0.540 Test Loss: 2.275 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.698683500289917
Epoch: 33, Steps: 20 | Train Loss: 0.136 Vali Loss: 2.908 Vali Acc: 0.520 Test Loss: 2.908 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6610982418060303
Epoch: 34, Steps: 20 | Train Loss: 0.125 Vali Loss: 2.166 Vali Acc: 0.530 Test Loss: 2.166 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.7425711154937744
Epoch: 35, Steps: 20 | Train Loss: 0.098 Vali Loss: 2.644 Vali Acc: 0.510 Test Loss: 2.644 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.7178785800933838
Epoch: 36, Steps: 20 | Train Loss: 0.134 Vali Loss: 2.496 Vali Acc: 0.470 Test Loss: 2.496 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 68866
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3486082553863525
Epoch: 1, Steps: 20 | Train Loss: 0.770 Vali Loss: 0.732 Vali Acc: 0.560 Test Loss: 0.732 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.4366562366485596
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.842 Vali Acc: 0.540 Test Loss: 0.842 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6434335708618164
Epoch: 3, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.894 Vali Acc: 0.520 Test Loss: 0.894 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.470395803451538
Epoch: 4, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.830 Vali Acc: 0.450 Test Loss: 0.830 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.403963327407837
Epoch: 5, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.925 Vali Acc: 0.560 Test Loss: 0.925 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.626657247543335
Epoch: 6, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.910 Vali Acc: 0.550 Test Loss: 0.910 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.309457540512085
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.906 Vali Acc: 0.560 Test Loss: 0.906 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.252434492111206
Epoch: 8, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.938 Vali Acc: 0.450 Test Loss: 0.938 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2603952884674072
Epoch: 9, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.874 Vali Acc: 0.600 Test Loss: 0.874 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599991).  Saving model ...
Epoch: 10 cost time: 1.3305296897888184
Epoch: 10, Steps: 20 | Train Loss: 0.502 Vali Loss: 1.055 Vali Acc: 0.500 Test Loss: 1.055 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2582075595855713
Epoch: 11, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.049 Vali Acc: 0.480 Test Loss: 1.049 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.300586462020874
Epoch: 12, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.642 Vali Acc: 0.490 Test Loss: 1.642 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.919825792312622
Epoch: 13, Steps: 20 | Train Loss: 0.495 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8349995613098145
Epoch: 14, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.316 Vali Acc: 0.490 Test Loss: 1.316 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9461805820465088
Epoch: 15, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.327 Vali Acc: 0.550 Test Loss: 1.327 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6290984153747559
Epoch: 16, Steps: 20 | Train Loss: 0.404 Vali Loss: 1.377 Vali Acc: 0.510 Test Loss: 1.377 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7841827869415283
Epoch: 17, Steps: 20 | Train Loss: 0.381 Vali Loss: 1.329 Vali Acc: 0.490 Test Loss: 1.329 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4652326107025146
Epoch: 18, Steps: 20 | Train Loss: 0.341 Vali Loss: 1.265 Vali Acc: 0.510 Test Loss: 1.265 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.489539384841919
Epoch: 19, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.575 Vali Acc: 0.510 Test Loss: 1.575 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 61826
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5028655529022217
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.571763277053833
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3033921718597412
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.807 Vali Acc: 0.480 Test Loss: 0.807 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.70151686668396
Epoch: 4, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.833 Vali Acc: 0.520 Test Loss: 0.833 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8308336734771729
Epoch: 5, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.982 Vali Acc: 0.550 Test Loss: 0.982 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549990).  Saving model ...
Epoch: 6 cost time: 1.7412402629852295
Epoch: 6, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.884 Vali Acc: 0.550 Test Loss: 0.884 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549991).  Saving model ...
Epoch: 7 cost time: 1.2651231288909912
Epoch: 7, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5764234066009521
Epoch: 8, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.011 Vali Acc: 0.530 Test Loss: 1.011 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.547130823135376
Epoch: 9, Steps: 20 | Train Loss: 0.508 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6053743362426758
Epoch: 10, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.009 Vali Acc: 0.550 Test Loss: 1.009 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.609443187713623
Epoch: 11, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.142 Vali Acc: 0.520 Test Loss: 1.142 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6275594234466553
Epoch: 12, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.879 Vali Acc: 0.490 Test Loss: 0.879 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1979312896728516
Epoch: 13, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.104 Vali Acc: 0.540 Test Loss: 1.104 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.273534059524536
Epoch: 14, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.295 Vali Acc: 0.490 Test Loss: 1.295 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8901114463806152
Epoch: 15, Steps: 20 | Train Loss: 0.415 Vali Loss: 1.102 Vali Acc: 0.520 Test Loss: 1.102 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.917625904083252
Epoch: 16, Steps: 20 | Train Loss: 0.415 Vali Loss: 1.197 Vali Acc: 0.550 Test Loss: 1.197 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm64_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 51266
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5693397521972656
Epoch: 1, Steps: 20 | Train Loss: 0.792 Vali Loss: 0.827 Vali Acc: 0.460 Test Loss: 0.827 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.7280831336975098
Epoch: 2, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
Validation loss decreased (-0.459992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 1.716477632522583
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 1.216 Vali Acc: 0.510 Test Loss: 1.216 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.114248037338257
Epoch: 4, Steps: 20 | Train Loss: 0.747 Vali Loss: 1.615 Vali Acc: 0.490 Test Loss: 1.615 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7445271015167236
Epoch: 5, Steps: 20 | Train Loss: 0.698 Vali Loss: 1.120 Vali Acc: 0.520 Test Loss: 1.120 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8022637367248535
Epoch: 6, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.920 Vali Acc: 0.480 Test Loss: 0.920 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.07627010345459
Epoch: 7, Steps: 20 | Train Loss: 0.728 Vali Loss: 1.285 Vali Acc: 0.570 Test Loss: 1.285 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569987).  Saving model ...
Epoch: 8 cost time: 1.7920029163360596
Epoch: 8, Steps: 20 | Train Loss: 0.623 Vali Loss: 2.099 Vali Acc: 0.530 Test Loss: 2.099 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4534099102020264
Epoch: 9, Steps: 20 | Train Loss: 0.664 Vali Loss: 3.055 Vali Acc: 0.530 Test Loss: 3.055 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.008270263671875
Epoch: 10, Steps: 20 | Train Loss: 0.482 Vali Loss: 1.185 Vali Acc: 0.510 Test Loss: 1.185 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.900808572769165
Epoch: 11, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.607 Vali Acc: 0.510 Test Loss: 1.607 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.035244941711426
Epoch: 12, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.911 Vali Acc: 0.530 Test Loss: 1.911 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6556425094604492
Epoch: 13, Steps: 20 | Train Loss: 0.506 Vali Loss: 2.266 Vali Acc: 0.500 Test Loss: 2.266 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.839895248413086
Epoch: 14, Steps: 20 | Train Loss: 0.502 Vali Loss: 1.910 Vali Acc: 0.510 Test Loss: 1.910 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.085925579071045
Epoch: 15, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.736 Vali Acc: 0.550 Test Loss: 1.736 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7707929611206055
Epoch: 16, Steps: 20 | Train Loss: 0.182 Vali Loss: 2.723 Vali Acc: 0.540 Test Loss: 2.723 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8526453971862793
Epoch: 17, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.924 Vali Acc: 0.470 Test Loss: 1.924 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 110754
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3925344944000244
Epoch: 1, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.4795863628387451
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.840 Vali Acc: 0.520 Test Loss: 0.840 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 1.5160043239593506
Epoch: 3, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.791 Vali Acc: 0.560 Test Loss: 0.791 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 1.3770809173583984
Epoch: 4, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.906 Vali Acc: 0.480 Test Loss: 0.906 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6954834461212158
Epoch: 5, Steps: 20 | Train Loss: 0.564 Vali Loss: 1.029 Vali Acc: 0.500 Test Loss: 1.029 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6034190654754639
Epoch: 6, Steps: 20 | Train Loss: 0.692 Vali Loss: 1.189 Vali Acc: 0.480 Test Loss: 1.189 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6570918560028076
Epoch: 7, Steps: 20 | Train Loss: 0.565 Vali Loss: 1.031 Vali Acc: 0.450 Test Loss: 1.031 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9464023113250732
Epoch: 8, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.978 Vali Acc: 0.510 Test Loss: 0.978 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.657806158065796
Epoch: 9, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.002 Vali Acc: 0.390 Test Loss: 1.002 Test Acc: 0.390
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.643043041229248
Epoch: 10, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.108 Vali Acc: 0.480 Test Loss: 1.108 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.684403419494629
Epoch: 11, Steps: 20 | Train Loss: 0.344 Vali Loss: 1.108 Vali Acc: 0.450 Test Loss: 1.108 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.06575608253479
Epoch: 12, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.148 Vali Acc: 0.520 Test Loss: 1.148 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7506999969482422
Epoch: 13, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.471 Vali Acc: 0.500 Test Loss: 1.471 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 65986
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.601959466934204
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.890 Vali Acc: 0.460 Test Loss: 0.890 Test Acc: 0.460
Validation loss decreased (inf --> -0.459991).  Saving model ...
Epoch: 2 cost time: 1.6884772777557373
Epoch: 2, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.881 Vali Acc: 0.520 Test Loss: 0.881 Test Acc: 0.520
Validation loss decreased (-0.459991 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 1.2142460346221924
Epoch: 3, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.995 Vali Acc: 0.440 Test Loss: 0.995 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.484060525894165
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.841 Vali Acc: 0.460 Test Loss: 0.841 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5786991119384766
Epoch: 5, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.907 Vali Acc: 0.450 Test Loss: 0.907 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5526366233825684
Epoch: 6, Steps: 20 | Train Loss: 0.584 Vali Loss: 1.278 Vali Acc: 0.520 Test Loss: 1.278 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5774075984954834
Epoch: 7, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.964 Vali Acc: 0.530 Test Loss: 0.964 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529990).  Saving model ...
Epoch: 8 cost time: 1.7098968029022217
Epoch: 8, Steps: 20 | Train Loss: 0.440 Vali Loss: 1.145 Vali Acc: 0.480 Test Loss: 1.145 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6424434185028076
Epoch: 9, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.164 Vali Acc: 0.470 Test Loss: 1.164 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7624390125274658
Epoch: 10, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.212 Vali Acc: 0.510 Test Loss: 1.212 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7826740741729736
Epoch: 11, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.236 Vali Acc: 0.450 Test Loss: 1.236 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.774099588394165
Epoch: 12, Steps: 20 | Train Loss: 0.419 Vali Loss: 1.202 Vali Acc: 0.540 Test Loss: 1.202 Test Acc: 0.540
Validation loss decreased (-0.529990 --> -0.539988).  Saving model ...
Epoch: 13 cost time: 1.7475287914276123
Epoch: 13, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6655843257904053
Epoch: 14, Steps: 20 | Train Loss: 0.258 Vali Loss: 1.411 Vali Acc: 0.440 Test Loss: 1.411 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7104475498199463
Epoch: 15, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.879 Vali Acc: 0.520 Test Loss: 1.879 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4937748908996582
Epoch: 16, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.729 Vali Acc: 0.480 Test Loss: 1.729 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.696535348892212
Epoch: 17, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.640 Vali Acc: 0.500 Test Loss: 1.640 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5861239433288574
Epoch: 18, Steps: 20 | Train Loss: 0.129 Vali Loss: 1.599 Vali Acc: 0.480 Test Loss: 1.599 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6209239959716797
Epoch: 19, Steps: 20 | Train Loss: 0.159 Vali Loss: 1.532 Vali Acc: 0.520 Test Loss: 1.532 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.621324062347412
Epoch: 20, Steps: 20 | Train Loss: 0.159 Vali Loss: 2.248 Vali Acc: 0.480 Test Loss: 2.248 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5447027683258057
Epoch: 21, Steps: 20 | Train Loss: 0.210 Vali Loss: 1.839 Vali Acc: 0.470 Test Loss: 1.839 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.37056303024292
Epoch: 22, Steps: 20 | Train Loss: 0.097 Vali Loss: 1.847 Vali Acc: 0.490 Test Loss: 1.847 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 66018
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.461278200149536
Epoch: 1, Steps: 20 | Train Loss: 0.793 Vali Loss: 0.883 Vali Acc: 0.520 Test Loss: 0.883 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 1.5138859748840332
Epoch: 2, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.813 Vali Acc: 0.510 Test Loss: 0.813 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.540884017944336
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.798 Vali Acc: 0.500 Test Loss: 0.798 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5086073875427246
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.925 Vali Acc: 0.500 Test Loss: 0.925 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.483952522277832
Epoch: 5, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.952 Vali Acc: 0.470 Test Loss: 0.952 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.758085012435913
Epoch: 6, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.863 Vali Acc: 0.510 Test Loss: 0.863 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5913152694702148
Epoch: 7, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.865 Vali Acc: 0.480 Test Loss: 0.865 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4326794147491455
Epoch: 8, Steps: 20 | Train Loss: 0.470 Vali Loss: 1.079 Vali Acc: 0.520 Test Loss: 1.079 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5282912254333496
Epoch: 9, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.905 Vali Acc: 0.520 Test Loss: 0.905 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4990296363830566
Epoch: 10, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.102 Vali Acc: 0.490 Test Loss: 1.102 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6079752445220947
Epoch: 11, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.108 Vali Acc: 0.490 Test Loss: 1.108 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 51714
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2749409675598145
Epoch: 1, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.6794354915618896
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6560189723968506
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.745 Vali Acc: 0.530 Test Loss: 0.745 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8411214351654053
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.877 Vali Acc: 0.490 Test Loss: 0.877 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.757380723953247
Epoch: 5, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.900 Vali Acc: 0.500 Test Loss: 0.900 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8513915538787842
Epoch: 6, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.788 Vali Acc: 0.510 Test Loss: 0.788 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7762870788574219
Epoch: 7, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.883 Vali Acc: 0.520 Test Loss: 0.883 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7053451538085938
Epoch: 8, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.820 Vali Acc: 0.500 Test Loss: 0.820 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9511489868164062
Epoch: 9, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.863 Vali Acc: 0.570 Test Loss: 0.863 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569991).  Saving model ...
Epoch: 10 cost time: 1.6916701793670654
Epoch: 10, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.950 Vali Acc: 0.500 Test Loss: 0.950 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.566066026687622
Epoch: 11, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.947 Vali Acc: 0.540 Test Loss: 0.947 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5194027423858643
Epoch: 12, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.928 Vali Acc: 0.520 Test Loss: 0.928 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8151054382324219
Epoch: 13, Steps: 20 | Train Loss: 0.401 Vali Loss: 1.001 Vali Acc: 0.520 Test Loss: 1.001 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6621501445770264
Epoch: 14, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.960 Vali Acc: 0.570 Test Loss: 0.960 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5977401733398438
Epoch: 15, Steps: 20 | Train Loss: 0.336 Vali Loss: 1.075 Vali Acc: 0.530 Test Loss: 1.075 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7898499965667725
Epoch: 16, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.086 Vali Acc: 0.480 Test Loss: 1.086 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.682387113571167
Epoch: 17, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.057 Vali Acc: 0.530 Test Loss: 1.057 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5520234107971191
Epoch: 18, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.059 Vali Acc: 0.540 Test Loss: 1.059 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6731789112091064
Epoch: 19, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 42850
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7508344650268555
Epoch: 1, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.9453163146972656
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.781 Vali Acc: 0.460 Test Loss: 0.781 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4564740657806396
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.5805408954620361
Epoch: 4, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4824886322021484
Epoch: 5, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.908 Vali Acc: 0.530 Test Loss: 0.908 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5629894733428955
Epoch: 6, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.937 Vali Acc: 0.520 Test Loss: 0.937 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5194237232208252
Epoch: 7, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.842 Vali Acc: 0.560 Test Loss: 0.842 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 1.8115386962890625
Epoch: 8, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6786293983459473
Epoch: 9, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.795 Vali Acc: 0.560 Test Loss: 0.795 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 1.827021837234497
Epoch: 10, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.842 Vali Acc: 0.480 Test Loss: 0.842 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8288490772247314
Epoch: 11, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.907 Vali Acc: 0.550 Test Loss: 0.907 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6143243312835693
Epoch: 12, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.997 Vali Acc: 0.470 Test Loss: 0.997 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7879621982574463
Epoch: 13, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.892 Vali Acc: 0.550 Test Loss: 0.892 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7357995510101318
Epoch: 14, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.972 Vali Acc: 0.530 Test Loss: 0.972 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6364328861236572
Epoch: 15, Steps: 20 | Train Loss: 0.418 Vali Loss: 1.080 Vali Acc: 0.500 Test Loss: 1.080 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7530784606933594
Epoch: 16, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.004 Vali Acc: 0.510 Test Loss: 1.004 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5555830001831055
Epoch: 17, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.064 Vali Acc: 0.500 Test Loss: 1.064 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.752596378326416
Epoch: 18, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.073 Vali Acc: 0.520 Test Loss: 1.073 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6210031509399414
Epoch: 19, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.067 Vali Acc: 0.500 Test Loss: 1.067 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 39330
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.132105588912964
Epoch: 1, Steps: 20 | Train Loss: 0.770 Vali Loss: 0.716 Vali Acc: 0.530 Test Loss: 0.716 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.4907209873199463
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.798 Vali Acc: 0.470 Test Loss: 0.798 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3167273998260498
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.788 Vali Acc: 0.530 Test Loss: 0.788 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3883960247039795
Epoch: 4, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.827 Vali Acc: 0.510 Test Loss: 0.827 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4050097465515137
Epoch: 5, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.836 Vali Acc: 0.490 Test Loss: 0.836 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2998836040496826
Epoch: 6, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.816 Vali Acc: 0.490 Test Loss: 0.816 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.495760202407837
Epoch: 7, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.799 Vali Acc: 0.550 Test Loss: 0.799 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 1.2922399044036865
Epoch: 8, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4034113883972168
Epoch: 9, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.874 Vali Acc: 0.480 Test Loss: 0.874 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3687074184417725
Epoch: 10, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.894 Vali Acc: 0.470 Test Loss: 0.894 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3406982421875
Epoch: 11, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.829 Vali Acc: 0.510 Test Loss: 0.829 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3980529308319092
Epoch: 12, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.888 Vali Acc: 0.520 Test Loss: 0.888 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3556277751922607
Epoch: 13, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.849 Vali Acc: 0.500 Test Loss: 0.849 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1756997108459473
Epoch: 14, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.915 Vali Acc: 0.490 Test Loss: 0.915 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5264122486114502
Epoch: 15, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2943699359893799
Epoch: 16, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.882 Vali Acc: 0.500 Test Loss: 0.882 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4730539321899414
Epoch: 17, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.850 Vali Acc: 0.530 Test Loss: 0.850 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 34050
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.853445291519165
Epoch: 1, Steps: 20 | Train Loss: 0.775 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.9986283779144287
Epoch: 2, Steps: 20 | Train Loss: 0.766 Vali Loss: 1.194 Vali Acc: 0.450 Test Loss: 1.194 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0349624156951904
Epoch: 3, Steps: 20 | Train Loss: 0.770 Vali Loss: 1.022 Vali Acc: 0.530 Test Loss: 1.022 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529990).  Saving model ...
Epoch: 4 cost time: 1.6640229225158691
Epoch: 4, Steps: 20 | Train Loss: 0.830 Vali Loss: 0.977 Vali Acc: 0.510 Test Loss: 0.977 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6527602672576904
Epoch: 5, Steps: 20 | Train Loss: 0.573 Vali Loss: 1.051 Vali Acc: 0.530 Test Loss: 1.051 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6842989921569824
Epoch: 6, Steps: 20 | Train Loss: 0.516 Vali Loss: 1.464 Vali Acc: 0.500 Test Loss: 1.464 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.673898696899414
Epoch: 7, Steps: 20 | Train Loss: 0.645 Vali Loss: 1.268 Vali Acc: 0.490 Test Loss: 1.268 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7165558338165283
Epoch: 8, Steps: 20 | Train Loss: 0.466 Vali Loss: 1.120 Vali Acc: 0.540 Test Loss: 1.120 Test Acc: 0.540
Validation loss decreased (-0.529990 --> -0.539989).  Saving model ...
Epoch: 9 cost time: 1.6128582954406738
Epoch: 9, Steps: 20 | Train Loss: 0.631 Vali Loss: 1.685 Vali Acc: 0.540 Test Loss: 1.685 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.082521677017212
Epoch: 10, Steps: 20 | Train Loss: 0.436 Vali Loss: 1.338 Vali Acc: 0.590 Test Loss: 1.338 Test Acc: 0.590
Validation loss decreased (-0.539989 --> -0.589987).  Saving model ...
Epoch: 11 cost time: 1.9439589977264404
Epoch: 11, Steps: 20 | Train Loss: 0.629 Vali Loss: 1.427 Vali Acc: 0.490 Test Loss: 1.427 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.016646385192871
Epoch: 12, Steps: 20 | Train Loss: 0.247 Vali Loss: 1.799 Vali Acc: 0.450 Test Loss: 1.799 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0905141830444336
Epoch: 13, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.801 Vali Acc: 0.580 Test Loss: 1.801 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8494901657104492
Epoch: 14, Steps: 20 | Train Loss: 0.392 Vali Loss: 2.231 Vali Acc: 0.560 Test Loss: 2.231 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8200304508209229
Epoch: 15, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.933 Vali Acc: 0.480 Test Loss: 1.933 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.758385181427002
Epoch: 16, Steps: 20 | Train Loss: 0.345 Vali Loss: 2.641 Vali Acc: 0.480 Test Loss: 2.641 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7124831676483154
Epoch: 17, Steps: 20 | Train Loss: 0.275 Vali Loss: 2.682 Vali Acc: 0.500 Test Loss: 2.682 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8967664241790771
Epoch: 18, Steps: 20 | Train Loss: 0.180 Vali Loss: 2.678 Vali Acc: 0.520 Test Loss: 2.678 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8374242782592773
Epoch: 19, Steps: 20 | Train Loss: 0.224 Vali Loss: 2.985 Vali Acc: 0.570 Test Loss: 2.985 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9654784202575684
Epoch: 20, Steps: 20 | Train Loss: 0.158 Vali Loss: 2.827 Vali Acc: 0.500 Test Loss: 2.827 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 102434
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6198575496673584
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.745 Vali Acc: 0.460 Test Loss: 0.745 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.6796650886535645
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.787 Vali Acc: 0.490 Test Loss: 0.787 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 1.6098639965057373
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.798 Vali Acc: 0.500 Test Loss: 0.798 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 1.46917724609375
Epoch: 4, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.825 Vali Acc: 0.470 Test Loss: 0.825 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4070968627929688
Epoch: 5, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.903 Vali Acc: 0.550 Test Loss: 0.903 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 1.416921615600586
Epoch: 6, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.817 Vali Acc: 0.510 Test Loss: 0.817 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3849918842315674
Epoch: 7, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.924 Vali Acc: 0.410 Test Loss: 0.924 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.654313325881958
Epoch: 8, Steps: 20 | Train Loss: 0.511 Vali Loss: 1.214 Vali Acc: 0.550 Test Loss: 1.214 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.559861660003662
Epoch: 9, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.949 Vali Acc: 0.510 Test Loss: 0.949 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.366018295288086
Epoch: 10, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.264 Vali Acc: 0.560 Test Loss: 1.264 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559987).  Saving model ...
Epoch: 11 cost time: 1.653608798980713
Epoch: 11, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.993 Vali Acc: 0.480 Test Loss: 0.993 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.442152738571167
Epoch: 12, Steps: 20 | Train Loss: 0.338 Vali Loss: 1.536 Vali Acc: 0.510 Test Loss: 1.536 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4456918239593506
Epoch: 13, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.398 Vali Acc: 0.490 Test Loss: 1.398 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5404846668243408
Epoch: 14, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.529 Vali Acc: 0.440 Test Loss: 1.529 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4511363506317139
Epoch: 15, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.379 Vali Acc: 0.500 Test Loss: 1.379 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3642873764038086
Epoch: 16, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.455 Vali Acc: 0.490 Test Loss: 1.455 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5427827835083008
Epoch: 17, Steps: 20 | Train Loss: 0.237 Vali Loss: 1.401 Vali Acc: 0.500 Test Loss: 1.401 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4940965175628662
Epoch: 18, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.504 Vali Acc: 0.520 Test Loss: 1.504 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4350671768188477
Epoch: 19, Steps: 20 | Train Loss: 0.230 Vali Loss: 1.682 Vali Acc: 0.480 Test Loss: 1.682 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6631181240081787
Epoch: 20, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.808 Vali Acc: 0.510 Test Loss: 1.808 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 57666
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3001482486724854
Epoch: 1, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.4499616622924805
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.765 Vali Acc: 0.570 Test Loss: 0.765 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 1.5414776802062988
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.823 Vali Acc: 0.470 Test Loss: 0.823 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4455862045288086
Epoch: 4, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.848 Vali Acc: 0.520 Test Loss: 0.848 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3708140850067139
Epoch: 5, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.888 Vali Acc: 0.490 Test Loss: 0.888 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5196714401245117
Epoch: 6, Steps: 20 | Train Loss: 0.507 Vali Loss: 1.106 Vali Acc: 0.530 Test Loss: 1.106 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4823193550109863
Epoch: 7, Steps: 20 | Train Loss: 0.596 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4329750537872314
Epoch: 8, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.911 Vali Acc: 0.560 Test Loss: 0.911 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.447094202041626
Epoch: 9, Steps: 20 | Train Loss: 0.510 Vali Loss: 1.104 Vali Acc: 0.570 Test Loss: 1.104 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.598604440689087
Epoch: 10, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.158 Vali Acc: 0.510 Test Loss: 1.158 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7071239948272705
Epoch: 11, Steps: 20 | Train Loss: 0.545 Vali Loss: 1.137 Vali Acc: 0.520 Test Loss: 1.137 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4438683986663818
Epoch: 12, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.305 Vali Acc: 0.490 Test Loss: 1.305 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 57698
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4297592639923096
Epoch: 1, Steps: 20 | Train Loss: 0.785 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.432222604751587
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.623422622680664
Epoch: 3, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.856 Vali Acc: 0.510 Test Loss: 0.856 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5179624557495117
Epoch: 4, Steps: 20 | Train Loss: 0.654 Vali Loss: 1.102 Vali Acc: 0.510 Test Loss: 1.102 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.290785551071167
Epoch: 5, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.855 Vali Acc: 0.580 Test Loss: 0.855 Test Acc: 0.580
Validation loss decreased (-0.509992 --> -0.579991).  Saving model ...
Epoch: 6 cost time: 1.4191882610321045
Epoch: 6, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.936 Vali Acc: 0.460 Test Loss: 0.936 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.319946527481079
Epoch: 7, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.909 Vali Acc: 0.500 Test Loss: 0.909 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2675857543945312
Epoch: 8, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.891 Vali Acc: 0.530 Test Loss: 0.891 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3068535327911377
Epoch: 9, Steps: 20 | Train Loss: 0.490 Vali Loss: 1.202 Vali Acc: 0.470 Test Loss: 1.202 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.240670919418335
Epoch: 10, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.916 Vali Acc: 0.480 Test Loss: 0.916 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6082451343536377
Epoch: 11, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.947 Vali Acc: 0.510 Test Loss: 0.947 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3364503383636475
Epoch: 12, Steps: 20 | Train Loss: 0.334 Vali Loss: 0.976 Vali Acc: 0.540 Test Loss: 0.976 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4004757404327393
Epoch: 13, Steps: 20 | Train Loss: 0.284 Vali Loss: 1.035 Vali Acc: 0.490 Test Loss: 1.035 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3986008167266846
Epoch: 14, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.225 Vali Acc: 0.540 Test Loss: 1.225 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.686527967453003
Epoch: 15, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.183 Vali Acc: 0.490 Test Loss: 1.183 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 43394
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.38991117477417
Epoch: 1, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.693 Vali Acc: 0.590 Test Loss: 0.693 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.874690055847168
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.746 Vali Acc: 0.560 Test Loss: 0.746 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6515460014343262
Epoch: 3, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.842 Vali Acc: 0.550 Test Loss: 0.842 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7381110191345215
Epoch: 4, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.899 Vali Acc: 0.480 Test Loss: 0.899 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5854203701019287
Epoch: 5, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.767 Vali Acc: 0.560 Test Loss: 0.767 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7496137619018555
Epoch: 6, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.851 Vali Acc: 0.560 Test Loss: 0.851 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4596755504608154
Epoch: 7, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.855 Vali Acc: 0.540 Test Loss: 0.855 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5928783416748047
Epoch: 8, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.969 Vali Acc: 0.510 Test Loss: 0.969 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4354450702667236
Epoch: 9, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.896 Vali Acc: 0.540 Test Loss: 0.896 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5461466312408447
Epoch: 10, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.941 Vali Acc: 0.550 Test Loss: 0.941 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7423491477966309
Epoch: 11, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.982 Vali Acc: 0.460 Test Loss: 0.982 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 34530
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5694925785064697
Epoch: 1, Steps: 20 | Train Loss: 0.784 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.6953094005584717
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.770 Vali Acc: 0.530 Test Loss: 0.770 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 1.722581148147583
Epoch: 3, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.848 Vali Acc: 0.530 Test Loss: 0.848 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6742172241210938
Epoch: 4, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.977 Vali Acc: 0.520 Test Loss: 0.977 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6889302730560303
Epoch: 5, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.911 Vali Acc: 0.470 Test Loss: 0.911 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6812455654144287
Epoch: 6, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.831 Vali Acc: 0.530 Test Loss: 0.831 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7750139236450195
Epoch: 7, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.900 Vali Acc: 0.500 Test Loss: 0.900 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7104547023773193
Epoch: 8, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.833 Vali Acc: 0.500 Test Loss: 0.833 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.733142375946045
Epoch: 9, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.880 Vali Acc: 0.510 Test Loss: 0.880 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4417073726654053
Epoch: 10, Steps: 20 | Train Loss: 0.500 Vali Loss: 1.004 Vali Acc: 0.500 Test Loss: 1.004 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5862250328063965
Epoch: 11, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.924 Vali Acc: 0.480 Test Loss: 0.924 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6362242698669434
Epoch: 12, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.852 Vali Acc: 0.540 Test Loss: 0.852 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539991).  Saving model ...
Epoch: 13 cost time: 1.485234260559082
Epoch: 13, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.920 Vali Acc: 0.550 Test Loss: 0.920 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549991).  Saving model ...
Epoch: 14 cost time: 1.534759759902954
Epoch: 14, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.059 Vali Acc: 0.480 Test Loss: 1.059 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8019213676452637
Epoch: 15, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.998 Vali Acc: 0.550 Test Loss: 0.998 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.680129051208496
Epoch: 16, Steps: 20 | Train Loss: 0.381 Vali Loss: 0.989 Vali Acc: 0.510 Test Loss: 0.989 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6227777004241943
Epoch: 17, Steps: 20 | Train Loss: 0.345 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.770925760269165
Epoch: 18, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.012 Vali Acc: 0.550 Test Loss: 1.012 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6530847549438477
Epoch: 19, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.126 Vali Acc: 0.470 Test Loss: 1.126 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7082321643829346
Epoch: 20, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.417 Vali Acc: 0.490 Test Loss: 1.417 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.729835033416748
Epoch: 21, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.230 Vali Acc: 0.480 Test Loss: 1.230 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6214654445648193
Epoch: 22, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.430 Vali Acc: 0.510 Test Loss: 1.430 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6614062786102295
Epoch: 23, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.204 Vali Acc: 0.510 Test Loss: 1.204 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 31010
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7247231006622314
Epoch: 1, Steps: 20 | Train Loss: 0.788 Vali Loss: 0.746 Vali Acc: 0.430 Test Loss: 0.746 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.1913585662841797
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.781 Vali Acc: 0.460 Test Loss: 0.781 Test Acc: 0.460
Validation loss decreased (-0.429993 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 1.1564195156097412
Epoch: 3, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.754 Vali Acc: 0.540 Test Loss: 0.754 Test Acc: 0.540
Validation loss decreased (-0.459992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 1.274482250213623
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.133744478225708
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.787 Vali Acc: 0.460 Test Loss: 0.787 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1031901836395264
Epoch: 6, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.794 Vali Acc: 0.480 Test Loss: 0.794 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2278687953948975
Epoch: 7, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.763 Vali Acc: 0.480 Test Loss: 0.763 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2302966117858887
Epoch: 8, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.799 Vali Acc: 0.530 Test Loss: 0.799 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.10400390625
Epoch: 9, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.795 Vali Acc: 0.470 Test Loss: 0.795 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2429230213165283
Epoch: 10, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.806 Vali Acc: 0.590 Test Loss: 0.806 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589992).  Saving model ...
Epoch: 11 cost time: 1.3874835968017578
Epoch: 11, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.828 Vali Acc: 0.540 Test Loss: 0.828 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3047959804534912
Epoch: 12, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.846 Vali Acc: 0.560 Test Loss: 0.846 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3023772239685059
Epoch: 13, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.799 Vali Acc: 0.540 Test Loss: 0.799 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2458784580230713
Epoch: 14, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2340304851531982
Epoch: 15, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.930 Vali Acc: 0.530 Test Loss: 0.930 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1361987590789795
Epoch: 16, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.918 Vali Acc: 0.480 Test Loss: 0.918 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2414045333862305
Epoch: 17, Steps: 20 | Train Loss: 0.388 Vali Loss: 0.909 Vali Acc: 0.530 Test Loss: 0.909 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2002012729644775
Epoch: 18, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.871 Vali Acc: 0.570 Test Loss: 0.871 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3280246257781982
Epoch: 19, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.917 Vali Acc: 0.530 Test Loss: 0.917 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3345873355865479
Epoch: 20, Steps: 20 | Train Loss: 0.378 Vali Loss: 0.895 Vali Acc: 0.520 Test Loss: 0.895 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 25730
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5801758766174316
Epoch: 1, Steps: 20 | Train Loss: 0.805 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.0841293334960938
Epoch: 2, Steps: 20 | Train Loss: 0.904 Vali Loss: 0.780 Vali Acc: 0.510 Test Loss: 0.780 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.6322753429412842
Epoch: 3, Steps: 20 | Train Loss: 0.656 Vali Loss: 1.113 Vali Acc: 0.530 Test Loss: 1.113 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529989).  Saving model ...
Epoch: 4 cost time: 1.9720261096954346
Epoch: 4, Steps: 20 | Train Loss: 0.873 Vali Loss: 1.656 Vali Acc: 0.510 Test Loss: 1.656 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9280996322631836
Epoch: 5, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.958 Vali Acc: 0.530 Test Loss: 0.958 Test Acc: 0.530
Validation loss decreased (-0.529989 --> -0.529990).  Saving model ...
Epoch: 6 cost time: 2.10052227973938
Epoch: 6, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.365 Vali Acc: 0.510 Test Loss: 1.365 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0607526302337646
Epoch: 7, Steps: 20 | Train Loss: 0.763 Vali Loss: 1.332 Vali Acc: 0.540 Test Loss: 1.332 Test Acc: 0.540
Validation loss decreased (-0.529990 --> -0.539987).  Saving model ...
Epoch: 8 cost time: 1.9317452907562256
Epoch: 8, Steps: 20 | Train Loss: 0.650 Vali Loss: 1.188 Vali Acc: 0.530 Test Loss: 1.188 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1184935569763184
Epoch: 9, Steps: 20 | Train Loss: 0.481 Vali Loss: 1.588 Vali Acc: 0.510 Test Loss: 1.588 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0100693702697754
Epoch: 10, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.399 Vali Acc: 0.570 Test Loss: 1.399 Test Acc: 0.570
Validation loss decreased (-0.539987 --> -0.569986).  Saving model ...
Epoch: 11 cost time: 2.2844936847686768
Epoch: 11, Steps: 20 | Train Loss: 0.602 Vali Loss: 3.490 Vali Acc: 0.510 Test Loss: 3.490 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0874972343444824
Epoch: 12, Steps: 20 | Train Loss: 0.681 Vali Loss: 1.636 Vali Acc: 0.500 Test Loss: 1.636 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1696510314941406
Epoch: 13, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.519 Vali Acc: 0.500 Test Loss: 1.519 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1804773807525635
Epoch: 14, Steps: 20 | Train Loss: 0.326 Vali Loss: 2.522 Vali Acc: 0.480 Test Loss: 2.522 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8448545932769775
Epoch: 15, Steps: 20 | Train Loss: 0.260 Vali Loss: 2.000 Vali Acc: 0.520 Test Loss: 2.000 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7870662212371826
Epoch: 16, Steps: 20 | Train Loss: 0.231 Vali Loss: 2.146 Vali Acc: 0.540 Test Loss: 2.146 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8199050426483154
Epoch: 17, Steps: 20 | Train Loss: 0.336 Vali Loss: 2.094 Vali Acc: 0.500 Test Loss: 2.094 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.023439884185791
Epoch: 18, Steps: 20 | Train Loss: 0.267 Vali Loss: 2.481 Vali Acc: 0.480 Test Loss: 2.481 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7610421180725098
Epoch: 19, Steps: 20 | Train Loss: 0.352 Vali Loss: 2.112 Vali Acc: 0.520 Test Loss: 2.112 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8152124881744385
Epoch: 20, Steps: 20 | Train Loss: 0.158 Vali Loss: 3.190 Vali Acc: 0.460 Test Loss: 3.190 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 98274
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3110573291778564
Epoch: 1, Steps: 20 | Train Loss: 0.803 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.8047351837158203
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.866 Vali Acc: 0.530 Test Loss: 0.866 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 1.708076000213623
Epoch: 3, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.926 Vali Acc: 0.500 Test Loss: 0.926 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8521203994750977
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.917 Vali Acc: 0.500 Test Loss: 0.917 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7989044189453125
Epoch: 5, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.942 Vali Acc: 0.470 Test Loss: 0.942 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7867937088012695
Epoch: 6, Steps: 20 | Train Loss: 0.563 Vali Loss: 1.147 Vali Acc: 0.490 Test Loss: 1.147 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8291430473327637
Epoch: 7, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.764890193939209
Epoch: 8, Steps: 20 | Train Loss: 0.511 Vali Loss: 1.054 Vali Acc: 0.520 Test Loss: 1.054 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7829670906066895
Epoch: 9, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.038 Vali Acc: 0.490 Test Loss: 1.038 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8653414249420166
Epoch: 10, Steps: 20 | Train Loss: 0.569 Vali Loss: 1.036 Vali Acc: 0.460 Test Loss: 1.036 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8876612186431885
Epoch: 11, Steps: 20 | Train Loss: 0.406 Vali Loss: 1.346 Vali Acc: 0.490 Test Loss: 1.346 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8171942234039307
Epoch: 12, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.088 Vali Acc: 0.530 Test Loss: 1.088 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 53506
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.296832323074341
Epoch: 1, Steps: 20 | Train Loss: 0.796 Vali Loss: 0.824 Vali Acc: 0.440 Test Loss: 0.824 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 1.5658862590789795
Epoch: 2, Steps: 20 | Train Loss: 0.737 Vali Loss: 1.041 Vali Acc: 0.460 Test Loss: 1.041 Test Acc: 0.460
Validation loss decreased (-0.439992 --> -0.459990).  Saving model ...
Epoch: 3 cost time: 1.5096707344055176
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.866 Vali Acc: 0.520 Test Loss: 0.866 Test Acc: 0.520
Validation loss decreased (-0.459990 --> -0.519991).  Saving model ...
Epoch: 4 cost time: 1.4889583587646484
Epoch: 4, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.932 Vali Acc: 0.450 Test Loss: 0.932 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7969114780426025
Epoch: 5, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.939 Vali Acc: 0.450 Test Loss: 0.939 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7021610736846924
Epoch: 6, Steps: 20 | Train Loss: 0.644 Vali Loss: 1.182 Vali Acc: 0.460 Test Loss: 1.182 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8301899433135986
Epoch: 7, Steps: 20 | Train Loss: 0.565 Vali Loss: 1.051 Vali Acc: 0.510 Test Loss: 1.051 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8734819889068604
Epoch: 8, Steps: 20 | Train Loss: 0.496 Vali Loss: 1.002 Vali Acc: 0.480 Test Loss: 1.002 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.71620774269104
Epoch: 9, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.012 Vali Acc: 0.470 Test Loss: 1.012 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7405242919921875
Epoch: 10, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.034 Vali Acc: 0.540 Test Loss: 1.034 Test Acc: 0.540
Validation loss decreased (-0.519991 --> -0.539990).  Saving model ...
Epoch: 11 cost time: 1.648542881011963
Epoch: 11, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.070 Vali Acc: 0.540 Test Loss: 1.070 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5971453189849854
Epoch: 12, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.131 Vali Acc: 0.490 Test Loss: 1.131 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6109824180603027
Epoch: 13, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.266 Vali Acc: 0.480 Test Loss: 1.266 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0866758823394775
Epoch: 14, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.086 Vali Acc: 0.460 Test Loss: 1.086 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0295217037200928
Epoch: 15, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.338 Vali Acc: 0.520 Test Loss: 1.338 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1590654850006104
Epoch: 16, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.209 Vali Acc: 0.550 Test Loss: 1.209 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549988).  Saving model ...
Epoch: 17 cost time: 2.0541281700134277
Epoch: 17, Steps: 20 | Train Loss: 0.211 Vali Loss: 1.464 Vali Acc: 0.490 Test Loss: 1.464 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0638794898986816
Epoch: 18, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.737 Vali Acc: 0.530 Test Loss: 1.737 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.071824312210083
Epoch: 19, Steps: 20 | Train Loss: 0.304 Vali Loss: 1.847 Vali Acc: 0.510 Test Loss: 1.847 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.14158296585083
Epoch: 20, Steps: 20 | Train Loss: 0.174 Vali Loss: 1.628 Vali Acc: 0.480 Test Loss: 1.628 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9593381881713867
Epoch: 21, Steps: 20 | Train Loss: 0.161 Vali Loss: 1.410 Vali Acc: 0.540 Test Loss: 1.410 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.980334997177124
Epoch: 22, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.974 Vali Acc: 0.530 Test Loss: 1.974 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8769333362579346
Epoch: 23, Steps: 20 | Train Loss: 0.115 Vali Loss: 1.710 Vali Acc: 0.520 Test Loss: 1.710 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7307727336883545
Epoch: 24, Steps: 20 | Train Loss: 0.123 Vali Loss: 2.207 Vali Acc: 0.480 Test Loss: 2.207 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6110408306121826
Epoch: 25, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.941 Vali Acc: 0.560 Test Loss: 1.941 Test Acc: 0.560
Validation loss decreased (-0.549988 --> -0.559981).  Saving model ...
Epoch: 26 cost time: 1.8930139541625977
Epoch: 26, Steps: 20 | Train Loss: 0.085 Vali Loss: 2.254 Vali Acc: 0.520 Test Loss: 2.254 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9372365474700928
Epoch: 27, Steps: 20 | Train Loss: 0.141 Vali Loss: 2.005 Vali Acc: 0.530 Test Loss: 2.005 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7723214626312256
Epoch: 28, Steps: 20 | Train Loss: 0.073 Vali Loss: 2.376 Vali Acc: 0.490 Test Loss: 2.376 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9312572479248047
Epoch: 29, Steps: 20 | Train Loss: 0.070 Vali Loss: 2.264 Vali Acc: 0.510 Test Loss: 2.264 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.846639633178711
Epoch: 30, Steps: 20 | Train Loss: 0.151 Vali Loss: 2.338 Vali Acc: 0.490 Test Loss: 2.338 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.912872552871704
Epoch: 31, Steps: 20 | Train Loss: 0.089 Vali Loss: 2.354 Vali Acc: 0.510 Test Loss: 2.354 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.0837509632110596
Epoch: 32, Steps: 20 | Train Loss: 0.127 Vali Loss: 2.202 Vali Acc: 0.490 Test Loss: 2.202 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9425127506256104
Epoch: 33, Steps: 20 | Train Loss: 0.049 Vali Loss: 3.544 Vali Acc: 0.490 Test Loss: 3.544 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0024163722991943
Epoch: 34, Steps: 20 | Train Loss: 0.127 Vali Loss: 3.205 Vali Acc: 0.500 Test Loss: 3.205 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.9026002883911133
Epoch: 35, Steps: 20 | Train Loss: 0.082 Vali Loss: 3.285 Vali Acc: 0.500 Test Loss: 3.285 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 53538
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.787097454071045
Epoch: 1, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.0505850315093994
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.902 Vali Acc: 0.530 Test Loss: 0.902 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 2.0568859577178955
Epoch: 3, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.904 Vali Acc: 0.510 Test Loss: 0.904 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8337106704711914
Epoch: 4, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.851 Vali Acc: 0.510 Test Loss: 0.851 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.031980514526367
Epoch: 5, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8460500240325928
Epoch: 6, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7860689163208008
Epoch: 7, Steps: 20 | Train Loss: 0.558 Vali Loss: 1.002 Vali Acc: 0.490 Test Loss: 1.002 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7701427936553955
Epoch: 8, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.919 Vali Acc: 0.560 Test Loss: 0.919 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559991).  Saving model ...
Epoch: 9 cost time: 1.9160189628601074
Epoch: 9, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.028 Vali Acc: 0.520 Test Loss: 1.028 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.864450216293335
Epoch: 10, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.954 Vali Acc: 0.580 Test Loss: 0.954 Test Acc: 0.580
Validation loss decreased (-0.559991 --> -0.579990).  Saving model ...
Epoch: 11 cost time: 1.9297442436218262
Epoch: 11, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.126 Vali Acc: 0.550 Test Loss: 1.126 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0744242668151855
Epoch: 12, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.094 Vali Acc: 0.480 Test Loss: 1.094 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0439252853393555
Epoch: 13, Steps: 20 | Train Loss: 0.395 Vali Loss: 1.070 Vali Acc: 0.530 Test Loss: 1.070 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9114913940429688
Epoch: 14, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.054 Vali Acc: 0.500 Test Loss: 1.054 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9632618427276611
Epoch: 15, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.121 Vali Acc: 0.510 Test Loss: 1.121 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.88413667678833
Epoch: 16, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.125 Vali Acc: 0.510 Test Loss: 1.125 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2068674564361572
Epoch: 17, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.265 Vali Acc: 0.470 Test Loss: 1.265 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.038862705230713
Epoch: 18, Steps: 20 | Train Loss: 0.230 Vali Loss: 1.508 Vali Acc: 0.490 Test Loss: 1.508 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.0609476566314697
Epoch: 19, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.313 Vali Acc: 0.480 Test Loss: 1.313 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0163631439208984
Epoch: 20, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.200 Vali Acc: 0.550 Test Loss: 1.200 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 39234
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.744033098220825
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 1.8841426372528076
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.777 Vali Acc: 0.510 Test Loss: 0.777 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.7169303894042969
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.822 Vali Acc: 0.560 Test Loss: 0.822 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 1.6099207401275635
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.870 Vali Acc: 0.540 Test Loss: 0.870 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.587038278579712
Epoch: 5, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.856 Vali Acc: 0.490 Test Loss: 0.856 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.828148365020752
Epoch: 6, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.930 Vali Acc: 0.510 Test Loss: 0.930 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.67214035987854
Epoch: 7, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.880 Vali Acc: 0.500 Test Loss: 0.880 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.895326852798462
Epoch: 8, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.908 Vali Acc: 0.510 Test Loss: 0.908 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.812232494354248
Epoch: 9, Steps: 20 | Train Loss: 0.577 Vali Loss: 1.156 Vali Acc: 0.490 Test Loss: 1.156 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9313173294067383
Epoch: 10, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.917 Vali Acc: 0.520 Test Loss: 0.917 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.843736171722412
Epoch: 11, Steps: 20 | Train Loss: 0.491 Vali Loss: 1.109 Vali Acc: 0.480 Test Loss: 1.109 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6361205577850342
Epoch: 12, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.991 Vali Acc: 0.490 Test Loss: 0.991 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0467183589935303
Epoch: 13, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 30370
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.778266429901123
Epoch: 1, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.761 Vali Acc: 0.460 Test Loss: 0.761 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.9127161502838135
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
Validation loss decreased (-0.459992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.8244080543518066
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.838 Vali Acc: 0.480 Test Loss: 0.838 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1032650470733643
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.863 Vali Acc: 0.510 Test Loss: 0.863 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9361660480499268
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.856 Vali Acc: 0.490 Test Loss: 0.856 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3861849308013916
Epoch: 6, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.884 Vali Acc: 0.470 Test Loss: 0.884 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7722089290618896
Epoch: 7, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.831 Vali Acc: 0.470 Test Loss: 0.831 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5873496532440186
Epoch: 8, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.950 Vali Acc: 0.500 Test Loss: 0.950 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.727217197418213
Epoch: 9, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.912 Vali Acc: 0.460 Test Loss: 0.912 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6072468757629395
Epoch: 10, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.944 Vali Acc: 0.480 Test Loss: 0.944 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.639585018157959
Epoch: 11, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.899 Vali Acc: 0.520 Test Loss: 0.899 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519991).  Saving model ...
Epoch: 12 cost time: 1.9101390838623047
Epoch: 12, Steps: 20 | Train Loss: 0.480 Vali Loss: 1.031 Vali Acc: 0.470 Test Loss: 1.031 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.93094801902771
Epoch: 13, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.868 Vali Acc: 0.510 Test Loss: 0.868 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1084725856781006
Epoch: 14, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.023 Vali Acc: 0.510 Test Loss: 1.023 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9705402851104736
Epoch: 15, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.983 Vali Acc: 0.510 Test Loss: 0.983 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.685438632965088
Epoch: 16, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.040 Vali Acc: 0.460 Test Loss: 1.040 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9178011417388916
Epoch: 17, Steps: 20 | Train Loss: 0.385 Vali Loss: 1.026 Vali Acc: 0.500 Test Loss: 1.026 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.204749584197998
Epoch: 18, Steps: 20 | Train Loss: 0.350 Vali Loss: 1.004 Vali Acc: 0.500 Test Loss: 1.004 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0230119228363037
Epoch: 19, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.103 Vali Acc: 0.440 Test Loss: 1.103 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0722875595092773
Epoch: 20, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.140 Vali Acc: 0.510 Test Loss: 1.140 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0329651832580566
Epoch: 21, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.182 Vali Acc: 0.460 Test Loss: 1.182 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 26850
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.151669979095459
Epoch: 1, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.764 Vali Acc: 0.510 Test Loss: 0.764 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.1979467868804932
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.763 Vali Acc: 0.470 Test Loss: 0.763 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0813205242156982
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3521060943603516
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.787 Vali Acc: 0.560 Test Loss: 0.787 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559992).  Saving model ...
Epoch: 5 cost time: 1.275451421737671
Epoch: 5, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.798 Vali Acc: 0.550 Test Loss: 0.798 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2546091079711914
Epoch: 6, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.774 Vali Acc: 0.470 Test Loss: 0.774 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1402795314788818
Epoch: 7, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.848 Vali Acc: 0.540 Test Loss: 0.848 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.257469654083252
Epoch: 8, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2063565254211426
Epoch: 9, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.784 Vali Acc: 0.540 Test Loss: 0.784 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1617348194122314
Epoch: 10, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.841 Vali Acc: 0.510 Test Loss: 0.841 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0650193691253662
Epoch: 11, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.883 Vali Acc: 0.480 Test Loss: 0.883 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.160715103149414
Epoch: 12, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3170363903045654
Epoch: 13, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2411682605743408
Epoch: 14, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.872 Vali Acc: 0.550 Test Loss: 0.872 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm32_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 21570
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.038714408874512
Epoch: 1, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.841 Vali Acc: 0.490 Test Loss: 0.841 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.0471205711364746
Epoch: 2, Steps: 20 | Train Loss: 0.839 Vali Loss: 0.823 Vali Acc: 0.490 Test Loss: 0.823 Test Acc: 0.490
Validation loss decreased (-0.489992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 2.1045756340026855
Epoch: 3, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.756 Vali Acc: 0.520 Test Loss: 0.756 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 2.1642343997955322
Epoch: 4, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.842 Vali Acc: 0.520 Test Loss: 0.842 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2047805786132812
Epoch: 5, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.940 Vali Acc: 0.540 Test Loss: 0.940 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539991).  Saving model ...
Epoch: 6 cost time: 2.002917766571045
Epoch: 6, Steps: 20 | Train Loss: 0.552 Vali Loss: 1.036 Vali Acc: 0.530 Test Loss: 1.036 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9576501846313477
Epoch: 7, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.876 Vali Acc: 0.500 Test Loss: 0.876 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.137312173843384
Epoch: 8, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.919 Vali Acc: 0.500 Test Loss: 0.919 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8442027568817139
Epoch: 9, Steps: 20 | Train Loss: 0.395 Vali Loss: 1.012 Vali Acc: 0.470 Test Loss: 1.012 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1044650077819824
Epoch: 10, Steps: 20 | Train Loss: 0.378 Vali Loss: 1.018 Vali Acc: 0.470 Test Loss: 1.018 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9456875324249268
Epoch: 11, Steps: 20 | Train Loss: 0.406 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.034574508666992
Epoch: 12, Steps: 20 | Train Loss: 0.343 Vali Loss: 1.372 Vali Acc: 0.520 Test Loss: 1.372 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.893066644668579
Epoch: 13, Steps: 20 | Train Loss: 0.381 Vali Loss: 1.331 Vali Acc: 0.470 Test Loss: 1.331 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8130741119384766
Epoch: 14, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.126 Vali Acc: 0.530 Test Loss: 1.126 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.000164747238159
Epoch: 15, Steps: 20 | Train Loss: 0.272 Vali Loss: 1.222 Vali Acc: 0.560 Test Loss: 1.222 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559988).  Saving model ...
Epoch: 16 cost time: 2.1292033195495605
Epoch: 16, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.419 Vali Acc: 0.480 Test Loss: 1.419 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1639745235443115
Epoch: 17, Steps: 20 | Train Loss: 0.180 Vali Loss: 1.717 Vali Acc: 0.490 Test Loss: 1.717 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8127036094665527
Epoch: 18, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.618 Vali Acc: 0.480 Test Loss: 1.618 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1022934913635254
Epoch: 19, Steps: 20 | Train Loss: 0.190 Vali Loss: 1.648 Vali Acc: 0.480 Test Loss: 1.648 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1942176818847656
Epoch: 20, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.474 Vali Acc: 0.540 Test Loss: 1.474 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.05378794670105
Epoch: 21, Steps: 20 | Train Loss: 0.173 Vali Loss: 1.886 Vali Acc: 0.550 Test Loss: 1.886 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7922124862670898
Epoch: 22, Steps: 20 | Train Loss: 0.286 Vali Loss: 2.159 Vali Acc: 0.480 Test Loss: 2.159 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6853258609771729
Epoch: 23, Steps: 20 | Train Loss: 0.125 Vali Loss: 2.252 Vali Acc: 0.460 Test Loss: 2.252 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6812877655029297
Epoch: 24, Steps: 20 | Train Loss: 0.126 Vali Loss: 1.977 Vali Acc: 0.490 Test Loss: 1.977 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6058166027069092
Epoch: 25, Steps: 20 | Train Loss: 0.117 Vali Loss: 1.894 Vali Acc: 0.600 Test Loss: 1.894 Test Acc: 0.600
Validation loss decreased (-0.559988 --> -0.599981).  Saving model ...
Epoch: 26 cost time: 1.6711831092834473
Epoch: 26, Steps: 20 | Train Loss: 0.111 Vali Loss: 2.408 Vali Acc: 0.460 Test Loss: 2.408 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8916680812835693
Epoch: 27, Steps: 20 | Train Loss: 0.077 Vali Loss: 2.063 Vali Acc: 0.480 Test Loss: 2.063 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7154209613800049
Epoch: 28, Steps: 20 | Train Loss: 0.068 Vali Loss: 2.047 Vali Acc: 0.560 Test Loss: 2.047 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8144965171813965
Epoch: 29, Steps: 20 | Train Loss: 0.033 Vali Loss: 2.035 Vali Acc: 0.550 Test Loss: 2.035 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9755206108093262
Epoch: 30, Steps: 20 | Train Loss: 0.045 Vali Loss: 2.291 Vali Acc: 0.510 Test Loss: 2.291 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7518889904022217
Epoch: 31, Steps: 20 | Train Loss: 0.058 Vali Loss: 2.320 Vali Acc: 0.530 Test Loss: 2.320 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6916894912719727
Epoch: 32, Steps: 20 | Train Loss: 0.052 Vali Loss: 2.857 Vali Acc: 0.460 Test Loss: 2.857 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9712748527526855
Epoch: 33, Steps: 20 | Train Loss: 0.014 Vali Loss: 2.552 Vali Acc: 0.440 Test Loss: 2.552 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0162034034729004
Epoch: 34, Steps: 20 | Train Loss: 0.036 Vali Loss: 2.690 Vali Acc: 0.490 Test Loss: 2.690 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.1041579246520996
Epoch: 35, Steps: 20 | Train Loss: 0.080 Vali Loss: 3.258 Vali Acc: 0.470 Test Loss: 3.258 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 54482
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.49450421333313
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.711967945098877
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.864 Vali Acc: 0.470 Test Loss: 0.864 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9044251441955566
Epoch: 3, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.803 Vali Acc: 0.470 Test Loss: 0.803 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.878880262374878
Epoch: 4, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.952 Vali Acc: 0.510 Test Loss: 0.952 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9943432807922363
Epoch: 5, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.798 Vali Acc: 0.420 Test Loss: 0.798 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7677907943725586
Epoch: 6, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.853 Vali Acc: 0.490 Test Loss: 0.853 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8019962310791016
Epoch: 7, Steps: 20 | Train Loss: 0.554 Vali Loss: 1.010 Vali Acc: 0.480 Test Loss: 1.010 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8552508354187012
Epoch: 8, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6993961334228516
Epoch: 9, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6582517623901367
Epoch: 10, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.926 Vali Acc: 0.500 Test Loss: 0.926 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.705704689025879
Epoch: 11, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.997 Vali Acc: 0.510 Test Loss: 0.997 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 32098
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3689494132995605
Epoch: 1, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.798 Vali Acc: 0.440 Test Loss: 0.798 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 2.021010398864746
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.867 Vali Acc: 0.480 Test Loss: 0.867 Test Acc: 0.480
Validation loss decreased (-0.439992 --> -0.479991).  Saving model ...
Epoch: 3 cost time: 1.8841800689697266
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
Validation loss decreased (-0.479991 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 1.8120858669281006
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.839 Vali Acc: 0.480 Test Loss: 0.839 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.808668851852417
Epoch: 5, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.917 Vali Acc: 0.440 Test Loss: 0.917 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.025404691696167
Epoch: 6, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.806 Vali Acc: 0.500 Test Loss: 0.806 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6955275535583496
Epoch: 7, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.896 Vali Acc: 0.500 Test Loss: 0.896 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.748044490814209
Epoch: 8, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.908 Vali Acc: 0.530 Test Loss: 0.908 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529991).  Saving model ...
Epoch: 9 cost time: 2.0168280601501465
Epoch: 9, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.960 Vali Acc: 0.530 Test Loss: 0.960 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7777512073516846
Epoch: 10, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.953 Vali Acc: 0.440 Test Loss: 0.953 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7463209629058838
Epoch: 11, Steps: 20 | Train Loss: 0.443 Vali Loss: 1.124 Vali Acc: 0.560 Test Loss: 1.124 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559989).  Saving model ...
Epoch: 12 cost time: 2.131380081176758
Epoch: 12, Steps: 20 | Train Loss: 0.484 Vali Loss: 1.165 Vali Acc: 0.480 Test Loss: 1.165 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8065681457519531
Epoch: 13, Steps: 20 | Train Loss: 0.411 Vali Loss: 1.013 Vali Acc: 0.480 Test Loss: 1.013 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.866295576095581
Epoch: 14, Steps: 20 | Train Loss: 0.427 Vali Loss: 1.032 Vali Acc: 0.480 Test Loss: 1.032 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.973576545715332
Epoch: 15, Steps: 20 | Train Loss: 0.406 Vali Loss: 1.032 Vali Acc: 0.500 Test Loss: 1.032 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8614659309387207
Epoch: 16, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.233 Vali Acc: 0.480 Test Loss: 1.233 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.656611680984497
Epoch: 17, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.165 Vali Acc: 0.460 Test Loss: 1.165 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7208268642425537
Epoch: 18, Steps: 20 | Train Loss: 0.284 Vali Loss: 1.090 Vali Acc: 0.550 Test Loss: 1.090 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5916247367858887
Epoch: 19, Steps: 20 | Train Loss: 0.288 Vali Loss: 1.280 Vali Acc: 0.520 Test Loss: 1.280 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6953985691070557
Epoch: 20, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.157 Vali Acc: 0.490 Test Loss: 1.157 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.753495454788208
Epoch: 21, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.264 Vali Acc: 0.470 Test Loss: 1.264 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 32114
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8615756034851074
Epoch: 1, Steps: 20 | Train Loss: 0.790 Vali Loss: 0.698 Vali Acc: 0.520 Test Loss: 0.698 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.1550531387329102
Epoch: 2, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.735 Vali Acc: 0.470 Test Loss: 0.735 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.112412452697754
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.172821044921875
Epoch: 4, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.773 Vali Acc: 0.490 Test Loss: 0.773 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1463348865509033
Epoch: 5, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.758 Vali Acc: 0.510 Test Loss: 0.758 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1781575679779053
Epoch: 6, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 1.1660346984863281
Epoch: 7, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.789 Vali Acc: 0.540 Test Loss: 0.789 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.114555835723877
Epoch: 8, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.827 Vali Acc: 0.490 Test Loss: 0.827 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2706208229064941
Epoch: 9, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.791 Vali Acc: 0.560 Test Loss: 0.791 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 1.1882905960083008
Epoch: 10, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.866 Vali Acc: 0.510 Test Loss: 0.866 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.241201400756836
Epoch: 11, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.960 Vali Acc: 0.530 Test Loss: 0.960 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2458295822143555
Epoch: 12, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.855 Vali Acc: 0.540 Test Loss: 0.855 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2815630435943604
Epoch: 13, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.871 Vali Acc: 0.530 Test Loss: 0.871 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2106900215148926
Epoch: 14, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.133 Vali Acc: 0.480 Test Loss: 1.133 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0944633483886719
Epoch: 15, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.934 Vali Acc: 0.530 Test Loss: 0.934 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3088977336883545
Epoch: 16, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.940 Vali Acc: 0.530 Test Loss: 0.940 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.077054500579834
Epoch: 17, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.186 Vali Acc: 0.530 Test Loss: 1.186 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.463693618774414
Epoch: 18, Steps: 20 | Train Loss: 0.346 Vali Loss: 0.961 Vali Acc: 0.530 Test Loss: 0.961 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2900009155273438
Epoch: 19, Steps: 20 | Train Loss: 0.290 Vali Loss: 0.985 Vali Acc: 0.530 Test Loss: 0.985 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 24962
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2223567962646484
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.2934598922729492
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.747 Vali Acc: 0.560 Test Loss: 0.747 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.399444580078125
Epoch: 3, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3927171230316162
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3382649421691895
Epoch: 5, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.779 Vali Acc: 0.470 Test Loss: 0.779 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.183664083480835
Epoch: 6, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3131599426269531
Epoch: 7, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.825 Vali Acc: 0.480 Test Loss: 0.825 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3671023845672607
Epoch: 8, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.825 Vali Acc: 0.480 Test Loss: 0.825 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.298471450805664
Epoch: 9, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.842 Vali Acc: 0.490 Test Loss: 0.842 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2438018321990967
Epoch: 10, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.832 Vali Acc: 0.540 Test Loss: 0.832 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3230311870574951
Epoch: 11, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.814 Vali Acc: 0.510 Test Loss: 0.814 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2593824863433838
Epoch: 12, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 20530
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3434813022613525
Epoch: 1, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.797 Vali Acc: 0.450 Test Loss: 0.797 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 1.242323637008667
Epoch: 2, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.757 Vali Acc: 0.420 Test Loss: 0.757 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3832428455352783
Epoch: 3, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
Validation loss decreased (-0.449992 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 1.2709972858428955
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.789 Vali Acc: 0.520 Test Loss: 0.789 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 1.4068653583526611
Epoch: 5, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2741756439208984
Epoch: 6, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.783 Vali Acc: 0.530 Test Loss: 0.783 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 7 cost time: 1.3552727699279785
Epoch: 7, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4167146682739258
Epoch: 8, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.954 Vali Acc: 0.500 Test Loss: 0.954 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.477654218673706
Epoch: 9, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.859 Vali Acc: 0.470 Test Loss: 0.859 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2518539428710938
Epoch: 10, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.986 Vali Acc: 0.490 Test Loss: 0.986 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3583638668060303
Epoch: 11, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.819 Vali Acc: 0.540 Test Loss: 0.819 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 12 cost time: 1.4335594177246094
Epoch: 12, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.858 Vali Acc: 0.520 Test Loss: 0.858 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4186322689056396
Epoch: 13, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.800 Vali Acc: 0.540 Test Loss: 0.800 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539992).  Saving model ...
Epoch: 14 cost time: 1.272524118423462
Epoch: 14, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.853 Vali Acc: 0.510 Test Loss: 0.853 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2326853275299072
Epoch: 15, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.868 Vali Acc: 0.530 Test Loss: 0.868 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2597923278808594
Epoch: 16, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.872 Vali Acc: 0.480 Test Loss: 0.872 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3671979904174805
Epoch: 17, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.931 Vali Acc: 0.480 Test Loss: 0.931 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3607847690582275
Epoch: 18, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.963 Vali Acc: 0.470 Test Loss: 0.963 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2130072116851807
Epoch: 19, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.882 Vali Acc: 0.500 Test Loss: 0.882 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1793913841247559
Epoch: 20, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.039 Vali Acc: 0.480 Test Loss: 1.039 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1691761016845703
Epoch: 21, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.024 Vali Acc: 0.480 Test Loss: 1.024 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4077401161193848
Epoch: 22, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.980 Vali Acc: 0.490 Test Loss: 0.980 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2790915966033936
Epoch: 23, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.029 Vali Acc: 0.500 Test Loss: 1.029 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 18770
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8602724075317383
Epoch: 1, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.713 Vali Acc: 0.460 Test Loss: 0.713 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.3231151103973389
Epoch: 2, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.28586745262146
Epoch: 3, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.3081252574920654
Epoch: 4, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 1.0827059745788574
Epoch: 5, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.759 Vali Acc: 0.530 Test Loss: 0.759 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 1.2864375114440918
Epoch: 6, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.772 Vali Acc: 0.520 Test Loss: 0.772 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2566206455230713
Epoch: 7, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.772 Vali Acc: 0.560 Test Loss: 0.772 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 1.487159252166748
Epoch: 8, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.831 Vali Acc: 0.500 Test Loss: 0.831 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4271061420440674
Epoch: 9, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.806 Vali Acc: 0.490 Test Loss: 0.806 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2852282524108887
Epoch: 10, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.776 Vali Acc: 0.530 Test Loss: 0.776 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.286865472793579
Epoch: 11, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.783 Vali Acc: 0.530 Test Loss: 0.783 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3012049198150635
Epoch: 12, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.799 Vali Acc: 0.490 Test Loss: 0.799 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2373590469360352
Epoch: 13, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.854 Vali Acc: 0.480 Test Loss: 0.854 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3118531703948975
Epoch: 14, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.787 Vali Acc: 0.520 Test Loss: 0.787 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.279630184173584
Epoch: 15, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.887 Vali Acc: 0.530 Test Loss: 0.887 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2986793518066406
Epoch: 16, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2648890018463135
Epoch: 17, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 16130
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.563471794128418
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.768 Vali Acc: 0.470 Test Loss: 0.768 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 1.8337738513946533
Epoch: 2, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.983 Vali Acc: 0.510 Test Loss: 0.983 Test Acc: 0.510
Validation loss decreased (-0.469992 --> -0.509990).  Saving model ...
Epoch: 3 cost time: 1.824815273284912
Epoch: 3, Steps: 20 | Train Loss: 0.805 Vali Loss: 0.833 Vali Acc: 0.470 Test Loss: 0.833 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0094947814941406
Epoch: 4, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.829 Vali Acc: 0.470 Test Loss: 0.829 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.764127492904663
Epoch: 5, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.859 Vali Acc: 0.530 Test Loss: 0.859 Test Acc: 0.530
Validation loss decreased (-0.509990 --> -0.529991).  Saving model ...
Epoch: 6 cost time: 1.995863914489746
Epoch: 6, Steps: 20 | Train Loss: 0.703 Vali Loss: 1.073 Vali Acc: 0.500 Test Loss: 1.073 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9607548713684082
Epoch: 7, Steps: 20 | Train Loss: 0.588 Vali Loss: 1.064 Vali Acc: 0.510 Test Loss: 1.064 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9942679405212402
Epoch: 8, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.897 Vali Acc: 0.480 Test Loss: 0.897 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9271774291992188
Epoch: 9, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.905 Vali Acc: 0.480 Test Loss: 0.905 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7998361587524414
Epoch: 10, Steps: 20 | Train Loss: 0.456 Vali Loss: 1.047 Vali Acc: 0.530 Test Loss: 1.047 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.856351375579834
Epoch: 11, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.938 Vali Acc: 0.530 Test Loss: 0.938 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.885875940322876
Epoch: 12, Steps: 20 | Train Loss: 0.381 Vali Loss: 1.056 Vali Acc: 0.500 Test Loss: 1.056 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.1977591514587402
Epoch: 13, Steps: 20 | Train Loss: 0.421 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9233427047729492
Epoch: 14, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.590 Vali Acc: 0.510 Test Loss: 1.590 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0844550132751465
Epoch: 15, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.162 Vali Acc: 0.480 Test Loss: 1.162 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 50258
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3927855491638184
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.703 Vali Acc: 0.530 Test Loss: 0.703 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.863312005996704
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7420165538787842
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.815 Vali Acc: 0.470 Test Loss: 0.815 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.673785924911499
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9103879928588867
Epoch: 5, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7697758674621582
Epoch: 6, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.799 Vali Acc: 0.440 Test Loss: 0.799 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8705556392669678
Epoch: 7, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8539543151855469
Epoch: 8, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.801 Vali Acc: 0.480 Test Loss: 0.801 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8393149375915527
Epoch: 9, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.863 Vali Acc: 0.480 Test Loss: 0.863 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7697324752807617
Epoch: 10, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.868 Vali Acc: 0.500 Test Loss: 0.868 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8210077285766602
Epoch: 11, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.932 Vali Acc: 0.480 Test Loss: 0.932 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 27874
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.437880516052246
Epoch: 1, Steps: 20 | Train Loss: 0.787 Vali Loss: 0.761 Vali Acc: 0.490 Test Loss: 0.761 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.7772996425628662
Epoch: 2, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 1.8640515804290771
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.789 Vali Acc: 0.480 Test Loss: 0.789 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6574769020080566
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.836 Vali Acc: 0.480 Test Loss: 0.836 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6689207553863525
Epoch: 5, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.846 Vali Acc: 0.450 Test Loss: 0.846 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3946645259857178
Epoch: 6, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.859 Vali Acc: 0.480 Test Loss: 0.859 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.485680341720581
Epoch: 7, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.837 Vali Acc: 0.530 Test Loss: 0.837 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4686193466186523
Epoch: 8, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.823 Vali Acc: 0.550 Test Loss: 0.823 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 1.5488810539245605
Epoch: 9, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.856 Vali Acc: 0.540 Test Loss: 0.856 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4547767639160156
Epoch: 10, Steps: 20 | Train Loss: 0.506 Vali Loss: 1.067 Vali Acc: 0.510 Test Loss: 1.067 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7057135105133057
Epoch: 11, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.957 Vali Acc: 0.520 Test Loss: 0.957 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.637444019317627
Epoch: 12, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.947 Vali Acc: 0.520 Test Loss: 0.947 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.863985538482666
Epoch: 13, Steps: 20 | Train Loss: 0.440 Vali Loss: 1.134 Vali Acc: 0.510 Test Loss: 1.134 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6073851585388184
Epoch: 14, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.334 Vali Acc: 0.490 Test Loss: 1.334 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.745497465133667
Epoch: 15, Steps: 20 | Train Loss: 0.378 Vali Loss: 1.028 Vali Acc: 0.550 Test Loss: 1.028 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.733684778213501
Epoch: 16, Steps: 20 | Train Loss: 0.420 Vali Loss: 1.119 Vali Acc: 0.470 Test Loss: 1.119 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6240136623382568
Epoch: 17, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.171 Vali Acc: 0.470 Test Loss: 1.171 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.749509572982788
Epoch: 18, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.221 Vali Acc: 0.520 Test Loss: 1.221 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 27890
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8092775344848633
Epoch: 1, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.731 Vali Acc: 0.600 Test Loss: 0.731 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 1.0865890979766846
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0280375480651855
Epoch: 3, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0621721744537354
Epoch: 4, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1339871883392334
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0249691009521484
Epoch: 6, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.814 Vali Acc: 0.490 Test Loss: 0.814 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0477478504180908
Epoch: 7, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.841 Vali Acc: 0.530 Test Loss: 0.841 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0616397857666016
Epoch: 8, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.861 Vali Acc: 0.560 Test Loss: 0.861 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0075621604919434
Epoch: 9, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.793 Vali Acc: 0.490 Test Loss: 0.793 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0610790252685547
Epoch: 10, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.840 Vali Acc: 0.490 Test Loss: 0.840 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9992938041687012
Epoch: 11, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.875 Vali Acc: 0.490 Test Loss: 0.875 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 20738
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.007577896118164
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.720 Vali Acc: 0.450 Test Loss: 0.720 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.2251901626586914
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.762 Vali Acc: 0.480 Test Loss: 0.762 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 1.193068265914917
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.744 Vali Acc: 0.460 Test Loss: 0.744 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.295748233795166
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.853 Vali Acc: 0.510 Test Loss: 0.853 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509991).  Saving model ...
Epoch: 5 cost time: 1.2751500606536865
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
Validation loss decreased (-0.509991 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 1.2993242740631104
Epoch: 6, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.801 Vali Acc: 0.480 Test Loss: 0.801 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1857917308807373
Epoch: 7, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.862 Vali Acc: 0.450 Test Loss: 0.862 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2358291149139404
Epoch: 8, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.797 Vali Acc: 0.560 Test Loss: 0.797 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 9 cost time: 1.324986457824707
Epoch: 9, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.859 Vali Acc: 0.490 Test Loss: 0.859 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.229837417602539
Epoch: 10, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.911 Vali Acc: 0.480 Test Loss: 0.911 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2673966884613037
Epoch: 11, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.907 Vali Acc: 0.480 Test Loss: 0.907 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1938068866729736
Epoch: 12, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.823 Vali Acc: 0.510 Test Loss: 0.823 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1822404861450195
Epoch: 13, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.856 Vali Acc: 0.420 Test Loss: 0.856 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3684160709381104
Epoch: 14, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.992 Vali Acc: 0.540 Test Loss: 0.992 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1937534809112549
Epoch: 15, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.836 Vali Acc: 0.480 Test Loss: 0.836 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2550535202026367
Epoch: 16, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.848 Vali Acc: 0.480 Test Loss: 0.848 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3209481239318848
Epoch: 17, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.894 Vali Acc: 0.460 Test Loss: 0.894 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2241270542144775
Epoch: 18, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.935 Vali Acc: 0.500 Test Loss: 0.935 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 16306
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.167415142059326
Epoch: 1, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.4517130851745605
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.3337762355804443
Epoch: 3, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4250245094299316
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.318117380142212
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.787 Vali Acc: 0.510 Test Loss: 0.787 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2716636657714844
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.802 Vali Acc: 0.490 Test Loss: 0.802 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.196976661682129
Epoch: 7, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.779 Vali Acc: 0.510 Test Loss: 0.779 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3298590183258057
Epoch: 8, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 1.173964262008667
Epoch: 9, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 10 cost time: 1.202209711074829
Epoch: 10, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2123160362243652
Epoch: 11, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.837 Vali Acc: 0.540 Test Loss: 0.837 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3158791065216064
Epoch: 12, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.344895839691162
Epoch: 13, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.839 Vali Acc: 0.560 Test Loss: 0.839 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 14 cost time: 1.2983124256134033
Epoch: 14, Steps: 20 | Train Loss: 0.501 Vali Loss: 1.077 Vali Acc: 0.530 Test Loss: 1.077 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3614394664764404
Epoch: 15, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.843 Vali Acc: 0.510 Test Loss: 0.843 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3320319652557373
Epoch: 16, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.042 Vali Acc: 0.470 Test Loss: 1.042 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2155508995056152
Epoch: 17, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.887 Vali Acc: 0.500 Test Loss: 0.887 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2513465881347656
Epoch: 18, Steps: 20 | Train Loss: 0.433 Vali Loss: 1.010 Vali Acc: 0.470 Test Loss: 1.010 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3560001850128174
Epoch: 19, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.957 Vali Acc: 0.520 Test Loss: 0.957 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2409014701843262
Epoch: 20, Steps: 20 | Train Loss: 0.368 Vali Loss: 1.005 Vali Acc: 0.530 Test Loss: 1.005 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2676010131835938
Epoch: 21, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.951 Vali Acc: 0.490 Test Loss: 0.951 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3256194591522217
Epoch: 22, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.962 Vali Acc: 0.500 Test Loss: 0.962 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2113182544708252
Epoch: 23, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.035 Vali Acc: 0.540 Test Loss: 1.035 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 14546
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0407302379608154
Epoch: 1, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.2654359340667725
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2720863819122314
Epoch: 3, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.729 Vali Acc: 0.580 Test Loss: 0.729 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 1.2073497772216797
Epoch: 4, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1388435363769531
Epoch: 5, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1865222454071045
Epoch: 6, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.293832778930664
Epoch: 7, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.800 Vali Acc: 0.580 Test Loss: 0.800 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2781610488891602
Epoch: 8, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.763 Vali Acc: 0.560 Test Loss: 0.763 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2595953941345215
Epoch: 9, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.823 Vali Acc: 0.540 Test Loss: 0.823 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3201103210449219
Epoch: 10, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.861 Vali Acc: 0.530 Test Loss: 0.861 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2703168392181396
Epoch: 11, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2318077087402344
Epoch: 12, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.777 Vali Acc: 0.520 Test Loss: 0.777 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3101904392242432
Epoch: 13, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.779 Vali Acc: 0.550 Test Loss: 0.779 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 11906
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.614081621170044
Epoch: 1, Steps: 20 | Train Loss: 0.777 Vali Loss: 0.828 Vali Acc: 0.530 Test Loss: 0.828 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.036372184753418
Epoch: 2, Steps: 20 | Train Loss: 0.752 Vali Loss: 1.121 Vali Acc: 0.510 Test Loss: 1.121 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7696373462677002
Epoch: 3, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.805 Vali Acc: 0.480 Test Loss: 0.805 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9618752002716064
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.883 Vali Acc: 0.430 Test Loss: 0.883 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9266357421875
Epoch: 5, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.942 Vali Acc: 0.550 Test Loss: 0.942 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 1.8408288955688477
Epoch: 6, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.948 Vali Acc: 0.420 Test Loss: 0.948 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0074996948242188
Epoch: 7, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.988 Vali Acc: 0.530 Test Loss: 0.988 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9249892234802246
Epoch: 8, Steps: 20 | Train Loss: 0.528 Vali Loss: 1.459 Vali Acc: 0.520 Test Loss: 1.459 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.078817844390869
Epoch: 9, Steps: 20 | Train Loss: 0.750 Vali Loss: 1.306 Vali Acc: 0.510 Test Loss: 1.306 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0800812244415283
Epoch: 10, Steps: 20 | Train Loss: 0.496 Vali Loss: 1.017 Vali Acc: 0.520 Test Loss: 1.017 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.12890362739563
Epoch: 11, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.315 Vali Acc: 0.460 Test Loss: 1.315 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7043402194976807
Epoch: 12, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.510 Vali Acc: 0.500 Test Loss: 1.510 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8647704124450684
Epoch: 13, Steps: 20 | Train Loss: 0.502 Vali Loss: 1.205 Vali Acc: 0.480 Test Loss: 1.205 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.755199670791626
Epoch: 14, Steps: 20 | Train Loss: 0.354 Vali Loss: 1.164 Vali Acc: 0.470 Test Loss: 1.164 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.725701093673706
Epoch: 15, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.270 Vali Acc: 0.540 Test Loss: 1.270 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 48146
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3139560222625732
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.811535358428955
Epoch: 2, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8108787536621094
Epoch: 3, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9024500846862793
Epoch: 4, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8001949787139893
Epoch: 5, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.801 Vali Acc: 0.500 Test Loss: 0.801 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.795412540435791
Epoch: 6, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.777 Vali Acc: 0.550 Test Loss: 0.777 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8776452541351318
Epoch: 7, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.790635347366333
Epoch: 8, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.186 Vali Acc: 0.550 Test Loss: 1.186 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.813262939453125
Epoch: 9, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.915 Vali Acc: 0.460 Test Loss: 0.915 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7764923572540283
Epoch: 10, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.087 Vali Acc: 0.510 Test Loss: 1.087 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7905592918395996
Epoch: 11, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.884 Vali Acc: 0.530 Test Loss: 0.884 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 25762
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.462556838989258
Epoch: 1, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.734 Vali Acc: 0.520 Test Loss: 0.734 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.5585346221923828
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.763 Vali Acc: 0.500 Test Loss: 0.763 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7244932651519775
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.796 Vali Acc: 0.520 Test Loss: 0.796 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7077910900115967
Epoch: 4, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.945 Vali Acc: 0.490 Test Loss: 0.945 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7799456119537354
Epoch: 5, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.812 Vali Acc: 0.520 Test Loss: 0.812 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7027125358581543
Epoch: 6, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.981 Vali Acc: 0.500 Test Loss: 0.981 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7957768440246582
Epoch: 7, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.945 Vali Acc: 0.460 Test Loss: 0.945 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.125755548477173
Epoch: 8, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.943 Vali Acc: 0.460 Test Loss: 0.943 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9971418380737305
Epoch: 9, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.911 Vali Acc: 0.490 Test Loss: 0.911 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1744585037231445
Epoch: 10, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.948 Vali Acc: 0.450 Test Loss: 0.948 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.1352124214172363
Epoch: 11, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.927 Vali Acc: 0.510 Test Loss: 0.927 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 25778
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9705235958099365
Epoch: 1, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.785 Vali Acc: 0.450 Test Loss: 0.785 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 1.3120958805084229
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
Validation loss decreased (-0.449992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.3347315788269043
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.793 Vali Acc: 0.450 Test Loss: 0.793 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3108642101287842
Epoch: 4, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.830 Vali Acc: 0.490 Test Loss: 0.830 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3544983863830566
Epoch: 5, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.882 Vali Acc: 0.530 Test Loss: 0.882 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529991).  Saving model ...
Epoch: 6 cost time: 1.1542408466339111
Epoch: 6, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.753 Vali Acc: 0.520 Test Loss: 0.753 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3390302658081055
Epoch: 7, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.871 Vali Acc: 0.510 Test Loss: 0.871 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3181941509246826
Epoch: 8, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4020750522613525
Epoch: 9, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.881 Vali Acc: 0.500 Test Loss: 0.881 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2811853885650635
Epoch: 10, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.848 Vali Acc: 0.480 Test Loss: 0.848 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3153009414672852
Epoch: 11, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.902 Vali Acc: 0.480 Test Loss: 0.902 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3183801174163818
Epoch: 12, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.837 Vali Acc: 0.510 Test Loss: 0.837 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2831239700317383
Epoch: 13, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.933 Vali Acc: 0.500 Test Loss: 0.933 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.352931022644043
Epoch: 14, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.906 Vali Acc: 0.510 Test Loss: 0.906 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3393571376800537
Epoch: 15, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.896 Vali Acc: 0.500 Test Loss: 0.896 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 18626
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.177309274673462
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.4730818271636963
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.758 Vali Acc: 0.510 Test Loss: 0.758 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2276837825775146
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2250723838806152
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.836 Vali Acc: 0.490 Test Loss: 0.836 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1973490715026855
Epoch: 5, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.776 Vali Acc: 0.490 Test Loss: 0.776 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2130827903747559
Epoch: 6, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.793 Vali Acc: 0.510 Test Loss: 0.793 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2696771621704102
Epoch: 7, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.781 Vali Acc: 0.530 Test Loss: 0.781 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 8 cost time: 1.3280837535858154
Epoch: 8, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.802 Vali Acc: 0.540 Test Loss: 0.802 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 9 cost time: 1.2906596660614014
Epoch: 9, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.809 Vali Acc: 0.490 Test Loss: 0.809 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1555087566375732
Epoch: 10, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.834 Vali Acc: 0.520 Test Loss: 0.834 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.201556921005249
Epoch: 11, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.861 Vali Acc: 0.470 Test Loss: 0.861 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2073776721954346
Epoch: 12, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.930 Vali Acc: 0.510 Test Loss: 0.930 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3527092933654785
Epoch: 13, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.860 Vali Acc: 0.520 Test Loss: 0.860 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3078560829162598
Epoch: 14, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.848 Vali Acc: 0.500 Test Loss: 0.848 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3481934070587158
Epoch: 15, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.878 Vali Acc: 0.480 Test Loss: 0.878 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3611927032470703
Epoch: 16, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.892 Vali Acc: 0.450 Test Loss: 0.892 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3768346309661865
Epoch: 17, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.910 Vali Acc: 0.500 Test Loss: 0.910 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2032241821289062
Epoch: 18, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.056 Vali Acc: 0.520 Test Loss: 1.056 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 14194
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2795307636260986
Epoch: 1, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.740 Vali Acc: 0.460 Test Loss: 0.740 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.3240206241607666
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.1788125038146973
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.238600730895996
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3905973434448242
Epoch: 5, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.808 Vali Acc: 0.530 Test Loss: 0.808 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 1.2956724166870117
Epoch: 6, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.761 Vali Acc: 0.480 Test Loss: 0.761 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3046574592590332
Epoch: 7, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.796 Vali Acc: 0.520 Test Loss: 0.796 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2834680080413818
Epoch: 8, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.792 Vali Acc: 0.550 Test Loss: 0.792 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 1.2349512577056885
Epoch: 9, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.788 Vali Acc: 0.490 Test Loss: 0.788 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2708513736724854
Epoch: 10, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.277785301208496
Epoch: 11, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.900 Vali Acc: 0.500 Test Loss: 0.900 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1229217052459717
Epoch: 12, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3689568042755127
Epoch: 13, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.928 Vali Acc: 0.470 Test Loss: 0.928 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1260099411010742
Epoch: 14, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.877 Vali Acc: 0.510 Test Loss: 0.877 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1629245281219482
Epoch: 15, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.902 Vali Acc: 0.520 Test Loss: 0.902 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.250107765197754
Epoch: 16, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.848 Vali Acc: 0.570 Test Loss: 0.848 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 17 cost time: 1.2889087200164795
Epoch: 17, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.943 Vali Acc: 0.520 Test Loss: 0.943 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1782610416412354
Epoch: 18, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.872 Vali Acc: 0.550 Test Loss: 0.872 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.250817060470581
Epoch: 19, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.962 Vali Acc: 0.500 Test Loss: 0.962 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2426362037658691
Epoch: 20, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.102 Vali Acc: 0.480 Test Loss: 1.102 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1997284889221191
Epoch: 21, Steps: 20 | Train Loss: 0.385 Vali Loss: 1.023 Vali Acc: 0.470 Test Loss: 1.023 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2451446056365967
Epoch: 22, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.988 Vali Acc: 0.460 Test Loss: 0.988 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.318047046661377
Epoch: 23, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.126 Vali Acc: 0.470 Test Loss: 1.126 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.354112148284912
Epoch: 24, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.106 Vali Acc: 0.490 Test Loss: 1.106 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3855812549591064
Epoch: 25, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.041 Vali Acc: 0.500 Test Loss: 1.041 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4039645195007324
Epoch: 26, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.189 Vali Acc: 0.410 Test Loss: 1.189 Test Acc: 0.410
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 12434
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.025698184967041
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.3267803192138672
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.735 Vali Acc: 0.560 Test Loss: 0.735 Test Acc: 0.560
Validation loss decreased (-0.489993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.2778029441833496
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.201927900314331
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.739 Vali Acc: 0.560 Test Loss: 0.739 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1150445938110352
Epoch: 5, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1680214405059814
Epoch: 6, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.750 Vali Acc: 0.540 Test Loss: 0.750 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1529223918914795
Epoch: 7, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.766 Vali Acc: 0.470 Test Loss: 0.766 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1540262699127197
Epoch: 8, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1156301498413086
Epoch: 9, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1683549880981445
Epoch: 10, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1998326778411865
Epoch: 11, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.816 Vali Acc: 0.550 Test Loss: 0.816 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2118549346923828
Epoch: 12, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.793 Vali Acc: 0.560 Test Loss: 0.793 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_PatchTST_UEA_ftM_sl50_ll0_pl0_el1_dm16_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9794
model size : 0.35MB
