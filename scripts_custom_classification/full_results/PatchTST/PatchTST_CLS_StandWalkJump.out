Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.15124773979187
Epoch: 1, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7938942909240723
Epoch: 2, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6733369827270508
Epoch: 3, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7292370796203613
Epoch: 4, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.800788164138794
Epoch: 5, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6545307636260986
Epoch: 6, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6596992015838623
Epoch: 7, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.706284761428833
Epoch: 8, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6747300624847412
Epoch: 9, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.008 Vali Acc: 0.400 Test Loss: 1.008 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8164012432098389
Epoch: 10, Steps: 1 | Train Loss: 0.300 Vali Loss: 0.966 Vali Acc: 0.467 Test Loss: 0.966 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 11 cost time: 0.7159984111785889
Epoch: 11, Steps: 1 | Train Loss: 0.226 Vali Loss: 0.943 Vali Acc: 0.467 Test Loss: 0.943 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 12 cost time: 0.9461593627929688
Epoch: 12, Steps: 1 | Train Loss: 0.158 Vali Loss: 0.949 Vali Acc: 0.400 Test Loss: 0.949 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.729393482208252
Epoch: 13, Steps: 1 | Train Loss: 0.101 Vali Loss: 0.975 Vali Acc: 0.400 Test Loss: 0.975 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6955742835998535
Epoch: 14, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.008 Vali Acc: 0.400 Test Loss: 1.008 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7906575202941895
Epoch: 15, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7549037933349609
Epoch: 16, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8450567722320557
Epoch: 17, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1755971908569336
Epoch: 18, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7119162082672119
Epoch: 19, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7559034824371338
Epoch: 20, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6644394397735596
Epoch: 21, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 525571
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9617717266082764
Epoch: 1, Steps: 1 | Train Loss: 1.249 Vali Loss: 0.987 Vali Acc: 0.600 Test Loss: 0.987 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.6787843704223633
Epoch: 2, Steps: 1 | Train Loss: 1.294 Vali Loss: 0.981 Vali Acc: 0.600 Test Loss: 0.981 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.6678991317749023
Epoch: 3, Steps: 1 | Train Loss: 1.203 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.6633076667785645
Epoch: 4, Steps: 1 | Train Loss: 1.065 Vali Loss: 0.969 Vali Acc: 0.600 Test Loss: 0.969 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.6522679328918457
Epoch: 5, Steps: 1 | Train Loss: 1.055 Vali Loss: 0.964 Vali Acc: 0.600 Test Loss: 0.964 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.7519469261169434
Epoch: 6, Steps: 1 | Train Loss: 1.104 Vali Loss: 0.958 Vali Acc: 0.600 Test Loss: 0.958 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.7565608024597168
Epoch: 7, Steps: 1 | Train Loss: 0.890 Vali Loss: 0.951 Vali Acc: 0.600 Test Loss: 0.951 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 1.066305160522461
Epoch: 8, Steps: 1 | Train Loss: 0.748 Vali Loss: 0.944 Vali Acc: 0.600 Test Loss: 0.944 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599991).  Saving model ...
Epoch: 9 cost time: 0.7515749931335449
Epoch: 9, Steps: 1 | Train Loss: 0.659 Vali Loss: 0.938 Vali Acc: 0.600 Test Loss: 0.938 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 10 cost time: 0.7164711952209473
Epoch: 10, Steps: 1 | Train Loss: 0.442 Vali Loss: 0.931 Vali Acc: 0.600 Test Loss: 0.931 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 11 cost time: 0.759770393371582
Epoch: 11, Steps: 1 | Train Loss: 0.449 Vali Loss: 0.925 Vali Acc: 0.600 Test Loss: 0.925 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 12 cost time: 0.6866483688354492
Epoch: 12, Steps: 1 | Train Loss: 0.337 Vali Loss: 0.921 Vali Acc: 0.600 Test Loss: 0.921 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 13 cost time: 0.7016983032226562
Epoch: 13, Steps: 1 | Train Loss: 0.254 Vali Loss: 0.916 Vali Acc: 0.600 Test Loss: 0.916 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 14 cost time: 0.9569988250732422
Epoch: 14, Steps: 1 | Train Loss: 0.210 Vali Loss: 0.915 Vali Acc: 0.600 Test Loss: 0.915 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 15 cost time: 0.7090466022491455
Epoch: 15, Steps: 1 | Train Loss: 0.133 Vali Loss: 0.919 Vali Acc: 0.533 Test Loss: 0.919 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8628320693969727
Epoch: 16, Steps: 1 | Train Loss: 0.122 Vali Loss: 0.923 Vali Acc: 0.533 Test Loss: 0.923 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7692141532897949
Epoch: 17, Steps: 1 | Train Loss: 0.086 Vali Loss: 0.933 Vali Acc: 0.533 Test Loss: 0.933 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7934846878051758
Epoch: 18, Steps: 1 | Train Loss: 0.059 Vali Loss: 0.947 Vali Acc: 0.533 Test Loss: 0.947 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8410065174102783
Epoch: 19, Steps: 1 | Train Loss: 0.038 Vali Loss: 0.961 Vali Acc: 0.533 Test Loss: 0.961 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6437797546386719
Epoch: 20, Steps: 1 | Train Loss: 0.028 Vali Loss: 0.976 Vali Acc: 0.533 Test Loss: 0.976 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7274472713470459
Epoch: 21, Steps: 1 | Train Loss: 0.017 Vali Loss: 0.994 Vali Acc: 0.533 Test Loss: 0.994 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9879646301269531
Epoch: 22, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9050040245056152
Epoch: 23, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7821505069732666
Epoch: 24, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 473603
model size : 4.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.088892936706543
Epoch: 1, Steps: 1 | Train Loss: 1.417 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.8130273818969727
Epoch: 2, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.9365546703338623
Epoch: 3, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.6498117446899414
Epoch: 4, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.8213350772857666
Epoch: 5, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.6591777801513672
Epoch: 6, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6908128261566162
Epoch: 7, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.686347484588623
Epoch: 8, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.9331018924713135
Epoch: 9, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.8801336288452148
Epoch: 10, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.9743390083312988
Epoch: 11, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7153489589691162
Epoch: 12, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.8160495758056641
Epoch: 13, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.8299746513366699
Epoch: 14, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.9641375541687012
Epoch: 15, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.9356768131256104
Epoch: 16, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.9547197818756104
Epoch: 17, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.7960832118988037
Epoch: 18, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.667086124420166
Epoch: 19, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.9429304599761963
Epoch: 20, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9418351650238037
Epoch: 21, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8914000988006592
Epoch: 22, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.679018497467041
Epoch: 23, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6659796237945557
Epoch: 24, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8951265811920166
Epoch: 25, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7474753856658936
Epoch: 26, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8015861511230469
Epoch: 27, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.883643627166748
Epoch: 28, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0851616859436035
Epoch: 29, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 461699
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.136153221130371
Epoch: 1, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7918925285339355
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7027287483215332
Epoch: 3, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.8498275279998779
Epoch: 4, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.7376902103424072
Epoch: 5, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6870222091674805
Epoch: 6, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.763230562210083
Epoch: 7, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6923370361328125
Epoch: 8, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7268369197845459
Epoch: 9, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9069457054138184
Epoch: 10, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.042 Vali Acc: 0.333 Test Loss: 1.042 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9299309253692627
Epoch: 11, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.038 Vali Acc: 0.333 Test Loss: 1.038 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9731295108795166
Epoch: 12, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.033 Vali Acc: 0.333 Test Loss: 1.033 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9451842308044434
Epoch: 13, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 1.0898997783660889
Epoch: 14, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.023 Vali Acc: 0.400 Test Loss: 1.023 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 15 cost time: 1.0272307395935059
Epoch: 15, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 16 cost time: 0.7352535724639893
Epoch: 16, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.007 Vali Acc: 0.400 Test Loss: 1.007 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 17 cost time: 0.6855831146240234
Epoch: 17, Steps: 1 | Train Loss: 0.219 Vali Loss: 0.996 Vali Acc: 0.400 Test Loss: 0.996 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 18 cost time: 0.8874268531799316
Epoch: 18, Steps: 1 | Train Loss: 0.153 Vali Loss: 0.984 Vali Acc: 0.400 Test Loss: 0.984 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 19 cost time: 0.9468257427215576
Epoch: 19, Steps: 1 | Train Loss: 0.094 Vali Loss: 0.975 Vali Acc: 0.400 Test Loss: 0.975 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 20 cost time: 0.7873647212982178
Epoch: 20, Steps: 1 | Train Loss: 0.082 Vali Loss: 0.969 Vali Acc: 0.400 Test Loss: 0.969 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 21 cost time: 0.9627671241760254
Epoch: 21, Steps: 1 | Train Loss: 0.052 Vali Loss: 0.967 Vali Acc: 0.400 Test Loss: 0.967 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 22 cost time: 0.7456932067871094
Epoch: 22, Steps: 1 | Train Loss: 0.055 Vali Loss: 0.972 Vali Acc: 0.400 Test Loss: 0.972 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2522883415222168
Epoch: 23, Steps: 1 | Train Loss: 0.044 Vali Loss: 0.982 Vali Acc: 0.400 Test Loss: 0.982 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7843563556671143
Epoch: 24, Steps: 1 | Train Loss: 0.027 Vali Loss: 0.992 Vali Acc: 0.400 Test Loss: 0.992 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1005957126617432
Epoch: 25, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.003 Vali Acc: 0.400 Test Loss: 1.003 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8651168346405029
Epoch: 26, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8794341087341309
Epoch: 27, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9414303302764893
Epoch: 28, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9110934734344482
Epoch: 29, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0676400661468506
Epoch: 30, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.022270917892456
Epoch: 31, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 460419
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.422865867614746
Epoch: 1, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.9515228271484375
Epoch: 2, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.8292057514190674
Epoch: 3, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.176 Vali Acc: 0.467 Test Loss: 1.176 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.7059638500213623
Epoch: 4, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 1.0808794498443604
Epoch: 5, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.7522456645965576
Epoch: 6, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.7761199474334717
Epoch: 7, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.932257890701294
Epoch: 8, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 1.1046311855316162
Epoch: 9, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.9344303607940674
Epoch: 10, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.8159687519073486
Epoch: 11, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0596449375152588
Epoch: 12, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8808009624481201
Epoch: 13, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9517946243286133
Epoch: 14, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.032811164855957
Epoch: 15, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.007472038269043
Epoch: 16, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9023675918579102
Epoch: 17, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.833519458770752
Epoch: 18, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.013068675994873
Epoch: 19, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2494187355041504
Epoch: 20, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 465667
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1944589614868164
Epoch: 1, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.0826570987701416
Epoch: 2, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.8846817016601562
Epoch: 3, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 1.0816230773925781
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.9430315494537354
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.0589532852172852
Epoch: 6, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.9876482486724854
Epoch: 7, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.7041218280792236
Epoch: 8, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.9764101505279541
Epoch: 9, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.8568460941314697
Epoch: 10, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.9655101299285889
Epoch: 11, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.9032764434814453
Epoch: 12, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.7956204414367676
Epoch: 13, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.7399024963378906
Epoch: 14, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.7879829406738281
Epoch: 15, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.8861949443817139
Epoch: 16, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.8647477626800537
Epoch: 17, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.8589229583740234
Epoch: 18, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 1.3062212467193604
Epoch: 19, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.794020414352417
Epoch: 20, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.042 Vali Acc: 0.333 Test Loss: 1.042 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1932117938995361
Epoch: 21, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 22 cost time: 0.9372363090515137
Epoch: 22, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 23 cost time: 0.8219060897827148
Epoch: 23, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.019 Vali Acc: 0.467 Test Loss: 1.019 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 1.1254167556762695
Epoch: 24, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 25 cost time: 1.0003125667572021
Epoch: 25, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 26 cost time: 0.8034744262695312
Epoch: 26, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 27 cost time: 1.0266635417938232
Epoch: 27, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 28 cost time: 0.9374547004699707
Epoch: 28, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 29 cost time: 0.9842274188995361
Epoch: 29, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 30 cost time: 0.9340226650238037
Epoch: 30, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9636898040771484
Epoch: 31, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0763607025146484
Epoch: 32, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8904187679290771
Epoch: 33, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.983386754989624
Epoch: 34, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0681653022766113
Epoch: 35, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 36 cost time: 0.8906223773956299
Epoch: 36, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.861485481262207
Epoch: 37, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.008913516998291
Epoch: 38, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8606395721435547
Epoch: 39, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9536302089691162
Epoch: 40, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1451199054718018
Epoch: 41, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8219995498657227
Epoch: 42, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6184754371643066
Epoch: 43, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9177310466766357
Epoch: 44, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.931096076965332
Epoch: 45, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 477059
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.505558967590332
Epoch: 1, Steps: 1 | Train Loss: 1.411 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 1.0754547119140625
Epoch: 2, Steps: 1 | Train Loss: 1.518 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8429446220397949
Epoch: 3, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.8857665061950684
Epoch: 4, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.761631965637207
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.9771296977996826
Epoch: 6, Steps: 1 | Train Loss: 1.323 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.9918978214263916
Epoch: 7, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 1.128800868988037
Epoch: 8, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.9213109016418457
Epoch: 9, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.7519428730010986
Epoch: 10, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.7894287109375
Epoch: 11, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 1.012338399887085
Epoch: 12, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.839155912399292
Epoch: 13, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 1.392568588256836
Epoch: 14, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.8575670719146729
Epoch: 15, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.9668774604797363
Epoch: 16, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 1.1199097633361816
Epoch: 17, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.045 Vali Acc: 0.267 Test Loss: 1.045 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2499620914459229
Epoch: 18, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 0.7877407073974609
Epoch: 19, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 20 cost time: 0.7658636569976807
Epoch: 20, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 21 cost time: 0.7843704223632812
Epoch: 21, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 22 cost time: 0.6322832107543945
Epoch: 22, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 23 cost time: 0.7931039333343506
Epoch: 23, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.9135622978210449
Epoch: 24, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 0.7829430103302002
Epoch: 25, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 1.1058101654052734
Epoch: 26, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 27 cost time: 0.7777740955352783
Epoch: 27, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.007 Vali Acc: 0.667 Test Loss: 1.007 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 28 cost time: 1.0095348358154297
Epoch: 28, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.008 Vali Acc: 0.667 Test Loss: 1.008 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9769840240478516
Epoch: 29, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8126206398010254
Epoch: 30, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7810318470001221
Epoch: 31, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.015 Vali Acc: 0.600 Test Loss: 1.015 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8421545028686523
Epoch: 32, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8414325714111328
Epoch: 33, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.019 Vali Acc: 0.600 Test Loss: 1.019 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9616291522979736
Epoch: 34, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9027202129364014
Epoch: 35, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9177815914154053
Epoch: 36, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1161563396453857
Epoch: 37, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df256_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 488451
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.237618446350098
Epoch: 1, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.097193717956543
Epoch: 2, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.3751757144927979
Epoch: 3, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6645617485046387
Epoch: 4, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.0289757251739502
Epoch: 5, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.7881956100463867
Epoch: 6, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7500314712524414
Epoch: 7, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 8 cost time: 0.9152145385742188
Epoch: 8, Steps: 1 | Train Loss: 0.565 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 9 cost time: 0.8256957530975342
Epoch: 9, Steps: 1 | Train Loss: 0.381 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.9703464508056641
Epoch: 10, Steps: 1 | Train Loss: 0.296 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.967029333114624
Epoch: 11, Steps: 1 | Train Loss: 0.215 Vali Loss: 0.976 Vali Acc: 0.533 Test Loss: 0.976 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533324).  Saving model ...
Epoch: 12 cost time: 0.8663084506988525
Epoch: 12, Steps: 1 | Train Loss: 0.159 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 13 cost time: 0.8694369792938232
Epoch: 13, Steps: 1 | Train Loss: 0.086 Vali Loss: 0.962 Vali Acc: 0.533 Test Loss: 0.962 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 14 cost time: 0.9057767391204834
Epoch: 14, Steps: 1 | Train Loss: 0.071 Vali Loss: 0.956 Vali Acc: 0.467 Test Loss: 0.956 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7852973937988281
Epoch: 15, Steps: 1 | Train Loss: 0.045 Vali Loss: 0.964 Vali Acc: 0.400 Test Loss: 0.964 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7968137264251709
Epoch: 16, Steps: 1 | Train Loss: 0.025 Vali Loss: 0.986 Vali Acc: 0.333 Test Loss: 0.986 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.699984073638916
Epoch: 17, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8804738521575928
Epoch: 18, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.85634446144104
Epoch: 19, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0653982162475586
Epoch: 20, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1068758964538574
Epoch: 21, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1182751655578613
Epoch: 22, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0672807693481445
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 426883
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8068649768829346
Epoch: 1, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.1637451648712158
Epoch: 2, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 1.0416996479034424
Epoch: 3, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7761073112487793
Epoch: 4, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.8727502822875977
Epoch: 5, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2704575061798096
Epoch: 6, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.141815423965454
Epoch: 7, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.207390308380127
Epoch: 8, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0884265899658203
Epoch: 9, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1395535469055176
Epoch: 10, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.170703649520874
Epoch: 11, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1028285026550293
Epoch: 12, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1934452056884766
Epoch: 13, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9637508392333984
Epoch: 14, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 374915
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.213886022567749
Epoch: 1, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9079020023345947
Epoch: 2, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8368504047393799
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.740123987197876
Epoch: 4, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.715559720993042
Epoch: 5, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.9500682353973389
Epoch: 6, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.8131864070892334
Epoch: 7, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8727586269378662
Epoch: 8, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9926228523254395
Epoch: 9, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4296603202819824
Epoch: 10, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9981839656829834
Epoch: 11, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 1.0103955268859863
Epoch: 12, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.9104626178741455
Epoch: 13, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.8872323036193848
Epoch: 14, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.837761402130127
Epoch: 15, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9480488300323486
Epoch: 16, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8924221992492676
Epoch: 17, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1931285858154297
Epoch: 18, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0718128681182861
Epoch: 19, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0808584690093994
Epoch: 20, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9601180553436279
Epoch: 21, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8290398120880127
Epoch: 22, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.033912181854248
Epoch: 23, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8492121696472168
Epoch: 24, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 363011
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3827953338623047
Epoch: 1, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.9198040962219238
Epoch: 2, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.8596549034118652
Epoch: 3, Steps: 1 | Train Loss: 1.336 Vali Loss: 1.182 Vali Acc: 0.467 Test Loss: 1.182 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 1.1292781829833984
Epoch: 4, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.176 Vali Acc: 0.467 Test Loss: 1.176 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.7377328872680664
Epoch: 5, Steps: 1 | Train Loss: 1.342 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9953794479370117
Epoch: 6, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9823112487792969
Epoch: 7, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8114988803863525
Epoch: 8, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.051030158996582
Epoch: 9, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2440412044525146
Epoch: 10, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0940203666687012
Epoch: 11, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.796086311340332
Epoch: 12, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 1.3626453876495361
Epoch: 13, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.790503740310669
Epoch: 14, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.8448159694671631
Epoch: 15, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 1.0594282150268555
Epoch: 16, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.9498770236968994
Epoch: 17, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9201846122741699
Epoch: 18, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0092506408691406
Epoch: 19, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8597705364227295
Epoch: 20, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 1.1009321212768555
Epoch: 21, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 22 cost time: 1.2130870819091797
Epoch: 22, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 1.052872657775879
Epoch: 23, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 1.1863601207733154
Epoch: 24, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 1.025115966796875
Epoch: 25, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5173561573028564
Epoch: 26, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0203895568847656
Epoch: 27, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9099552631378174
Epoch: 28, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9078741073608398
Epoch: 29, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2099542617797852
Epoch: 30, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3293554782867432
Epoch: 31, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0930984020233154
Epoch: 32, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2188231945037842
Epoch: 33, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9766144752502441
Epoch: 34, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 361731
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.752087116241455
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.759861946105957
Epoch: 2, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.896151065826416
Epoch: 3, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.8312914371490479
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.733020544052124
Epoch: 5, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.8408098220825195
Epoch: 6, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.8527028560638428
Epoch: 7, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.8991742134094238
Epoch: 8, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.9634084701538086
Epoch: 9, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8137111663818359
Epoch: 10, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1079938411712646
Epoch: 11, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2207372188568115
Epoch: 12, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9721095561981201
Epoch: 13, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.006788730621338
Epoch: 14, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0941452980041504
Epoch: 15, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0237665176391602
Epoch: 16, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0981547832489014
Epoch: 17, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9736981391906738
Epoch: 18, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.9055659770965576
Epoch: 19, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 1.0455152988433838
Epoch: 20, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.9238991737365723
Epoch: 21, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.9501993656158447
Epoch: 22, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 1.1139280796051025
Epoch: 23, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.8032338619232178
Epoch: 24, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.7616310119628906
Epoch: 25, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8388257026672363
Epoch: 26, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1594312191009521
Epoch: 27, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.303553819656372
Epoch: 28, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.402564525604248
Epoch: 29, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 30 cost time: 1.2529511451721191
Epoch: 30, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0387547016143799
Epoch: 31, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8821895122528076
Epoch: 32, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8850870132446289
Epoch: 33, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9726576805114746
Epoch: 34, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0968568325042725
Epoch: 35, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8468973636627197
Epoch: 36, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8863470554351807
Epoch: 37, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8728296756744385
Epoch: 38, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0399565696716309
Epoch: 39, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 366979
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.358646869659424
Epoch: 1, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6815686225891113
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7924351692199707
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8268616199493408
Epoch: 4, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7380023002624512
Epoch: 5, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1139733791351318
Epoch: 6, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.8899276256561279
Epoch: 7, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.965348482131958
Epoch: 8, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.6453697681427002
Epoch: 9, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.7070283889770508
Epoch: 10, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 0.8435792922973633
Epoch: 11, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.7789828777313232
Epoch: 12, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.1033291816711426
Epoch: 13, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.7090623378753662
Epoch: 14, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.6880667209625244
Epoch: 15, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 16 cost time: 0.7397117614746094
Epoch: 16, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 17 cost time: 0.7648005485534668
Epoch: 17, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 18 cost time: 0.6417512893676758
Epoch: 18, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 19 cost time: 0.6460931301116943
Epoch: 19, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 20 cost time: 0.9418699741363525
Epoch: 20, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.8339290618896484
Epoch: 21, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.7212591171264648
Epoch: 22, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.6903629302978516
Epoch: 23, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 1.0460295677185059
Epoch: 24, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.014 Vali Acc: 0.600 Test Loss: 1.014 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.8082575798034668
Epoch: 25, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.8443336486816406
Epoch: 26, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.009 Vali Acc: 0.600 Test Loss: 1.009 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 27 cost time: 0.6763803958892822
Epoch: 27, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 28 cost time: 0.7730567455291748
Epoch: 28, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 29 cost time: 0.8346447944641113
Epoch: 29, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 30 cost time: 1.0005908012390137
Epoch: 30, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0103332996368408
Epoch: 31, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7830219268798828
Epoch: 32, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8884077072143555
Epoch: 33, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8798375129699707
Epoch: 34, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7443535327911377
Epoch: 35, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2807822227478027
Epoch: 36, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8652224540710449
Epoch: 37, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.012 Vali Acc: 0.600 Test Loss: 1.012 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7348334789276123
Epoch: 38, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6994490623474121
Epoch: 39, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.014 Vali Acc: 0.600 Test Loss: 1.014 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 378371
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0927562713623047
Epoch: 1, Steps: 1 | Train Loss: 1.315 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.1528849601745605
Epoch: 2, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6439230442047119
Epoch: 3, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.833810567855835
Epoch: 4, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6893796920776367
Epoch: 5, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.92852783203125
Epoch: 6, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7626488208770752
Epoch: 7, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.886439323425293
Epoch: 8, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.8006799221038818
Epoch: 9, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.7547321319580078
Epoch: 10, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.8234057426452637
Epoch: 11, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.8011596202850342
Epoch: 12, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 1.119901180267334
Epoch: 13, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.9127075672149658
Epoch: 14, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.8496048450469971
Epoch: 15, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.8366022109985352
Epoch: 16, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 1.057985782623291
Epoch: 17, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.8296411037445068
Epoch: 18, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.7690620422363281
Epoch: 19, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 1.0087940692901611
Epoch: 20, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 1.018510341644287
Epoch: 21, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.9630229473114014
Epoch: 22, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8555161952972412
Epoch: 23, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9747798442840576
Epoch: 24, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1289787292480469
Epoch: 25, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7614672183990479
Epoch: 26, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7958283424377441
Epoch: 27, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6701090335845947
Epoch: 28, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8894467353820801
Epoch: 29, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7373943328857422
Epoch: 30, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.666792631149292
Epoch: 31, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df128_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 389763
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0213751792907715
Epoch: 1, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.664278507232666
Epoch: 2, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.8631224632263184
Epoch: 3, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7247521877288818
Epoch: 4, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8665335178375244
Epoch: 5, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.6614933013916016
Epoch: 6, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7546956539154053
Epoch: 7, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.8770689964294434
Epoch: 8, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.7977993488311768
Epoch: 9, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.9009213447570801
Epoch: 10, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.7211325168609619
Epoch: 11, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6986453533172607
Epoch: 12, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.046 Vali Acc: 0.333 Test Loss: 1.046 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8448276519775391
Epoch: 13, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.041 Vali Acc: 0.333 Test Loss: 1.041 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7884833812713623
Epoch: 14, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9551858901977539
Epoch: 15, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7427904605865479
Epoch: 16, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.163 Vali Acc: 0.533 Test Loss: 1.163 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 0.8521044254302979
Epoch: 17, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.225 Vali Acc: 0.533 Test Loss: 1.225 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9131343364715576
Epoch: 18, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.280 Vali Acc: 0.467 Test Loss: 1.280 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7186017036437988
Epoch: 19, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.326 Vali Acc: 0.467 Test Loss: 1.326 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7725906372070312
Epoch: 20, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.365 Vali Acc: 0.467 Test Loss: 1.365 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8802757263183594
Epoch: 21, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.397 Vali Acc: 0.467 Test Loss: 1.397 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0505974292755127
Epoch: 22, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.425 Vali Acc: 0.467 Test Loss: 1.425 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8197193145751953
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.448 Vali Acc: 0.467 Test Loss: 1.448 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8914251327514648
Epoch: 24, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.468 Vali Acc: 0.467 Test Loss: 1.468 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9229793548583984
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.467 Test Loss: 1.487 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9639301300048828
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.467 Test Loss: 1.503 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 377539
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.520563840866089
Epoch: 1, Steps: 1 | Train Loss: 1.437 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.935697078704834
Epoch: 2, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.2080574035644531
Epoch: 3, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 1.0146772861480713
Epoch: 4, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.8268320560455322
Epoch: 5, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.9259612560272217
Epoch: 6, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 1.2914164066314697
Epoch: 7, Steps: 1 | Train Loss: 0.765 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.8931577205657959
Epoch: 8, Steps: 1 | Train Loss: 0.818 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 1.179103136062622
Epoch: 9, Steps: 1 | Train Loss: 0.686 Vali Loss: 0.983 Vali Acc: 0.600 Test Loss: 0.983 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.8272337913513184
Epoch: 10, Steps: 1 | Train Loss: 0.679 Vali Loss: 0.974 Vali Acc: 0.600 Test Loss: 0.974 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.985231876373291
Epoch: 11, Steps: 1 | Train Loss: 0.492 Vali Loss: 0.962 Vali Acc: 0.600 Test Loss: 0.962 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.9404852390289307
Epoch: 12, Steps: 1 | Train Loss: 0.375 Vali Loss: 0.950 Vali Acc: 0.667 Test Loss: 0.950 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 13 cost time: 0.6712965965270996
Epoch: 13, Steps: 1 | Train Loss: 0.272 Vali Loss: 0.936 Vali Acc: 0.600 Test Loss: 0.936 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1712732315063477
Epoch: 14, Steps: 1 | Train Loss: 0.221 Vali Loss: 0.926 Vali Acc: 0.600 Test Loss: 0.926 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7542762756347656
Epoch: 15, Steps: 1 | Train Loss: 0.160 Vali Loss: 0.920 Vali Acc: 0.600 Test Loss: 0.920 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7762010097503662
Epoch: 16, Steps: 1 | Train Loss: 0.128 Vali Loss: 0.922 Vali Acc: 0.667 Test Loss: 0.922 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 17 cost time: 0.7932298183441162
Epoch: 17, Steps: 1 | Train Loss: 0.106 Vali Loss: 0.929 Vali Acc: 0.667 Test Loss: 0.929 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1006672382354736
Epoch: 18, Steps: 1 | Train Loss: 0.068 Vali Loss: 0.934 Vali Acc: 0.667 Test Loss: 0.934 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.105464220046997
Epoch: 19, Steps: 1 | Train Loss: 0.055 Vali Loss: 0.945 Vali Acc: 0.667 Test Loss: 0.945 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0402555465698242
Epoch: 20, Steps: 1 | Train Loss: 0.030 Vali Loss: 0.955 Vali Acc: 0.667 Test Loss: 0.955 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0078577995300293
Epoch: 21, Steps: 1 | Train Loss: 0.027 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.076495885848999
Epoch: 22, Steps: 1 | Train Loss: 0.015 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9849424362182617
Epoch: 23, Steps: 1 | Train Loss: 0.011 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8412089347839355
Epoch: 24, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7132489681243896
Epoch: 25, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1045470237731934
Epoch: 26, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 325571
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.017627716064453
Epoch: 1, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7859842777252197
Epoch: 2, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8238580226898193
Epoch: 3, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0132474899291992
Epoch: 4, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9256033897399902
Epoch: 5, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0852959156036377
Epoch: 6, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.918950080871582
Epoch: 7, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.93115234375
Epoch: 8, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.9308459758758545
Epoch: 9, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.8427581787109375
Epoch: 10, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.754946231842041
Epoch: 11, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.6777641773223877
Epoch: 12, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.9134776592254639
Epoch: 13, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.8449068069458008
Epoch: 14, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.9621562957763672
Epoch: 15, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.877373218536377
Epoch: 16, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 1.0825014114379883
Epoch: 17, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1231765747070312
Epoch: 18, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 19 cost time: 1.1179959774017334
Epoch: 19, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.828035831451416
Epoch: 20, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9019184112548828
Epoch: 21, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.041654348373413
Epoch: 22, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1248319149017334
Epoch: 23, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9967498779296875
Epoch: 24, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1844782829284668
Epoch: 25, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.884570837020874
Epoch: 26, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9792780876159668
Epoch: 27, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.220 Vali Acc: 0.467 Test Loss: 1.220 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9829249382019043
Epoch: 28, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.229 Vali Acc: 0.467 Test Loss: 1.229 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 313667
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5059566497802734
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.302 Vali Acc: 0.400 Test Loss: 1.302 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.7089290618896484
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.274 Vali Acc: 0.400 Test Loss: 1.274 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.8794212341308594
Epoch: 3, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.249 Vali Acc: 0.467 Test Loss: 1.249 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466654).  Saving model ...
Epoch: 4 cost time: 0.7423291206359863
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.226 Vali Acc: 0.467 Test Loss: 1.226 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 5 cost time: 0.766350507736206
Epoch: 5, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.207 Vali Acc: 0.467 Test Loss: 1.207 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 1.1267802715301514
Epoch: 6, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.188 Vali Acc: 0.467 Test Loss: 1.188 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.9629504680633545
Epoch: 7, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 1.1128222942352295
Epoch: 8, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 1.0503549575805664
Epoch: 9, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.7440977096557617
Epoch: 10, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 1.163391351699829
Epoch: 11, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.8714649677276611
Epoch: 12, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 1.0642211437225342
Epoch: 13, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.878882884979248
Epoch: 14, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.9046239852905273
Epoch: 15, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.7240443229675293
Epoch: 16, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.084 Vali Acc: 0.667 Test Loss: 1.084 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 17 cost time: 1.3555841445922852
Epoch: 17, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.079 Vali Acc: 0.667 Test Loss: 1.079 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 18 cost time: 0.8991749286651611
Epoch: 18, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.074 Vali Acc: 0.667 Test Loss: 1.074 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 19 cost time: 0.9541547298431396
Epoch: 19, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.069 Vali Acc: 0.667 Test Loss: 1.069 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 20 cost time: 0.7350592613220215
Epoch: 20, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.063 Vali Acc: 0.667 Test Loss: 1.063 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 21 cost time: 0.7032039165496826
Epoch: 21, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.059 Vali Acc: 0.667 Test Loss: 1.059 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 22 cost time: 0.6137964725494385
Epoch: 22, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.056 Vali Acc: 0.667 Test Loss: 1.056 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 23 cost time: 1.129070520401001
Epoch: 23, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.053 Vali Acc: 0.667 Test Loss: 1.053 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 24 cost time: 0.7883217334747314
Epoch: 24, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.051 Vali Acc: 0.667 Test Loss: 1.051 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 25 cost time: 0.8426313400268555
Epoch: 25, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9250457286834717
Epoch: 26, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2134284973144531
Epoch: 27, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0140573978424072
Epoch: 28, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9548838138580322
Epoch: 29, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0447368621826172
Epoch: 30, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8827898502349854
Epoch: 31, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8890676498413086
Epoch: 32, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.738431453704834
Epoch: 33, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7131333351135254
Epoch: 34, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 312387
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3948071002960205
Epoch: 1, Steps: 1 | Train Loss: 1.350 Vali Loss: 1.243 Vali Acc: 0.200 Test Loss: 1.243 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8446741104125977
Epoch: 2, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.239 Vali Acc: 0.200 Test Loss: 1.239 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 1.0491125583648682
Epoch: 3, Steps: 1 | Train Loss: 1.309 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 1.0084600448608398
Epoch: 4, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 1.0356450080871582
Epoch: 5, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.228 Vali Acc: 0.200 Test Loss: 1.228 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 1.0498051643371582
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 1.1077861785888672
Epoch: 7, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 0.9969096183776855
Epoch: 8, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.9324440956115723
Epoch: 9, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.8618636131286621
Epoch: 10, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 1.0771129131317139
Epoch: 11, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.900503396987915
Epoch: 12, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9876525402069092
Epoch: 13, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8102915287017822
Epoch: 14, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9057555198669434
Epoch: 15, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9339454174041748
Epoch: 16, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1679039001464844
Epoch: 17, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2361249923706055
Epoch: 18, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9582369327545166
Epoch: 19, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0615580081939697
Epoch: 20, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8542375564575195
Epoch: 21, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 317635
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.956428050994873
Epoch: 1, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.0764412879943848
Epoch: 2, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.6542885303497314
Epoch: 3, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.723440408706665
Epoch: 4, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.716752290725708
Epoch: 5, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.7723202705383301
Epoch: 6, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6700670719146729
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7158806324005127
Epoch: 8, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.7776346206665039
Epoch: 9, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.8263459205627441
Epoch: 10, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.9433472156524658
Epoch: 11, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.6944475173950195
Epoch: 12, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8916573524475098
Epoch: 13, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7030248641967773
Epoch: 14, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6765334606170654
Epoch: 15, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8651669025421143
Epoch: 16, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6865458488464355
Epoch: 17, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.7005650997161865
Epoch: 18, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.7059032917022705
Epoch: 19, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.954833984375
Epoch: 20, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.7157187461853027
Epoch: 21, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.7144434452056885
Epoch: 22, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.8705363273620605
Epoch: 23, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 0.9267082214355469
Epoch: 24, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.8472716808319092
Epoch: 25, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.9375030994415283
Epoch: 26, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 27 cost time: 0.8493890762329102
Epoch: 27, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 28 cost time: 0.7709712982177734
Epoch: 28, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 29 cost time: 0.7550065517425537
Epoch: 29, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1289012432098389
Epoch: 30, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9301474094390869
Epoch: 31, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8547072410583496
Epoch: 32, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8812947273254395
Epoch: 33, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6233956813812256
Epoch: 34, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.777184247970581
Epoch: 35, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8098809719085693
Epoch: 36, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9652652740478516
Epoch: 37, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.798041582107544
Epoch: 38, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 329027
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.346883773803711
Epoch: 1, Steps: 1 | Train Loss: 1.305 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9432270526885986
Epoch: 2, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.9957642555236816
Epoch: 3, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.8574979305267334
Epoch: 4, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7373025417327881
Epoch: 5, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7278449535369873
Epoch: 6, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.9119894504547119
Epoch: 7, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.722097635269165
Epoch: 8, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.798708438873291
Epoch: 9, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.7298612594604492
Epoch: 10, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.9782209396362305
Epoch: 11, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.8091723918914795
Epoch: 12, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.7949788570404053
Epoch: 13, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.8920149803161621
Epoch: 14, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.8940935134887695
Epoch: 15, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.8883466720581055
Epoch: 16, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.9071919918060303
Epoch: 17, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.8814082145690918
Epoch: 18, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.7696235179901123
Epoch: 19, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 20 cost time: 0.9947855472564697
Epoch: 20, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 21 cost time: 0.7666916847229004
Epoch: 21, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 22 cost time: 0.7944226264953613
Epoch: 22, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.7862162590026855
Epoch: 23, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.9026401042938232
Epoch: 24, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9485809803009033
Epoch: 25, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8412246704101562
Epoch: 26, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7680037021636963
Epoch: 27, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7182269096374512
Epoch: 28, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8919262886047363
Epoch: 29, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 1.0158147811889648
Epoch: 30, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8958964347839355
Epoch: 31, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9622540473937988
Epoch: 32, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.763934850692749
Epoch: 33, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8192741870880127
Epoch: 34, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.829056978225708
Epoch: 35, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7322583198547363
Epoch: 36, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9954807758331299
Epoch: 37, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.061889886856079
Epoch: 38, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 39 cost time: 1.0353310108184814
Epoch: 39, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.092 Vali Acc: 0.600 Test Loss: 1.092 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9489614963531494
Epoch: 40, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6787190437316895
Epoch: 41, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.100 Vali Acc: 0.600 Test Loss: 1.100 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8866021633148193
Epoch: 42, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.102 Vali Acc: 0.667 Test Loss: 1.102 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 43 cost time: 1.1631672382354736
Epoch: 43, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.106 Vali Acc: 0.667 Test Loss: 1.106 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9935243129730225
Epoch: 44, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.109 Vali Acc: 0.667 Test Loss: 1.109 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1233294010162354
Epoch: 45, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.111 Vali Acc: 0.667 Test Loss: 1.111 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0137972831726074
Epoch: 46, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.114 Vali Acc: 0.667 Test Loss: 1.114 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0406348705291748
Epoch: 47, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.117 Vali Acc: 0.667 Test Loss: 1.117 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8440797328948975
Epoch: 48, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.120 Vali Acc: 0.667 Test Loss: 1.120 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9820220470428467
Epoch: 49, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.122 Vali Acc: 0.667 Test Loss: 1.122 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0055317878723145
Epoch: 50, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.125 Vali Acc: 0.667 Test Loss: 1.125 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.9421505928039551
Epoch: 51, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.127 Vali Acc: 0.667 Test Loss: 1.127 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.9846744537353516
Epoch: 52, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.129 Vali Acc: 0.667 Test Loss: 1.129 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm128_nh16_df64_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 340419
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.493136405944824
Epoch: 1, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.9258861541748047
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8863956928253174
Epoch: 3, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.8641347885131836
Epoch: 4, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8188583850860596
Epoch: 5, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0435898303985596
Epoch: 6, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 1.303961992263794
Epoch: 7, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2237789630889893
Epoch: 8, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1165940761566162
Epoch: 9, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.978374719619751
Epoch: 10, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1042633056640625
Epoch: 11, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.9006853103637695
Epoch: 12, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.035 Vali Acc: 0.333 Test Loss: 1.035 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 1.16159987449646
Epoch: 13, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.019 Vali Acc: 0.333 Test Loss: 1.019 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.9316682815551758
Epoch: 14, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466657).  Saving model ...
Epoch: 15 cost time: 1.0063550472259521
Epoch: 15, Steps: 1 | Train Loss: 0.200 Vali Loss: 0.988 Vali Acc: 0.467 Test Loss: 0.988 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 16 cost time: 0.8809826374053955
Epoch: 16, Steps: 1 | Train Loss: 0.161 Vali Loss: 0.979 Vali Acc: 0.400 Test Loss: 0.979 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8103599548339844
Epoch: 17, Steps: 1 | Train Loss: 0.134 Vali Loss: 0.975 Vali Acc: 0.467 Test Loss: 0.975 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 18 cost time: 1.0437076091766357
Epoch: 18, Steps: 1 | Train Loss: 0.123 Vali Loss: 0.980 Vali Acc: 0.467 Test Loss: 0.980 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8972611427307129
Epoch: 19, Steps: 1 | Train Loss: 0.091 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9935605525970459
Epoch: 20, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0029182434082031
Epoch: 21, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.038 Vali Acc: 0.333 Test Loss: 1.038 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1197803020477295
Epoch: 22, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8744902610778809
Epoch: 23, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9128100872039795
Epoch: 24, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.061527967453003
Epoch: 25, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0891859531402588
Epoch: 26, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9425547122955322
Epoch: 27, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 214019
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9615466594696045
Epoch: 1, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8296096324920654
Epoch: 2, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7092092037200928
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7405374050140381
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7467813491821289
Epoch: 5, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7537171840667725
Epoch: 6, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8221948146820068
Epoch: 7, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9536020755767822
Epoch: 8, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.053 Vali Acc: 0.267 Test Loss: 1.053 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8860428333282471
Epoch: 9, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 0.7432887554168701
Epoch: 10, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.023 Vali Acc: 0.333 Test Loss: 1.023 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7938477993011475
Epoch: 11, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 12 cost time: 0.6962249279022217
Epoch: 12, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 13 cost time: 0.8631987571716309
Epoch: 13, Steps: 1 | Train Loss: 0.607 Vali Loss: 0.990 Vali Acc: 0.400 Test Loss: 0.990 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7809176445007324
Epoch: 14, Steps: 1 | Train Loss: 0.437 Vali Loss: 0.981 Vali Acc: 0.533 Test Loss: 0.981 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 15 cost time: 0.9426710605621338
Epoch: 15, Steps: 1 | Train Loss: 0.492 Vali Loss: 0.974 Vali Acc: 0.467 Test Loss: 0.974 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8458316326141357
Epoch: 16, Steps: 1 | Train Loss: 0.375 Vali Loss: 0.966 Vali Acc: 0.467 Test Loss: 0.966 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8511776924133301
Epoch: 17, Steps: 1 | Train Loss: 0.251 Vali Loss: 0.959 Vali Acc: 0.467 Test Loss: 0.959 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.869758129119873
Epoch: 18, Steps: 1 | Train Loss: 0.247 Vali Loss: 0.953 Vali Acc: 0.533 Test Loss: 0.953 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 19 cost time: 0.7842662334442139
Epoch: 19, Steps: 1 | Train Loss: 0.144 Vali Loss: 0.948 Vali Acc: 0.533 Test Loss: 0.948 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 20 cost time: 0.7924840450286865
Epoch: 20, Steps: 1 | Train Loss: 0.175 Vali Loss: 0.943 Vali Acc: 0.600 Test Loss: 0.943 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599991).  Saving model ...
Epoch: 21 cost time: 0.7665607929229736
Epoch: 21, Steps: 1 | Train Loss: 0.163 Vali Loss: 0.941 Vali Acc: 0.600 Test Loss: 0.941 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 22 cost time: 0.8337299823760986
Epoch: 22, Steps: 1 | Train Loss: 0.111 Vali Loss: 0.939 Vali Acc: 0.667 Test Loss: 0.939 Test Acc: 0.667
Validation loss decreased (-0.599991 --> -0.666657).  Saving model ...
Epoch: 23 cost time: 0.7459297180175781
Epoch: 23, Steps: 1 | Train Loss: 0.090 Vali Loss: 0.938 Vali Acc: 0.667 Test Loss: 0.938 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 24 cost time: 0.7654531002044678
Epoch: 24, Steps: 1 | Train Loss: 0.067 Vali Loss: 0.939 Vali Acc: 0.600 Test Loss: 0.939 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.900458574295044
Epoch: 25, Steps: 1 | Train Loss: 0.051 Vali Loss: 0.941 Vali Acc: 0.533 Test Loss: 0.941 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8111693859100342
Epoch: 26, Steps: 1 | Train Loss: 0.051 Vali Loss: 0.944 Vali Acc: 0.667 Test Loss: 0.944 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.112858533859253
Epoch: 27, Steps: 1 | Train Loss: 0.032 Vali Loss: 0.947 Vali Acc: 0.667 Test Loss: 0.947 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1478145122528076
Epoch: 28, Steps: 1 | Train Loss: 0.029 Vali Loss: 0.950 Vali Acc: 0.600 Test Loss: 0.950 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0015573501586914
Epoch: 29, Steps: 1 | Train Loss: 0.022 Vali Loss: 0.954 Vali Acc: 0.600 Test Loss: 0.954 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7224447727203369
Epoch: 30, Steps: 1 | Train Loss: 0.022 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8865516185760498
Epoch: 31, Steps: 1 | Train Loss: 0.016 Vali Loss: 0.962 Vali Acc: 0.600 Test Loss: 0.962 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0250399112701416
Epoch: 32, Steps: 1 | Train Loss: 0.017 Vali Loss: 0.967 Vali Acc: 0.600 Test Loss: 0.967 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7685961723327637
Epoch: 33, Steps: 1 | Train Loss: 0.011 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 188035
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4492783546447754
Epoch: 1, Steps: 1 | Train Loss: 1.321 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7842576503753662
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.770737886428833
Epoch: 3, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.769122838973999
Epoch: 4, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.51957106590271
Epoch: 5, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.0974559783935547
Epoch: 6, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7868669033050537
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.9765057563781738
Epoch: 8, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 1.1272623538970947
Epoch: 9, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.889491081237793
Epoch: 10, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.8749551773071289
Epoch: 11, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.8526525497436523
Epoch: 12, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.9666721820831299
Epoch: 13, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.8453714847564697
Epoch: 14, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.8954007625579834
Epoch: 15, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.9324755668640137
Epoch: 16, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 17 cost time: 0.818554162979126
Epoch: 17, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 18 cost time: 0.8852705955505371
Epoch: 18, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 19 cost time: 0.8293013572692871
Epoch: 19, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 20 cost time: 0.9169256687164307
Epoch: 20, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 21 cost time: 0.8166794776916504
Epoch: 21, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.010 Vali Acc: 0.400 Test Loss: 1.010 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 22 cost time: 0.8003349304199219
Epoch: 22, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 23 cost time: 0.893195390701294
Epoch: 23, Steps: 1 | Train Loss: 0.169 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 24 cost time: 0.7798702716827393
Epoch: 24, Steps: 1 | Train Loss: 0.145 Vali Loss: 0.992 Vali Acc: 0.400 Test Loss: 0.992 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7642900943756104
Epoch: 25, Steps: 1 | Train Loss: 0.109 Vali Loss: 0.988 Vali Acc: 0.400 Test Loss: 0.988 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7569584846496582
Epoch: 26, Steps: 1 | Train Loss: 0.094 Vali Loss: 0.985 Vali Acc: 0.400 Test Loss: 0.985 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6948587894439697
Epoch: 27, Steps: 1 | Train Loss: 0.072 Vali Loss: 0.983 Vali Acc: 0.400 Test Loss: 0.983 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.850447416305542
Epoch: 28, Steps: 1 | Train Loss: 0.055 Vali Loss: 0.982 Vali Acc: 0.400 Test Loss: 0.982 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8185362815856934
Epoch: 29, Steps: 1 | Train Loss: 0.054 Vali Loss: 0.981 Vali Acc: 0.400 Test Loss: 0.981 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8136947154998779
Epoch: 30, Steps: 1 | Train Loss: 0.048 Vali Loss: 0.980 Vali Acc: 0.400 Test Loss: 0.980 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1661481857299805
Epoch: 31, Steps: 1 | Train Loss: 0.039 Vali Loss: 0.981 Vali Acc: 0.533 Test Loss: 0.981 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 32 cost time: 0.8153934478759766
Epoch: 32, Steps: 1 | Train Loss: 0.032 Vali Loss: 0.981 Vali Acc: 0.533 Test Loss: 0.981 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8709862232208252
Epoch: 33, Steps: 1 | Train Loss: 0.028 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 34 cost time: 0.7708950042724609
Epoch: 34, Steps: 1 | Train Loss: 0.021 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 35 cost time: 0.9798409938812256
Epoch: 35, Steps: 1 | Train Loss: 0.019 Vali Loss: 0.978 Vali Acc: 0.533 Test Loss: 0.978 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 36 cost time: 0.6963260173797607
Epoch: 36, Steps: 1 | Train Loss: 0.018 Vali Loss: 0.978 Vali Acc: 0.533 Test Loss: 0.978 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 37 cost time: 0.7837615013122559
Epoch: 37, Steps: 1 | Train Loss: 0.014 Vali Loss: 0.978 Vali Acc: 0.533 Test Loss: 0.978 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 38 cost time: 0.739386796951294
Epoch: 38, Steps: 1 | Train Loss: 0.013 Vali Loss: 0.978 Vali Acc: 0.533 Test Loss: 0.978 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8002958297729492
Epoch: 39, Steps: 1 | Train Loss: 0.010 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8948655128479004
Epoch: 40, Steps: 1 | Train Loss: 0.009 Vali Loss: 0.980 Vali Acc: 0.533 Test Loss: 0.980 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8827650547027588
Epoch: 41, Steps: 1 | Train Loss: 0.008 Vali Loss: 0.981 Vali Acc: 0.533 Test Loss: 0.981 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9081554412841797
Epoch: 42, Steps: 1 | Train Loss: 0.006 Vali Loss: 0.982 Vali Acc: 0.533 Test Loss: 0.982 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8708512783050537
Epoch: 43, Steps: 1 | Train Loss: 0.007 Vali Loss: 0.983 Vali Acc: 0.600 Test Loss: 0.983 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599990).  Saving model ...
Epoch: 44 cost time: 0.7519257068634033
Epoch: 44, Steps: 1 | Train Loss: 0.006 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8736848831176758
Epoch: 45, Steps: 1 | Train Loss: 0.005 Vali Loss: 0.986 Vali Acc: 0.600 Test Loss: 0.986 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8897857666015625
Epoch: 46, Steps: 1 | Train Loss: 0.005 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7431149482727051
Epoch: 47, Steps: 1 | Train Loss: 0.004 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7467443943023682
Epoch: 48, Steps: 1 | Train Loss: 0.003 Vali Loss: 0.993 Vali Acc: 0.600 Test Loss: 0.993 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7730419635772705
Epoch: 49, Steps: 1 | Train Loss: 0.004 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.7334325313568115
Epoch: 50, Steps: 1 | Train Loss: 0.003 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.7623348236083984
Epoch: 51, Steps: 1 | Train Loss: 0.003 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.7900197505950928
Epoch: 52, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.000 Vali Acc: 0.600 Test Loss: 1.000 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.8753542900085449
Epoch: 53, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 182083
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1806182861328125
Epoch: 1, Steps: 1 | Train Loss: 1.408 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7975947856903076
Epoch: 2, Steps: 1 | Train Loss: 1.616 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.903594970703125
Epoch: 3, Steps: 1 | Train Loss: 1.507 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.8282124996185303
Epoch: 4, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.6910264492034912
Epoch: 5, Steps: 1 | Train Loss: 1.355 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7667114734649658
Epoch: 6, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.6908562183380127
Epoch: 7, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.798783540725708
Epoch: 8, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.684119701385498
Epoch: 9, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.8081738948822021
Epoch: 10, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.6625685691833496
Epoch: 11, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.6558303833007812
Epoch: 12, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.6427857875823975
Epoch: 13, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7152228355407715
Epoch: 14, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6612675189971924
Epoch: 15, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7489190101623535
Epoch: 16, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.7985661029815674
Epoch: 17, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 1.0660767555236816
Epoch: 18, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 1.1623713970184326
Epoch: 19, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 0.6419374942779541
Epoch: 20, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 0.6756472587585449
Epoch: 21, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.708057165145874
Epoch: 22, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.901475191116333
Epoch: 23, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.6953206062316895
Epoch: 24, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.7873501777648926
Epoch: 25, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8287248611450195
Epoch: 26, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8285186290740967
Epoch: 27, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5905783176422119
Epoch: 28, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.616356611251831
Epoch: 29, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7857482433319092
Epoch: 30, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.817720890045166
Epoch: 31, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7080709934234619
Epoch: 32, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 33 cost time: 0.6883418560028076
Epoch: 33, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 34 cost time: 0.6264925003051758
Epoch: 34, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 35 cost time: 0.7661194801330566
Epoch: 35, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 36 cost time: 0.7074260711669922
Epoch: 36, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 37 cost time: 0.5916011333465576
Epoch: 37, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6872897148132324
Epoch: 38, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5868937969207764
Epoch: 39, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5559537410736084
Epoch: 40, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8533997535705566
Epoch: 41, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6557111740112305
Epoch: 42, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9034538269042969
Epoch: 43, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6988177299499512
Epoch: 44, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 45 cost time: 0.8839354515075684
Epoch: 45, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7848203182220459
Epoch: 46, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8620047569274902
Epoch: 47, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9201860427856445
Epoch: 48, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6164963245391846
Epoch: 49, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7585446834564209
Epoch: 50, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.7103762626647949
Epoch: 51, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.7349717617034912
Epoch: 52, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.8683948516845703
Epoch: 53, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.6475763320922852
Epoch: 54, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 181443
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.922794818878174
Epoch: 1, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.277 Vali Acc: 0.200 Test Loss: 1.277 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.989058256149292
Epoch: 2, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.272 Vali Acc: 0.200 Test Loss: 1.272 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.8822519779205322
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.8443965911865234
Epoch: 4, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 0.7496378421783447
Epoch: 5, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.258 Vali Acc: 0.200 Test Loss: 1.258 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 6 cost time: 0.7012050151824951
Epoch: 6, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.253 Vali Acc: 0.133 Test Loss: 1.253 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9966385364532471
Epoch: 7, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.249 Vali Acc: 0.133 Test Loss: 1.249 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8649835586547852
Epoch: 8, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.243 Vali Acc: 0.133 Test Loss: 1.243 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8343703746795654
Epoch: 9, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.238 Vali Acc: 0.133 Test Loss: 1.238 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7986433506011963
Epoch: 10, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.231 Vali Acc: 0.133 Test Loss: 1.231 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8563077449798584
Epoch: 11, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.224 Vali Acc: 0.067 Test Loss: 1.224 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8953850269317627
Epoch: 12, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.216 Vali Acc: 0.133 Test Loss: 1.216 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8468942642211914
Epoch: 13, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.208 Vali Acc: 0.133 Test Loss: 1.208 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8399038314819336
Epoch: 14, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.201 Vali Acc: 0.133 Test Loss: 1.201 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8885354995727539
Epoch: 15, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.193 Vali Acc: 0.200 Test Loss: 1.193 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199988).  Saving model ...
Epoch: 16 cost time: 1.136812448501587
Epoch: 16, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 17 cost time: 0.8236613273620605
Epoch: 17, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 18 cost time: 1.1406946182250977
Epoch: 18, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 19 cost time: 0.7578475475311279
Epoch: 19, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 20 cost time: 0.8936808109283447
Epoch: 20, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 21 cost time: 0.7619726657867432
Epoch: 21, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 22 cost time: 0.8291623592376709
Epoch: 22, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 23 cost time: 0.7228834629058838
Epoch: 23, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 24 cost time: 0.8659820556640625
Epoch: 24, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 25 cost time: 0.8147356510162354
Epoch: 25, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 26 cost time: 0.983482837677002
Epoch: 26, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 27 cost time: 0.8800415992736816
Epoch: 27, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 28 cost time: 0.7068741321563721
Epoch: 28, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 29 cost time: 0.8825638294219971
Epoch: 29, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 30 cost time: 0.9002819061279297
Epoch: 30, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 31 cost time: 1.045518159866333
Epoch: 31, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 32 cost time: 0.7653663158416748
Epoch: 32, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 33 cost time: 0.8582720756530762
Epoch: 33, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 34 cost time: 0.9083006381988525
Epoch: 34, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 35 cost time: 0.8337037563323975
Epoch: 35, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 36 cost time: 1.2519361972808838
Epoch: 36, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 37 cost time: 1.1694858074188232
Epoch: 37, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 38 cost time: 1.0452065467834473
Epoch: 38, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 39 cost time: 0.6814191341400146
Epoch: 39, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 40 cost time: 0.9278934001922607
Epoch: 40, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 41 cost time: 1.0759427547454834
Epoch: 41, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9689602851867676
Epoch: 42, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8307702541351318
Epoch: 43, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9338347911834717
Epoch: 44, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.725471019744873
Epoch: 45, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.837754487991333
Epoch: 46, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7333459854125977
Epoch: 47, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8511056900024414
Epoch: 48, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8981425762176514
Epoch: 49, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.056617021560669
Epoch: 50, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 184067
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1907544136047363
Epoch: 1, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.351 Vali Acc: 0.267 Test Loss: 1.351 Test Acc: 0.267
Validation loss decreased (inf --> -0.266653).  Saving model ...
Epoch: 2 cost time: 1.0267150402069092
Epoch: 2, Steps: 1 | Train Loss: 1.389 Vali Loss: 1.342 Vali Acc: 0.267 Test Loss: 1.342 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 3 cost time: 0.7559833526611328
Epoch: 3, Steps: 1 | Train Loss: 1.310 Vali Loss: 1.334 Vali Acc: 0.267 Test Loss: 1.334 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 4 cost time: 0.7524785995483398
Epoch: 4, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.327 Vali Acc: 0.267 Test Loss: 1.327 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 5 cost time: 0.7465331554412842
Epoch: 5, Steps: 1 | Train Loss: 1.423 Vali Loss: 1.322 Vali Acc: 0.267 Test Loss: 1.322 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 6 cost time: 0.7119045257568359
Epoch: 6, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.317 Vali Acc: 0.267 Test Loss: 1.317 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 7 cost time: 0.7011709213256836
Epoch: 7, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.312 Vali Acc: 0.200 Test Loss: 1.312 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.859790563583374
Epoch: 8, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.308 Vali Acc: 0.200 Test Loss: 1.308 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9612021446228027
Epoch: 9, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.303 Vali Acc: 0.200 Test Loss: 1.303 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7702372074127197
Epoch: 10, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.299 Vali Acc: 0.267 Test Loss: 1.299 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266654).  Saving model ...
Epoch: 11 cost time: 0.6976172924041748
Epoch: 11, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 12 cost time: 0.736332893371582
Epoch: 12, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 13 cost time: 0.6897377967834473
Epoch: 13, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 14 cost time: 0.7896711826324463
Epoch: 14, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 15 cost time: 0.8578834533691406
Epoch: 15, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.276 Vali Acc: 0.333 Test Loss: 1.276 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.9476208686828613
Epoch: 16, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.8568229675292969
Epoch: 17, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 0.8516976833343506
Epoch: 18, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 1.0000090599060059
Epoch: 19, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 20 cost time: 0.9879968166351318
Epoch: 20, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 21 cost time: 0.9936141967773438
Epoch: 21, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 22 cost time: 1.0405731201171875
Epoch: 22, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 23 cost time: 0.7940394878387451
Epoch: 23, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 24 cost time: 0.9907877445220947
Epoch: 24, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 25 cost time: 0.8030805587768555
Epoch: 25, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 26 cost time: 0.5914454460144043
Epoch: 26, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 27 cost time: 0.9792237281799316
Epoch: 27, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8569929599761963
Epoch: 28, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 29 cost time: 1.107595682144165
Epoch: 29, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 30 cost time: 0.8672294616699219
Epoch: 30, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 31 cost time: 0.9211068153381348
Epoch: 31, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.222 Vali Acc: 0.467 Test Loss: 1.222 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 32 cost time: 0.7744550704956055
Epoch: 32, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.223 Vali Acc: 0.467 Test Loss: 1.223 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.204695463180542
Epoch: 33, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.223 Vali Acc: 0.467 Test Loss: 1.223 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8556301593780518
Epoch: 34, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.226 Vali Acc: 0.467 Test Loss: 1.226 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.95050048828125
Epoch: 35, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.227 Vali Acc: 0.533 Test Loss: 1.227 Test Acc: 0.533
Validation loss decreased (-0.466654 --> -0.533321).  Saving model ...
Epoch: 36 cost time: 0.7012159824371338
Epoch: 36, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.229 Vali Acc: 0.533 Test Loss: 1.229 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6765010356903076
Epoch: 37, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.229 Vali Acc: 0.533 Test Loss: 1.229 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9071612358093262
Epoch: 38, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.231 Vali Acc: 0.533 Test Loss: 1.231 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8676815032958984
Epoch: 39, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.233 Vali Acc: 0.533 Test Loss: 1.233 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.049626350402832
Epoch: 40, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.235 Vali Acc: 0.533 Test Loss: 1.235 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9797730445861816
Epoch: 41, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.236 Vali Acc: 0.533 Test Loss: 1.236 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0578210353851318
Epoch: 42, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.238 Vali Acc: 0.533 Test Loss: 1.238 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9126253128051758
Epoch: 43, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.239 Vali Acc: 0.533 Test Loss: 1.239 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0134994983673096
Epoch: 44, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.240 Vali Acc: 0.533 Test Loss: 1.240 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9408755302429199
Epoch: 45, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.241 Vali Acc: 0.533 Test Loss: 1.241 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 189763
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2929677963256836
Epoch: 1, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.2270584106445312
Epoch: 2, Steps: 1 | Train Loss: 1.379 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.755795955657959
Epoch: 3, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9155411720275879
Epoch: 4, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9355285167694092
Epoch: 5, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9188113212585449
Epoch: 6, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8894321918487549
Epoch: 7, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9475910663604736
Epoch: 8, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8923685550689697
Epoch: 9, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8831167221069336
Epoch: 10, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6331653594970703
Epoch: 11, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df256_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 195459
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.228891611099243
Epoch: 1, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.1587765216827393
Epoch: 2, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9142367839813232
Epoch: 3, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8394324779510498
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8994476795196533
Epoch: 5, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8839256763458252
Epoch: 6, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9588949680328369
Epoch: 7, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0598905086517334
Epoch: 8, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1547391414642334
Epoch: 9, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8431217670440674
Epoch: 10, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 1.107323169708252
Epoch: 11, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.9308621883392334
Epoch: 12, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8191971778869629
Epoch: 13, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.9005467891693115
Epoch: 14, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9576606750488281
Epoch: 15, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8192758560180664
Epoch: 16, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8717727661132812
Epoch: 17, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1488041877746582
Epoch: 18, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0659880638122559
Epoch: 19, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0838449001312256
Epoch: 20, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9779386520385742
Epoch: 21, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9208455085754395
Epoch: 22, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9383373260498047
Epoch: 23, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 164483
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1439402103424072
Epoch: 1, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7080471515655518
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.8894355297088623
Epoch: 3, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.825376033782959
Epoch: 4, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.7574982643127441
Epoch: 5, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.8043243885040283
Epoch: 6, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 0.8367078304290771
Epoch: 7, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.7769060134887695
Epoch: 8, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7165231704711914
Epoch: 9, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.9711835384368896
Epoch: 10, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.8364436626434326
Epoch: 11, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.6440119743347168
Epoch: 12, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.6406128406524658
Epoch: 13, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.6964874267578125
Epoch: 14, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.8632266521453857
Epoch: 15, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.019 Vali Acc: 0.467 Test Loss: 1.019 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.7721302509307861
Epoch: 16, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 17 cost time: 0.7121827602386475
Epoch: 17, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 18 cost time: 0.8278579711914062
Epoch: 18, Steps: 1 | Train Loss: 0.243 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 19 cost time: 0.7364940643310547
Epoch: 19, Steps: 1 | Train Loss: 0.184 Vali Loss: 0.995 Vali Acc: 0.400 Test Loss: 0.995 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6892867088317871
Epoch: 20, Steps: 1 | Train Loss: 0.218 Vali Loss: 0.991 Vali Acc: 0.400 Test Loss: 0.991 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.746171236038208
Epoch: 21, Steps: 1 | Train Loss: 0.155 Vali Loss: 0.991 Vali Acc: 0.400 Test Loss: 0.991 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7533762454986572
Epoch: 22, Steps: 1 | Train Loss: 0.095 Vali Loss: 0.994 Vali Acc: 0.400 Test Loss: 0.994 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.723393440246582
Epoch: 23, Steps: 1 | Train Loss: 0.076 Vali Loss: 0.998 Vali Acc: 0.400 Test Loss: 0.998 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8710677623748779
Epoch: 24, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.006 Vali Acc: 0.400 Test Loss: 1.006 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7376694679260254
Epoch: 25, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7614014148712158
Epoch: 26, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7931816577911377
Epoch: 27, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8673715591430664
Epoch: 28, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 138499
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2215819358825684
Epoch: 1, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7016875743865967
Epoch: 2, Steps: 1 | Train Loss: 1.359 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.7516660690307617
Epoch: 3, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.7600023746490479
Epoch: 4, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5863003730773926
Epoch: 5, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.7867426872253418
Epoch: 6, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.8145079612731934
Epoch: 7, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.7378237247467041
Epoch: 8, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1279096603393555
Epoch: 9, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7386412620544434
Epoch: 10, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.754638671875
Epoch: 11, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.9924502372741699
Epoch: 12, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.7265441417694092
Epoch: 13, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.6321907043457031
Epoch: 14, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7375888824462891
Epoch: 15, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7057151794433594
Epoch: 16, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8882064819335938
Epoch: 17, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7920989990234375
Epoch: 18, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0706675052642822
Epoch: 19, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 1.0021886825561523
Epoch: 20, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.8453688621520996
Epoch: 21, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.6760990619659424
Epoch: 22, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.8848927021026611
Epoch: 23, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.751279354095459
Epoch: 24, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.6711974143981934
Epoch: 25, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 0.8438642024993896
Epoch: 26, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 27 cost time: 0.6401662826538086
Epoch: 27, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 0.7256870269775391
Epoch: 28, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.6657309532165527
Epoch: 29, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9354710578918457
Epoch: 30, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8221406936645508
Epoch: 31, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8623917102813721
Epoch: 32, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8800981044769287
Epoch: 33, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8865725994110107
Epoch: 34, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0962884426116943
Epoch: 35, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1319215297698975
Epoch: 36, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2624893188476562
Epoch: 37, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9331743717193604
Epoch: 38, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 132547
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.591193675994873
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.7377927303314209
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.9033799171447754
Epoch: 3, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.193 Vali Acc: 0.200 Test Loss: 1.193 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.7938780784606934
Epoch: 4, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.8092770576477051
Epoch: 5, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.877490758895874
Epoch: 6, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8730669021606445
Epoch: 7, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4219293594360352
Epoch: 8, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0039088726043701
Epoch: 9, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2672641277313232
Epoch: 10, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.139814853668213
Epoch: 11, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0989842414855957
Epoch: 12, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.7397325038909912
Epoch: 13, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.9000732898712158
Epoch: 14, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8172273635864258
Epoch: 15, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.180450677871704
Epoch: 16, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.222254753112793
Epoch: 17, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1002018451690674
Epoch: 18, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2735848426818848
Epoch: 19, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0744144916534424
Epoch: 20, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 1.0646343231201172
Epoch: 21, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 0.8674988746643066
Epoch: 22, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 1.1419074535369873
Epoch: 23, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 24 cost time: 0.9502787590026855
Epoch: 24, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 25 cost time: 1.0504379272460938
Epoch: 25, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 26 cost time: 1.0613608360290527
Epoch: 26, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 1.0842888355255127
Epoch: 27, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3954498767852783
Epoch: 28, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1909089088439941
Epoch: 29, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0638418197631836
Epoch: 30, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.223078727722168
Epoch: 31, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0870749950408936
Epoch: 32, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.807910680770874
Epoch: 33, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.427900791168213
Epoch: 34, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1985256671905518
Epoch: 35, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.4022407531738281
Epoch: 36, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 131907
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.658468008041382
Epoch: 1, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.3807106018066406
Epoch: 2, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.0229947566986084
Epoch: 3, Steps: 1 | Train Loss: 1.311 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.9292757511138916
Epoch: 4, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 1.017289400100708
Epoch: 5, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9012298583984375
Epoch: 6, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8361997604370117
Epoch: 7, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7894270420074463
Epoch: 8, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.802581787109375
Epoch: 9, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.9389536380767822
Epoch: 10, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 1.078401803970337
Epoch: 11, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 1.139627456665039
Epoch: 12, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.0761899948120117
Epoch: 13, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.9589390754699707
Epoch: 14, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 1.0662086009979248
Epoch: 15, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.9237620830535889
Epoch: 16, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.8341002464294434
Epoch: 17, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.0600931644439697
Epoch: 18, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.8997900485992432
Epoch: 19, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.813349723815918
Epoch: 20, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.6775460243225098
Epoch: 21, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 1.01163649559021
Epoch: 22, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 1.0476033687591553
Epoch: 23, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.79414963722229
Epoch: 24, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1076855659484863
Epoch: 25, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9842350482940674
Epoch: 26, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.058525562286377
Epoch: 27, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7272250652313232
Epoch: 28, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0686378479003906
Epoch: 29, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 30 cost time: 1.0466337203979492
Epoch: 30, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.117 Vali Acc: 0.533 Test Loss: 1.117 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0420560836791992
Epoch: 31, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.123 Vali Acc: 0.600 Test Loss: 1.123 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 32 cost time: 0.8952891826629639
Epoch: 32, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.137833833694458
Epoch: 33, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.135 Vali Acc: 0.533 Test Loss: 1.135 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0258607864379883
Epoch: 34, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.142 Vali Acc: 0.600 Test Loss: 1.142 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7906861305236816
Epoch: 35, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.147 Vali Acc: 0.533 Test Loss: 1.147 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8382425308227539
Epoch: 36, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.153 Vali Acc: 0.533 Test Loss: 1.153 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9696629047393799
Epoch: 37, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.159 Vali Acc: 0.533 Test Loss: 1.159 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.835364818572998
Epoch: 38, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8630990982055664
Epoch: 39, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.172 Vali Acc: 0.467 Test Loss: 1.172 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9555342197418213
Epoch: 40, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.177 Vali Acc: 0.467 Test Loss: 1.177 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0854480266571045
Epoch: 41, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 134531
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1286652088165283
Epoch: 1, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.9542357921600342
Epoch: 2, Steps: 1 | Train Loss: 1.344 Vali Loss: 1.341 Vali Acc: 0.400 Test Loss: 1.341 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.7046823501586914
Epoch: 3, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.330 Vali Acc: 0.467 Test Loss: 1.330 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466653).  Saving model ...
Epoch: 4 cost time: 0.7977254390716553
Epoch: 4, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.321 Vali Acc: 0.467 Test Loss: 1.321 Test Acc: 0.467
Validation loss decreased (-0.466653 --> -0.466653).  Saving model ...
Epoch: 5 cost time: 0.9267308712005615
Epoch: 5, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.314 Vali Acc: 0.467 Test Loss: 1.314 Test Acc: 0.467
Validation loss decreased (-0.466653 --> -0.466654).  Saving model ...
Epoch: 6 cost time: 0.8299400806427002
Epoch: 6, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.307 Vali Acc: 0.467 Test Loss: 1.307 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 7 cost time: 0.7889349460601807
Epoch: 7, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.301 Vali Acc: 0.467 Test Loss: 1.301 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 8 cost time: 0.9787614345550537
Epoch: 8, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.297 Vali Acc: 0.467 Test Loss: 1.297 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 9 cost time: 0.9483952522277832
Epoch: 9, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.292 Vali Acc: 0.467 Test Loss: 1.292 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 10 cost time: 0.6983861923217773
Epoch: 10, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.288 Vali Acc: 0.467 Test Loss: 1.288 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 11 cost time: 0.9462292194366455
Epoch: 11, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.284 Vali Acc: 0.467 Test Loss: 1.284 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 12 cost time: 0.840864896774292
Epoch: 12, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.280 Vali Acc: 0.467 Test Loss: 1.280 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 13 cost time: 0.9034631252288818
Epoch: 13, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.277 Vali Acc: 0.467 Test Loss: 1.277 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 14 cost time: 1.0880563259124756
Epoch: 14, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.274 Vali Acc: 0.467 Test Loss: 1.274 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 15 cost time: 0.8073198795318604
Epoch: 15, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.270 Vali Acc: 0.467 Test Loss: 1.270 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 16 cost time: 0.8309736251831055
Epoch: 16, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.267 Vali Acc: 0.467 Test Loss: 1.267 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 17 cost time: 0.9785807132720947
Epoch: 17, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.264 Vali Acc: 0.467 Test Loss: 1.264 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 18 cost time: 0.8659343719482422
Epoch: 18, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.261 Vali Acc: 0.467 Test Loss: 1.261 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 19 cost time: 0.7376470565795898
Epoch: 19, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.258 Vali Acc: 0.400 Test Loss: 1.258 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7182943820953369
Epoch: 20, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.256 Vali Acc: 0.400 Test Loss: 1.256 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9878222942352295
Epoch: 21, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8813605308532715
Epoch: 22, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.249 Vali Acc: 0.400 Test Loss: 1.249 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8779160976409912
Epoch: 23, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8964293003082275
Epoch: 24, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9436256885528564
Epoch: 25, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.834545373916626
Epoch: 26, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.241 Vali Acc: 0.400 Test Loss: 1.241 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9497392177581787
Epoch: 27, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.859612226486206
Epoch: 28, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 140227
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1655869483947754
Epoch: 1, Steps: 1 | Train Loss: 1.364 Vali Loss: 1.277 Vali Acc: 0.133 Test Loss: 1.277 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 1.0207626819610596
Epoch: 2, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.267 Vali Acc: 0.133 Test Loss: 1.267 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.7373476028442383
Epoch: 3, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.257 Vali Acc: 0.200 Test Loss: 1.257 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.9545459747314453
Epoch: 4, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.249 Vali Acc: 0.200 Test Loss: 1.249 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.6092848777770996
Epoch: 5, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.242 Vali Acc: 0.200 Test Loss: 1.242 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.8244969844818115
Epoch: 6, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.7822456359863281
Epoch: 7, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.8125879764556885
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 0.8910121917724609
Epoch: 9, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 10 cost time: 0.8772268295288086
Epoch: 10, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 11 cost time: 1.2840538024902344
Epoch: 11, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 12 cost time: 0.827441930770874
Epoch: 12, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 13 cost time: 1.0183830261230469
Epoch: 13, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 14 cost time: 0.8593528270721436
Epoch: 14, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.8365280628204346
Epoch: 15, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 16 cost time: 1.0796327590942383
Epoch: 16, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 17 cost time: 0.9425828456878662
Epoch: 17, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 18 cost time: 0.670499324798584
Epoch: 18, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 19 cost time: 0.7962560653686523
Epoch: 19, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 20 cost time: 0.9767742156982422
Epoch: 20, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 21 cost time: 0.7283115386962891
Epoch: 21, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 22 cost time: 0.8283700942993164
Epoch: 22, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 23 cost time: 0.620701789855957
Epoch: 23, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 24 cost time: 0.8462719917297363
Epoch: 24, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 25 cost time: 0.9704098701477051
Epoch: 25, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 26 cost time: 0.7226290702819824
Epoch: 26, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 27 cost time: 0.8085637092590332
Epoch: 27, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 28 cost time: 1.0489060878753662
Epoch: 28, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 29 cost time: 1.2091917991638184
Epoch: 29, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 30 cost time: 0.8184409141540527
Epoch: 30, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 31 cost time: 0.9462640285491943
Epoch: 31, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 32 cost time: 0.749640941619873
Epoch: 32, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 33 cost time: 0.8338465690612793
Epoch: 33, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 34 cost time: 1.0721681118011475
Epoch: 34, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 35 cost time: 0.8688428401947021
Epoch: 35, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 36 cost time: 0.9086344242095947
Epoch: 36, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 37 cost time: 1.028219223022461
Epoch: 37, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 38 cost time: 0.775639533996582
Epoch: 38, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 39 cost time: 0.9303081035614014
Epoch: 39, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 40 cost time: 0.8238730430603027
Epoch: 40, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 41 cost time: 0.6932415962219238
Epoch: 41, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 42 cost time: 0.8109028339385986
Epoch: 42, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 43 cost time: 0.6561212539672852
Epoch: 43, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 44 cost time: 0.6631832122802734
Epoch: 44, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 45 cost time: 0.8801815509796143
Epoch: 45, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 46 cost time: 0.7693150043487549
Epoch: 46, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 47 cost time: 1.0881097316741943
Epoch: 47, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 48 cost time: 0.8447024822235107
Epoch: 48, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 49 cost time: 0.7600314617156982
Epoch: 49, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 50 cost time: 1.0142123699188232
Epoch: 50, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8463757038116455
Epoch: 51, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.813809871673584
Epoch: 52, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.0229904651641846
Epoch: 53, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.112 Vali Acc: 0.667 Test Loss: 1.112 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 54 cost time: 0.6918656826019287
Epoch: 54, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.113 Vali Acc: 0.667 Test Loss: 1.113 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0677828788757324
Epoch: 55, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.113 Vali Acc: 0.667 Test Loss: 1.113 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.9989323616027832
Epoch: 56, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.114 Vali Acc: 0.667 Test Loss: 1.114 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7718629837036133
Epoch: 57, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.115 Vali Acc: 0.667 Test Loss: 1.115 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.1241116523742676
Epoch: 58, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.115 Vali Acc: 0.667 Test Loss: 1.115 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.8574411869049072
Epoch: 59, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.116 Vali Acc: 0.667 Test Loss: 1.116 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.0156705379486084
Epoch: 60, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.116 Vali Acc: 0.733 Test Loss: 1.116 Test Acc: 0.733
Validation loss decreased (-0.666656 --> -0.733322).  Saving model ...
Epoch: 61 cost time: 1.130427360534668
Epoch: 61, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.118 Vali Acc: 0.733 Test Loss: 1.118 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8546938896179199
Epoch: 62, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.118 Vali Acc: 0.733 Test Loss: 1.118 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.1590628623962402
Epoch: 63, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.118 Vali Acc: 0.733 Test Loss: 1.118 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.8578972816467285
Epoch: 64, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.119 Vali Acc: 0.733 Test Loss: 1.119 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.7744443416595459
Epoch: 65, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.119 Vali Acc: 0.733 Test Loss: 1.119 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.7716524600982666
Epoch: 66, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.119 Vali Acc: 0.733 Test Loss: 1.119 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.8364434242248535
Epoch: 67, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.120 Vali Acc: 0.733 Test Loss: 1.120 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.9466862678527832
Epoch: 68, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.120 Vali Acc: 0.733 Test Loss: 1.120 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.1341590881347656
Epoch: 69, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.121 Vali Acc: 0.733 Test Loss: 1.121 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.9921860694885254
Epoch: 70, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.122 Vali Acc: 0.733 Test Loss: 1.122 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df128_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 145923
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.823387384414673
Epoch: 1, Steps: 1 | Train Loss: 1.360 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.8340978622436523
Epoch: 2, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9781088829040527
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0255255699157715
Epoch: 4, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.116398811340332
Epoch: 5, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.0711164474487305
Epoch: 6, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.913994312286377
Epoch: 7, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.7828648090362549
Epoch: 8, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.7374355792999268
Epoch: 9, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.7146701812744141
Epoch: 10, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.6979489326477051
Epoch: 11, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.8246321678161621
Epoch: 12, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.9333512783050537
Epoch: 13, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.057 Vali Acc: 0.600 Test Loss: 1.057 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 1.0707573890686035
Epoch: 14, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9309878349304199
Epoch: 15, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0993151664733887
Epoch: 16, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9953505992889404
Epoch: 17, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9227695465087891
Epoch: 18, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8662164211273193
Epoch: 19, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9038214683532715
Epoch: 20, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.044 Vali Acc: 0.667 Test Loss: 1.044 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 21 cost time: 0.7196342945098877
Epoch: 21, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.050 Vali Acc: 0.667 Test Loss: 1.050 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8721597194671631
Epoch: 22, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.061 Vali Acc: 0.667 Test Loss: 1.061 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9107141494750977
Epoch: 23, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.074 Vali Acc: 0.667 Test Loss: 1.074 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8276412487030029
Epoch: 24, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.032423496246338
Epoch: 25, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.111 Vali Acc: 0.667 Test Loss: 1.111 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9910492897033691
Epoch: 26, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.131 Vali Acc: 0.600 Test Loss: 1.131 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.893531322479248
Epoch: 27, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.149 Vali Acc: 0.600 Test Loss: 1.149 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3713386058807373
Epoch: 28, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.168 Vali Acc: 0.533 Test Loss: 1.168 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.878819465637207
Epoch: 29, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.187 Vali Acc: 0.533 Test Loss: 1.187 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3308403491973877
Epoch: 30, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.202 Vali Acc: 0.533 Test Loss: 1.202 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 139715
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.699019193649292
Epoch: 1, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.9345736503601074
Epoch: 2, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 1.1147944927215576
Epoch: 3, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.8433027267456055
Epoch: 4, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.9515552520751953
Epoch: 5, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.9414381980895996
Epoch: 6, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.8484756946563721
Epoch: 7, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.8683505058288574
Epoch: 8, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 1.1546647548675537
Epoch: 9, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.7125258445739746
Epoch: 10, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 1.0797219276428223
Epoch: 11, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.9238569736480713
Epoch: 12, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.9325461387634277
Epoch: 13, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 1.0733137130737305
Epoch: 14, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.9565300941467285
Epoch: 15, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 1.025780439376831
Epoch: 16, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.119 Vali Acc: 0.533 Test Loss: 1.119 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 0.968390941619873
Epoch: 17, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.119 Vali Acc: 0.533 Test Loss: 1.119 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0971760749816895
Epoch: 18, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.14813232421875
Epoch: 19, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7480258941650391
Epoch: 20, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8577489852905273
Epoch: 21, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.008859395980835
Epoch: 22, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.786273717880249
Epoch: 23, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8240060806274414
Epoch: 24, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9247698783874512
Epoch: 25, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1249735355377197
Epoch: 26, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 113731
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.684648036956787
Epoch: 1, Steps: 1 | Train Loss: 1.408 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.9340784549713135
Epoch: 2, Steps: 1 | Train Loss: 1.512 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 1.0893504619598389
Epoch: 3, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.7842180728912354
Epoch: 4, Steps: 1 | Train Loss: 1.425 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.74625563621521
Epoch: 5, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.796217679977417
Epoch: 6, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.9181716442108154
Epoch: 7, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 1.0844335556030273
Epoch: 8, Steps: 1 | Train Loss: 1.091 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 1.1026291847229004
Epoch: 9, Steps: 1 | Train Loss: 1.067 Vali Loss: 0.993 Vali Acc: 0.533 Test Loss: 0.993 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.874962568283081
Epoch: 10, Steps: 1 | Train Loss: 0.988 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 1.1113359928131104
Epoch: 11, Steps: 1 | Train Loss: 1.097 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 1.144090175628662
Epoch: 12, Steps: 1 | Train Loss: 0.866 Vali Loss: 0.980 Vali Acc: 0.600 Test Loss: 0.980 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.9682204723358154
Epoch: 13, Steps: 1 | Train Loss: 0.690 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.9747810363769531
Epoch: 14, Steps: 1 | Train Loss: 0.549 Vali Loss: 0.971 Vali Acc: 0.600 Test Loss: 0.971 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.8020048141479492
Epoch: 15, Steps: 1 | Train Loss: 0.622 Vali Loss: 0.969 Vali Acc: 0.667 Test Loss: 0.969 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 16 cost time: 0.7685840129852295
Epoch: 16, Steps: 1 | Train Loss: 0.544 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9530234336853027
Epoch: 17, Steps: 1 | Train Loss: 0.579 Vali Loss: 0.961 Vali Acc: 0.600 Test Loss: 0.961 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.922842264175415
Epoch: 18, Steps: 1 | Train Loss: 0.510 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7610013484954834
Epoch: 19, Steps: 1 | Train Loss: 0.394 Vali Loss: 0.953 Vali Acc: 0.600 Test Loss: 0.953 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.90090012550354
Epoch: 20, Steps: 1 | Train Loss: 0.378 Vali Loss: 0.951 Vali Acc: 0.600 Test Loss: 0.951 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9129002094268799
Epoch: 21, Steps: 1 | Train Loss: 0.317 Vali Loss: 0.949 Vali Acc: 0.600 Test Loss: 0.949 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7856590747833252
Epoch: 22, Steps: 1 | Train Loss: 0.251 Vali Loss: 0.946 Vali Acc: 0.533 Test Loss: 0.946 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.958024263381958
Epoch: 23, Steps: 1 | Train Loss: 0.232 Vali Loss: 0.941 Vali Acc: 0.533 Test Loss: 0.941 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0228159427642822
Epoch: 24, Steps: 1 | Train Loss: 0.198 Vali Loss: 0.935 Vali Acc: 0.533 Test Loss: 0.935 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.92283034324646
Epoch: 25, Steps: 1 | Train Loss: 0.151 Vali Loss: 0.927 Vali Acc: 0.533 Test Loss: 0.927 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 107779
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0407445430755615
Epoch: 1, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8237030506134033
Epoch: 2, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0067853927612305
Epoch: 3, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1530404090881348
Epoch: 4, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8931002616882324
Epoch: 5, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7575008869171143
Epoch: 6, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7684884071350098
Epoch: 7, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9215526580810547
Epoch: 8, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0537304878234863
Epoch: 9, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.9485652446746826
Epoch: 10, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 1.2151179313659668
Epoch: 11, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.8495044708251953
Epoch: 12, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 1.1167452335357666
Epoch: 13, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.8498995304107666
Epoch: 14, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.6954805850982666
Epoch: 15, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.898165225982666
Epoch: 16, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 1.0583105087280273
Epoch: 17, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 1.3522603511810303
Epoch: 18, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.8737766742706299
Epoch: 19, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.8859865665435791
Epoch: 20, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 1.020042896270752
Epoch: 21, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.9672961235046387
Epoch: 22, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.8544788360595703
Epoch: 23, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9753940105438232
Epoch: 24, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7718629837036133
Epoch: 25, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0330097675323486
Epoch: 26, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 1.1047625541687012
Epoch: 27, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8858683109283447
Epoch: 28, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0659229755401611
Epoch: 29, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9676105976104736
Epoch: 30, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 31 cost time: 1.0011234283447266
Epoch: 31, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9678740501403809
Epoch: 32, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1927058696746826
Epoch: 33, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9008669853210449
Epoch: 34, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0361888408660889
Epoch: 35, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8675532341003418
Epoch: 36, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.041945457458496
Epoch: 37, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8894526958465576
Epoch: 38, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.011152982711792
Epoch: 39, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9715366363525391
Epoch: 40, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 107139
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.070831298828125
Epoch: 1, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7070152759552002
Epoch: 2, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.908637523651123
Epoch: 3, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8583269119262695
Epoch: 4, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9433150291442871
Epoch: 5, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.8032004833221436
Epoch: 6, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.8189690113067627
Epoch: 7, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 1.0769495964050293
Epoch: 8, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7363343238830566
Epoch: 9, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 1.3783481121063232
Epoch: 10, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8497536182403564
Epoch: 11, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7392411231994629
Epoch: 12, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7876102924346924
Epoch: 13, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8814396858215332
Epoch: 14, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7884438037872314
Epoch: 15, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.999096155166626
Epoch: 16, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8881795406341553
Epoch: 17, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.070 Vali Acc: 0.200 Test Loss: 1.070 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8089442253112793
Epoch: 18, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8118162155151367
Epoch: 19, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.064 Vali Acc: 0.267 Test Loss: 1.064 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 109763
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2748544216156006
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.9266865253448486
Epoch: 2, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.9456017017364502
Epoch: 3, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.9344804286956787
Epoch: 4, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 1.063664197921753
Epoch: 5, Steps: 1 | Train Loss: 1.282 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.8190004825592041
Epoch: 6, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.883552074432373
Epoch: 7, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.8860435485839844
Epoch: 8, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 1.0613901615142822
Epoch: 9, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9730219841003418
Epoch: 10, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7834107875823975
Epoch: 11, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8250744342803955
Epoch: 12, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 1.0044114589691162
Epoch: 13, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.8299541473388672
Epoch: 14, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 1.0001730918884277
Epoch: 15, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.9324386119842529
Epoch: 16, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 1.0338480472564697
Epoch: 17, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.0611236095428467
Epoch: 18, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.9014036655426025
Epoch: 19, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.8006949424743652
Epoch: 20, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.8054690361022949
Epoch: 21, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.7566401958465576
Epoch: 22, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.7577860355377197
Epoch: 23, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 1.0227415561676025
Epoch: 24, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 1.1676445007324219
Epoch: 25, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 1.1837246417999268
Epoch: 26, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.8136396408081055
Epoch: 27, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 1.0878350734710693
Epoch: 28, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 0.903331995010376
Epoch: 29, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.8953239917755127
Epoch: 30, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 0.8343684673309326
Epoch: 31, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 32 cost time: 0.7587337493896484
Epoch: 32, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 33 cost time: 0.8493025302886963
Epoch: 33, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 34 cost time: 0.7464334964752197
Epoch: 34, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 35 cost time: 1.077293872833252
Epoch: 35, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8579766750335693
Epoch: 36, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0046393871307373
Epoch: 37, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6766092777252197
Epoch: 38, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0647273063659668
Epoch: 39, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7999255657196045
Epoch: 40, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7510864734649658
Epoch: 41, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8570666313171387
Epoch: 42, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9385337829589844
Epoch: 43, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.1707274913787842
Epoch: 44, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 115459
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7765560150146484
Epoch: 1, Steps: 1 | Train Loss: 1.335 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.9362552165985107
Epoch: 2, Steps: 1 | Train Loss: 1.285 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6856479644775391
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9040956497192383
Epoch: 4, Steps: 1 | Train Loss: 1.326 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6960573196411133
Epoch: 5, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.680680513381958
Epoch: 6, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.577418327331543
Epoch: 7, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7681348323822021
Epoch: 8, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8756909370422363
Epoch: 9, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7255573272705078
Epoch: 10, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.7350277900695801
Epoch: 11, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.9047732353210449
Epoch: 12, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.6563830375671387
Epoch: 13, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.7003121376037598
Epoch: 14, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 0.7934179306030273
Epoch: 15, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 0.8603715896606445
Epoch: 16, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.928154706954956
Epoch: 17, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 0.7689502239227295
Epoch: 18, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 0.8390655517578125
Epoch: 19, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 0.9416725635528564
Epoch: 20, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 0.7162489891052246
Epoch: 21, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 22 cost time: 0.8359503746032715
Epoch: 22, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.211 Vali Acc: 0.467 Test Loss: 1.211 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 0.8067302703857422
Epoch: 23, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.207 Vali Acc: 0.467 Test Loss: 1.207 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 24 cost time: 0.9762890338897705
Epoch: 24, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7697176933288574
Epoch: 25, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.730830192565918
Epoch: 26, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7484827041625977
Epoch: 27, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.777108907699585
Epoch: 28, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0144402980804443
Epoch: 29, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.192 Vali Acc: 0.467 Test Loss: 1.192 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 30 cost time: 0.8111000061035156
Epoch: 30, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.191 Vali Acc: 0.467 Test Loss: 1.191 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 31 cost time: 0.804610013961792
Epoch: 31, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.191 Vali Acc: 0.467 Test Loss: 1.191 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8324012756347656
Epoch: 32, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.192 Vali Acc: 0.467 Test Loss: 1.192 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8302111625671387
Epoch: 33, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1435267925262451
Epoch: 34, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7539300918579102
Epoch: 35, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8792753219604492
Epoch: 36, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8598077297210693
Epoch: 37, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8097448348999023
Epoch: 38, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8633401393890381
Epoch: 39, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7439181804656982
Epoch: 40, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm64_nh16_df64_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 121155
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1680145263671875
Epoch: 1, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.449 Vali Acc: 0.333 Test Loss: 1.449 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 0.7717723846435547
Epoch: 2, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.430 Vali Acc: 0.333 Test Loss: 1.430 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 0.6654000282287598
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.413 Vali Acc: 0.333 Test Loss: 1.413 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 4 cost time: 0.8261840343475342
Epoch: 4, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.396 Vali Acc: 0.333 Test Loss: 1.396 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 1.0409791469573975
Epoch: 5, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.378 Vali Acc: 0.333 Test Loss: 1.378 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 1.0723040103912354
Epoch: 6, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.363 Vali Acc: 0.333 Test Loss: 1.363 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 0.8044884204864502
Epoch: 7, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.348 Vali Acc: 0.333 Test Loss: 1.348 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 0.9178948402404785
Epoch: 8, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.329 Vali Acc: 0.267 Test Loss: 1.329 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.859339714050293
Epoch: 9, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.313 Vali Acc: 0.333 Test Loss: 1.313 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 0.8517758846282959
Epoch: 10, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.299 Vali Acc: 0.333 Test Loss: 1.299 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 11 cost time: 1.0835022926330566
Epoch: 11, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.7177023887634277
Epoch: 12, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.275 Vali Acc: 0.400 Test Loss: 1.275 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 0.8131866455078125
Epoch: 13, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 0.7680726051330566
Epoch: 14, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 15 cost time: 0.8314917087554932
Epoch: 15, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8291735649108887
Epoch: 16, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6617124080657959
Epoch: 17, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8470678329467773
Epoch: 18, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7550363540649414
Epoch: 19, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0976574420928955
Epoch: 20, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6450443267822266
Epoch: 21, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 22 cost time: 0.8203177452087402
Epoch: 22, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 23 cost time: 0.7935786247253418
Epoch: 23, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 24 cost time: 0.8222057819366455
Epoch: 24, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 25 cost time: 0.8841266632080078
Epoch: 25, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 26 cost time: 0.8078184127807617
Epoch: 26, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.7633898258209229
Epoch: 27, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.9925203323364258
Epoch: 28, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9198122024536133
Epoch: 29, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.021209478378296
Epoch: 30, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8765826225280762
Epoch: 31, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9066925048828125
Epoch: 32, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9556503295898438
Epoch: 33, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7502222061157227
Epoch: 34, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7155041694641113
Epoch: 35, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8483912944793701
Epoch: 36, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7358050346374512
Epoch: 37, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 95107
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5372350215911865
Epoch: 1, Steps: 1 | Train Loss: 1.334 Vali Loss: 1.282 Vali Acc: 0.333 Test Loss: 1.282 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.1511049270629883
Epoch: 2, Steps: 1 | Train Loss: 1.274 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.7896215915679932
Epoch: 3, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.9687237739562988
Epoch: 4, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.9086227416992188
Epoch: 5, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.9481303691864014
Epoch: 6, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 1.0310931205749512
Epoch: 7, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 1.1594839096069336
Epoch: 8, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.9281306266784668
Epoch: 9, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.7958064079284668
Epoch: 10, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 1.0187580585479736
Epoch: 11, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.8804705142974854
Epoch: 12, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.8877425193786621
Epoch: 13, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 1.0096023082733154
Epoch: 14, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.7888689041137695
Epoch: 15, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.044243574142456
Epoch: 16, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3367247581481934
Epoch: 17, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2931551933288574
Epoch: 18, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8619136810302734
Epoch: 19, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1224281787872314
Epoch: 20, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0417742729187012
Epoch: 21, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2730379104614258
Epoch: 22, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 23 cost time: 1.0102145671844482
Epoch: 23, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 24 cost time: 0.9661779403686523
Epoch: 24, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 25 cost time: 0.9120988845825195
Epoch: 25, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 26 cost time: 1.0659081935882568
Epoch: 26, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.157933235168457
Epoch: 27, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.218 Vali Acc: 0.400 Test Loss: 1.218 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1369881629943848
Epoch: 28, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9113144874572754
Epoch: 29, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5700371265411377
Epoch: 30, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.246272325515747
Epoch: 31, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9092319011688232
Epoch: 32, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.232 Vali Acc: 0.467 Test Loss: 1.232 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 33 cost time: 0.9278202056884766
Epoch: 33, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.232 Vali Acc: 0.467 Test Loss: 1.232 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1467328071594238
Epoch: 34, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.232 Vali Acc: 0.467 Test Loss: 1.232 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.035722255706787
Epoch: 35, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.235 Vali Acc: 0.467 Test Loss: 1.235 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1738908290863037
Epoch: 36, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.237 Vali Acc: 0.467 Test Loss: 1.237 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5057179927825928
Epoch: 37, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.239 Vali Acc: 0.467 Test Loss: 1.239 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9173703193664551
Epoch: 38, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.242 Vali Acc: 0.467 Test Loss: 1.242 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.261718511581421
Epoch: 39, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.246 Vali Acc: 0.467 Test Loss: 1.246 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2055139541625977
Epoch: 40, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.253 Vali Acc: 0.467 Test Loss: 1.253 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0321722030639648
Epoch: 41, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.261 Vali Acc: 0.467 Test Loss: 1.261 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2327961921691895
Epoch: 42, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.270 Vali Acc: 0.467 Test Loss: 1.270 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 82115
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.106068849563599
Epoch: 1, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 1.3733606338500977
Epoch: 2, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9410500526428223
Epoch: 3, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7320213317871094
Epoch: 4, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8381752967834473
Epoch: 5, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9741275310516357
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7022550106048584
Epoch: 7, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8695409297943115
Epoch: 8, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7858891487121582
Epoch: 9, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0233581066131592
Epoch: 10, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7499725818634033
Epoch: 11, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 79139
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.526216983795166
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 1.167569875717163
Epoch: 2, Steps: 1 | Train Loss: 1.335 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.9741499423980713
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.8780941963195801
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 1.055518627166748
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.900484561920166
Epoch: 6, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 1.118793249130249
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 1.061979055404663
Epoch: 8, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.7065629959106445
Epoch: 9, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.7621777057647705
Epoch: 10, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.9928817749023438
Epoch: 11, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.9157440662384033
Epoch: 12, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.201 Vali Acc: 0.467 Test Loss: 1.201 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.9795506000518799
Epoch: 13, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.195 Vali Acc: 0.467 Test Loss: 1.195 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.9838643074035645
Epoch: 14, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0693976879119873
Epoch: 15, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0844712257385254
Epoch: 16, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.07200288772583
Epoch: 17, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1200435161590576
Epoch: 18, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8973324298858643
Epoch: 19, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9846799373626709
Epoch: 20, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.056868314743042
Epoch: 21, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.987076997756958
Epoch: 22, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8701205253601074
Epoch: 23, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 78819
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1756277084350586
Epoch: 1, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9185986518859863
Epoch: 2, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8436689376831055
Epoch: 3, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6684386730194092
Epoch: 4, Steps: 1 | Train Loss: 1.346 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.099867343902588
Epoch: 5, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9685215950012207
Epoch: 6, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0341308116912842
Epoch: 7, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2666394710540771
Epoch: 8, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0530848503112793
Epoch: 9, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1217865943908691
Epoch: 10, Steps: 1 | Train Loss: 1.256 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8764657974243164
Epoch: 11, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9289116859436035
Epoch: 12, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.127835750579834
Epoch: 13, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1002976894378662
Epoch: 14, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 80131
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.800156593322754
Epoch: 1, Steps: 1 | Train Loss: 1.491 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.9264745712280273
Epoch: 2, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.283 Vali Acc: 0.200 Test Loss: 1.283 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.050757884979248
Epoch: 3, Steps: 1 | Train Loss: 1.308 Vali Loss: 1.287 Vali Acc: 0.200 Test Loss: 1.287 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0082638263702393
Epoch: 4, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.291 Vali Acc: 0.200 Test Loss: 1.291 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9579067230224609
Epoch: 5, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.294 Vali Acc: 0.200 Test Loss: 1.294 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.203740119934082
Epoch: 6, Steps: 1 | Train Loss: 1.323 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2005810737609863
Epoch: 7, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.303 Vali Acc: 0.200 Test Loss: 1.303 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8260531425476074
Epoch: 8, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.307 Vali Acc: 0.200 Test Loss: 1.307 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9651985168457031
Epoch: 9, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.310 Vali Acc: 0.200 Test Loss: 1.310 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8316752910614014
Epoch: 10, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.313 Vali Acc: 0.200 Test Loss: 1.313 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9944653511047363
Epoch: 11, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.316 Vali Acc: 0.200 Test Loss: 1.316 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 82979
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5437324047088623
Epoch: 1, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7383749485015869
Epoch: 2, Steps: 1 | Train Loss: 1.284 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.9572718143463135
Epoch: 3, Steps: 1 | Train Loss: 1.264 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.9384195804595947
Epoch: 4, Steps: 1 | Train Loss: 1.387 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.9978923797607422
Epoch: 5, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7422854900360107
Epoch: 6, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0309665203094482
Epoch: 7, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.8219268321990967
Epoch: 8, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.7153670787811279
Epoch: 9, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.7472047805786133
Epoch: 10, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.72381591796875
Epoch: 11, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.7386362552642822
Epoch: 12, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.9359691143035889
Epoch: 13, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.0188958644866943
Epoch: 14, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.9752504825592041
Epoch: 15, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 1.120760202407837
Epoch: 16, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.8344640731811523
Epoch: 17, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.7900724411010742
Epoch: 18, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8592934608459473
Epoch: 19, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 1.096036434173584
Epoch: 20, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 1.4682016372680664
Epoch: 21, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.7747013568878174
Epoch: 22, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 1.0305802822113037
Epoch: 23, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.899458646774292
Epoch: 24, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8482146263122559
Epoch: 25, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0695185661315918
Epoch: 26, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8098433017730713
Epoch: 27, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8944013118743896
Epoch: 28, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8274931907653809
Epoch: 29, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7621328830718994
Epoch: 30, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9283475875854492
Epoch: 31, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0193135738372803
Epoch: 32, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8557164669036865
Epoch: 33, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df256_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 85827
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.54451584815979
Epoch: 1, Steps: 1 | Train Loss: 1.311 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.0836706161499023
Epoch: 2, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9804644584655762
Epoch: 3, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.253 Vali Acc: 0.200 Test Loss: 1.253 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8252851963043213
Epoch: 4, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8915197849273682
Epoch: 5, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.258 Vali Acc: 0.200 Test Loss: 1.258 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7156937122344971
Epoch: 6, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8614192008972168
Epoch: 7, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8488187789916992
Epoch: 8, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0097682476043701
Epoch: 9, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.787494421005249
Epoch: 10, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.260 Vali Acc: 0.200 Test Loss: 1.260 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1711430549621582
Epoch: 11, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 70147
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4026405811309814
Epoch: 1, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.353 Vali Acc: 0.267 Test Loss: 1.353 Test Acc: 0.267
Validation loss decreased (inf --> -0.266653).  Saving model ...
Epoch: 2 cost time: 1.0935795307159424
Epoch: 2, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.349 Vali Acc: 0.267 Test Loss: 1.349 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 3 cost time: 0.9571206569671631
Epoch: 3, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.344 Vali Acc: 0.267 Test Loss: 1.344 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 4 cost time: 1.0720610618591309
Epoch: 4, Steps: 1 | Train Loss: 1.323 Vali Loss: 1.340 Vali Acc: 0.267 Test Loss: 1.340 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 5 cost time: 0.7582488059997559
Epoch: 5, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.337 Vali Acc: 0.267 Test Loss: 1.337 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 6 cost time: 0.9076244831085205
Epoch: 6, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.335 Vali Acc: 0.267 Test Loss: 1.335 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 7 cost time: 0.8930304050445557
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.332 Vali Acc: 0.267 Test Loss: 1.332 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 8 cost time: 0.904066801071167
Epoch: 8, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.330 Vali Acc: 0.267 Test Loss: 1.330 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 9 cost time: 0.7174849510192871
Epoch: 9, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.327 Vali Acc: 0.267 Test Loss: 1.327 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 10 cost time: 0.9004316329956055
Epoch: 10, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.325 Vali Acc: 0.267 Test Loss: 1.325 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 11 cost time: 0.9842727184295654
Epoch: 11, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.322 Vali Acc: 0.267 Test Loss: 1.322 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 12 cost time: 0.9213399887084961
Epoch: 12, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.320 Vali Acc: 0.267 Test Loss: 1.320 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 13 cost time: 0.8783907890319824
Epoch: 13, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.317 Vali Acc: 0.267 Test Loss: 1.317 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 14 cost time: 0.8635833263397217
Epoch: 14, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.315 Vali Acc: 0.200 Test Loss: 1.315 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9141404628753662
Epoch: 15, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.314 Vali Acc: 0.200 Test Loss: 1.314 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9043703079223633
Epoch: 16, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.313 Vali Acc: 0.200 Test Loss: 1.313 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8912222385406494
Epoch: 17, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.312 Vali Acc: 0.200 Test Loss: 1.312 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9085514545440674
Epoch: 18, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.311 Vali Acc: 0.200 Test Loss: 1.311 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0155835151672363
Epoch: 19, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.309 Vali Acc: 0.200 Test Loss: 1.309 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2362518310546875
Epoch: 20, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.308 Vali Acc: 0.267 Test Loss: 1.308 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266654).  Saving model ...
Epoch: 21 cost time: 1.0012202262878418
Epoch: 21, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.307 Vali Acc: 0.267 Test Loss: 1.307 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 22 cost time: 1.2539093494415283
Epoch: 22, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.306 Vali Acc: 0.267 Test Loss: 1.306 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 23 cost time: 0.9648969173431396
Epoch: 23, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.306 Vali Acc: 0.333 Test Loss: 1.306 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333320).  Saving model ...
Epoch: 24 cost time: 0.7451095581054688
Epoch: 24, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1678895950317383
Epoch: 25, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.309 Vali Acc: 0.333 Test Loss: 1.309 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9430544376373291
Epoch: 26, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.313 Vali Acc: 0.333 Test Loss: 1.313 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9312899112701416
Epoch: 27, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.317 Vali Acc: 0.333 Test Loss: 1.317 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.325986385345459
Epoch: 28, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.322 Vali Acc: 0.333 Test Loss: 1.322 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.948878288269043
Epoch: 29, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.328 Vali Acc: 0.400 Test Loss: 1.328 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399987).  Saving model ...
Epoch: 30 cost time: 0.8453648090362549
Epoch: 30, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.334 Vali Acc: 0.400 Test Loss: 1.334 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.143946647644043
Epoch: 31, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9920127391815186
Epoch: 32, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.342 Vali Acc: 0.400 Test Loss: 1.342 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7984082698822021
Epoch: 33, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.346 Vali Acc: 0.400 Test Loss: 1.346 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7249228954315186
Epoch: 34, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0533175468444824
Epoch: 35, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.378361463546753
Epoch: 36, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8587298393249512
Epoch: 37, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8286783695220947
Epoch: 38, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.348 Vali Acc: 0.333 Test Loss: 1.348 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.866194486618042
Epoch: 39, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.348 Vali Acc: 0.333 Test Loss: 1.348 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 57155
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.434786081314087
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8616604804992676
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9343798160552979
Epoch: 3, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.062 Vali Acc: 0.267 Test Loss: 1.062 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.989790678024292
Epoch: 4, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.047 Vali Acc: 0.267 Test Loss: 1.047 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.916435956954956
Epoch: 5, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 1.0094172954559326
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 1.0315594673156738
Epoch: 7, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 8 cost time: 1.1888065338134766
Epoch: 8, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.004 Vali Acc: 0.400 Test Loss: 1.004 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.8902122974395752
Epoch: 9, Steps: 1 | Train Loss: 0.940 Vali Loss: 0.994 Vali Acc: 0.400 Test Loss: 0.994 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 0.9283275604248047
Epoch: 10, Steps: 1 | Train Loss: 0.789 Vali Loss: 0.983 Vali Acc: 0.467 Test Loss: 0.983 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 11 cost time: 0.9052600860595703
Epoch: 11, Steps: 1 | Train Loss: 0.921 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 12 cost time: 0.727402925491333
Epoch: 12, Steps: 1 | Train Loss: 0.898 Vali Loss: 0.962 Vali Acc: 0.533 Test Loss: 0.962 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 13 cost time: 0.9478669166564941
Epoch: 13, Steps: 1 | Train Loss: 0.780 Vali Loss: 0.952 Vali Acc: 0.533 Test Loss: 0.952 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 14 cost time: 1.0769693851470947
Epoch: 14, Steps: 1 | Train Loss: 0.789 Vali Loss: 0.943 Vali Acc: 0.533 Test Loss: 0.943 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 15 cost time: 1.0266709327697754
Epoch: 15, Steps: 1 | Train Loss: 0.842 Vali Loss: 0.934 Vali Acc: 0.600 Test Loss: 0.934 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599991).  Saving model ...
Epoch: 16 cost time: 1.1011102199554443
Epoch: 16, Steps: 1 | Train Loss: 0.614 Vali Loss: 0.927 Vali Acc: 0.733 Test Loss: 0.927 Test Acc: 0.733
Validation loss decreased (-0.599991 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 0.7494778633117676
Epoch: 17, Steps: 1 | Train Loss: 0.688 Vali Loss: 0.920 Vali Acc: 0.733 Test Loss: 0.920 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 18 cost time: 1.0632038116455078
Epoch: 18, Steps: 1 | Train Loss: 0.583 Vali Loss: 0.915 Vali Acc: 0.733 Test Loss: 0.915 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 1.0004651546478271
Epoch: 19, Steps: 1 | Train Loss: 0.520 Vali Loss: 0.910 Vali Acc: 0.733 Test Loss: 0.910 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 20 cost time: 1.228626012802124
Epoch: 20, Steps: 1 | Train Loss: 0.611 Vali Loss: 0.905 Vali Acc: 0.800 Test Loss: 0.905 Test Acc: 0.800
Validation loss decreased (-0.733324 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 1.0325977802276611
Epoch: 21, Steps: 1 | Train Loss: 0.642 Vali Loss: 0.900 Vali Acc: 0.800 Test Loss: 0.900 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 0.9824435710906982
Epoch: 22, Steps: 1 | Train Loss: 0.446 Vali Loss: 0.896 Vali Acc: 0.800 Test Loss: 0.896 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 23 cost time: 0.9178357124328613
Epoch: 23, Steps: 1 | Train Loss: 0.387 Vali Loss: 0.892 Vali Acc: 0.800 Test Loss: 0.892 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 24 cost time: 0.8401069641113281
Epoch: 24, Steps: 1 | Train Loss: 0.424 Vali Loss: 0.888 Vali Acc: 0.800 Test Loss: 0.888 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 25 cost time: 0.7722885608673096
Epoch: 25, Steps: 1 | Train Loss: 0.372 Vali Loss: 0.885 Vali Acc: 0.800 Test Loss: 0.885 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 26 cost time: 1.4952507019042969
Epoch: 26, Steps: 1 | Train Loss: 0.363 Vali Loss: 0.881 Vali Acc: 0.800 Test Loss: 0.881 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 27 cost time: 0.8598012924194336
Epoch: 27, Steps: 1 | Train Loss: 0.281 Vali Loss: 0.878 Vali Acc: 0.800 Test Loss: 0.878 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 28 cost time: 1.5971848964691162
Epoch: 28, Steps: 1 | Train Loss: 0.252 Vali Loss: 0.874 Vali Acc: 0.800 Test Loss: 0.874 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 29 cost time: 0.9728078842163086
Epoch: 29, Steps: 1 | Train Loss: 0.270 Vali Loss: 0.871 Vali Acc: 0.733 Test Loss: 0.871 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1895675659179688
Epoch: 30, Steps: 1 | Train Loss: 0.255 Vali Loss: 0.868 Vali Acc: 0.800 Test Loss: 0.868 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 31 cost time: 1.1549625396728516
Epoch: 31, Steps: 1 | Train Loss: 0.217 Vali Loss: 0.866 Vali Acc: 0.867 Test Loss: 0.866 Test Acc: 0.867
Validation loss decreased (-0.799991 --> -0.866658).  Saving model ...
Epoch: 32 cost time: 1.0269246101379395
Epoch: 32, Steps: 1 | Train Loss: 0.201 Vali Loss: 0.863 Vali Acc: 0.867 Test Loss: 0.863 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 33 cost time: 0.9523217678070068
Epoch: 33, Steps: 1 | Train Loss: 0.187 Vali Loss: 0.860 Vali Acc: 0.867 Test Loss: 0.860 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 34 cost time: 0.9779205322265625
Epoch: 34, Steps: 1 | Train Loss: 0.148 Vali Loss: 0.857 Vali Acc: 0.867 Test Loss: 0.857 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 35 cost time: 1.3602790832519531
Epoch: 35, Steps: 1 | Train Loss: 0.156 Vali Loss: 0.856 Vali Acc: 0.867 Test Loss: 0.856 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 36 cost time: 0.808326244354248
Epoch: 36, Steps: 1 | Train Loss: 0.106 Vali Loss: 0.854 Vali Acc: 0.867 Test Loss: 0.854 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 37 cost time: 1.0996787548065186
Epoch: 37, Steps: 1 | Train Loss: 0.101 Vali Loss: 0.852 Vali Acc: 0.867 Test Loss: 0.852 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 38 cost time: 1.2295074462890625
Epoch: 38, Steps: 1 | Train Loss: 0.082 Vali Loss: 0.851 Vali Acc: 0.867 Test Loss: 0.851 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 39 cost time: 1.3378169536590576
Epoch: 39, Steps: 1 | Train Loss: 0.076 Vali Loss: 0.850 Vali Acc: 0.867 Test Loss: 0.850 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 40 cost time: 1.0658838748931885
Epoch: 40, Steps: 1 | Train Loss: 0.064 Vali Loss: 0.849 Vali Acc: 0.867 Test Loss: 0.849 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 41 cost time: 0.9205186367034912
Epoch: 41, Steps: 1 | Train Loss: 0.079 Vali Loss: 0.847 Vali Acc: 0.867 Test Loss: 0.847 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 42 cost time: 0.9121041297912598
Epoch: 42, Steps: 1 | Train Loss: 0.061 Vali Loss: 0.847 Vali Acc: 0.867 Test Loss: 0.847 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 43 cost time: 0.7198069095611572
Epoch: 43, Steps: 1 | Train Loss: 0.060 Vali Loss: 0.846 Vali Acc: 0.867 Test Loss: 0.846 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 44 cost time: 0.9072883129119873
Epoch: 44, Steps: 1 | Train Loss: 0.049 Vali Loss: 0.845 Vali Acc: 0.800 Test Loss: 0.845 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8288900852203369
Epoch: 45, Steps: 1 | Train Loss: 0.048 Vali Loss: 0.844 Vali Acc: 0.800 Test Loss: 0.844 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8150980472564697
Epoch: 46, Steps: 1 | Train Loss: 0.050 Vali Loss: 0.844 Vali Acc: 0.800 Test Loss: 0.844 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.1017026901245117
Epoch: 47, Steps: 1 | Train Loss: 0.041 Vali Loss: 0.844 Vali Acc: 0.800 Test Loss: 0.844 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7670023441314697
Epoch: 48, Steps: 1 | Train Loss: 0.031 Vali Loss: 0.844 Vali Acc: 0.800 Test Loss: 0.844 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8913438320159912
Epoch: 49, Steps: 1 | Train Loss: 0.034 Vali Loss: 0.845 Vali Acc: 0.800 Test Loss: 0.845 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.9425861835479736
Epoch: 50, Steps: 1 | Train Loss: 0.030 Vali Loss: 0.846 Vali Acc: 0.733 Test Loss: 0.846 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.9873042106628418
Epoch: 51, Steps: 1 | Train Loss: 0.029 Vali Loss: 0.846 Vali Acc: 0.733 Test Loss: 0.846 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.9926247596740723
Epoch: 52, Steps: 1 | Train Loss: 0.021 Vali Loss: 0.847 Vali Acc: 0.733 Test Loss: 0.847 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0018365383148193
Epoch: 53, Steps: 1 | Train Loss: 0.024 Vali Loss: 0.848 Vali Acc: 0.733 Test Loss: 0.848 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.8666666666666667
model parameter : 54179
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.815819263458252
Epoch: 1, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6872749328613281
Epoch: 2, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 1.0380489826202393
Epoch: 3, Steps: 1 | Train Loss: 1.432 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9797556400299072
Epoch: 4, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9079501628875732
Epoch: 5, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7718343734741211
Epoch: 6, Steps: 1 | Train Loss: 1.336 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9686446189880371
Epoch: 7, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8205642700195312
Epoch: 8, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.875213623046875
Epoch: 9, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8308405876159668
Epoch: 10, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.216 Vali Acc: 0.200 Test Loss: 1.216 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9490673542022705
Epoch: 11, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9897370338439941
Epoch: 12, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 53859
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.034485578536987
Epoch: 1, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 1.010850429534912
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.249 Vali Acc: 0.200 Test Loss: 1.249 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.8664412498474121
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 1.1657319068908691
Epoch: 4, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.9181857109069824
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.9225184917449951
Epoch: 6, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.8806564807891846
Epoch: 7, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 1.2712230682373047
Epoch: 8, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.9311065673828125
Epoch: 9, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.9172284603118896
Epoch: 10, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 1.0348091125488281
Epoch: 11, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 1.197131633758545
Epoch: 12, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.9326326847076416
Epoch: 13, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 1.0857768058776855
Epoch: 14, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 1.0670461654663086
Epoch: 15, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 1.0316283702850342
Epoch: 16, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 1.1530086994171143
Epoch: 17, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.9949226379394531
Epoch: 18, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.8799905776977539
Epoch: 19, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.8727560043334961
Epoch: 20, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.9549405574798584
Epoch: 21, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 1.0009310245513916
Epoch: 22, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 1.1284799575805664
Epoch: 23, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 24 cost time: 1.2414817810058594
Epoch: 24, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 1.228041648864746
Epoch: 25, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 1.3569142818450928
Epoch: 26, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 1.0397956371307373
Epoch: 27, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.996943473815918
Epoch: 28, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2351553440093994
Epoch: 29, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.078996181488037
Epoch: 30, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.056039571762085
Epoch: 31, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0010490417480469
Epoch: 32, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1420907974243164
Epoch: 33, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 34 cost time: 0.99369215965271
Epoch: 34, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.085099220275879
Epoch: 35, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 36 cost time: 0.9755825996398926
Epoch: 36, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.074101448059082
Epoch: 37, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0604057312011719
Epoch: 38, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8918917179107666
Epoch: 39, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9818720817565918
Epoch: 40, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2639384269714355
Epoch: 41, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8443467617034912
Epoch: 42, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8172469139099121
Epoch: 43, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1163413524627686
Epoch: 44, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.1395082473754883
Epoch: 45, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 55171
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.857400417327881
Epoch: 1, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.330 Vali Acc: 0.333 Test Loss: 1.330 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.892319917678833
Epoch: 2, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.316 Vali Acc: 0.333 Test Loss: 1.316 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.8599276542663574
Epoch: 3, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.9035947322845459
Epoch: 4, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.294 Vali Acc: 0.333 Test Loss: 1.294 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 1.1425385475158691
Epoch: 5, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.285 Vali Acc: 0.333 Test Loss: 1.285 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 0.7940161228179932
Epoch: 6, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.276 Vali Acc: 0.333 Test Loss: 1.276 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.865593671798706
Epoch: 7, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0724546909332275
Epoch: 8, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7099525928497314
Epoch: 9, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.8383612632751465
Epoch: 10, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.9455766677856445
Epoch: 11, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.8399975299835205
Epoch: 12, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 1.0929920673370361
Epoch: 13, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 1.0500054359436035
Epoch: 14, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 1.0999271869659424
Epoch: 15, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 1.178086519241333
Epoch: 16, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 1.073998212814331
Epoch: 17, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 0.9020140171051025
Epoch: 18, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 0.8965327739715576
Epoch: 19, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 0.8399093151092529
Epoch: 20, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 0.7583119869232178
Epoch: 21, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.176 Vali Acc: 0.467 Test Loss: 1.176 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 22 cost time: 0.9937479496002197
Epoch: 22, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 1.1440980434417725
Epoch: 23, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 24 cost time: 0.9219191074371338
Epoch: 24, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 25 cost time: 1.326573371887207
Epoch: 25, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 26 cost time: 1.0132777690887451
Epoch: 26, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 27 cost time: 1.0609853267669678
Epoch: 27, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 28 cost time: 1.3110969066619873
Epoch: 28, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 29 cost time: 1.1730782985687256
Epoch: 29, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 30 cost time: 1.0171747207641602
Epoch: 30, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 31 cost time: 0.9978268146514893
Epoch: 31, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.8681535720825195
Epoch: 32, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 33 cost time: 0.9115142822265625
Epoch: 33, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 34 cost time: 1.1381916999816895
Epoch: 34, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 35 cost time: 1.2769770622253418
Epoch: 35, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 36 cost time: 0.761005163192749
Epoch: 36, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 37 cost time: 0.8555688858032227
Epoch: 37, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 38 cost time: 1.1883082389831543
Epoch: 38, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 39 cost time: 0.9812266826629639
Epoch: 39, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 40 cost time: 1.2261316776275635
Epoch: 40, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 41 cost time: 1.1960499286651611
Epoch: 41, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 42 cost time: 0.8923876285552979
Epoch: 42, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 43 cost time: 0.8999245166778564
Epoch: 43, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 44 cost time: 1.16066575050354
Epoch: 44, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 45 cost time: 1.0340790748596191
Epoch: 45, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 46 cost time: 1.1161701679229736
Epoch: 46, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 47 cost time: 1.527130365371704
Epoch: 47, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 48 cost time: 1.5932221412658691
Epoch: 48, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 49 cost time: 1.0249419212341309
Epoch: 49, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 50 cost time: 1.1051201820373535
Epoch: 50, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 51 cost time: 0.9920763969421387
Epoch: 51, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 52 cost time: 0.9256618022918701
Epoch: 52, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 53 cost time: 1.0824413299560547
Epoch: 53, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 54 cost time: 0.9641983509063721
Epoch: 54, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 55 cost time: 1.2734160423278809
Epoch: 55, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 56 cost time: 1.1871588230133057
Epoch: 56, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 57 cost time: 0.9396438598632812
Epoch: 57, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 58 cost time: 0.8326373100280762
Epoch: 58, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.038 Vali Acc: 0.667 Test Loss: 1.038 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 59 cost time: 1.3387835025787354
Epoch: 59, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.037 Vali Acc: 0.667 Test Loss: 1.037 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 60 cost time: 1.1742334365844727
Epoch: 60, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1995608806610107
Epoch: 61, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9931974411010742
Epoch: 62, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1395044326782227
Epoch: 63, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.0555341243743896
Epoch: 64, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.158771276473999
Epoch: 65, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.0369493961334229
Epoch: 66, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.308732271194458
Epoch: 67, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.3628289699554443
Epoch: 68, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.01228928565979
Epoch: 69, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 58019
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4200057983398438
Epoch: 1, Steps: 1 | Train Loss: 1.264 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.1453211307525635
Epoch: 2, Steps: 1 | Train Loss: 1.387 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.746171236038208
Epoch: 3, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8964231014251709
Epoch: 4, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.846541166305542
Epoch: 5, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.057748556137085
Epoch: 6, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9816069602966309
Epoch: 7, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8339331150054932
Epoch: 8, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7847943305969238
Epoch: 9, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8711225986480713
Epoch: 10, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9643545150756836
Epoch: 11, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df128_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 60867
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8131792545318604
Epoch: 1, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 1.1491684913635254
Epoch: 2, Steps: 1 | Train Loss: 1.347 Vali Loss: 1.057 Vali Acc: 0.600 Test Loss: 1.057 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.9916231632232666
Epoch: 3, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2412350177764893
Epoch: 4, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1426808834075928
Epoch: 5, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2419686317443848
Epoch: 6, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8574984073638916
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8256385326385498
Epoch: 8, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7725827693939209
Epoch: 9, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2980084419250488
Epoch: 10, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7151205539703369
Epoch: 11, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.023059368133545
Epoch: 12, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.013 Vali Acc: 0.400 Test Loss: 1.013 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 57667
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.49737286567688
Epoch: 1, Steps: 1 | Train Loss: 1.567 Vali Loss: 1.305 Vali Acc: 0.267 Test Loss: 1.305 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.7717571258544922
Epoch: 2, Steps: 1 | Train Loss: 1.497 Vali Loss: 1.302 Vali Acc: 0.267 Test Loss: 1.302 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.8075523376464844
Epoch: 3, Steps: 1 | Train Loss: 1.420 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.9827640056610107
Epoch: 4, Steps: 1 | Train Loss: 1.367 Vali Loss: 1.296 Vali Acc: 0.267 Test Loss: 1.296 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.8797826766967773
Epoch: 5, Steps: 1 | Train Loss: 1.528 Vali Loss: 1.292 Vali Acc: 0.267 Test Loss: 1.292 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.6983821392059326
Epoch: 6, Steps: 1 | Train Loss: 1.359 Vali Loss: 1.291 Vali Acc: 0.267 Test Loss: 1.291 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.8007912635803223
Epoch: 7, Steps: 1 | Train Loss: 1.527 Vali Loss: 1.289 Vali Acc: 0.267 Test Loss: 1.289 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 0.8773083686828613
Epoch: 8, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.898627758026123
Epoch: 9, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.281 Vali Acc: 0.200 Test Loss: 1.281 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7634696960449219
Epoch: 10, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.276 Vali Acc: 0.200 Test Loss: 1.276 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8484609127044678
Epoch: 11, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.270 Vali Acc: 0.200 Test Loss: 1.270 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.807178258895874
Epoch: 12, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.262 Vali Acc: 0.200 Test Loss: 1.262 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9339003562927246
Epoch: 13, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.254 Vali Acc: 0.200 Test Loss: 1.254 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0605745315551758
Epoch: 14, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 15 cost time: 0.8494813442230225
Epoch: 15, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.7553892135620117
Epoch: 16, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.9119625091552734
Epoch: 17, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 0.7683610916137695
Epoch: 18, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 0.7650585174560547
Epoch: 19, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 20 cost time: 0.9170174598693848
Epoch: 20, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 21 cost time: 0.6874294281005859
Epoch: 21, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 22 cost time: 0.771756649017334
Epoch: 22, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 0.7721755504608154
Epoch: 23, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 24 cost time: 0.8961231708526611
Epoch: 24, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 25 cost time: 0.7576663494110107
Epoch: 25, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 26 cost time: 0.8706636428833008
Epoch: 26, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.8605895042419434
Epoch: 27, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.7846653461456299
Epoch: 28, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.7536571025848389
Epoch: 29, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 0.7177488803863525
Epoch: 30, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 0.7329151630401611
Epoch: 31, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 32 cost time: 0.7163536548614502
Epoch: 32, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 33 cost time: 1.4305877685546875
Epoch: 33, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 34 cost time: 0.9662113189697266
Epoch: 34, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 35 cost time: 0.8957197666168213
Epoch: 35, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 36 cost time: 0.8026988506317139
Epoch: 36, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 37 cost time: 1.5386543273925781
Epoch: 37, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 38 cost time: 0.8093531131744385
Epoch: 38, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 39 cost time: 0.6888823509216309
Epoch: 39, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 40 cost time: 0.8627381324768066
Epoch: 40, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 41 cost time: 0.7652008533477783
Epoch: 41, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 42 cost time: 0.8558893203735352
Epoch: 42, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 43 cost time: 0.9423186779022217
Epoch: 43, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 44 cost time: 0.8926117420196533
Epoch: 44, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0087051391601562
Epoch: 45, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 46 cost time: 0.9176292419433594
Epoch: 46, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.080723524093628
Epoch: 47, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 48 cost time: 0.6993110179901123
Epoch: 48, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 49 cost time: 0.7009823322296143
Epoch: 49, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7739424705505371
Epoch: 50, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9254038333892822
Epoch: 51, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7465875148773193
Epoch: 52, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8384358882904053
Epoch: 53, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.7257616519927979
Epoch: 54, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.9202611446380615
Epoch: 55, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.8807632923126221
Epoch: 56, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.9473130702972412
Epoch: 57, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.704841136932373
Epoch: 58, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 44675
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.614203929901123
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.106083631515503
Epoch: 2, Steps: 1 | Train Loss: 1.286 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 1.0912270545959473
Epoch: 3, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.9474983215332031
Epoch: 4, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.8856172561645508
Epoch: 5, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.8943793773651123
Epoch: 6, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.9337954521179199
Epoch: 7, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.9870181083679199
Epoch: 8, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.8890814781188965
Epoch: 9, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.9457967281341553
Epoch: 10, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.8887379169464111
Epoch: 11, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.841609001159668
Epoch: 12, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.9808382987976074
Epoch: 13, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.9423413276672363
Epoch: 14, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1450238227844238
Epoch: 15, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9622213840484619
Epoch: 16, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8636345863342285
Epoch: 17, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8153102397918701
Epoch: 18, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.9310574531555176
Epoch: 19, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.9920778274536133
Epoch: 20, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.9131178855895996
Epoch: 21, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.7707605361938477
Epoch: 22, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.8867087364196777
Epoch: 23, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.8126397132873535
Epoch: 24, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.9983313083648682
Epoch: 25, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.8609180450439453
Epoch: 26, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.7507293224334717
Epoch: 27, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 0.7345330715179443
Epoch: 28, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9248533248901367
Epoch: 29, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.029325008392334
Epoch: 30, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7886621952056885
Epoch: 31, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8680403232574463
Epoch: 32, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7682616710662842
Epoch: 33, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7446961402893066
Epoch: 34, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7235443592071533
Epoch: 35, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7883796691894531
Epoch: 36, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9562685489654541
Epoch: 37, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 41699
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2898919582366943
Epoch: 1, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.0214178562164307
Epoch: 2, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 1.0562987327575684
Epoch: 3, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 1.012211561203003
Epoch: 4, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.8219633102416992
Epoch: 5, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.8570311069488525
Epoch: 6, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.8114564418792725
Epoch: 7, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.780670166015625
Epoch: 8, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.9404971599578857
Epoch: 9, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 1.0773470401763916
Epoch: 10, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 1.224442481994629
Epoch: 11, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 1.2231650352478027
Epoch: 12, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 1.3016183376312256
Epoch: 13, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 1.1348187923431396
Epoch: 14, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4222593307495117
Epoch: 15, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.128126621246338
Epoch: 16, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1565723419189453
Epoch: 17, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9547121524810791
Epoch: 18, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9151618480682373
Epoch: 19, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9066550731658936
Epoch: 20, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8255109786987305
Epoch: 21, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9759001731872559
Epoch: 22, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9496793746948242
Epoch: 23, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 41379
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.250690221786499
Epoch: 1, Steps: 1 | Train Loss: 1.045 Vali Loss: 0.945 Vali Acc: 0.600 Test Loss: 0.945 Test Acc: 0.600
Validation loss decreased (inf --> -0.599991).  Saving model ...
Epoch: 2 cost time: 1.0091726779937744
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 0.944 Vali Acc: 0.600 Test Loss: 0.944 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 3 cost time: 0.6395349502563477
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 0.943 Vali Acc: 0.533 Test Loss: 0.943 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7828118801116943
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 0.942 Vali Acc: 0.467 Test Loss: 0.942 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9389269351959229
Epoch: 5, Steps: 1 | Train Loss: 0.859 Vali Loss: 0.942 Vali Acc: 0.467 Test Loss: 0.942 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7828192710876465
Epoch: 6, Steps: 1 | Train Loss: 0.874 Vali Loss: 0.941 Vali Acc: 0.467 Test Loss: 0.941 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8086097240447998
Epoch: 7, Steps: 1 | Train Loss: 0.991 Vali Loss: 0.940 Vali Acc: 0.467 Test Loss: 0.940 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.880645751953125
Epoch: 8, Steps: 1 | Train Loss: 1.050 Vali Loss: 0.939 Vali Acc: 0.467 Test Loss: 0.939 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7640511989593506
Epoch: 9, Steps: 1 | Train Loss: 0.857 Vali Loss: 0.938 Vali Acc: 0.467 Test Loss: 0.938 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7060525417327881
Epoch: 10, Steps: 1 | Train Loss: 0.945 Vali Loss: 0.936 Vali Acc: 0.467 Test Loss: 0.936 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8267359733581543
Epoch: 11, Steps: 1 | Train Loss: 0.917 Vali Loss: 0.935 Vali Acc: 0.467 Test Loss: 0.935 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1198546886444092
Epoch: 12, Steps: 1 | Train Loss: 0.906 Vali Loss: 0.934 Vali Acc: 0.467 Test Loss: 0.934 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 42691
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4129176139831543
Epoch: 1, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7431118488311768
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.9719541072845459
Epoch: 3, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 1.068957805633545
Epoch: 4, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.8513391017913818
Epoch: 5, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.4248085021972656
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.934499979019165
Epoch: 7, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8792927265167236
Epoch: 8, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.8529891967773438
Epoch: 9, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.8979454040527344
Epoch: 10, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.8981974124908447
Epoch: 11, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.218 Vali Acc: 0.400 Test Loss: 1.218 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.7138628959655762
Epoch: 12, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.994189977645874
Epoch: 13, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 1.2151334285736084
Epoch: 14, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 1.094270944595337
Epoch: 15, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 1.0927157402038574
Epoch: 16, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 1.0395007133483887
Epoch: 17, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 1.3592479228973389
Epoch: 18, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4107170104980469
Epoch: 19, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2903687953948975
Epoch: 20, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3639347553253174
Epoch: 21, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.155494213104248
Epoch: 22, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0473530292510986
Epoch: 23, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.167806625366211
Epoch: 24, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8811061382293701
Epoch: 25, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 26 cost time: 1.1610217094421387
Epoch: 26, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 27 cost time: 0.9497337341308594
Epoch: 27, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 28 cost time: 0.8717381954193115
Epoch: 28, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 29 cost time: 1.1143684387207031
Epoch: 29, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.162 Vali Acc: 0.533 Test Loss: 1.162 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 30 cost time: 0.9751114845275879
Epoch: 30, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.158 Vali Acc: 0.533 Test Loss: 1.158 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 31 cost time: 0.9383029937744141
Epoch: 31, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.155 Vali Acc: 0.600 Test Loss: 1.155 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599988).  Saving model ...
Epoch: 32 cost time: 1.1852443218231201
Epoch: 32, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.153 Vali Acc: 0.600 Test Loss: 1.153 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 33 cost time: 1.3531498908996582
Epoch: 33, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.150 Vali Acc: 0.600 Test Loss: 1.150 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 34 cost time: 1.144731044769287
Epoch: 34, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.148 Vali Acc: 0.600 Test Loss: 1.148 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 35 cost time: 1.0243208408355713
Epoch: 35, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.145 Vali Acc: 0.600 Test Loss: 1.145 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 36 cost time: 1.0653440952301025
Epoch: 36, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.142 Vali Acc: 0.600 Test Loss: 1.142 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 37 cost time: 1.2185616493225098
Epoch: 37, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.140 Vali Acc: 0.600 Test Loss: 1.140 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 38 cost time: 1.1244316101074219
Epoch: 38, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.137 Vali Acc: 0.600 Test Loss: 1.137 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 39 cost time: 1.6133339405059814
Epoch: 39, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.135 Vali Acc: 0.600 Test Loss: 1.135 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 40 cost time: 0.8929011821746826
Epoch: 40, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.133 Vali Acc: 0.600 Test Loss: 1.133 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 41 cost time: 1.2442107200622559
Epoch: 41, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.132 Vali Acc: 0.600 Test Loss: 1.132 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 42 cost time: 0.9648489952087402
Epoch: 42, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.131 Vali Acc: 0.600 Test Loss: 1.131 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 43 cost time: 1.2406690120697021
Epoch: 43, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.129 Vali Acc: 0.600 Test Loss: 1.129 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 44 cost time: 1.4507324695587158
Epoch: 44, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.129 Vali Acc: 0.600 Test Loss: 1.129 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 45 cost time: 1.1542167663574219
Epoch: 45, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.129 Vali Acc: 0.600 Test Loss: 1.129 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 46 cost time: 1.540118932723999
Epoch: 46, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 47 cost time: 0.9456019401550293
Epoch: 47, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2510101795196533
Epoch: 48, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3032207489013672
Epoch: 49, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1876583099365234
Epoch: 50, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.2718768119812012
Epoch: 51, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.283602237701416
Epoch: 52, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.4346017837524414
Epoch: 53, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.120 Vali Acc: 0.533 Test Loss: 1.120 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.1643712520599365
Epoch: 54, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.0146901607513428
Epoch: 55, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.0892705917358398
Epoch: 56, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.117 Vali Acc: 0.600 Test Loss: 1.117 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 57 cost time: 0.8845007419586182
Epoch: 57, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.117 Vali Acc: 0.600 Test Loss: 1.117 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 58 cost time: 0.8549613952636719
Epoch: 58, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.116 Vali Acc: 0.667 Test Loss: 1.116 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 59 cost time: 1.0504868030548096
Epoch: 59, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.115 Vali Acc: 0.667 Test Loss: 1.115 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 60 cost time: 1.0102531909942627
Epoch: 60, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.114 Vali Acc: 0.667 Test Loss: 1.114 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 61 cost time: 1.2615671157836914
Epoch: 61, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.114 Vali Acc: 0.667 Test Loss: 1.114 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 62 cost time: 1.060863733291626
Epoch: 62, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.113 Vali Acc: 0.667 Test Loss: 1.113 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 63 cost time: 1.2950007915496826
Epoch: 63, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.113 Vali Acc: 0.667 Test Loss: 1.113 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.3398864269256592
Epoch: 64, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.113 Vali Acc: 0.667 Test Loss: 1.113 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.147075891494751
Epoch: 65, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.113 Vali Acc: 0.667 Test Loss: 1.113 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 66 cost time: 1.3611061573028564
Epoch: 66, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.113 Vali Acc: 0.667 Test Loss: 1.113 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 67 cost time: 1.211442470550537
Epoch: 67, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.112 Vali Acc: 0.667 Test Loss: 1.112 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 68 cost time: 1.0460765361785889
Epoch: 68, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.112 Vali Acc: 0.667 Test Loss: 1.112 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 69 cost time: 1.1304638385772705
Epoch: 69, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.111 Vali Acc: 0.667 Test Loss: 1.111 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 70 cost time: 1.9026823043823242
Epoch: 70, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.110 Vali Acc: 0.667 Test Loss: 1.110 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 71 cost time: 1.1924898624420166
Epoch: 71, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.110 Vali Acc: 0.667 Test Loss: 1.110 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.6096339225769043
Epoch: 72, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.109 Vali Acc: 0.667 Test Loss: 1.109 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 73 cost time: 1.1258275508880615
Epoch: 73, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.110 Vali Acc: 0.667 Test Loss: 1.110 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.0710947513580322
Epoch: 74, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.109 Vali Acc: 0.667 Test Loss: 1.109 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 75 cost time: 1.2853538990020752
Epoch: 75, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.109 Vali Acc: 0.667 Test Loss: 1.109 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 76 cost time: 1.1904025077819824
Epoch: 76, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.108 Vali Acc: 0.667 Test Loss: 1.108 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 77 cost time: 0.9919445514678955
Epoch: 77, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.109 Vali Acc: 0.667 Test Loss: 1.109 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.0781152248382568
Epoch: 78, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.108 Vali Acc: 0.667 Test Loss: 1.108 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.2645652294158936
Epoch: 79, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.108 Vali Acc: 0.667 Test Loss: 1.108 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 80 cost time: 1.13126540184021
Epoch: 80, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.108 Vali Acc: 0.667 Test Loss: 1.108 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 81 cost time: 1.5029973983764648
Epoch: 81, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.108 Vali Acc: 0.667 Test Loss: 1.108 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 82 cost time: 1.2369132041931152
Epoch: 82, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.107 Vali Acc: 0.667 Test Loss: 1.107 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 83 cost time: 1.6651136875152588
Epoch: 83, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.107 Vali Acc: 0.667 Test Loss: 1.107 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 84 cost time: 1.3161859512329102
Epoch: 84, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.106 Vali Acc: 0.667 Test Loss: 1.106 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 85 cost time: 1.2945129871368408
Epoch: 85, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.105 Vali Acc: 0.667 Test Loss: 1.105 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 86 cost time: 1.0447869300842285
Epoch: 86, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.105 Vali Acc: 0.667 Test Loss: 1.105 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 87 cost time: 1.1683299541473389
Epoch: 87, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.105 Vali Acc: 0.667 Test Loss: 1.105 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 88 cost time: 1.0506207942962646
Epoch: 88, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.104 Vali Acc: 0.667 Test Loss: 1.104 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 89 cost time: 1.5970816612243652
Epoch: 89, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.104 Vali Acc: 0.667 Test Loss: 1.104 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 90 cost time: 1.249389410018921
Epoch: 90, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.105 Vali Acc: 0.667 Test Loss: 1.105 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.3858263492584229
Epoch: 91, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.105 Vali Acc: 0.667 Test Loss: 1.105 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 1.3694767951965332
Epoch: 92, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.105 Vali Acc: 0.667 Test Loss: 1.105 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 1.093867301940918
Epoch: 93, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.105 Vali Acc: 0.667 Test Loss: 1.105 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 1.6346280574798584
Epoch: 94, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.106 Vali Acc: 0.667 Test Loss: 1.106 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 1.7077758312225342
Epoch: 95, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.105 Vali Acc: 0.667 Test Loss: 1.105 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 1.3993895053863525
Epoch: 96, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.105 Vali Acc: 0.667 Test Loss: 1.105 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 1.657790184020996
Epoch: 97, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.104 Vali Acc: 0.667 Test Loss: 1.104 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 1.204258918762207
Epoch: 98, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.105 Vali Acc: 0.667 Test Loss: 1.105 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 1.1257293224334717
Epoch: 99, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.105 Vali Acc: 0.667 Test Loss: 1.105 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 45539
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.766737222671509
Epoch: 1, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.492 Vali Acc: 0.333 Test Loss: 1.492 Test Acc: 0.333
Validation loss decreased (inf --> -0.333318).  Saving model ...
Epoch: 2 cost time: 0.8962197303771973
Epoch: 2, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.450 Vali Acc: 0.333 Test Loss: 1.450 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 0.7567970752716064
Epoch: 3, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.413 Vali Acc: 0.267 Test Loss: 1.413 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2872462272644043
Epoch: 4, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.381 Vali Acc: 0.267 Test Loss: 1.381 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0799155235290527
Epoch: 5, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.352 Vali Acc: 0.267 Test Loss: 1.352 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8912529945373535
Epoch: 6, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.328 Vali Acc: 0.267 Test Loss: 1.328 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9389302730560303
Epoch: 7, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 0.9198117256164551
Epoch: 8, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.289 Vali Acc: 0.333 Test Loss: 1.289 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 9 cost time: 1.1014845371246338
Epoch: 9, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.8914961814880371
Epoch: 10, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.9452838897705078
Epoch: 11, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 1.2019445896148682
Epoch: 12, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.9783411026000977
Epoch: 13, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.9118072986602783
Epoch: 14, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.8608114719390869
Epoch: 15, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.8459405899047852
Epoch: 16, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.9016242027282715
Epoch: 17, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 1.0736885070800781
Epoch: 18, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.9975566864013672
Epoch: 19, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.923163890838623
Epoch: 20, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 1.1683084964752197
Epoch: 21, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 22 cost time: 1.0815985202789307
Epoch: 22, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 1.023857831954956
Epoch: 23, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 24 cost time: 1.1205613613128662
Epoch: 24, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 25 cost time: 0.9831898212432861
Epoch: 25, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 26 cost time: 1.012930154800415
Epoch: 26, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 27 cost time: 0.6742486953735352
Epoch: 27, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 28 cost time: 0.9332056045532227
Epoch: 28, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7942423820495605
Epoch: 29, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7740638256072998
Epoch: 30, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7939305305480957
Epoch: 31, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 32 cost time: 0.9159669876098633
Epoch: 32, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.049241304397583
Epoch: 33, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.139899492263794
Epoch: 34, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8963344097137451
Epoch: 35, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9541563987731934
Epoch: 36, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.127124309539795
Epoch: 37, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7593710422515869
Epoch: 38, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6726627349853516
Epoch: 39, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7131786346435547
Epoch: 40, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9773299694061279
Epoch: 41, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm32_nh4_df64_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 48387
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2574050426483154
Epoch: 1, Steps: 1 | Train Loss: 1.330 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9308109283447266
Epoch: 2, Steps: 1 | Train Loss: 1.324 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9773774147033691
Epoch: 3, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 1.1321048736572266
Epoch: 4, Steps: 1 | Train Loss: 1.307 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.8532235622406006
Epoch: 5, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.0172009468078613
Epoch: 6, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.8536801338195801
Epoch: 7, Steps: 1 | Train Loss: 1.261 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8793962001800537
Epoch: 8, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8302638530731201
Epoch: 9, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.813417911529541
Epoch: 10, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8351407051086426
Epoch: 11, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8127620220184326
Epoch: 12, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9534456729888916
Epoch: 13, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0081214904785156
Epoch: 14, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7345743179321289
Epoch: 15, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0486047267913818
Epoch: 16, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 44867
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.509521245956421
Epoch: 1, Steps: 1 | Train Loss: 1.574 Vali Loss: 1.188 Vali Acc: 0.067 Test Loss: 1.188 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.8002421855926514
Epoch: 2, Steps: 1 | Train Loss: 1.366 Vali Loss: 1.187 Vali Acc: 0.067 Test Loss: 1.187 Test Acc: 0.067
Validation loss decreased (-0.066655 --> -0.066655).  Saving model ...
Epoch: 3 cost time: 0.8684206008911133
Epoch: 3, Steps: 1 | Train Loss: 1.287 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
Validation loss decreased (-0.066655 --> -0.133321).  Saving model ...
Epoch: 4 cost time: 0.7867732048034668
Epoch: 4, Steps: 1 | Train Loss: 1.386 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 5 cost time: 1.1534054279327393
Epoch: 5, Steps: 1 | Train Loss: 1.256 Vali Loss: 1.186 Vali Acc: 0.133 Test Loss: 1.186 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 6 cost time: 1.0760719776153564
Epoch: 6, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.186 Vali Acc: 0.133 Test Loss: 1.186 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0958404541015625
Epoch: 7, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.186 Vali Acc: 0.133 Test Loss: 1.186 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 8 cost time: 0.8268342018127441
Epoch: 8, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.185 Vali Acc: 0.133 Test Loss: 1.185 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 9 cost time: 1.0607249736785889
Epoch: 9, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (-0.133321 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 1.025937795639038
Epoch: 10, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.9739987850189209
Epoch: 11, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 1.1204533576965332
Epoch: 12, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.9204025268554688
Epoch: 13, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.9104905128479004
Epoch: 14, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.8467121124267578
Epoch: 15, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 1.0000150203704834
Epoch: 16, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 1.1336636543273926
Epoch: 17, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 1.2962851524353027
Epoch: 18, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.9298748970031738
Epoch: 19, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.9556653499603271
Epoch: 20, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 1.1203978061676025
Epoch: 21, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 0.9406547546386719
Epoch: 22, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.905341625213623
Epoch: 23, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1094253063201904
Epoch: 24, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9905753135681152
Epoch: 25, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0661895275115967
Epoch: 26, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.004281759262085
Epoch: 27, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9766232967376709
Epoch: 28, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0475478172302246
Epoch: 29, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0453667640686035
Epoch: 30, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.058342456817627
Epoch: 31, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 32 cost time: 1.0488972663879395
Epoch: 32, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 33 cost time: 1.0658318996429443
Epoch: 33, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 34 cost time: 0.8074002265930176
Epoch: 34, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 35 cost time: 1.0973482131958008
Epoch: 35, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 36 cost time: 0.8516056537628174
Epoch: 36, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 37 cost time: 0.9354941844940186
Epoch: 37, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 38 cost time: 1.0088047981262207
Epoch: 38, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 39 cost time: 1.057408332824707
Epoch: 39, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 40 cost time: 1.1189296245574951
Epoch: 40, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8503282070159912
Epoch: 41, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9060308933258057
Epoch: 42, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8140871524810791
Epoch: 43, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9312310218811035
Epoch: 44, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9798593521118164
Epoch: 45, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 46 cost time: 1.1452343463897705
Epoch: 46, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9598329067230225
Epoch: 47, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.407353162765503
Epoch: 48, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.130882978439331
Epoch: 49, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0187714099884033
Epoch: 50, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9660196304321289
Epoch: 51, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9378852844238281
Epoch: 52, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.2532081604003906
Epoch: 53, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.7631878852844238
Epoch: 54, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.1012940406799316
Epoch: 55, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 38371
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3511431217193604
Epoch: 1, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8180367946624756
Epoch: 2, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.9075953960418701
Epoch: 3, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.722719669342041
Epoch: 4, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 1.1061620712280273
Epoch: 5, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.0755643844604492
Epoch: 6, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.8998138904571533
Epoch: 7, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.8969385623931885
Epoch: 8, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7962560653686523
Epoch: 9, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.05122709274292
Epoch: 10, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9334509372711182
Epoch: 11, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.132305383682251
Epoch: 12, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9652748107910156
Epoch: 13, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8551743030548096
Epoch: 14, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.092761754989624
Epoch: 15, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9178640842437744
Epoch: 16, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8552241325378418
Epoch: 17, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0542399883270264
Epoch: 18, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 36883
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7505812644958496
Epoch: 1, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.2157838344573975
Epoch: 2, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.1675662994384766
Epoch: 3, Steps: 1 | Train Loss: 1.254 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.9527266025543213
Epoch: 4, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7116091251373291
Epoch: 5, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0214383602142334
Epoch: 6, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.054762363433838
Epoch: 7, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1149241924285889
Epoch: 8, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9471137523651123
Epoch: 9, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2807939052581787
Epoch: 10, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9939670562744141
Epoch: 11, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.9212343692779541
Epoch: 12, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.942490816116333
Epoch: 13, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.0211730003356934
Epoch: 14, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.1010921001434326
Epoch: 15, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.9446437358856201
Epoch: 16, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.9733293056488037
Epoch: 17, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.8342258930206299
Epoch: 18, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 1.024362564086914
Epoch: 19, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 1.2626938819885254
Epoch: 20, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.7685728073120117
Epoch: 21, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.9343745708465576
Epoch: 22, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 1.1027634143829346
Epoch: 23, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.8523154258728027
Epoch: 24, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 1.003413438796997
Epoch: 25, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 0.9179413318634033
Epoch: 26, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9127600193023682
Epoch: 27, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8618488311767578
Epoch: 28, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8039278984069824
Epoch: 29, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9876792430877686
Epoch: 30, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9304864406585693
Epoch: 31, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8122055530548096
Epoch: 32, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2340612411499023
Epoch: 33, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 34 cost time: 0.9056441783905029
Epoch: 34, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 35 cost time: 1.0975234508514404
Epoch: 35, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 36 cost time: 0.9939718246459961
Epoch: 36, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 37 cost time: 1.0668299198150635
Epoch: 37, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 38 cost time: 0.9326140880584717
Epoch: 38, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 39 cost time: 1.0044336318969727
Epoch: 39, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 40 cost time: 0.8371596336364746
Epoch: 40, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 41 cost time: 0.9291338920593262
Epoch: 41, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 42 cost time: 0.6564600467681885
Epoch: 42, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 43 cost time: 1.1927766799926758
Epoch: 43, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 44 cost time: 0.97963547706604
Epoch: 44, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 45 cost time: 0.7947616577148438
Epoch: 45, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 46 cost time: 0.797252893447876
Epoch: 46, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 47 cost time: 0.8018956184387207
Epoch: 47, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 48 cost time: 0.8673567771911621
Epoch: 48, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 49 cost time: 0.939699649810791
Epoch: 49, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 50 cost time: 0.8514914512634277
Epoch: 50, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 51 cost time: 0.9038822650909424
Epoch: 51, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 52 cost time: 1.0273041725158691
Epoch: 52, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 53 cost time: 0.9215984344482422
Epoch: 53, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 54 cost time: 0.9796125888824463
Epoch: 54, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 55 cost time: 0.8473589420318604
Epoch: 55, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 56 cost time: 0.8168466091156006
Epoch: 56, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 57 cost time: 0.769831657409668
Epoch: 57, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 58 cost time: 0.9446158409118652
Epoch: 58, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 59 cost time: 1.107600212097168
Epoch: 59, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 60 cost time: 1.0883166790008545
Epoch: 60, Steps: 1 | Train Loss: 0.090 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 61 cost time: 1.1038215160369873
Epoch: 61, Steps: 1 | Train Loss: 0.081 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 62 cost time: 0.839341402053833
Epoch: 62, Steps: 1 | Train Loss: 0.076 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 63 cost time: 0.9476776123046875
Epoch: 63, Steps: 1 | Train Loss: 0.091 Vali Loss: 0.993 Vali Acc: 0.533 Test Loss: 0.993 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 64 cost time: 0.9430947303771973
Epoch: 64, Steps: 1 | Train Loss: 0.056 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 65 cost time: 0.8732068538665771
Epoch: 65, Steps: 1 | Train Loss: 0.084 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 66 cost time: 1.0279455184936523
Epoch: 66, Steps: 1 | Train Loss: 0.075 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 67 cost time: 0.8803670406341553
Epoch: 67, Steps: 1 | Train Loss: 0.065 Vali Loss: 0.986 Vali Acc: 0.533 Test Loss: 0.986 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 68 cost time: 1.0625059604644775
Epoch: 68, Steps: 1 | Train Loss: 0.063 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 69 cost time: 0.887730598449707
Epoch: 69, Steps: 1 | Train Loss: 0.062 Vali Loss: 0.983 Vali Acc: 0.533 Test Loss: 0.983 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533324).  Saving model ...
Epoch: 70 cost time: 0.9367308616638184
Epoch: 70, Steps: 1 | Train Loss: 0.060 Vali Loss: 0.982 Vali Acc: 0.533 Test Loss: 0.982 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 71 cost time: 1.1273183822631836
Epoch: 71, Steps: 1 | Train Loss: 0.063 Vali Loss: 0.981 Vali Acc: 0.533 Test Loss: 0.981 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 72 cost time: 1.0653691291809082
Epoch: 72, Steps: 1 | Train Loss: 0.047 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 73 cost time: 1.1939971446990967
Epoch: 73, Steps: 1 | Train Loss: 0.053 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 74 cost time: 0.9712955951690674
Epoch: 74, Steps: 1 | Train Loss: 0.056 Vali Loss: 0.976 Vali Acc: 0.533 Test Loss: 0.976 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 75 cost time: 1.0097215175628662
Epoch: 75, Steps: 1 | Train Loss: 0.046 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 76 cost time: 0.9920122623443604
Epoch: 76, Steps: 1 | Train Loss: 0.045 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 77 cost time: 0.9714705944061279
Epoch: 77, Steps: 1 | Train Loss: 0.042 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 78 cost time: 0.8154833316802979
Epoch: 78, Steps: 1 | Train Loss: 0.041 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 79 cost time: 0.966235876083374
Epoch: 79, Steps: 1 | Train Loss: 0.037 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 80 cost time: 0.7048130035400391
Epoch: 80, Steps: 1 | Train Loss: 0.036 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 81 cost time: 0.9367392063140869
Epoch: 81, Steps: 1 | Train Loss: 0.034 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 82 cost time: 0.8734936714172363
Epoch: 82, Steps: 1 | Train Loss: 0.037 Vali Loss: 0.966 Vali Acc: 0.533 Test Loss: 0.966 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 83 cost time: 1.1374843120574951
Epoch: 83, Steps: 1 | Train Loss: 0.031 Vali Loss: 0.965 Vali Acc: 0.533 Test Loss: 0.965 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 84 cost time: 0.9470236301422119
Epoch: 84, Steps: 1 | Train Loss: 0.041 Vali Loss: 0.965 Vali Acc: 0.533 Test Loss: 0.965 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 85 cost time: 1.0520102977752686
Epoch: 85, Steps: 1 | Train Loss: 0.031 Vali Loss: 0.964 Vali Acc: 0.533 Test Loss: 0.964 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 86 cost time: 0.7432889938354492
Epoch: 86, Steps: 1 | Train Loss: 0.029 Vali Loss: 0.964 Vali Acc: 0.533 Test Loss: 0.964 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 87 cost time: 0.9617524147033691
Epoch: 87, Steps: 1 | Train Loss: 0.032 Vali Loss: 0.963 Vali Acc: 0.533 Test Loss: 0.963 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 88 cost time: 0.9925527572631836
Epoch: 88, Steps: 1 | Train Loss: 0.028 Vali Loss: 0.963 Vali Acc: 0.533 Test Loss: 0.963 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 89 cost time: 0.8639614582061768
Epoch: 89, Steps: 1 | Train Loss: 0.027 Vali Loss: 0.962 Vali Acc: 0.533 Test Loss: 0.962 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 90 cost time: 0.923577070236206
Epoch: 90, Steps: 1 | Train Loss: 0.026 Vali Loss: 0.962 Vali Acc: 0.533 Test Loss: 0.962 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 91 cost time: 0.9398994445800781
Epoch: 91, Steps: 1 | Train Loss: 0.029 Vali Loss: 0.961 Vali Acc: 0.533 Test Loss: 0.961 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 92 cost time: 1.0426051616668701
Epoch: 92, Steps: 1 | Train Loss: 0.023 Vali Loss: 0.961 Vali Acc: 0.533 Test Loss: 0.961 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 93 cost time: 0.8146347999572754
Epoch: 93, Steps: 1 | Train Loss: 0.024 Vali Loss: 0.961 Vali Acc: 0.533 Test Loss: 0.961 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 94 cost time: 0.8634738922119141
Epoch: 94, Steps: 1 | Train Loss: 0.030 Vali Loss: 0.961 Vali Acc: 0.533 Test Loss: 0.961 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 95 cost time: 0.7448272705078125
Epoch: 95, Steps: 1 | Train Loss: 0.024 Vali Loss: 0.961 Vali Acc: 0.533 Test Loss: 0.961 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 96 cost time: 0.6954245567321777
Epoch: 96, Steps: 1 | Train Loss: 0.032 Vali Loss: 0.961 Vali Acc: 0.533 Test Loss: 0.961 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 97 cost time: 0.7167315483093262
Epoch: 97, Steps: 1 | Train Loss: 0.024 Vali Loss: 0.960 Vali Acc: 0.533 Test Loss: 0.960 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 98 cost time: 0.9115798473358154
Epoch: 98, Steps: 1 | Train Loss: 0.028 Vali Loss: 0.960 Vali Acc: 0.533 Test Loss: 0.960 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 99 cost time: 1.2258431911468506
Epoch: 99, Steps: 1 | Train Loss: 0.032 Vali Loss: 0.960 Vali Acc: 0.533 Test Loss: 0.960 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 100 cost time: 1.0290603637695312
Epoch: 100, Steps: 1 | Train Loss: 0.017 Vali Loss: 0.960 Vali Acc: 0.533 Test Loss: 0.960 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 36723
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7749576568603516
Epoch: 1, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.1439244747161865
Epoch: 2, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8400554656982422
Epoch: 3, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7919485569000244
Epoch: 4, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.1228349208831787
Epoch: 5, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7873973846435547
Epoch: 6, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9656414985656738
Epoch: 7, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7129197120666504
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.9532949924468994
Epoch: 9, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8801963329315186
Epoch: 10, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.8344955444335938
Epoch: 11, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.9252321720123291
Epoch: 12, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.7878789901733398
Epoch: 13, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.9036262035369873
Epoch: 14, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 1.1342568397521973
Epoch: 15, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0175223350524902
Epoch: 16, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.083739995956421
Epoch: 17, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9921388626098633
Epoch: 18, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8487329483032227
Epoch: 19, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8692669868469238
Epoch: 20, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9343583583831787
Epoch: 21, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0326297283172607
Epoch: 22, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7644991874694824
Epoch: 23, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1488940715789795
Epoch: 24, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 37379
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5939130783081055
Epoch: 1, Steps: 1 | Train Loss: 1.422 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.122283935546875
Epoch: 2, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9231719970703125
Epoch: 3, Steps: 1 | Train Loss: 1.327 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.208888292312622
Epoch: 4, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8973908424377441
Epoch: 5, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0337693691253662
Epoch: 6, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0141441822052002
Epoch: 7, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1369812488555908
Epoch: 8, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.8952388763427734
Epoch: 9, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0942366123199463
Epoch: 10, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9837493896484375
Epoch: 11, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1743032932281494
Epoch: 12, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1534295082092285
Epoch: 13, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.824580192565918
Epoch: 14, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1652405261993408
Epoch: 15, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9050300121307373
Epoch: 16, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0395886898040771
Epoch: 17, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9639096260070801
Epoch: 18, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 38803
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.628570079803467
Epoch: 1, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.472012996673584
Epoch: 2, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.2540984153747559
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.180237054824829
Epoch: 4, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 1.4265508651733398
Epoch: 5, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.341325044631958
Epoch: 6, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.9966480731964111
Epoch: 7, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 1.4337091445922852
Epoch: 8, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.8873205184936523
Epoch: 9, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 1.2699313163757324
Epoch: 10, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 1.2026453018188477
Epoch: 11, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.8439767360687256
Epoch: 12, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 1.1149463653564453
Epoch: 13, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.3647825717926025
Epoch: 14, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.0620837211608887
Epoch: 15, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 1.09120512008667
Epoch: 16, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 1.0452470779418945
Epoch: 17, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 1.3268816471099854
Epoch: 18, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 1.055598258972168
Epoch: 19, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 1.1728801727294922
Epoch: 20, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.8760373592376709
Epoch: 21, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 22 cost time: 1.144437551498413
Epoch: 22, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 23 cost time: 1.3167834281921387
Epoch: 23, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 24 cost time: 0.9237799644470215
Epoch: 24, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 25 cost time: 0.8766372203826904
Epoch: 25, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 26 cost time: 1.0136940479278564
Epoch: 26, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 27 cost time: 1.2403464317321777
Epoch: 27, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 28 cost time: 1.131458044052124
Epoch: 28, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.8473467826843262
Epoch: 29, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.7421319484710693
Epoch: 30, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 0.9184651374816895
Epoch: 31, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 32 cost time: 1.0746536254882812
Epoch: 32, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 33 cost time: 1.1335625648498535
Epoch: 33, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0030641555786133
Epoch: 34, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.875246524810791
Epoch: 35, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 36 cost time: 1.3329200744628906
Epoch: 36, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 37 cost time: 0.7458555698394775
Epoch: 37, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 38 cost time: 1.0095832347869873
Epoch: 38, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 39 cost time: 0.82686448097229
Epoch: 39, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 40 cost time: 0.9505677223205566
Epoch: 40, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 41 cost time: 1.0708856582641602
Epoch: 41, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 42 cost time: 0.977938175201416
Epoch: 42, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 43 cost time: 0.9130048751831055
Epoch: 43, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 44 cost time: 0.9646186828613281
Epoch: 44, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 45 cost time: 1.3912677764892578
Epoch: 45, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 46 cost time: 1.0259170532226562
Epoch: 46, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 47 cost time: 1.192840814590454
Epoch: 47, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 48 cost time: 1.0417282581329346
Epoch: 48, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 49 cost time: 0.8350234031677246
Epoch: 49, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 50 cost time: 0.8879609107971191
Epoch: 50, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 51 cost time: 1.1699414253234863
Epoch: 51, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 52 cost time: 0.9734892845153809
Epoch: 52, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 53 cost time: 1.0079140663146973
Epoch: 53, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 54 cost time: 0.9161844253540039
Epoch: 54, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 55 cost time: 0.9247326850891113
Epoch: 55, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 56 cost time: 0.8331823348999023
Epoch: 56, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 57 cost time: 0.7957034111022949
Epoch: 57, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 58 cost time: 1.1279232501983643
Epoch: 58, Steps: 1 | Train Loss: 0.118 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 59 cost time: 1.0251717567443848
Epoch: 59, Steps: 1 | Train Loss: 0.113 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 60 cost time: 1.0894808769226074
Epoch: 60, Steps: 1 | Train Loss: 0.079 Vali Loss: 0.994 Vali Acc: 0.533 Test Loss: 0.994 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 61 cost time: 1.015815258026123
Epoch: 61, Steps: 1 | Train Loss: 0.085 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 62 cost time: 1.207578182220459
Epoch: 62, Steps: 1 | Train Loss: 0.082 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 63 cost time: 1.2819819450378418
Epoch: 63, Steps: 1 | Train Loss: 0.097 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 64 cost time: 1.0974571704864502
Epoch: 64, Steps: 1 | Train Loss: 0.079 Vali Loss: 0.986 Vali Acc: 0.533 Test Loss: 0.986 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 65 cost time: 1.1601555347442627
Epoch: 65, Steps: 1 | Train Loss: 0.070 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 66 cost time: 0.994492769241333
Epoch: 66, Steps: 1 | Train Loss: 0.072 Vali Loss: 0.983 Vali Acc: 0.533 Test Loss: 0.983 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533324).  Saving model ...
Epoch: 67 cost time: 1.104006052017212
Epoch: 67, Steps: 1 | Train Loss: 0.085 Vali Loss: 0.982 Vali Acc: 0.533 Test Loss: 0.982 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 68 cost time: 0.9435224533081055
Epoch: 68, Steps: 1 | Train Loss: 0.077 Vali Loss: 0.980 Vali Acc: 0.533 Test Loss: 0.980 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 69 cost time: 1.0042128562927246
Epoch: 69, Steps: 1 | Train Loss: 0.060 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 70 cost time: 1.359342336654663
Epoch: 70, Steps: 1 | Train Loss: 0.065 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 71 cost time: 1.1622216701507568
Epoch: 71, Steps: 1 | Train Loss: 0.046 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 72 cost time: 1.3581066131591797
Epoch: 72, Steps: 1 | Train Loss: 0.060 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 73 cost time: 1.1696269512176514
Epoch: 73, Steps: 1 | Train Loss: 0.057 Vali Loss: 0.976 Vali Acc: 0.533 Test Loss: 0.976 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 74 cost time: 1.2810747623443604
Epoch: 74, Steps: 1 | Train Loss: 0.062 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 75 cost time: 1.1270499229431152
Epoch: 75, Steps: 1 | Train Loss: 0.054 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.257638931274414
Epoch: 76, Steps: 1 | Train Loss: 0.059 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 77 cost time: 0.9987220764160156
Epoch: 77, Steps: 1 | Train Loss: 0.055 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 78 cost time: 1.1575794219970703
Epoch: 78, Steps: 1 | Train Loss: 0.050 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.215951919555664
Epoch: 79, Steps: 1 | Train Loss: 0.048 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.2401728630065918
Epoch: 80, Steps: 1 | Train Loss: 0.043 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 81 cost time: 0.9697422981262207
Epoch: 81, Steps: 1 | Train Loss: 0.044 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 82 cost time: 0.8294084072113037
Epoch: 82, Steps: 1 | Train Loss: 0.041 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.9912264347076416
Epoch: 83, Steps: 1 | Train Loss: 0.034 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.8832075595855713
Epoch: 84, Steps: 1 | Train Loss: 0.047 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.1196837425231934
Epoch: 85, Steps: 1 | Train Loss: 0.042 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.0829558372497559
Epoch: 86, Steps: 1 | Train Loss: 0.036 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.1282782554626465
Epoch: 87, Steps: 1 | Train Loss: 0.038 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.8436863422393799
Epoch: 88, Steps: 1 | Train Loss: 0.030 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.9906694889068604
Epoch: 89, Steps: 1 | Train Loss: 0.039 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.9700331687927246
Epoch: 90, Steps: 1 | Train Loss: 0.042 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 91 cost time: 0.7998757362365723
Epoch: 91, Steps: 1 | Train Loss: 0.034 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 92 cost time: 0.8973045349121094
Epoch: 92, Steps: 1 | Train Loss: 0.034 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 93 cost time: 1.011561632156372
Epoch: 93, Steps: 1 | Train Loss: 0.039 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 94 cost time: 0.8677361011505127
Epoch: 94, Steps: 1 | Train Loss: 0.030 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 95 cost time: 1.1410484313964844
Epoch: 95, Steps: 1 | Train Loss: 0.033 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.828610897064209
Epoch: 96, Steps: 1 | Train Loss: 0.031 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.1078784465789795
Epoch: 97, Steps: 1 | Train Loss: 0.035 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 98 cost time: 1.0884974002838135
Epoch: 98, Steps: 1 | Train Loss: 0.035 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.4414184093475342
Epoch: 99, Steps: 1 | Train Loss: 0.021 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 1.0907678604125977
Epoch: 100, Steps: 1 | Train Loss: 0.024 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df256_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 40227
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.174734592437744
Epoch: 1, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.9015467166900635
Epoch: 2, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.9571914672851562
Epoch: 3, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.8930799961090088
Epoch: 4, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.9610960483551025
Epoch: 5, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.7857925891876221
Epoch: 6, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 1.0028059482574463
Epoch: 7, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 1.241518497467041
Epoch: 8, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.9120156764984131
Epoch: 9, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.7799677848815918
Epoch: 10, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.9811854362487793
Epoch: 11, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.8647482395172119
Epoch: 12, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.960568904876709
Epoch: 13, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.1048336029052734
Epoch: 14, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.7958309650421143
Epoch: 15, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.9942853450775146
Epoch: 16, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.9209921360015869
Epoch: 17, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.9810926914215088
Epoch: 18, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 1.1969711780548096
Epoch: 19, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 1.0204455852508545
Epoch: 20, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.9012634754180908
Epoch: 21, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9758598804473877
Epoch: 22, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7414286136627197
Epoch: 23, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8885715007781982
Epoch: 24, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9726526737213135
Epoch: 25, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1081323623657227
Epoch: 26, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9463901519775391
Epoch: 27, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8910739421844482
Epoch: 28, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.7644870281219482
Epoch: 29, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 30 cost time: 0.933861255645752
Epoch: 30, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7522883415222168
Epoch: 31, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1105687618255615
Epoch: 32, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1816701889038086
Epoch: 33, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9079465866088867
Epoch: 34, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9405605792999268
Epoch: 35, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0150823593139648
Epoch: 36, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1988282203674316
Epoch: 37, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9328854084014893
Epoch: 38, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.87508225440979
Epoch: 39, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 32195
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.198199987411499
Epoch: 1, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.300 Vali Acc: 0.267 Test Loss: 1.300 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.7897169589996338
Epoch: 2, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.8362669944763184
Epoch: 3, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.289 Vali Acc: 0.267 Test Loss: 1.289 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.8694112300872803
Epoch: 4, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.284 Vali Acc: 0.267 Test Loss: 1.284 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 1.178896188735962
Epoch: 5, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.999903678894043
Epoch: 6, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.277 Vali Acc: 0.267 Test Loss: 1.277 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.8253602981567383
Epoch: 7, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.274 Vali Acc: 0.267 Test Loss: 1.274 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 0.8421773910522461
Epoch: 8, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.9054727554321289
Epoch: 9, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.8930087089538574
Epoch: 10, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 11 cost time: 0.859529972076416
Epoch: 11, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 12 cost time: 0.8869011402130127
Epoch: 12, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 13 cost time: 0.8479404449462891
Epoch: 13, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 14 cost time: 1.0260436534881592
Epoch: 14, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 15 cost time: 1.0516183376312256
Epoch: 15, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 16 cost time: 1.1380367279052734
Epoch: 16, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.8922417163848877
Epoch: 17, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9442317485809326
Epoch: 18, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9760265350341797
Epoch: 19, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9935071468353271
Epoch: 20, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.137364387512207
Epoch: 21, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1685333251953125
Epoch: 22, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1010491847991943
Epoch: 23, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.086937665939331
Epoch: 24, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1519250869750977
Epoch: 25, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 26 cost time: 0.7845783233642578
Epoch: 26, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 27 cost time: 1.082556962966919
Epoch: 27, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 28 cost time: 1.007988452911377
Epoch: 28, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 29 cost time: 0.7630691528320312
Epoch: 29, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 30 cost time: 0.9398396015167236
Epoch: 30, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 31 cost time: 0.9167797565460205
Epoch: 31, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 32 cost time: 0.9126391410827637
Epoch: 32, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9709546566009521
Epoch: 33, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.047661304473877
Epoch: 34, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.15871262550354
Epoch: 35, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.163975477218628
Epoch: 36, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3142404556274414
Epoch: 37, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4762940406799316
Epoch: 38, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.255235195159912
Epoch: 39, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.962183952331543
Epoch: 40, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0302908420562744
Epoch: 41, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 25699
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.400181770324707
Epoch: 1, Steps: 1 | Train Loss: 1.317 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 1.1616711616516113
Epoch: 2, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 1.191382884979248
Epoch: 3, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 1.1087205410003662
Epoch: 4, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 1.3174240589141846
Epoch: 5, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 1.2406656742095947
Epoch: 6, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2092511653900146
Epoch: 7, Steps: 1 | Train Loss: 1.323 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 8 cost time: 1.0926039218902588
Epoch: 8, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 1.2510409355163574
Epoch: 9, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 1.1093463897705078
Epoch: 10, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 0.9081776142120361
Epoch: 11, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 12 cost time: 1.1740264892578125
Epoch: 12, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 1.138000249862671
Epoch: 13, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 0.9295930862426758
Epoch: 14, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 15 cost time: 0.9973180294036865
Epoch: 15, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 16 cost time: 1.1798410415649414
Epoch: 16, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 1.14719820022583
Epoch: 17, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.8314905166625977
Epoch: 18, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.8154308795928955
Epoch: 19, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8406999111175537
Epoch: 20, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0831661224365234
Epoch: 21, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1010417938232422
Epoch: 22, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.315887451171875
Epoch: 23, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3965771198272705
Epoch: 24, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7899017333984375
Epoch: 25, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7008709907531738
Epoch: 26, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9489185810089111
Epoch: 27, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.013 Vali Acc: 0.400 Test Loss: 1.013 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0331027507781982
Epoch: 28, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.011 Vali Acc: 0.400 Test Loss: 1.011 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 24211
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7166659832000732
Epoch: 1, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9245948791503906
Epoch: 2, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.0062925815582275
Epoch: 3, Steps: 1 | Train Loss: 1.271 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.094599962234497
Epoch: 4, Steps: 1 | Train Loss: 1.321 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0277912616729736
Epoch: 5, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9743273258209229
Epoch: 6, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8687729835510254
Epoch: 7, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0517463684082031
Epoch: 8, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7702245712280273
Epoch: 9, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9579148292541504
Epoch: 10, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9427013397216797
Epoch: 11, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8911278247833252
Epoch: 12, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9443850517272949
Epoch: 13, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 24051
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.573294162750244
Epoch: 1, Steps: 1 | Train Loss: 1.442 Vali Loss: 1.292 Vali Acc: 0.200 Test Loss: 1.292 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.8472723960876465
Epoch: 2, Steps: 1 | Train Loss: 1.304 Vali Loss: 1.293 Vali Acc: 0.200 Test Loss: 1.293 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8525347709655762
Epoch: 3, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.293 Vali Acc: 0.200 Test Loss: 1.293 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1928706169128418
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.294 Vali Acc: 0.200 Test Loss: 1.294 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0222671031951904
Epoch: 5, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.296 Vali Acc: 0.200 Test Loss: 1.296 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9784293174743652
Epoch: 6, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.298 Vali Acc: 0.200 Test Loss: 1.298 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9806768894195557
Epoch: 7, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.300 Vali Acc: 0.200 Test Loss: 1.300 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8941378593444824
Epoch: 8, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.301 Vali Acc: 0.200 Test Loss: 1.301 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3688719272613525
Epoch: 9, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.303 Vali Acc: 0.200 Test Loss: 1.303 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9680099487304688
Epoch: 10, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.305 Vali Acc: 0.200 Test Loss: 1.305 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5287420749664307
Epoch: 11, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.307 Vali Acc: 0.200 Test Loss: 1.307 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 24707
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5325069427490234
Epoch: 1, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.9177982807159424
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 1.1456241607666016
Epoch: 3, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 1.0062954425811768
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.928114652633667
Epoch: 5, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2093987464904785
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0665409564971924
Epoch: 7, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2651662826538086
Epoch: 8, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0205230712890625
Epoch: 9, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 1.0719616413116455
Epoch: 10, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 1.11102294921875
Epoch: 11, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9730269908905029
Epoch: 12, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1922707557678223
Epoch: 13, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 1.1144335269927979
Epoch: 14, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 1.2570903301239014
Epoch: 15, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 1.0775854587554932
Epoch: 16, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.9402825832366943
Epoch: 17, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 1.2875573635101318
Epoch: 18, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 0.9672391414642334
Epoch: 19, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 1.1038520336151123
Epoch: 20, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4209015369415283
Epoch: 21, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0915310382843018
Epoch: 22, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9095232486724854
Epoch: 23, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8847286701202393
Epoch: 24, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0685954093933105
Epoch: 25, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0306894779205322
Epoch: 26, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5005598068237305
Epoch: 27, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0653553009033203
Epoch: 28, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3440203666687012
Epoch: 29, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 26131
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.163184642791748
Epoch: 1, Steps: 1 | Train Loss: 1.313 Vali Loss: 1.200 Vali Acc: 0.133 Test Loss: 1.200 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.6939573287963867
Epoch: 2, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.203 Vali Acc: 0.133 Test Loss: 1.203 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0423285961151123
Epoch: 3, Steps: 1 | Train Loss: 1.342 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 1.0208783149719238
Epoch: 4, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7686164379119873
Epoch: 5, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0785303115844727
Epoch: 6, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7186462879180908
Epoch: 7, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.048905849456787
Epoch: 8, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7257785797119141
Epoch: 9, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0685389041900635
Epoch: 10, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0399770736694336
Epoch: 11, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8359811305999756
Epoch: 12, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.229 Vali Acc: 0.200 Test Loss: 1.229 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9931118488311768
Epoch: 13, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.232 Vali Acc: 0.200 Test Loss: 1.232 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df128_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 27555
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9824023246765137
Epoch: 1, Steps: 1 | Train Loss: 1.284 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.032975673675537
Epoch: 2, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.341966152191162
Epoch: 3, Steps: 1 | Train Loss: 1.436 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.314939260482788
Epoch: 4, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0414214134216309
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9338455200195312
Epoch: 6, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1346800327301025
Epoch: 7, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1832168102264404
Epoch: 8, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2549798488616943
Epoch: 9, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0170361995697021
Epoch: 10, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1051604747772217
Epoch: 11, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0698983669281006
Epoch: 12, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 25859
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5557639598846436
Epoch: 1, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.16908860206604
Epoch: 2, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.1327884197235107
Epoch: 3, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.0417475700378418
Epoch: 4, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.9413261413574219
Epoch: 5, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.0866169929504395
Epoch: 6, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 1.021305799484253
Epoch: 7, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.9412176609039307
Epoch: 8, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 1.038454532623291
Epoch: 9, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 1.132737159729004
Epoch: 10, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0317847728729248
Epoch: 11, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1792306900024414
Epoch: 12, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.062129020690918
Epoch: 13, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9080221652984619
Epoch: 14, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.005910873413086
Epoch: 15, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8728277683258057
Epoch: 16, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9760115146636963
Epoch: 17, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.0154378414154053
Epoch: 18, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 1.168492317199707
Epoch: 19, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 1.0820140838623047
Epoch: 20, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.9396183490753174
Epoch: 21, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 1.078242540359497
Epoch: 22, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.8869788646697998
Epoch: 23, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 1.1471433639526367
Epoch: 24, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.9742650985717773
Epoch: 25, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 1.0656991004943848
Epoch: 26, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 1.2222166061401367
Epoch: 27, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 1.005079984664917
Epoch: 28, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.9674170017242432
Epoch: 29, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 1.0600762367248535
Epoch: 30, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 0.9070031642913818
Epoch: 31, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9813921451568604
Epoch: 32, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9031102657318115
Epoch: 33, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1594927310943604
Epoch: 34, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0408241748809814
Epoch: 35, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.919222354888916
Epoch: 36, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5485525131225586
Epoch: 37, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8720638751983643
Epoch: 38, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 39 cost time: 1.0201787948608398
Epoch: 39, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8437163829803467
Epoch: 40, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1057658195495605
Epoch: 41, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.240541934967041
Epoch: 42, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 43 cost time: 0.9016475677490234
Epoch: 43, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 44 cost time: 0.9601244926452637
Epoch: 44, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0913758277893066
Epoch: 45, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.229971170425415
Epoch: 46, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9572727680206299
Epoch: 47, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.062337875366211
Epoch: 48, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.1068222522735596
Epoch: 49, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.8313124179840088
Epoch: 50, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.9063165187835693
Epoch: 51, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.1141409873962402
Epoch: 52, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0059492588043213
Epoch: 53, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 19363
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.183806896209717
Epoch: 1, Steps: 1 | Train Loss: 1.424 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.918694019317627
Epoch: 2, Steps: 1 | Train Loss: 1.403 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9323709011077881
Epoch: 3, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8086426258087158
Epoch: 4, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7944884300231934
Epoch: 5, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0994257926940918
Epoch: 6, Steps: 1 | Train Loss: 1.474 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9134397506713867
Epoch: 7, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9114687442779541
Epoch: 8, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8811407089233398
Epoch: 9, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.139761209487915
Epoch: 10, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8294610977172852
Epoch: 11, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 17875
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.747323751449585
Epoch: 1, Steps: 1 | Train Loss: 1.394 Vali Loss: 1.552 Vali Acc: 0.333 Test Loss: 1.552 Test Acc: 0.333
Validation loss decreased (inf --> -0.333318).  Saving model ...
Epoch: 2 cost time: 0.9235701560974121
Epoch: 2, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.509 Vali Acc: 0.333 Test Loss: 1.509 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333318).  Saving model ...
Epoch: 3 cost time: 0.7955234050750732
Epoch: 3, Steps: 1 | Train Loss: 1.319 Vali Loss: 1.473 Vali Acc: 0.333 Test Loss: 1.473 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333319).  Saving model ...
Epoch: 4 cost time: 0.8047022819519043
Epoch: 4, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.441 Vali Acc: 0.333 Test Loss: 1.441 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 0.9920082092285156
Epoch: 5, Steps: 1 | Train Loss: 1.273 Vali Loss: 1.414 Vali Acc: 0.333 Test Loss: 1.414 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 6 cost time: 0.900153636932373
Epoch: 6, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.394 Vali Acc: 0.333 Test Loss: 1.394 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 7 cost time: 0.8953301906585693
Epoch: 7, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.377 Vali Acc: 0.333 Test Loss: 1.377 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 1.0197653770446777
Epoch: 8, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.361 Vali Acc: 0.333 Test Loss: 1.361 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 9 cost time: 0.978607177734375
Epoch: 9, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.348 Vali Acc: 0.333 Test Loss: 1.348 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 1.1625549793243408
Epoch: 10, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.335 Vali Acc: 0.200 Test Loss: 1.335 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9248640537261963
Epoch: 11, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.324 Vali Acc: 0.200 Test Loss: 1.324 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.151639461517334
Epoch: 12, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.314 Vali Acc: 0.133 Test Loss: 1.314 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8257982730865479
Epoch: 13, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.305 Vali Acc: 0.133 Test Loss: 1.305 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9577257633209229
Epoch: 14, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.296 Vali Acc: 0.133 Test Loss: 1.296 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1334049701690674
Epoch: 15, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.288 Vali Acc: 0.133 Test Loss: 1.288 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0804104804992676
Epoch: 16, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.281 Vali Acc: 0.133 Test Loss: 1.281 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0850427150726318
Epoch: 17, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.273 Vali Acc: 0.133 Test Loss: 1.273 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1024141311645508
Epoch: 18, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.267 Vali Acc: 0.133 Test Loss: 1.267 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2406814098358154
Epoch: 19, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.260 Vali Acc: 0.133 Test Loss: 1.260 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 17715
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2559852600097656
Epoch: 1, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.9360537528991699
Epoch: 2, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 1.1804790496826172
Epoch: 3, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 1.1806845664978027
Epoch: 4, Steps: 1 | Train Loss: 1.306 Vali Loss: 1.069 Vali Acc: 0.267 Test Loss: 1.069 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.8743038177490234
Epoch: 5, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.069 Vali Acc: 0.267 Test Loss: 1.069 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 1.0502619743347168
Epoch: 6, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.068 Vali Acc: 0.267 Test Loss: 1.068 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 1.150038719177246
Epoch: 7, Steps: 1 | Train Loss: 1.354 Vali Loss: 1.068 Vali Acc: 0.267 Test Loss: 1.068 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 1.053025245666504
Epoch: 8, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 1.030135154724121
Epoch: 9, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 0.9362573623657227
Epoch: 10, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 1.1283540725708008
Epoch: 11, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 1.0709073543548584
Epoch: 12, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 1.0350353717803955
Epoch: 13, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 1.1012372970581055
Epoch: 14, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 1.142219066619873
Epoch: 15, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 0.9179644584655762
Epoch: 16, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 1.1807301044464111
Epoch: 17, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 0.7980844974517822
Epoch: 18, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 0.843379020690918
Epoch: 19, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.044 Vali Acc: 0.333 Test Loss: 1.044 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 20 cost time: 1.089254379272461
Epoch: 20, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 21 cost time: 0.9934895038604736
Epoch: 21, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 22 cost time: 1.0013961791992188
Epoch: 22, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 23 cost time: 1.123317003250122
Epoch: 23, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 24 cost time: 0.9250173568725586
Epoch: 24, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 25 cost time: 1.0778851509094238
Epoch: 25, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 26 cost time: 1.0607833862304688
Epoch: 26, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 27 cost time: 0.9382588863372803
Epoch: 27, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 28 cost time: 0.9018797874450684
Epoch: 28, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 29 cost time: 1.0260748863220215
Epoch: 29, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 30 cost time: 0.9427230358123779
Epoch: 30, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 31 cost time: 0.8473107814788818
Epoch: 31, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.011 Vali Acc: 0.400 Test Loss: 1.011 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 32 cost time: 1.085655689239502
Epoch: 32, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.008 Vali Acc: 0.400 Test Loss: 1.008 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 33 cost time: 0.9151723384857178
Epoch: 33, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.005 Vali Acc: 0.400 Test Loss: 1.005 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 34 cost time: 0.7689809799194336
Epoch: 34, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.003 Vali Acc: 0.400 Test Loss: 1.003 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 35 cost time: 1.0699362754821777
Epoch: 35, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.000 Vali Acc: 0.400 Test Loss: 1.000 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 36 cost time: 0.9206936359405518
Epoch: 36, Steps: 1 | Train Loss: 0.560 Vali Loss: 0.997 Vali Acc: 0.400 Test Loss: 0.997 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 37 cost time: 1.020723581314087
Epoch: 37, Steps: 1 | Train Loss: 0.510 Vali Loss: 0.994 Vali Acc: 0.400 Test Loss: 0.994 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 38 cost time: 1.3312122821807861
Epoch: 38, Steps: 1 | Train Loss: 0.460 Vali Loss: 0.991 Vali Acc: 0.400 Test Loss: 0.991 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 39 cost time: 0.810225248336792
Epoch: 39, Steps: 1 | Train Loss: 0.467 Vali Loss: 0.988 Vali Acc: 0.400 Test Loss: 0.988 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 40 cost time: 1.0468769073486328
Epoch: 40, Steps: 1 | Train Loss: 0.435 Vali Loss: 0.985 Vali Acc: 0.400 Test Loss: 0.985 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 41 cost time: 0.9400701522827148
Epoch: 41, Steps: 1 | Train Loss: 0.393 Vali Loss: 0.982 Vali Acc: 0.400 Test Loss: 0.982 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 42 cost time: 0.7383549213409424
Epoch: 42, Steps: 1 | Train Loss: 0.416 Vali Loss: 0.979 Vali Acc: 0.400 Test Loss: 0.979 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 43 cost time: 0.9154624938964844
Epoch: 43, Steps: 1 | Train Loss: 0.370 Vali Loss: 0.976 Vali Acc: 0.400 Test Loss: 0.976 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 44 cost time: 0.8607335090637207
Epoch: 44, Steps: 1 | Train Loss: 0.332 Vali Loss: 0.974 Vali Acc: 0.400 Test Loss: 0.974 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 45 cost time: 1.3004534244537354
Epoch: 45, Steps: 1 | Train Loss: 0.357 Vali Loss: 0.971 Vali Acc: 0.400 Test Loss: 0.971 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 46 cost time: 1.3030438423156738
Epoch: 46, Steps: 1 | Train Loss: 0.289 Vali Loss: 0.968 Vali Acc: 0.467 Test Loss: 0.968 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 47 cost time: 0.8032107353210449
Epoch: 47, Steps: 1 | Train Loss: 0.231 Vali Loss: 0.967 Vali Acc: 0.467 Test Loss: 0.967 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 48 cost time: 0.8862507343292236
Epoch: 48, Steps: 1 | Train Loss: 0.271 Vali Loss: 0.966 Vali Acc: 0.467 Test Loss: 0.966 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 49 cost time: 0.8916435241699219
Epoch: 49, Steps: 1 | Train Loss: 0.241 Vali Loss: 0.965 Vali Acc: 0.467 Test Loss: 0.965 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 50 cost time: 0.8512327671051025
Epoch: 50, Steps: 1 | Train Loss: 0.267 Vali Loss: 0.964 Vali Acc: 0.467 Test Loss: 0.964 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 51 cost time: 1.050689458847046
Epoch: 51, Steps: 1 | Train Loss: 0.240 Vali Loss: 0.963 Vali Acc: 0.467 Test Loss: 0.963 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 52 cost time: 1.1144092082977295
Epoch: 52, Steps: 1 | Train Loss: 0.198 Vali Loss: 0.962 Vali Acc: 0.467 Test Loss: 0.962 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 53 cost time: 0.6919384002685547
Epoch: 53, Steps: 1 | Train Loss: 0.195 Vali Loss: 0.961 Vali Acc: 0.467 Test Loss: 0.961 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 54 cost time: 0.975445032119751
Epoch: 54, Steps: 1 | Train Loss: 0.188 Vali Loss: 0.960 Vali Acc: 0.467 Test Loss: 0.960 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 55 cost time: 0.8407177925109863
Epoch: 55, Steps: 1 | Train Loss: 0.221 Vali Loss: 0.959 Vali Acc: 0.467 Test Loss: 0.959 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 56 cost time: 1.0203657150268555
Epoch: 56, Steps: 1 | Train Loss: 0.189 Vali Loss: 0.957 Vali Acc: 0.467 Test Loss: 0.957 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 57 cost time: 0.9887042045593262
Epoch: 57, Steps: 1 | Train Loss: 0.205 Vali Loss: 0.957 Vali Acc: 0.467 Test Loss: 0.957 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1343388557434082
Epoch: 58, Steps: 1 | Train Loss: 0.151 Vali Loss: 0.956 Vali Acc: 0.467 Test Loss: 0.956 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 59 cost time: 0.8468313217163086
Epoch: 59, Steps: 1 | Train Loss: 0.133 Vali Loss: 0.955 Vali Acc: 0.467 Test Loss: 0.955 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 60 cost time: 1.336674451828003
Epoch: 60, Steps: 1 | Train Loss: 0.136 Vali Loss: 0.954 Vali Acc: 0.467 Test Loss: 0.954 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 61 cost time: 1.0588643550872803
Epoch: 61, Steps: 1 | Train Loss: 0.160 Vali Loss: 0.954 Vali Acc: 0.467 Test Loss: 0.954 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0849978923797607
Epoch: 62, Steps: 1 | Train Loss: 0.111 Vali Loss: 0.953 Vali Acc: 0.467 Test Loss: 0.953 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 63 cost time: 0.8589048385620117
Epoch: 63, Steps: 1 | Train Loss: 0.109 Vali Loss: 0.953 Vali Acc: 0.467 Test Loss: 0.953 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 64 cost time: 1.1856715679168701
Epoch: 64, Steps: 1 | Train Loss: 0.114 Vali Loss: 0.952 Vali Acc: 0.467 Test Loss: 0.952 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 65 cost time: 0.6990234851837158
Epoch: 65, Steps: 1 | Train Loss: 0.128 Vali Loss: 0.952 Vali Acc: 0.467 Test Loss: 0.952 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 66 cost time: 0.811936616897583
Epoch: 66, Steps: 1 | Train Loss: 0.115 Vali Loss: 0.952 Vali Acc: 0.467 Test Loss: 0.952 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7622816562652588
Epoch: 67, Steps: 1 | Train Loss: 0.102 Vali Loss: 0.952 Vali Acc: 0.467 Test Loss: 0.952 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.8684873580932617
Epoch: 68, Steps: 1 | Train Loss: 0.081 Vali Loss: 0.953 Vali Acc: 0.467 Test Loss: 0.953 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.8433644771575928
Epoch: 69, Steps: 1 | Train Loss: 0.097 Vali Loss: 0.953 Vali Acc: 0.467 Test Loss: 0.953 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.0184695720672607
Epoch: 70, Steps: 1 | Train Loss: 0.087 Vali Loss: 0.954 Vali Acc: 0.467 Test Loss: 0.954 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.9872393608093262
Epoch: 71, Steps: 1 | Train Loss: 0.113 Vali Loss: 0.954 Vali Acc: 0.533 Test Loss: 0.954 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 72 cost time: 1.059671401977539
Epoch: 72, Steps: 1 | Train Loss: 0.073 Vali Loss: 0.954 Vali Acc: 0.533 Test Loss: 0.954 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 73 cost time: 0.7709541320800781
Epoch: 73, Steps: 1 | Train Loss: 0.075 Vali Loss: 0.954 Vali Acc: 0.533 Test Loss: 0.954 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.06223464012146
Epoch: 74, Steps: 1 | Train Loss: 0.066 Vali Loss: 0.954 Vali Acc: 0.533 Test Loss: 0.954 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.3354249000549316
Epoch: 75, Steps: 1 | Train Loss: 0.055 Vali Loss: 0.955 Vali Acc: 0.533 Test Loss: 0.955 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.1331491470336914
Epoch: 76, Steps: 1 | Train Loss: 0.067 Vali Loss: 0.955 Vali Acc: 0.533 Test Loss: 0.955 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.263920545578003
Epoch: 77, Steps: 1 | Train Loss: 0.058 Vali Loss: 0.955 Vali Acc: 0.533 Test Loss: 0.955 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.031620740890503
Epoch: 78, Steps: 1 | Train Loss: 0.059 Vali Loss: 0.955 Vali Acc: 0.533 Test Loss: 0.955 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.2172951698303223
Epoch: 79, Steps: 1 | Train Loss: 0.076 Vali Loss: 0.955 Vali Acc: 0.533 Test Loss: 0.955 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.7208795547485352
Epoch: 80, Steps: 1 | Train Loss: 0.075 Vali Loss: 0.955 Vali Acc: 0.533 Test Loss: 0.955 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.9992654323577881
Epoch: 81, Steps: 1 | Train Loss: 0.067 Vali Loss: 0.956 Vali Acc: 0.533 Test Loss: 0.956 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.8579216003417969
Epoch: 82, Steps: 1 | Train Loss: 0.050 Vali Loss: 0.956 Vali Acc: 0.533 Test Loss: 0.956 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 18371
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4379360675811768
Epoch: 1, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.311 Vali Acc: 0.200 Test Loss: 1.311 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.946382999420166
Epoch: 2, Steps: 1 | Train Loss: 1.376 Vali Loss: 1.306 Vali Acc: 0.200 Test Loss: 1.306 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.9174509048461914
Epoch: 3, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.300 Vali Acc: 0.133 Test Loss: 1.300 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8731527328491211
Epoch: 4, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.295 Vali Acc: 0.133 Test Loss: 1.295 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.933621883392334
Epoch: 5, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.290 Vali Acc: 0.133 Test Loss: 1.290 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9861149787902832
Epoch: 6, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.287 Vali Acc: 0.133 Test Loss: 1.287 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.318213939666748
Epoch: 7, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.283 Vali Acc: 0.133 Test Loss: 1.283 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0518627166748047
Epoch: 8, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.279 Vali Acc: 0.133 Test Loss: 1.279 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9199244976043701
Epoch: 9, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.275 Vali Acc: 0.133 Test Loss: 1.275 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3680665493011475
Epoch: 10, Steps: 1 | Train Loss: 1.342 Vali Loss: 1.271 Vali Acc: 0.133 Test Loss: 1.271 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0055599212646484
Epoch: 11, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.268 Vali Acc: 0.067 Test Loss: 1.268 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9390778541564941
Epoch: 12, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.264 Vali Acc: 0.067 Test Loss: 1.264 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 19795
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4714179039001465
Epoch: 1, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.941464900970459
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.9900193214416504
Epoch: 3, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.823737621307373
Epoch: 4, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.0985534191131592
Epoch: 5, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.2718775272369385
Epoch: 6, Steps: 1 | Train Loss: 1.319 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.8419816493988037
Epoch: 7, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 1.0947017669677734
Epoch: 8, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 1.277057409286499
Epoch: 9, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.8468880653381348
Epoch: 10, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.8420593738555908
Epoch: 11, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 1.380202054977417
Epoch: 12, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 1.1294846534729004
Epoch: 13, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.305837631225586
Epoch: 14, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 1.1259040832519531
Epoch: 15, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 1.1229350566864014
Epoch: 16, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 1.265580654144287
Epoch: 17, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 1.186128854751587
Epoch: 18, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 1.3212714195251465
Epoch: 19, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 1.1504700183868408
Epoch: 20, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 1.1366145610809326
Epoch: 21, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 22 cost time: 1.1537129878997803
Epoch: 22, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 23 cost time: 1.1732947826385498
Epoch: 23, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 1.0975804328918457
Epoch: 24, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 1.2767930030822754
Epoch: 25, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 26 cost time: 1.3808135986328125
Epoch: 26, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 27 cost time: 1.4510784149169922
Epoch: 27, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 28 cost time: 1.846442461013794
Epoch: 28, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 29 cost time: 1.3023350238800049
Epoch: 29, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 30 cost time: 1.8044548034667969
Epoch: 30, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 31 cost time: 1.386909008026123
Epoch: 31, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 32 cost time: 1.691014289855957
Epoch: 32, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 33 cost time: 1.4624133110046387
Epoch: 33, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.133 Vali Acc: 0.533 Test Loss: 1.133 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 34 cost time: 1.0991172790527344
Epoch: 34, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.133 Vali Acc: 0.533 Test Loss: 1.133 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 35 cost time: 0.9441134929656982
Epoch: 35, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.132 Vali Acc: 0.533 Test Loss: 1.132 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 36 cost time: 1.1809937953948975
Epoch: 36, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 37 cost time: 1.2092006206512451
Epoch: 37, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 38 cost time: 1.055487871170044
Epoch: 38, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 39 cost time: 1.093559980392456
Epoch: 39, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 40 cost time: 1.4237852096557617
Epoch: 40, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 41 cost time: 1.395850419998169
Epoch: 41, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 42 cost time: 1.2429955005645752
Epoch: 42, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9815375804901123
Epoch: 43, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.6926600933074951
Epoch: 44, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1267006397247314
Epoch: 45, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.4071662425994873
Epoch: 46, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.131 Vali Acc: 0.600 Test Loss: 1.131 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 47 cost time: 1.1975059509277344
Epoch: 47, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.131 Vali Acc: 0.600 Test Loss: 1.131 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2502739429473877
Epoch: 48, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.132 Vali Acc: 0.600 Test Loss: 1.132 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3955886363983154
Epoch: 49, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.132 Vali Acc: 0.600 Test Loss: 1.132 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2302618026733398
Epoch: 50, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.133 Vali Acc: 0.600 Test Loss: 1.133 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.6773993968963623
Epoch: 51, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.133 Vali Acc: 0.600 Test Loss: 1.133 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.2084567546844482
Epoch: 52, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.133 Vali Acc: 0.600 Test Loss: 1.133 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.0188825130462646
Epoch: 53, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.133 Vali Acc: 0.600 Test Loss: 1.133 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.4479906558990479
Epoch: 54, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.134 Vali Acc: 0.600 Test Loss: 1.134 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.3693671226501465
Epoch: 55, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.133 Vali Acc: 0.600 Test Loss: 1.133 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.1414239406585693
Epoch: 56, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.134 Vali Acc: 0.600 Test Loss: 1.134 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el3_dm16_nh4_df64_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 21219
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.809196949005127
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.9553425312042236
Epoch: 2, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.1044235229492188
Epoch: 3, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.8800129890441895
Epoch: 4, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 1.1668384075164795
Epoch: 5, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.07423734664917
Epoch: 6, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1275255680084229
Epoch: 7, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1783170700073242
Epoch: 8, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3650145530700684
Epoch: 9, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0558478832244873
Epoch: 10, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2591323852539062
Epoch: 11, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 1.3533811569213867
Epoch: 12, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2029738426208496
Epoch: 13, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8950309753417969
Epoch: 14, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4484121799468994
Epoch: 15, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3136959075927734
Epoch: 16, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3823888301849365
Epoch: 17, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0600221157073975
Epoch: 18, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9465017318725586
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1138935089111328
Epoch: 20, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0992088317871094
Epoch: 21, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.318 Vali Acc: 0.333 Test Loss: 1.318 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 393091
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.372843027114868
Epoch: 1, Steps: 1 | Train Loss: 1.363 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.9724135398864746
Epoch: 2, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8272581100463867
Epoch: 3, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0093891620635986
Epoch: 4, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.230386734008789
Epoch: 5, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9417595863342285
Epoch: 6, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0897107124328613
Epoch: 7, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9958209991455078
Epoch: 8, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.9014430046081543
Epoch: 9, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 1.5313200950622559
Epoch: 10, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.9562118053436279
Epoch: 11, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 1.1956567764282227
Epoch: 12, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.1185898780822754
Epoch: 13, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.7453663349151611
Epoch: 14, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.8443968296051025
Epoch: 15, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 16 cost time: 0.816399335861206
Epoch: 16, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.138 Vali Acc: 0.533 Test Loss: 1.138 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0119519233703613
Epoch: 17, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.145 Vali Acc: 0.533 Test Loss: 1.145 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.145756721496582
Epoch: 18, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.151 Vali Acc: 0.533 Test Loss: 1.151 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9964725971221924
Epoch: 19, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1044869422912598
Epoch: 20, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0223283767700195
Epoch: 21, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4368281364440918
Epoch: 22, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2979614734649658
Epoch: 23, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9956164360046387
Epoch: 24, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8616650104522705
Epoch: 25, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 341123
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5278165340423584
Epoch: 1, Steps: 1 | Train Loss: 1.374 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.1703517436981201
Epoch: 2, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.8911468982696533
Epoch: 3, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.8863730430603027
Epoch: 4, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 1.0635621547698975
Epoch: 5, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.9196164608001709
Epoch: 6, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.857013463973999
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 1.019606113433838
Epoch: 8, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.7435665130615234
Epoch: 9, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 1.1413822174072266
Epoch: 10, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 1.170762538909912
Epoch: 11, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.9433584213256836
Epoch: 12, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 1.2830572128295898
Epoch: 13, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 1.1464073657989502
Epoch: 14, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 1.0148327350616455
Epoch: 15, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.9736745357513428
Epoch: 16, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0442984104156494
Epoch: 17, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.8542377948760986
Epoch: 18, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.173987627029419
Epoch: 19, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0115511417388916
Epoch: 20, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.076 Vali Acc: 0.600 Test Loss: 1.076 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2278180122375488
Epoch: 21, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9770429134368896
Epoch: 22, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.374356985092163
Epoch: 23, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7527918815612793
Epoch: 24, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2215759754180908
Epoch: 25, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.09676194190979
Epoch: 26, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.120 Vali Acc: 0.533 Test Loss: 1.120 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0358343124389648
Epoch: 27, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 329219
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.526458263397217
Epoch: 1, Steps: 1 | Train Loss: 1.344 Vali Loss: 1.282 Vali Acc: 0.333 Test Loss: 1.282 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.2126014232635498
Epoch: 2, Steps: 1 | Train Loss: 1.373 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.075273036956787
Epoch: 3, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1451354026794434
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0582714080810547
Epoch: 5, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0736701488494873
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1600382328033447
Epoch: 7, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8732161521911621
Epoch: 8, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 1.301905632019043
Epoch: 9, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5025668144226074
Epoch: 10, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1322715282440186
Epoch: 11, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1857423782348633
Epoch: 12, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 0.9110062122344971
Epoch: 13, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.8023710250854492
Epoch: 14, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.9284288883209229
Epoch: 15, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 1.203624963760376
Epoch: 16, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 1.0463781356811523
Epoch: 17, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 18 cost time: 1.0690879821777344
Epoch: 18, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.038 Vali Acc: 0.333 Test Loss: 1.038 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0589814186096191
Epoch: 19, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 20 cost time: 0.9324386119842529
Epoch: 20, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 21 cost time: 0.6640100479125977
Epoch: 21, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 1.0408031940460205
Epoch: 22, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.8602936267852783
Epoch: 23, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 1.096299171447754
Epoch: 24, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 1.0892388820648193
Epoch: 25, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2355749607086182
Epoch: 26, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0587308406829834
Epoch: 27, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0040764808654785
Epoch: 28, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2674641609191895
Epoch: 29, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4297382831573486
Epoch: 30, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6854774951934814
Epoch: 31, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1448304653167725
Epoch: 32, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.3490045070648193
Epoch: 33, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4270522594451904
Epoch: 34, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 327939
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.503675937652588
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.232 Vali Acc: 0.133 Test Loss: 1.232 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.7568767070770264
Epoch: 2, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.232 Vali Acc: 0.133 Test Loss: 1.232 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 1.0859739780426025
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.232 Vali Acc: 0.200 Test Loss: 1.232 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.880352258682251
Epoch: 4, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.083122730255127
Epoch: 5, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9228298664093018
Epoch: 6, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1517415046691895
Epoch: 7, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6745913028717041
Epoch: 8, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1535429954528809
Epoch: 9, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7736172676086426
Epoch: 10, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1149086952209473
Epoch: 11, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.230 Vali Acc: 0.200 Test Loss: 1.230 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 12 cost time: 1.2144434452056885
Epoch: 12, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 13 cost time: 1.0999631881713867
Epoch: 13, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 14 cost time: 0.9522359371185303
Epoch: 14, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.9121649265289307
Epoch: 15, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.7418944835662842
Epoch: 16, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.9199237823486328
Epoch: 17, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 0.7538101673126221
Epoch: 18, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 0.6973934173583984
Epoch: 19, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 0.7071270942687988
Epoch: 20, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 0.721137523651123
Epoch: 21, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 22 cost time: 0.8269820213317871
Epoch: 22, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 23 cost time: 0.7945852279663086
Epoch: 23, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 24 cost time: 0.7892143726348877
Epoch: 24, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 25 cost time: 0.9118962287902832
Epoch: 25, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 26 cost time: 1.135892391204834
Epoch: 26, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8199667930603027
Epoch: 27, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.194 Vali Acc: 0.467 Test Loss: 1.194 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 28 cost time: 0.8872332572937012
Epoch: 28, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.197 Vali Acc: 0.467 Test Loss: 1.197 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9983623027801514
Epoch: 29, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.199 Vali Acc: 0.467 Test Loss: 1.199 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9891519546508789
Epoch: 30, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.202 Vali Acc: 0.467 Test Loss: 1.202 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9621384143829346
Epoch: 31, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.204 Vali Acc: 0.467 Test Loss: 1.204 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9673638343811035
Epoch: 32, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0755348205566406
Epoch: 33, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.211 Vali Acc: 0.467 Test Loss: 1.211 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8053934574127197
Epoch: 34, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.213 Vali Acc: 0.467 Test Loss: 1.213 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7256169319152832
Epoch: 35, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.216 Vali Acc: 0.467 Test Loss: 1.216 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8097217082977295
Epoch: 36, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.219 Vali Acc: 0.467 Test Loss: 1.219 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9945237636566162
Epoch: 37, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.222 Vali Acc: 0.467 Test Loss: 1.222 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 333187
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.458477258682251
Epoch: 1, Steps: 1 | Train Loss: 1.370 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.8650455474853516
Epoch: 2, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.8151464462280273
Epoch: 3, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.86952805519104
Epoch: 4, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8948979377746582
Epoch: 5, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.9795396327972412
Epoch: 6, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.6358401775360107
Epoch: 7, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 1.0944499969482422
Epoch: 8, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.9456541538238525
Epoch: 9, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8099067211151123
Epoch: 10, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8750395774841309
Epoch: 11, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1685254573822021
Epoch: 12, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7691757678985596
Epoch: 13, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.0134520530700684
Epoch: 14, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.8119008541107178
Epoch: 15, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0065319538116455
Epoch: 16, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8483788967132568
Epoch: 17, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0107805728912354
Epoch: 18, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9313695430755615
Epoch: 19, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8652007579803467
Epoch: 20, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8406667709350586
Epoch: 21, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8745591640472412
Epoch: 22, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7629508972167969
Epoch: 23, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8816485404968262
Epoch: 24, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 344579
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8623039722442627
Epoch: 1, Steps: 1 | Train Loss: 1.629 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9140095710754395
Epoch: 2, Steps: 1 | Train Loss: 1.555 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7585866451263428
Epoch: 3, Steps: 1 | Train Loss: 1.305 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8784441947937012
Epoch: 4, Steps: 1 | Train Loss: 1.344 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.837822437286377
Epoch: 5, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.8508687019348145
Epoch: 6, Steps: 1 | Train Loss: 1.462 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.9200303554534912
Epoch: 7, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 1.2193524837493896
Epoch: 8, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 1.1490058898925781
Epoch: 9, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.021367073059082
Epoch: 10, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9772439002990723
Epoch: 11, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8583903312683105
Epoch: 12, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.908534049987793
Epoch: 13, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0229902267456055
Epoch: 14, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1762793064117432
Epoch: 15, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8830125331878662
Epoch: 16, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1509068012237549
Epoch: 17, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0460598468780518
Epoch: 18, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 1.1034786701202393
Epoch: 19, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 1.2058112621307373
Epoch: 20, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.80818772315979
Epoch: 21, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0276567935943604
Epoch: 22, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0541884899139404
Epoch: 23, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1835761070251465
Epoch: 24, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1085078716278076
Epoch: 25, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9784893989562988
Epoch: 26, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0391480922698975
Epoch: 27, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1846051216125488
Epoch: 28, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9590520858764648
Epoch: 29, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7982230186462402
Epoch: 30, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df256_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 355971
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.051761865615845
Epoch: 1, Steps: 1 | Train Loss: 1.401 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.9246659278869629
Epoch: 2, Steps: 1 | Train Loss: 1.336 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.9960007667541504
Epoch: 3, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.3431541919708252
Epoch: 4, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.890526294708252
Epoch: 5, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.9422285556793213
Epoch: 6, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1951425075531006
Epoch: 7, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9434318542480469
Epoch: 8, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.272815465927124
Epoch: 9, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0318830013275146
Epoch: 10, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.9621899127960205
Epoch: 11, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.9516716003417969
Epoch: 12, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.052 Vali Acc: 0.200 Test Loss: 1.052 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9924287796020508
Epoch: 13, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.035 Vali Acc: 0.200 Test Loss: 1.035 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9439713954925537
Epoch: 14, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.031 Vali Acc: 0.333 Test Loss: 1.031 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.773188591003418
Epoch: 15, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 1.0687534809112549
Epoch: 16, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.158940076828003
Epoch: 17, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.138331651687622
Epoch: 18, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1482667922973633
Epoch: 19, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.049034833908081
Epoch: 20, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.259 Vali Acc: 0.400 Test Loss: 1.259 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0339038372039795
Epoch: 21, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.292 Vali Acc: 0.400 Test Loss: 1.292 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.194307804107666
Epoch: 22, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8707802295684814
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9864485263824463
Epoch: 24, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.372 Vali Acc: 0.400 Test Loss: 1.372 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9844949245452881
Epoch: 25, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.394 Vali Acc: 0.400 Test Loss: 1.394 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 327299
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.278935670852661
Epoch: 1, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.3691606521606445
Epoch: 2, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.0646145343780518
Epoch: 3, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.3183491230010986
Epoch: 4, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.3410844802856445
Epoch: 5, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.8709580898284912
Epoch: 6, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.9503014087677002
Epoch: 7, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7343096733093262
Epoch: 8, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.9853494167327881
Epoch: 9, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.8851697444915771
Epoch: 10, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.9403517246246338
Epoch: 11, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.890233039855957
Epoch: 12, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.962235689163208
Epoch: 13, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.2856628894805908
Epoch: 14, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.117 Vali Acc: 0.533 Test Loss: 1.117 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 1.0196762084960938
Epoch: 15, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2157783508300781
Epoch: 16, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0676398277282715
Epoch: 17, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0981500148773193
Epoch: 18, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9371984004974365
Epoch: 19, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1309237480163574
Epoch: 20, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.848494291305542
Epoch: 21, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9436242580413818
Epoch: 22, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.175 Vali Acc: 0.467 Test Loss: 1.175 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.960578441619873
Epoch: 23, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.189 Vali Acc: 0.467 Test Loss: 1.189 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8046367168426514
Epoch: 24, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.203 Vali Acc: 0.467 Test Loss: 1.203 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 275331
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3893883228302
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6691887378692627
Epoch: 2, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8443424701690674
Epoch: 3, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7679200172424316
Epoch: 4, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8585495948791504
Epoch: 5, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.9867000579833984
Epoch: 6, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.8561344146728516
Epoch: 7, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.8342483043670654
Epoch: 8, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.7362182140350342
Epoch: 9, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 1.0251708030700684
Epoch: 10, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8482863903045654
Epoch: 11, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.8281474113464355
Epoch: 12, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.9698858261108398
Epoch: 13, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.7511191368103027
Epoch: 14, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.052393913269043
Epoch: 15, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 1.0160562992095947
Epoch: 16, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.971149206161499
Epoch: 17, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.9186937808990479
Epoch: 18, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.9658560752868652
Epoch: 19, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.8155918121337891
Epoch: 20, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7834804058074951
Epoch: 21, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8017876148223877
Epoch: 22, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8865158557891846
Epoch: 23, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9150285720825195
Epoch: 24, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0345475673675537
Epoch: 25, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8239035606384277
Epoch: 26, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1073856353759766
Epoch: 27, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2976090908050537
Epoch: 28, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0379090309143066
Epoch: 29, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 263427
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4353082180023193
Epoch: 1, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.260 Vali Acc: 0.200 Test Loss: 1.260 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 1.00882887840271
Epoch: 2, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 1.31667160987854
Epoch: 3, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.9962413311004639
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
Validation loss decreased (-0.266654 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.7680132389068604
Epoch: 5, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.241 Vali Acc: 0.467 Test Loss: 1.241 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 6 cost time: 0.9835748672485352
Epoch: 6, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.236 Vali Acc: 0.467 Test Loss: 1.236 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 7 cost time: 0.94563889503479
Epoch: 7, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.232 Vali Acc: 0.533 Test Loss: 1.232 Test Acc: 0.533
Validation loss decreased (-0.466654 --> -0.533321).  Saving model ...
Epoch: 8 cost time: 1.031491994857788
Epoch: 8, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.227 Vali Acc: 0.533 Test Loss: 1.227 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 9 cost time: 1.2526843547821045
Epoch: 9, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.222 Vali Acc: 0.533 Test Loss: 1.222 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 10 cost time: 0.9289107322692871
Epoch: 10, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.218 Vali Acc: 0.533 Test Loss: 1.218 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 11 cost time: 0.8012375831604004
Epoch: 11, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.214 Vali Acc: 0.533 Test Loss: 1.214 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 12 cost time: 0.8661143779754639
Epoch: 12, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.209 Vali Acc: 0.533 Test Loss: 1.209 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 13 cost time: 1.0907518863677979
Epoch: 13, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.201 Vali Acc: 0.533 Test Loss: 1.201 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 14 cost time: 0.816852331161499
Epoch: 14, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.191 Vali Acc: 0.533 Test Loss: 1.191 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 15 cost time: 0.8672938346862793
Epoch: 15, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.181 Vali Acc: 0.533 Test Loss: 1.181 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533322).  Saving model ...
Epoch: 16 cost time: 1.0603196620941162
Epoch: 16, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.170 Vali Acc: 0.533 Test Loss: 1.170 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 1.1093482971191406
Epoch: 17, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0424575805664062
Epoch: 18, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7576444149017334
Epoch: 19, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9939653873443604
Epoch: 20, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7974498271942139
Epoch: 21, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.160 Vali Acc: 0.533 Test Loss: 1.160 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 22 cost time: 1.3012337684631348
Epoch: 22, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.163 Vali Acc: 0.667 Test Loss: 1.163 Test Acc: 0.667
Validation loss decreased (-0.533322 --> -0.666655).  Saving model ...
Epoch: 23 cost time: 0.9459643363952637
Epoch: 23, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.167 Vali Acc: 0.667 Test Loss: 1.167 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.89581298828125
Epoch: 24, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.173 Vali Acc: 0.667 Test Loss: 1.173 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.346381425857544
Epoch: 25, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.178 Vali Acc: 0.667 Test Loss: 1.178 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9621939659118652
Epoch: 26, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.183 Vali Acc: 0.667 Test Loss: 1.183 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8950660228729248
Epoch: 27, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.188 Vali Acc: 0.667 Test Loss: 1.188 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0282208919525146
Epoch: 28, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.193 Vali Acc: 0.667 Test Loss: 1.193 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9233143329620361
Epoch: 29, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.196 Vali Acc: 0.667 Test Loss: 1.196 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9392683506011963
Epoch: 30, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1389408111572266
Epoch: 31, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.204 Vali Acc: 0.600 Test Loss: 1.204 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.905311107635498
Epoch: 32, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.207 Vali Acc: 0.600 Test Loss: 1.207 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 262147
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.6058335304260254
Epoch: 1, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.0613257884979248
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.379223346710205
Epoch: 3, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.1304149627685547
Epoch: 4, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 1.075256586074829
Epoch: 5, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 1.0548076629638672
Epoch: 6, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.9004008769989014
Epoch: 7, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.7831087112426758
Epoch: 8, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.9976909160614014
Epoch: 9, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 1.1158223152160645
Epoch: 10, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.192 Vali Acc: 0.467 Test Loss: 1.192 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.8460636138916016
Epoch: 11, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3172757625579834
Epoch: 12, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.182 Vali Acc: 0.467 Test Loss: 1.182 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.9157631397247314
Epoch: 13, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.177 Vali Acc: 0.467 Test Loss: 1.177 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 1.156191349029541
Epoch: 14, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2611777782440186
Epoch: 15, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2962348461151123
Epoch: 16, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.24257230758667
Epoch: 17, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6083672046661377
Epoch: 18, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2677407264709473
Epoch: 19, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2630014419555664
Epoch: 20, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8744301795959473
Epoch: 21, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.011324167251587
Epoch: 22, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.011162281036377
Epoch: 23, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 267395
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.331514835357666
Epoch: 1, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 1.0789833068847656
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.8670690059661865
Epoch: 3, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.9385108947753906
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 1.0784730911254883
Epoch: 5, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 1.1100807189941406
Epoch: 6, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.020 Vali Acc: 0.600 Test Loss: 1.020 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 1.3169739246368408
Epoch: 7, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.014 Vali Acc: 0.600 Test Loss: 1.014 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 1.1122403144836426
Epoch: 8, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.06333589553833
Epoch: 9, Steps: 1 | Train Loss: 0.774 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9472508430480957
Epoch: 10, Steps: 1 | Train Loss: 0.581 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0680036544799805
Epoch: 11, Steps: 1 | Train Loss: 0.566 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2804856300354004
Epoch: 12, Steps: 1 | Train Loss: 0.567 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0103034973144531
Epoch: 13, Steps: 1 | Train Loss: 0.458 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9987249374389648
Epoch: 14, Steps: 1 | Train Loss: 0.425 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9998879432678223
Epoch: 15, Steps: 1 | Train Loss: 0.364 Vali Loss: 0.961 Vali Acc: 0.533 Test Loss: 0.961 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9057662487030029
Epoch: 16, Steps: 1 | Train Loss: 0.270 Vali Loss: 0.956 Vali Acc: 0.533 Test Loss: 0.956 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1244101524353027
Epoch: 17, Steps: 1 | Train Loss: 0.326 Vali Loss: 0.950 Vali Acc: 0.533 Test Loss: 0.950 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 278787
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.045610189437866
Epoch: 1, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.839045524597168
Epoch: 2, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.228 Vali Acc: 0.467 Test Loss: 1.228 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 3 cost time: 0.9606447219848633
Epoch: 3, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.226 Vali Acc: 0.467 Test Loss: 1.226 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 4 cost time: 0.7594847679138184
Epoch: 4, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.225 Vali Acc: 0.467 Test Loss: 1.225 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 5 cost time: 1.000152826309204
Epoch: 5, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9444007873535156
Epoch: 6, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.851001501083374
Epoch: 7, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.218 Vali Acc: 0.400 Test Loss: 1.218 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0430989265441895
Epoch: 8, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8943281173706055
Epoch: 9, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.93314528465271
Epoch: 10, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9537887573242188
Epoch: 11, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8921642303466797
Epoch: 12, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0820720195770264
Epoch: 13, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3621253967285156
Epoch: 14, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df128_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 290179
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.900301218032837
Epoch: 1, Steps: 1 | Train Loss: 1.606 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.7538566589355469
Epoch: 2, Steps: 1 | Train Loss: 1.257 Vali Loss: 1.258 Vali Acc: 0.200 Test Loss: 1.258 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9102895259857178
Epoch: 3, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.243 Vali Acc: 0.200 Test Loss: 1.243 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8559541702270508
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0053770542144775
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2295196056365967
Epoch: 6, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 1.4490375518798828
Epoch: 7, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 1.155010461807251
Epoch: 8, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.181 Vali Acc: 0.533 Test Loss: 1.181 Test Acc: 0.533
Validation loss decreased (-0.266655 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 1.1180901527404785
Epoch: 9, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.064711093902588
Epoch: 10, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2163150310516357
Epoch: 11, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1651456356048584
Epoch: 12, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5185856819152832
Epoch: 13, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 1.2711150646209717
Epoch: 14, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0941267013549805
Epoch: 15, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0424737930297852
Epoch: 16, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0506746768951416
Epoch: 17, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9815471172332764
Epoch: 18, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2218916416168213
Epoch: 19, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1101911067962646
Epoch: 20, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.219 Vali Acc: 0.467 Test Loss: 1.219 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3173174858093262
Epoch: 21, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.249 Vali Acc: 0.467 Test Loss: 1.249 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4396967887878418
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.280 Vali Acc: 0.467 Test Loss: 1.280 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6184823513031006
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.312 Vali Acc: 0.467 Test Loss: 1.312 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 294403
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.228588342666626
Epoch: 1, Steps: 1 | Train Loss: 1.408 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 1.1099896430969238
Epoch: 2, Steps: 1 | Train Loss: 1.264 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 1.1756105422973633
Epoch: 3, Steps: 1 | Train Loss: 1.276 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.0905539989471436
Epoch: 4, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.8489570617675781
Epoch: 5, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.900348424911499
Epoch: 6, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9793095588684082
Epoch: 7, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9680297374725342
Epoch: 8, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.04343581199646
Epoch: 9, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.213996171951294
Epoch: 10, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9211797714233398
Epoch: 11, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0454604625701904
Epoch: 12, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0700671672821045
Epoch: 13, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2294886112213135
Epoch: 14, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.7293694019317627
Epoch: 15, Steps: 1 | Train Loss: 0.128 Vali Loss: 0.978 Vali Acc: 0.600 Test Loss: 0.978 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 1.135091781616211
Epoch: 16, Steps: 1 | Train Loss: 0.096 Vali Loss: 0.963 Vali Acc: 0.533 Test Loss: 0.963 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2268309593200684
Epoch: 17, Steps: 1 | Train Loss: 0.072 Vali Loss: 0.958 Vali Acc: 0.667 Test Loss: 0.958 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 18 cost time: 0.7280540466308594
Epoch: 18, Steps: 1 | Train Loss: 0.042 Vali Loss: 0.958 Vali Acc: 0.667 Test Loss: 0.958 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8213794231414795
Epoch: 19, Steps: 1 | Train Loss: 0.038 Vali Loss: 0.963 Vali Acc: 0.600 Test Loss: 0.963 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9278743267059326
Epoch: 20, Steps: 1 | Train Loss: 0.033 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7837755680084229
Epoch: 21, Steps: 1 | Train Loss: 0.022 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7841746807098389
Epoch: 22, Steps: 1 | Train Loss: 0.019 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9929389953613281
Epoch: 23, Steps: 1 | Train Loss: 0.011 Vali Loss: 0.993 Vali Acc: 0.533 Test Loss: 0.993 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.091339111328125
Epoch: 24, Steps: 1 | Train Loss: 0.009 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3351209163665771
Epoch: 25, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.050811767578125
Epoch: 26, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4066269397735596
Epoch: 27, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 242435
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1370959281921387
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.0347986221313477
Epoch: 2, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9789137840270996
Epoch: 3, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.0739667415618896
Epoch: 4, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.2650132179260254
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.0674378871917725
Epoch: 6, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.0218799114227295
Epoch: 7, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.8155605792999268
Epoch: 8, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.9148211479187012
Epoch: 9, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.8490984439849854
Epoch: 10, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 1.3031342029571533
Epoch: 11, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.9515283107757568
Epoch: 12, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.6791248321533203
Epoch: 13, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.024 Vali Acc: 0.667 Test Loss: 1.024 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 14 cost time: 0.6999988555908203
Epoch: 14, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.014 Vali Acc: 0.667 Test Loss: 1.014 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 15 cost time: 0.8097550868988037
Epoch: 15, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.006 Vali Acc: 0.667 Test Loss: 1.006 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 16 cost time: 0.7815275192260742
Epoch: 16, Steps: 1 | Train Loss: 0.184 Vali Loss: 0.999 Vali Acc: 0.667 Test Loss: 0.999 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 17 cost time: 1.034451961517334
Epoch: 17, Steps: 1 | Train Loss: 0.156 Vali Loss: 0.995 Vali Acc: 0.667 Test Loss: 0.995 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 18 cost time: 0.898449182510376
Epoch: 18, Steps: 1 | Train Loss: 0.104 Vali Loss: 0.996 Vali Acc: 0.533 Test Loss: 0.996 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9700727462768555
Epoch: 19, Steps: 1 | Train Loss: 0.077 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1088533401489258
Epoch: 20, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1132628917694092
Epoch: 21, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8410632610321045
Epoch: 22, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0326244831085205
Epoch: 23, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.70998215675354
Epoch: 24, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8401613235473633
Epoch: 25, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7692677974700928
Epoch: 26, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8545351028442383
Epoch: 27, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 230531
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.505876064300537
Epoch: 1, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.007047176361084
Epoch: 2, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.952415943145752
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0506699085235596
Epoch: 4, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7859432697296143
Epoch: 5, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9201476573944092
Epoch: 6, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.8581960201263428
Epoch: 7, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.9438714981079102
Epoch: 8, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 1.075758934020996
Epoch: 9, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 1.303591012954712
Epoch: 10, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.999685525894165
Epoch: 11, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0094118118286133
Epoch: 12, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 1.0698802471160889
Epoch: 13, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.8047807216644287
Epoch: 14, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 1.1395704746246338
Epoch: 15, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 0.9126393795013428
Epoch: 16, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.9096667766571045
Epoch: 17, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.1232664585113525
Epoch: 18, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.7740635871887207
Epoch: 19, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 1.263951063156128
Epoch: 20, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.868476390838623
Epoch: 21, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.8848381042480469
Epoch: 22, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.104341983795166
Epoch: 23, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2249877452850342
Epoch: 24, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9857735633850098
Epoch: 25, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9267265796661377
Epoch: 26, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.860175371170044
Epoch: 27, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.917048454284668
Epoch: 28, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8842997550964355
Epoch: 29, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1641521453857422
Epoch: 30, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0786128044128418
Epoch: 31, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 229251
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4350969791412354
Epoch: 1, Steps: 1 | Train Loss: 1.327 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.2812252044677734
Epoch: 2, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.3023185729980469
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8367066383361816
Epoch: 4, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.207432508468628
Epoch: 5, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9165534973144531
Epoch: 6, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0954463481903076
Epoch: 7, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.088876724243164
Epoch: 8, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.017298698425293
Epoch: 9, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9418351650238037
Epoch: 10, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9601576328277588
Epoch: 11, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1682276725769043
Epoch: 12, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 234499
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.38236403465271
Epoch: 1, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7903940677642822
Epoch: 2, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.9282546043395996
Epoch: 3, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0551421642303467
Epoch: 4, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3206002712249756
Epoch: 5, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8949170112609863
Epoch: 6, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0623533725738525
Epoch: 7, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9983034133911133
Epoch: 8, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8376269340515137
Epoch: 9, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7064909934997559
Epoch: 10, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.973503589630127
Epoch: 11, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0773637294769287
Epoch: 12, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 245891
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3866491317749023
Epoch: 1, Steps: 1 | Train Loss: 1.337 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6961259841918945
Epoch: 2, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9053924083709717
Epoch: 3, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7749764919281006
Epoch: 4, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9874284267425537
Epoch: 5, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7483880519866943
Epoch: 6, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.8118937015533447
Epoch: 7, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 1.1126048564910889
Epoch: 8, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.159144639968872
Epoch: 9, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.8533647060394287
Epoch: 10, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.7868192195892334
Epoch: 11, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 1.253722906112671
Epoch: 12, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.2844290733337402
Epoch: 13, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 1.0862891674041748
Epoch: 14, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.9452152252197266
Epoch: 15, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 1.0346641540527344
Epoch: 16, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7714972496032715
Epoch: 17, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.106090784072876
Epoch: 18, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8462433815002441
Epoch: 19, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8093321323394775
Epoch: 20, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8610405921936035
Epoch: 21, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 1.0468034744262695
Epoch: 22, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 1.005298137664795
Epoch: 23, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.910132646560669
Epoch: 24, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0569941997528076
Epoch: 25, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2370076179504395
Epoch: 26, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3635187149047852
Epoch: 27, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8921504020690918
Epoch: 28, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2418038845062256
Epoch: 29, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.868985652923584
Epoch: 30, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1206471920013428
Epoch: 31, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9790463447570801
Epoch: 32, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9655113220214844
Epoch: 33, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm128_nh16_df64_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 257283
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.304868459701538
Epoch: 1, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.9112677574157715
Epoch: 2, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.9850332736968994
Epoch: 3, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.8445546627044678
Epoch: 4, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.125943899154663
Epoch: 5, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.209 Vali Acc: 0.200 Test Loss: 1.209 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8791851997375488
Epoch: 6, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0308995246887207
Epoch: 7, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8961403369903564
Epoch: 8, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8530745506286621
Epoch: 9, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7634680271148682
Epoch: 10, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9409940242767334
Epoch: 11, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.7924520969390869
Epoch: 12, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.8386135101318359
Epoch: 13, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.7358436584472656
Epoch: 14, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.762310266494751
Epoch: 15, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 1.0545861721038818
Epoch: 16, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6976802349090576
Epoch: 17, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7347204685211182
Epoch: 18, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9752068519592285
Epoch: 19, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.894397497177124
Epoch: 20, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.8086369037628174
Epoch: 21, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 1.1121721267700195
Epoch: 22, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0141966342926025
Epoch: 23, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 1.045506477355957
Epoch: 24, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.044119119644165
Epoch: 25, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8492574691772461
Epoch: 26, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 27 cost time: 0.9836981296539307
Epoch: 27, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9835786819458008
Epoch: 28, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.144 Vali Acc: 0.533 Test Loss: 1.144 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.105454683303833
Epoch: 29, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.164 Vali Acc: 0.533 Test Loss: 1.164 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8222098350524902
Epoch: 30, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9934036731719971
Epoch: 31, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.203 Vali Acc: 0.533 Test Loss: 1.203 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.02587890625
Epoch: 32, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.222 Vali Acc: 0.533 Test Loss: 1.222 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1982033252716064
Epoch: 33, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.240 Vali Acc: 0.533 Test Loss: 1.240 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0000693798065186
Epoch: 34, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.258 Vali Acc: 0.533 Test Loss: 1.258 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9808235168457031
Epoch: 35, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.274 Vali Acc: 0.533 Test Loss: 1.274 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9165904521942139
Epoch: 36, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.289 Vali Acc: 0.533 Test Loss: 1.289 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 164035
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.683326482772827
Epoch: 1, Steps: 1 | Train Loss: 1.437 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.9685311317443848
Epoch: 2, Steps: 1 | Train Loss: 1.355 Vali Loss: 1.187 Vali Acc: 0.467 Test Loss: 1.187 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.9794139862060547
Epoch: 3, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.180 Vali Acc: 0.467 Test Loss: 1.180 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.9911704063415527
Epoch: 4, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0342597961425781
Epoch: 5, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8570466041564941
Epoch: 6, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.89835524559021
Epoch: 7, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9785830974578857
Epoch: 8, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1694562435150146
Epoch: 9, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8534998893737793
Epoch: 10, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3284497261047363
Epoch: 11, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0513708591461182
Epoch: 12, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0572571754455566
Epoch: 13, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 138051
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.24185848236084
Epoch: 1, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.364 Vali Acc: 0.267 Test Loss: 1.364 Test Acc: 0.267
Validation loss decreased (inf --> -0.266653).  Saving model ...
Epoch: 2 cost time: 0.7305130958557129
Epoch: 2, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.339 Vali Acc: 0.267 Test Loss: 1.339 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 3 cost time: 0.83036208152771
Epoch: 3, Steps: 1 | Train Loss: 1.325 Vali Loss: 1.317 Vali Acc: 0.267 Test Loss: 1.317 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 4 cost time: 1.024604320526123
Epoch: 4, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.9090454578399658
Epoch: 5, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.9498279094696045
Epoch: 6, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.269 Vali Acc: 0.200 Test Loss: 1.269 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.104050874710083
Epoch: 7, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8065447807312012
Epoch: 8, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.012406349182129
Epoch: 9, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.8812010288238525
Epoch: 10, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.930633544921875
Epoch: 11, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 1.0696465969085693
Epoch: 12, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.9345736503601074
Epoch: 13, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 1.0815448760986328
Epoch: 14, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.193 Vali Acc: 0.467 Test Loss: 1.193 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 1.0051970481872559
Epoch: 15, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.190 Vali Acc: 0.467 Test Loss: 1.190 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.7431759834289551
Epoch: 16, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.188 Vali Acc: 0.467 Test Loss: 1.188 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 17 cost time: 0.8254995346069336
Epoch: 17, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.187 Vali Acc: 0.467 Test Loss: 1.187 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 0.9028503894805908
Epoch: 18, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7394626140594482
Epoch: 19, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 20 cost time: 1.1782612800598145
Epoch: 20, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 21 cost time: 1.2741057872772217
Epoch: 21, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.176 Vali Acc: 0.467 Test Loss: 1.176 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 22 cost time: 0.8331091403961182
Epoch: 22, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.173 Vali Acc: 0.467 Test Loss: 1.173 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 0.9944326877593994
Epoch: 23, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 24 cost time: 0.992689847946167
Epoch: 24, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 25 cost time: 1.0927786827087402
Epoch: 25, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 26 cost time: 1.1076409816741943
Epoch: 26, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 27 cost time: 1.1446034908294678
Epoch: 27, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0076212882995605
Epoch: 28, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.016571044921875
Epoch: 29, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9479248523712158
Epoch: 30, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.172 Vali Acc: 0.467 Test Loss: 1.172 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9191691875457764
Epoch: 31, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.178 Vali Acc: 0.467 Test Loss: 1.178 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.28350830078125
Epoch: 32, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9924962520599365
Epoch: 33, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.190 Vali Acc: 0.467 Test Loss: 1.190 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1232001781463623
Epoch: 34, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4222066402435303
Epoch: 35, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.203 Vali Acc: 0.467 Test Loss: 1.203 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.971473217010498
Epoch: 36, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.210 Vali Acc: 0.467 Test Loss: 1.210 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 132099
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.068007707595825
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.258 Vali Acc: 0.067 Test Loss: 1.258 Test Acc: 0.067
Validation loss decreased (inf --> -0.066654).  Saving model ...
Epoch: 2 cost time: 1.2372832298278809
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.258 Vali Acc: 0.067 Test Loss: 1.258 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2727735042572021
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.259 Vali Acc: 0.067 Test Loss: 1.259 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4413223266601562
Epoch: 4, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.260 Vali Acc: 0.067 Test Loss: 1.260 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8364229202270508
Epoch: 5, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.262 Vali Acc: 0.067 Test Loss: 1.262 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8490831851959229
Epoch: 6, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.263 Vali Acc: 0.067 Test Loss: 1.263 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7370166778564453
Epoch: 7, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.265 Vali Acc: 0.067 Test Loss: 1.265 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6803126335144043
Epoch: 8, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.266 Vali Acc: 0.067 Test Loss: 1.266 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8262038230895996
Epoch: 9, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.267 Vali Acc: 0.067 Test Loss: 1.267 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.014941930770874
Epoch: 10, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.269 Vali Acc: 0.133 Test Loss: 1.269 Test Acc: 0.133
Validation loss decreased (-0.066654 --> -0.133321).  Saving model ...
Epoch: 11 cost time: 0.6329464912414551
Epoch: 11, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.270 Vali Acc: 0.133 Test Loss: 1.270 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8885648250579834
Epoch: 12, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.271 Vali Acc: 0.133 Test Loss: 1.271 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.870098352432251
Epoch: 13, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.272 Vali Acc: 0.200 Test Loss: 1.272 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199987).  Saving model ...
Epoch: 14 cost time: 0.8698668479919434
Epoch: 14, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.274 Vali Acc: 0.200 Test Loss: 1.274 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1549084186553955
Epoch: 15, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
Validation loss decreased (-0.199987 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.9647185802459717
Epoch: 16, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.277 Vali Acc: 0.333 Test Loss: 1.277 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9833436012268066
Epoch: 17, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.279 Vali Acc: 0.333 Test Loss: 1.279 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9268531799316406
Epoch: 18, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9076476097106934
Epoch: 19, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1370124816894531
Epoch: 20, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.287 Vali Acc: 0.400 Test Loss: 1.287 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 21 cost time: 1.0978155136108398
Epoch: 21, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.291 Vali Acc: 0.400 Test Loss: 1.291 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.911292314529419
Epoch: 22, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.294 Vali Acc: 0.400 Test Loss: 1.294 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7238337993621826
Epoch: 23, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8299779891967773
Epoch: 24, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.300 Vali Acc: 0.467 Test Loss: 1.300 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466654).  Saving model ...
Epoch: 25 cost time: 1.0922062397003174
Epoch: 25, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.303 Vali Acc: 0.467 Test Loss: 1.303 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7585346698760986
Epoch: 26, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.306 Vali Acc: 0.467 Test Loss: 1.306 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0580291748046875
Epoch: 27, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.308 Vali Acc: 0.467 Test Loss: 1.308 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.821401834487915
Epoch: 28, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.311 Vali Acc: 0.467 Test Loss: 1.311 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6940295696258545
Epoch: 29, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.314 Vali Acc: 0.467 Test Loss: 1.314 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7178583145141602
Epoch: 30, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.318 Vali Acc: 0.467 Test Loss: 1.318 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7834157943725586
Epoch: 31, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.322 Vali Acc: 0.467 Test Loss: 1.322 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8008723258972168
Epoch: 32, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.326 Vali Acc: 0.467 Test Loss: 1.326 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8773312568664551
Epoch: 33, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.330 Vali Acc: 0.467 Test Loss: 1.330 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8940119743347168
Epoch: 34, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.335 Vali Acc: 0.467 Test Loss: 1.335 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 131459
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3775570392608643
Epoch: 1, Steps: 1 | Train Loss: 1.316 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7935190200805664
Epoch: 2, Steps: 1 | Train Loss: 1.361 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8265411853790283
Epoch: 3, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.9698419570922852
Epoch: 4, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.023608922958374
Epoch: 5, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.8051297664642334
Epoch: 6, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0667409896850586
Epoch: 7, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.7385923862457275
Epoch: 8, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 1.043630599975586
Epoch: 9, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.9826946258544922
Epoch: 10, Steps: 1 | Train Loss: 1.107 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.8887982368469238
Epoch: 11, Steps: 1 | Train Loss: 1.018 Vali Loss: 0.991 Vali Acc: 0.467 Test Loss: 0.991 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9512438774108887
Epoch: 12, Steps: 1 | Train Loss: 0.978 Vali Loss: 0.986 Vali Acc: 0.467 Test Loss: 0.986 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9602031707763672
Epoch: 13, Steps: 1 | Train Loss: 0.830 Vali Loss: 0.982 Vali Acc: 0.467 Test Loss: 0.982 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.95672607421875
Epoch: 14, Steps: 1 | Train Loss: 0.850 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9585771560668945
Epoch: 15, Steps: 1 | Train Loss: 0.773 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8123822212219238
Epoch: 16, Steps: 1 | Train Loss: 0.553 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9422388076782227
Epoch: 17, Steps: 1 | Train Loss: 0.625 Vali Loss: 0.966 Vali Acc: 0.600 Test Loss: 0.966 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.8863852024078369
Epoch: 18, Steps: 1 | Train Loss: 0.544 Vali Loss: 0.963 Vali Acc: 0.600 Test Loss: 0.963 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.845482587814331
Epoch: 19, Steps: 1 | Train Loss: 0.493 Vali Loss: 0.960 Vali Acc: 0.600 Test Loss: 0.960 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.8799688816070557
Epoch: 20, Steps: 1 | Train Loss: 0.360 Vali Loss: 0.959 Vali Acc: 0.600 Test Loss: 0.959 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.8591358661651611
Epoch: 21, Steps: 1 | Train Loss: 0.453 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.7369780540466309
Epoch: 22, Steps: 1 | Train Loss: 0.310 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.7435081005096436
Epoch: 23, Steps: 1 | Train Loss: 0.266 Vali Loss: 0.954 Vali Acc: 0.533 Test Loss: 0.954 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7586703300476074
Epoch: 24, Steps: 1 | Train Loss: 0.218 Vali Loss: 0.954 Vali Acc: 0.533 Test Loss: 0.954 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9520711898803711
Epoch: 25, Steps: 1 | Train Loss: 0.271 Vali Loss: 0.955 Vali Acc: 0.533 Test Loss: 0.955 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9060986042022705
Epoch: 26, Steps: 1 | Train Loss: 0.231 Vali Loss: 0.957 Vali Acc: 0.533 Test Loss: 0.957 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9114034175872803
Epoch: 27, Steps: 1 | Train Loss: 0.156 Vali Loss: 0.959 Vali Acc: 0.533 Test Loss: 0.959 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.05238676071167
Epoch: 28, Steps: 1 | Train Loss: 0.147 Vali Loss: 0.961 Vali Acc: 0.533 Test Loss: 0.961 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9510421752929688
Epoch: 29, Steps: 1 | Train Loss: 0.126 Vali Loss: 0.963 Vali Acc: 0.600 Test Loss: 0.963 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7427375316619873
Epoch: 30, Steps: 1 | Train Loss: 0.095 Vali Loss: 0.966 Vali Acc: 0.600 Test Loss: 0.966 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7813944816589355
Epoch: 31, Steps: 1 | Train Loss: 0.093 Vali Loss: 0.969 Vali Acc: 0.600 Test Loss: 0.969 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.754899263381958
Epoch: 32, Steps: 1 | Train Loss: 0.099 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 134083
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.960482358932495
Epoch: 1, Steps: 1 | Train Loss: 1.295 Vali Loss: 1.215 Vali Acc: 0.467 Test Loss: 1.215 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.8306722640991211
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.197 Vali Acc: 0.467 Test Loss: 1.197 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.8605690002441406
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.8305683135986328
Epoch: 4, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.6229994297027588
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.7294797897338867
Epoch: 6, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.6623835563659668
Epoch: 7, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.7407529354095459
Epoch: 8, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.7216603755950928
Epoch: 9, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.8559761047363281
Epoch: 10, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.964601993560791
Epoch: 11, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.9521694183349609
Epoch: 12, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 1.1104834079742432
Epoch: 13, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.7022829055786133
Epoch: 14, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.8006694316864014
Epoch: 15, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.949899435043335
Epoch: 16, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 1.0041601657867432
Epoch: 17, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 1.0598900318145752
Epoch: 18, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.8187170028686523
Epoch: 19, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.8133788108825684
Epoch: 20, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.8596034049987793
Epoch: 21, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.673114538192749
Epoch: 22, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.8179206848144531
Epoch: 23, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.9809644222259521
Epoch: 24, Steps: 1 | Train Loss: 0.192 Vali Loss: 0.999 Vali Acc: 0.600 Test Loss: 0.999 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.9410824775695801
Epoch: 25, Steps: 1 | Train Loss: 0.180 Vali Loss: 0.995 Vali Acc: 0.667 Test Loss: 0.995 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 26 cost time: 0.8549497127532959
Epoch: 26, Steps: 1 | Train Loss: 0.169 Vali Loss: 0.991 Vali Acc: 0.667 Test Loss: 0.991 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 27 cost time: 0.9942975044250488
Epoch: 27, Steps: 1 | Train Loss: 0.130 Vali Loss: 0.988 Vali Acc: 0.667 Test Loss: 0.988 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 28 cost time: 1.0312697887420654
Epoch: 28, Steps: 1 | Train Loss: 0.127 Vali Loss: 0.986 Vali Acc: 0.667 Test Loss: 0.986 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 29 cost time: 0.9453494548797607
Epoch: 29, Steps: 1 | Train Loss: 0.120 Vali Loss: 0.983 Vali Acc: 0.667 Test Loss: 0.983 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 30 cost time: 1.1922175884246826
Epoch: 30, Steps: 1 | Train Loss: 0.089 Vali Loss: 0.981 Vali Acc: 0.667 Test Loss: 0.981 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 31 cost time: 0.8758487701416016
Epoch: 31, Steps: 1 | Train Loss: 0.075 Vali Loss: 0.978 Vali Acc: 0.667 Test Loss: 0.978 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 32 cost time: 0.7676756381988525
Epoch: 32, Steps: 1 | Train Loss: 0.054 Vali Loss: 0.976 Vali Acc: 0.667 Test Loss: 0.976 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 33 cost time: 1.135953664779663
Epoch: 33, Steps: 1 | Train Loss: 0.056 Vali Loss: 0.974 Vali Acc: 0.667 Test Loss: 0.974 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 34 cost time: 0.9725906848907471
Epoch: 34, Steps: 1 | Train Loss: 0.049 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9935996532440186
Epoch: 35, Steps: 1 | Train Loss: 0.045 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9119775295257568
Epoch: 36, Steps: 1 | Train Loss: 0.042 Vali Loss: 0.970 Vali Acc: 0.600 Test Loss: 0.970 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8412408828735352
Epoch: 37, Steps: 1 | Train Loss: 0.044 Vali Loss: 0.968 Vali Acc: 0.600 Test Loss: 0.968 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8216390609741211
Epoch: 38, Steps: 1 | Train Loss: 0.032 Vali Loss: 0.967 Vali Acc: 0.600 Test Loss: 0.967 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8804104328155518
Epoch: 39, Steps: 1 | Train Loss: 0.025 Vali Loss: 0.967 Vali Acc: 0.600 Test Loss: 0.967 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9978609085083008
Epoch: 40, Steps: 1 | Train Loss: 0.031 Vali Loss: 0.966 Vali Acc: 0.600 Test Loss: 0.966 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.3399579524993896
Epoch: 41, Steps: 1 | Train Loss: 0.019 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0913212299346924
Epoch: 42, Steps: 1 | Train Loss: 0.020 Vali Loss: 0.964 Vali Acc: 0.600 Test Loss: 0.964 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3866536617279053
Epoch: 43, Steps: 1 | Train Loss: 0.019 Vali Loss: 0.964 Vali Acc: 0.600 Test Loss: 0.964 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 139779
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.6786136627197266
Epoch: 1, Steps: 1 | Train Loss: 1.357 Vali Loss: 1.333 Vali Acc: 0.133 Test Loss: 1.333 Test Acc: 0.133
Validation loss decreased (inf --> -0.133320).  Saving model ...
Epoch: 2 cost time: 1.0202288627624512
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.333 Vali Acc: 0.133 Test Loss: 1.333 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 3 cost time: 1.089219331741333
Epoch: 3, Steps: 1 | Train Loss: 1.364 Vali Loss: 1.333 Vali Acc: 0.133 Test Loss: 1.333 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2404956817626953
Epoch: 4, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.334 Vali Acc: 0.133 Test Loss: 1.334 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0154924392700195
Epoch: 5, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.335 Vali Acc: 0.133 Test Loss: 1.335 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8177342414855957
Epoch: 6, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.336 Vali Acc: 0.133 Test Loss: 1.336 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9672806262969971
Epoch: 7, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.338 Vali Acc: 0.133 Test Loss: 1.338 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9004554748535156
Epoch: 8, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.339 Vali Acc: 0.133 Test Loss: 1.339 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9414873123168945
Epoch: 9, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.340 Vali Acc: 0.133 Test Loss: 1.340 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2602007389068604
Epoch: 10, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.342 Vali Acc: 0.133 Test Loss: 1.342 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1097114086151123
Epoch: 11, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.343 Vali Acc: 0.133 Test Loss: 1.343 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.977869987487793
Epoch: 12, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.344 Vali Acc: 0.133 Test Loss: 1.344 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df256_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.13333333333333333
model parameter : 145475
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8179502487182617
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.989069938659668
Epoch: 2, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.3692750930786133
Epoch: 3, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8484957218170166
Epoch: 4, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1272475719451904
Epoch: 5, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.7393500804901123
Epoch: 6, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7802186012268066
Epoch: 7, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9491753578186035
Epoch: 8, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1951918601989746
Epoch: 9, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8333256244659424
Epoch: 10, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.252124547958374
Epoch: 11, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9028582572937012
Epoch: 12, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2576589584350586
Epoch: 13, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8028767108917236
Epoch: 14, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.939267635345459
Epoch: 15, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.7676436901092529
Epoch: 16, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.956707239151001
Epoch: 17, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9080095291137695
Epoch: 18, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1101622581481934
Epoch: 19, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9392800331115723
Epoch: 20, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9043211936950684
Epoch: 21, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2344372272491455
Epoch: 22, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.020505428314209
Epoch: 23, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2266759872436523
Epoch: 24, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9543483257293701
Epoch: 25, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0979509353637695
Epoch: 26, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 131011
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.021348714828491
Epoch: 1, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7937870025634766
Epoch: 2, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.7958567142486572
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.9414629936218262
Epoch: 4, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.994621992111206
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.9387955665588379
Epoch: 6, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.901587724685669
Epoch: 7, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7958416938781738
Epoch: 8, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.820824384689331
Epoch: 9, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 1.1961851119995117
Epoch: 10, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0264477729797363
Epoch: 11, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.262052059173584
Epoch: 12, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2837581634521484
Epoch: 13, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9258074760437012
Epoch: 14, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8157908916473389
Epoch: 15, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1893610954284668
Epoch: 16, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.070763349533081
Epoch: 17, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.8975510597229004
Epoch: 18, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.968299150466919
Epoch: 19, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.8781373500823975
Epoch: 20, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.8896458148956299
Epoch: 21, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.8817780017852783
Epoch: 22, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0441601276397705
Epoch: 23, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1022844314575195
Epoch: 24, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1396498680114746
Epoch: 25, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.8657543659210205
Epoch: 26, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.8873038291931152
Epoch: 27, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.043628215789795
Epoch: 28, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 0.7676112651824951
Epoch: 29, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.553584098815918
Epoch: 30, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1227037906646729
Epoch: 31, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0565509796142578
Epoch: 32, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7559685707092285
Epoch: 33, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.058598518371582
Epoch: 34, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.173933506011963
Epoch: 35, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1093049049377441
Epoch: 36, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1151180267333984
Epoch: 37, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1073050498962402
Epoch: 38, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 105027
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.918973922729492
Epoch: 1, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8885223865509033
Epoch: 2, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 1.001154899597168
Epoch: 3, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.8302948474884033
Epoch: 4, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.7894701957702637
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.1471707820892334
Epoch: 6, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 1.1993377208709717
Epoch: 7, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 1.1432702541351318
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.8168742656707764
Epoch: 9, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.9144458770751953
Epoch: 10, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7882373332977295
Epoch: 11, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9777853488922119
Epoch: 12, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.895559549331665
Epoch: 13, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 1.1817424297332764
Epoch: 14, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.855128288269043
Epoch: 15, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.8516294956207275
Epoch: 16, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.9261114597320557
Epoch: 17, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.0582830905914307
Epoch: 18, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1337945461273193
Epoch: 19, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 20 cost time: 0.9996559619903564
Epoch: 20, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9340903759002686
Epoch: 21, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8730185031890869
Epoch: 22, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2026927471160889
Epoch: 23, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.087292194366455
Epoch: 24, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.85915207862854
Epoch: 25, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3087348937988281
Epoch: 26, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.940298318862915
Epoch: 27, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9675254821777344
Epoch: 28, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1421003341674805
Epoch: 29, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.182 Vali Acc: 0.467 Test Loss: 1.182 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 99075
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.471977710723877
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.9889228343963623
Epoch: 2, Steps: 1 | Train Loss: 1.344 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.9376509189605713
Epoch: 3, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 1.0536091327667236
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.0150120258331299
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.9215867519378662
Epoch: 6, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 1.1407876014709473
Epoch: 7, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2579562664031982
Epoch: 8, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3552155494689941
Epoch: 9, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.066756010055542
Epoch: 10, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1861615180969238
Epoch: 11, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1646604537963867
Epoch: 12, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3015596866607666
Epoch: 13, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0478084087371826
Epoch: 14, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7271053791046143
Epoch: 15, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1329047679901123
Epoch: 16, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 98435
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7988662719726562
Epoch: 1, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.9118127822875977
Epoch: 2, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3553950786590576
Epoch: 3, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1491878032684326
Epoch: 4, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9760282039642334
Epoch: 5, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9857468605041504
Epoch: 6, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.861295223236084
Epoch: 7, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0624701976776123
Epoch: 8, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7364189624786377
Epoch: 9, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0422990322113037
Epoch: 10, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0548536777496338
Epoch: 11, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 101059
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.6693789958953857
Epoch: 1, Steps: 1 | Train Loss: 1.473 Vali Loss: 1.342 Vali Acc: 0.333 Test Loss: 1.342 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.469702959060669
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.327 Vali Acc: 0.267 Test Loss: 1.327 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1674962043762207
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.8450336456298828
Epoch: 4, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.304 Vali Acc: 0.333 Test Loss: 1.304 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 0.892486572265625
Epoch: 5, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.293 Vali Acc: 0.333 Test Loss: 1.293 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 0.7418432235717773
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.284 Vali Acc: 0.267 Test Loss: 1.284 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8069777488708496
Epoch: 7, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.276 Vali Acc: 0.200 Test Loss: 1.276 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8623900413513184
Epoch: 8, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7764108180999756
Epoch: 9, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.259 Vali Acc: 0.200 Test Loss: 1.259 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.046738862991333
Epoch: 10, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.251 Vali Acc: 0.200 Test Loss: 1.251 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.286332130432129
Epoch: 11, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.243 Vali Acc: 0.200 Test Loss: 1.243 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4651679992675781
Epoch: 12, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.285438060760498
Epoch: 13, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7989284992218018
Epoch: 14, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1423113346099854
Epoch: 15, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 106755
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0407238006591797
Epoch: 1, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8040316104888916
Epoch: 2, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8934071063995361
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8494582176208496
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.8401882648468018
Epoch: 5, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.6273312568664551
Epoch: 6, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.7418937683105469
Epoch: 7, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9811856746673584
Epoch: 8, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6994533538818359
Epoch: 9, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.7834627628326416
Epoch: 10, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.120 Vali Acc: 0.533 Test Loss: 1.120 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.8956985473632812
Epoch: 11, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.8597548007965088
Epoch: 12, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.116 Vali Acc: 0.533 Test Loss: 1.116 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 0.7998220920562744
Epoch: 13, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.853996992111206
Epoch: 14, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.771709680557251
Epoch: 15, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 16 cost time: 0.7688124179840088
Epoch: 16, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.106 Vali Acc: 0.533 Test Loss: 1.106 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 0.5720047950744629
Epoch: 17, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 18 cost time: 1.3352549076080322
Epoch: 18, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 19 cost time: 0.9946284294128418
Epoch: 19, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 20 cost time: 0.8098762035369873
Epoch: 20, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 21 cost time: 0.889132022857666
Epoch: 21, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 22 cost time: 1.032930850982666
Epoch: 22, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 23 cost time: 0.9048173427581787
Epoch: 23, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 24 cost time: 1.158576488494873
Epoch: 24, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9248132705688477
Epoch: 25, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8325793743133545
Epoch: 26, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 27 cost time: 0.8402872085571289
Epoch: 27, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9291460514068604
Epoch: 28, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.174642562866211
Epoch: 29, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.095 Vali Acc: 0.600 Test Loss: 1.095 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 30 cost time: 1.0495867729187012
Epoch: 30, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8662075996398926
Epoch: 31, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.099 Vali Acc: 0.600 Test Loss: 1.099 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0004100799560547
Epoch: 32, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8184921741485596
Epoch: 33, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2365639209747314
Epoch: 34, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.105 Vali Acc: 0.533 Test Loss: 1.105 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.765913724899292
Epoch: 35, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.108 Vali Acc: 0.533 Test Loss: 1.108 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9071028232574463
Epoch: 36, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9299969673156738
Epoch: 37, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8727438449859619
Epoch: 38, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.116 Vali Acc: 0.533 Test Loss: 1.116 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.736328125
Epoch: 39, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df128_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 112451
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.218021631240845
Epoch: 1, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.3203003406524658
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.218 Vali Acc: 0.400 Test Loss: 1.218 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 1.0326118469238281
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 1.2866828441619873
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.3521254062652588
Epoch: 5, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.9207048416137695
Epoch: 6, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.978452205657959
Epoch: 7, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9523870944976807
Epoch: 8, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2560193538665771
Epoch: 9, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2765562534332275
Epoch: 10, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1826403141021729
Epoch: 11, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 1.2998104095458984
Epoch: 12, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.065397024154663
Epoch: 13, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 1.1411190032958984
Epoch: 14, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6634836196899414
Epoch: 15, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2835922241210938
Epoch: 16, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 1.3075973987579346
Epoch: 17, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.341174840927124
Epoch: 18, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8854861259460449
Epoch: 19, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1368739604949951
Epoch: 20, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9524369239807129
Epoch: 21, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9849741458892822
Epoch: 22, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8746747970581055
Epoch: 23, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.306077480316162
Epoch: 24, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.382861852645874
Epoch: 25, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4857780933380127
Epoch: 26, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8073742389678955
Epoch: 27, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 114499
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.884352684020996
Epoch: 1, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0322935581207275
Epoch: 2, Steps: 1 | Train Loss: 1.528 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.179502010345459
Epoch: 3, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.505826473236084
Epoch: 4, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.2933881282806396
Epoch: 5, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.7864632606506348
Epoch: 6, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8573203086853027
Epoch: 7, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1363143920898438
Epoch: 8, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0950102806091309
Epoch: 9, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3866560459136963
Epoch: 10, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 1.3683750629425049
Epoch: 11, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 1.3496801853179932
Epoch: 12, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 1.2945365905761719
Epoch: 13, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 1.2639031410217285
Epoch: 14, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.033 Vali Acc: 0.333 Test Loss: 1.033 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.292811393737793
Epoch: 15, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.024 Vali Acc: 0.333 Test Loss: 1.024 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4068641662597656
Epoch: 16, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.012 Vali Acc: 0.400 Test Loss: 1.012 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 17 cost time: 1.064028024673462
Epoch: 17, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 18 cost time: 1.0823376178741455
Epoch: 18, Steps: 1 | Train Loss: 0.288 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 1.2071895599365234
Epoch: 19, Steps: 1 | Train Loss: 0.241 Vali Loss: 0.986 Vali Acc: 0.467 Test Loss: 0.986 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3585877418518066
Epoch: 20, Steps: 1 | Train Loss: 0.254 Vali Loss: 0.985 Vali Acc: 0.600 Test Loss: 0.985 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.98150634765625
Epoch: 21, Steps: 1 | Train Loss: 0.162 Vali Loss: 0.986 Vali Acc: 0.600 Test Loss: 0.986 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.313929557800293
Epoch: 22, Steps: 1 | Train Loss: 0.125 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0382273197174072
Epoch: 23, Steps: 1 | Train Loss: 0.126 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1390817165374756
Epoch: 24, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.004 Vali Acc: 0.600 Test Loss: 1.004 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2231371402740479
Epoch: 25, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.119795560836792
Epoch: 26, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4499564170837402
Epoch: 27, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3452661037445068
Epoch: 28, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.188253402709961
Epoch: 29, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2962028980255127
Epoch: 30, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 88515
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7256195545196533
Epoch: 1, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.7632462978363037
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.181 Vali Acc: 0.133 Test Loss: 1.181 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133322).  Saving model ...
Epoch: 3 cost time: 1.1119754314422607
Epoch: 3, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.8073468208312988
Epoch: 4, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.8214249610900879
Epoch: 5, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.6993858814239502
Epoch: 6, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.8053297996520996
Epoch: 7, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.8868603706359863
Epoch: 8, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.7823801040649414
Epoch: 9, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.9294967651367188
Epoch: 10, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.9160125255584717
Epoch: 11, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 1.008037805557251
Epoch: 12, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.5720138549804688
Epoch: 13, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.9884631633758545
Epoch: 14, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.8425590991973877
Epoch: 15, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 16 cost time: 0.8558039665222168
Epoch: 16, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 17 cost time: 0.8877956867218018
Epoch: 17, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 18 cost time: 0.9274172782897949
Epoch: 18, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 19 cost time: 0.9768774509429932
Epoch: 19, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.9990553855895996
Epoch: 20, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.8402986526489258
Epoch: 21, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 1.0318443775177002
Epoch: 22, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.8467686176300049
Epoch: 23, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.7757165431976318
Epoch: 24, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9509806632995605
Epoch: 25, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.8718752861022949
Epoch: 26, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9219236373901367
Epoch: 27, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8306577205657959
Epoch: 28, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7789530754089355
Epoch: 29, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0262587070465088
Epoch: 30, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7184033393859863
Epoch: 31, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8162941932678223
Epoch: 32, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7753775119781494
Epoch: 33, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9266867637634277
Epoch: 34, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.942453145980835
Epoch: 35, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 36 cost time: 0.8912379741668701
Epoch: 36, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2710931301116943
Epoch: 37, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8903915882110596
Epoch: 38, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9756133556365967
Epoch: 39, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0034074783325195
Epoch: 40, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0790784358978271
Epoch: 41, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2446682453155518
Epoch: 42, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1144518852233887
Epoch: 43, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1786060333251953
Epoch: 44, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2091071605682373
Epoch: 45, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 82563
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.381293296813965
Epoch: 1, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.0070312023162842
Epoch: 2, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.1448209285736084
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1584713459014893
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2549874782562256
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9716522693634033
Epoch: 6, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1170976161956787
Epoch: 7, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2274549007415771
Epoch: 8, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.114976406097412
Epoch: 9, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0238332748413086
Epoch: 10, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9524438381195068
Epoch: 11, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8942065238952637
Epoch: 12, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.044 Vali Acc: 0.333 Test Loss: 1.044 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 81923
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8847851753234863
Epoch: 1, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.353 Vali Acc: 0.200 Test Loss: 1.353 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 1.259413480758667
Epoch: 2, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.353 Vali Acc: 0.200 Test Loss: 1.353 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.216271162033081
Epoch: 3, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.354 Vali Acc: 0.200 Test Loss: 1.354 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2567870616912842
Epoch: 4, Steps: 1 | Train Loss: 1.370 Vali Loss: 1.355 Vali Acc: 0.200 Test Loss: 1.355 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1729533672332764
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.356 Vali Acc: 0.200 Test Loss: 1.356 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1557738780975342
Epoch: 6, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.359 Vali Acc: 0.200 Test Loss: 1.359 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9097170829772949
Epoch: 7, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.361 Vali Acc: 0.200 Test Loss: 1.361 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9028832912445068
Epoch: 8, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.363 Vali Acc: 0.200 Test Loss: 1.363 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7987556457519531
Epoch: 9, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.364 Vali Acc: 0.267 Test Loss: 1.364 Test Acc: 0.267
Validation loss decreased (-0.199986 --> -0.266653).  Saving model ...
Epoch: 10 cost time: 1.040769100189209
Epoch: 10, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.366 Vali Acc: 0.267 Test Loss: 1.366 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1304495334625244
Epoch: 11, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.368 Vali Acc: 0.200 Test Loss: 1.368 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0158567428588867
Epoch: 12, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.369 Vali Acc: 0.200 Test Loss: 1.369 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9791903495788574
Epoch: 13, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.370 Vali Acc: 0.200 Test Loss: 1.370 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2365829944610596
Epoch: 14, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.371 Vali Acc: 0.200 Test Loss: 1.371 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1873247623443604
Epoch: 15, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.372 Vali Acc: 0.200 Test Loss: 1.372 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9856667518615723
Epoch: 16, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.372 Vali Acc: 0.200 Test Loss: 1.372 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1071758270263672
Epoch: 17, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.372 Vali Acc: 0.200 Test Loss: 1.372 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8967669010162354
Epoch: 18, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.372 Vali Acc: 0.200 Test Loss: 1.372 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.288069725036621
Epoch: 19, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.373 Vali Acc: 0.200 Test Loss: 1.373 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 84547
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.227169513702393
Epoch: 1, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7843949794769287
Epoch: 2, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.093144178390503
Epoch: 3, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7974750995635986
Epoch: 4, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.9564120769500732
Epoch: 5, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.0694878101348877
Epoch: 6, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.0395960807800293
Epoch: 7, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.7825150489807129
Epoch: 8, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.9822666645050049
Epoch: 9, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.7856917381286621
Epoch: 10, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 1.3586270809173584
Epoch: 11, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 1.0786030292510986
Epoch: 12, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.9757847785949707
Epoch: 13, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.8095557689666748
Epoch: 14, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.9283139705657959
Epoch: 15, Steps: 1 | Train Loss: 0.623 Vali Loss: 0.999 Vali Acc: 0.467 Test Loss: 0.999 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9507970809936523
Epoch: 16, Steps: 1 | Train Loss: 0.559 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.562101125717163
Epoch: 17, Steps: 1 | Train Loss: 0.475 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8532199859619141
Epoch: 18, Steps: 1 | Train Loss: 0.503 Vali Loss: 0.986 Vali Acc: 0.467 Test Loss: 0.986 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9634053707122803
Epoch: 19, Steps: 1 | Train Loss: 0.349 Vali Loss: 0.981 Vali Acc: 0.467 Test Loss: 0.981 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1343374252319336
Epoch: 20, Steps: 1 | Train Loss: 0.358 Vali Loss: 0.977 Vali Acc: 0.467 Test Loss: 0.977 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8852829933166504
Epoch: 21, Steps: 1 | Train Loss: 0.293 Vali Loss: 0.973 Vali Acc: 0.467 Test Loss: 0.973 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0766677856445312
Epoch: 22, Steps: 1 | Train Loss: 0.312 Vali Loss: 0.969 Vali Acc: 0.467 Test Loss: 0.969 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8862431049346924
Epoch: 23, Steps: 1 | Train Loss: 0.322 Vali Loss: 0.966 Vali Acc: 0.467 Test Loss: 0.966 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8167383670806885
Epoch: 24, Steps: 1 | Train Loss: 0.209 Vali Loss: 0.962 Vali Acc: 0.467 Test Loss: 0.962 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 90243
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9372942447662354
Epoch: 1, Steps: 1 | Train Loss: 1.395 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.261460781097412
Epoch: 2, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9673311710357666
Epoch: 3, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.2242259979248047
Epoch: 4, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.0668723583221436
Epoch: 5, Steps: 1 | Train Loss: 1.309 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.9938478469848633
Epoch: 6, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8257288932800293
Epoch: 7, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9947524070739746
Epoch: 8, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.8243060111999512
Epoch: 9, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 1.1742610931396484
Epoch: 10, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 0.924274206161499
Epoch: 11, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 0.7099106311798096
Epoch: 12, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 0.9039402008056641
Epoch: 13, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.6781125068664551
Epoch: 14, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 15 cost time: 1.0011370182037354
Epoch: 15, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 16 cost time: 0.9025905132293701
Epoch: 16, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 17 cost time: 1.1854174137115479
Epoch: 17, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 18 cost time: 1.2444722652435303
Epoch: 18, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 19 cost time: 1.1977758407592773
Epoch: 19, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 20 cost time: 1.4362201690673828
Epoch: 20, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.9780101776123047
Epoch: 21, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.815345287322998
Epoch: 22, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.91365647315979
Epoch: 23, Steps: 1 | Train Loss: 0.372 Vali Loss: 0.996 Vali Acc: 0.467 Test Loss: 0.996 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2395596504211426
Epoch: 24, Steps: 1 | Train Loss: 0.367 Vali Loss: 0.991 Vali Acc: 0.467 Test Loss: 0.991 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7732288837432861
Epoch: 25, Steps: 1 | Train Loss: 0.276 Vali Loss: 0.988 Vali Acc: 0.467 Test Loss: 0.988 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0880632400512695
Epoch: 26, Steps: 1 | Train Loss: 0.271 Vali Loss: 0.985 Vali Acc: 0.467 Test Loss: 0.985 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1119976043701172
Epoch: 27, Steps: 1 | Train Loss: 0.256 Vali Loss: 0.983 Vali Acc: 0.467 Test Loss: 0.983 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1796514987945557
Epoch: 28, Steps: 1 | Train Loss: 0.182 Vali Loss: 0.981 Vali Acc: 0.467 Test Loss: 0.981 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9612526893615723
Epoch: 29, Steps: 1 | Train Loss: 0.170 Vali Loss: 0.979 Vali Acc: 0.467 Test Loss: 0.979 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1882569789886475
Epoch: 30, Steps: 1 | Train Loss: 0.159 Vali Loss: 0.978 Vali Acc: 0.467 Test Loss: 0.978 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm64_nh16_df64_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 95939
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.89225697517395
Epoch: 1, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.8147883415222168
Epoch: 2, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0135416984558105
Epoch: 3, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7248716354370117
Epoch: 4, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.839440107345581
Epoch: 5, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0056447982788086
Epoch: 6, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9175398349761963
Epoch: 7, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.9785068035125732
Epoch: 8, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1156041622161865
Epoch: 9, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2742016315460205
Epoch: 10, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9784834384918213
Epoch: 11, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.037869930267334
Epoch: 12, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2898366451263428
Epoch: 13, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3083384037017822
Epoch: 14, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9787981510162354
Epoch: 15, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9439547061920166
Epoch: 16, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.9400210380554199
Epoch: 17, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7824673652648926
Epoch: 18, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.828707218170166
Epoch: 19, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 1.0608317852020264
Epoch: 20, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.9008932113647461
Epoch: 21, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 1.7667267322540283
Epoch: 22, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 1.1758019924163818
Epoch: 23, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 1.0276024341583252
Epoch: 24, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2485854625701904
Epoch: 25, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4450461864471436
Epoch: 26, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8429059982299805
Epoch: 27, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.393824815750122
Epoch: 28, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 1.3283884525299072
Epoch: 29, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.30330228805542
Epoch: 30, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1647508144378662
Epoch: 31, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2618021965026855
Epoch: 32, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9146664142608643
Epoch: 33, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3128671646118164
Epoch: 34, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2175860404968262
Epoch: 35, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7811198234558105
Epoch: 36, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.319519281387329
Epoch: 37, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1076772212982178
Epoch: 38, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 74083
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.809821367263794
Epoch: 1, Steps: 1 | Train Loss: 1.413 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9160215854644775
Epoch: 2, Steps: 1 | Train Loss: 1.286 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.0845539569854736
Epoch: 3, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7878017425537109
Epoch: 4, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.4060192108154297
Epoch: 5, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.5683190822601318
Epoch: 6, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9620401859283447
Epoch: 7, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.172520399093628
Epoch: 8, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.516530990600586
Epoch: 9, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.063 Vali Acc: 0.267 Test Loss: 1.063 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1931731700897217
Epoch: 10, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.054 Vali Acc: 0.267 Test Loss: 1.054 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3857908248901367
Epoch: 11, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 12 cost time: 1.2482850551605225
Epoch: 12, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.037 Vali Acc: 0.333 Test Loss: 1.037 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 13 cost time: 1.0494227409362793
Epoch: 13, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.029 Vali Acc: 0.333 Test Loss: 1.029 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 1.067697525024414
Epoch: 14, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.021 Vali Acc: 0.400 Test Loss: 1.021 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 15 cost time: 1.0162487030029297
Epoch: 15, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 16 cost time: 0.7043886184692383
Epoch: 16, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 17 cost time: 1.0677475929260254
Epoch: 17, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 18 cost time: 0.9133830070495605
Epoch: 18, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 19 cost time: 1.244450569152832
Epoch: 19, Steps: 1 | Train Loss: 0.542 Vali Loss: 0.998 Vali Acc: 0.467 Test Loss: 0.998 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 20 cost time: 0.971787691116333
Epoch: 20, Steps: 1 | Train Loss: 0.477 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 21 cost time: 1.0252125263214111
Epoch: 21, Steps: 1 | Train Loss: 0.454 Vali Loss: 0.992 Vali Acc: 0.467 Test Loss: 0.992 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 22 cost time: 1.591930627822876
Epoch: 22, Steps: 1 | Train Loss: 0.416 Vali Loss: 0.990 Vali Acc: 0.400 Test Loss: 0.990 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.247323751449585
Epoch: 23, Steps: 1 | Train Loss: 0.329 Vali Loss: 0.988 Vali Acc: 0.400 Test Loss: 0.988 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4094610214233398
Epoch: 24, Steps: 1 | Train Loss: 0.345 Vali Loss: 0.988 Vali Acc: 0.400 Test Loss: 0.988 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1548471450805664
Epoch: 25, Steps: 1 | Train Loss: 0.271 Vali Loss: 0.987 Vali Acc: 0.400 Test Loss: 0.987 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3752992153167725
Epoch: 26, Steps: 1 | Train Loss: 0.294 Vali Loss: 0.987 Vali Acc: 0.400 Test Loss: 0.987 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3116850852966309
Epoch: 27, Steps: 1 | Train Loss: 0.208 Vali Loss: 0.987 Vali Acc: 0.400 Test Loss: 0.987 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1739158630371094
Epoch: 28, Steps: 1 | Train Loss: 0.231 Vali Loss: 0.989 Vali Acc: 0.400 Test Loss: 0.989 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8489408493041992
Epoch: 29, Steps: 1 | Train Loss: 0.199 Vali Loss: 0.993 Vali Acc: 0.333 Test Loss: 0.993 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2293908596038818
Epoch: 30, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.000 Vali Acc: 0.333 Test Loss: 1.000 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2400624752044678
Epoch: 31, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.009 Vali Acc: 0.333 Test Loss: 1.009 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 61091
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.020514965057373
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8923771381378174
Epoch: 2, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.9106881618499756
Epoch: 3, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 1.0442240238189697
Epoch: 4, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.9356484413146973
Epoch: 5, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0243806838989258
Epoch: 6, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.8012657165527344
Epoch: 7, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 1.1918928623199463
Epoch: 8, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 1.1741931438446045
Epoch: 9, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 1.0070879459381104
Epoch: 10, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.114 Vali Acc: 0.600 Test Loss: 1.114 Test Acc: 0.600
Validation loss decreased (-0.466655 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.9498836994171143
Epoch: 11, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.9156546592712402
Epoch: 12, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.7437665462493896
Epoch: 13, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.099 Vali Acc: 0.600 Test Loss: 1.099 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.7655632495880127
Epoch: 14, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.095 Vali Acc: 0.600 Test Loss: 1.095 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.9336552619934082
Epoch: 15, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8307723999023438
Epoch: 16, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2851908206939697
Epoch: 17, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9464690685272217
Epoch: 18, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7619495391845703
Epoch: 19, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0082635879516602
Epoch: 20, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8073875904083252
Epoch: 21, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.074 Vali Acc: 0.667 Test Loss: 1.074 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 22 cost time: 1.066234827041626
Epoch: 22, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.072 Vali Acc: 0.667 Test Loss: 1.072 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 23 cost time: 0.8320333957672119
Epoch: 23, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8686819076538086
Epoch: 24, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7983701229095459
Epoch: 25, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1487927436828613
Epoch: 26, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1425058841705322
Epoch: 27, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0566110610961914
Epoch: 28, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0341174602508545
Epoch: 29, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9808413982391357
Epoch: 30, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0657203197479248
Epoch: 31, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4775116443634033
Epoch: 32, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 58115
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4771945476531982
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.106403112411499
Epoch: 2, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.9661705493927002
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.1645724773406982
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 1.0112519264221191
Epoch: 5, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 1.126394271850586
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.904076099395752
Epoch: 7, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.9924287796020508
Epoch: 8, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 1.07855224609375
Epoch: 9, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 1.462618350982666
Epoch: 10, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1057929992675781
Epoch: 11, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8288900852203369
Epoch: 12, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.8417541980743408
Epoch: 13, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.9086732864379883
Epoch: 14, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 1.1916534900665283
Epoch: 15, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.78721022605896
Epoch: 16, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.8157258033752441
Epoch: 17, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 1.149975299835205
Epoch: 18, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 1.0096409320831299
Epoch: 19, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 20 cost time: 1.2941868305206299
Epoch: 20, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 21 cost time: 1.3179090023040771
Epoch: 21, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 22 cost time: 1.1773169040679932
Epoch: 22, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0307180881500244
Epoch: 23, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.92643141746521
Epoch: 24, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.103534460067749
Epoch: 25, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 26 cost time: 1.2094404697418213
Epoch: 26, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1808137893676758
Epoch: 27, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9100356101989746
Epoch: 28, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2026891708374023
Epoch: 29, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7727060317993164
Epoch: 30, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1779847145080566
Epoch: 31, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.00840163230896
Epoch: 32, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6371769905090332
Epoch: 33, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9555752277374268
Epoch: 34, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7363579273223877
Epoch: 35, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 57795
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.229418992996216
Epoch: 1, Steps: 1 | Train Loss: 1.377 Vali Loss: 1.502 Vali Acc: 0.333 Test Loss: 1.502 Test Acc: 0.333
Validation loss decreased (inf --> -0.333318).  Saving model ...
Epoch: 2 cost time: 1.0418462753295898
Epoch: 2, Steps: 1 | Train Loss: 1.490 Vali Loss: 1.471 Vali Acc: 0.333 Test Loss: 1.471 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 1.071709156036377
Epoch: 3, Steps: 1 | Train Loss: 1.426 Vali Loss: 1.443 Vali Acc: 0.333 Test Loss: 1.443 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 4 cost time: 1.2058837413787842
Epoch: 4, Steps: 1 | Train Loss: 1.351 Vali Loss: 1.418 Vali Acc: 0.333 Test Loss: 1.418 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 1.4731624126434326
Epoch: 5, Steps: 1 | Train Loss: 1.333 Vali Loss: 1.395 Vali Acc: 0.333 Test Loss: 1.395 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 6 cost time: 1.014688491821289
Epoch: 6, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.377 Vali Acc: 0.333 Test Loss: 1.377 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 1.0273964405059814
Epoch: 7, Steps: 1 | Train Loss: 1.385 Vali Loss: 1.360 Vali Acc: 0.333 Test Loss: 1.360 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 1.1880552768707275
Epoch: 8, Steps: 1 | Train Loss: 1.405 Vali Loss: 1.345 Vali Acc: 0.333 Test Loss: 1.345 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 9 cost time: 1.0663597583770752
Epoch: 9, Steps: 1 | Train Loss: 1.360 Vali Loss: 1.330 Vali Acc: 0.333 Test Loss: 1.330 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 0.655043363571167
Epoch: 10, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.317 Vali Acc: 0.333 Test Loss: 1.317 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 11 cost time: 1.1548223495483398
Epoch: 11, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 12 cost time: 1.1105437278747559
Epoch: 12, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2937512397766113
Epoch: 13, Steps: 1 | Train Loss: 1.314 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3064069747924805
Epoch: 14, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.272 Vali Acc: 0.267 Test Loss: 1.272 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8960309028625488
Epoch: 15, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9277284145355225
Epoch: 16, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2883977890014648
Epoch: 17, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.158686637878418
Epoch: 18, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0246448516845703
Epoch: 19, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2485344409942627
Epoch: 20, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0081980228424072
Epoch: 21, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 59107
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.439840316772461
Epoch: 1, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.9367945194244385
Epoch: 2, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.7058122158050537
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.735288143157959
Epoch: 4, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.004 Vali Acc: 0.400 Test Loss: 1.004 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 1.1257398128509521
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 0.996 Vali Acc: 0.467 Test Loss: 0.996 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 6 cost time: 0.9816997051239014
Epoch: 6, Steps: 1 | Train Loss: 0.819 Vali Loss: 0.988 Vali Acc: 0.467 Test Loss: 0.988 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 7 cost time: 0.8703794479370117
Epoch: 7, Steps: 1 | Train Loss: 1.038 Vali Loss: 0.981 Vali Acc: 0.467 Test Loss: 0.981 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 8 cost time: 0.8943707942962646
Epoch: 8, Steps: 1 | Train Loss: 0.836 Vali Loss: 0.975 Vali Acc: 0.467 Test Loss: 0.975 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 9 cost time: 1.1359755992889404
Epoch: 9, Steps: 1 | Train Loss: 0.883 Vali Loss: 0.969 Vali Acc: 0.467 Test Loss: 0.969 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 10 cost time: 0.8483843803405762
Epoch: 10, Steps: 1 | Train Loss: 0.816 Vali Loss: 0.964 Vali Acc: 0.467 Test Loss: 0.964 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 11 cost time: 1.2686736583709717
Epoch: 11, Steps: 1 | Train Loss: 0.842 Vali Loss: 0.960 Vali Acc: 0.467 Test Loss: 0.960 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 12 cost time: 1.159233808517456
Epoch: 12, Steps: 1 | Train Loss: 0.681 Vali Loss: 0.956 Vali Acc: 0.533 Test Loss: 0.956 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 13 cost time: 1.1689796447753906
Epoch: 13, Steps: 1 | Train Loss: 0.792 Vali Loss: 0.952 Vali Acc: 0.533 Test Loss: 0.952 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 14 cost time: 1.0552763938903809
Epoch: 14, Steps: 1 | Train Loss: 0.800 Vali Loss: 0.949 Vali Acc: 0.533 Test Loss: 0.949 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 15 cost time: 0.7630214691162109
Epoch: 15, Steps: 1 | Train Loss: 0.732 Vali Loss: 0.946 Vali Acc: 0.533 Test Loss: 0.946 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 16 cost time: 0.9839270114898682
Epoch: 16, Steps: 1 | Train Loss: 0.821 Vali Loss: 0.943 Vali Acc: 0.600 Test Loss: 0.943 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599991).  Saving model ...
Epoch: 17 cost time: 1.0292820930480957
Epoch: 17, Steps: 1 | Train Loss: 0.715 Vali Loss: 0.940 Vali Acc: 0.600 Test Loss: 0.940 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 18 cost time: 1.1208817958831787
Epoch: 18, Steps: 1 | Train Loss: 0.524 Vali Loss: 0.937 Vali Acc: 0.600 Test Loss: 0.937 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 19 cost time: 0.9909329414367676
Epoch: 19, Steps: 1 | Train Loss: 0.532 Vali Loss: 0.935 Vali Acc: 0.600 Test Loss: 0.935 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 20 cost time: 1.34128737449646
Epoch: 20, Steps: 1 | Train Loss: 0.599 Vali Loss: 0.933 Vali Acc: 0.667 Test Loss: 0.933 Test Acc: 0.667
Validation loss decreased (-0.599991 --> -0.666657).  Saving model ...
Epoch: 21 cost time: 0.826728105545044
Epoch: 21, Steps: 1 | Train Loss: 0.548 Vali Loss: 0.931 Vali Acc: 0.667 Test Loss: 0.931 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 22 cost time: 0.900761604309082
Epoch: 22, Steps: 1 | Train Loss: 0.446 Vali Loss: 0.929 Vali Acc: 0.733 Test Loss: 0.929 Test Acc: 0.733
Validation loss decreased (-0.666657 --> -0.733324).  Saving model ...
Epoch: 23 cost time: 1.0450079441070557
Epoch: 23, Steps: 1 | Train Loss: 0.487 Vali Loss: 0.927 Vali Acc: 0.733 Test Loss: 0.927 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 24 cost time: 1.1335628032684326
Epoch: 24, Steps: 1 | Train Loss: 0.382 Vali Loss: 0.926 Vali Acc: 0.733 Test Loss: 0.926 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 25 cost time: 1.057844877243042
Epoch: 25, Steps: 1 | Train Loss: 0.367 Vali Loss: 0.925 Vali Acc: 0.733 Test Loss: 0.925 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 26 cost time: 0.879586935043335
Epoch: 26, Steps: 1 | Train Loss: 0.369 Vali Loss: 0.924 Vali Acc: 0.733 Test Loss: 0.924 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 27 cost time: 1.0199110507965088
Epoch: 27, Steps: 1 | Train Loss: 0.308 Vali Loss: 0.923 Vali Acc: 0.733 Test Loss: 0.923 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 28 cost time: 1.1525139808654785
Epoch: 28, Steps: 1 | Train Loss: 0.284 Vali Loss: 0.922 Vali Acc: 0.733 Test Loss: 0.922 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 29 cost time: 0.689307451248169
Epoch: 29, Steps: 1 | Train Loss: 0.296 Vali Loss: 0.922 Vali Acc: 0.733 Test Loss: 0.922 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 30 cost time: 0.9015102386474609
Epoch: 30, Steps: 1 | Train Loss: 0.223 Vali Loss: 0.921 Vali Acc: 0.733 Test Loss: 0.921 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 31 cost time: 0.8764524459838867
Epoch: 31, Steps: 1 | Train Loss: 0.208 Vali Loss: 0.921 Vali Acc: 0.733 Test Loss: 0.921 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 32 cost time: 0.9017899036407471
Epoch: 32, Steps: 1 | Train Loss: 0.230 Vali Loss: 0.920 Vali Acc: 0.733 Test Loss: 0.920 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 33 cost time: 0.7552165985107422
Epoch: 33, Steps: 1 | Train Loss: 0.196 Vali Loss: 0.920 Vali Acc: 0.733 Test Loss: 0.920 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 34 cost time: 1.0556957721710205
Epoch: 34, Steps: 1 | Train Loss: 0.237 Vali Loss: 0.920 Vali Acc: 0.733 Test Loss: 0.920 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 35 cost time: 1.1469738483428955
Epoch: 35, Steps: 1 | Train Loss: 0.183 Vali Loss: 0.920 Vali Acc: 0.733 Test Loss: 0.920 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 36 cost time: 1.1151461601257324
Epoch: 36, Steps: 1 | Train Loss: 0.102 Vali Loss: 0.920 Vali Acc: 0.733 Test Loss: 0.920 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 37 cost time: 1.0058436393737793
Epoch: 37, Steps: 1 | Train Loss: 0.103 Vali Loss: 0.920 Vali Acc: 0.667 Test Loss: 0.920 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9466700553894043
Epoch: 38, Steps: 1 | Train Loss: 0.124 Vali Loss: 0.919 Vali Acc: 0.667 Test Loss: 0.919 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8906641006469727
Epoch: 39, Steps: 1 | Train Loss: 0.111 Vali Loss: 0.920 Vali Acc: 0.600 Test Loss: 0.920 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9897539615631104
Epoch: 40, Steps: 1 | Train Loss: 0.107 Vali Loss: 0.921 Vali Acc: 0.600 Test Loss: 0.921 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.957970142364502
Epoch: 41, Steps: 1 | Train Loss: 0.084 Vali Loss: 0.921 Vali Acc: 0.600 Test Loss: 0.921 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1451470851898193
Epoch: 42, Steps: 1 | Train Loss: 0.090 Vali Loss: 0.921 Vali Acc: 0.600 Test Loss: 0.921 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9887080192565918
Epoch: 43, Steps: 1 | Train Loss: 0.074 Vali Loss: 0.922 Vali Acc: 0.600 Test Loss: 0.922 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.014716625213623
Epoch: 44, Steps: 1 | Train Loss: 0.081 Vali Loss: 0.923 Vali Acc: 0.600 Test Loss: 0.923 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.9741976261138916
Epoch: 45, Steps: 1 | Train Loss: 0.068 Vali Loss: 0.925 Vali Acc: 0.600 Test Loss: 0.925 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.8628435134887695
Epoch: 46, Steps: 1 | Train Loss: 0.062 Vali Loss: 0.926 Vali Acc: 0.600 Test Loss: 0.926 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 61955
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8838396072387695
Epoch: 1, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8976490497589111
Epoch: 2, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 1.0678749084472656
Epoch: 3, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 1.0214166641235352
Epoch: 4, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 1.2423005104064941
Epoch: 5, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.016979455947876
Epoch: 6, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.302337646484375
Epoch: 7, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.8780193328857422
Epoch: 8, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 1.1387732028961182
Epoch: 9, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 1.293102502822876
Epoch: 10, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 1.15342116355896
Epoch: 11, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 12 cost time: 1.1878507137298584
Epoch: 12, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 0.9527316093444824
Epoch: 13, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 1.0841217041015625
Epoch: 14, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 15 cost time: 0.9105837345123291
Epoch: 15, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 16 cost time: 1.086660623550415
Epoch: 16, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 17 cost time: 0.9694547653198242
Epoch: 17, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.125016212463379
Epoch: 18, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7412877082824707
Epoch: 19, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9735817909240723
Epoch: 20, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9048173427581787
Epoch: 21, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1997711658477783
Epoch: 22, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3374757766723633
Epoch: 23, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1991527080535889
Epoch: 24, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1950888633728027
Epoch: 25, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.504004716873169
Epoch: 26, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df256_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 64803
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.13629674911499
Epoch: 1, Steps: 1 | Train Loss: 1.306 Vali Loss: 1.208 Vali Acc: 0.533 Test Loss: 1.208 Test Acc: 0.533
Validation loss decreased (inf --> -0.533321).  Saving model ...
Epoch: 2 cost time: 1.0482902526855469
Epoch: 2, Steps: 1 | Train Loss: 1.306 Vali Loss: 1.200 Vali Acc: 0.467 Test Loss: 1.200 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9342906475067139
Epoch: 3, Steps: 1 | Train Loss: 1.335 Vali Loss: 1.194 Vali Acc: 0.467 Test Loss: 1.194 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1500768661499023
Epoch: 4, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.187 Vali Acc: 0.467 Test Loss: 1.187 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0164165496826172
Epoch: 5, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8926815986633301
Epoch: 6, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8525197505950928
Epoch: 7, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8303523063659668
Epoch: 8, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1570050716400146
Epoch: 9, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0649757385253906
Epoch: 10, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.812852144241333
Epoch: 11, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 57443
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.158985137939453
Epoch: 1, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 1.28253173828125
Epoch: 2, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0855097770690918
Epoch: 3, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0049924850463867
Epoch: 4, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.223816156387329
Epoch: 5, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3046855926513672
Epoch: 6, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9821670055389404
Epoch: 7, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1709933280944824
Epoch: 8, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9922580718994141
Epoch: 9, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1138660907745361
Epoch: 10, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.035722255706787
Epoch: 11, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 44451
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.449546575546265
Epoch: 1, Steps: 1 | Train Loss: 1.455 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.1855146884918213
Epoch: 2, Steps: 1 | Train Loss: 1.594 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.2140142917633057
Epoch: 3, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.0420782566070557
Epoch: 4, Steps: 1 | Train Loss: 1.396 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8934774398803711
Epoch: 5, Steps: 1 | Train Loss: 1.308 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.9349238872528076
Epoch: 6, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8587207794189453
Epoch: 7, Steps: 1 | Train Loss: 1.292 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0366294384002686
Epoch: 8, Steps: 1 | Train Loss: 1.322 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9474563598632812
Epoch: 9, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0618910789489746
Epoch: 10, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9969024658203125
Epoch: 11, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8960304260253906
Epoch: 12, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8951339721679688
Epoch: 13, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4488401412963867
Epoch: 14, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8860344886779785
Epoch: 15, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 41475
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.1926703453063965
Epoch: 1, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 1.151839017868042
Epoch: 2, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 1.1668610572814941
Epoch: 3, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 1.0562164783477783
Epoch: 4, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 1.0923664569854736
Epoch: 5, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.9985334873199463
Epoch: 6, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 1.2564756870269775
Epoch: 7, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 1.2048630714416504
Epoch: 8, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 1.0712928771972656
Epoch: 9, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.062 Vali Acc: 0.267 Test Loss: 1.062 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2003886699676514
Epoch: 10, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.060 Vali Acc: 0.267 Test Loss: 1.060 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3404099941253662
Epoch: 11, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.057 Vali Acc: 0.267 Test Loss: 1.057 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.151747465133667
Epoch: 12, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.054 Vali Acc: 0.267 Test Loss: 1.054 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0102801322937012
Epoch: 13, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.052 Vali Acc: 0.267 Test Loss: 1.052 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4017071723937988
Epoch: 14, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.049 Vali Acc: 0.267 Test Loss: 1.049 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8917806148529053
Epoch: 15, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.046 Vali Acc: 0.267 Test Loss: 1.046 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5365548133850098
Epoch: 16, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 0.9793012142181396
Epoch: 17, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.040 Vali Acc: 0.333 Test Loss: 1.040 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 1.2157468795776367
Epoch: 18, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.037 Vali Acc: 0.333 Test Loss: 1.037 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 0.980825662612915
Epoch: 19, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.034 Vali Acc: 0.333 Test Loss: 1.034 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 20 cost time: 1.0981559753417969
Epoch: 20, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.031 Vali Acc: 0.333 Test Loss: 1.031 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 21 cost time: 0.918492317199707
Epoch: 21, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 22 cost time: 0.9684572219848633
Epoch: 22, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 23 cost time: 1.4007625579833984
Epoch: 23, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 24 cost time: 1.3194780349731445
Epoch: 24, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 25 cost time: 1.0932085514068604
Epoch: 25, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 26 cost time: 1.3860499858856201
Epoch: 26, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 27 cost time: 1.2882206439971924
Epoch: 27, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.013 Vali Acc: 0.400 Test Loss: 1.013 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 28 cost time: 1.0055270195007324
Epoch: 28, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.011 Vali Acc: 0.400 Test Loss: 1.011 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 29 cost time: 0.9368488788604736
Epoch: 29, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.009 Vali Acc: 0.400 Test Loss: 1.009 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 30 cost time: 1.300868034362793
Epoch: 30, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.008 Vali Acc: 0.400 Test Loss: 1.008 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 31 cost time: 1.1384243965148926
Epoch: 31, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 32 cost time: 1.085648775100708
Epoch: 32, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 33 cost time: 1.023411750793457
Epoch: 33, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 34 cost time: 1.1310551166534424
Epoch: 34, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8312554359436035
Epoch: 35, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.222264289855957
Epoch: 36, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9702386856079102
Epoch: 37, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0055770874023438
Epoch: 38, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4186713695526123
Epoch: 39, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.3727540969848633
Epoch: 40, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1626675128936768
Epoch: 41, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.3401498794555664
Epoch: 42, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0652310848236084
Epoch: 43, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 41155
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.561626434326172
Epoch: 1, Steps: 1 | Train Loss: 1.512 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.3253376483917236
Epoch: 2, Steps: 1 | Train Loss: 1.395 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.3177955150604248
Epoch: 3, Steps: 1 | Train Loss: 1.287 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.051898717880249
Epoch: 4, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.9170441627502441
Epoch: 5, Steps: 1 | Train Loss: 1.318 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.9540443420410156
Epoch: 6, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.9549026489257812
Epoch: 7, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.9553976058959961
Epoch: 8, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 1.3430521488189697
Epoch: 9, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 1.056748867034912
Epoch: 10, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9863388538360596
Epoch: 11, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1255483627319336
Epoch: 12, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1046085357666016
Epoch: 13, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.161076307296753
Epoch: 14, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.138643741607666
Epoch: 15, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8830854892730713
Epoch: 16, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6421630382537842
Epoch: 17, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2293710708618164
Epoch: 18, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0523176193237305
Epoch: 19, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 42467
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.02304220199585
Epoch: 1, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.0786137580871582
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1404240131378174
Epoch: 3, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0086042881011963
Epoch: 4, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0611302852630615
Epoch: 5, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9649970531463623
Epoch: 6, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1673636436462402
Epoch: 7, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8909499645233154
Epoch: 8, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1560781002044678
Epoch: 9, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.202204704284668
Epoch: 10, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0711538791656494
Epoch: 11, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 45315
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.573967218399048
Epoch: 1, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.9680671691894531
Epoch: 2, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.9048469066619873
Epoch: 3, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.9976952075958252
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 1.1159980297088623
Epoch: 5, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.8962233066558838
Epoch: 6, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 1.3897442817687988
Epoch: 7, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 1.053961992263794
Epoch: 8, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.9678745269775391
Epoch: 9, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 1.1430695056915283
Epoch: 10, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.9544522762298584
Epoch: 11, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1051251888275146
Epoch: 12, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9041562080383301
Epoch: 13, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1503233909606934
Epoch: 14, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1681582927703857
Epoch: 15, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0421578884124756
Epoch: 16, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.176584005355835
Epoch: 17, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1572728157043457
Epoch: 18, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.473292589187622
Epoch: 19, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1091639995574951
Epoch: 20, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df128_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 48163
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3098857402801514
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8290970325469971
Epoch: 2, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.7584962844848633
Epoch: 3, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.8543086051940918
Epoch: 4, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.9573125839233398
Epoch: 5, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.1251449584960938
Epoch: 6, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.9000470638275146
Epoch: 7, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 1.3416392803192139
Epoch: 8, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.981320858001709
Epoch: 9, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.9528124332427979
Epoch: 10, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 1.0163991451263428
Epoch: 11, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 1.3387846946716309
Epoch: 12, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.0323314666748047
Epoch: 13, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.8826684951782227
Epoch: 14, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.0064208507537842
Epoch: 15, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.9966897964477539
Epoch: 16, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.743821382522583
Epoch: 17, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7815840244293213
Epoch: 18, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.9895038604736328
Epoch: 19, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.900935173034668
Epoch: 20, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.901235818862915
Epoch: 21, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.9513053894042969
Epoch: 22, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.9479813575744629
Epoch: 23, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.9374313354492188
Epoch: 24, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.441056728363037
Epoch: 25, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2718377113342285
Epoch: 26, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4419317245483398
Epoch: 27, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5640194416046143
Epoch: 28, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1249339580535889
Epoch: 29, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4438226222991943
Epoch: 30, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1436395645141602
Epoch: 31, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0250799655914307
Epoch: 32, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4449162483215332
Epoch: 33, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 49123
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.588175058364868
Epoch: 1, Steps: 1 | Train Loss: 1.356 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9909493923187256
Epoch: 2, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.0709285736083984
Epoch: 3, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 1.0453674793243408
Epoch: 4, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.08467698097229
Epoch: 5, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.0142076015472412
Epoch: 6, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.906243085861206
Epoch: 7, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.9474058151245117
Epoch: 8, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8031775951385498
Epoch: 9, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.221365213394165
Epoch: 10, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7923390865325928
Epoch: 11, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7960309982299805
Epoch: 12, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8377437591552734
Epoch: 13, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8024873733520508
Epoch: 14, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9669961929321289
Epoch: 15, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.8370997905731201
Epoch: 16, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 1.1555993556976318
Epoch: 17, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.1455483436584473
Epoch: 18, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.9350521564483643
Epoch: 19, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 1.0626111030578613
Epoch: 20, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.7613916397094727
Epoch: 21, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 1.167314052581787
Epoch: 22, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 1.2328264713287354
Epoch: 23, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 1.1936020851135254
Epoch: 24, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.783534049987793
Epoch: 25, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 1.133601188659668
Epoch: 26, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 1.0854415893554688
Epoch: 27, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 1.0744807720184326
Epoch: 28, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 1.3453357219696045
Epoch: 29, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9195983409881592
Epoch: 30, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.995384693145752
Epoch: 31, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1308705806732178
Epoch: 32, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0904877185821533
Epoch: 33, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7943141460418701
Epoch: 34, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7796084880828857
Epoch: 35, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0425994396209717
Epoch: 36, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8394410610198975
Epoch: 37, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9721255302429199
Epoch: 38, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 36131
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.548796892166138
Epoch: 1, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.197190523147583
Epoch: 2, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.100987434387207
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9481637477874756
Epoch: 4, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.305068016052246
Epoch: 5, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.5542373657226562
Epoch: 6, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.9214715957641602
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0676264762878418
Epoch: 8, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.562453031539917
Epoch: 9, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6275019645690918
Epoch: 10, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4235882759094238
Epoch: 11, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2796058654785156
Epoch: 12, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9917902946472168
Epoch: 13, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.146885871887207
Epoch: 14, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3582873344421387
Epoch: 15, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2678818702697754
Epoch: 16, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 33155
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.699068784713745
Epoch: 1, Steps: 1 | Train Loss: 1.336 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7474558353424072
Epoch: 2, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9284405708312988
Epoch: 3, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1505966186523438
Epoch: 4, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2627952098846436
Epoch: 5, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8897261619567871
Epoch: 6, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.032027244567871
Epoch: 7, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2105834484100342
Epoch: 8, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.935272216796875
Epoch: 9, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8295242786407471
Epoch: 10, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.05690598487854
Epoch: 11, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 32835
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.004618406295776
Epoch: 1, Steps: 1 | Train Loss: 1.316 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9984064102172852
Epoch: 2, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8314874172210693
Epoch: 3, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4862723350524902
Epoch: 4, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9955191612243652
Epoch: 5, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9709758758544922
Epoch: 6, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0605785846710205
Epoch: 7, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2687098979949951
Epoch: 8, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4020092487335205
Epoch: 9, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.429870843887329
Epoch: 10, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1669058799743652
Epoch: 11, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.109 Vali Acc: 0.200 Test Loss: 1.109 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.909327507019043
Epoch: 12, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 13 cost time: 1.289435625076294
Epoch: 13, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 14 cost time: 1.2682807445526123
Epoch: 14, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 15 cost time: 0.8755133152008057
Epoch: 15, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 16 cost time: 0.8228030204772949
Epoch: 16, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 0.7780330181121826
Epoch: 17, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 1.0048213005065918
Epoch: 18, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 0.9035353660583496
Epoch: 19, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 20 cost time: 1.0904521942138672
Epoch: 20, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 1.2607967853546143
Epoch: 21, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 1.0311288833618164
Epoch: 22, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.9699416160583496
Epoch: 23, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 24 cost time: 0.8823795318603516
Epoch: 24, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 25 cost time: 1.1854302883148193
Epoch: 25, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.99517822265625
Epoch: 26, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 1.282961368560791
Epoch: 27, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 1.0808091163635254
Epoch: 28, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.9311647415161133
Epoch: 29, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.9905259609222412
Epoch: 30, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 1.1572661399841309
Epoch: 31, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 32 cost time: 0.8140106201171875
Epoch: 32, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 33 cost time: 0.9570965766906738
Epoch: 33, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 34 cost time: 0.8843934535980225
Epoch: 34, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 35 cost time: 0.8319191932678223
Epoch: 35, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 36 cost time: 0.9306252002716064
Epoch: 36, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9784438610076904
Epoch: 37, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8063733577728271
Epoch: 38, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1166093349456787
Epoch: 39, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0125222206115723
Epoch: 40, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2163164615631104
Epoch: 41, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7520148754119873
Epoch: 42, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8995766639709473
Epoch: 43, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0685253143310547
Epoch: 44, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3981075286865234
Epoch: 45, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 34147
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3509342670440674
Epoch: 1, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.0648586750030518
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.1890065670013428
Epoch: 3, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.5758070945739746
Epoch: 4, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.2962863445281982
Epoch: 5, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.1372921466827393
Epoch: 6, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.920557975769043
Epoch: 7, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 1.333122730255127
Epoch: 8, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 1.0518929958343506
Epoch: 9, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 1.382957935333252
Epoch: 10, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.9140489101409912
Epoch: 11, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.9038596153259277
Epoch: 12, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.9956731796264648
Epoch: 13, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 1.2294399738311768
Epoch: 14, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.9827079772949219
Epoch: 15, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.8757061958312988
Epoch: 16, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 1.0951275825500488
Epoch: 17, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.33345627784729
Epoch: 18, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 1.0197868347167969
Epoch: 19, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 20 cost time: 1.209775686264038
Epoch: 20, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 21 cost time: 1.016899824142456
Epoch: 21, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 22 cost time: 1.1151890754699707
Epoch: 22, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 23 cost time: 1.2530813217163086
Epoch: 23, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 24 cost time: 0.8884177207946777
Epoch: 24, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 25 cost time: 1.0498414039611816
Epoch: 25, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 26 cost time: 1.4237589836120605
Epoch: 26, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 27 cost time: 1.084268569946289
Epoch: 27, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 28 cost time: 1.3219118118286133
Epoch: 28, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 29 cost time: 1.2036633491516113
Epoch: 29, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.013 Vali Acc: 0.400 Test Loss: 1.013 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 30 cost time: 1.1606464385986328
Epoch: 30, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.009 Vali Acc: 0.400 Test Loss: 1.009 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 31 cost time: 0.9455070495605469
Epoch: 31, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.006 Vali Acc: 0.400 Test Loss: 1.006 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 32 cost time: 1.180657148361206
Epoch: 32, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.002 Vali Acc: 0.333 Test Loss: 1.002 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2935235500335693
Epoch: 33, Steps: 1 | Train Loss: 0.232 Vali Loss: 0.999 Vali Acc: 0.467 Test Loss: 0.999 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 34 cost time: 1.4425475597381592
Epoch: 34, Steps: 1 | Train Loss: 0.241 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 35 cost time: 1.2199599742889404
Epoch: 35, Steps: 1 | Train Loss: 0.175 Vali Loss: 0.992 Vali Acc: 0.467 Test Loss: 0.992 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 36 cost time: 1.4843010902404785
Epoch: 36, Steps: 1 | Train Loss: 0.183 Vali Loss: 0.989 Vali Acc: 0.467 Test Loss: 0.989 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 37 cost time: 1.2364532947540283
Epoch: 37, Steps: 1 | Train Loss: 0.156 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 38 cost time: 1.0712056159973145
Epoch: 38, Steps: 1 | Train Loss: 0.151 Vali Loss: 0.985 Vali Acc: 0.467 Test Loss: 0.985 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 39 cost time: 1.163424015045166
Epoch: 39, Steps: 1 | Train Loss: 0.125 Vali Loss: 0.983 Vali Acc: 0.467 Test Loss: 0.983 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 40 cost time: 1.1792776584625244
Epoch: 40, Steps: 1 | Train Loss: 0.118 Vali Loss: 0.982 Vali Acc: 0.467 Test Loss: 0.982 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 41 cost time: 0.7758126258850098
Epoch: 41, Steps: 1 | Train Loss: 0.107 Vali Loss: 0.981 Vali Acc: 0.467 Test Loss: 0.981 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 42 cost time: 1.1710643768310547
Epoch: 42, Steps: 1 | Train Loss: 0.107 Vali Loss: 0.979 Vali Acc: 0.467 Test Loss: 0.979 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 43 cost time: 1.0498008728027344
Epoch: 43, Steps: 1 | Train Loss: 0.075 Vali Loss: 0.978 Vali Acc: 0.467 Test Loss: 0.978 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 44 cost time: 1.2003021240234375
Epoch: 44, Steps: 1 | Train Loss: 0.095 Vali Loss: 0.977 Vali Acc: 0.467 Test Loss: 0.977 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 45 cost time: 1.2071776390075684
Epoch: 45, Steps: 1 | Train Loss: 0.105 Vali Loss: 0.976 Vali Acc: 0.467 Test Loss: 0.976 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 46 cost time: 0.9758429527282715
Epoch: 46, Steps: 1 | Train Loss: 0.074 Vali Loss: 0.975 Vali Acc: 0.533 Test Loss: 0.975 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 47 cost time: 1.3388900756835938
Epoch: 47, Steps: 1 | Train Loss: 0.069 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 48 cost time: 1.246286153793335
Epoch: 48, Steps: 1 | Train Loss: 0.071 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 49 cost time: 1.4085323810577393
Epoch: 49, Steps: 1 | Train Loss: 0.073 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 50 cost time: 1.2870337963104248
Epoch: 50, Steps: 1 | Train Loss: 0.063 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 51 cost time: 1.292621374130249
Epoch: 51, Steps: 1 | Train Loss: 0.060 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 52 cost time: 1.1944751739501953
Epoch: 52, Steps: 1 | Train Loss: 0.045 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 53 cost time: 0.9625329971313477
Epoch: 53, Steps: 1 | Train Loss: 0.054 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0555603504180908
Epoch: 54, Steps: 1 | Train Loss: 0.042 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 55 cost time: 1.3302178382873535
Epoch: 55, Steps: 1 | Train Loss: 0.042 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1515583992004395
Epoch: 56, Steps: 1 | Train Loss: 0.040 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 57 cost time: 1.2921483516693115
Epoch: 57, Steps: 1 | Train Loss: 0.029 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 58 cost time: 1.1954700946807861
Epoch: 58, Steps: 1 | Train Loss: 0.032 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 59 cost time: 1.1242895126342773
Epoch: 59, Steps: 1 | Train Loss: 0.031 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 60 cost time: 1.221972942352295
Epoch: 60, Steps: 1 | Train Loss: 0.033 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 61 cost time: 1.4050021171569824
Epoch: 61, Steps: 1 | Train Loss: 0.032 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.3149688243865967
Epoch: 62, Steps: 1 | Train Loss: 0.029 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.2928335666656494
Epoch: 63, Steps: 1 | Train Loss: 0.028 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.046598196029663
Epoch: 64, Steps: 1 | Train Loss: 0.025 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.6040680408477783
Epoch: 65, Steps: 1 | Train Loss: 0.029 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.486163854598999
Epoch: 66, Steps: 1 | Train Loss: 0.035 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.2466204166412354
Epoch: 67, Steps: 1 | Train Loss: 0.029 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 68 cost time: 1.5559780597686768
Epoch: 68, Steps: 1 | Train Loss: 0.025 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 69 cost time: 1.2830150127410889
Epoch: 69, Steps: 1 | Train Loss: 0.021 Vali Loss: 0.968 Vali Acc: 0.533 Test Loss: 0.968 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 70 cost time: 1.7304165363311768
Epoch: 70, Steps: 1 | Train Loss: 0.024 Vali Loss: 0.968 Vali Acc: 0.533 Test Loss: 0.968 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 71 cost time: 1.0969974994659424
Epoch: 71, Steps: 1 | Train Loss: 0.021 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 72 cost time: 1.201052188873291
Epoch: 72, Steps: 1 | Train Loss: 0.022 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 73 cost time: 1.2005615234375
Epoch: 73, Steps: 1 | Train Loss: 0.018 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 74 cost time: 1.3337256908416748
Epoch: 74, Steps: 1 | Train Loss: 0.017 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 75 cost time: 1.4000582695007324
Epoch: 75, Steps: 1 | Train Loss: 0.021 Vali Loss: 0.966 Vali Acc: 0.533 Test Loss: 0.966 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 76 cost time: 1.0406630039215088
Epoch: 76, Steps: 1 | Train Loss: 0.020 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.9010486602783203
Epoch: 77, Steps: 1 | Train Loss: 0.016 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.1783995628356934
Epoch: 78, Steps: 1 | Train Loss: 0.017 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.180518388748169
Epoch: 79, Steps: 1 | Train Loss: 0.014 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.2089817523956299
Epoch: 80, Steps: 1 | Train Loss: 0.016 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.3653452396392822
Epoch: 81, Steps: 1 | Train Loss: 0.013 Vali Loss: 0.968 Vali Acc: 0.533 Test Loss: 0.968 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.1256215572357178
Epoch: 82, Steps: 1 | Train Loss: 0.020 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 1.2490999698638916
Epoch: 83, Steps: 1 | Train Loss: 0.014 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 1.169571876525879
Epoch: 84, Steps: 1 | Train Loss: 0.017 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 1.3876230716705322
Epoch: 85, Steps: 1 | Train Loss: 0.014 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 36995
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9415857791900635
Epoch: 1, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.259 Vali Acc: 0.200 Test Loss: 1.259 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 1.0424025058746338
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.259 Vali Acc: 0.200 Test Loss: 1.259 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8656013011932373
Epoch: 3, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.260 Vali Acc: 0.200 Test Loss: 1.260 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1418631076812744
Epoch: 4, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7582182884216309
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.781851053237915
Epoch: 6, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.013077974319458
Epoch: 7, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7740778923034668
Epoch: 8, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.265 Vali Acc: 0.200 Test Loss: 1.265 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0246059894561768
Epoch: 9, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.266 Vali Acc: 0.200 Test Loss: 1.266 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9271798133850098
Epoch: 10, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.02773118019104
Epoch: 11, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm32_nh4_df64_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 39843
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.148115158081055
Epoch: 1, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0725452899932861
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9409821033477783
Epoch: 3, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9197142124176025
Epoch: 4, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.098238468170166
Epoch: 5, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.5398733615875244
Epoch: 6, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7168395519256592
Epoch: 7, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 1.2310688495635986
Epoch: 8, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.85111403465271
Epoch: 9, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 1.0184531211853027
Epoch: 10, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 1.009709119796753
Epoch: 11, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.9008924961090088
Epoch: 12, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.9859039783477783
Epoch: 13, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.0158860683441162
Epoch: 14, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.1056666374206543
Epoch: 15, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.8998832702636719
Epoch: 16, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 1.1973474025726318
Epoch: 17, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 1.070063591003418
Epoch: 18, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 1.0130493640899658
Epoch: 19, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.8277382850646973
Epoch: 20, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 1.086461067199707
Epoch: 21, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 1.4330642223358154
Epoch: 22, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.8747572898864746
Epoch: 23, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.9265201091766357
Epoch: 24, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 1.0253217220306396
Epoch: 25, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0351676940917969
Epoch: 26, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8108217716217041
Epoch: 27, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.111771583557129
Epoch: 28, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7245914936065674
Epoch: 29, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9628605842590332
Epoch: 30, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 0.7470557689666748
Epoch: 31, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3376870155334473
Epoch: 32, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0127627849578857
Epoch: 33, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.207181692123413
Epoch: 34, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 35 cost time: 0.9350202083587646
Epoch: 35, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7489521503448486
Epoch: 36, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8328437805175781
Epoch: 37, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1835994720458984
Epoch: 38, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.072115421295166
Epoch: 39, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9940474033355713
Epoch: 40, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.072124719619751
Epoch: 41, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1064260005950928
Epoch: 42, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0070505142211914
Epoch: 43, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9353930950164795
Epoch: 44, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 35251
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.781317710876465
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8105700016021729
Epoch: 2, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0157787799835205
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8787491321563721
Epoch: 4, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8114943504333496
Epoch: 5, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.06748366355896
Epoch: 6, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.078550100326538
Epoch: 7, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1423048973083496
Epoch: 8, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3348667621612549
Epoch: 9, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.399559736251831
Epoch: 10, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1786730289459229
Epoch: 11, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 28755
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9328787326812744
Epoch: 1, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7888338565826416
Epoch: 2, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.1051125526428223
Epoch: 3, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.9329302310943604
Epoch: 4, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.9411664009094238
Epoch: 5, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 1.3614439964294434
Epoch: 6, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 1.068490982055664
Epoch: 7, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 1.0195038318634033
Epoch: 8, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 1.0513677597045898
Epoch: 9, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 1.302114725112915
Epoch: 10, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.9162278175354004
Epoch: 11, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.9203081130981445
Epoch: 12, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.0003376007080078
Epoch: 13, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.9218509197235107
Epoch: 14, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 1.0473403930664062
Epoch: 15, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.9955148696899414
Epoch: 16, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 0.8979859352111816
Epoch: 17, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 18 cost time: 1.0492024421691895
Epoch: 18, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8562660217285156
Epoch: 19, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8114490509033203
Epoch: 20, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9050107002258301
Epoch: 21, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1117804050445557
Epoch: 22, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8652122020721436
Epoch: 23, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8201017379760742
Epoch: 24, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1478550434112549
Epoch: 25, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0578246116638184
Epoch: 26, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9342339038848877
Epoch: 27, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 27267
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.91705060005188
Epoch: 1, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8445887565612793
Epoch: 2, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.9410750865936279
Epoch: 3, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.7967309951782227
Epoch: 4, Steps: 1 | Train Loss: 1.366 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7690324783325195
Epoch: 5, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9327998161315918
Epoch: 6, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1008291244506836
Epoch: 7, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.170 Vali Acc: 0.133 Test Loss: 1.170 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.206068515777588
Epoch: 8, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.169 Vali Acc: 0.133 Test Loss: 1.169 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9291188716888428
Epoch: 9, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.168 Vali Acc: 0.133 Test Loss: 1.168 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.110447645187378
Epoch: 10, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.167 Vali Acc: 0.133 Test Loss: 1.167 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9807565212249756
Epoch: 11, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.166 Vali Acc: 0.133 Test Loss: 1.166 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9766552448272705
Epoch: 12, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.165 Vali Acc: 0.133 Test Loss: 1.165 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1034307479858398
Epoch: 13, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 27107
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.772566318511963
Epoch: 1, Steps: 1 | Train Loss: 1.332 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.1370515823364258
Epoch: 2, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.9740028381347656
Epoch: 3, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.1549570560455322
Epoch: 4, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.750481367111206
Epoch: 5, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.1247663497924805
Epoch: 6, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1876616477966309
Epoch: 7, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.9270370006561279
Epoch: 8, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2443137168884277
Epoch: 9, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2721691131591797
Epoch: 10, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6428847312927246
Epoch: 11, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0151827335357666
Epoch: 12, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2392911911010742
Epoch: 13, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9393115043640137
Epoch: 14, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1076796054840088
Epoch: 15, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1226065158843994
Epoch: 16, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9822781085968018
Epoch: 17, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 27763
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7439024448394775
Epoch: 1, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.293 Vali Acc: 0.333 Test Loss: 1.293 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.324126958847046
Epoch: 2, Steps: 1 | Train Loss: 1.256 Vali Loss: 1.286 Vali Acc: 0.333 Test Loss: 1.286 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.9063358306884766
Epoch: 3, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.9394760131835938
Epoch: 4, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.274 Vali Acc: 0.333 Test Loss: 1.274 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.9105291366577148
Epoch: 5, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 1.0588068962097168
Epoch: 6, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.8584079742431641
Epoch: 7, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.8880443572998047
Epoch: 8, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.779916524887085
Epoch: 9, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.7769815921783447
Epoch: 10, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.8375790119171143
Epoch: 11, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.9810566902160645
Epoch: 12, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.6383078098297119
Epoch: 13, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.7764439582824707
Epoch: 14, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.9397296905517578
Epoch: 15, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8711252212524414
Epoch: 16, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7936139106750488
Epoch: 17, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1421597003936768
Epoch: 18, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 0.8215396404266357
Epoch: 19, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 20 cost time: 0.920891523361206
Epoch: 20, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 21 cost time: 0.9923510551452637
Epoch: 21, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 22 cost time: 1.2472896575927734
Epoch: 22, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 23 cost time: 0.9894001483917236
Epoch: 23, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 24 cost time: 0.9022712707519531
Epoch: 24, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 25 cost time: 0.787522554397583
Epoch: 25, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 26 cost time: 1.153064489364624
Epoch: 26, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 27 cost time: 1.0960326194763184
Epoch: 27, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 28 cost time: 0.8586709499359131
Epoch: 28, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 29 cost time: 0.7990639209747314
Epoch: 29, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.179 Vali Acc: 0.467 Test Loss: 1.179 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 30 cost time: 0.6941483020782471
Epoch: 30, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.176 Vali Acc: 0.467 Test Loss: 1.176 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 31 cost time: 0.761937141418457
Epoch: 31, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.173 Vali Acc: 0.467 Test Loss: 1.173 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 32 cost time: 0.921405553817749
Epoch: 32, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 33 cost time: 0.8858809471130371
Epoch: 33, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 34 cost time: 1.2959849834442139
Epoch: 34, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 35 cost time: 1.0263524055480957
Epoch: 35, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 36 cost time: 0.9754416942596436
Epoch: 36, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 37 cost time: 0.9181616306304932
Epoch: 37, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 38 cost time: 0.9437384605407715
Epoch: 38, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 39 cost time: 1.1795439720153809
Epoch: 39, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 40 cost time: 0.8981130123138428
Epoch: 40, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 41 cost time: 0.8885910511016846
Epoch: 41, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 42 cost time: 0.9534609317779541
Epoch: 42, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 43 cost time: 1.350938081741333
Epoch: 43, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 44 cost time: 0.9129467010498047
Epoch: 44, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 45 cost time: 0.8872406482696533
Epoch: 45, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 46 cost time: 1.4453907012939453
Epoch: 46, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.150496244430542
Epoch: 47, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9642767906188965
Epoch: 48, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9691047668457031
Epoch: 49, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1011264324188232
Epoch: 50, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.062445878982544
Epoch: 51, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9849224090576172
Epoch: 52, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0487370491027832
Epoch: 53, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.9200067520141602
Epoch: 54, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.020106554031372
Epoch: 55, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 29187
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.699463129043579
Epoch: 1, Steps: 1 | Train Loss: 1.335 Vali Loss: 1.338 Vali Acc: 0.267 Test Loss: 1.338 Test Acc: 0.267
Validation loss decreased (inf --> -0.266653).  Saving model ...
Epoch: 2 cost time: 1.1136679649353027
Epoch: 2, Steps: 1 | Train Loss: 1.357 Vali Loss: 1.329 Vali Acc: 0.333 Test Loss: 1.329 Test Acc: 0.333
Validation loss decreased (-0.266653 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.9567322731018066
Epoch: 3, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.322 Vali Acc: 0.333 Test Loss: 1.322 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.9834394454956055
Epoch: 4, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 1.025097131729126
Epoch: 5, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.309 Vali Acc: 0.333 Test Loss: 1.309 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 0.8599908351898193
Epoch: 6, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 1.4516100883483887
Epoch: 7, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.301 Vali Acc: 0.333 Test Loss: 1.301 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 0.7625236511230469
Epoch: 8, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.297 Vali Acc: 0.333 Test Loss: 1.297 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 9 cost time: 1.2289044857025146
Epoch: 9, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.293 Vali Acc: 0.333 Test Loss: 1.293 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 1.0144433975219727
Epoch: 10, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 11 cost time: 1.1477689743041992
Epoch: 11, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.286 Vali Acc: 0.333 Test Loss: 1.286 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 12 cost time: 0.8819828033447266
Epoch: 12, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.283 Vali Acc: 0.333 Test Loss: 1.283 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 1.0516784191131592
Epoch: 13, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 1.01177978515625
Epoch: 14, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 1.2667791843414307
Epoch: 15, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.276 Vali Acc: 0.333 Test Loss: 1.276 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 1.4484813213348389
Epoch: 16, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.9252123832702637
Epoch: 17, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 1.080394983291626
Epoch: 18, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 1.1996667385101318
Epoch: 19, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 20 cost time: 0.9180517196655273
Epoch: 20, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 21 cost time: 1.2311184406280518
Epoch: 21, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 22 cost time: 0.795468807220459
Epoch: 22, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 23 cost time: 1.1220879554748535
Epoch: 23, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 24 cost time: 0.9160332679748535
Epoch: 24, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 25 cost time: 1.211890459060669
Epoch: 25, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.257 Vali Acc: 0.333 Test Loss: 1.257 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 26 cost time: 1.1687850952148438
Epoch: 26, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 27 cost time: 1.0386989116668701
Epoch: 27, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 28 cost time: 1.346268653869629
Epoch: 28, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2085545063018799
Epoch: 29, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9986310005187988
Epoch: 30, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2226593494415283
Epoch: 31, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9589130878448486
Epoch: 32, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.523090124130249
Epoch: 33, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3100817203521729
Epoch: 34, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 35 cost time: 1.1086034774780273
Epoch: 35, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 36 cost time: 1.2685372829437256
Epoch: 36, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 37 cost time: 1.1867351531982422
Epoch: 37, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 38 cost time: 1.3051483631134033
Epoch: 38, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 39 cost time: 0.8799424171447754
Epoch: 39, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 40 cost time: 1.0759503841400146
Epoch: 40, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 41 cost time: 1.2717125415802002
Epoch: 41, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2718989849090576
Epoch: 42, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.188300609588623
Epoch: 43, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.032715082168579
Epoch: 44, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2059993743896484
Epoch: 45, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0764799118041992
Epoch: 46, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.6093120574951172
Epoch: 47, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.4525456428527832
Epoch: 48, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8722801208496094
Epoch: 49, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.8007171154022217
Epoch: 50, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df256_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 30611
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.480018377304077
Epoch: 1, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 1.1324787139892578
Epoch: 2, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.1403203010559082
Epoch: 3, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.975461483001709
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9398400783538818
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.9403762817382812
Epoch: 6, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 1.0657272338867188
Epoch: 7, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 1.2497045993804932
Epoch: 8, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0333142280578613
Epoch: 9, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8920652866363525
Epoch: 10, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0060539245605469
Epoch: 11, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1049885749816895
Epoch: 12, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2263882160186768
Epoch: 13, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0081100463867188
Epoch: 14, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2255017757415771
Epoch: 15, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8852236270904541
Epoch: 16, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1517274379730225
Epoch: 17, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 26803
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.433598041534424
Epoch: 1, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.4080805778503418
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.9963405132293701
Epoch: 3, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 1.023488998413086
Epoch: 4, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.98797607421875
Epoch: 5, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 1.338097095489502
Epoch: 6, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 1.489074468612671
Epoch: 7, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.8810327053070068
Epoch: 8, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 1.454392910003662
Epoch: 9, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 1.2041044235229492
Epoch: 10, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1311984062194824
Epoch: 11, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0114929676055908
Epoch: 12, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0046663284301758
Epoch: 13, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.215203046798706
Epoch: 14, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3597629070281982
Epoch: 15, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2517011165618896
Epoch: 16, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0271592140197754
Epoch: 17, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9859485626220703
Epoch: 18, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0507616996765137
Epoch: 19, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 20307
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.530032157897949
Epoch: 1, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 1.27323579788208
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.175 Vali Acc: 0.467 Test Loss: 1.175 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.9744234085083008
Epoch: 3, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 1.9359476566314697
Epoch: 4, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.746455192565918
Epoch: 5, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 1.1855826377868652
Epoch: 6, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 1.0892574787139893
Epoch: 7, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9621090888977051
Epoch: 8, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9519975185394287
Epoch: 9, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9745171070098877
Epoch: 10, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0269556045532227
Epoch: 11, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1161613464355469
Epoch: 12, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8744544982910156
Epoch: 13, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1757607460021973
Epoch: 14, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9655160903930664
Epoch: 15, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3765931129455566
Epoch: 16, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 18819
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.381155014038086
Epoch: 1, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.3721516132354736
Epoch: 2, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.3457036018371582
Epoch: 3, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.2942924499511719
Epoch: 4, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.1122634410858154
Epoch: 5, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.8604767322540283
Epoch: 6, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 1.2458171844482422
Epoch: 7, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 1.3349473476409912
Epoch: 8, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.9776179790496826
Epoch: 9, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 1.086071491241455
Epoch: 10, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.8991196155548096
Epoch: 11, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 1.7968964576721191
Epoch: 12, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.8887040615081787
Epoch: 13, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 1.5098440647125244
Epoch: 14, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 1.8072984218597412
Epoch: 15, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 1.019850492477417
Epoch: 16, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.9191133975982666
Epoch: 17, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.1901581287384033
Epoch: 18, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 1.1145284175872803
Epoch: 19, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.9187133312225342
Epoch: 20, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 1.0388643741607666
Epoch: 21, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 1.1458725929260254
Epoch: 22, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 1.3478477001190186
Epoch: 23, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 1.2324249744415283
Epoch: 24, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 1.2041921615600586
Epoch: 25, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 1.5095446109771729
Epoch: 26, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 1.1730937957763672
Epoch: 27, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 1.1637182235717773
Epoch: 28, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 1.338329792022705
Epoch: 29, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 1.4580910205841064
Epoch: 30, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 1.1781537532806396
Epoch: 31, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 32 cost time: 1.219430685043335
Epoch: 32, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 33 cost time: 1.2251570224761963
Epoch: 33, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 34 cost time: 1.926652431488037
Epoch: 34, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 35 cost time: 1.2468059062957764
Epoch: 35, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 36 cost time: 1.1359953880310059
Epoch: 36, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 37 cost time: 0.9164454936981201
Epoch: 37, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 38 cost time: 0.9424736499786377
Epoch: 38, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 39 cost time: 1.2809150218963623
Epoch: 39, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1606247425079346
Epoch: 40, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 41 cost time: 1.0019309520721436
Epoch: 41, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0035405158996582
Epoch: 42, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2306435108184814
Epoch: 43, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1337742805480957
Epoch: 44, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.079864740371704
Epoch: 45, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.038191795349121
Epoch: 46, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9123797416687012
Epoch: 47, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0762596130371094
Epoch: 48, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9530010223388672
Epoch: 49, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.0554625988006592
Epoch: 50, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 18659
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.070817470550537
Epoch: 1, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.0677227973937988
Epoch: 2, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.1720423698425293
Epoch: 3, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 1.2619819641113281
Epoch: 4, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 1.1742324829101562
Epoch: 5, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 1.3036446571350098
Epoch: 6, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 1.4262568950653076
Epoch: 7, Steps: 1 | Train Loss: 1.334 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 1.4460077285766602
Epoch: 8, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 1.1148078441619873
Epoch: 9, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 1.1488239765167236
Epoch: 10, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.057 Vali Acc: 0.600 Test Loss: 1.057 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 1.1025633811950684
Epoch: 11, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.9787445068359375
Epoch: 12, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 1.0467987060546875
Epoch: 13, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.050 Vali Acc: 0.600 Test Loss: 1.050 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 1.0013787746429443
Epoch: 14, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 1.1280243396759033
Epoch: 15, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 1.445002794265747
Epoch: 16, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 17 cost time: 1.3529934883117676
Epoch: 17, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 1.536520004272461
Epoch: 18, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.517735481262207
Epoch: 19, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.458622932434082
Epoch: 20, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.057837724685669
Epoch: 21, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0849285125732422
Epoch: 22, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1592330932617188
Epoch: 23, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2002060413360596
Epoch: 24, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1306188106536865
Epoch: 25, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9382138252258301
Epoch: 26, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2764580249786377
Epoch: 27, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 19315
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.951461315155029
Epoch: 1, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.6030082702636719
Epoch: 2, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.0275349617004395
Epoch: 3, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.9207088947296143
Epoch: 4, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9285762310028076
Epoch: 5, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.0185489654541016
Epoch: 6, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 1.141977310180664
Epoch: 7, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9428894519805908
Epoch: 8, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 1.3110275268554688
Epoch: 9, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 1.013326644897461
Epoch: 10, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 1.144132137298584
Epoch: 11, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 1.1245923042297363
Epoch: 12, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 1.2092900276184082
Epoch: 13, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 1.6030449867248535
Epoch: 14, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 1.3852119445800781
Epoch: 15, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 1.0528802871704102
Epoch: 16, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.9294540882110596
Epoch: 17, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.45137619972229
Epoch: 18, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 1.112912893295288
Epoch: 19, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 1.0880038738250732
Epoch: 20, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 1.022111415863037
Epoch: 21, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.9441041946411133
Epoch: 22, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.8007690906524658
Epoch: 23, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 1.2371699810028076
Epoch: 24, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 1.029937505722046
Epoch: 25, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 1.4344580173492432
Epoch: 26, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 1.3030805587768555
Epoch: 27, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.9525964260101318
Epoch: 28, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 1.073204517364502
Epoch: 29, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 1.09222412109375
Epoch: 30, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 1.8164489269256592
Epoch: 31, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 32 cost time: 0.9914767742156982
Epoch: 32, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 33 cost time: 1.3010244369506836
Epoch: 33, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 34 cost time: 1.0889697074890137
Epoch: 34, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 35 cost time: 1.0414271354675293
Epoch: 35, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 36 cost time: 1.4264912605285645
Epoch: 36, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 37 cost time: 1.4413490295410156
Epoch: 37, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 38 cost time: 1.2697784900665283
Epoch: 38, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 39 cost time: 1.164923906326294
Epoch: 39, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 40 cost time: 0.9885358810424805
Epoch: 40, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 41 cost time: 1.1371583938598633
Epoch: 41, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 42 cost time: 0.9040694236755371
Epoch: 42, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 43 cost time: 0.8570530414581299
Epoch: 43, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 44 cost time: 1.1931312084197998
Epoch: 44, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 45 cost time: 1.0347900390625
Epoch: 45, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 46 cost time: 1.1636021137237549
Epoch: 46, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 47 cost time: 1.184417486190796
Epoch: 47, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 48 cost time: 1.2603726387023926
Epoch: 48, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1759428977966309
Epoch: 49, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2505762577056885
Epoch: 50, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1757261753082275
Epoch: 51, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.9724521636962891
Epoch: 52, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.2706408500671387
Epoch: 53, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.2246756553649902
Epoch: 54, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.2766811847686768
Epoch: 55, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 56 cost time: 0.9257853031158447
Epoch: 56, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1228222846984863
Epoch: 57, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9019608497619629
Epoch: 58, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.4608087539672852
Epoch: 59, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.0543513298034668
Epoch: 60, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.058349847793579
Epoch: 61, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.9940900802612305
Epoch: 62, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.107558012008667
Epoch: 63, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.7267599105834961
Epoch: 64, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.8922350406646729
Epoch: 65, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 20739
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.046979665756226
Epoch: 1, Steps: 1 | Train Loss: 1.348 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.0514979362487793
Epoch: 2, Steps: 1 | Train Loss: 1.340 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.221954107284546
Epoch: 3, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.9791233539581299
Epoch: 4, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 1.4592831134796143
Epoch: 5, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.8956866264343262
Epoch: 6, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 1.076939344406128
Epoch: 7, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1292967796325684
Epoch: 8, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4436824321746826
Epoch: 9, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4616663455963135
Epoch: 10, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2418091297149658
Epoch: 11, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 1.2971327304840088
Epoch: 12, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 1.0115830898284912
Epoch: 13, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 1.2761270999908447
Epoch: 14, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 1.0167961120605469
Epoch: 15, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 1.517976999282837
Epoch: 16, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.9277162551879883
Epoch: 17, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.9404892921447754
Epoch: 18, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 1.0620782375335693
Epoch: 19, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 1.470332384109497
Epoch: 20, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 1.0203242301940918
Epoch: 21, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 1.0960266590118408
Epoch: 22, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 1.2850866317749023
Epoch: 23, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 24 cost time: 0.9636733531951904
Epoch: 24, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 25 cost time: 1.069575309753418
Epoch: 25, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 26 cost time: 1.0656657218933105
Epoch: 26, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 27 cost time: 1.2317626476287842
Epoch: 27, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 28 cost time: 1.48463773727417
Epoch: 28, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 1.175858497619629
Epoch: 29, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 30 cost time: 1.181697130203247
Epoch: 30, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 31 cost time: 1.0446486473083496
Epoch: 31, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0597167015075684
Epoch: 32, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0786550045013428
Epoch: 33, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.000551462173462
Epoch: 34, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.075411081314087
Epoch: 35, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.442533254623413
Epoch: 36, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2234995365142822
Epoch: 37, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1968328952789307
Epoch: 38, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.37546968460083
Epoch: 39, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3451526165008545
Epoch: 40, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df128_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 22163
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.912723779678345
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.051959753036499
Epoch: 2, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.0304944515228271
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 1.1909880638122559
Epoch: 4, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 1.030236005783081
Epoch: 5, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 1.6385564804077148
Epoch: 6, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 1.5217645168304443
Epoch: 7, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 1.294842004776001
Epoch: 8, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 1.0460598468780518
Epoch: 9, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 1.1759910583496094
Epoch: 10, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 1.2321817874908447
Epoch: 11, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 1.2101476192474365
Epoch: 12, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 1.0660219192504883
Epoch: 13, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.2493317127227783
Epoch: 14, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.9099931716918945
Epoch: 15, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 1.1188774108886719
Epoch: 16, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.9634935855865479
Epoch: 17, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 18 cost time: 1.0411643981933594
Epoch: 18, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 19 cost time: 1.1204259395599365
Epoch: 19, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.8497984409332275
Epoch: 20, Steps: 1 | Train Loss: 0.495 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 1.3832926750183105
Epoch: 21, Steps: 1 | Train Loss: 0.482 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.983619213104248
Epoch: 22, Steps: 1 | Train Loss: 0.498 Vali Loss: 0.983 Vali Acc: 0.533 Test Loss: 0.983 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533324).  Saving model ...
Epoch: 23 cost time: 1.2805376052856445
Epoch: 23, Steps: 1 | Train Loss: 0.440 Vali Loss: 0.976 Vali Acc: 0.467 Test Loss: 0.976 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3173842430114746
Epoch: 24, Steps: 1 | Train Loss: 0.410 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 25 cost time: 1.1800258159637451
Epoch: 25, Steps: 1 | Train Loss: 0.459 Vali Loss: 0.963 Vali Acc: 0.533 Test Loss: 0.963 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 26 cost time: 1.0559585094451904
Epoch: 26, Steps: 1 | Train Loss: 0.378 Vali Loss: 0.956 Vali Acc: 0.533 Test Loss: 0.956 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 27 cost time: 0.9726948738098145
Epoch: 27, Steps: 1 | Train Loss: 0.314 Vali Loss: 0.951 Vali Acc: 0.533 Test Loss: 0.951 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 28 cost time: 1.126713752746582
Epoch: 28, Steps: 1 | Train Loss: 0.338 Vali Loss: 0.946 Vali Acc: 0.533 Test Loss: 0.946 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 29 cost time: 1.1428239345550537
Epoch: 29, Steps: 1 | Train Loss: 0.267 Vali Loss: 0.942 Vali Acc: 0.533 Test Loss: 0.942 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 30 cost time: 1.2021868228912354
Epoch: 30, Steps: 1 | Train Loss: 0.264 Vali Loss: 0.940 Vali Acc: 0.533 Test Loss: 0.940 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 31 cost time: 1.0520923137664795
Epoch: 31, Steps: 1 | Train Loss: 0.185 Vali Loss: 0.936 Vali Acc: 0.467 Test Loss: 0.936 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7265896797180176
Epoch: 32, Steps: 1 | Train Loss: 0.192 Vali Loss: 0.934 Vali Acc: 0.400 Test Loss: 0.934 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8468363285064697
Epoch: 33, Steps: 1 | Train Loss: 0.182 Vali Loss: 0.932 Vali Acc: 0.467 Test Loss: 0.932 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3796584606170654
Epoch: 34, Steps: 1 | Train Loss: 0.159 Vali Loss: 0.931 Vali Acc: 0.467 Test Loss: 0.931 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1484651565551758
Epoch: 35, Steps: 1 | Train Loss: 0.144 Vali Loss: 0.932 Vali Acc: 0.467 Test Loss: 0.932 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1108148097991943
Epoch: 36, Steps: 1 | Train Loss: 0.109 Vali Loss: 0.935 Vali Acc: 0.467 Test Loss: 0.935 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1225032806396484
Epoch: 37, Steps: 1 | Train Loss: 0.118 Vali Loss: 0.936 Vali Acc: 0.467 Test Loss: 0.936 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0942432880401611
Epoch: 38, Steps: 1 | Train Loss: 0.102 Vali Loss: 0.937 Vali Acc: 0.467 Test Loss: 0.937 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9177279472351074
Epoch: 39, Steps: 1 | Train Loss: 0.091 Vali Loss: 0.936 Vali Acc: 0.467 Test Loss: 0.936 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.347618579864502
Epoch: 40, Steps: 1 | Train Loss: 0.076 Vali Loss: 0.935 Vali Acc: 0.467 Test Loss: 0.935 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 22579
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.521643400192261
Epoch: 1, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.0128872394561768
Epoch: 2, Steps: 1 | Train Loss: 1.349 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.1668009757995605
Epoch: 3, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.947833776473999
Epoch: 4, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.0983500480651855
Epoch: 5, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.0512571334838867
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 1.2836694717407227
Epoch: 7, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0822019577026367
Epoch: 8, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2600951194763184
Epoch: 9, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3267779350280762
Epoch: 10, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0945014953613281
Epoch: 11, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.8598682880401611
Epoch: 12, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.1970758438110352
Epoch: 13, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.178368091583252
Epoch: 14, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.0483782291412354
Epoch: 15, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.9128315448760986
Epoch: 16, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.9614512920379639
Epoch: 17, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1797537803649902
Epoch: 18, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2242772579193115
Epoch: 19, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3395640850067139
Epoch: 20, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5852272510528564
Epoch: 21, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.158139944076538
Epoch: 22, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.164149284362793
Epoch: 23, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2894351482391357
Epoch: 24, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4908461570739746
Epoch: 25, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0747463703155518
Epoch: 26, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 16083
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.44903564453125
Epoch: 1, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 1.4213075637817383
Epoch: 2, Steps: 1 | Train Loss: 1.297 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 1.0904510021209717
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.9597961902618408
Epoch: 4, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.9015569686889648
Epoch: 5, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 1.2425949573516846
Epoch: 6, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1261067390441895
Epoch: 7, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9832210540771484
Epoch: 8, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0750513076782227
Epoch: 9, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.09427809715271
Epoch: 10, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9313781261444092
Epoch: 11, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.514359474182129
Epoch: 12, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 1.1661579608917236
Epoch: 13, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 1.210874319076538
Epoch: 14, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 1.066955804824829
Epoch: 15, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1075613498687744
Epoch: 16, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9138333797454834
Epoch: 17, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2050697803497314
Epoch: 18, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.056396484375
Epoch: 19, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2666606903076172
Epoch: 20, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1559209823608398
Epoch: 21, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 22 cost time: 1.2856614589691162
Epoch: 22, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 23 cost time: 1.3394014835357666
Epoch: 23, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 24 cost time: 0.9639840126037598
Epoch: 24, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 25 cost time: 0.9549002647399902
Epoch: 25, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 26 cost time: 0.9214792251586914
Epoch: 26, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 27 cost time: 0.8907461166381836
Epoch: 27, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 28 cost time: 1.1605401039123535
Epoch: 28, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 29 cost time: 1.2481889724731445
Epoch: 29, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 30 cost time: 1.436946153640747
Epoch: 30, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 31 cost time: 1.1050841808319092
Epoch: 31, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 32 cost time: 1.1490600109100342
Epoch: 32, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 33 cost time: 1.081989049911499
Epoch: 33, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 34 cost time: 0.9730021953582764
Epoch: 34, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 35 cost time: 1.3196954727172852
Epoch: 35, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 36 cost time: 1.2036540508270264
Epoch: 36, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 37 cost time: 0.9841277599334717
Epoch: 37, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 38 cost time: 1.0475993156433105
Epoch: 38, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.172 Vali Acc: 0.467 Test Loss: 1.172 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 39 cost time: 0.9675142765045166
Epoch: 39, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 40 cost time: 0.8192248344421387
Epoch: 40, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.164 Vali Acc: 0.533 Test Loss: 1.164 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 41 cost time: 0.9688925743103027
Epoch: 41, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.160 Vali Acc: 0.533 Test Loss: 1.160 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 42 cost time: 1.106917142868042
Epoch: 42, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.156 Vali Acc: 0.533 Test Loss: 1.156 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 43 cost time: 1.7537009716033936
Epoch: 43, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.152 Vali Acc: 0.533 Test Loss: 1.152 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 44 cost time: 1.4760756492614746
Epoch: 44, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.148 Vali Acc: 0.533 Test Loss: 1.148 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 45 cost time: 1.423760175704956
Epoch: 45, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.145 Vali Acc: 0.533 Test Loss: 1.145 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 46 cost time: 0.7859137058258057
Epoch: 46, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.141 Vali Acc: 0.533 Test Loss: 1.141 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 47 cost time: 1.1943881511688232
Epoch: 47, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.138 Vali Acc: 0.533 Test Loss: 1.138 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 48 cost time: 1.5670967102050781
Epoch: 48, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.136 Vali Acc: 0.533 Test Loss: 1.136 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 49 cost time: 0.933189868927002
Epoch: 49, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 50 cost time: 1.158116340637207
Epoch: 50, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.132 Vali Acc: 0.533 Test Loss: 1.132 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 51 cost time: 1.4817297458648682
Epoch: 51, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 52 cost time: 1.333242654800415
Epoch: 52, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 53 cost time: 0.9211711883544922
Epoch: 53, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 54 cost time: 1.4669132232666016
Epoch: 54, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 55 cost time: 1.130267858505249
Epoch: 55, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 56 cost time: 1.1837239265441895
Epoch: 56, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 57 cost time: 1.4008162021636963
Epoch: 57, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 58 cost time: 1.277946949005127
Epoch: 58, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 59 cost time: 1.6305885314941406
Epoch: 59, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.132181167602539
Epoch: 60, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.992401123046875
Epoch: 61, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.599121332168579
Epoch: 62, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.008453130722046
Epoch: 63, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.9926872253417969
Epoch: 64, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.213674783706665
Epoch: 65, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.3078842163085938
Epoch: 66, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.0958211421966553
Epoch: 67, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 2.003190040588379
Epoch: 68, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14595
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.135358095169067
Epoch: 1, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.1525683403015137
Epoch: 2, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2032642364501953
Epoch: 3, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1017017364501953
Epoch: 4, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8442890644073486
Epoch: 5, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1126224994659424
Epoch: 6, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1680636405944824
Epoch: 7, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1035869121551514
Epoch: 8, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2469432353973389
Epoch: 9, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.482419490814209
Epoch: 10, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1441974639892578
Epoch: 11, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 14435
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.17251443862915
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.1725788116455078
Epoch: 2, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1448583602905273
Epoch: 3, Steps: 1 | Train Loss: 1.331 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1723244190216064
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2587916851043701
Epoch: 5, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3407652378082275
Epoch: 6, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.255 Vali Acc: 0.400 Test Loss: 1.255 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.1575636863708496
Epoch: 7, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.257 Vali Acc: 0.400 Test Loss: 1.257 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1033084392547607
Epoch: 8, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.259 Vali Acc: 0.400 Test Loss: 1.259 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.435530662536621
Epoch: 9, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1569674015045166
Epoch: 10, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.263 Vali Acc: 0.400 Test Loss: 1.263 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2727117538452148
Epoch: 11, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.167158842086792
Epoch: 12, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1190085411071777
Epoch: 13, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.268 Vali Acc: 0.400 Test Loss: 1.268 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1314287185668945
Epoch: 14, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9572529792785645
Epoch: 15, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0039029121398926
Epoch: 16, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 15091
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.297717332839966
Epoch: 1, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 1.1622719764709473
Epoch: 2, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.149 Vali Acc: 0.533 Test Loss: 1.149 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 1.302018165588379
Epoch: 3, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9515669345855713
Epoch: 4, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1051127910614014
Epoch: 5, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 1.1976678371429443
Epoch: 6, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0734920501708984
Epoch: 7, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.106339693069458
Epoch: 8, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.030799388885498
Epoch: 9, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2984004020690918
Epoch: 10, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 1.0961627960205078
Epoch: 11, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9887359142303467
Epoch: 12, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.154430627822876
Epoch: 13, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3778328895568848
Epoch: 14, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0521996021270752
Epoch: 15, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.291926383972168
Epoch: 16, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.128 Vali Acc: 0.533 Test Loss: 1.128 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9645175933837891
Epoch: 17, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0759000778198242
Epoch: 18, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.061894178390503
Epoch: 19, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.132 Vali Acc: 0.533 Test Loss: 1.132 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3168549537658691
Epoch: 20, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.133 Vali Acc: 0.533 Test Loss: 1.133 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 16515
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.104431629180908
Epoch: 1, Steps: 1 | Train Loss: 1.292 Vali Loss: 1.552 Vali Acc: 0.333 Test Loss: 1.552 Test Acc: 0.333
Validation loss decreased (inf --> -0.333318).  Saving model ...
Epoch: 2 cost time: 1.2007017135620117
Epoch: 2, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.523 Vali Acc: 0.333 Test Loss: 1.523 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333318).  Saving model ...
Epoch: 3 cost time: 1.0094285011291504
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.497 Vali Acc: 0.333 Test Loss: 1.497 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333318).  Saving model ...
Epoch: 4 cost time: 0.9738638401031494
Epoch: 4, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.473 Vali Acc: 0.333 Test Loss: 1.473 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 1.1881189346313477
Epoch: 5, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.453 Vali Acc: 0.333 Test Loss: 1.453 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 6 cost time: 1.3335998058319092
Epoch: 6, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.437 Vali Acc: 0.333 Test Loss: 1.437 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 7 cost time: 1.0164144039154053
Epoch: 7, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.422 Vali Acc: 0.333 Test Loss: 1.422 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 8 cost time: 1.2000925540924072
Epoch: 8, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.409 Vali Acc: 0.333 Test Loss: 1.409 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 9 cost time: 0.8726298809051514
Epoch: 9, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.397 Vali Acc: 0.333 Test Loss: 1.397 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 10 cost time: 1.3145902156829834
Epoch: 10, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.387 Vali Acc: 0.333 Test Loss: 1.387 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 11 cost time: 1.440272331237793
Epoch: 11, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.377 Vali Acc: 0.333 Test Loss: 1.377 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 12 cost time: 1.1835086345672607
Epoch: 12, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.368 Vali Acc: 0.400 Test Loss: 1.368 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399986).  Saving model ...
Epoch: 13 cost time: 1.3647496700286865
Epoch: 13, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.360 Vali Acc: 0.400 Test Loss: 1.360 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 14 cost time: 1.0866165161132812
Epoch: 14, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.351 Vali Acc: 0.333 Test Loss: 1.351 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8955883979797363
Epoch: 15, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.343 Vali Acc: 0.400 Test Loss: 1.343 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 16 cost time: 1.1812469959259033
Epoch: 16, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.336 Vali Acc: 0.333 Test Loss: 1.336 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3398191928863525
Epoch: 17, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.329 Vali Acc: 0.333 Test Loss: 1.329 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2110095024108887
Epoch: 18, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.322 Vali Acc: 0.333 Test Loss: 1.322 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3261935710906982
Epoch: 19, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.334153413772583
Epoch: 20, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.309 Vali Acc: 0.333 Test Loss: 1.309 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0639064311981201
Epoch: 21, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.062140703201294
Epoch: 22, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.297 Vali Acc: 0.267 Test Loss: 1.297 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3959853649139404
Epoch: 23, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2967007160186768
Epoch: 24, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.279376745223999
Epoch: 25, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el2_dm16_nh4_df64_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 17939
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.631402254104614
Epoch: 1, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.2696702480316162
Epoch: 2, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.145759105682373
Epoch: 3, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9982678890228271
Epoch: 4, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.022838830947876
Epoch: 5, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2537448406219482
Epoch: 6, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0551209449768066
Epoch: 7, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 1.0340156555175781
Epoch: 8, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.021 Vali Acc: 0.400 Test Loss: 1.021 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1035656929016113
Epoch: 9, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.008 Vali Acc: 0.400 Test Loss: 1.008 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8580930233001709
Epoch: 10, Steps: 1 | Train Loss: 0.293 Vali Loss: 0.990 Vali Acc: 0.400 Test Loss: 0.990 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.372422456741333
Epoch: 11, Steps: 1 | Train Loss: 0.174 Vali Loss: 0.979 Vali Acc: 0.400 Test Loss: 0.979 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.277334213256836
Epoch: 12, Steps: 1 | Train Loss: 0.128 Vali Loss: 0.982 Vali Acc: 0.533 Test Loss: 0.982 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533324).  Saving model ...
Epoch: 13 cost time: 1.071577548980713
Epoch: 13, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.460930585861206
Epoch: 14, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1643784046173096
Epoch: 15, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0449683666229248
Epoch: 16, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1609127521514893
Epoch: 17, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8980233669281006
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.056074857711792
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8827629089355469
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8077661991119385
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9439105987548828
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 260611
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.947845220565796
Epoch: 1, Steps: 1 | Train Loss: 1.394 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.3760654926300049
Epoch: 2, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.2319221496582031
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.1562108993530273
Epoch: 4, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.3189163208007812
Epoch: 5, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.9682581424713135
Epoch: 6, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.8875045776367188
Epoch: 7, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0718462467193604
Epoch: 8, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9288525581359863
Epoch: 9, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1150085926055908
Epoch: 10, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6123971939086914
Epoch: 11, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.8789687156677246
Epoch: 12, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 1.046466588973999
Epoch: 13, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.9241249561309814
Epoch: 14, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 1.134993553161621
Epoch: 15, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5837810039520264
Epoch: 16, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.12593674659729
Epoch: 17, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.11006760597229
Epoch: 18, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3956058025360107
Epoch: 19, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4549446105957031
Epoch: 20, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8152749538421631
Epoch: 21, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2549519538879395
Epoch: 22, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 1.1636035442352295
Epoch: 23, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3929154872894287
Epoch: 24, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3657701015472412
Epoch: 25, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4492526054382324
Epoch: 26, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.54512357711792
Epoch: 27, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.246 Vali Acc: 0.467 Test Loss: 1.246 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3545112609863281
Epoch: 28, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.258 Vali Acc: 0.467 Test Loss: 1.258 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0927987098693848
Epoch: 29, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.270 Vali Acc: 0.467 Test Loss: 1.270 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0095915794372559
Epoch: 30, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.282 Vali Acc: 0.467 Test Loss: 1.282 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1632041931152344
Epoch: 31, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.467 Test Loss: 1.293 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6320068836212158
Epoch: 32, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.304 Vali Acc: 0.467 Test Loss: 1.304 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 208643
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9594461917877197
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.398 Vali Acc: 0.333 Test Loss: 1.398 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 1.1226117610931396
Epoch: 2, Steps: 1 | Train Loss: 1.305 Vali Loss: 1.380 Vali Acc: 0.333 Test Loss: 1.380 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 1.0119431018829346
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.364 Vali Acc: 0.333 Test Loss: 1.364 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.8075566291809082
Epoch: 4, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.349 Vali Acc: 0.333 Test Loss: 1.349 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 1.2337892055511475
Epoch: 5, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.336 Vali Acc: 0.333 Test Loss: 1.336 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 0.8591992855072021
Epoch: 6, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.324 Vali Acc: 0.333 Test Loss: 1.324 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 0.8508973121643066
Epoch: 7, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 0.9915063381195068
Epoch: 8, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.306 Vali Acc: 0.333 Test Loss: 1.306 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 9 cost time: 0.8272643089294434
Epoch: 9, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.301 Vali Acc: 0.333 Test Loss: 1.301 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 1.1572186946868896
Epoch: 10, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.299 Vali Acc: 0.333 Test Loss: 1.299 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 11 cost time: 1.2734286785125732
Epoch: 11, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.296 Vali Acc: 0.333 Test Loss: 1.296 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 12 cost time: 1.1069200038909912
Epoch: 12, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.292 Vali Acc: 0.333 Test Loss: 1.292 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 13 cost time: 0.9298050403594971
Epoch: 13, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.283 Vali Acc: 0.333 Test Loss: 1.283 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 1.2769091129302979
Epoch: 14, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 1.3457093238830566
Epoch: 15, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 16 cost time: 1.0611300468444824
Epoch: 16, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 17 cost time: 1.0776066780090332
Epoch: 17, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4375877380371094
Epoch: 18, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.268 Vali Acc: 0.400 Test Loss: 1.268 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1412866115570068
Epoch: 19, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4030613899230957
Epoch: 20, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.271 Vali Acc: 0.400 Test Loss: 1.271 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4880595207214355
Epoch: 21, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.271 Vali Acc: 0.400 Test Loss: 1.271 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5014073848724365
Epoch: 22, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.272 Vali Acc: 0.467 Test Loss: 1.272 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466654).  Saving model ...
Epoch: 23 cost time: 1.3718059062957764
Epoch: 23, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.277 Vali Acc: 0.467 Test Loss: 1.277 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0577702522277832
Epoch: 24, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.283 Vali Acc: 0.467 Test Loss: 1.283 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4962034225463867
Epoch: 25, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.289 Vali Acc: 0.533 Test Loss: 1.289 Test Acc: 0.533
Validation loss decreased (-0.466654 --> -0.533320).  Saving model ...
Epoch: 26 cost time: 1.0666592121124268
Epoch: 26, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.297 Vali Acc: 0.533 Test Loss: 1.297 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.193986415863037
Epoch: 27, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.304 Vali Acc: 0.533 Test Loss: 1.304 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.196047306060791
Epoch: 28, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.313 Vali Acc: 0.533 Test Loss: 1.313 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2220020294189453
Epoch: 29, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.321 Vali Acc: 0.533 Test Loss: 1.321 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2784810066223145
Epoch: 30, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.329 Vali Acc: 0.533 Test Loss: 1.329 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1582164764404297
Epoch: 31, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.339 Vali Acc: 0.533 Test Loss: 1.339 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.139761209487915
Epoch: 32, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.347 Vali Acc: 0.533 Test Loss: 1.347 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2503266334533691
Epoch: 33, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.356 Vali Acc: 0.533 Test Loss: 1.356 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3108594417572021
Epoch: 34, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.365 Vali Acc: 0.533 Test Loss: 1.365 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3232450485229492
Epoch: 35, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.373 Vali Acc: 0.533 Test Loss: 1.373 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 196739
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.931138515472412
Epoch: 1, Steps: 1 | Train Loss: 1.321 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 1.0395097732543945
Epoch: 2, Steps: 1 | Train Loss: 1.281 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 1.2095673084259033
Epoch: 3, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.2131075859069824
Epoch: 4, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.4842050075531006
Epoch: 5, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 6 cost time: 1.0870366096496582
Epoch: 6, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 7 cost time: 1.0831406116485596
Epoch: 7, Steps: 1 | Train Loss: 1.106 Vali Loss: 0.997 Vali Acc: 0.600 Test Loss: 0.997 Test Acc: 0.600
Validation loss decreased (-0.466657 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.9791228771209717
Epoch: 8, Steps: 1 | Train Loss: 0.931 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.9324018955230713
Epoch: 9, Steps: 1 | Train Loss: 0.758 Vali Loss: 0.982 Vali Acc: 0.667 Test Loss: 0.982 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 10 cost time: 0.8306164741516113
Epoch: 10, Steps: 1 | Train Loss: 0.710 Vali Loss: 0.975 Vali Acc: 0.667 Test Loss: 0.975 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 1.0295135974884033
Epoch: 11, Steps: 1 | Train Loss: 0.650 Vali Loss: 0.968 Vali Acc: 0.667 Test Loss: 0.968 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 12 cost time: 1.0276267528533936
Epoch: 12, Steps: 1 | Train Loss: 0.505 Vali Loss: 0.962 Vali Acc: 0.667 Test Loss: 0.962 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 13 cost time: 1.1708192825317383
Epoch: 13, Steps: 1 | Train Loss: 0.420 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.028679370880127
Epoch: 14, Steps: 1 | Train Loss: 0.351 Vali Loss: 0.950 Vali Acc: 0.600 Test Loss: 0.950 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0026700496673584
Epoch: 15, Steps: 1 | Train Loss: 0.369 Vali Loss: 0.947 Vali Acc: 0.600 Test Loss: 0.947 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.010096788406372
Epoch: 16, Steps: 1 | Train Loss: 0.236 Vali Loss: 0.945 Vali Acc: 0.600 Test Loss: 0.945 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8001043796539307
Epoch: 17, Steps: 1 | Train Loss: 0.221 Vali Loss: 0.943 Vali Acc: 0.600 Test Loss: 0.943 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2117550373077393
Epoch: 18, Steps: 1 | Train Loss: 0.134 Vali Loss: 0.944 Vali Acc: 0.600 Test Loss: 0.944 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9689819812774658
Epoch: 19, Steps: 1 | Train Loss: 0.109 Vali Loss: 0.944 Vali Acc: 0.600 Test Loss: 0.944 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0356049537658691
Epoch: 20, Steps: 1 | Train Loss: 0.071 Vali Loss: 0.946 Vali Acc: 0.600 Test Loss: 0.946 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1465506553649902
Epoch: 21, Steps: 1 | Train Loss: 0.080 Vali Loss: 0.953 Vali Acc: 0.600 Test Loss: 0.953 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2881979942321777
Epoch: 22, Steps: 1 | Train Loss: 0.060 Vali Loss: 0.960 Vali Acc: 0.600 Test Loss: 0.960 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 195459
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8110718727111816
Epoch: 1, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.9964432716369629
Epoch: 2, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.138505220413208
Epoch: 3, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.8128433227539062
Epoch: 4, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.2178630828857422
Epoch: 5, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.2535676956176758
Epoch: 6, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.6585888862609863
Epoch: 7, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 1.165595531463623
Epoch: 8, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 1.0252649784088135
Epoch: 9, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.010 Vali Acc: 0.400 Test Loss: 1.010 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9570615291595459
Epoch: 10, Steps: 1 | Train Loss: 0.870 Vali Loss: 0.998 Vali Acc: 0.333 Test Loss: 0.998 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4933078289031982
Epoch: 11, Steps: 1 | Train Loss: 0.663 Vali Loss: 0.986 Vali Acc: 0.400 Test Loss: 0.986 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7916152477264404
Epoch: 12, Steps: 1 | Train Loss: 0.524 Vali Loss: 0.974 Vali Acc: 0.600 Test Loss: 0.974 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.7813594341278076
Epoch: 13, Steps: 1 | Train Loss: 0.439 Vali Loss: 0.964 Vali Acc: 0.533 Test Loss: 0.964 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1098384857177734
Epoch: 14, Steps: 1 | Train Loss: 0.393 Vali Loss: 0.954 Vali Acc: 0.533 Test Loss: 0.954 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8572707176208496
Epoch: 15, Steps: 1 | Train Loss: 0.385 Vali Loss: 0.945 Vali Acc: 0.533 Test Loss: 0.945 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7986419200897217
Epoch: 16, Steps: 1 | Train Loss: 0.385 Vali Loss: 0.936 Vali Acc: 0.533 Test Loss: 0.936 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5902576446533203
Epoch: 17, Steps: 1 | Train Loss: 0.258 Vali Loss: 0.929 Vali Acc: 0.533 Test Loss: 0.929 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1664714813232422
Epoch: 18, Steps: 1 | Train Loss: 0.208 Vali Loss: 0.921 Vali Acc: 0.533 Test Loss: 0.921 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0602667331695557
Epoch: 19, Steps: 1 | Train Loss: 0.168 Vali Loss: 0.917 Vali Acc: 0.533 Test Loss: 0.917 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.040757656097412
Epoch: 20, Steps: 1 | Train Loss: 0.115 Vali Loss: 0.913 Vali Acc: 0.533 Test Loss: 0.913 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9529769420623779
Epoch: 21, Steps: 1 | Train Loss: 0.119 Vali Loss: 0.910 Vali Acc: 0.467 Test Loss: 0.910 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1698925495147705
Epoch: 22, Steps: 1 | Train Loss: 0.073 Vali Loss: 0.908 Vali Acc: 0.533 Test Loss: 0.908 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 200707
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.865727424621582
Epoch: 1, Steps: 1 | Train Loss: 1.350 Vali Loss: 1.411 Vali Acc: 0.333 Test Loss: 1.411 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 0.9786491394042969
Epoch: 2, Steps: 1 | Train Loss: 1.307 Vali Loss: 1.410 Vali Acc: 0.333 Test Loss: 1.410 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 1.2677693367004395
Epoch: 3, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.409 Vali Acc: 0.333 Test Loss: 1.409 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 4 cost time: 1.3974099159240723
Epoch: 4, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.408 Vali Acc: 0.333 Test Loss: 1.408 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 1.484330177307129
Epoch: 5, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.407 Vali Acc: 0.333 Test Loss: 1.407 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 6 cost time: 1.1876764297485352
Epoch: 6, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.406 Vali Acc: 0.333 Test Loss: 1.406 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 7 cost time: 1.5063776969909668
Epoch: 7, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.404 Vali Acc: 0.267 Test Loss: 1.404 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1813819408416748
Epoch: 8, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.401 Vali Acc: 0.267 Test Loss: 1.401 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8437943458557129
Epoch: 9, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.398 Vali Acc: 0.267 Test Loss: 1.398 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0216097831726074
Epoch: 10, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.393 Vali Acc: 0.200 Test Loss: 1.393 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0238726139068604
Epoch: 11, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.388 Vali Acc: 0.200 Test Loss: 1.388 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9517943859100342
Epoch: 12, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.383 Vali Acc: 0.200 Test Loss: 1.383 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9643940925598145
Epoch: 13, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.376 Vali Acc: 0.200 Test Loss: 1.376 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2404255867004395
Epoch: 14, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.370 Vali Acc: 0.200 Test Loss: 1.370 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.176501989364624
Epoch: 15, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.364 Vali Acc: 0.200 Test Loss: 1.364 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4153883457183838
Epoch: 16, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.357 Vali Acc: 0.200 Test Loss: 1.357 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 212099
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.789715766906738
Epoch: 1, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.409 Vali Acc: 0.267 Test Loss: 1.409 Test Acc: 0.267
Validation loss decreased (inf --> -0.266653).  Saving model ...
Epoch: 2 cost time: 1.1127164363861084
Epoch: 2, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.397 Vali Acc: 0.267 Test Loss: 1.397 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 3 cost time: 0.889704704284668
Epoch: 3, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.386 Vali Acc: 0.267 Test Loss: 1.386 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 4 cost time: 0.9348747730255127
Epoch: 4, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.377 Vali Acc: 0.267 Test Loss: 1.377 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 5 cost time: 1.0099833011627197
Epoch: 5, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.370 Vali Acc: 0.267 Test Loss: 1.370 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 6 cost time: 1.24637770652771
Epoch: 6, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.362 Vali Acc: 0.267 Test Loss: 1.362 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 7 cost time: 1.2422566413879395
Epoch: 7, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.355 Vali Acc: 0.267 Test Loss: 1.355 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 8 cost time: 1.0213890075683594
Epoch: 8, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.348 Vali Acc: 0.267 Test Loss: 1.348 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 9 cost time: 1.1689882278442383
Epoch: 9, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.343 Vali Acc: 0.267 Test Loss: 1.343 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 10 cost time: 1.3590774536132812
Epoch: 10, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.337 Vali Acc: 0.267 Test Loss: 1.337 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 11 cost time: 1.6054456233978271
Epoch: 11, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.332 Vali Acc: 0.267 Test Loss: 1.332 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 12 cost time: 1.0472729206085205
Epoch: 12, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.327 Vali Acc: 0.267 Test Loss: 1.327 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 13 cost time: 1.5333895683288574
Epoch: 13, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.322 Vali Acc: 0.267 Test Loss: 1.322 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 14 cost time: 1.1662769317626953
Epoch: 14, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.318 Vali Acc: 0.267 Test Loss: 1.318 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266653).  Saving model ...
Epoch: 15 cost time: 1.1994476318359375
Epoch: 15, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.314 Vali Acc: 0.267 Test Loss: 1.314 Test Acc: 0.267
Validation loss decreased (-0.266653 --> -0.266654).  Saving model ...
Epoch: 16 cost time: 0.930429220199585
Epoch: 16, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.310 Vali Acc: 0.267 Test Loss: 1.310 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 17 cost time: 1.0395333766937256
Epoch: 17, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.308 Vali Acc: 0.267 Test Loss: 1.308 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 18 cost time: 1.0795087814331055
Epoch: 18, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.306 Vali Acc: 0.267 Test Loss: 1.306 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 19 cost time: 0.8353357315063477
Epoch: 19, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.305 Vali Acc: 0.267 Test Loss: 1.305 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 20 cost time: 1.448542833328247
Epoch: 20, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.304 Vali Acc: 0.333 Test Loss: 1.304 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333320).  Saving model ...
Epoch: 21 cost time: 0.8171060085296631
Epoch: 21, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1195921897888184
Epoch: 22, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.01788330078125
Epoch: 23, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0385291576385498
Epoch: 24, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.310 Vali Acc: 0.333 Test Loss: 1.310 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.105649709701538
Epoch: 25, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.315 Vali Acc: 0.267 Test Loss: 1.315 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9685506820678711
Epoch: 26, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.319 Vali Acc: 0.267 Test Loss: 1.319 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9100682735443115
Epoch: 27, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.324 Vali Acc: 0.267 Test Loss: 1.324 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3020446300506592
Epoch: 28, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.330 Vali Acc: 0.267 Test Loss: 1.330 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.472003698348999
Epoch: 29, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.336 Vali Acc: 0.333 Test Loss: 1.336 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1990280151367188
Epoch: 30, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.341 Vali Acc: 0.333 Test Loss: 1.341 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df256_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 223491
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.0159196853637695
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.249 Vali Acc: 0.533 Test Loss: 1.249 Test Acc: 0.533
Validation loss decreased (inf --> -0.533321).  Saving model ...
Epoch: 2 cost time: 0.9704430103302002
Epoch: 2, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.201 Vali Acc: 0.533 Test Loss: 1.201 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533321).  Saving model ...
Epoch: 3 cost time: 1.1324658393859863
Epoch: 3, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.166008710861206
Epoch: 4, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8929762840270996
Epoch: 5, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.270003080368042
Epoch: 6, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8716630935668945
Epoch: 7, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1701545715332031
Epoch: 8, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1098556518554688
Epoch: 9, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9738214015960693
Epoch: 10, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1074280738830566
Epoch: 11, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9024658203125
Epoch: 12, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533321 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 1.294501543045044
Epoch: 13, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6311099529266357
Epoch: 14, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2025742530822754
Epoch: 15, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8983254432678223
Epoch: 16, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3176860809326172
Epoch: 17, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.904548168182373
Epoch: 18, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8753530979156494
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0322027206420898
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2975411415100098
Epoch: 21, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2193858623504639
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 227715
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.029315948486328
Epoch: 1, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.9849119186401367
Epoch: 2, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8492071628570557
Epoch: 3, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.7916219234466553
Epoch: 4, Steps: 1 | Train Loss: 0.779 Vali Loss: 0.995 Vali Acc: 0.600 Test Loss: 0.995 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 1.0431973934173584
Epoch: 5, Steps: 1 | Train Loss: 0.623 Vali Loss: 0.986 Vali Acc: 0.667 Test Loss: 0.986 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 1.0132908821105957
Epoch: 6, Steps: 1 | Train Loss: 0.668 Vali Loss: 0.978 Vali Acc: 0.667 Test Loss: 0.978 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 7 cost time: 1.269357681274414
Epoch: 7, Steps: 1 | Train Loss: 0.595 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2640142440795898
Epoch: 8, Steps: 1 | Train Loss: 0.555 Vali Loss: 0.962 Vali Acc: 0.533 Test Loss: 0.962 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1374220848083496
Epoch: 9, Steps: 1 | Train Loss: 0.473 Vali Loss: 0.953 Vali Acc: 0.467 Test Loss: 0.953 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2888293266296387
Epoch: 10, Steps: 1 | Train Loss: 0.391 Vali Loss: 0.942 Vali Acc: 0.533 Test Loss: 0.942 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3614697456359863
Epoch: 11, Steps: 1 | Train Loss: 0.281 Vali Loss: 0.930 Vali Acc: 0.533 Test Loss: 0.930 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0251710414886475
Epoch: 12, Steps: 1 | Train Loss: 0.248 Vali Loss: 0.922 Vali Acc: 0.533 Test Loss: 0.922 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9215409755706787
Epoch: 13, Steps: 1 | Train Loss: 0.164 Vali Loss: 0.912 Vali Acc: 0.533 Test Loss: 0.912 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9215948581695557
Epoch: 14, Steps: 1 | Train Loss: 0.192 Vali Loss: 0.902 Vali Acc: 0.533 Test Loss: 0.902 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0408339500427246
Epoch: 15, Steps: 1 | Train Loss: 0.109 Vali Loss: 0.892 Vali Acc: 0.533 Test Loss: 0.892 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.818791389465332
Epoch: 16, Steps: 1 | Train Loss: 0.086 Vali Loss: 0.882 Vali Acc: 0.533 Test Loss: 0.882 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 175747
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.736619234085083
Epoch: 1, Steps: 1 | Train Loss: 1.448 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 1.0839738845825195
Epoch: 2, Steps: 1 | Train Loss: 1.387 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.9069507122039795
Epoch: 3, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9679093360900879
Epoch: 4, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0349290370941162
Epoch: 5, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.257 Vali Acc: 0.267 Test Loss: 1.257 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1768250465393066
Epoch: 6, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9665045738220215
Epoch: 7, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.9086487293243408
Epoch: 8, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0361602306365967
Epoch: 9, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8502027988433838
Epoch: 10, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8013632297515869
Epoch: 11, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8954176902770996
Epoch: 12, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.133608102798462
Epoch: 13, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.274 Vali Acc: 0.333 Test Loss: 1.274 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9751675128936768
Epoch: 14, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9503228664398193
Epoch: 15, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0401854515075684
Epoch: 16, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.8671247959136963
Epoch: 17, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 0.9432413578033447
Epoch: 18, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 1.0079984664916992
Epoch: 19, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.236 Vali Acc: 0.467 Test Loss: 1.236 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 20 cost time: 1.3217544555664062
Epoch: 20, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1882109642028809
Epoch: 21, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.002260446548462
Epoch: 22, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.244 Vali Acc: 0.400 Test Loss: 1.244 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.061964988708496
Epoch: 23, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.254 Vali Acc: 0.400 Test Loss: 1.254 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0655794143676758
Epoch: 24, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9148566722869873
Epoch: 25, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0548052787780762
Epoch: 26, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.800238847732544
Epoch: 27, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.308 Vali Acc: 0.467 Test Loss: 1.308 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3014931678771973
Epoch: 28, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.323 Vali Acc: 0.467 Test Loss: 1.323 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.009329080581665
Epoch: 29, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.338 Vali Acc: 0.467 Test Loss: 1.338 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 163843
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.151537179946899
Epoch: 1, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.0683231353759766
Epoch: 2, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 1.0284998416900635
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 1.3950636386871338
Epoch: 4, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 1.0138564109802246
Epoch: 5, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 1.113373041152954
Epoch: 6, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.7316281795501709
Epoch: 7, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 1.3560807704925537
Epoch: 8, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 1.0261821746826172
Epoch: 9, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 1.2147455215454102
Epoch: 10, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 1.1537158489227295
Epoch: 11, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 1.8689186573028564
Epoch: 12, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.2026362419128418
Epoch: 13, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.210387945175171
Epoch: 14, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8167846202850342
Epoch: 15, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1228375434875488
Epoch: 16, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.9998035430908203
Epoch: 17, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 1.142371416091919
Epoch: 18, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 1.1066124439239502
Epoch: 19, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3463497161865234
Epoch: 20, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.9129648208618164
Epoch: 21, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0753254890441895
Epoch: 22, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0509579181671143
Epoch: 23, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.519338607788086
Epoch: 24, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0116939544677734
Epoch: 25, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0966989994049072
Epoch: 26, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1582832336425781
Epoch: 27, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 28 cost time: 1.1042366027832031
Epoch: 28, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1986863613128662
Epoch: 29, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2030959129333496
Epoch: 30, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1373810768127441
Epoch: 31, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.061521291732788
Epoch: 32, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.65647292137146
Epoch: 33, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4433345794677734
Epoch: 34, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0679218769073486
Epoch: 35, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.160020351409912
Epoch: 36, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1349899768829346
Epoch: 37, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 162563
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.6253271102905273
Epoch: 1, Steps: 1 | Train Loss: 1.428 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.4058732986450195
Epoch: 2, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8338422775268555
Epoch: 3, Steps: 1 | Train Loss: 1.396 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.1420364379882812
Epoch: 4, Steps: 1 | Train Loss: 1.345 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7878708839416504
Epoch: 5, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.1648602485656738
Epoch: 6, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 1.1326918601989746
Epoch: 7, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 1.2694027423858643
Epoch: 8, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 1.1747932434082031
Epoch: 9, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.8498127460479736
Epoch: 10, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 1.1107964515686035
Epoch: 11, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 1.0485177040100098
Epoch: 12, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.9539532661437988
Epoch: 13, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.9942877292633057
Epoch: 14, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 15 cost time: 1.2543580532073975
Epoch: 15, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 16 cost time: 0.816455602645874
Epoch: 16, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 17 cost time: 1.1411857604980469
Epoch: 17, Steps: 1 | Train Loss: 0.286 Vali Loss: 0.996 Vali Acc: 0.533 Test Loss: 0.996 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.856560230255127
Epoch: 18, Steps: 1 | Train Loss: 0.257 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2684276103973389
Epoch: 19, Steps: 1 | Train Loss: 0.255 Vali Loss: 0.983 Vali Acc: 0.400 Test Loss: 0.983 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1600978374481201
Epoch: 20, Steps: 1 | Train Loss: 0.209 Vali Loss: 0.980 Vali Acc: 0.400 Test Loss: 0.980 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.850369930267334
Epoch: 21, Steps: 1 | Train Loss: 0.145 Vali Loss: 0.977 Vali Acc: 0.400 Test Loss: 0.977 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0118544101715088
Epoch: 22, Steps: 1 | Train Loss: 0.105 Vali Loss: 0.974 Vali Acc: 0.400 Test Loss: 0.974 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9479269981384277
Epoch: 23, Steps: 1 | Train Loss: 0.079 Vali Loss: 0.974 Vali Acc: 0.400 Test Loss: 0.974 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5254240036010742
Epoch: 24, Steps: 1 | Train Loss: 0.066 Vali Loss: 0.976 Vali Acc: 0.400 Test Loss: 0.976 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2476880550384521
Epoch: 25, Steps: 1 | Train Loss: 0.056 Vali Loss: 0.978 Vali Acc: 0.533 Test Loss: 0.978 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533324).  Saving model ...
Epoch: 26 cost time: 1.0943691730499268
Epoch: 26, Steps: 1 | Train Loss: 0.039 Vali Loss: 0.981 Vali Acc: 0.533 Test Loss: 0.981 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1707594394683838
Epoch: 27, Steps: 1 | Train Loss: 0.031 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2787368297576904
Epoch: 28, Steps: 1 | Train Loss: 0.028 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.176745891571045
Epoch: 29, Steps: 1 | Train Loss: 0.016 Vali Loss: 0.996 Vali Acc: 0.533 Test Loss: 0.996 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9454829692840576
Epoch: 30, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1642844676971436
Epoch: 31, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2964940071105957
Epoch: 32, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1739168167114258
Epoch: 33, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4438350200653076
Epoch: 34, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.016270637512207
Epoch: 35, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 167811
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.495198011398315
Epoch: 1, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.7004082202911377
Epoch: 2, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.7636735439300537
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 1.073819875717163
Epoch: 4, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.8575470447540283
Epoch: 5, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.7643899917602539
Epoch: 6, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.9813859462738037
Epoch: 7, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.8332846164703369
Epoch: 8, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.9858798980712891
Epoch: 9, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 1.0792460441589355
Epoch: 10, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 0.9449694156646729
Epoch: 11, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 12 cost time: 1.3062305450439453
Epoch: 12, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 0.7023348808288574
Epoch: 13, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 14 cost time: 1.0641508102416992
Epoch: 14, Steps: 1 | Train Loss: 0.575 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 15 cost time: 0.9398529529571533
Epoch: 15, Steps: 1 | Train Loss: 0.436 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 16 cost time: 0.9294648170471191
Epoch: 16, Steps: 1 | Train Loss: 0.363 Vali Loss: 0.984 Vali Acc: 0.467 Test Loss: 0.984 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 17 cost time: 0.7928791046142578
Epoch: 17, Steps: 1 | Train Loss: 0.287 Vali Loss: 0.978 Vali Acc: 0.467 Test Loss: 0.978 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 18 cost time: 0.9860029220581055
Epoch: 18, Steps: 1 | Train Loss: 0.243 Vali Loss: 0.975 Vali Acc: 0.467 Test Loss: 0.975 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 19 cost time: 1.2633414268493652
Epoch: 19, Steps: 1 | Train Loss: 0.224 Vali Loss: 0.972 Vali Acc: 0.467 Test Loss: 0.972 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 20 cost time: 0.9708971977233887
Epoch: 20, Steps: 1 | Train Loss: 0.159 Vali Loss: 0.971 Vali Acc: 0.467 Test Loss: 0.971 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 21 cost time: 0.8863027095794678
Epoch: 21, Steps: 1 | Train Loss: 0.140 Vali Loss: 0.971 Vali Acc: 0.400 Test Loss: 0.971 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9577364921569824
Epoch: 22, Steps: 1 | Train Loss: 0.139 Vali Loss: 0.972 Vali Acc: 0.400 Test Loss: 0.972 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2570204734802246
Epoch: 23, Steps: 1 | Train Loss: 0.108 Vali Loss: 0.975 Vali Acc: 0.467 Test Loss: 0.975 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.986792802810669
Epoch: 24, Steps: 1 | Train Loss: 0.080 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 25 cost time: 0.924067497253418
Epoch: 25, Steps: 1 | Train Loss: 0.059 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9840869903564453
Epoch: 26, Steps: 1 | Train Loss: 0.042 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3169200420379639
Epoch: 27, Steps: 1 | Train Loss: 0.041 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0083541870117188
Epoch: 28, Steps: 1 | Train Loss: 0.036 Vali Loss: 0.996 Vali Acc: 0.533 Test Loss: 0.996 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1936230659484863
Epoch: 29, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1981229782104492
Epoch: 30, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0754268169403076
Epoch: 31, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1341266632080078
Epoch: 32, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599990).  Saving model ...
Epoch: 33 cost time: 0.9192352294921875
Epoch: 33, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.015 Vali Acc: 0.600 Test Loss: 1.015 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0736572742462158
Epoch: 34, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.408531665802002
Epoch: 35, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2053050994873047
Epoch: 36, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.400758981704712
Epoch: 37, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1489605903625488
Epoch: 38, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2273192405700684
Epoch: 39, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.065664291381836
Epoch: 40, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1784350872039795
Epoch: 41, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.4213018417358398
Epoch: 42, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 179203
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8243789672851562
Epoch: 1, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 1.097890853881836
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 1.055776596069336
Epoch: 3, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 1.1115899085998535
Epoch: 4, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.9726090431213379
Epoch: 5, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 1.1495263576507568
Epoch: 6, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9561822414398193
Epoch: 7, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1878552436828613
Epoch: 8, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.213 Vali Acc: 0.133 Test Loss: 1.213 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9339866638183594
Epoch: 9, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.210 Vali Acc: 0.133 Test Loss: 1.210 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0248675346374512
Epoch: 10, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.979686975479126
Epoch: 11, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0475471019744873
Epoch: 12, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0733389854431152
Epoch: 13, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 1.1294660568237305
Epoch: 14, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 1.150261402130127
Epoch: 15, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 16 cost time: 1.3021910190582275
Epoch: 16, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 17 cost time: 1.0697877407073975
Epoch: 17, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 18 cost time: 0.9678058624267578
Epoch: 18, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 19 cost time: 1.219043493270874
Epoch: 19, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0730390548706055
Epoch: 20, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3584065437316895
Epoch: 21, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0369329452514648
Epoch: 22, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1559412479400635
Epoch: 23, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9674866199493408
Epoch: 24, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0421819686889648
Epoch: 25, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2110991477966309
Epoch: 26, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9213006496429443
Epoch: 27, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1698336601257324
Epoch: 28, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df128_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 190595
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.2703564167022705
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8761351108551025
Epoch: 2, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.0505590438842773
Epoch: 3, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3189313411712646
Epoch: 4, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3183403015136719
Epoch: 5, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1320116519927979
Epoch: 6, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1154422760009766
Epoch: 7, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9026479721069336
Epoch: 8, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8810505867004395
Epoch: 9, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 1.0371806621551514
Epoch: 10, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 1.1874432563781738
Epoch: 11, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1776018142700195
Epoch: 12, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9467382431030273
Epoch: 13, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2182598114013672
Epoch: 14, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1804604530334473
Epoch: 15, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9071483612060547
Epoch: 16, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.312887191772461
Epoch: 17, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3766238689422607
Epoch: 18, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7885947227478027
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.489980697631836
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 211267
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.196543455123901
Epoch: 1, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 1.0295050144195557
Epoch: 2, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.929814338684082
Epoch: 3, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.2722668647766113
Epoch: 4, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 1.5000414848327637
Epoch: 5, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 1.239426612854004
Epoch: 6, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 1.1904022693634033
Epoch: 7, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.9129140377044678
Epoch: 8, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 1.1736564636230469
Epoch: 9, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 1.1684329509735107
Epoch: 10, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 1.1824462413787842
Epoch: 11, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.156252384185791
Epoch: 12, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2999908924102783
Epoch: 13, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9414851665496826
Epoch: 14, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0344877243041992
Epoch: 15, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.218 Vali Acc: 0.400 Test Loss: 1.218 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2038884162902832
Epoch: 16, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1544265747070312
Epoch: 17, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4492948055267334
Epoch: 18, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1534266471862793
Epoch: 19, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.219 Vali Acc: 0.467 Test Loss: 1.219 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 20 cost time: 0.9651150703430176
Epoch: 20, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.227 Vali Acc: 0.467 Test Loss: 1.227 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5778915882110596
Epoch: 21, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.235 Vali Acc: 0.467 Test Loss: 1.235 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.408165454864502
Epoch: 22, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.245 Vali Acc: 0.467 Test Loss: 1.245 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4634742736816406
Epoch: 23, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.254 Vali Acc: 0.467 Test Loss: 1.254 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0914180278778076
Epoch: 24, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.264 Vali Acc: 0.467 Test Loss: 1.264 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.194312334060669
Epoch: 25, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.274 Vali Acc: 0.467 Test Loss: 1.274 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.425532579421997
Epoch: 26, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.284 Vali Acc: 0.467 Test Loss: 1.284 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0175423622131348
Epoch: 27, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.294 Vali Acc: 0.467 Test Loss: 1.294 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9103243350982666
Epoch: 28, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.304 Vali Acc: 0.467 Test Loss: 1.304 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4657912254333496
Epoch: 29, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.313 Vali Acc: 0.467 Test Loss: 1.313 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 159299
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.2577478885650635
Epoch: 1, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 1.406064510345459
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 1.3061699867248535
Epoch: 3, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 1.0689196586608887
Epoch: 4, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.9129021167755127
Epoch: 5, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 1.0970511436462402
Epoch: 6, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.963019847869873
Epoch: 7, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.128 Vali Acc: 0.533 Test Loss: 1.128 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.9176456928253174
Epoch: 8, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.123 Vali Acc: 0.600 Test Loss: 1.123 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.9455349445343018
Epoch: 9, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.119 Vali Acc: 0.533 Test Loss: 1.119 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9077024459838867
Epoch: 10, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.193363904953003
Epoch: 11, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.565769910812378
Epoch: 12, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2854793071746826
Epoch: 13, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1513652801513672
Epoch: 14, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0104999542236328
Epoch: 15, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4729743003845215
Epoch: 16, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9686799049377441
Epoch: 17, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2095344066619873
Epoch: 18, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 147395
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7460737228393555
Epoch: 1, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.354 Vali Acc: 0.400 Test Loss: 1.354 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.0484845638275146
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.334 Vali Acc: 0.333 Test Loss: 1.334 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9782922267913818
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5940697193145752
Epoch: 4, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.299 Vali Acc: 0.333 Test Loss: 1.299 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.10896897315979
Epoch: 5, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3143882751464844
Epoch: 6, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7339353561401367
Epoch: 7, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.994941234588623
Epoch: 8, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9255778789520264
Epoch: 9, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.512944221496582
Epoch: 10, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0791537761688232
Epoch: 11, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 146115
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8178725242614746
Epoch: 1, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.0301833152770996
Epoch: 2, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.7586946487426758
Epoch: 3, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.215848684310913
Epoch: 4, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.9512159824371338
Epoch: 5, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7552125453948975
Epoch: 6, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4080896377563477
Epoch: 7, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6980245113372803
Epoch: 8, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 1.2160024642944336
Epoch: 9, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.844806432723999
Epoch: 10, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.9602057933807373
Epoch: 11, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 1.1848313808441162
Epoch: 12, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.8637394905090332
Epoch: 13, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.9532284736633301
Epoch: 14, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.9229228496551514
Epoch: 15, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 1.5261507034301758
Epoch: 16, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.945723295211792
Epoch: 17, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3002629280090332
Epoch: 18, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0738134384155273
Epoch: 19, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1850910186767578
Epoch: 20, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9335465431213379
Epoch: 21, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2651653289794922
Epoch: 22, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 1.584505558013916
Epoch: 23, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9816172122955322
Epoch: 24, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9380354881286621
Epoch: 25, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0577130317687988
Epoch: 26, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2482013702392578
Epoch: 27, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3795521259307861
Epoch: 28, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.467240810394287
Epoch: 29, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1149296760559082
Epoch: 30, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2469305992126465
Epoch: 31, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3871173858642578
Epoch: 32, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 151363
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.271352529525757
Epoch: 1, Steps: 1 | Train Loss: 1.339 Vali Loss: 1.321 Vali Acc: 0.200 Test Loss: 1.321 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 1.4087107181549072
Epoch: 2, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.306 Vali Acc: 0.200 Test Loss: 1.306 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 1.1901865005493164
Epoch: 3, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.293 Vali Acc: 0.200 Test Loss: 1.293 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 1.0428721904754639
Epoch: 4, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 1.0635323524475098
Epoch: 5, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.275 Vali Acc: 0.267 Test Loss: 1.275 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 1.066453456878662
Epoch: 6, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 1.2452824115753174
Epoch: 7, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 1.5496127605438232
Epoch: 8, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 1.6192281246185303
Epoch: 9, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 1.3738148212432861
Epoch: 10, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 11 cost time: 1.412346601486206
Epoch: 11, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 12 cost time: 1.4994161128997803
Epoch: 12, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 1.4810776710510254
Epoch: 13, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.781304121017456
Epoch: 14, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 1.2936899662017822
Epoch: 15, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 1.2150852680206299
Epoch: 16, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 1.099581241607666
Epoch: 17, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 1.5067739486694336
Epoch: 18, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 1.2150380611419678
Epoch: 19, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 1.199875831604004
Epoch: 20, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 1.1503183841705322
Epoch: 21, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.9985597133636475
Epoch: 22, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 1.03554368019104
Epoch: 23, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 1.2559032440185547
Epoch: 24, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 1.4437472820281982
Epoch: 25, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 1.1733782291412354
Epoch: 26, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5002944469451904
Epoch: 27, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.233778476715088
Epoch: 28, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1421782970428467
Epoch: 29, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 30 cost time: 0.9309818744659424
Epoch: 30, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 31 cost time: 0.9800186157226562
Epoch: 31, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 1.062812328338623
Epoch: 32, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 33 cost time: 1.171997308731079
Epoch: 33, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 34 cost time: 1.7098915576934814
Epoch: 34, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 35 cost time: 1.4973926544189453
Epoch: 35, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 36 cost time: 1.0495104789733887
Epoch: 36, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 37 cost time: 1.580367088317871
Epoch: 37, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 38 cost time: 1.0675544738769531
Epoch: 38, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 39 cost time: 1.2757513523101807
Epoch: 39, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 40 cost time: 1.3071033954620361
Epoch: 40, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4889371395111084
Epoch: 41, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2528457641601562
Epoch: 42, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.013213872909546
Epoch: 43, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.385209083557129
Epoch: 44, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8879938125610352
Epoch: 45, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.4604926109313965
Epoch: 46, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.5477430820465088
Epoch: 47, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.3875539302825928
Epoch: 48, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.3862221240997314
Epoch: 49, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 162755
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.357115983963013
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.9708833694458008
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 1.1755375862121582
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.9509596824645996
Epoch: 4, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.8968126773834229
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 1.1773350238800049
Epoch: 6, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 1.2426390647888184
Epoch: 7, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 1.268415927886963
Epoch: 8, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 9 cost time: 1.4933123588562012
Epoch: 9, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 10 cost time: 0.9707186222076416
Epoch: 10, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.086 Vali Acc: 0.200 Test Loss: 1.086 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1251845359802246
Epoch: 11, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.080 Vali Acc: 0.133 Test Loss: 1.080 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.13681960105896
Epoch: 12, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.074 Vali Acc: 0.200 Test Loss: 1.074 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0596494674682617
Epoch: 13, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.068 Vali Acc: 0.200 Test Loss: 1.068 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2639515399932861
Epoch: 14, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.062 Vali Acc: 0.267 Test Loss: 1.062 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 15 cost time: 1.1190431118011475
Epoch: 15, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 1.0764780044555664
Epoch: 16, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 1.008129358291626
Epoch: 17, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 1.112642765045166
Epoch: 18, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.044 Vali Acc: 0.333 Test Loss: 1.044 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 1.164339542388916
Epoch: 19, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.041 Vali Acc: 0.333 Test Loss: 1.041 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 20 cost time: 1.0243995189666748
Epoch: 20, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.040 Vali Acc: 0.333 Test Loss: 1.040 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 21 cost time: 1.0175235271453857
Epoch: 21, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 22 cost time: 1.0758018493652344
Epoch: 22, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 23 cost time: 1.0839951038360596
Epoch: 23, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.962646484375
Epoch: 24, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3430349826812744
Epoch: 25, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5253336429595947
Epoch: 26, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.37744140625
Epoch: 27, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1278977394104004
Epoch: 28, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 1.2657091617584229
Epoch: 29, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0926322937011719
Epoch: 30, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1702897548675537
Epoch: 31, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4869868755340576
Epoch: 32, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2195980548858643
Epoch: 33, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1330645084381104
Epoch: 34, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8961656093597412
Epoch: 35, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1590969562530518
Epoch: 36, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8722569942474365
Epoch: 37, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0144104957580566
Epoch: 38, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 39 cost time: 1.0661365985870361
Epoch: 39, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9816586971282959
Epoch: 40, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.107694387435913
Epoch: 41, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2156143188476562
Epoch: 42, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.119 Vali Acc: 0.533 Test Loss: 1.119 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2618062496185303
Epoch: 43, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5635020732879639
Epoch: 44, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.276458501815796
Epoch: 45, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.296661138534546
Epoch: 46, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.125931978225708
Epoch: 47, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8910326957702637
Epoch: 48, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.137 Vali Acc: 0.533 Test Loss: 1.137 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm128_nh16_df64_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 174147
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.106955528259277
Epoch: 1, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8774373531341553
Epoch: 2, Steps: 1 | Train Loss: 1.304 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4627149105072021
Epoch: 3, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2284088134765625
Epoch: 4, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2219572067260742
Epoch: 5, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.191 Vali Acc: 0.133 Test Loss: 1.191 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1526148319244385
Epoch: 6, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.186 Vali Acc: 0.067 Test Loss: 1.186 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0814731121063232
Epoch: 7, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.899486780166626
Epoch: 8, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2180957794189453
Epoch: 9, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9004042148590088
Epoch: 10, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9695906639099121
Epoch: 11, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 114051
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.393409252166748
Epoch: 1, Steps: 1 | Train Loss: 1.369 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.1304411888122559
Epoch: 2, Steps: 1 | Train Loss: 1.304 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8430299758911133
Epoch: 3, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.8557934761047363
Epoch: 4, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9364056587219238
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7855496406555176
Epoch: 6, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 1.164520025253296
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.9172093868255615
Epoch: 8, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 1.258882761001587
Epoch: 9, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 1.0976319313049316
Epoch: 10, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.8337442874908447
Epoch: 11, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.9439802169799805
Epoch: 12, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.9951603412628174
Epoch: 13, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.8471975326538086
Epoch: 14, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.0709598064422607
Epoch: 15, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.9536514282226562
Epoch: 16, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 1.1641945838928223
Epoch: 17, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.6778981685638428
Epoch: 18, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.931016206741333
Epoch: 19, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2357227802276611
Epoch: 20, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2354323863983154
Epoch: 21, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3695018291473389
Epoch: 22, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1571593284606934
Epoch: 23, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8478994369506836
Epoch: 24, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8162353038787842
Epoch: 25, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0965583324432373
Epoch: 26, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2634615898132324
Epoch: 27, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 88067
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8524270057678223
Epoch: 1, Steps: 1 | Train Loss: 1.280 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 1.3531391620635986
Epoch: 2, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.106 Vali Acc: 0.533 Test Loss: 1.106 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 1.0932559967041016
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.9431748390197754
Epoch: 4, Steps: 1 | Train Loss: 1.375 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.8565247058868408
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 1.2564318180084229
Epoch: 6, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.9534661769866943
Epoch: 7, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.9492976665496826
Epoch: 8, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.8953812122344971
Epoch: 9, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 1.1595795154571533
Epoch: 10, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 1.3615636825561523
Epoch: 11, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 1.024505615234375
Epoch: 12, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.8433327674865723
Epoch: 13, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.294952154159546
Epoch: 14, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.106194257736206
Epoch: 15, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.427985668182373
Epoch: 16, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3457684516906738
Epoch: 17, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8566124439239502
Epoch: 18, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.018 Vali Acc: 0.400 Test Loss: 1.018 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0719361305236816
Epoch: 19, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4867422580718994
Epoch: 20, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0669798851013184
Epoch: 21, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.013 Vali Acc: 0.400 Test Loss: 1.013 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1460692882537842
Epoch: 22, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.012 Vali Acc: 0.400 Test Loss: 1.012 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 82115
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.893562316894531
Epoch: 1, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.0824341773986816
Epoch: 2, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.299363613128662
Epoch: 3, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.1863000392913818
Epoch: 4, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 1.2896595001220703
Epoch: 5, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 1.3013298511505127
Epoch: 6, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 1.1676781177520752
Epoch: 7, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.117405891418457
Epoch: 8, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 1.1095690727233887
Epoch: 9, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 1.118922472000122
Epoch: 10, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 1.0311589241027832
Epoch: 11, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.9944515228271484
Epoch: 12, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 1.4532153606414795
Epoch: 13, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 1.1779601573944092
Epoch: 14, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 1.149641990661621
Epoch: 15, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 1.1431584358215332
Epoch: 16, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3275644779205322
Epoch: 17, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2181811332702637
Epoch: 18, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1385133266448975
Epoch: 19, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1057007312774658
Epoch: 20, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0448832511901855
Epoch: 21, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0416724681854248
Epoch: 22, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0873644351959229
Epoch: 23, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9780845642089844
Epoch: 24, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1549112796783447
Epoch: 25, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 81475
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9114937782287598
Epoch: 1, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9482152462005615
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.989208459854126
Epoch: 3, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.924274206161499
Epoch: 4, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8667430877685547
Epoch: 5, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.379884958267212
Epoch: 6, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.980889081954956
Epoch: 7, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.8505029678344727
Epoch: 8, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 1.0637648105621338
Epoch: 9, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 1.0287995338439941
Epoch: 10, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.7931551933288574
Epoch: 11, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.920860767364502
Epoch: 12, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.949537992477417
Epoch: 13, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 1.0835740566253662
Epoch: 14, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 15 cost time: 0.8303875923156738
Epoch: 15, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.9416091442108154
Epoch: 16, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.8400595188140869
Epoch: 17, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.9726333618164062
Epoch: 18, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 1.1263954639434814
Epoch: 19, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.012 Vali Acc: 0.400 Test Loss: 1.012 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8829503059387207
Epoch: 20, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.006 Vali Acc: 0.400 Test Loss: 1.006 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.177062749862671
Epoch: 21, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 22 cost time: 1.1619186401367188
Epoch: 22, Steps: 1 | Train Loss: 0.270 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 23 cost time: 1.0568289756774902
Epoch: 23, Steps: 1 | Train Loss: 0.228 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 24 cost time: 0.8994238376617432
Epoch: 24, Steps: 1 | Train Loss: 0.210 Vali Loss: 0.991 Vali Acc: 0.467 Test Loss: 0.991 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 25 cost time: 1.0301001071929932
Epoch: 25, Steps: 1 | Train Loss: 0.199 Vali Loss: 0.988 Vali Acc: 0.467 Test Loss: 0.988 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 26 cost time: 0.7179849147796631
Epoch: 26, Steps: 1 | Train Loss: 0.160 Vali Loss: 0.986 Vali Acc: 0.467 Test Loss: 0.986 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 27 cost time: 1.151705026626587
Epoch: 27, Steps: 1 | Train Loss: 0.123 Vali Loss: 0.985 Vali Acc: 0.467 Test Loss: 0.985 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 28 cost time: 0.9428908824920654
Epoch: 28, Steps: 1 | Train Loss: 0.122 Vali Loss: 0.984 Vali Acc: 0.467 Test Loss: 0.984 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 29 cost time: 0.9006855487823486
Epoch: 29, Steps: 1 | Train Loss: 0.121 Vali Loss: 0.983 Vali Acc: 0.467 Test Loss: 0.983 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 30 cost time: 1.6146366596221924
Epoch: 30, Steps: 1 | Train Loss: 0.083 Vali Loss: 0.983 Vali Acc: 0.533 Test Loss: 0.983 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 31 cost time: 1.5591280460357666
Epoch: 31, Steps: 1 | Train Loss: 0.084 Vali Loss: 0.982 Vali Acc: 0.533 Test Loss: 0.982 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 32 cost time: 1.0289716720581055
Epoch: 32, Steps: 1 | Train Loss: 0.061 Vali Loss: 0.982 Vali Acc: 0.533 Test Loss: 0.982 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0502915382385254
Epoch: 33, Steps: 1 | Train Loss: 0.058 Vali Loss: 0.983 Vali Acc: 0.533 Test Loss: 0.983 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0030202865600586
Epoch: 34, Steps: 1 | Train Loss: 0.041 Vali Loss: 0.983 Vali Acc: 0.533 Test Loss: 0.983 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1831140518188477
Epoch: 35, Steps: 1 | Train Loss: 0.040 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.5075318813323975
Epoch: 36, Steps: 1 | Train Loss: 0.041 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0354156494140625
Epoch: 37, Steps: 1 | Train Loss: 0.039 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9622840881347656
Epoch: 38, Steps: 1 | Train Loss: 0.029 Vali Loss: 0.989 Vali Acc: 0.467 Test Loss: 0.989 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9908003807067871
Epoch: 39, Steps: 1 | Train Loss: 0.027 Vali Loss: 0.991 Vali Acc: 0.467 Test Loss: 0.991 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.006756067276001
Epoch: 40, Steps: 1 | Train Loss: 0.021 Vali Loss: 0.993 Vali Acc: 0.467 Test Loss: 0.993 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9602577686309814
Epoch: 41, Steps: 1 | Train Loss: 0.022 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 84099
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9946253299713135
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.267 Vali Acc: 0.467 Test Loss: 1.267 Test Acc: 0.467
Validation loss decreased (inf --> -0.466654).  Saving model ...
Epoch: 2 cost time: 1.0661287307739258
Epoch: 2, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.262 Vali Acc: 0.467 Test Loss: 1.262 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 3 cost time: 0.7585315704345703
Epoch: 3, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.257 Vali Acc: 0.467 Test Loss: 1.257 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 4 cost time: 0.97873854637146
Epoch: 4, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.253 Vali Acc: 0.467 Test Loss: 1.253 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 5 cost time: 1.2610583305358887
Epoch: 5, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.249 Vali Acc: 0.467 Test Loss: 1.249 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 6 cost time: 1.1747827529907227
Epoch: 6, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.246 Vali Acc: 0.467 Test Loss: 1.246 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 7 cost time: 0.8070182800292969
Epoch: 7, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.242 Vali Acc: 0.467 Test Loss: 1.242 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 8 cost time: 0.8964786529541016
Epoch: 8, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.239 Vali Acc: 0.467 Test Loss: 1.239 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 9 cost time: 1.205108880996704
Epoch: 9, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.235 Vali Acc: 0.467 Test Loss: 1.235 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 10 cost time: 0.9902362823486328
Epoch: 10, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.231 Vali Acc: 0.467 Test Loss: 1.231 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 11 cost time: 0.7896811962127686
Epoch: 11, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.227 Vali Acc: 0.467 Test Loss: 1.227 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 12 cost time: 1.6266911029815674
Epoch: 12, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.222 Vali Acc: 0.467 Test Loss: 1.222 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 13 cost time: 0.9550352096557617
Epoch: 13, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.218 Vali Acc: 0.467 Test Loss: 1.218 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 14 cost time: 1.1259973049163818
Epoch: 14, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.213 Vali Acc: 0.467 Test Loss: 1.213 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.7518434524536133
Epoch: 15, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.207 Vali Acc: 0.467 Test Loss: 1.207 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.8640108108520508
Epoch: 16, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.202 Vali Acc: 0.467 Test Loss: 1.202 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 17 cost time: 1.0391991138458252
Epoch: 17, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.197 Vali Acc: 0.467 Test Loss: 1.197 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 1.0293798446655273
Epoch: 18, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.194 Vali Acc: 0.467 Test Loss: 1.194 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 19 cost time: 1.020948886871338
Epoch: 19, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.190 Vali Acc: 0.467 Test Loss: 1.190 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 20 cost time: 1.2795133590698242
Epoch: 20, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.188 Vali Acc: 0.467 Test Loss: 1.188 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 21 cost time: 1.128446102142334
Epoch: 21, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.186 Vali Acc: 0.467 Test Loss: 1.186 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 22 cost time: 0.9159359931945801
Epoch: 22, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 1.4785542488098145
Epoch: 23, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 24 cost time: 1.1859240531921387
Epoch: 24, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.179 Vali Acc: 0.467 Test Loss: 1.179 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 25 cost time: 1.0901758670806885
Epoch: 25, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.178 Vali Acc: 0.467 Test Loss: 1.178 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 26 cost time: 1.0201375484466553
Epoch: 26, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.176 Vali Acc: 0.467 Test Loss: 1.176 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 27 cost time: 1.1844115257263184
Epoch: 27, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 28 cost time: 0.8095667362213135
Epoch: 28, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.172 Vali Acc: 0.467 Test Loss: 1.172 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 29 cost time: 1.1748218536376953
Epoch: 29, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.170 Vali Acc: 0.467 Test Loss: 1.170 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 30 cost time: 0.970679759979248
Epoch: 30, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 31 cost time: 0.9877345561981201
Epoch: 31, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 32 cost time: 0.91800856590271
Epoch: 32, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 33 cost time: 0.9544150829315186
Epoch: 33, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.164 Vali Acc: 0.533 Test Loss: 1.164 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 34 cost time: 1.500014305114746
Epoch: 34, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2114546298980713
Epoch: 35, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0997729301452637
Epoch: 36, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4812331199645996
Epoch: 37, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1091818809509277
Epoch: 38, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0243678092956543
Epoch: 39, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8702178001403809
Epoch: 40, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1979444026947021
Epoch: 41, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.46846604347229
Epoch: 42, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.2681605815887451
Epoch: 43, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 89795
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.065925598144531
Epoch: 1, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.9190547466278076
Epoch: 2, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.927492618560791
Epoch: 3, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.8841400146484375
Epoch: 4, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9400057792663574
Epoch: 5, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.9251036643981934
Epoch: 6, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 1.1959173679351807
Epoch: 7, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0737900733947754
Epoch: 8, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.07963228225708
Epoch: 9, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1068966388702393
Epoch: 10, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0972461700439453
Epoch: 11, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4144158363342285
Epoch: 12, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8883891105651855
Epoch: 13, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9334390163421631
Epoch: 14, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 1.1968164443969727
Epoch: 15, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 1.1865098476409912
Epoch: 16, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 1.351799726486206
Epoch: 17, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.2193984985351562
Epoch: 18, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 1.34660005569458
Epoch: 19, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 1.2404296398162842
Epoch: 20, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.010636329650879
Epoch: 21, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2842748165130615
Epoch: 22, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.044 Vali Acc: 0.333 Test Loss: 1.044 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8847179412841797
Epoch: 23, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 24 cost time: 0.9999971389770508
Epoch: 24, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 25 cost time: 1.1499874591827393
Epoch: 25, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 26 cost time: 1.255509853363037
Epoch: 26, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 27 cost time: 1.0616960525512695
Epoch: 27, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 1.0705325603485107
Epoch: 28, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.888685941696167
Epoch: 29, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.8896443843841553
Epoch: 30, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 0.9671585559844971
Epoch: 31, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 32 cost time: 1.2479047775268555
Epoch: 32, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 33 cost time: 1.2759373188018799
Epoch: 33, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 34 cost time: 0.8860950469970703
Epoch: 34, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4292635917663574
Epoch: 35, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.932159423828125
Epoch: 36, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0869193077087402
Epoch: 37, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1761322021484375
Epoch: 38, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1348881721496582
Epoch: 39, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2704572677612305
Epoch: 40, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8869490623474121
Epoch: 41, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 42 cost time: 1.4794378280639648
Epoch: 42, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.019 Vali Acc: 0.600 Test Loss: 1.019 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2422475814819336
Epoch: 43, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0910437107086182
Epoch: 44, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9060177803039551
Epoch: 45, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0834581851959229
Epoch: 46, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1365742683410645
Epoch: 47, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0867977142333984
Epoch: 48, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.591282844543457
Epoch: 49, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.2070884704589844
Epoch: 50, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.3024015426635742
Epoch: 51, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df256_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 95491
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9594407081604004
Epoch: 1, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.0733425617218018
Epoch: 2, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.1000957489013672
Epoch: 3, Steps: 1 | Train Loss: 1.284 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.2183513641357422
Epoch: 4, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.0826613903045654
Epoch: 5, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.188086986541748
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0416390895843506
Epoch: 7, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9350883960723877
Epoch: 8, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8552772998809814
Epoch: 9, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.981712818145752
Epoch: 10, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 1.1341266632080078
Epoch: 11, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.9140198230743408
Epoch: 12, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.8988194465637207
Epoch: 13, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.9068179130554199
Epoch: 14, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8793416023254395
Epoch: 15, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1130456924438477
Epoch: 16, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2178256511688232
Epoch: 17, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9902338981628418
Epoch: 18, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7980935573577881
Epoch: 19, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0889248847961426
Epoch: 20, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1536586284637451
Epoch: 21, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.875525712966919
Epoch: 22, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2340903282165527
Epoch: 23, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 97539
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5144548416137695
Epoch: 1, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.942232608795166
Epoch: 2, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.9954445362091064
Epoch: 3, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7957079410552979
Epoch: 4, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.9033353328704834
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.7901384830474854
Epoch: 6, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.8719308376312256
Epoch: 7, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8465011119842529
Epoch: 8, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.8486804962158203
Epoch: 9, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.9194071292877197
Epoch: 10, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.66111159324646
Epoch: 11, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 1.3398799896240234
Epoch: 12, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 1.2100262641906738
Epoch: 13, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.152123212814331
Epoch: 14, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1410942077636719
Epoch: 15, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1727678775787354
Epoch: 16, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2216427326202393
Epoch: 17, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1114404201507568
Epoch: 18, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.024078369140625
Epoch: 19, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0240232944488525
Epoch: 20, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1320931911468506
Epoch: 21, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8383951187133789
Epoch: 22, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 71555
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.088404893875122
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.2275183200836182
Epoch: 2, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 1.3525888919830322
Epoch: 3, Steps: 1 | Train Loss: 1.279 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.7996575832366943
Epoch: 4, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2337393760681152
Epoch: 5, Steps: 1 | Train Loss: 1.161 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0915184020996094
Epoch: 6, Steps: 1 | Train Loss: 1.062 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 1.740842580795288
Epoch: 7, Steps: 1 | Train Loss: 1.021 Vali Loss: 0.981 Vali Acc: 0.600 Test Loss: 0.981 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 1.1171729564666748
Epoch: 8, Steps: 1 | Train Loss: 0.952 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 1.8087034225463867
Epoch: 9, Steps: 1 | Train Loss: 0.934 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1988847255706787
Epoch: 10, Steps: 1 | Train Loss: 0.830 Vali Loss: 0.964 Vali Acc: 0.533 Test Loss: 0.964 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3608334064483643
Epoch: 11, Steps: 1 | Train Loss: 0.933 Vali Loss: 0.961 Vali Acc: 0.467 Test Loss: 0.961 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5622239112854004
Epoch: 12, Steps: 1 | Train Loss: 0.757 Vali Loss: 0.958 Vali Acc: 0.467 Test Loss: 0.958 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4513294696807861
Epoch: 13, Steps: 1 | Train Loss: 0.625 Vali Loss: 0.957 Vali Acc: 0.667 Test Loss: 0.957 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 14 cost time: 1.214331865310669
Epoch: 14, Steps: 1 | Train Loss: 0.641 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.467592477798462
Epoch: 15, Steps: 1 | Train Loss: 0.527 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1912167072296143
Epoch: 16, Steps: 1 | Train Loss: 0.458 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4189515113830566
Epoch: 17, Steps: 1 | Train Loss: 0.500 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3433759212493896
Epoch: 18, Steps: 1 | Train Loss: 0.346 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0545244216918945
Epoch: 19, Steps: 1 | Train Loss: 0.322 Vali Loss: 0.958 Vali Acc: 0.600 Test Loss: 0.958 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3769023418426514
Epoch: 20, Steps: 1 | Train Loss: 0.275 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3665173053741455
Epoch: 21, Steps: 1 | Train Loss: 0.247 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2047672271728516
Epoch: 22, Steps: 1 | Train Loss: 0.245 Vali Loss: 0.953 Vali Acc: 0.600 Test Loss: 0.953 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.385181188583374
Epoch: 23, Steps: 1 | Train Loss: 0.185 Vali Loss: 0.949 Vali Acc: 0.600 Test Loss: 0.949 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 65603
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8754241466522217
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.0272412300109863
Epoch: 2, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9504976272583008
Epoch: 3, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8239579200744629
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9032177925109863
Epoch: 5, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.829073429107666
Epoch: 6, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2512977123260498
Epoch: 7, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.147536039352417
Epoch: 8, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9741837978363037
Epoch: 9, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.053710699081421
Epoch: 10, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.040428876876831
Epoch: 11, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1017630100250244
Epoch: 12, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0379092693328857
Epoch: 13, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0732035636901855
Epoch: 14, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2734436988830566
Epoch: 15, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 64963
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.0814337730407715
Epoch: 1, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.336 Vali Acc: 0.133 Test Loss: 1.336 Test Acc: 0.133
Validation loss decreased (inf --> -0.133320).  Saving model ...
Epoch: 2 cost time: 1.6245956420898438
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.332 Vali Acc: 0.133 Test Loss: 1.332 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 3 cost time: 1.141918420791626
Epoch: 3, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.328 Vali Acc: 0.067 Test Loss: 1.328 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6195251941680908
Epoch: 4, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.326 Vali Acc: 0.067 Test Loss: 1.326 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.053703784942627
Epoch: 5, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.324 Vali Acc: 0.133 Test Loss: 1.324 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 6 cost time: 1.087472677230835
Epoch: 6, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.323 Vali Acc: 0.133 Test Loss: 1.323 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 7 cost time: 1.1198596954345703
Epoch: 7, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.322 Vali Acc: 0.133 Test Loss: 1.322 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 8 cost time: 1.3681883811950684
Epoch: 8, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.321 Vali Acc: 0.133 Test Loss: 1.321 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 9 cost time: 1.3302578926086426
Epoch: 9, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.320 Vali Acc: 0.133 Test Loss: 1.320 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 10 cost time: 1.844834804534912
Epoch: 10, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.318 Vali Acc: 0.133 Test Loss: 1.318 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 11 cost time: 1.1998140811920166
Epoch: 11, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.316 Vali Acc: 0.200 Test Loss: 1.316 Test Acc: 0.200
Validation loss decreased (-0.133320 --> -0.199987).  Saving model ...
Epoch: 12 cost time: 1.2046432495117188
Epoch: 12, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.315 Vali Acc: 0.200 Test Loss: 1.315 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 13 cost time: 1.139725923538208
Epoch: 13, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.313 Vali Acc: 0.200 Test Loss: 1.313 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 14 cost time: 0.9745359420776367
Epoch: 14, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.311 Vali Acc: 0.200 Test Loss: 1.311 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 15 cost time: 1.0011308193206787
Epoch: 15, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.309 Vali Acc: 0.200 Test Loss: 1.309 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 16 cost time: 1.063971757888794
Epoch: 16, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.307 Vali Acc: 0.200 Test Loss: 1.307 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 17 cost time: 1.0768537521362305
Epoch: 17, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.305 Vali Acc: 0.200 Test Loss: 1.305 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 18 cost time: 1.6498160362243652
Epoch: 18, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.304 Vali Acc: 0.200 Test Loss: 1.304 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 19 cost time: 1.222884178161621
Epoch: 19, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.302 Vali Acc: 0.200 Test Loss: 1.302 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 20 cost time: 1.157301902770996
Epoch: 20, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.300 Vali Acc: 0.200 Test Loss: 1.300 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 21 cost time: 1.3064813613891602
Epoch: 21, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 22 cost time: 1.0463836193084717
Epoch: 22, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 23 cost time: 1.066979169845581
Epoch: 23, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.297 Vali Acc: 0.200 Test Loss: 1.297 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9523735046386719
Epoch: 24, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.296 Vali Acc: 0.200 Test Loss: 1.296 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2321960926055908
Epoch: 25, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.295 Vali Acc: 0.200 Test Loss: 1.295 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.022151231765747
Epoch: 26, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.294 Vali Acc: 0.200 Test Loss: 1.294 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.143298625946045
Epoch: 27, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 28 cost time: 0.8606226444244385
Epoch: 28, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 29 cost time: 1.209812879562378
Epoch: 29, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1069908142089844
Epoch: 30, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4573156833648682
Epoch: 31, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.296 Vali Acc: 0.333 Test Loss: 1.296 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333320).  Saving model ...
Epoch: 32 cost time: 1.0249228477478027
Epoch: 32, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399987).  Saving model ...
Epoch: 33 cost time: 0.911780595779419
Epoch: 33, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.300 Vali Acc: 0.400 Test Loss: 1.300 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.14454984664917
Epoch: 34, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.302 Vali Acc: 0.400 Test Loss: 1.302 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0150561332702637
Epoch: 35, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.304 Vali Acc: 0.400 Test Loss: 1.304 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1291491985321045
Epoch: 36, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.305 Vali Acc: 0.400 Test Loss: 1.305 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8897781372070312
Epoch: 37, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.307 Vali Acc: 0.400 Test Loss: 1.307 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9011595249176025
Epoch: 38, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.309 Vali Acc: 0.400 Test Loss: 1.309 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3766961097717285
Epoch: 39, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.015019178390503
Epoch: 40, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.312 Vali Acc: 0.400 Test Loss: 1.312 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0653495788574219
Epoch: 41, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2098541259765625
Epoch: 42, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.315 Vali Acc: 0.400 Test Loss: 1.315 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 67587
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.445753574371338
Epoch: 1, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.3408606052398682
Epoch: 2, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0441882610321045
Epoch: 3, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.248408317565918
Epoch: 4, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8362500667572021
Epoch: 5, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9580821990966797
Epoch: 6, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8237917423248291
Epoch: 7, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0647130012512207
Epoch: 8, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 1.0430922508239746
Epoch: 9, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.8796014785766602
Epoch: 10, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 1.204798698425293
Epoch: 11, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 1.2491090297698975
Epoch: 12, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 1.2785296440124512
Epoch: 13, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2859938144683838
Epoch: 14, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0286662578582764
Epoch: 15, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1676726341247559
Epoch: 16, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0569257736206055
Epoch: 17, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3019750118255615
Epoch: 18, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0090289115905762
Epoch: 19, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3008785247802734
Epoch: 20, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0337872505187988
Epoch: 21, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.961512565612793
Epoch: 22, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.9636330604553223
Epoch: 23, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 1.0785067081451416
Epoch: 24, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 1.2116549015045166
Epoch: 25, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 1.0414679050445557
Epoch: 26, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 1.0220086574554443
Epoch: 27, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 1.0410912036895752
Epoch: 28, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 1.1191074848175049
Epoch: 29, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 1.122631549835205
Epoch: 30, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 0.9631526470184326
Epoch: 31, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 32 cost time: 1.0961778163909912
Epoch: 32, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 33 cost time: 0.911492109298706
Epoch: 33, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 34 cost time: 0.8974001407623291
Epoch: 34, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 35 cost time: 1.0989980697631836
Epoch: 35, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 36 cost time: 0.985116720199585
Epoch: 36, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.003946304321289
Epoch: 37, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 38 cost time: 1.0260159969329834
Epoch: 38, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8677878379821777
Epoch: 39, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0884971618652344
Epoch: 40, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1742780208587646
Epoch: 41, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8063640594482422
Epoch: 42, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9723501205444336
Epoch: 43, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.346679925918579
Epoch: 44, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9899117946624756
Epoch: 45, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9238746166229248
Epoch: 46, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 47 cost time: 0.8817284107208252
Epoch: 47, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0153460502624512
Epoch: 48, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7736601829528809
Epoch: 49, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1185681819915771
Epoch: 50, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.1650903224945068
Epoch: 51, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9843287467956543
Epoch: 52, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.1504621505737305
Epoch: 53, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.9657671451568604
Epoch: 54, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.1898400783538818
Epoch: 55, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.1904487609863281
Epoch: 56, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 73283
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9101991653442383
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.868743896484375
Epoch: 2, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9725279808044434
Epoch: 3, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7496557235717773
Epoch: 4, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9991922378540039
Epoch: 5, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.9637231826782227
Epoch: 6, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.9564948081970215
Epoch: 7, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.9228901863098145
Epoch: 8, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7313613891601562
Epoch: 9, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.9478752613067627
Epoch: 10, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.9781231880187988
Epoch: 11, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.707531213760376
Epoch: 12, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.8813600540161133
Epoch: 13, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.8226902484893799
Epoch: 14, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.7776141166687012
Epoch: 15, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8915660381317139
Epoch: 16, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9508254528045654
Epoch: 17, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.160606861114502
Epoch: 18, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.031236171722412
Epoch: 19, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2404148578643799
Epoch: 20, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.854299783706665
Epoch: 21, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2165405750274658
Epoch: 22, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0254032611846924
Epoch: 23, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.768082857131958
Epoch: 24, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df128_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 78979
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.792104959487915
Epoch: 1, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.44148588180542
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.9258930683135986
Epoch: 3, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 1.0838136672973633
Epoch: 4, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0939416885375977
Epoch: 5, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9594993591308594
Epoch: 6, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7810375690460205
Epoch: 7, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8477485179901123
Epoch: 8, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.6785068511962891
Epoch: 9, Steps: 1 | Train Loss: 0.638 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 1.1238491535186768
Epoch: 10, Steps: 1 | Train Loss: 0.532 Vali Loss: 0.996 Vali Acc: 0.533 Test Loss: 0.996 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.885552167892456
Epoch: 11, Steps: 1 | Train Loss: 0.491 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.8863174915313721
Epoch: 12, Steps: 1 | Train Loss: 0.365 Vali Loss: 0.993 Vali Acc: 0.533 Test Loss: 0.993 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.710212230682373
Epoch: 13, Steps: 1 | Train Loss: 0.218 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.999401330947876
Epoch: 14, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1058831214904785
Epoch: 15, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1035406589508057
Epoch: 16, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2241871356964111
Epoch: 17, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9884779453277588
Epoch: 18, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2648828029632568
Epoch: 19, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8746862411499023
Epoch: 20, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.252145767211914
Epoch: 21, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 89283
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.319338083267212
Epoch: 1, Steps: 1 | Train Loss: 1.312 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.2715811729431152
Epoch: 2, Steps: 1 | Train Loss: 1.378 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.1247637271881104
Epoch: 3, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.0684361457824707
Epoch: 4, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 1.0523135662078857
Epoch: 5, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.180647611618042
Epoch: 6, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7233965396881104
Epoch: 7, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 1.1154611110687256
Epoch: 8, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.100 Vali Acc: 0.533 Test Loss: 1.100 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 1.118290901184082
Epoch: 9, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.9209315776824951
Epoch: 10, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.9040024280548096
Epoch: 11, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.248047113418579
Epoch: 12, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.065526008605957
Epoch: 13, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9791693687438965
Epoch: 14, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.8901083469390869
Epoch: 15, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.9185357093811035
Epoch: 16, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.9263231754302979
Epoch: 17, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.100555658340454
Epoch: 18, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1405229568481445
Epoch: 19, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.095 Vali Acc: 0.600 Test Loss: 1.095 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2559185028076172
Epoch: 20, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9057302474975586
Epoch: 21, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8621230125427246
Epoch: 22, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1481764316558838
Epoch: 23, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.117 Vali Acc: 0.533 Test Loss: 1.117 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.915132999420166
Epoch: 24, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7623515129089355
Epoch: 25, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8573808670043945
Epoch: 26, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 63299
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.031183242797852
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.208 Vali Acc: 0.133 Test Loss: 1.208 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.985008716583252
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
Validation loss decreased (-0.133321 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8168075084686279
Epoch: 3, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.1862695217132568
Epoch: 4, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 1.0024299621582031
Epoch: 5, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.9500288963317871
Epoch: 6, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8696389198303223
Epoch: 7, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.035032033920288
Epoch: 8, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8637728691101074
Epoch: 9, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9427111148834229
Epoch: 10, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0027856826782227
Epoch: 11, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2027442455291748
Epoch: 12, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7981889247894287
Epoch: 13, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8818690776824951
Epoch: 14, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 0.7168998718261719
Epoch: 15, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.211 Vali Acc: 0.467 Test Loss: 1.211 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.9605600833892822
Epoch: 16, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.212 Vali Acc: 0.467 Test Loss: 1.212 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8834772109985352
Epoch: 17, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.211 Vali Acc: 0.467 Test Loss: 1.211 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9967045783996582
Epoch: 18, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.210 Vali Acc: 0.467 Test Loss: 1.210 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 19 cost time: 0.9913406372070312
Epoch: 19, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.209 Vali Acc: 0.467 Test Loss: 1.209 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 20 cost time: 1.0720040798187256
Epoch: 20, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.207 Vali Acc: 0.467 Test Loss: 1.207 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 21 cost time: 0.9431581497192383
Epoch: 21, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.206 Vali Acc: 0.467 Test Loss: 1.206 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 22 cost time: 1.099869966506958
Epoch: 22, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1267437934875488
Epoch: 23, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8627429008483887
Epoch: 24, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.207 Vali Acc: 0.467 Test Loss: 1.207 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9789309501647949
Epoch: 25, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.210 Vali Acc: 0.467 Test Loss: 1.210 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.135519027709961
Epoch: 26, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.215 Vali Acc: 0.467 Test Loss: 1.215 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8837275505065918
Epoch: 27, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.222 Vali Acc: 0.467 Test Loss: 1.222 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9944708347320557
Epoch: 28, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.229 Vali Acc: 0.467 Test Loss: 1.229 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7977359294891357
Epoch: 29, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.235 Vali Acc: 0.467 Test Loss: 1.235 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4759180545806885
Epoch: 30, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.241 Vali Acc: 0.467 Test Loss: 1.241 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4868412017822266
Epoch: 31, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.247 Vali Acc: 0.467 Test Loss: 1.247 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 57347
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.64156436920166
Epoch: 1, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.9526784420013428
Epoch: 2, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.4674460887908936
Epoch: 3, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.9963061809539795
Epoch: 4, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.7276089191436768
Epoch: 5, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.9828345775604248
Epoch: 6, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.9300024509429932
Epoch: 7, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.9041731357574463
Epoch: 8, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 1.1544427871704102
Epoch: 9, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.9410879611968994
Epoch: 10, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.9071388244628906
Epoch: 11, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 1.1289482116699219
Epoch: 12, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 1.5600147247314453
Epoch: 13, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 1.0756747722625732
Epoch: 14, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 1.1021811962127686
Epoch: 15, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.9481687545776367
Epoch: 16, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 17 cost time: 0.9378130435943604
Epoch: 17, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 0.999706506729126
Epoch: 18, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 19 cost time: 1.1848106384277344
Epoch: 19, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8337230682373047
Epoch: 20, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9707567691802979
Epoch: 21, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9183468818664551
Epoch: 22, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1749391555786133
Epoch: 23, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1518168449401855
Epoch: 24, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8427548408508301
Epoch: 25, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0608952045440674
Epoch: 26, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7830920219421387
Epoch: 27, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 0.9590179920196533
Epoch: 28, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 1.282001256942749
Epoch: 29, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0910348892211914
Epoch: 30, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 31 cost time: 0.9484050273895264
Epoch: 31, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1705725193023682
Epoch: 32, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.140843391418457
Epoch: 33, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.011533260345459
Epoch: 34, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0805213451385498
Epoch: 35, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3159825801849365
Epoch: 36, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9148130416870117
Epoch: 37, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1329457759857178
Epoch: 38, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9224667549133301
Epoch: 39, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0647165775299072
Epoch: 40, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 56707
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5792768001556396
Epoch: 1, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.1620783805847168
Epoch: 2, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 1.07779860496521
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.9642777442932129
Epoch: 4, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8076210021972656
Epoch: 5, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.7823441028594971
Epoch: 6, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.846062183380127
Epoch: 7, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.7015745639801025
Epoch: 8, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 1.2515442371368408
Epoch: 9, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 1.1566319465637207
Epoch: 10, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 1.1503808498382568
Epoch: 11, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 1.2203099727630615
Epoch: 12, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 1.1098926067352295
Epoch: 13, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.4307682514190674
Epoch: 14, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.229684829711914
Epoch: 15, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6022489070892334
Epoch: 16, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2418103218078613
Epoch: 17, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1265203952789307
Epoch: 18, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9645559787750244
Epoch: 19, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2848351001739502
Epoch: 20, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9826781749725342
Epoch: 21, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1546988487243652
Epoch: 22, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9491262435913086
Epoch: 23, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 59331
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.216127395629883
Epoch: 1, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.0023818016052246
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.1545209884643555
Epoch: 3, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.161710262298584
Epoch: 4, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.582488775253296
Epoch: 5, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.0117430686950684
Epoch: 6, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.0429983139038086
Epoch: 7, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.202345848083496
Epoch: 8, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2017250061035156
Epoch: 9, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1799156665802002
Epoch: 10, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 1.2884857654571533
Epoch: 11, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 1.0574071407318115
Epoch: 12, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 1.1332457065582275
Epoch: 13, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.0624711513519287
Epoch: 14, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.4561657905578613
Epoch: 15, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 1.1171698570251465
Epoch: 16, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 1.6184148788452148
Epoch: 17, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 1.460676670074463
Epoch: 18, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.8861479759216309
Epoch: 19, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2222440242767334
Epoch: 20, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8641221523284912
Epoch: 21, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0899569988250732
Epoch: 22, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1638679504394531
Epoch: 23, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 1.3198230266571045
Epoch: 24, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.094132661819458
Epoch: 25, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.265277624130249
Epoch: 26, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4991662502288818
Epoch: 27, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.346975564956665
Epoch: 28, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2113993167877197
Epoch: 29, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.013 Vali Acc: 0.400 Test Loss: 1.013 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4227676391601562
Epoch: 30, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.010 Vali Acc: 0.400 Test Loss: 1.010 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1077299118041992
Epoch: 31, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.007 Vali Acc: 0.400 Test Loss: 1.007 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2274389266967773
Epoch: 32, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.006 Vali Acc: 0.400 Test Loss: 1.006 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4163315296173096
Epoch: 33, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.004 Vali Acc: 0.400 Test Loss: 1.004 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 65027
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7873170375823975
Epoch: 1, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8940503597259521
Epoch: 2, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.125981330871582
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.885399341583252
Epoch: 4, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8667056560516357
Epoch: 5, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 1.2149162292480469
Epoch: 6, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 1.15791654586792
Epoch: 7, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 8 cost time: 1.0813195705413818
Epoch: 8, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 1.2172813415527344
Epoch: 9, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 0.9790611267089844
Epoch: 10, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 1.023125171661377
Epoch: 11, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 12 cost time: 1.0464887619018555
Epoch: 12, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 1.3219730854034424
Epoch: 13, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 14 cost time: 1.2544076442718506
Epoch: 14, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.012 Vali Acc: 0.400 Test Loss: 1.012 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1982831954956055
Epoch: 15, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.009 Vali Acc: 0.400 Test Loss: 1.009 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2671163082122803
Epoch: 16, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.005 Vali Acc: 0.400 Test Loss: 1.005 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9988267421722412
Epoch: 17, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.002 Vali Acc: 0.400 Test Loss: 1.002 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1164319515228271
Epoch: 18, Steps: 1 | Train Loss: 0.625 Vali Loss: 0.998 Vali Acc: 0.467 Test Loss: 0.998 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 19 cost time: 1.1047718524932861
Epoch: 19, Steps: 1 | Train Loss: 0.418 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 20 cost time: 0.9939160346984863
Epoch: 20, Steps: 1 | Train Loss: 0.351 Vali Loss: 0.991 Vali Acc: 0.467 Test Loss: 0.991 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 21 cost time: 1.1668615341186523
Epoch: 21, Steps: 1 | Train Loss: 0.324 Vali Loss: 0.988 Vali Acc: 0.467 Test Loss: 0.988 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 22 cost time: 1.559227466583252
Epoch: 22, Steps: 1 | Train Loss: 0.281 Vali Loss: 0.985 Vali Acc: 0.467 Test Loss: 0.985 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 23 cost time: 1.0661952495574951
Epoch: 23, Steps: 1 | Train Loss: 0.311 Vali Loss: 0.982 Vali Acc: 0.467 Test Loss: 0.982 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 24 cost time: 1.001662015914917
Epoch: 24, Steps: 1 | Train Loss: 0.265 Vali Loss: 0.980 Vali Acc: 0.467 Test Loss: 0.980 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 25 cost time: 1.1654725074768066
Epoch: 25, Steps: 1 | Train Loss: 0.207 Vali Loss: 0.977 Vali Acc: 0.467 Test Loss: 0.977 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 26 cost time: 1.2225279808044434
Epoch: 26, Steps: 1 | Train Loss: 0.200 Vali Loss: 0.975 Vali Acc: 0.467 Test Loss: 0.975 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 27 cost time: 1.225337028503418
Epoch: 27, Steps: 1 | Train Loss: 0.183 Vali Loss: 0.974 Vali Acc: 0.467 Test Loss: 0.974 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 28 cost time: 1.1979846954345703
Epoch: 28, Steps: 1 | Train Loss: 0.151 Vali Loss: 0.973 Vali Acc: 0.467 Test Loss: 0.973 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 29 cost time: 1.339245319366455
Epoch: 29, Steps: 1 | Train Loss: 0.125 Vali Loss: 0.973 Vali Acc: 0.467 Test Loss: 0.973 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6839356422424316
Epoch: 30, Steps: 1 | Train Loss: 0.171 Vali Loss: 0.973 Vali Acc: 0.467 Test Loss: 0.973 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 31 cost time: 1.215376853942871
Epoch: 31, Steps: 1 | Train Loss: 0.111 Vali Loss: 0.973 Vali Acc: 0.467 Test Loss: 0.973 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.461512565612793
Epoch: 32, Steps: 1 | Train Loss: 0.100 Vali Loss: 0.974 Vali Acc: 0.467 Test Loss: 0.974 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2698614597320557
Epoch: 33, Steps: 1 | Train Loss: 0.107 Vali Loss: 0.975 Vali Acc: 0.467 Test Loss: 0.975 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.143329381942749
Epoch: 34, Steps: 1 | Train Loss: 0.077 Vali Loss: 0.976 Vali Acc: 0.467 Test Loss: 0.976 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.541886806488037
Epoch: 35, Steps: 1 | Train Loss: 0.068 Vali Loss: 0.979 Vali Acc: 0.400 Test Loss: 0.979 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6655077934265137
Epoch: 36, Steps: 1 | Train Loss: 0.062 Vali Loss: 0.981 Vali Acc: 0.400 Test Loss: 0.981 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.191549301147461
Epoch: 37, Steps: 1 | Train Loss: 0.055 Vali Loss: 0.985 Vali Acc: 0.400 Test Loss: 0.985 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2152256965637207
Epoch: 38, Steps: 1 | Train Loss: 0.039 Vali Loss: 0.988 Vali Acc: 0.400 Test Loss: 0.988 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2698891162872314
Epoch: 39, Steps: 1 | Train Loss: 0.038 Vali Loss: 0.992 Vali Acc: 0.400 Test Loss: 0.992 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0882725715637207
Epoch: 40, Steps: 1 | Train Loss: 0.033 Vali Loss: 0.995 Vali Acc: 0.400 Test Loss: 0.995 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm64_nh16_df64_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 70723
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7072391510009766
Epoch: 1, Steps: 1 | Train Loss: 1.409 Vali Loss: 1.198 Vali Acc: 0.133 Test Loss: 1.198 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.9032137393951416
Epoch: 2, Steps: 1 | Train Loss: 1.264 Vali Loss: 1.188 Vali Acc: 0.133 Test Loss: 1.188 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.9928536415100098
Epoch: 3, Steps: 1 | Train Loss: 1.446 Vali Loss: 1.179 Vali Acc: 0.133 Test Loss: 1.179 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133322).  Saving model ...
Epoch: 4 cost time: 1.016791582107544
Epoch: 4, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 5 cost time: 0.8740274906158447
Epoch: 5, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.168 Vali Acc: 0.133 Test Loss: 1.168 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 6 cost time: 0.9256877899169922
Epoch: 6, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 7 cost time: 1.2956206798553467
Epoch: 7, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.159 Vali Acc: 0.133 Test Loss: 1.159 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 8 cost time: 0.9468400478363037
Epoch: 8, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 1.1792597770690918
Epoch: 9, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 10 cost time: 0.8586452007293701
Epoch: 10, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.143 Vali Acc: 0.133 Test Loss: 1.143 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9849860668182373
Epoch: 11, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.138 Vali Acc: 0.133 Test Loss: 1.138 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0539531707763672
Epoch: 12, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 13 cost time: 1.0413470268249512
Epoch: 13, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 14 cost time: 1.0656280517578125
Epoch: 14, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.952223539352417
Epoch: 15, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 16 cost time: 1.157306432723999
Epoch: 16, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 17 cost time: 0.8789331912994385
Epoch: 17, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.841742753982544
Epoch: 18, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.8535246849060059
Epoch: 19, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7579312324523926
Epoch: 20, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9948825836181641
Epoch: 21, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9106080532073975
Epoch: 22, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 1.1160590648651123
Epoch: 23, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 1.150132656097412
Epoch: 24, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.9599297046661377
Epoch: 25, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 1.1510229110717773
Epoch: 26, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 0.8328092098236084
Epoch: 27, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9023590087890625
Epoch: 28, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.218113899230957
Epoch: 29, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1843981742858887
Epoch: 30, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5096790790557861
Epoch: 31, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6845123767852783
Epoch: 32, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4873123168945312
Epoch: 33, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9326932430267334
Epoch: 34, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0233991146087646
Epoch: 35, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0194754600524902
Epoch: 36, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 53059
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.817816257476807
Epoch: 1, Steps: 1 | Train Loss: 1.257 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 1.0650310516357422
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 1.3119537830352783
Epoch: 3, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1367902755737305
Epoch: 4, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2186055183410645
Epoch: 5, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5675361156463623
Epoch: 6, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2307426929473877
Epoch: 7, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3505730628967285
Epoch: 8, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 1.3284945487976074
Epoch: 9, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 1.0288739204406738
Epoch: 10, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 1.3371202945709229
Epoch: 11, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 1.2455122470855713
Epoch: 12, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 1.3010754585266113
Epoch: 13, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.9826819896697998
Epoch: 14, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.2842752933502197
Epoch: 15, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.9067652225494385
Epoch: 16, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 1.7977914810180664
Epoch: 17, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 1.6898274421691895
Epoch: 18, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 1.2989559173583984
Epoch: 19, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 1.1161961555480957
Epoch: 20, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 21 cost time: 1.2613673210144043
Epoch: 21, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 22 cost time: 0.9429550170898438
Epoch: 22, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 23 cost time: 1.195237636566162
Epoch: 23, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 24 cost time: 0.9163713455200195
Epoch: 24, Steps: 1 | Train Loss: 0.294 Vali Loss: 0.998 Vali Acc: 0.467 Test Loss: 0.998 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 25 cost time: 1.3248767852783203
Epoch: 25, Steps: 1 | Train Loss: 0.273 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 26 cost time: 1.6261308193206787
Epoch: 26, Steps: 1 | Train Loss: 0.252 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 27 cost time: 1.1625862121582031
Epoch: 27, Steps: 1 | Train Loss: 0.184 Vali Loss: 0.992 Vali Acc: 0.467 Test Loss: 0.992 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 28 cost time: 1.1243159770965576
Epoch: 28, Steps: 1 | Train Loss: 0.205 Vali Loss: 0.991 Vali Acc: 0.467 Test Loss: 0.991 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 29 cost time: 1.1947898864746094
Epoch: 29, Steps: 1 | Train Loss: 0.175 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 30 cost time: 0.9668583869934082
Epoch: 30, Steps: 1 | Train Loss: 0.141 Vali Loss: 0.986 Vali Acc: 0.533 Test Loss: 0.986 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 0.9711902141571045
Epoch: 31, Steps: 1 | Train Loss: 0.130 Vali Loss: 0.982 Vali Acc: 0.533 Test Loss: 0.982 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533324).  Saving model ...
Epoch: 32 cost time: 1.1953685283660889
Epoch: 32, Steps: 1 | Train Loss: 0.115 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 33 cost time: 1.2722935676574707
Epoch: 33, Steps: 1 | Train Loss: 0.099 Vali Loss: 0.977 Vali Acc: 0.600 Test Loss: 0.977 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599990).  Saving model ...
Epoch: 34 cost time: 1.414888858795166
Epoch: 34, Steps: 1 | Train Loss: 0.097 Vali Loss: 0.975 Vali Acc: 0.533 Test Loss: 0.975 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1932199001312256
Epoch: 35, Steps: 1 | Train Loss: 0.089 Vali Loss: 0.975 Vali Acc: 0.533 Test Loss: 0.975 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9962873458862305
Epoch: 36, Steps: 1 | Train Loss: 0.065 Vali Loss: 0.975 Vali Acc: 0.533 Test Loss: 0.975 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.258223295211792
Epoch: 37, Steps: 1 | Train Loss: 0.050 Vali Loss: 0.976 Vali Acc: 0.533 Test Loss: 0.976 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4294524192810059
Epoch: 38, Steps: 1 | Train Loss: 0.047 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1245918273925781
Epoch: 39, Steps: 1 | Train Loss: 0.047 Vali Loss: 0.980 Vali Acc: 0.533 Test Loss: 0.980 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0911824703216553
Epoch: 40, Steps: 1 | Train Loss: 0.042 Vali Loss: 0.981 Vali Acc: 0.533 Test Loss: 0.981 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1500744819641113
Epoch: 41, Steps: 1 | Train Loss: 0.036 Vali Loss: 0.982 Vali Acc: 0.533 Test Loss: 0.982 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1939129829406738
Epoch: 42, Steps: 1 | Train Loss: 0.032 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9996953010559082
Epoch: 43, Steps: 1 | Train Loss: 0.037 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 40067
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4119834899902344
Epoch: 1, Steps: 1 | Train Loss: 1.396 Vali Loss: 1.273 Vali Acc: 0.200 Test Loss: 1.273 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.9890444278717041
Epoch: 2, Steps: 1 | Train Loss: 1.465 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.8158812522888184
Epoch: 3, Steps: 1 | Train Loss: 1.426 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.9945130348205566
Epoch: 4, Steps: 1 | Train Loss: 1.351 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.8673269748687744
Epoch: 5, Steps: 1 | Train Loss: 1.254 Vali Loss: 1.272 Vali Acc: 0.267 Test Loss: 1.272 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.8684039115905762
Epoch: 6, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0064618587493896
Epoch: 7, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.273 Vali Acc: 0.200 Test Loss: 1.273 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.922330379486084
Epoch: 8, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.272 Vali Acc: 0.200 Test Loss: 1.272 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.939744234085083
Epoch: 9, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.271 Vali Acc: 0.200 Test Loss: 1.271 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.120495319366455
Epoch: 10, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.270 Vali Acc: 0.200 Test Loss: 1.270 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.075171947479248
Epoch: 11, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.268 Vali Acc: 0.200 Test Loss: 1.268 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3469090461730957
Epoch: 12, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.265 Vali Acc: 0.200 Test Loss: 1.265 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0341131687164307
Epoch: 13, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 14 cost time: 1.191237449645996
Epoch: 14, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 15 cost time: 1.4375720024108887
Epoch: 15, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 16 cost time: 1.0857157707214355
Epoch: 16, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 17 cost time: 0.9918439388275146
Epoch: 17, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 18 cost time: 1.2918288707733154
Epoch: 18, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 19 cost time: 1.2688000202178955
Epoch: 19, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8084397315979004
Epoch: 20, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.240 Vali Acc: 0.200 Test Loss: 1.240 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9778385162353516
Epoch: 21, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 22 cost time: 0.8065047264099121
Epoch: 22, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 23 cost time: 0.9532468318939209
Epoch: 23, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 24 cost time: 1.1089184284210205
Epoch: 24, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 25 cost time: 1.2089662551879883
Epoch: 25, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 26 cost time: 1.1120507717132568
Epoch: 26, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 27 cost time: 1.1093685626983643
Epoch: 27, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 28 cost time: 1.2256362438201904
Epoch: 28, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 29 cost time: 1.2358322143554688
Epoch: 29, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 30 cost time: 0.7435832023620605
Epoch: 30, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 31 cost time: 1.0366506576538086
Epoch: 31, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 32 cost time: 0.9607648849487305
Epoch: 32, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 33 cost time: 0.7918262481689453
Epoch: 33, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 34 cost time: 0.8191006183624268
Epoch: 34, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 35 cost time: 1.1129276752471924
Epoch: 35, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 36 cost time: 0.9728949069976807
Epoch: 36, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 37 cost time: 1.3810677528381348
Epoch: 37, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1077427864074707
Epoch: 38, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.281165599822998
Epoch: 39, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.192 Vali Acc: 0.467 Test Loss: 1.192 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 40 cost time: 1.3358385562896729
Epoch: 40, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.193 Vali Acc: 0.467 Test Loss: 1.193 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0917534828186035
Epoch: 41, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.193 Vali Acc: 0.467 Test Loss: 1.193 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.004110336303711
Epoch: 42, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.194 Vali Acc: 0.467 Test Loss: 1.194 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3447134494781494
Epoch: 43, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.195 Vali Acc: 0.467 Test Loss: 1.195 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.3797638416290283
Epoch: 44, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.222557783126831
Epoch: 45, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.197 Vali Acc: 0.467 Test Loss: 1.197 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9365158081054688
Epoch: 46, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.199 Vali Acc: 0.467 Test Loss: 1.199 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.1018238067626953
Epoch: 47, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.200 Vali Acc: 0.467 Test Loss: 1.200 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.814511775970459
Epoch: 48, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.202 Vali Acc: 0.467 Test Loss: 1.202 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.4216907024383545
Epoch: 49, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.203 Vali Acc: 0.467 Test Loss: 1.203 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37091
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.988806962966919
Epoch: 1, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8574588298797607
Epoch: 2, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.9197278022766113
Epoch: 3, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7755022048950195
Epoch: 4, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8580563068389893
Epoch: 5, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.136911392211914
Epoch: 6, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2258758544921875
Epoch: 7, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0985643863677979
Epoch: 8, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8601231575012207
Epoch: 9, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1446406841278076
Epoch: 10, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.099031686782837
Epoch: 11, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.376075267791748
Epoch: 12, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9921221733093262
Epoch: 13, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 36771
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.890536069869995
Epoch: 1, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.462 Vali Acc: 0.333 Test Loss: 1.462 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 1.325946569442749
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.445 Vali Acc: 0.333 Test Loss: 1.445 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 1.0676438808441162
Epoch: 3, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.429 Vali Acc: 0.333 Test Loss: 1.429 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 4 cost time: 1.3854026794433594
Epoch: 4, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.415 Vali Acc: 0.333 Test Loss: 1.415 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 1.4639034271240234
Epoch: 5, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.402 Vali Acc: 0.267 Test Loss: 1.402 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3209397792816162
Epoch: 6, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.392 Vali Acc: 0.267 Test Loss: 1.392 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.406419277191162
Epoch: 7, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.381 Vali Acc: 0.267 Test Loss: 1.381 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1409127712249756
Epoch: 8, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.371 Vali Acc: 0.267 Test Loss: 1.371 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.27787184715271
Epoch: 9, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.362 Vali Acc: 0.333 Test Loss: 1.362 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 1.0105466842651367
Epoch: 10, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.353 Vali Acc: 0.267 Test Loss: 1.353 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9451043605804443
Epoch: 11, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.344 Vali Acc: 0.267 Test Loss: 1.344 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0077574253082275
Epoch: 12, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.335 Vali Acc: 0.267 Test Loss: 1.335 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.112560510635376
Epoch: 13, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.327 Vali Acc: 0.267 Test Loss: 1.327 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0711743831634521
Epoch: 14, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.318 Vali Acc: 0.267 Test Loss: 1.318 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2869575023651123
Epoch: 15, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.311 Vali Acc: 0.267 Test Loss: 1.311 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8935132026672363
Epoch: 16, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.303 Vali Acc: 0.267 Test Loss: 1.303 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3130097389221191
Epoch: 17, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3338253498077393
Epoch: 18, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5393235683441162
Epoch: 19, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 38083
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9363083839416504
Epoch: 1, Steps: 1 | Train Loss: 1.363 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.3382186889648438
Epoch: 2, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 1.2199146747589111
Epoch: 3, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 1.2641749382019043
Epoch: 4, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.1803104877471924
Epoch: 5, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.175 Vali Acc: 0.467 Test Loss: 1.175 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 1.3202674388885498
Epoch: 6, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.172 Vali Acc: 0.533 Test Loss: 1.172 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 1.123356580734253
Epoch: 7, Steps: 1 | Train Loss: 1.226 Vali Loss: 1.170 Vali Acc: 0.533 Test Loss: 1.170 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.9170746803283691
Epoch: 8, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.168 Vali Acc: 0.533 Test Loss: 1.168 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 1.2374804019927979
Epoch: 9, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1356933116912842
Epoch: 10, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8336477279663086
Epoch: 11, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8674321174621582
Epoch: 12, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0349328517913818
Epoch: 13, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.13557767868042
Epoch: 14, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1978530883789062
Epoch: 15, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.063664197921753
Epoch: 16, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8915565013885498
Epoch: 17, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1932342052459717
Epoch: 18, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 40931
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1715476512908936
Epoch: 1, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.277 Vali Acc: 0.067 Test Loss: 1.277 Test Acc: 0.067
Validation loss decreased (inf --> -0.066654).  Saving model ...
Epoch: 2 cost time: 0.8300752639770508
Epoch: 2, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.277 Vali Acc: 0.067 Test Loss: 1.277 Test Acc: 0.067
Validation loss decreased (-0.066654 --> -0.066654).  Saving model ...
Epoch: 3 cost time: 0.7593657970428467
Epoch: 3, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.276 Vali Acc: 0.067 Test Loss: 1.276 Test Acc: 0.067
Validation loss decreased (-0.066654 --> -0.066654).  Saving model ...
Epoch: 4 cost time: 1.3356995582580566
Epoch: 4, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.276 Vali Acc: 0.133 Test Loss: 1.276 Test Acc: 0.133
Validation loss decreased (-0.066654 --> -0.133321).  Saving model ...
Epoch: 5 cost time: 1.0286290645599365
Epoch: 5, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.276 Vali Acc: 0.133 Test Loss: 1.276 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 6 cost time: 0.9091756343841553
Epoch: 6, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.276 Vali Acc: 0.133 Test Loss: 1.276 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.973198652267456
Epoch: 7, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.276 Vali Acc: 0.133 Test Loss: 1.276 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9414288997650146
Epoch: 8, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.275 Vali Acc: 0.133 Test Loss: 1.275 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 9 cost time: 1.09891939163208
Epoch: 9, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.274 Vali Acc: 0.133 Test Loss: 1.274 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 10 cost time: 1.0092120170593262
Epoch: 10, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.274 Vali Acc: 0.133 Test Loss: 1.274 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 11 cost time: 0.7973120212554932
Epoch: 11, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.272 Vali Acc: 0.133 Test Loss: 1.272 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 12 cost time: 1.0486748218536377
Epoch: 12, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.271 Vali Acc: 0.200 Test Loss: 1.271 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199987).  Saving model ...
Epoch: 13 cost time: 0.9774184226989746
Epoch: 13, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.268 Vali Acc: 0.200 Test Loss: 1.268 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 14 cost time: 0.8641097545623779
Epoch: 14, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.266 Vali Acc: 0.200 Test Loss: 1.266 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 15 cost time: 0.7038941383361816
Epoch: 15, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 16 cost time: 0.6886703968048096
Epoch: 16, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 17 cost time: 0.8638637065887451
Epoch: 17, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.258 Vali Acc: 0.200 Test Loss: 1.258 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 18 cost time: 0.7331132888793945
Epoch: 18, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 19 cost time: 0.8490278720855713
Epoch: 19, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.252 Vali Acc: 0.200 Test Loss: 1.252 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 20 cost time: 0.7340290546417236
Epoch: 20, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.249 Vali Acc: 0.200 Test Loss: 1.249 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199988).  Saving model ...
Epoch: 21 cost time: 0.7318723201751709
Epoch: 21, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 22 cost time: 0.799919605255127
Epoch: 22, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 23 cost time: 0.7765810489654541
Epoch: 23, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 24 cost time: 0.7284538745880127
Epoch: 24, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 25 cost time: 1.3086011409759521
Epoch: 25, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 26 cost time: 1.141878366470337
Epoch: 26, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 27 cost time: 0.8931703567504883
Epoch: 27, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 28 cost time: 0.7829771041870117
Epoch: 28, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 29 cost time: 0.969322919845581
Epoch: 29, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 30 cost time: 0.9327423572540283
Epoch: 30, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 31 cost time: 0.706082820892334
Epoch: 31, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 32 cost time: 0.8465769290924072
Epoch: 32, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 33 cost time: 0.7899448871612549
Epoch: 33, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 34 cost time: 0.9208593368530273
Epoch: 34, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 35 cost time: 1.201277494430542
Epoch: 35, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 36 cost time: 0.9585742950439453
Epoch: 36, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 37 cost time: 0.9584472179412842
Epoch: 37, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 38 cost time: 1.2904605865478516
Epoch: 38, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 39 cost time: 1.1971638202667236
Epoch: 39, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 40 cost time: 0.9647328853607178
Epoch: 40, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 41 cost time: 0.847428560256958
Epoch: 41, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 42 cost time: 0.9188687801361084
Epoch: 42, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 43 cost time: 0.8808159828186035
Epoch: 43, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 44 cost time: 0.9785773754119873
Epoch: 44, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 45 cost time: 0.9532372951507568
Epoch: 45, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 46 cost time: 0.8687570095062256
Epoch: 46, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 47 cost time: 0.8844938278198242
Epoch: 47, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 48 cost time: 0.9738268852233887
Epoch: 48, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 49 cost time: 0.8748269081115723
Epoch: 49, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 50 cost time: 0.8443467617034912
Epoch: 50, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 51 cost time: 0.9734373092651367
Epoch: 51, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7641916275024414
Epoch: 52, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 53 cost time: 0.8958604335784912
Epoch: 53, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 54 cost time: 1.0102272033691406
Epoch: 54, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 55 cost time: 0.883941650390625
Epoch: 55, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 56 cost time: 1.0981240272521973
Epoch: 56, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 57 cost time: 0.7636890411376953
Epoch: 57, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 58 cost time: 1.2866454124450684
Epoch: 58, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 59 cost time: 1.0708122253417969
Epoch: 59, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9891469478607178
Epoch: 60, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9322171211242676
Epoch: 61, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8426022529602051
Epoch: 62, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.8953711986541748
Epoch: 63, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.8914554119110107
Epoch: 64, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 65 cost time: 1.2579247951507568
Epoch: 65, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 66 cost time: 0.8100769519805908
Epoch: 66, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.5460679531097412
Epoch: 67, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1748838424682617
Epoch: 68, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.8926842212677002
Epoch: 69, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.1421198844909668
Epoch: 70, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.9617753028869629
Epoch: 71, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.0886132717132568
Epoch: 72, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.3494126796722412
Epoch: 73, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.1353466510772705
Epoch: 74, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.1788349151611328
Epoch: 75, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 76 cost time: 0.9724540710449219
Epoch: 76, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 77 cost time: 1.0990428924560547
Epoch: 77, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 78 cost time: 0.9686496257781982
Epoch: 78, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.953909158706665
Epoch: 79, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.9597320556640625
Epoch: 80, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.0335032939910889
Epoch: 81, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.0260701179504395
Epoch: 82, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.7100791931152344
Epoch: 83, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 1.0330448150634766
Epoch: 84, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.7558658123016357
Epoch: 85, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.9246563911437988
Epoch: 86, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 1.0216436386108398
Epoch: 87, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df256_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 43779
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.892273187637329
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.265 Vali Acc: 0.467 Test Loss: 1.265 Test Acc: 0.467
Validation loss decreased (inf --> -0.466654).  Saving model ...
Epoch: 2 cost time: 1.699103832244873
Epoch: 2, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.235 Vali Acc: 0.467 Test Loss: 1.235 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 3 cost time: 1.132087230682373
Epoch: 3, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8891057968139648
Epoch: 4, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1794841289520264
Epoch: 5, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9494287967681885
Epoch: 6, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3081231117248535
Epoch: 7, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1765239238739014
Epoch: 8, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5250563621520996
Epoch: 9, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.091954231262207
Epoch: 10, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0148847103118896
Epoch: 11, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9863636493682861
Epoch: 12, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 44739
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.6297855377197266
Epoch: 1, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.042259931564331
Epoch: 2, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.2171905040740967
Epoch: 3, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.0122747421264648
Epoch: 4, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 1.0060913562774658
Epoch: 5, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.8244988918304443
Epoch: 6, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.9069201946258545
Epoch: 7, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.8914282321929932
Epoch: 8, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.8722901344299316
Epoch: 9, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.9226353168487549
Epoch: 10, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.8790836334228516
Epoch: 11, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 1.163306474685669
Epoch: 12, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 1.1905500888824463
Epoch: 13, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 1.3206870555877686
Epoch: 14, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 1.09757399559021
Epoch: 15, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 16 cost time: 1.0828857421875
Epoch: 16, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0866687297821045
Epoch: 17, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8927669525146484
Epoch: 18, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 19 cost time: 0.9303534030914307
Epoch: 19, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 20 cost time: 1.3760993480682373
Epoch: 20, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8928399085998535
Epoch: 21, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 22 cost time: 0.8776161670684814
Epoch: 22, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 23 cost time: 1.2786877155303955
Epoch: 23, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 24 cost time: 0.7580897808074951
Epoch: 24, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 25 cost time: 1.1360867023468018
Epoch: 25, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 26 cost time: 0.8579440116882324
Epoch: 26, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 27 cost time: 0.8460845947265625
Epoch: 27, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 28 cost time: 0.71840500831604
Epoch: 28, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9280409812927246
Epoch: 29, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 30 cost time: 1.3187532424926758
Epoch: 30, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 31 cost time: 0.8217620849609375
Epoch: 31, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 32 cost time: 0.898977518081665
Epoch: 32, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 33 cost time: 1.3927257061004639
Epoch: 33, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.152 Vali Acc: 0.533 Test Loss: 1.152 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 34 cost time: 0.904827356338501
Epoch: 34, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9503600597381592
Epoch: 35, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1827621459960938
Epoch: 36, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.319720983505249
Epoch: 37, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3713617324829102
Epoch: 38, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9419879913330078
Epoch: 39, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8647885322570801
Epoch: 40, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9110386371612549
Epoch: 41, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0832107067108154
Epoch: 42, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9921224117279053
Epoch: 43, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 31747
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5535738468170166
Epoch: 1, Steps: 1 | Train Loss: 1.232 Vali Loss: 0.964 Vali Acc: 0.467 Test Loss: 0.964 Test Acc: 0.467
Validation loss decreased (inf --> -0.466657).  Saving model ...
Epoch: 2 cost time: 0.8860037326812744
Epoch: 2, Steps: 1 | Train Loss: 1.183 Vali Loss: 0.960 Vali Acc: 0.467 Test Loss: 0.960 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 3 cost time: 1.007253885269165
Epoch: 3, Steps: 1 | Train Loss: 1.118 Vali Loss: 0.957 Vali Acc: 0.467 Test Loss: 0.957 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 4 cost time: 1.0904593467712402
Epoch: 4, Steps: 1 | Train Loss: 1.046 Vali Loss: 0.953 Vali Acc: 0.467 Test Loss: 0.953 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 5 cost time: 1.3781800270080566
Epoch: 5, Steps: 1 | Train Loss: 1.108 Vali Loss: 0.951 Vali Acc: 0.533 Test Loss: 0.951 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 6 cost time: 1.0737106800079346
Epoch: 6, Steps: 1 | Train Loss: 1.009 Vali Loss: 0.949 Vali Acc: 0.533 Test Loss: 0.949 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 7 cost time: 0.9722416400909424
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 0.947 Vali Acc: 0.533 Test Loss: 0.947 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 8 cost time: 0.8718216419219971
Epoch: 8, Steps: 1 | Train Loss: 1.131 Vali Loss: 0.945 Vali Acc: 0.533 Test Loss: 0.945 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 9 cost time: 1.0831782817840576
Epoch: 9, Steps: 1 | Train Loss: 1.011 Vali Loss: 0.943 Vali Acc: 0.533 Test Loss: 0.943 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 10 cost time: 0.9667019844055176
Epoch: 10, Steps: 1 | Train Loss: 0.869 Vali Loss: 0.940 Vali Acc: 0.533 Test Loss: 0.940 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 11 cost time: 1.098952054977417
Epoch: 11, Steps: 1 | Train Loss: 0.874 Vali Loss: 0.937 Vali Acc: 0.533 Test Loss: 0.937 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 12 cost time: 1.0813617706298828
Epoch: 12, Steps: 1 | Train Loss: 0.870 Vali Loss: 0.935 Vali Acc: 0.600 Test Loss: 0.935 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599991).  Saving model ...
Epoch: 13 cost time: 0.9797778129577637
Epoch: 13, Steps: 1 | Train Loss: 0.772 Vali Loss: 0.931 Vali Acc: 0.600 Test Loss: 0.931 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 14 cost time: 1.6422080993652344
Epoch: 14, Steps: 1 | Train Loss: 0.675 Vali Loss: 0.928 Vali Acc: 0.533 Test Loss: 0.928 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1212451457977295
Epoch: 15, Steps: 1 | Train Loss: 0.820 Vali Loss: 0.925 Vali Acc: 0.533 Test Loss: 0.925 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5486087799072266
Epoch: 16, Steps: 1 | Train Loss: 0.734 Vali Loss: 0.921 Vali Acc: 0.600 Test Loss: 0.921 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 17 cost time: 0.9771990776062012
Epoch: 17, Steps: 1 | Train Loss: 0.673 Vali Loss: 0.918 Vali Acc: 0.600 Test Loss: 0.918 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 18 cost time: 0.9447965621948242
Epoch: 18, Steps: 1 | Train Loss: 0.576 Vali Loss: 0.915 Vali Acc: 0.600 Test Loss: 0.915 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 19 cost time: 1.0015687942504883
Epoch: 19, Steps: 1 | Train Loss: 0.639 Vali Loss: 0.911 Vali Acc: 0.600 Test Loss: 0.911 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 20 cost time: 1.0587878227233887
Epoch: 20, Steps: 1 | Train Loss: 0.590 Vali Loss: 0.908 Vali Acc: 0.600 Test Loss: 0.908 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 21 cost time: 1.4161381721496582
Epoch: 21, Steps: 1 | Train Loss: 0.476 Vali Loss: 0.905 Vali Acc: 0.600 Test Loss: 0.905 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 22 cost time: 0.8765661716461182
Epoch: 22, Steps: 1 | Train Loss: 0.418 Vali Loss: 0.902 Vali Acc: 0.600 Test Loss: 0.902 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 23 cost time: 0.9359958171844482
Epoch: 23, Steps: 1 | Train Loss: 0.429 Vali Loss: 0.899 Vali Acc: 0.600 Test Loss: 0.899 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 24 cost time: 1.2335727214813232
Epoch: 24, Steps: 1 | Train Loss: 0.445 Vali Loss: 0.896 Vali Acc: 0.667 Test Loss: 0.896 Test Acc: 0.667
Validation loss decreased (-0.599991 --> -0.666658).  Saving model ...
Epoch: 25 cost time: 1.3991656303405762
Epoch: 25, Steps: 1 | Train Loss: 0.393 Vali Loss: 0.894 Vali Acc: 0.667 Test Loss: 0.894 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666658).  Saving model ...
Epoch: 26 cost time: 1.216214895248413
Epoch: 26, Steps: 1 | Train Loss: 0.308 Vali Loss: 0.891 Vali Acc: 0.667 Test Loss: 0.891 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666658).  Saving model ...
Epoch: 27 cost time: 1.2762691974639893
Epoch: 27, Steps: 1 | Train Loss: 0.268 Vali Loss: 0.889 Vali Acc: 0.600 Test Loss: 0.889 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8134560585021973
Epoch: 28, Steps: 1 | Train Loss: 0.330 Vali Loss: 0.887 Vali Acc: 0.600 Test Loss: 0.887 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4902169704437256
Epoch: 29, Steps: 1 | Train Loss: 0.277 Vali Loss: 0.886 Vali Acc: 0.600 Test Loss: 0.886 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.116401195526123
Epoch: 30, Steps: 1 | Train Loss: 0.232 Vali Loss: 0.886 Vali Acc: 0.533 Test Loss: 0.886 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.182612657546997
Epoch: 31, Steps: 1 | Train Loss: 0.227 Vali Loss: 0.885 Vali Acc: 0.533 Test Loss: 0.885 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3525538444519043
Epoch: 32, Steps: 1 | Train Loss: 0.154 Vali Loss: 0.885 Vali Acc: 0.533 Test Loss: 0.885 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1239995956420898
Epoch: 33, Steps: 1 | Train Loss: 0.162 Vali Loss: 0.884 Vali Acc: 0.533 Test Loss: 0.884 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2340247631072998
Epoch: 34, Steps: 1 | Train Loss: 0.138 Vali Loss: 0.883 Vali Acc: 0.600 Test Loss: 0.883 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0066120624542236
Epoch: 35, Steps: 1 | Train Loss: 0.132 Vali Loss: 0.883 Vali Acc: 0.600 Test Loss: 0.883 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.4136300086975098
Epoch: 36, Steps: 1 | Train Loss: 0.132 Vali Loss: 0.882 Vali Acc: 0.600 Test Loss: 0.882 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 28771
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.314636468887329
Epoch: 1, Steps: 1 | Train Loss: 1.386 Vali Loss: 1.329 Vali Acc: 0.200 Test Loss: 1.329 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 1.4002196788787842
Epoch: 2, Steps: 1 | Train Loss: 1.395 Vali Loss: 1.328 Vali Acc: 0.200 Test Loss: 1.328 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 1.2109034061431885
Epoch: 3, Steps: 1 | Train Loss: 1.316 Vali Loss: 1.326 Vali Acc: 0.200 Test Loss: 1.326 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.982501745223999
Epoch: 4, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.324 Vali Acc: 0.200 Test Loss: 1.324 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 1.0846312046051025
Epoch: 5, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.322 Vali Acc: 0.133 Test Loss: 1.322 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3862578868865967
Epoch: 6, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.322 Vali Acc: 0.133 Test Loss: 1.322 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2777767181396484
Epoch: 7, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.321 Vali Acc: 0.133 Test Loss: 1.321 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5881507396697998
Epoch: 8, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.320 Vali Acc: 0.133 Test Loss: 1.320 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3360109329223633
Epoch: 9, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.318 Vali Acc: 0.133 Test Loss: 1.318 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0664725303649902
Epoch: 10, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.316 Vali Acc: 0.133 Test Loss: 1.316 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7817490100860596
Epoch: 11, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.314 Vali Acc: 0.133 Test Loss: 1.314 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.889448881149292
Epoch: 12, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.312 Vali Acc: 0.133 Test Loss: 1.312 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.038081169128418
Epoch: 13, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.309 Vali Acc: 0.133 Test Loss: 1.309 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9069323539733887
Epoch: 14, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.306 Vali Acc: 0.133 Test Loss: 1.306 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 28451
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.654106616973877
Epoch: 1, Steps: 1 | Train Loss: 1.356 Vali Loss: 1.274 Vali Acc: 0.200 Test Loss: 1.274 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.9744582176208496
Epoch: 2, Steps: 1 | Train Loss: 1.322 Vali Loss: 1.276 Vali Acc: 0.200 Test Loss: 1.276 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.417102336883545
Epoch: 3, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.278 Vali Acc: 0.200 Test Loss: 1.278 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1257436275482178
Epoch: 4, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.280 Vali Acc: 0.200 Test Loss: 1.280 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7975485324859619
Epoch: 5, Steps: 1 | Train Loss: 1.315 Vali Loss: 1.281 Vali Acc: 0.200 Test Loss: 1.281 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9825479984283447
Epoch: 6, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.284 Vali Acc: 0.200 Test Loss: 1.284 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1109802722930908
Epoch: 7, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.287 Vali Acc: 0.200 Test Loss: 1.287 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.277113914489746
Epoch: 8, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.289 Vali Acc: 0.200 Test Loss: 1.289 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6024668216705322
Epoch: 9, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 1.0270216464996338
Epoch: 10, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.292 Vali Acc: 0.267 Test Loss: 1.292 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5789589881896973
Epoch: 11, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.292 Vali Acc: 0.200 Test Loss: 1.292 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8844177722930908
Epoch: 12, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.292 Vali Acc: 0.200 Test Loss: 1.292 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1655285358428955
Epoch: 13, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.292 Vali Acc: 0.200 Test Loss: 1.292 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9017679691314697
Epoch: 14, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.290 Vali Acc: 0.200 Test Loss: 1.290 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.109302282333374
Epoch: 15, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.290 Vali Acc: 0.200 Test Loss: 1.290 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3469598293304443
Epoch: 16, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.288 Vali Acc: 0.200 Test Loss: 1.288 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4277164936065674
Epoch: 17, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.287 Vali Acc: 0.200 Test Loss: 1.287 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1581430435180664
Epoch: 18, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.285 Vali Acc: 0.200 Test Loss: 1.285 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5411200523376465
Epoch: 19, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.283 Vali Acc: 0.200 Test Loss: 1.283 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 29763
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.447580575942993
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.386 Vali Acc: 0.333 Test Loss: 1.386 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 1.0278446674346924
Epoch: 2, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.368 Vali Acc: 0.333 Test Loss: 1.368 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 1.155616044998169
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.353 Vali Acc: 0.333 Test Loss: 1.353 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.9754753112792969
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.340 Vali Acc: 0.333 Test Loss: 1.340 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 1.6600062847137451
Epoch: 5, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.328 Vali Acc: 0.333 Test Loss: 1.328 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 1.2564024925231934
Epoch: 6, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.318 Vali Acc: 0.333 Test Loss: 1.318 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 1.1210880279541016
Epoch: 7, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.310 Vali Acc: 0.333 Test Loss: 1.310 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 1.2699792385101318
Epoch: 8, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.302 Vali Acc: 0.333 Test Loss: 1.302 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 9 cost time: 0.9086551666259766
Epoch: 9, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.295 Vali Acc: 0.333 Test Loss: 1.295 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 1.2072405815124512
Epoch: 10, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.289 Vali Acc: 0.333 Test Loss: 1.289 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 11 cost time: 1.0805768966674805
Epoch: 11, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.283 Vali Acc: 0.333 Test Loss: 1.283 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 1.009568214416504
Epoch: 12, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.277 Vali Acc: 0.267 Test Loss: 1.277 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2778685092926025
Epoch: 13, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.272 Vali Acc: 0.267 Test Loss: 1.272 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1681888103485107
Epoch: 14, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0948224067687988
Epoch: 15, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2274911403656006
Epoch: 16, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.259 Vali Acc: 0.200 Test Loss: 1.259 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0804402828216553
Epoch: 17, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.254 Vali Acc: 0.200 Test Loss: 1.254 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9103343486785889
Epoch: 18, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3544890880584717
Epoch: 19, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0755834579467773
Epoch: 20, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8889856338500977
Epoch: 21, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 22 cost time: 1.2519495487213135
Epoch: 22, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 23 cost time: 0.9603257179260254
Epoch: 23, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 24 cost time: 1.0725674629211426
Epoch: 24, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 25 cost time: 0.9755344390869141
Epoch: 25, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 26 cost time: 0.8478167057037354
Epoch: 26, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 27 cost time: 0.941983699798584
Epoch: 27, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 28 cost time: 1.1204123497009277
Epoch: 28, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 29 cost time: 0.8420734405517578
Epoch: 29, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 30 cost time: 0.7390387058258057
Epoch: 30, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 31 cost time: 1.2950632572174072
Epoch: 31, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 32 cost time: 0.9922986030578613
Epoch: 32, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 33 cost time: 0.9208047389984131
Epoch: 33, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 34 cost time: 0.9030008316040039
Epoch: 34, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 35 cost time: 0.8278193473815918
Epoch: 35, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 36 cost time: 0.7664244174957275
Epoch: 36, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 37 cost time: 0.7542340755462646
Epoch: 37, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 38 cost time: 1.102895975112915
Epoch: 38, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 39 cost time: 1.0392568111419678
Epoch: 39, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 40 cost time: 0.7946186065673828
Epoch: 40, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 41 cost time: 0.7919135093688965
Epoch: 41, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 42 cost time: 0.9689686298370361
Epoch: 42, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 43 cost time: 0.7591052055358887
Epoch: 43, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 44 cost time: 1.0727436542510986
Epoch: 44, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 45 cost time: 0.7726333141326904
Epoch: 45, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 46 cost time: 0.839224100112915
Epoch: 46, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 47 cost time: 0.8507115840911865
Epoch: 47, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 48 cost time: 0.9479677677154541
Epoch: 48, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 49 cost time: 0.9148478507995605
Epoch: 49, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 50 cost time: 1.030839443206787
Epoch: 50, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 51 cost time: 0.7171816825866699
Epoch: 51, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 52 cost time: 1.2689754962921143
Epoch: 52, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 53 cost time: 1.3190908432006836
Epoch: 53, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 54 cost time: 1.2280688285827637
Epoch: 54, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 55 cost time: 0.899822473526001
Epoch: 55, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 56 cost time: 0.8727352619171143
Epoch: 56, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 57 cost time: 0.8382408618927002
Epoch: 57, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 58 cost time: 0.9396693706512451
Epoch: 58, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 59 cost time: 0.7828426361083984
Epoch: 59, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 60 cost time: 0.7497162818908691
Epoch: 60, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 61 cost time: 0.9758238792419434
Epoch: 61, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 62 cost time: 0.871281623840332
Epoch: 62, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7319073677062988
Epoch: 63, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 64 cost time: 0.7928440570831299
Epoch: 64, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7666823863983154
Epoch: 65, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.9745759963989258
Epoch: 66, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 67 cost time: 0.749222993850708
Epoch: 67, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.928318977355957
Epoch: 68, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7988505363464355
Epoch: 69, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.9609465599060059
Epoch: 70, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.8751029968261719
Epoch: 71, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.304600715637207
Epoch: 72, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.1305725574493408
Epoch: 73, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.9201626777648926
Epoch: 74, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.8655297756195068
Epoch: 75, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.0266969203948975
Epoch: 76, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 32611
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.6365771293640137
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.0254826545715332
Epoch: 2, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.1230671405792236
Epoch: 3, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.8217947483062744
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 1.085843563079834
Epoch: 5, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.9661245346069336
Epoch: 6, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 1.053328514099121
Epoch: 7, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.7862215042114258
Epoch: 8, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 1.1166086196899414
Epoch: 9, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.9142215251922607
Epoch: 10, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 1.0768787860870361
Epoch: 11, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.9253334999084473
Epoch: 12, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.8864922523498535
Epoch: 13, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 1.2748875617980957
Epoch: 14, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 0.9485476016998291
Epoch: 15, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 1.1890764236450195
Epoch: 16, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 1.1305203437805176
Epoch: 17, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 1.0857274532318115
Epoch: 18, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 1.0724523067474365
Epoch: 19, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.190 Vali Acc: 0.467 Test Loss: 1.190 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 20 cost time: 0.8868434429168701
Epoch: 20, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.187 Vali Acc: 0.467 Test Loss: 1.187 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 21 cost time: 1.0989909172058105
Epoch: 21, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 22 cost time: 1.0141503810882568
Epoch: 22, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.180 Vali Acc: 0.467 Test Loss: 1.180 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 0.8003489971160889
Epoch: 23, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0731616020202637
Epoch: 24, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8756921291351318
Epoch: 25, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7594213485717773
Epoch: 26, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9084682464599609
Epoch: 27, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2244665622711182
Epoch: 28, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.288825273513794
Epoch: 29, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8523077964782715
Epoch: 30, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9432592391967773
Epoch: 31, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1317670345306396
Epoch: 32, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df128_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 35459
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.4172937870025635
Epoch: 1, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.445 Vali Acc: 0.333 Test Loss: 1.445 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 1.3065617084503174
Epoch: 2, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.387 Vali Acc: 0.333 Test Loss: 1.387 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 1.3078875541687012
Epoch: 3, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.338 Vali Acc: 0.333 Test Loss: 1.338 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 1.2658178806304932
Epoch: 4, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.3861172199249268
Epoch: 5, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.262 Vali Acc: 0.400 Test Loss: 1.262 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.9123687744140625
Epoch: 6, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2486722469329834
Epoch: 7, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9407768249511719
Epoch: 8, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9714953899383545
Epoch: 9, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2851297855377197
Epoch: 10, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0234267711639404
Epoch: 11, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2249078750610352
Epoch: 12, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0469484329223633
Epoch: 13, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.124455451965332
Epoch: 14, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 1.5746855735778809
Epoch: 15, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 1.2751362323760986
Epoch: 16, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 1.720808982849121
Epoch: 17, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.5684690475463867
Epoch: 18, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4431350231170654
Epoch: 19, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 1.324662685394287
Epoch: 20, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.9149043560028076
Epoch: 21, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 1.1795330047607422
Epoch: 22, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 1.1387825012207031
Epoch: 23, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.8822638988494873
Epoch: 24, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 1.086327075958252
Epoch: 25, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 1.5755021572113037
Epoch: 26, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 1.6188428401947021
Epoch: 27, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 28 cost time: 1.0870180130004883
Epoch: 28, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 29 cost time: 1.2826595306396484
Epoch: 29, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 30 cost time: 1.0192341804504395
Epoch: 30, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 1.2757368087768555
Epoch: 31, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3578479290008545
Epoch: 32, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.019 Vali Acc: 0.600 Test Loss: 1.019 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 33 cost time: 1.0765190124511719
Epoch: 33, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.995567798614502
Epoch: 34, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.301835298538208
Epoch: 35, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2326757907867432
Epoch: 36, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0321614742279053
Epoch: 37, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.361830711364746
Epoch: 38, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2298712730407715
Epoch: 39, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.260566234588623
Epoch: 40, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1415112018585205
Epoch: 41, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.0247507095336914
Epoch: 42, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 40579
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4132165908813477
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.0521039962768555
Epoch: 2, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.1206047534942627
Epoch: 3, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7787189483642578
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9154629707336426
Epoch: 5, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.722104549407959
Epoch: 6, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.0359852313995361
Epoch: 7, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.9339356422424316
Epoch: 8, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.9639787673950195
Epoch: 9, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.8154182434082031
Epoch: 10, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.8852894306182861
Epoch: 11, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.9645144939422607
Epoch: 12, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.9297847747802734
Epoch: 13, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 1.2651984691619873
Epoch: 14, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.9911701679229736
Epoch: 15, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.9489538669586182
Epoch: 16, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 1.014779806137085
Epoch: 17, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.8248474597930908
Epoch: 18, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 1.1498534679412842
Epoch: 19, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 1.4358665943145752
Epoch: 20, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.930305004119873
Epoch: 21, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 1.125910758972168
Epoch: 22, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.9706323146820068
Epoch: 23, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.7846357822418213
Epoch: 24, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 1.3321280479431152
Epoch: 25, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.8293678760528564
Epoch: 26, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 27 cost time: 1.0917863845825195
Epoch: 27, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1587867736816406
Epoch: 28, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 29 cost time: 0.8186991214752197
Epoch: 29, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 30 cost time: 0.7259495258331299
Epoch: 30, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.020 Vali Acc: 0.600 Test Loss: 1.020 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 31 cost time: 1.328432321548462
Epoch: 31, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 32 cost time: 0.9617724418640137
Epoch: 32, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 33 cost time: 0.8021566867828369
Epoch: 33, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 34 cost time: 0.9570043087005615
Epoch: 34, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0681116580963135
Epoch: 35, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2881762981414795
Epoch: 36, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.020 Vali Acc: 0.600 Test Loss: 1.020 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9900157451629639
Epoch: 37, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8330130577087402
Epoch: 38, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0979461669921875
Epoch: 39, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1137075424194336
Epoch: 40, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2820777893066406
Epoch: 41, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8873164653778076
Epoch: 42, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4525530338287354
Epoch: 43, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 27587
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.328217267990112
Epoch: 1, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.1704707145690918
Epoch: 2, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 1.0952343940734863
Epoch: 3, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 1.2307417392730713
Epoch: 4, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 1.347440481185913
Epoch: 5, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 1.284266471862793
Epoch: 6, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 1.1274454593658447
Epoch: 7, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.211 Vali Acc: 0.200 Test Loss: 1.211 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 1.1784982681274414
Epoch: 8, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.209 Vali Acc: 0.200 Test Loss: 1.209 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 1.1381280422210693
Epoch: 9, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 10 cost time: 1.2350990772247314
Epoch: 10, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 11 cost time: 1.0549695491790771
Epoch: 11, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 12 cost time: 1.4398770332336426
Epoch: 12, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.197 Vali Acc: 0.133 Test Loss: 1.197 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9486918449401855
Epoch: 13, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.194 Vali Acc: 0.133 Test Loss: 1.194 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9577667713165283
Epoch: 14, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4027788639068604
Epoch: 15, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 16 cost time: 1.3592629432678223
Epoch: 16, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 17 cost time: 1.160691738128662
Epoch: 17, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 18 cost time: 0.8811545372009277
Epoch: 18, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 19 cost time: 1.205282211303711
Epoch: 19, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.172 Vali Acc: 0.133 Test Loss: 1.172 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0446522235870361
Epoch: 20, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.168 Vali Acc: 0.133 Test Loss: 1.168 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5759429931640625
Epoch: 21, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.165 Vali Acc: 0.133 Test Loss: 1.165 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0082032680511475
Epoch: 22, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 23 cost time: 1.1190414428710938
Epoch: 23, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 24 cost time: 1.4163694381713867
Epoch: 24, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 25 cost time: 0.9666604995727539
Epoch: 25, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 26 cost time: 1.2718122005462646
Epoch: 26, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 27 cost time: 1.0917117595672607
Epoch: 27, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 28 cost time: 1.195446491241455
Epoch: 28, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 29 cost time: 1.393411636352539
Epoch: 29, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 30 cost time: 1.4843900203704834
Epoch: 30, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 31 cost time: 1.3140127658843994
Epoch: 31, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 32 cost time: 1.2130661010742188
Epoch: 32, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 33 cost time: 1.529024362564087
Epoch: 33, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 34 cost time: 1.3914775848388672
Epoch: 34, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0448832511901855
Epoch: 35, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 36 cost time: 0.6703386306762695
Epoch: 36, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 37 cost time: 1.4860212802886963
Epoch: 37, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.198349952697754
Epoch: 38, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 39 cost time: 0.8965771198272705
Epoch: 39, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4693434238433838
Epoch: 40, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.087266445159912
Epoch: 41, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0367443561553955
Epoch: 42, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2542328834533691
Epoch: 43, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.3756022453308105
Epoch: 44, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.2657701969146729
Epoch: 45, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1945750713348389
Epoch: 46, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9727468490600586
Epoch: 47, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.4089181423187256
Epoch: 48, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.158 Vali Acc: 0.533 Test Loss: 1.158 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 49 cost time: 0.9490251541137695
Epoch: 49, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.160 Vali Acc: 0.533 Test Loss: 1.160 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0154826641082764
Epoch: 50, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0267539024353027
Epoch: 51, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.8267152309417725
Epoch: 52, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.154632568359375
Epoch: 53, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.164518117904663
Epoch: 54, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.1680264472961426
Epoch: 55, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.140080451965332
Epoch: 56, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.1260368824005127
Epoch: 57, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.9497818946838379
Epoch: 58, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.176 Vali Acc: 0.467 Test Loss: 1.176 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 24611
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.3151795864105225
Epoch: 1, Steps: 1 | Train Loss: 1.386 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.9275469779968262
Epoch: 2, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7962791919708252
Epoch: 3, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.082411766052246
Epoch: 4, Steps: 1 | Train Loss: 1.399 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.1893222332000732
Epoch: 5, Steps: 1 | Train Loss: 1.304 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1667931079864502
Epoch: 6, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.032466173171997
Epoch: 7, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8270206451416016
Epoch: 8, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3542540073394775
Epoch: 9, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2636709213256836
Epoch: 10, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3026599884033203
Epoch: 11, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8517258167266846
Epoch: 12, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.8152799606323242
Epoch: 13, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 1.6050617694854736
Epoch: 14, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 15 cost time: 1.336615800857544
Epoch: 15, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7325923442840576
Epoch: 16, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.039 Vali Acc: 0.333 Test Loss: 1.039 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9651799201965332
Epoch: 17, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2071888446807861
Epoch: 18, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 19 cost time: 1.1782746315002441
Epoch: 19, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 1.2092528343200684
Epoch: 20, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 1.4876682758331299
Epoch: 21, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 1.3795504570007324
Epoch: 22, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 1.929495096206665
Epoch: 23, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 1.5768187046051025
Epoch: 24, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 1.0513286590576172
Epoch: 25, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 1.1371335983276367
Epoch: 26, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 27 cost time: 1.212676763534546
Epoch: 27, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 1.385371446609497
Epoch: 28, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 1.6617522239685059
Epoch: 29, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 1.3699414730072021
Epoch: 30, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 1.2486562728881836
Epoch: 31, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 32 cost time: 1.7202751636505127
Epoch: 32, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 33 cost time: 1.7168605327606201
Epoch: 33, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 34 cost time: 1.5300195217132568
Epoch: 34, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 35 cost time: 1.8276398181915283
Epoch: 35, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 36 cost time: 1.3032233715057373
Epoch: 36, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 37 cost time: 1.4198112487792969
Epoch: 37, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 38 cost time: 1.896996021270752
Epoch: 38, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 39 cost time: 1.3129692077636719
Epoch: 39, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 40 cost time: 1.2500600814819336
Epoch: 40, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 41 cost time: 1.4690337181091309
Epoch: 41, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 42 cost time: 1.6182444095611572
Epoch: 42, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 43 cost time: 0.977888822555542
Epoch: 43, Steps: 1 | Train Loss: 0.099 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 44 cost time: 1.454758882522583
Epoch: 44, Steps: 1 | Train Loss: 0.088 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 45 cost time: 1.391735315322876
Epoch: 45, Steps: 1 | Train Loss: 0.072 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 46 cost time: 1.3520748615264893
Epoch: 46, Steps: 1 | Train Loss: 0.083 Vali Loss: 0.994 Vali Acc: 0.533 Test Loss: 0.994 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 47 cost time: 1.1923587322235107
Epoch: 47, Steps: 1 | Train Loss: 0.052 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 48 cost time: 1.394714593887329
Epoch: 48, Steps: 1 | Train Loss: 0.063 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 49 cost time: 1.6136794090270996
Epoch: 49, Steps: 1 | Train Loss: 0.055 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 50 cost time: 1.1633412837982178
Epoch: 50, Steps: 1 | Train Loss: 0.049 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 51 cost time: 1.3011438846588135
Epoch: 51, Steps: 1 | Train Loss: 0.046 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 52 cost time: 1.5276436805725098
Epoch: 52, Steps: 1 | Train Loss: 0.045 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 53 cost time: 1.4213004112243652
Epoch: 53, Steps: 1 | Train Loss: 0.037 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 54 cost time: 1.1109228134155273
Epoch: 54, Steps: 1 | Train Loss: 0.039 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 55 cost time: 1.6805808544158936
Epoch: 55, Steps: 1 | Train Loss: 0.031 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 56 cost time: 1.0172052383422852
Epoch: 56, Steps: 1 | Train Loss: 0.028 Vali Loss: 0.986 Vali Acc: 0.533 Test Loss: 0.986 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 57 cost time: 1.2687008380889893
Epoch: 57, Steps: 1 | Train Loss: 0.029 Vali Loss: 0.986 Vali Acc: 0.533 Test Loss: 0.986 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 58 cost time: 1.133209466934204
Epoch: 58, Steps: 1 | Train Loss: 0.026 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.220362901687622
Epoch: 59, Steps: 1 | Train Loss: 0.036 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.274132251739502
Epoch: 60, Steps: 1 | Train Loss: 0.025 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.0208816528320312
Epoch: 61, Steps: 1 | Train Loss: 0.018 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.18461275100708
Epoch: 62, Steps: 1 | Train Loss: 0.020 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.3709557056427002
Epoch: 63, Steps: 1 | Train Loss: 0.018 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.5246858596801758
Epoch: 64, Steps: 1 | Train Loss: 0.019 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.7532727718353271
Epoch: 65, Steps: 1 | Train Loss: 0.017 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.557408094406128
Epoch: 66, Steps: 1 | Train Loss: 0.017 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.2651126384735107
Epoch: 67, Steps: 1 | Train Loss: 0.014 Vali Loss: 0.993 Vali Acc: 0.533 Test Loss: 0.993 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 24291
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.8280370235443115
Epoch: 1, Steps: 1 | Train Loss: 1.351 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.3910179138183594
Epoch: 2, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.9837980270385742
Epoch: 3, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.0661249160766602
Epoch: 4, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 1.1404519081115723
Epoch: 5, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 1.1262366771697998
Epoch: 6, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 1.0653972625732422
Epoch: 7, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 1.0206806659698486
Epoch: 8, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 1.2578098773956299
Epoch: 9, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 1.167755365371704
Epoch: 10, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 1.180408239364624
Epoch: 11, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 1.172250747680664
Epoch: 12, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 1.1835837364196777
Epoch: 13, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 1.239912509918213
Epoch: 14, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 1.2647969722747803
Epoch: 15, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.9444773197174072
Epoch: 16, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 1.08677077293396
Epoch: 17, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.7766625881195068
Epoch: 18, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.8559489250183105
Epoch: 19, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 1.2414352893829346
Epoch: 20, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6502752304077148
Epoch: 21, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.250436782836914
Epoch: 22, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4520928859710693
Epoch: 23, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1101031303405762
Epoch: 24, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9604661464691162
Epoch: 25, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3073420524597168
Epoch: 26, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3243334293365479
Epoch: 27, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4228944778442383
Epoch: 28, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0248360633850098
Epoch: 29, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 25603
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.86435604095459
Epoch: 1, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.1860363483428955
Epoch: 2, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.8604037761688232
Epoch: 3, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.8862833976745605
Epoch: 4, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 1.0038905143737793
Epoch: 5, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.8149747848510742
Epoch: 6, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.771569013595581
Epoch: 7, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.8436746597290039
Epoch: 8, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.9994006156921387
Epoch: 9, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.133 Vali Acc: 0.133 Test Loss: 1.133 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0046429634094238
Epoch: 10, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.132 Vali Acc: 0.133 Test Loss: 1.132 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1160836219787598
Epoch: 11, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.130 Vali Acc: 0.133 Test Loss: 1.130 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3233122825622559
Epoch: 12, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 13 cost time: 1.0976190567016602
Epoch: 13, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 1.042266845703125
Epoch: 14, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.7889549732208252
Epoch: 15, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 16 cost time: 0.7910540103912354
Epoch: 16, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 17 cost time: 1.0607130527496338
Epoch: 17, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 1.0018682479858398
Epoch: 18, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 1.8788740634918213
Epoch: 19, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.8621902465820312
Epoch: 20, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.9476337432861328
Epoch: 21, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 0.9007666110992432
Epoch: 22, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 1.1288487911224365
Epoch: 23, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2031528949737549
Epoch: 24, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 25 cost time: 1.0458340644836426
Epoch: 25, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 26 cost time: 0.9258556365966797
Epoch: 26, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 27 cost time: 1.1552245616912842
Epoch: 27, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 28 cost time: 1.3462939262390137
Epoch: 28, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 29 cost time: 0.9442048072814941
Epoch: 29, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 30 cost time: 1.0354392528533936
Epoch: 30, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 31 cost time: 1.3859493732452393
Epoch: 31, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 32 cost time: 0.9474887847900391
Epoch: 32, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 33 cost time: 0.9045751094818115
Epoch: 33, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 34 cost time: 0.837127685546875
Epoch: 34, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 35 cost time: 0.9268527030944824
Epoch: 35, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 36 cost time: 1.1301705837249756
Epoch: 36, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 37 cost time: 1.1105382442474365
Epoch: 37, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 38 cost time: 0.9149351119995117
Epoch: 38, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 39 cost time: 0.9541800022125244
Epoch: 39, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 40 cost time: 1.383476972579956
Epoch: 40, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 41 cost time: 1.1262028217315674
Epoch: 41, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 42 cost time: 1.2696480751037598
Epoch: 42, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 43 cost time: 1.1005501747131348
Epoch: 43, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 44 cost time: 0.9745523929595947
Epoch: 44, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 45 cost time: 1.2336244583129883
Epoch: 45, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 46 cost time: 0.9902224540710449
Epoch: 46, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 47 cost time: 1.3287172317504883
Epoch: 47, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 48 cost time: 0.8872721195220947
Epoch: 48, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 49 cost time: 0.8205945491790771
Epoch: 49, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 50 cost time: 1.105132818222046
Epoch: 50, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 51 cost time: 1.1619791984558105
Epoch: 51, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 52 cost time: 0.9848487377166748
Epoch: 52, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 53 cost time: 0.9249200820922852
Epoch: 53, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.17991042137146
Epoch: 54, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2100224494934082
Epoch: 55, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9519362449645996
Epoch: 56, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.2009375095367432
Epoch: 57, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.5375454425811768
Epoch: 58, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.2346258163452148
Epoch: 59, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 60 cost time: 1.169416904449463
Epoch: 60, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9610631465911865
Epoch: 61, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9012932777404785
Epoch: 62, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8678081035614014
Epoch: 63, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.1300883293151855
Epoch: 64, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.8633754253387451
Epoch: 65, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.8333277702331543
Epoch: 66, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.8529622554779053
Epoch: 67, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.9301636219024658
Epoch: 68, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.9279086589813232
Epoch: 69, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 28451
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4251692295074463
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.9996645450592041
Epoch: 2, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 1.0536057949066162
Epoch: 3, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 1.0756816864013672
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.7807369232177734
Epoch: 5, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.7741439342498779
Epoch: 6, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 1.2353596687316895
Epoch: 7, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 1.0521228313446045
Epoch: 8, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.8121194839477539
Epoch: 9, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.8671245574951172
Epoch: 10, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8310894966125488
Epoch: 11, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0364265441894531
Epoch: 12, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.962425708770752
Epoch: 13, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2164335250854492
Epoch: 14, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9835965633392334
Epoch: 15, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 1.004162073135376
Epoch: 16, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.8732802867889404
Epoch: 17, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 1.354224443435669
Epoch: 18, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.9464848041534424
Epoch: 19, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.920302152633667
Epoch: 20, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.886054515838623
Epoch: 21, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8808045387268066
Epoch: 22, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0180988311767578
Epoch: 23, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1471421718597412
Epoch: 24, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2694900035858154
Epoch: 25, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9136993885040283
Epoch: 26, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.847339391708374
Epoch: 27, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.397557020187378
Epoch: 28, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm32_nh4_df64_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 31299
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.470785140991211
Epoch: 1, Steps: 1 | Train Loss: 1.417 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 1.0363125801086426
Epoch: 2, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.8320412635803223
Epoch: 3, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 1.008268117904663
Epoch: 4, Steps: 1 | Train Loss: 1.334 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 1.118323564529419
Epoch: 5, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 1.0758709907531738
Epoch: 6, Steps: 1 | Train Loss: 1.281 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.9870507717132568
Epoch: 7, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 1.2947311401367188
Epoch: 8, Steps: 1 | Train Loss: 1.305 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 1.0808446407318115
Epoch: 9, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 1.0756809711456299
Epoch: 10, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.9831387996673584
Epoch: 11, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.8829779624938965
Epoch: 12, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 1.0530409812927246
Epoch: 13, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 1.2218918800354004
Epoch: 14, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 1.0618464946746826
Epoch: 15, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 1.0979318618774414
Epoch: 16, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 17 cost time: 0.985121488571167
Epoch: 17, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 1.0071370601654053
Epoch: 18, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 19 cost time: 0.9344899654388428
Epoch: 19, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9678394794464111
Epoch: 20, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.349059820175171
Epoch: 21, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 22 cost time: 1.236863613128662
Epoch: 22, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 1.0321815013885498
Epoch: 23, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 24 cost time: 1.1893031597137451
Epoch: 24, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 25 cost time: 0.9052391052246094
Epoch: 25, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.9787421226501465
Epoch: 26, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 27 cost time: 1.2980499267578125
Epoch: 27, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 1.1979868412017822
Epoch: 28, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 0.729485034942627
Epoch: 29, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 30 cost time: 0.8027372360229492
Epoch: 30, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 31 cost time: 0.7511277198791504
Epoch: 31, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.8254907131195068
Epoch: 32, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 33 cost time: 0.7810108661651611
Epoch: 33, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 34 cost time: 1.1542704105377197
Epoch: 34, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 35 cost time: 0.9192941188812256
Epoch: 35, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 36 cost time: 1.5219688415527344
Epoch: 36, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 37 cost time: 1.0446903705596924
Epoch: 37, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5720710754394531
Epoch: 38, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.716186285018921
Epoch: 39, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9012441635131836
Epoch: 40, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1484107971191406
Epoch: 41, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1296961307525635
Epoch: 42, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.0257551670074463
Epoch: 43, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0601062774658203
Epoch: 44, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.0355322360992432
Epoch: 45, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.170398235321045
Epoch: 46, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 25635
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.51253342628479
Epoch: 1, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.51210618019104
Epoch: 2, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.0946011543273926
Epoch: 3, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.1688787937164307
Epoch: 4, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.0763747692108154
Epoch: 5, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.975574254989624
Epoch: 6, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8720781803131104
Epoch: 7, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2016818523406982
Epoch: 8, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0257055759429932
Epoch: 9, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1641724109649658
Epoch: 10, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.772266149520874
Epoch: 11, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8960762023925781
Epoch: 12, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1627781391143799
Epoch: 13, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1231706142425537
Epoch: 14, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 19139
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.144373893737793
Epoch: 1, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.0381801128387451
Epoch: 2, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.9931080341339111
Epoch: 3, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.8579704761505127
Epoch: 4, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.808448076248169
Epoch: 5, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9285788536071777
Epoch: 6, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0922267436981201
Epoch: 7, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0092458724975586
Epoch: 8, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2039458751678467
Epoch: 9, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0652344226837158
Epoch: 10, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0213086605072021
Epoch: 11, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.373976469039917
Epoch: 12, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9616262912750244
Epoch: 13, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5465834140777588
Epoch: 14, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 17651
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.350923538208008
Epoch: 1, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 1.149747610092163
Epoch: 2, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 1.083263874053955
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 1.4695565700531006
Epoch: 4, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 1.3550984859466553
Epoch: 5, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.021 Vali Acc: 0.400 Test Loss: 1.021 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 1.374962568283081
Epoch: 6, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 1.324737548828125
Epoch: 7, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 8 cost time: 1.5963950157165527
Epoch: 8, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.018 Vali Acc: 0.400 Test Loss: 1.018 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 1.090031385421753
Epoch: 9, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 0.9483613967895508
Epoch: 10, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 0.9609522819519043
Epoch: 11, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.013 Vali Acc: 0.400 Test Loss: 1.013 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 12 cost time: 0.9777765274047852
Epoch: 12, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.011 Vali Acc: 0.400 Test Loss: 1.011 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 1.2718725204467773
Epoch: 13, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.009 Vali Acc: 0.400 Test Loss: 1.009 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 1.0374314785003662
Epoch: 14, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 15 cost time: 1.163586139678955
Epoch: 15, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 16 cost time: 1.321552038192749
Epoch: 16, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 17 cost time: 1.3154771327972412
Epoch: 17, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.001 Vali Acc: 0.400 Test Loss: 1.001 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1752681732177734
Epoch: 18, Steps: 1 | Train Loss: 0.850 Vali Loss: 0.999 Vali Acc: 0.400 Test Loss: 0.999 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3300151824951172
Epoch: 19, Steps: 1 | Train Loss: 0.818 Vali Loss: 0.997 Vali Acc: 0.400 Test Loss: 0.997 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4351766109466553
Epoch: 20, Steps: 1 | Train Loss: 0.810 Vali Loss: 0.995 Vali Acc: 0.400 Test Loss: 0.995 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3122971057891846
Epoch: 21, Steps: 1 | Train Loss: 0.734 Vali Loss: 0.992 Vali Acc: 0.467 Test Loss: 0.992 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 22 cost time: 1.1758010387420654
Epoch: 22, Steps: 1 | Train Loss: 0.760 Vali Loss: 0.989 Vali Acc: 0.467 Test Loss: 0.989 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 23 cost time: 1.1784255504608154
Epoch: 23, Steps: 1 | Train Loss: 0.747 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 24 cost time: 1.1976327896118164
Epoch: 24, Steps: 1 | Train Loss: 0.752 Vali Loss: 0.985 Vali Acc: 0.467 Test Loss: 0.985 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 25 cost time: 1.0642626285552979
Epoch: 25, Steps: 1 | Train Loss: 0.763 Vali Loss: 0.982 Vali Acc: 0.467 Test Loss: 0.982 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 26 cost time: 1.666640043258667
Epoch: 26, Steps: 1 | Train Loss: 0.662 Vali Loss: 0.980 Vali Acc: 0.533 Test Loss: 0.980 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 27 cost time: 1.0436906814575195
Epoch: 27, Steps: 1 | Train Loss: 0.632 Vali Loss: 0.978 Vali Acc: 0.533 Test Loss: 0.978 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 28 cost time: 1.3097741603851318
Epoch: 28, Steps: 1 | Train Loss: 0.511 Vali Loss: 0.976 Vali Acc: 0.533 Test Loss: 0.976 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 29 cost time: 1.190675973892212
Epoch: 29, Steps: 1 | Train Loss: 0.554 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 30 cost time: 1.2029995918273926
Epoch: 30, Steps: 1 | Train Loss: 0.479 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 31 cost time: 1.432382345199585
Epoch: 31, Steps: 1 | Train Loss: 0.361 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 32 cost time: 1.3744776248931885
Epoch: 32, Steps: 1 | Train Loss: 0.452 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 33 cost time: 1.3279964923858643
Epoch: 33, Steps: 1 | Train Loss: 0.388 Vali Loss: 0.965 Vali Acc: 0.533 Test Loss: 0.965 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 34 cost time: 1.4838078022003174
Epoch: 34, Steps: 1 | Train Loss: 0.405 Vali Loss: 0.963 Vali Acc: 0.533 Test Loss: 0.963 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 35 cost time: 1.4512367248535156
Epoch: 35, Steps: 1 | Train Loss: 0.411 Vali Loss: 0.961 Vali Acc: 0.533 Test Loss: 0.961 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 36 cost time: 1.9392869472503662
Epoch: 36, Steps: 1 | Train Loss: 0.404 Vali Loss: 0.959 Vali Acc: 0.533 Test Loss: 0.959 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 37 cost time: 1.3365106582641602
Epoch: 37, Steps: 1 | Train Loss: 0.396 Vali Loss: 0.957 Vali Acc: 0.533 Test Loss: 0.957 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 38 cost time: 1.62733793258667
Epoch: 38, Steps: 1 | Train Loss: 0.324 Vali Loss: 0.955 Vali Acc: 0.533 Test Loss: 0.955 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 39 cost time: 1.0339689254760742
Epoch: 39, Steps: 1 | Train Loss: 0.331 Vali Loss: 0.953 Vali Acc: 0.533 Test Loss: 0.953 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 40 cost time: 1.520916223526001
Epoch: 40, Steps: 1 | Train Loss: 0.293 Vali Loss: 0.951 Vali Acc: 0.533 Test Loss: 0.951 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 41 cost time: 1.556997537612915
Epoch: 41, Steps: 1 | Train Loss: 0.222 Vali Loss: 0.949 Vali Acc: 0.533 Test Loss: 0.949 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 42 cost time: 1.4921011924743652
Epoch: 42, Steps: 1 | Train Loss: 0.306 Vali Loss: 0.948 Vali Acc: 0.533 Test Loss: 0.948 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 43 cost time: 1.2447960376739502
Epoch: 43, Steps: 1 | Train Loss: 0.244 Vali Loss: 0.947 Vali Acc: 0.533 Test Loss: 0.947 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 44 cost time: 1.4225270748138428
Epoch: 44, Steps: 1 | Train Loss: 0.249 Vali Loss: 0.946 Vali Acc: 0.533 Test Loss: 0.946 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 45 cost time: 1.4254519939422607
Epoch: 45, Steps: 1 | Train Loss: 0.250 Vali Loss: 0.945 Vali Acc: 0.533 Test Loss: 0.945 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 46 cost time: 1.0737528800964355
Epoch: 46, Steps: 1 | Train Loss: 0.165 Vali Loss: 0.944 Vali Acc: 0.533 Test Loss: 0.944 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 47 cost time: 1.5083115100860596
Epoch: 47, Steps: 1 | Train Loss: 0.137 Vali Loss: 0.943 Vali Acc: 0.533 Test Loss: 0.943 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 48 cost time: 1.132714033126831
Epoch: 48, Steps: 1 | Train Loss: 0.194 Vali Loss: 0.942 Vali Acc: 0.533 Test Loss: 0.942 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 49 cost time: 1.3327758312225342
Epoch: 49, Steps: 1 | Train Loss: 0.154 Vali Loss: 0.942 Vali Acc: 0.533 Test Loss: 0.942 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 50 cost time: 1.3357794284820557
Epoch: 50, Steps: 1 | Train Loss: 0.153 Vali Loss: 0.941 Vali Acc: 0.533 Test Loss: 0.941 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 51 cost time: 1.2638890743255615
Epoch: 51, Steps: 1 | Train Loss: 0.163 Vali Loss: 0.941 Vali Acc: 0.533 Test Loss: 0.941 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 52 cost time: 1.4383213520050049
Epoch: 52, Steps: 1 | Train Loss: 0.140 Vali Loss: 0.941 Vali Acc: 0.533 Test Loss: 0.941 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2264811992645264
Epoch: 53, Steps: 1 | Train Loss: 0.165 Vali Loss: 0.941 Vali Acc: 0.467 Test Loss: 0.941 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.4561285972595215
Epoch: 54, Steps: 1 | Train Loss: 0.110 Vali Loss: 0.941 Vali Acc: 0.467 Test Loss: 0.941 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.1927735805511475
Epoch: 55, Steps: 1 | Train Loss: 0.143 Vali Loss: 0.941 Vali Acc: 0.467 Test Loss: 0.941 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.2946274280548096
Epoch: 56, Steps: 1 | Train Loss: 0.101 Vali Loss: 0.941 Vali Acc: 0.467 Test Loss: 0.941 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.1217052936553955
Epoch: 57, Steps: 1 | Train Loss: 0.090 Vali Loss: 0.942 Vali Acc: 0.467 Test Loss: 0.942 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.421370029449463
Epoch: 58, Steps: 1 | Train Loss: 0.088 Vali Loss: 0.942 Vali Acc: 0.467 Test Loss: 0.942 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.0970220565795898
Epoch: 59, Steps: 1 | Train Loss: 0.106 Vali Loss: 0.942 Vali Acc: 0.467 Test Loss: 0.942 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.630636215209961
Epoch: 60, Steps: 1 | Train Loss: 0.093 Vali Loss: 0.942 Vali Acc: 0.467 Test Loss: 0.942 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 2.0328404903411865
Epoch: 61, Steps: 1 | Train Loss: 0.098 Vali Loss: 0.942 Vali Acc: 0.467 Test Loss: 0.942 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 17491
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.021576642990112
Epoch: 1, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.308 Vali Acc: 0.333 Test Loss: 1.308 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.1249492168426514
Epoch: 2, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.307 Vali Acc: 0.267 Test Loss: 1.307 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8650357723236084
Epoch: 3, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.307 Vali Acc: 0.267 Test Loss: 1.307 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.041243553161621
Epoch: 4, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 1.084852695465088
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 1.2565834522247314
Epoch: 6, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.308 Vali Acc: 0.333 Test Loss: 1.308 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0676603317260742
Epoch: 7, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.309 Vali Acc: 0.400 Test Loss: 1.309 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 1.2019150257110596
Epoch: 8, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.405808687210083
Epoch: 9, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9031991958618164
Epoch: 10, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.312 Vali Acc: 0.400 Test Loss: 1.312 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0413334369659424
Epoch: 11, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.313 Vali Acc: 0.400 Test Loss: 1.313 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.03092622756958
Epoch: 12, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.313 Vali Acc: 0.400 Test Loss: 1.313 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9682042598724365
Epoch: 13, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8090827465057373
Epoch: 14, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9125487804412842
Epoch: 15, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.313 Vali Acc: 0.400 Test Loss: 1.313 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0194635391235352
Epoch: 16, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.313 Vali Acc: 0.400 Test Loss: 1.313 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0104236602783203
Epoch: 17, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.313 Vali Acc: 0.400 Test Loss: 1.313 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 18147
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5914993286132812
Epoch: 1, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.1442828178405762
Epoch: 2, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 1.649183988571167
Epoch: 3, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.18288254737854
Epoch: 4, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.7759160995483398
Epoch: 5, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2396996021270752
Epoch: 6, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1400301456451416
Epoch: 7, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1925880908966064
Epoch: 8, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0278303623199463
Epoch: 9, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9886903762817383
Epoch: 10, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.34328031539917
Epoch: 11, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2315673828125
Epoch: 12, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3980329036712646
Epoch: 13, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6254072189331055
Epoch: 14, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 1.0998797416687012
Epoch: 15, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 1.2345755100250244
Epoch: 16, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9280233383178711
Epoch: 17, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 1.40391206741333
Epoch: 18, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 0.8868062496185303
Epoch: 19, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 20 cost time: 1.004202127456665
Epoch: 20, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 21 cost time: 0.9265072345733643
Epoch: 21, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 22 cost time: 1.1339178085327148
Epoch: 22, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3938498497009277
Epoch: 23, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0287015438079834
Epoch: 24, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6218314170837402
Epoch: 25, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0222914218902588
Epoch: 26, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.328577995300293
Epoch: 27, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.4587862491607666
Epoch: 28, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1770708560943604
Epoch: 29, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4176695346832275
Epoch: 30, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2389624118804932
Epoch: 31, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 19571
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.383634805679321
Epoch: 1, Steps: 1 | Train Loss: 1.433 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.0752699375152588
Epoch: 2, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.8743956089019775
Epoch: 3, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.3629629611968994
Epoch: 4, Steps: 1 | Train Loss: 1.303 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.1243493556976318
Epoch: 5, Steps: 1 | Train Loss: 1.309 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.1207170486450195
Epoch: 6, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.8418824672698975
Epoch: 7, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 1.2336044311523438
Epoch: 8, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 1.1007308959960938
Epoch: 9, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 1.133296012878418
Epoch: 10, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 1.263490915298462
Epoch: 11, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 1.326270341873169
Epoch: 12, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.346869707107544
Epoch: 13, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 1.1611225605010986
Epoch: 14, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.1209156513214111
Epoch: 15, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 1.2200748920440674
Epoch: 16, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 1.3732562065124512
Epoch: 17, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 1.2230503559112549
Epoch: 18, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 1.156477689743042
Epoch: 19, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 1.1269526481628418
Epoch: 20, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 1.3041703701019287
Epoch: 21, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.9572117328643799
Epoch: 22, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 1.0694305896759033
Epoch: 23, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 1.1666593551635742
Epoch: 24, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 1.0902469158172607
Epoch: 25, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 1.6064507961273193
Epoch: 26, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 27 cost time: 1.2423219680786133
Epoch: 27, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 1.8284649848937988
Epoch: 28, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.267270565032959
Epoch: 29, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3307147026062012
Epoch: 30, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.123060703277588
Epoch: 31, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9051737785339355
Epoch: 32, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.975306510925293
Epoch: 33, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9346921443939209
Epoch: 34, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0926611423492432
Epoch: 35, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8122153282165527
Epoch: 36, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6060576438903809
Epoch: 37, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df256_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 20995
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.619595289230347
Epoch: 1, Steps: 1 | Train Loss: 1.324 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.262223482131958
Epoch: 2, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 1.3391900062561035
Epoch: 3, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 1.357147455215454
Epoch: 4, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 1.165205955505371
Epoch: 5, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.9920580387115479
Epoch: 6, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0493113994598389
Epoch: 7, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8268513679504395
Epoch: 8, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3352868556976318
Epoch: 9, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9616847038269043
Epoch: 10, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0450325012207031
Epoch: 11, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 1.4187562465667725
Epoch: 12, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2714598178863525
Epoch: 13, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1294221878051758
Epoch: 14, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1249947547912598
Epoch: 15, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5869781970977783
Epoch: 16, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1481289863586426
Epoch: 17, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2788662910461426
Epoch: 18, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4414305686950684
Epoch: 19, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3569152355194092
Epoch: 20, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2161762714385986
Epoch: 21, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 21411
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.706834554672241
Epoch: 1, Steps: 1 | Train Loss: 1.502 Vali Loss: 1.361 Vali Acc: 0.467 Test Loss: 1.361 Test Acc: 0.467
Validation loss decreased (inf --> -0.466653).  Saving model ...
Epoch: 2 cost time: 1.4832236766815186
Epoch: 2, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.336 Vali Acc: 0.467 Test Loss: 1.336 Test Acc: 0.467
Validation loss decreased (-0.466653 --> -0.466653).  Saving model ...
Epoch: 3 cost time: 1.444969892501831
Epoch: 3, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.312 Vali Acc: 0.467 Test Loss: 1.312 Test Acc: 0.467
Validation loss decreased (-0.466653 --> -0.466654).  Saving model ...
Epoch: 4 cost time: 1.2978746891021729
Epoch: 4, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.289 Vali Acc: 0.467 Test Loss: 1.289 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 5 cost time: 1.2251560688018799
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.268 Vali Acc: 0.467 Test Loss: 1.268 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 6 cost time: 1.1946499347686768
Epoch: 6, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.253 Vali Acc: 0.467 Test Loss: 1.253 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 7 cost time: 1.4552288055419922
Epoch: 7, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.238 Vali Acc: 0.467 Test Loss: 1.238 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 8 cost time: 1.1549246311187744
Epoch: 8, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.222 Vali Acc: 0.467 Test Loss: 1.222 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466654).  Saving model ...
Epoch: 9 cost time: 1.1527488231658936
Epoch: 9, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.207 Vali Acc: 0.467 Test Loss: 1.207 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 1.295760154724121
Epoch: 10, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.191 Vali Acc: 0.467 Test Loss: 1.191 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.8791580200195312
Epoch: 11, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.177 Vali Acc: 0.467 Test Loss: 1.177 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 2.0096187591552734
Epoch: 12, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 1.0659253597259521
Epoch: 13, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 1.7168152332305908
Epoch: 14, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.136 Vali Acc: 0.533 Test Loss: 1.136 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 1.0571868419647217
Epoch: 15, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 16 cost time: 1.6446599960327148
Epoch: 16, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 1.7113800048828125
Epoch: 17, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.105 Vali Acc: 0.533 Test Loss: 1.105 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 18 cost time: 1.4998481273651123
Epoch: 18, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 19 cost time: 1.8068866729736328
Epoch: 19, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.090 Vali Acc: 0.600 Test Loss: 1.090 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 1.1127204895019531
Epoch: 20, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 0.9563889503479004
Epoch: 21, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.8758981227874756
Epoch: 22, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.9544651508331299
Epoch: 23, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 24 cost time: 1.4186286926269531
Epoch: 24, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 1.616079568862915
Epoch: 25, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 0.9960935115814209
Epoch: 26, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 1.247882604598999
Epoch: 27, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 28 cost time: 1.0437803268432617
Epoch: 28, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 29 cost time: 1.7043511867523193
Epoch: 29, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 30 cost time: 1.244323492050171
Epoch: 30, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 31 cost time: 1.7784442901611328
Epoch: 31, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 32 cost time: 1.14729905128479
Epoch: 32, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 33 cost time: 1.1254308223724365
Epoch: 33, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 34 cost time: 0.9634246826171875
Epoch: 34, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 35 cost time: 0.9747943878173828
Epoch: 35, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 36 cost time: 1.1085472106933594
Epoch: 36, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.168297529220581
Epoch: 37, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1114461421966553
Epoch: 38, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9360833168029785
Epoch: 39, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1526474952697754
Epoch: 40, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.015 Vali Acc: 0.600 Test Loss: 1.015 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 41 cost time: 1.437868356704712
Epoch: 41, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.012 Vali Acc: 0.600 Test Loss: 1.012 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 42 cost time: 1.014613151550293
Epoch: 42, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 43 cost time: 1.3111348152160645
Epoch: 43, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.009 Vali Acc: 0.600 Test Loss: 1.009 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 44 cost time: 0.99173903465271
Epoch: 44, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 45 cost time: 1.3404698371887207
Epoch: 45, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 46 cost time: 1.269693374633789
Epoch: 46, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1297142505645752
Epoch: 47, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.009 Vali Acc: 0.600 Test Loss: 1.009 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.3578622341156006
Epoch: 48, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1263222694396973
Epoch: 49, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.012 Vali Acc: 0.600 Test Loss: 1.012 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.2145359516143799
Epoch: 50, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.431563377380371
Epoch: 51, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.2587342262268066
Epoch: 52, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.198171615600586
Epoch: 53, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.11622953414917
Epoch: 54, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.945101261138916
Epoch: 55, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 14915
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.667245149612427
Epoch: 1, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.121661901473999
Epoch: 2, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.1215662956237793
Epoch: 3, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.266 Vali Acc: 0.333 Test Loss: 1.266 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.1049354076385498
Epoch: 4, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 1.6561369895935059
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 1.1165778636932373
Epoch: 6, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3165597915649414
Epoch: 7, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.247 Vali Acc: 0.200 Test Loss: 1.247 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8613920211791992
Epoch: 8, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3301527500152588
Epoch: 9, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.241 Vali Acc: 0.200 Test Loss: 1.241 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.171839952468872
Epoch: 10, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6500859260559082
Epoch: 11, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.607046365737915
Epoch: 12, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.230 Vali Acc: 0.200 Test Loss: 1.230 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.738640546798706
Epoch: 13, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.503629446029663
Epoch: 14, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4816246032714844
Epoch: 15, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 13427
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7642757892608643
Epoch: 1, Steps: 1 | Train Loss: 1.551 Vali Loss: 1.480 Vali Acc: 0.333 Test Loss: 1.480 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 1.6360414028167725
Epoch: 2, Steps: 1 | Train Loss: 1.283 Vali Loss: 1.451 Vali Acc: 0.333 Test Loss: 1.451 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 1.5467846393585205
Epoch: 3, Steps: 1 | Train Loss: 1.458 Vali Loss: 1.426 Vali Acc: 0.267 Test Loss: 1.426 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.120542049407959
Epoch: 4, Steps: 1 | Train Loss: 1.542 Vali Loss: 1.404 Vali Acc: 0.267 Test Loss: 1.404 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0577154159545898
Epoch: 5, Steps: 1 | Train Loss: 1.373 Vali Loss: 1.386 Vali Acc: 0.267 Test Loss: 1.386 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1099157333374023
Epoch: 6, Steps: 1 | Train Loss: 1.412 Vali Loss: 1.371 Vali Acc: 0.267 Test Loss: 1.371 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1156113147735596
Epoch: 7, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.358 Vali Acc: 0.267 Test Loss: 1.358 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.129324197769165
Epoch: 8, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.347 Vali Acc: 0.267 Test Loss: 1.347 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9486222267150879
Epoch: 9, Steps: 1 | Train Loss: 1.261 Vali Loss: 1.337 Vali Acc: 0.267 Test Loss: 1.337 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2964675426483154
Epoch: 10, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.329 Vali Acc: 0.267 Test Loss: 1.329 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5098156929016113
Epoch: 11, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.321 Vali Acc: 0.267 Test Loss: 1.321 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9532506465911865
Epoch: 12, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.314 Vali Acc: 0.267 Test Loss: 1.314 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 13267
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8971757888793945
Epoch: 1, Steps: 1 | Train Loss: 1.449 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 1.548147439956665
Epoch: 2, Steps: 1 | Train Loss: 1.336 Vali Loss: 1.281 Vali Acc: 0.200 Test Loss: 1.281 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9224855899810791
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.271 Vali Acc: 0.200 Test Loss: 1.271 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0785470008850098
Epoch: 4, Steps: 1 | Train Loss: 1.356 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2820332050323486
Epoch: 5, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6995575428009033
Epoch: 6, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 1.4322710037231445
Epoch: 7, Steps: 1 | Train Loss: 1.226 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 1.380286455154419
Epoch: 8, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 1.3267128467559814
Epoch: 9, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 1.032182216644287
Epoch: 10, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 1.1923842430114746
Epoch: 11, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0247776508331299
Epoch: 12, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1635730266571045
Epoch: 13, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.962113618850708
Epoch: 14, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.254650592803955
Epoch: 15, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6405799388885498
Epoch: 16, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0360536575317383
Epoch: 17, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9934959411621094
Epoch: 18, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2785186767578125
Epoch: 19, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5282666683197021
Epoch: 20, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 13923
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7894134521484375
Epoch: 1, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.163 Vali Acc: 0.533 Test Loss: 1.163 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.9714629650115967
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.162 Vali Acc: 0.533 Test Loss: 1.162 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 1.239649772644043
Epoch: 3, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5820949077606201
Epoch: 4, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6742925643920898
Epoch: 5, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9942960739135742
Epoch: 6, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1644725799560547
Epoch: 7, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0343189239501953
Epoch: 8, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8624656200408936
Epoch: 9, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.486668348312378
Epoch: 10, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9270608425140381
Epoch: 11, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2228443622589111
Epoch: 12, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 15347
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.115509033203125
Epoch: 1, Steps: 1 | Train Loss: 1.289 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.1179583072662354
Epoch: 2, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 1.229522705078125
Epoch: 3, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.225 Vali Acc: 0.467 Test Loss: 1.225 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 4 cost time: 1.0502710342407227
Epoch: 4, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0401899814605713
Epoch: 5, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2083203792572021
Epoch: 6, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.395012378692627
Epoch: 7, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2427992820739746
Epoch: 8, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9908890724182129
Epoch: 9, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2804148197174072
Epoch: 10, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9935052394866943
Epoch: 11, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.300605058670044
Epoch: 12, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0994908809661865
Epoch: 13, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df128_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 16771
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.6399741172790527
Epoch: 1, Steps: 1 | Train Loss: 1.276 Vali Loss: 1.274 Vali Acc: 0.333 Test Loss: 1.274 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.288773775100708
Epoch: 2, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.9109365940093994
Epoch: 3, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.061540126800537
Epoch: 4, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.8474514484405518
Epoch: 5, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.0272307395935059
Epoch: 6, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6161377429962158
Epoch: 7, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1745572090148926
Epoch: 8, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5136909484863281
Epoch: 9, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.202911615371704
Epoch: 10, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2801198959350586
Epoch: 11, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 1.310065507888794
Epoch: 12, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.9609389305114746
Epoch: 13, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 1.0723235607147217
Epoch: 14, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 1.290623664855957
Epoch: 15, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 1.0005097389221191
Epoch: 16, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 1.5863721370697021
Epoch: 17, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 1.3257040977478027
Epoch: 18, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 1.2356071472167969
Epoch: 19, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 1.4934663772583008
Epoch: 20, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 1.2558279037475586
Epoch: 21, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.9462928771972656
Epoch: 22, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 1.0202431678771973
Epoch: 23, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 1.4065415859222412
Epoch: 24, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 1.458702802658081
Epoch: 25, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 1.335071325302124
Epoch: 26, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 1.2685492038726807
Epoch: 27, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 1.2427845001220703
Epoch: 28, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 1.0970077514648438
Epoch: 29, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 1.0553290843963623
Epoch: 30, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 1.3192827701568604
Epoch: 31, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 32 cost time: 1.5498924255371094
Epoch: 32, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 33 cost time: 0.9086799621582031
Epoch: 33, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 34 cost time: 0.8069548606872559
Epoch: 34, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 35 cost time: 1.2045657634735107
Epoch: 35, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 36 cost time: 2.1372828483581543
Epoch: 36, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 37 cost time: 1.5308761596679688
Epoch: 37, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 38 cost time: 1.228952407836914
Epoch: 38, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 39 cost time: 1.2515645027160645
Epoch: 39, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0790884494781494
Epoch: 40, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.213646650314331
Epoch: 41, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.974238395690918
Epoch: 42, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.20493483543396
Epoch: 43, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.123962163925171
Epoch: 44, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.258711576461792
Epoch: 45, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1847803592681885
Epoch: 46, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.5983169078826904
Epoch: 47, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.3807437419891357
Epoch: 48, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 19299
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4386653900146484
Epoch: 1, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.3754801750183105
Epoch: 2, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.6091587543487549
Epoch: 3, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.178748607635498
Epoch: 4, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.6841495037078857
Epoch: 5, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.2431132793426514
Epoch: 6, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 1.5811197757720947
Epoch: 7, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 1.0274853706359863
Epoch: 8, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 1.52388596534729
Epoch: 9, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 1.3630270957946777
Epoch: 10, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 1.7387254238128662
Epoch: 11, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 1.2634949684143066
Epoch: 12, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 1.4038598537445068
Epoch: 13, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 1.0889968872070312
Epoch: 14, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 1.1653592586517334
Epoch: 15, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.071 Vali Acc: 0.667 Test Loss: 1.071 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 16 cost time: 0.8324027061462402
Epoch: 16, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3994545936584473
Epoch: 17, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.456712245941162
Epoch: 18, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.062 Vali Acc: 0.667 Test Loss: 1.062 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 19 cost time: 1.2212419509887695
Epoch: 19, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3754148483276367
Epoch: 20, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.057 Vali Acc: 0.600 Test Loss: 1.057 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1297757625579834
Epoch: 21, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3497004508972168
Epoch: 22, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9365534782409668
Epoch: 23, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0691633224487305
Epoch: 24, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.081629991531372
Epoch: 25, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9120645523071289
Epoch: 26, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4197862148284912
Epoch: 27, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1409034729003906
Epoch: 28, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 12803
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps188_str94_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.6649842262268066
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.1120901107788086
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.8520772457122803
Epoch: 3, Steps: 1 | Train Loss: 1.300 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.1361947059631348
Epoch: 4, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.7400188446044922
Epoch: 5, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.134162187576294
Epoch: 6, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1889796257019043
Epoch: 7, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2978477478027344
Epoch: 8, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7197484970092773
Epoch: 9, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1052722930908203
Epoch: 10, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9143202304840088
Epoch: 11, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6356725692749023
Epoch: 12, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0187811851501465
Epoch: 13, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1799712181091309
Epoch: 14, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps188_str94_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 11315
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9188437461853027
Epoch: 1, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.434 Vali Acc: 0.400 Test Loss: 1.434 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.4383220672607422
Epoch: 2, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.412 Vali Acc: 0.333 Test Loss: 1.412 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5634777545928955
Epoch: 3, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.393 Vali Acc: 0.333 Test Loss: 1.393 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.238025426864624
Epoch: 4, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.376 Vali Acc: 0.333 Test Loss: 1.376 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7860007286071777
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.361 Vali Acc: 0.333 Test Loss: 1.361 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.220879316329956
Epoch: 6, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.351 Vali Acc: 0.333 Test Loss: 1.351 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6969919204711914
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.341 Vali Acc: 0.267 Test Loss: 1.341 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4655206203460693
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.333 Vali Acc: 0.267 Test Loss: 1.333 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1452672481536865
Epoch: 9, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.325 Vali Acc: 0.267 Test Loss: 1.325 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4649865627288818
Epoch: 10, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.318 Vali Acc: 0.200 Test Loss: 1.318 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.126368761062622
Epoch: 11, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.312 Vali Acc: 0.200 Test Loss: 1.312 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 11155
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps375_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.732430934906006
Epoch: 1, Steps: 1 | Train Loss: 1.338 Vali Loss: 1.363 Vali Acc: 0.333 Test Loss: 1.363 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.0102744102478027
Epoch: 2, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.360 Vali Acc: 0.267 Test Loss: 1.360 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1464416980743408
Epoch: 3, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.357 Vali Acc: 0.267 Test Loss: 1.357 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0071310997009277
Epoch: 4, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.354 Vali Acc: 0.267 Test Loss: 1.354 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9023704528808594
Epoch: 5, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.352 Vali Acc: 0.267 Test Loss: 1.352 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4035053253173828
Epoch: 6, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.352 Vali Acc: 0.267 Test Loss: 1.352 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6956202983856201
Epoch: 7, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.352 Vali Acc: 0.267 Test Loss: 1.352 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0194928646087646
Epoch: 8, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.352 Vali Acc: 0.267 Test Loss: 1.352 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0859992504119873
Epoch: 9, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.352 Vali Acc: 0.267 Test Loss: 1.352 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0829529762268066
Epoch: 10, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.351 Vali Acc: 0.267 Test Loss: 1.351 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2780952453613281
Epoch: 11, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.351 Vali Acc: 0.267 Test Loss: 1.351 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps375_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 11811
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.426160097122192
Epoch: 1, Steps: 1 | Train Loss: 1.373 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 1.2146565914154053
Epoch: 2, Steps: 1 | Train Loss: 1.599 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 1.0856022834777832
Epoch: 3, Steps: 1 | Train Loss: 1.422 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.2912647724151611
Epoch: 4, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.9757697582244873
Epoch: 5, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.3695728778839111
Epoch: 6, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 1.2685494422912598
Epoch: 7, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 1.254251480102539
Epoch: 8, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.9791944026947021
Epoch: 9, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 1.1975300312042236
Epoch: 10, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.9825832843780518
Epoch: 11, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 1.2349128723144531
Epoch: 12, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 1.0423674583435059
Epoch: 13, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 1.2017488479614258
Epoch: 14, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 0.7355728149414062
Epoch: 15, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1228022575378418
Epoch: 16, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3638813495635986
Epoch: 17, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8852548599243164
Epoch: 18, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.311586618423462
Epoch: 19, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0352444648742676
Epoch: 20, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0982131958007812
Epoch: 21, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1454203128814697
Epoch: 22, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1080036163330078
Epoch: 23, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.934838056564331
Epoch: 24, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 13235
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps625_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7441318035125732
Epoch: 1, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
Validation loss decreased (inf --> -0.466657).  Saving model ...
Epoch: 2 cost time: 1.1077373027801514
Epoch: 2, Steps: 1 | Train Loss: 1.230 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.8459572792053223
Epoch: 3, Steps: 1 | Train Loss: 1.118 Vali Loss: 0.993 Vali Acc: 0.533 Test Loss: 0.993 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 1.2458045482635498
Epoch: 4, Steps: 1 | Train Loss: 1.201 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.9123270511627197
Epoch: 5, Steps: 1 | Train Loss: 1.134 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.8618295192718506
Epoch: 6, Steps: 1 | Train Loss: 1.166 Vali Loss: 0.982 Vali Acc: 0.467 Test Loss: 0.982 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7858133316040039
Epoch: 7, Steps: 1 | Train Loss: 1.262 Vali Loss: 0.980 Vali Acc: 0.467 Test Loss: 0.980 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8107404708862305
Epoch: 8, Steps: 1 | Train Loss: 1.101 Vali Loss: 0.977 Vali Acc: 0.467 Test Loss: 0.977 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8825459480285645
Epoch: 9, Steps: 1 | Train Loss: 1.009 Vali Loss: 0.975 Vali Acc: 0.467 Test Loss: 0.975 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1518173217773438
Epoch: 10, Steps: 1 | Train Loss: 0.981 Vali Loss: 0.973 Vali Acc: 0.467 Test Loss: 0.973 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9540126323699951
Epoch: 11, Steps: 1 | Train Loss: 1.003 Vali Loss: 0.971 Vali Acc: 0.467 Test Loss: 0.971 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1525444984436035
Epoch: 12, Steps: 1 | Train Loss: 1.154 Vali Loss: 0.969 Vali Acc: 0.400 Test Loss: 0.969 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0816948413848877
Epoch: 13, Steps: 1 | Train Loss: 1.003 Vali Loss: 0.967 Vali Acc: 0.400 Test Loss: 0.967 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8509371280670166
Epoch: 14, Steps: 1 | Train Loss: 1.066 Vali Loss: 0.965 Vali Acc: 0.467 Test Loss: 0.965 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1876413822174072
Epoch: 15, Steps: 1 | Train Loss: 1.103 Vali Loss: 0.964 Vali Acc: 0.467 Test Loss: 0.964 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_PatchTST_UEA_ftM_sl2500_ll0_pl0_el1_dm16_nh4_df64_ps625_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14659
model size : 0.37MB
