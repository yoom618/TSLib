Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5753304958343506
Epoch: 1, Steps: 3 | Train Loss: 1.588 Vali Loss: 1.430 Vali Acc: 0.150 Test Loss: 1.430 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.5944368839263916
Epoch: 2, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.340 Vali Acc: 0.275 Test Loss: 1.340 Test Acc: 0.275
Validation loss decreased (-0.149986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.6373333930969238
Epoch: 3, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.207 Vali Acc: 0.450 Test Loss: 1.207 Test Acc: 0.450
Validation loss decreased (-0.274987 --> -0.449988).  Saving model ...
Epoch: 4 cost time: 0.558560848236084
Epoch: 4, Steps: 3 | Train Loss: 0.845 Vali Loss: 1.084 Vali Acc: 0.550 Test Loss: 1.084 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549989).  Saving model ...
Epoch: 5 cost time: 0.602290153503418
Epoch: 5, Steps: 3 | Train Loss: 0.584 Vali Loss: 0.998 Vali Acc: 0.650 Test Loss: 0.998 Test Acc: 0.650
Validation loss decreased (-0.549989 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 0.5277566909790039
Epoch: 6, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.879 Vali Acc: 0.725 Test Loss: 0.879 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 0.46256351470947266
Epoch: 7, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 0.5713975429534912
Epoch: 8, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.819 Vali Acc: 0.725 Test Loss: 0.819 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.571209192276001
Epoch: 9, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.794 Vali Acc: 0.775 Test Loss: 0.794 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 10 cost time: 0.5246117115020752
Epoch: 10, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.834 Vali Acc: 0.750 Test Loss: 0.834 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5709242820739746
Epoch: 11, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.822 Vali Acc: 0.750 Test Loss: 0.822 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5225691795349121
Epoch: 12, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.828 Vali Acc: 0.750 Test Loss: 0.828 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5113837718963623
Epoch: 13, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.831 Vali Acc: 0.775 Test Loss: 0.831 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5821399688720703
Epoch: 14, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.832 Vali Acc: 0.800 Test Loss: 0.832 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 0.5394203662872314
Epoch: 15, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.824 Vali Acc: 0.825 Test Loss: 0.824 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.5305261611938477
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.825 Test Loss: 0.820 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.6649410724639893
Epoch: 17, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.825 Test Loss: 0.820 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 0.5659909248352051
Epoch: 18, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.820 Vali Acc: 0.825 Test Loss: 0.820 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.528968334197998
Epoch: 19, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.825 Test Loss: 0.823 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5737934112548828
Epoch: 20, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5666570663452148
Epoch: 21, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.576284646987915
Epoch: 22, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.825 Test Loss: 0.832 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6814689636230469
Epoch: 23, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.825 Test Loss: 0.835 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5545313358306885
Epoch: 24, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.825 Test Loss: 0.838 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5382585525512695
Epoch: 25, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.825 Test Loss: 0.841 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.4636659622192383
Epoch: 26, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.825 Test Loss: 0.844 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.4931960105895996
Epoch: 27, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.825 Test Loss: 0.847 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 551684
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.09883713722229
Epoch: 1, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.506 Vali Acc: 0.250 Test Loss: 1.506 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.6427590847015381
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.414 Vali Acc: 0.300 Test Loss: 1.414 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.5243666172027588
Epoch: 3, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.289 Vali Acc: 0.475 Test Loss: 1.289 Test Acc: 0.475
Validation loss decreased (-0.299986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.691688060760498
Epoch: 4, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.176 Vali Acc: 0.525 Test Loss: 1.176 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.6829197406768799
Epoch: 5, Steps: 3 | Train Loss: 0.731 Vali Loss: 1.094 Vali Acc: 0.575 Test Loss: 1.094 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.6285748481750488
Epoch: 6, Steps: 3 | Train Loss: 0.489 Vali Loss: 1.018 Vali Acc: 0.575 Test Loss: 1.018 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 7 cost time: 0.5866153240203857
Epoch: 7, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.936 Vali Acc: 0.600 Test Loss: 0.936 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599991).  Saving model ...
Epoch: 8 cost time: 0.7152221202850342
Epoch: 8, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.890 Vali Acc: 0.600 Test Loss: 0.890 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 9 cost time: 0.6423845291137695
Epoch: 9, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.872 Vali Acc: 0.700 Test Loss: 0.872 Test Acc: 0.700
Validation loss decreased (-0.599991 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 0.7004373073577881
Epoch: 10, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.879 Vali Acc: 0.675 Test Loss: 0.879 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6686081886291504
Epoch: 11, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.841 Vali Acc: 0.700 Test Loss: 0.841 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 12 cost time: 0.6816577911376953
Epoch: 12, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.832 Vali Acc: 0.700 Test Loss: 0.832 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 13 cost time: 0.7014148235321045
Epoch: 13, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.841 Vali Acc: 0.725 Test Loss: 0.841 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724992).  Saving model ...
Epoch: 14 cost time: 0.741767406463623
Epoch: 14, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.855 Vali Acc: 0.725 Test Loss: 0.855 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6087245941162109
Epoch: 15, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.871 Vali Acc: 0.725 Test Loss: 0.871 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6403036117553711
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.881 Vali Acc: 0.700 Test Loss: 0.881 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5801677703857422
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.891 Vali Acc: 0.675 Test Loss: 0.891 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7406008243560791
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.901 Vali Acc: 0.700 Test Loss: 0.901 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6248440742492676
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.909 Vali Acc: 0.700 Test Loss: 0.909 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5592825412750244
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.912 Vali Acc: 0.700 Test Loss: 0.912 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6899819374084473
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.914 Vali Acc: 0.700 Test Loss: 0.914 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.605926513671875
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.700 Test Loss: 0.915 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.665701150894165
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.725 Test Loss: 0.916 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 499716
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.055579900741577
Epoch: 1, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.347 Vali Acc: 0.350 Test Loss: 1.347 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.5129506587982178
Epoch: 2, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.310 Vali Acc: 0.425 Test Loss: 1.310 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.6272857189178467
Epoch: 3, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.256 Vali Acc: 0.475 Test Loss: 1.256 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.6231780052185059
Epoch: 4, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.201 Vali Acc: 0.550 Test Loss: 1.201 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.6066200733184814
Epoch: 5, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.145 Vali Acc: 0.475 Test Loss: 1.145 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5063292980194092
Epoch: 6, Steps: 3 | Train Loss: 0.670 Vali Loss: 1.058 Vali Acc: 0.700 Test Loss: 1.058 Test Acc: 0.700
Validation loss decreased (-0.549988 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 0.6938774585723877
Epoch: 7, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.996 Vali Acc: 0.725 Test Loss: 0.996 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 0.5902960300445557
Epoch: 8, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.965 Vali Acc: 0.700 Test Loss: 0.965 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5324394702911377
Epoch: 9, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.944 Vali Acc: 0.650 Test Loss: 0.944 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.651766300201416
Epoch: 10, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.917 Vali Acc: 0.675 Test Loss: 0.917 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.49838995933532715
Epoch: 11, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.906 Vali Acc: 0.675 Test Loss: 0.906 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7080211639404297
Epoch: 12, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.898 Vali Acc: 0.700 Test Loss: 0.898 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5410876274108887
Epoch: 13, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.903 Vali Acc: 0.675 Test Loss: 0.903 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.651627779006958
Epoch: 14, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.923 Vali Acc: 0.675 Test Loss: 0.923 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5225896835327148
Epoch: 15, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.961 Vali Acc: 0.675 Test Loss: 0.961 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6780006885528564
Epoch: 16, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.995 Vali Acc: 0.650 Test Loss: 0.995 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6166160106658936
Epoch: 17, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.025 Vali Acc: 0.650 Test Loss: 1.025 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 475524
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2349612712860107
Epoch: 1, Steps: 3 | Train Loss: 1.479 Vali Loss: 1.517 Vali Acc: 0.225 Test Loss: 1.517 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.7167208194732666
Epoch: 2, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.465 Vali Acc: 0.300 Test Loss: 1.465 Test Acc: 0.300
Validation loss decreased (-0.224985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.5493686199188232
Epoch: 3, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.389 Vali Acc: 0.325 Test Loss: 1.389 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.7539863586425781
Epoch: 4, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.316 Vali Acc: 0.400 Test Loss: 1.316 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.7209610939025879
Epoch: 5, Steps: 3 | Train Loss: 1.019 Vali Loss: 1.246 Vali Acc: 0.450 Test Loss: 1.246 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.5778241157531738
Epoch: 6, Steps: 3 | Train Loss: 0.715 Vali Loss: 1.170 Vali Acc: 0.475 Test Loss: 1.170 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.6890823841094971
Epoch: 7, Steps: 3 | Train Loss: 0.526 Vali Loss: 1.124 Vali Acc: 0.525 Test Loss: 1.124 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524989).  Saving model ...
Epoch: 8 cost time: 0.70816969871521
Epoch: 8, Steps: 3 | Train Loss: 0.450 Vali Loss: 1.094 Vali Acc: 0.525 Test Loss: 1.094 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 9 cost time: 0.5347311496734619
Epoch: 9, Steps: 3 | Train Loss: 0.292 Vali Loss: 1.046 Vali Acc: 0.550 Test Loss: 1.046 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549990).  Saving model ...
Epoch: 10 cost time: 0.5984129905700684
Epoch: 10, Steps: 3 | Train Loss: 0.246 Vali Loss: 1.010 Vali Acc: 0.625 Test Loss: 1.010 Test Acc: 0.625
Validation loss decreased (-0.549990 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.7489235401153564
Epoch: 11, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.995 Vali Acc: 0.650 Test Loss: 0.995 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 0.5829992294311523
Epoch: 12, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.996 Vali Acc: 0.650 Test Loss: 0.996 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6932165622711182
Epoch: 13, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.011 Vali Acc: 0.650 Test Loss: 1.011 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7403175830841064
Epoch: 14, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.050 Vali Acc: 0.700 Test Loss: 1.050 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 0.5594601631164551
Epoch: 15, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.097 Vali Acc: 0.675 Test Loss: 1.097 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.47049570083618164
Epoch: 16, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.135 Vali Acc: 0.700 Test Loss: 1.135 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.653132438659668
Epoch: 17, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.154 Vali Acc: 0.675 Test Loss: 1.154 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6750173568725586
Epoch: 18, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.160 Vali Acc: 0.675 Test Loss: 1.160 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5835087299346924
Epoch: 19, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.160 Vali Acc: 0.675 Test Loss: 1.160 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6160330772399902
Epoch: 20, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.157 Vali Acc: 0.675 Test Loss: 1.157 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6101858615875244
Epoch: 21, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.153 Vali Acc: 0.675 Test Loss: 1.153 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5981214046478271
Epoch: 22, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.148 Vali Acc: 0.700 Test Loss: 1.148 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5566802024841309
Epoch: 23, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.143 Vali Acc: 0.700 Test Loss: 1.143 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7488679885864258
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.141 Vali Acc: 0.700 Test Loss: 1.141 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 460420
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0242202281951904
Epoch: 1, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.493 Vali Acc: 0.325 Test Loss: 1.493 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.6678235530853271
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.466 Vali Acc: 0.450 Test Loss: 1.466 Test Acc: 0.450
Validation loss decreased (-0.324985 --> -0.449985).  Saving model ...
Epoch: 3 cost time: 0.6031765937805176
Epoch: 3, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.428 Vali Acc: 0.425 Test Loss: 1.428 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.587183952331543
Epoch: 4, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.385 Vali Acc: 0.500 Test Loss: 1.385 Test Acc: 0.500
Validation loss decreased (-0.449985 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 0.6107003688812256
Epoch: 5, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.341 Vali Acc: 0.475 Test Loss: 1.341 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5691630840301514
Epoch: 6, Steps: 3 | Train Loss: 0.915 Vali Loss: 1.308 Vali Acc: 0.450 Test Loss: 1.308 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6186606884002686
Epoch: 7, Steps: 3 | Train Loss: 0.791 Vali Loss: 1.275 Vali Acc: 0.525 Test Loss: 1.275 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 0.6881475448608398
Epoch: 8, Steps: 3 | Train Loss: 0.703 Vali Loss: 1.243 Vali Acc: 0.550 Test Loss: 1.243 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.7143311500549316
Epoch: 9, Steps: 3 | Train Loss: 0.477 Vali Loss: 1.212 Vali Acc: 0.525 Test Loss: 1.212 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6290066242218018
Epoch: 10, Steps: 3 | Train Loss: 0.371 Vali Loss: 1.204 Vali Acc: 0.525 Test Loss: 1.204 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5847368240356445
Epoch: 11, Steps: 3 | Train Loss: 0.298 Vali Loss: 1.192 Vali Acc: 0.525 Test Loss: 1.192 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5898733139038086
Epoch: 12, Steps: 3 | Train Loss: 0.225 Vali Loss: 1.197 Vali Acc: 0.600 Test Loss: 1.197 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.7468652725219727
Epoch: 13, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.226 Vali Acc: 0.575 Test Loss: 1.226 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6957950592041016
Epoch: 14, Steps: 3 | Train Loss: 0.107 Vali Loss: 1.241 Vali Acc: 0.575 Test Loss: 1.241 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7341930866241455
Epoch: 15, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.241 Vali Acc: 0.625 Test Loss: 1.241 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 16 cost time: 0.7082514762878418
Epoch: 16, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.233 Vali Acc: 0.650 Test Loss: 1.233 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 17 cost time: 0.7294023036956787
Epoch: 17, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.221 Vali Acc: 0.650 Test Loss: 1.221 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 18 cost time: 0.7108330726623535
Epoch: 18, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.217 Vali Acc: 0.650 Test Loss: 1.217 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 19 cost time: 0.684333086013794
Epoch: 19, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.211 Vali Acc: 0.650 Test Loss: 1.211 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 20 cost time: 0.6873569488525391
Epoch: 20, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.216 Vali Acc: 0.700 Test Loss: 1.216 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699988).  Saving model ...
Epoch: 21 cost time: 0.6289229393005371
Epoch: 21, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.226 Vali Acc: 0.700 Test Loss: 1.226 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.669079065322876
Epoch: 22, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.239 Vali Acc: 0.700 Test Loss: 1.239 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6158905029296875
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.252 Vali Acc: 0.700 Test Loss: 1.252 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6600823402404785
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.264 Vali Acc: 0.700 Test Loss: 1.264 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7204787731170654
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.274 Vali Acc: 0.700 Test Loss: 1.274 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7449171543121338
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.278 Vali Acc: 0.700 Test Loss: 1.278 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.723912239074707
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.283 Vali Acc: 0.700 Test Loss: 1.283 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7793726921081543
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.285 Vali Acc: 0.700 Test Loss: 1.285 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6178073883056641
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.286 Vali Acc: 0.700 Test Loss: 1.286 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7083418369293213
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.283 Vali Acc: 0.675 Test Loss: 1.283 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 436484
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9648463726043701
Epoch: 1, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.529 Vali Acc: 0.300 Test Loss: 1.529 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.5812287330627441
Epoch: 2, Steps: 3 | Train Loss: 1.497 Vali Loss: 1.509 Vali Acc: 0.300 Test Loss: 1.509 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.5619120597839355
Epoch: 3, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.479 Vali Acc: 0.350 Test Loss: 1.479 Test Acc: 0.350
Validation loss decreased (-0.299985 --> -0.349985).  Saving model ...
Epoch: 4 cost time: 0.5262250900268555
Epoch: 4, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.436 Vali Acc: 0.400 Test Loss: 1.436 Test Acc: 0.400
Validation loss decreased (-0.349985 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.4830305576324463
Epoch: 5, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.391 Vali Acc: 0.475 Test Loss: 1.391 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474986).  Saving model ...
Epoch: 6 cost time: 0.5824666023254395
Epoch: 6, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.350 Vali Acc: 0.475 Test Loss: 1.350 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.5062198638916016
Epoch: 7, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.318 Vali Acc: 0.500 Test Loss: 1.318 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.6631958484649658
Epoch: 8, Steps: 3 | Train Loss: 0.704 Vali Loss: 1.292 Vali Acc: 0.525 Test Loss: 1.292 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 0.5492727756500244
Epoch: 9, Steps: 3 | Train Loss: 0.607 Vali Loss: 1.270 Vali Acc: 0.525 Test Loss: 1.270 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 0.5610644817352295
Epoch: 10, Steps: 3 | Train Loss: 0.497 Vali Loss: 1.240 Vali Acc: 0.550 Test Loss: 1.240 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.6184356212615967
Epoch: 11, Steps: 3 | Train Loss: 0.425 Vali Loss: 1.219 Vali Acc: 0.600 Test Loss: 1.219 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 0.6130492687225342
Epoch: 12, Steps: 3 | Train Loss: 0.281 Vali Loss: 1.198 Vali Acc: 0.600 Test Loss: 1.198 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.58933424949646
Epoch: 13, Steps: 3 | Train Loss: 0.271 Vali Loss: 1.187 Vali Acc: 0.625 Test Loss: 1.187 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 14 cost time: 0.6570558547973633
Epoch: 14, Steps: 3 | Train Loss: 0.204 Vali Loss: 1.185 Vali Acc: 0.625 Test Loss: 1.185 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 15 cost time: 0.5698075294494629
Epoch: 15, Steps: 3 | Train Loss: 0.130 Vali Loss: 1.198 Vali Acc: 0.625 Test Loss: 1.198 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5349042415618896
Epoch: 16, Steps: 3 | Train Loss: 0.116 Vali Loss: 1.221 Vali Acc: 0.625 Test Loss: 1.221 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5704326629638672
Epoch: 17, Steps: 3 | Train Loss: 0.082 Vali Loss: 1.248 Vali Acc: 0.650 Test Loss: 1.248 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 18 cost time: 0.6533653736114502
Epoch: 18, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.282 Vali Acc: 0.625 Test Loss: 1.282 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6113903522491455
Epoch: 19, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.304 Vali Acc: 0.675 Test Loss: 1.304 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674987).  Saving model ...
Epoch: 20 cost time: 0.6922316551208496
Epoch: 20, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.311 Vali Acc: 0.675 Test Loss: 1.311 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5969030857086182
Epoch: 21, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.314 Vali Acc: 0.675 Test Loss: 1.314 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6341419219970703
Epoch: 22, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.315 Vali Acc: 0.675 Test Loss: 1.315 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6304607391357422
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.315 Vali Acc: 0.675 Test Loss: 1.315 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6647875308990479
Epoch: 24, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.317 Vali Acc: 0.675 Test Loss: 1.317 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6167302131652832
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.320 Vali Acc: 0.675 Test Loss: 1.320 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5702385902404785
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.320 Vali Acc: 0.675 Test Loss: 1.320 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6047091484069824
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.323 Vali Acc: 0.675 Test Loss: 1.323 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5337293148040771
Epoch: 28, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.323 Vali Acc: 0.675 Test Loss: 1.323 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6007921695709229
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.328 Vali Acc: 0.650 Test Loss: 1.328 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 430980
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.193544626235962
Epoch: 1, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.460 Vali Acc: 0.300 Test Loss: 1.460 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.5371963977813721
Epoch: 2, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.431 Vali Acc: 0.400 Test Loss: 1.431 Test Acc: 0.400
Validation loss decreased (-0.299985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.5996277332305908
Epoch: 3, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.398 Vali Acc: 0.400 Test Loss: 1.398 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.5267775058746338
Epoch: 4, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.360 Vali Acc: 0.450 Test Loss: 1.360 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 5 cost time: 0.5208027362823486
Epoch: 5, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.328 Vali Acc: 0.450 Test Loss: 1.328 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.5664904117584229
Epoch: 6, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.300 Vali Acc: 0.450 Test Loss: 1.300 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.6381080150604248
Epoch: 7, Steps: 3 | Train Loss: 0.820 Vali Loss: 1.279 Vali Acc: 0.500 Test Loss: 1.279 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.5899922847747803
Epoch: 8, Steps: 3 | Train Loss: 0.796 Vali Loss: 1.262 Vali Acc: 0.475 Test Loss: 1.262 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6092066764831543
Epoch: 9, Steps: 3 | Train Loss: 0.618 Vali Loss: 1.250 Vali Acc: 0.475 Test Loss: 1.250 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.548701286315918
Epoch: 10, Steps: 3 | Train Loss: 0.502 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.7125289440155029
Epoch: 11, Steps: 3 | Train Loss: 0.473 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6597156524658203
Epoch: 12, Steps: 3 | Train Loss: 0.357 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.609647274017334
Epoch: 13, Steps: 3 | Train Loss: 0.348 Vali Loss: 1.256 Vali Acc: 0.525 Test Loss: 1.256 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524987).  Saving model ...
Epoch: 14 cost time: 0.5704529285430908
Epoch: 14, Steps: 3 | Train Loss: 0.250 Vali Loss: 1.233 Vali Acc: 0.550 Test Loss: 1.233 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.5806615352630615
Epoch: 15, Steps: 3 | Train Loss: 0.237 Vali Loss: 1.208 Vali Acc: 0.575 Test Loss: 1.208 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 16 cost time: 0.599963903427124
Epoch: 16, Steps: 3 | Train Loss: 0.170 Vali Loss: 1.171 Vali Acc: 0.600 Test Loss: 1.171 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 17 cost time: 0.5620605945587158
Epoch: 17, Steps: 3 | Train Loss: 0.128 Vali Loss: 1.149 Vali Acc: 0.625 Test Loss: 1.149 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.6263065338134766
Epoch: 18, Steps: 3 | Train Loss: 0.079 Vali Loss: 1.135 Vali Acc: 0.650 Test Loss: 1.135 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 0.6811552047729492
Epoch: 19, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.112 Vali Acc: 0.675 Test Loss: 1.112 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 20 cost time: 0.559934139251709
Epoch: 20, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.103 Vali Acc: 0.650 Test Loss: 1.103 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5944457054138184
Epoch: 21, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.100 Vali Acc: 0.650 Test Loss: 1.100 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6055986881256104
Epoch: 22, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.113 Vali Acc: 0.650 Test Loss: 1.113 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5678598880767822
Epoch: 23, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.123 Vali Acc: 0.650 Test Loss: 1.123 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6223561763763428
Epoch: 24, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.134 Vali Acc: 0.650 Test Loss: 1.134 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5613625049591064
Epoch: 25, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.145 Vali Acc: 0.650 Test Loss: 1.145 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5408203601837158
Epoch: 26, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.155 Vali Acc: 0.650 Test Loss: 1.155 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5241219997406006
Epoch: 27, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.162 Vali Acc: 0.650 Test Loss: 1.162 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6188793182373047
Epoch: 28, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.171 Vali Acc: 0.650 Test Loss: 1.171 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6034464836120605
Epoch: 29, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.175 Vali Acc: 0.650 Test Loss: 1.175 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df256_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 422404
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.055166482925415
Epoch: 1, Steps: 3 | Train Loss: 1.593 Vali Loss: 1.461 Vali Acc: 0.175 Test Loss: 1.461 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.7411022186279297
Epoch: 2, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.398 Vali Acc: 0.225 Test Loss: 1.398 Test Acc: 0.225
Validation loss decreased (-0.174985 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.8119938373565674
Epoch: 3, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.280 Vali Acc: 0.525 Test Loss: 1.280 Test Acc: 0.525
Validation loss decreased (-0.224986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 0.7466146945953369
Epoch: 4, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.164 Vali Acc: 0.600 Test Loss: 1.164 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.805534839630127
Epoch: 5, Steps: 3 | Train Loss: 0.586 Vali Loss: 1.005 Vali Acc: 0.650 Test Loss: 1.005 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 0.741178035736084
Epoch: 6, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.954 Vali Acc: 0.650 Test Loss: 0.954 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 7 cost time: 0.7548978328704834
Epoch: 7, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.916 Vali Acc: 0.650 Test Loss: 0.916 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 8 cost time: 0.7676668167114258
Epoch: 8, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.881 Vali Acc: 0.700 Test Loss: 0.881 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699991).  Saving model ...
Epoch: 9 cost time: 0.7237904071807861
Epoch: 9, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.832 Vali Acc: 0.775 Test Loss: 0.832 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774992).  Saving model ...
Epoch: 10 cost time: 0.7243213653564453
Epoch: 10, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 11 cost time: 0.660456657409668
Epoch: 11, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.818 Vali Acc: 0.800 Test Loss: 0.818 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8165547847747803
Epoch: 12, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.844 Vali Acc: 0.775 Test Loss: 0.844 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6889955997467041
Epoch: 13, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.875 Vali Acc: 0.775 Test Loss: 0.875 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6664252281188965
Epoch: 14, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7202939987182617
Epoch: 15, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7165288925170898
Epoch: 16, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7610762119293213
Epoch: 17, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.962 Vali Acc: 0.775 Test Loss: 0.962 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8673198223114014
Epoch: 18, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.968 Vali Acc: 0.775 Test Loss: 0.968 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8100807666778564
Epoch: 19, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.968 Vali Acc: 0.775 Test Loss: 0.968 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.716357946395874
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.967 Vali Acc: 0.800 Test Loss: 0.967 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 452996
model size : 4.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0993499755859375
Epoch: 1, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.380 Vali Acc: 0.350 Test Loss: 1.380 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.8136076927185059
Epoch: 2, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.320 Vali Acc: 0.375 Test Loss: 1.320 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.7352168560028076
Epoch: 3, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.234 Vali Acc: 0.475 Test Loss: 1.234 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.6872973442077637
Epoch: 4, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.136 Vali Acc: 0.475 Test Loss: 1.136 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474989).  Saving model ...
Epoch: 5 cost time: 0.7907345294952393
Epoch: 5, Steps: 3 | Train Loss: 0.696 Vali Loss: 1.054 Vali Acc: 0.550 Test Loss: 1.054 Test Acc: 0.550
Validation loss decreased (-0.474989 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.7476449012756348
Epoch: 6, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.957 Vali Acc: 0.700 Test Loss: 0.957 Test Acc: 0.700
Validation loss decreased (-0.549989 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 0.8336954116821289
Epoch: 7, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.905 Vali Acc: 0.700 Test Loss: 0.905 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 8 cost time: 0.7404272556304932
Epoch: 8, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.847 Vali Acc: 0.725 Test Loss: 0.847 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724992).  Saving model ...
Epoch: 9 cost time: 0.7957174777984619
Epoch: 9, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.840 Vali Acc: 0.700 Test Loss: 0.840 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6800665855407715
Epoch: 10, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.859 Vali Acc: 0.650 Test Loss: 0.859 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8289613723754883
Epoch: 11, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.845 Vali Acc: 0.700 Test Loss: 0.845 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7547008991241455
Epoch: 12, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.818 Vali Acc: 0.725 Test Loss: 0.818 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 13 cost time: 0.7120761871337891
Epoch: 13, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.811 Vali Acc: 0.775 Test Loss: 0.811 Test Acc: 0.775
Validation loss decreased (-0.724992 --> -0.774992).  Saving model ...
Epoch: 14 cost time: 0.7907915115356445
Epoch: 14, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.814 Vali Acc: 0.775 Test Loss: 0.814 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7025887966156006
Epoch: 15, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6622545719146729
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7382464408874512
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.879 Vali Acc: 0.725 Test Loss: 0.879 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7741169929504395
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.900 Vali Acc: 0.700 Test Loss: 0.900 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6669988632202148
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.914 Vali Acc: 0.700 Test Loss: 0.914 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7189657688140869
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.924 Vali Acc: 0.700 Test Loss: 0.924 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7050533294677734
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.700 Test Loss: 0.930 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7092218399047852
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.700 Test Loss: 0.933 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6723117828369141
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.934 Vali Acc: 0.725 Test Loss: 0.934 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 401028
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.342808723449707
Epoch: 1, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.265 Vali Acc: 0.300 Test Loss: 1.265 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.6694221496582031
Epoch: 2, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.233 Vali Acc: 0.350 Test Loss: 1.233 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349988).  Saving model ...
Epoch: 3 cost time: 0.790865421295166
Epoch: 3, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.173 Vali Acc: 0.475 Test Loss: 1.173 Test Acc: 0.475
Validation loss decreased (-0.349988 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.7743632793426514
Epoch: 4, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.7380321025848389
Epoch: 5, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.070 Vali Acc: 0.625 Test Loss: 1.070 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 0.7003059387207031
Epoch: 6, Steps: 3 | Train Loss: 0.569 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7287037372589111
Epoch: 7, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.980 Vali Acc: 0.625 Test Loss: 0.980 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 0.7346301078796387
Epoch: 8, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.948 Vali Acc: 0.625 Test Loss: 0.948 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 9 cost time: 0.7118146419525146
Epoch: 9, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.922 Vali Acc: 0.650 Test Loss: 0.922 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649991).  Saving model ...
Epoch: 10 cost time: 0.65968918800354
Epoch: 10, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.895 Vali Acc: 0.650 Test Loss: 0.895 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 11 cost time: 0.8656485080718994
Epoch: 11, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.894 Vali Acc: 0.700 Test Loss: 0.894 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 0.7522861957550049
Epoch: 12, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.903 Vali Acc: 0.725 Test Loss: 0.903 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.809579610824585
Epoch: 13, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.931 Vali Acc: 0.675 Test Loss: 0.931 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7673969268798828
Epoch: 14, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.960 Vali Acc: 0.675 Test Loss: 0.960 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7465062141418457
Epoch: 15, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.991 Vali Acc: 0.675 Test Loss: 0.991 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7078747749328613
Epoch: 16, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.012 Vali Acc: 0.675 Test Loss: 1.012 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6827466487884521
Epoch: 17, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.035 Vali Acc: 0.675 Test Loss: 1.035 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.737511157989502
Epoch: 18, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6999688148498535
Epoch: 19, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6908633708953857
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7964982986450195
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.71610426902771
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 376836
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.895803451538086
Epoch: 1, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.377 Vali Acc: 0.325 Test Loss: 1.377 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.8402469158172607
Epoch: 2, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.330 Vali Acc: 0.400 Test Loss: 1.330 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.8252348899841309
Epoch: 3, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.261 Vali Acc: 0.475 Test Loss: 1.261 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.761049747467041
Epoch: 4, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.8327803611755371
Epoch: 5, Steps: 3 | Train Loss: 0.784 Vali Loss: 1.126 Vali Acc: 0.525 Test Loss: 1.126 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 6 cost time: 0.7467176914215088
Epoch: 6, Steps: 3 | Train Loss: 0.687 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.7254655361175537
Epoch: 7, Steps: 3 | Train Loss: 0.569 Vali Loss: 1.028 Vali Acc: 0.650 Test Loss: 1.028 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.779529333114624
Epoch: 8, Steps: 3 | Train Loss: 0.374 Vali Loss: 1.001 Vali Acc: 0.625 Test Loss: 1.001 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8205716609954834
Epoch: 9, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.991 Vali Acc: 0.625 Test Loss: 0.991 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8016629219055176
Epoch: 10, Steps: 3 | Train Loss: 0.270 Vali Loss: 1.004 Vali Acc: 0.625 Test Loss: 1.004 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7545146942138672
Epoch: 11, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.992 Vali Acc: 0.625 Test Loss: 0.992 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.76983642578125
Epoch: 12, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.961 Vali Acc: 0.650 Test Loss: 0.961 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 0.7010498046875
Epoch: 13, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.948 Vali Acc: 0.650 Test Loss: 0.948 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 14 cost time: 0.8044066429138184
Epoch: 14, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.943 Vali Acc: 0.675 Test Loss: 0.943 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 15 cost time: 0.8510124683380127
Epoch: 15, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.952 Vali Acc: 0.675 Test Loss: 0.952 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8979544639587402
Epoch: 16, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.966 Vali Acc: 0.700 Test Loss: 0.966 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 0.8304505348205566
Epoch: 17, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.977 Vali Acc: 0.700 Test Loss: 0.977 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7934348583221436
Epoch: 18, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.989 Vali Acc: 0.700 Test Loss: 0.989 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8094778060913086
Epoch: 19, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.003 Vali Acc: 0.700 Test Loss: 1.003 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8596656322479248
Epoch: 20, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.016 Vali Acc: 0.675 Test Loss: 1.016 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6738390922546387
Epoch: 21, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.028 Vali Acc: 0.700 Test Loss: 1.028 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8188865184783936
Epoch: 22, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.035 Vali Acc: 0.700 Test Loss: 1.035 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7578699588775635
Epoch: 23, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.043 Vali Acc: 0.700 Test Loss: 1.043 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9026310443878174
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.051 Vali Acc: 0.700 Test Loss: 1.051 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8840508460998535
Epoch: 25, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.060 Vali Acc: 0.700 Test Loss: 1.060 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7698357105255127
Epoch: 26, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.066 Vali Acc: 0.700 Test Loss: 1.066 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 361732
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7353339195251465
Epoch: 1, Steps: 3 | Train Loss: 1.635 Vali Loss: 1.409 Vali Acc: 0.325 Test Loss: 1.409 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.9820575714111328
Epoch: 2, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.373 Vali Acc: 0.300 Test Loss: 1.373 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7947556972503662
Epoch: 3, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.339 Vali Acc: 0.400 Test Loss: 1.339 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.7691948413848877
Epoch: 4, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.8816184997558594
Epoch: 5, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.252 Vali Acc: 0.450 Test Loss: 1.252 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.7915060520172119
Epoch: 6, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.197 Vali Acc: 0.475 Test Loss: 1.197 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.7599074840545654
Epoch: 7, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.150 Vali Acc: 0.525 Test Loss: 1.150 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.8925759792327881
Epoch: 8, Steps: 3 | Train Loss: 0.665 Vali Loss: 1.119 Vali Acc: 0.550 Test Loss: 1.119 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.7794866561889648
Epoch: 9, Steps: 3 | Train Loss: 0.570 Vali Loss: 1.107 Vali Acc: 0.550 Test Loss: 1.107 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 0.7800741195678711
Epoch: 10, Steps: 3 | Train Loss: 0.410 Vali Loss: 1.095 Vali Acc: 0.575 Test Loss: 1.095 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.8803343772888184
Epoch: 11, Steps: 3 | Train Loss: 0.323 Vali Loss: 1.084 Vali Acc: 0.575 Test Loss: 1.084 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.8617045879364014
Epoch: 12, Steps: 3 | Train Loss: 0.274 Vali Loss: 1.077 Vali Acc: 0.575 Test Loss: 1.077 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.7949190139770508
Epoch: 13, Steps: 3 | Train Loss: 0.203 Vali Loss: 1.071 Vali Acc: 0.650 Test Loss: 1.071 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 0.9558217525482178
Epoch: 14, Steps: 3 | Train Loss: 0.165 Vali Loss: 1.076 Vali Acc: 0.650 Test Loss: 1.076 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8821465969085693
Epoch: 15, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.069 Vali Acc: 0.650 Test Loss: 1.069 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 0.6860113143920898
Epoch: 16, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.069 Vali Acc: 0.675 Test Loss: 1.069 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 17 cost time: 0.7899882793426514
Epoch: 17, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.074 Vali Acc: 0.750 Test Loss: 1.074 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749989).  Saving model ...
Epoch: 18 cost time: 0.8057289123535156
Epoch: 18, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.093 Vali Acc: 0.750 Test Loss: 1.093 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.82918381690979
Epoch: 19, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.106 Vali Acc: 0.750 Test Loss: 1.106 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7146475315093994
Epoch: 20, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.122 Vali Acc: 0.750 Test Loss: 1.122 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6698801517486572
Epoch: 21, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.137 Vali Acc: 0.700 Test Loss: 1.137 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8290402889251709
Epoch: 22, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.150 Vali Acc: 0.700 Test Loss: 1.150 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7537586688995361
Epoch: 23, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.161 Vali Acc: 0.700 Test Loss: 1.161 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6467454433441162
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.173 Vali Acc: 0.700 Test Loss: 1.173 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7298851013183594
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.177 Vali Acc: 0.700 Test Loss: 1.177 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7717037200927734
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.181 Vali Acc: 0.700 Test Loss: 1.181 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8181538581848145
Epoch: 27, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.185 Vali Acc: 0.700 Test Loss: 1.185 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 337796
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2835135459899902
Epoch: 1, Steps: 3 | Train Loss: 1.574 Vali Loss: 1.400 Vali Acc: 0.250 Test Loss: 1.400 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.6390013694763184
Epoch: 2, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.377 Vali Acc: 0.200 Test Loss: 1.377 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6046140193939209
Epoch: 3, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.346 Vali Acc: 0.225 Test Loss: 1.346 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6268417835235596
Epoch: 4, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.316 Vali Acc: 0.325 Test Loss: 1.316 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.7247664928436279
Epoch: 5, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.287 Vali Acc: 0.450 Test Loss: 1.287 Test Acc: 0.450
Validation loss decreased (-0.324987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.632573127746582
Epoch: 6, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.263 Vali Acc: 0.450 Test Loss: 1.263 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.5950772762298584
Epoch: 7, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.6660525798797607
Epoch: 8, Steps: 3 | Train Loss: 0.703 Vali Loss: 1.215 Vali Acc: 0.550 Test Loss: 1.215 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.6400811672210693
Epoch: 9, Steps: 3 | Train Loss: 0.601 Vali Loss: 1.176 Vali Acc: 0.575 Test Loss: 1.176 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.5844576358795166
Epoch: 10, Steps: 3 | Train Loss: 0.554 Vali Loss: 1.140 Vali Acc: 0.600 Test Loss: 1.140 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.5599141120910645
Epoch: 11, Steps: 3 | Train Loss: 0.515 Vali Loss: 1.105 Vali Acc: 0.625 Test Loss: 1.105 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.6275365352630615
Epoch: 12, Steps: 3 | Train Loss: 0.313 Vali Loss: 1.087 Vali Acc: 0.625 Test Loss: 1.087 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.638988733291626
Epoch: 13, Steps: 3 | Train Loss: 0.299 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 0.637160062789917
Epoch: 14, Steps: 3 | Train Loss: 0.188 Vali Loss: 1.082 Vali Acc: 0.650 Test Loss: 1.082 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5653262138366699
Epoch: 15, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.098 Vali Acc: 0.650 Test Loss: 1.098 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6884863376617432
Epoch: 16, Steps: 3 | Train Loss: 0.126 Vali Loss: 1.105 Vali Acc: 0.650 Test Loss: 1.105 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5716989040374756
Epoch: 17, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.116 Vali Acc: 0.650 Test Loss: 1.116 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6331467628479004
Epoch: 18, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.561429500579834
Epoch: 19, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.121 Vali Acc: 0.675 Test Loss: 1.121 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 20 cost time: 0.6245512962341309
Epoch: 20, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.124 Vali Acc: 0.675 Test Loss: 1.124 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6216902732849121
Epoch: 21, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.121 Vali Acc: 0.675 Test Loss: 1.121 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 22 cost time: 0.5894985198974609
Epoch: 22, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.124 Vali Acc: 0.675 Test Loss: 1.124 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6185755729675293
Epoch: 23, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.120 Vali Acc: 0.675 Test Loss: 1.120 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 24 cost time: 0.6090264320373535
Epoch: 24, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.120 Vali Acc: 0.675 Test Loss: 1.120 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.529808521270752
Epoch: 25, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.118 Vali Acc: 0.675 Test Loss: 1.118 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.494537353515625
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.116 Vali Acc: 0.675 Test Loss: 1.116 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 27 cost time: 0.5429377555847168
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.113 Vali Acc: 0.675 Test Loss: 1.113 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 28 cost time: 0.5586867332458496
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.109 Vali Acc: 0.675 Test Loss: 1.109 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 29 cost time: 0.5178606510162354
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.106 Vali Acc: 0.675 Test Loss: 1.106 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 30 cost time: 0.7905845642089844
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.104 Vali Acc: 0.700 Test Loss: 1.104 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 31 cost time: 0.5329756736755371
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.106 Vali Acc: 0.700 Test Loss: 1.106 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6054883003234863
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.106 Vali Acc: 0.700 Test Loss: 1.106 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6158008575439453
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.110 Vali Acc: 0.700 Test Loss: 1.110 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5967857837677002
Epoch: 34, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6973755359649658
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6698458194732666
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.111 Vali Acc: 0.700 Test Loss: 1.111 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6071767807006836
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.110 Vali Acc: 0.700 Test Loss: 1.110 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6330137252807617
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.112 Vali Acc: 0.700 Test Loss: 1.112 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7267513275146484
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.113 Vali Acc: 0.700 Test Loss: 1.113 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6176939010620117
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.113 Vali Acc: 0.700 Test Loss: 1.113 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 332292
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1045546531677246
Epoch: 1, Steps: 3 | Train Loss: 1.556 Vali Loss: 1.372 Vali Acc: 0.350 Test Loss: 1.372 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5667819976806641
Epoch: 2, Steps: 3 | Train Loss: 1.545 Vali Loss: 1.364 Vali Acc: 0.350 Test Loss: 1.364 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.6407642364501953
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.341 Vali Acc: 0.375 Test Loss: 1.341 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.7271459102630615
Epoch: 4, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.311 Vali Acc: 0.450 Test Loss: 1.311 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.6744968891143799
Epoch: 5, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.277 Vali Acc: 0.450 Test Loss: 1.277 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.6606409549713135
Epoch: 6, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.5516903400421143
Epoch: 7, Steps: 3 | Train Loss: 0.971 Vali Loss: 1.209 Vali Acc: 0.550 Test Loss: 1.209 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.687697172164917
Epoch: 8, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.182 Vali Acc: 0.525 Test Loss: 1.182 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5990674495697021
Epoch: 9, Steps: 3 | Train Loss: 0.764 Vali Loss: 1.160 Vali Acc: 0.525 Test Loss: 1.160 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6027209758758545
Epoch: 10, Steps: 3 | Train Loss: 0.578 Vali Loss: 1.142 Vali Acc: 0.525 Test Loss: 1.142 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.689356803894043
Epoch: 11, Steps: 3 | Train Loss: 0.555 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6260461807250977
Epoch: 12, Steps: 3 | Train Loss: 0.398 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6295571327209473
Epoch: 13, Steps: 3 | Train Loss: 0.380 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6140697002410889
Epoch: 14, Steps: 3 | Train Loss: 0.315 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6107895374298096
Epoch: 15, Steps: 3 | Train Loss: 0.256 Vali Loss: 1.080 Vali Acc: 0.525 Test Loss: 1.080 Test Acc: 0.525
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7341446876525879
Epoch: 16, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.062 Vali Acc: 0.550 Test Loss: 1.062 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 0.6677229404449463
Epoch: 17, Steps: 3 | Train Loss: 0.156 Vali Loss: 1.040 Vali Acc: 0.575 Test Loss: 1.040 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574990).  Saving model ...
Epoch: 18 cost time: 0.6001555919647217
Epoch: 18, Steps: 3 | Train Loss: 0.120 Vali Loss: 1.021 Vali Acc: 0.575 Test Loss: 1.021 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 19 cost time: 0.7300763130187988
Epoch: 19, Steps: 3 | Train Loss: 0.095 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.7110669612884521
Epoch: 20, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.988 Vali Acc: 0.625 Test Loss: 0.988 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 21 cost time: 0.6863656044006348
Epoch: 21, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.978 Vali Acc: 0.625 Test Loss: 0.978 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 22 cost time: 0.7831325531005859
Epoch: 22, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.973 Vali Acc: 0.625 Test Loss: 0.973 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 23 cost time: 0.6645402908325195
Epoch: 23, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.974 Vali Acc: 0.625 Test Loss: 0.974 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8297948837280273
Epoch: 24, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.977 Vali Acc: 0.625 Test Loss: 0.977 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7560904026031494
Epoch: 25, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.979 Vali Acc: 0.675 Test Loss: 0.979 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 26 cost time: 0.7120654582977295
Epoch: 26, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.980 Vali Acc: 0.700 Test Loss: 0.980 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 27 cost time: 0.7424535751342773
Epoch: 27, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.988 Vali Acc: 0.675 Test Loss: 0.988 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6564648151397705
Epoch: 28, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.994 Vali Acc: 0.650 Test Loss: 0.994 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.653076171875
Epoch: 29, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.000 Vali Acc: 0.650 Test Loss: 1.000 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6385881900787354
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7388186454772949
Epoch: 31, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.006 Vali Acc: 0.650 Test Loss: 1.006 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7250001430511475
Epoch: 32, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.007 Vali Acc: 0.650 Test Loss: 1.007 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6929957866668701
Epoch: 33, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.008 Vali Acc: 0.650 Test Loss: 1.008 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7157933712005615
Epoch: 34, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.008 Vali Acc: 0.650 Test Loss: 1.008 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.70182204246521
Epoch: 35, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.007 Vali Acc: 0.650 Test Loss: 1.007 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.699371337890625
Epoch: 36, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.004 Vali Acc: 0.650 Test Loss: 1.004 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df128_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 323716
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.394439220428467
Epoch: 1, Steps: 3 | Train Loss: 1.600 Vali Loss: 1.375 Vali Acc: 0.275 Test Loss: 1.375 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.7362549304962158
Epoch: 2, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.305 Vali Acc: 0.300 Test Loss: 1.305 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.88594651222229
Epoch: 3, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.173 Vali Acc: 0.450 Test Loss: 1.173 Test Acc: 0.450
Validation loss decreased (-0.299987 --> -0.449988).  Saving model ...
Epoch: 4 cost time: 0.9381561279296875
Epoch: 4, Steps: 3 | Train Loss: 0.860 Vali Loss: 1.044 Vali Acc: 0.525 Test Loss: 1.044 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524990).  Saving model ...
Epoch: 5 cost time: 0.7576851844787598
Epoch: 5, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.978 Vali Acc: 0.575 Test Loss: 0.978 Test Acc: 0.575
Validation loss decreased (-0.524990 --> -0.574990).  Saving model ...
Epoch: 6 cost time: 0.9970855712890625
Epoch: 6, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.883 Vali Acc: 0.625 Test Loss: 0.883 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624991).  Saving model ...
Epoch: 7 cost time: 0.864349365234375
Epoch: 7, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.785 Vali Acc: 0.800 Test Loss: 0.785 Test Acc: 0.800
Validation loss decreased (-0.624991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 0.8751676082611084
Epoch: 8, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9704923629760742
Epoch: 9, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.736 Vali Acc: 0.825 Test Loss: 0.736 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 10 cost time: 1.0042719841003418
Epoch: 10, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0495519638061523
Epoch: 11, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.770 Vali Acc: 0.825 Test Loss: 0.770 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.04656982421875
Epoch: 12, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.825 Test Loss: 0.789 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0787200927734375
Epoch: 13, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.824 Vali Acc: 0.825 Test Loss: 0.824 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9586327075958252
Epoch: 14, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0038325786590576
Epoch: 15, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.874 Vali Acc: 0.800 Test Loss: 0.874 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0138845443725586
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.886 Vali Acc: 0.800 Test Loss: 0.886 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.029144525527954
Epoch: 17, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.892 Vali Acc: 0.825 Test Loss: 0.892 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9637298583984375
Epoch: 18, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.895 Vali Acc: 0.825 Test Loss: 0.895 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1023201942443848
Epoch: 19, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.825 Test Loss: 0.899 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 403652
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.576570987701416
Epoch: 1, Steps: 3 | Train Loss: 1.549 Vali Loss: 1.507 Vali Acc: 0.150 Test Loss: 1.507 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 1.0378196239471436
Epoch: 2, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.433 Vali Acc: 0.125 Test Loss: 1.433 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0443365573883057
Epoch: 3, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.312 Vali Acc: 0.325 Test Loss: 1.312 Test Acc: 0.325
Validation loss decreased (-0.149985 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 1.0766305923461914
Epoch: 4, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.230 Vali Acc: 0.375 Test Loss: 1.230 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 1.05765700340271
Epoch: 5, Steps: 3 | Train Loss: 0.803 Vali Loss: 1.155 Vali Acc: 0.450 Test Loss: 1.155 Test Acc: 0.450
Validation loss decreased (-0.374988 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 1.083531379699707
Epoch: 6, Steps: 3 | Train Loss: 0.548 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.8986203670501709
Epoch: 7, Steps: 3 | Train Loss: 0.449 Vali Loss: 1.143 Vali Acc: 0.475 Test Loss: 1.143 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0640385150909424
Epoch: 8, Steps: 3 | Train Loss: 0.304 Vali Loss: 1.047 Vali Acc: 0.575 Test Loss: 1.047 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574990).  Saving model ...
Epoch: 9 cost time: 1.018347978591919
Epoch: 9, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.964 Vali Acc: 0.625 Test Loss: 0.964 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.9292960166931152
Epoch: 10, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.896 Vali Acc: 0.625 Test Loss: 0.896 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 11 cost time: 1.1199746131896973
Epoch: 11, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.873 Vali Acc: 0.650 Test Loss: 0.873 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649991).  Saving model ...
Epoch: 12 cost time: 1.0625338554382324
Epoch: 12, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.875 Vali Acc: 0.675 Test Loss: 0.875 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 13 cost time: 1.073204517364502
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.873 Vali Acc: 0.675 Test Loss: 0.873 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 14 cost time: 1.0443270206451416
Epoch: 14, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.876 Vali Acc: 0.700 Test Loss: 0.876 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 1.0560507774353027
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.888 Vali Acc: 0.700 Test Loss: 0.888 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0842609405517578
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.899 Vali Acc: 0.700 Test Loss: 0.899 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.020693063735962
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.904 Vali Acc: 0.700 Test Loss: 0.904 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9367790222167969
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.907 Vali Acc: 0.700 Test Loss: 0.907 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9738075733184814
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.912 Vali Acc: 0.700 Test Loss: 0.912 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9113516807556152
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.916 Vali Acc: 0.700 Test Loss: 0.916 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9990673065185547
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.700 Test Loss: 0.918 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9401836395263672
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.921 Vali Acc: 0.700 Test Loss: 0.921 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.006906509399414
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.922 Vali Acc: 0.700 Test Loss: 0.922 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9874887466430664
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.924 Vali Acc: 0.700 Test Loss: 0.924 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 351684
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3758373260498047
Epoch: 1, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.308 Vali Acc: 0.275 Test Loss: 1.308 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 1.0181348323822021
Epoch: 2, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.282 Vali Acc: 0.325 Test Loss: 1.282 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.9761600494384766
Epoch: 3, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.241 Vali Acc: 0.475 Test Loss: 1.241 Test Acc: 0.475
Validation loss decreased (-0.324987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.9000418186187744
Epoch: 4, Steps: 3 | Train Loss: 0.955 Vali Loss: 1.195 Vali Acc: 0.550 Test Loss: 1.195 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.9654910564422607
Epoch: 5, Steps: 3 | Train Loss: 0.869 Vali Loss: 1.129 Vali Acc: 0.575 Test Loss: 1.129 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 1.0036463737487793
Epoch: 6, Steps: 3 | Train Loss: 0.600 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.9342079162597656
Epoch: 7, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.989 Vali Acc: 0.625 Test Loss: 0.989 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 0.981964111328125
Epoch: 8, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.957 Vali Acc: 0.625 Test Loss: 0.957 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 0.8795838356018066
Epoch: 9, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.920 Vali Acc: 0.675 Test Loss: 0.920 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674991).  Saving model ...
Epoch: 10 cost time: 0.91330885887146
Epoch: 10, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.899 Vali Acc: 0.700 Test Loss: 0.899 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.8839273452758789
Epoch: 11, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.896 Vali Acc: 0.700 Test Loss: 0.896 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 0.9198780059814453
Epoch: 12, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.903 Vali Acc: 0.650 Test Loss: 0.903 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.031733751296997
Epoch: 13, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.908 Vali Acc: 0.675 Test Loss: 0.908 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9144256114959717
Epoch: 14, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.913 Vali Acc: 0.675 Test Loss: 0.913 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9590611457824707
Epoch: 15, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.927 Vali Acc: 0.675 Test Loss: 0.927 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0310354232788086
Epoch: 16, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.949 Vali Acc: 0.725 Test Loss: 0.949 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 17 cost time: 0.9186334609985352
Epoch: 17, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.974 Vali Acc: 0.725 Test Loss: 0.974 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9993705749511719
Epoch: 18, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.002 Vali Acc: 0.725 Test Loss: 1.002 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9182357788085938
Epoch: 19, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.026 Vali Acc: 0.725 Test Loss: 1.026 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8903470039367676
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.048 Vali Acc: 0.700 Test Loss: 1.048 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.00083589553833
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.070 Vali Acc: 0.700 Test Loss: 1.070 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9290175437927246
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.086 Vali Acc: 0.700 Test Loss: 1.086 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9716055393218994
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.097 Vali Acc: 0.700 Test Loss: 1.097 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9632601737976074
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.105 Vali Acc: 0.700 Test Loss: 1.105 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9682576656341553
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9937994480133057
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.110 Vali Acc: 0.700 Test Loss: 1.110 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 327492
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.488896369934082
Epoch: 1, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.435 Vali Acc: 0.225 Test Loss: 1.435 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.9025657176971436
Epoch: 2, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.409 Vali Acc: 0.225 Test Loss: 1.409 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.8402292728424072
Epoch: 3, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.348 Vali Acc: 0.325 Test Loss: 1.348 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.852874755859375
Epoch: 4, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.278 Vali Acc: 0.450 Test Loss: 1.278 Test Acc: 0.450
Validation loss decreased (-0.324987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.8439188003540039
Epoch: 5, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.219 Vali Acc: 0.475 Test Loss: 1.219 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.8569567203521729
Epoch: 6, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.173 Vali Acc: 0.475 Test Loss: 1.173 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.8173398971557617
Epoch: 7, Steps: 3 | Train Loss: 0.612 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.7418792247772217
Epoch: 8, Steps: 3 | Train Loss: 0.453 Vali Loss: 1.113 Vali Acc: 0.525 Test Loss: 1.113 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 9 cost time: 0.8771004676818848
Epoch: 9, Steps: 3 | Train Loss: 0.278 Vali Loss: 1.094 Vali Acc: 0.525 Test Loss: 1.094 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 1.0344789028167725
Epoch: 10, Steps: 3 | Train Loss: 0.224 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.8614561557769775
Epoch: 11, Steps: 3 | Train Loss: 0.171 Vali Loss: 1.035 Vali Acc: 0.650 Test Loss: 1.035 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 0.8659813404083252
Epoch: 12, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.054 Vali Acc: 0.650 Test Loss: 1.054 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9002997875213623
Epoch: 13, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.091 Vali Acc: 0.650 Test Loss: 1.091 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.940779447555542
Epoch: 14, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.112 Vali Acc: 0.650 Test Loss: 1.112 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9303743839263916
Epoch: 15, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.139 Vali Acc: 0.650 Test Loss: 1.139 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9381725788116455
Epoch: 16, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.160 Vali Acc: 0.650 Test Loss: 1.160 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8396987915039062
Epoch: 17, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.172 Vali Acc: 0.675 Test Loss: 1.172 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674988).  Saving model ...
Epoch: 18 cost time: 0.8454098701477051
Epoch: 18, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.164 Vali Acc: 0.675 Test Loss: 1.164 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 19 cost time: 0.8562412261962891
Epoch: 19, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.149 Vali Acc: 0.675 Test Loss: 1.149 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 20 cost time: 0.8767321109771729
Epoch: 20, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.135 Vali Acc: 0.675 Test Loss: 1.135 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 21 cost time: 0.8896477222442627
Epoch: 21, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.124 Vali Acc: 0.675 Test Loss: 1.124 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 22 cost time: 0.9218473434448242
Epoch: 22, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.118 Vali Acc: 0.700 Test Loss: 1.118 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 23 cost time: 0.9133517742156982
Epoch: 23, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.114 Vali Acc: 0.700 Test Loss: 1.114 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 24 cost time: 0.9315886497497559
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.111 Vali Acc: 0.700 Test Loss: 1.111 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 25 cost time: 0.9304137229919434
Epoch: 25, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.111 Vali Acc: 0.700 Test Loss: 1.111 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 26 cost time: 0.922644853591919
Epoch: 26, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.115 Vali Acc: 0.700 Test Loss: 1.115 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9260902404785156
Epoch: 27, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.120 Vali Acc: 0.700 Test Loss: 1.120 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8731048107147217
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.126 Vali Acc: 0.700 Test Loss: 1.126 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8790619373321533
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.132 Vali Acc: 0.700 Test Loss: 1.132 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8595638275146484
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.136 Vali Acc: 0.700 Test Loss: 1.136 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8632948398590088
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.141 Vali Acc: 0.700 Test Loss: 1.141 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9243764877319336
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.147 Vali Acc: 0.700 Test Loss: 1.147 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8970637321472168
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.152 Vali Acc: 0.700 Test Loss: 1.152 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9264476299285889
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.156 Vali Acc: 0.700 Test Loss: 1.156 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8781723976135254
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.163 Vali Acc: 0.700 Test Loss: 1.163 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 312388
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.537776231765747
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.360 Vali Acc: 0.200 Test Loss: 1.360 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.9297807216644287
Epoch: 2, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.346 Vali Acc: 0.250 Test Loss: 1.346 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 1.0786101818084717
Epoch: 3, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
Validation loss decreased (-0.249987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.9464452266693115
Epoch: 4, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.302 Vali Acc: 0.450 Test Loss: 1.302 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.929943323135376
Epoch: 5, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.276 Vali Acc: 0.425 Test Loss: 1.276 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9108083248138428
Epoch: 6, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.249 Vali Acc: 0.425 Test Loss: 1.249 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8889658451080322
Epoch: 7, Steps: 3 | Train Loss: 0.721 Vali Loss: 1.234 Vali Acc: 0.450 Test Loss: 1.234 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.9585421085357666
Epoch: 8, Steps: 3 | Train Loss: 0.587 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.0132598876953125
Epoch: 9, Steps: 3 | Train Loss: 0.481 Vali Loss: 1.193 Vali Acc: 0.525 Test Loss: 1.193 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 0.9966554641723633
Epoch: 10, Steps: 3 | Train Loss: 0.364 Vali Loss: 1.164 Vali Acc: 0.550 Test Loss: 1.164 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.9897875785827637
Epoch: 11, Steps: 3 | Train Loss: 0.310 Vali Loss: 1.128 Vali Acc: 0.575 Test Loss: 1.128 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.9326927661895752
Epoch: 12, Steps: 3 | Train Loss: 0.231 Vali Loss: 1.114 Vali Acc: 0.575 Test Loss: 1.114 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 1.0602102279663086
Epoch: 13, Steps: 3 | Train Loss: 0.187 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.9265141487121582
Epoch: 14, Steps: 3 | Train Loss: 0.161 Vali Loss: 1.135 Vali Acc: 0.600 Test Loss: 1.135 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0513758659362793
Epoch: 15, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.154 Vali Acc: 0.625 Test Loss: 1.154 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624988).  Saving model ...
Epoch: 16 cost time: 0.9281847476959229
Epoch: 16, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.169 Vali Acc: 0.625 Test Loss: 1.169 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9093072414398193
Epoch: 17, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.183 Vali Acc: 0.625 Test Loss: 1.183 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9631316661834717
Epoch: 18, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.202 Vali Acc: 0.625 Test Loss: 1.202 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8957149982452393
Epoch: 19, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.213 Vali Acc: 0.650 Test Loss: 1.213 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 20 cost time: 1.0329656600952148
Epoch: 20, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.220 Vali Acc: 0.650 Test Loss: 1.220 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9238286018371582
Epoch: 21, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.225 Vali Acc: 0.675 Test Loss: 1.225 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 22 cost time: 0.9614405632019043
Epoch: 22, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.227 Vali Acc: 0.675 Test Loss: 1.227 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0411932468414307
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.233 Vali Acc: 0.675 Test Loss: 1.233 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0593349933624268
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.235 Vali Acc: 0.675 Test Loss: 1.235 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.02004075050354
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.238 Vali Acc: 0.675 Test Loss: 1.238 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9732990264892578
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.239 Vali Acc: 0.675 Test Loss: 1.239 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9865632057189941
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.242 Vali Acc: 0.675 Test Loss: 1.242 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9199361801147461
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.244 Vali Acc: 0.675 Test Loss: 1.244 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0322253704071045
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.249 Vali Acc: 0.675 Test Loss: 1.249 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0324616432189941
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.249 Vali Acc: 0.675 Test Loss: 1.249 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.962235689163208
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.251 Vali Acc: 0.675 Test Loss: 1.251 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 288452
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6414074897766113
Epoch: 1, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.383 Vali Acc: 0.375 Test Loss: 1.383 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.7010886669158936
Epoch: 2, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.369 Vali Acc: 0.375 Test Loss: 1.369 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.7019681930541992
Epoch: 3, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.347 Vali Acc: 0.525 Test Loss: 1.347 Test Acc: 0.525
Validation loss decreased (-0.374986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 0.7764313220977783
Epoch: 4, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.310 Vali Acc: 0.525 Test Loss: 1.310 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.6917228698730469
Epoch: 5, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.271 Vali Acc: 0.525 Test Loss: 1.271 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.6745030879974365
Epoch: 6, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.229 Vali Acc: 0.575 Test Loss: 1.229 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.8601582050323486
Epoch: 7, Steps: 3 | Train Loss: 0.728 Vali Loss: 1.187 Vali Acc: 0.600 Test Loss: 1.187 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.7393248081207275
Epoch: 8, Steps: 3 | Train Loss: 0.631 Vali Loss: 1.151 Vali Acc: 0.625 Test Loss: 1.151 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 9 cost time: 0.8248035907745361
Epoch: 9, Steps: 3 | Train Loss: 0.569 Vali Loss: 1.126 Vali Acc: 0.625 Test Loss: 1.126 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.6584587097167969
Epoch: 10, Steps: 3 | Train Loss: 0.453 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.6640501022338867
Epoch: 11, Steps: 3 | Train Loss: 0.344 Vali Loss: 1.090 Vali Acc: 0.675 Test Loss: 1.090 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 0.6754913330078125
Epoch: 12, Steps: 3 | Train Loss: 0.298 Vali Loss: 1.084 Vali Acc: 0.675 Test Loss: 1.084 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 0.7468485832214355
Epoch: 13, Steps: 3 | Train Loss: 0.227 Vali Loss: 1.081 Vali Acc: 0.700 Test Loss: 1.081 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 0.6467881202697754
Epoch: 14, Steps: 3 | Train Loss: 0.200 Vali Loss: 1.083 Vali Acc: 0.700 Test Loss: 1.083 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6743383407592773
Epoch: 15, Steps: 3 | Train Loss: 0.159 Vali Loss: 1.084 Vali Acc: 0.650 Test Loss: 1.084 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6666789054870605
Epoch: 16, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.091 Vali Acc: 0.650 Test Loss: 1.091 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6576845645904541
Epoch: 17, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.116 Vali Acc: 0.675 Test Loss: 1.116 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7254292964935303
Epoch: 18, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.139 Vali Acc: 0.675 Test Loss: 1.139 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7393074035644531
Epoch: 19, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.159 Vali Acc: 0.675 Test Loss: 1.159 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7471919059753418
Epoch: 20, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.172 Vali Acc: 0.675 Test Loss: 1.172 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7551774978637695
Epoch: 21, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.184 Vali Acc: 0.675 Test Loss: 1.184 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7597794532775879
Epoch: 22, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.197 Vali Acc: 0.675 Test Loss: 1.197 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6244995594024658
Epoch: 23, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.206 Vali Acc: 0.675 Test Loss: 1.206 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 282948
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.433133840560913
Epoch: 1, Steps: 3 | Train Loss: 1.563 Vali Loss: 1.489 Vali Acc: 0.250 Test Loss: 1.489 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.7013766765594482
Epoch: 2, Steps: 3 | Train Loss: 1.539 Vali Loss: 1.459 Vali Acc: 0.250 Test Loss: 1.459 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.816328763961792
Epoch: 3, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.423 Vali Acc: 0.300 Test Loss: 1.423 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.705186128616333
Epoch: 4, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.379 Vali Acc: 0.375 Test Loss: 1.379 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.6828374862670898
Epoch: 5, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.332 Vali Acc: 0.375 Test Loss: 1.332 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.6821589469909668
Epoch: 6, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.286 Vali Acc: 0.400 Test Loss: 1.286 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.7355256080627441
Epoch: 7, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.246 Vali Acc: 0.400 Test Loss: 1.246 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.6944124698638916
Epoch: 8, Steps: 3 | Train Loss: 0.799 Vali Loss: 1.213 Vali Acc: 0.450 Test Loss: 1.213 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 0.7164061069488525
Epoch: 9, Steps: 3 | Train Loss: 0.687 Vali Loss: 1.187 Vali Acc: 0.550 Test Loss: 1.187 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.6925258636474609
Epoch: 10, Steps: 3 | Train Loss: 0.554 Vali Loss: 1.167 Vali Acc: 0.550 Test Loss: 1.167 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.7378957271575928
Epoch: 11, Steps: 3 | Train Loss: 0.531 Vali Loss: 1.155 Vali Acc: 0.550 Test Loss: 1.155 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.7625422477722168
Epoch: 12, Steps: 3 | Train Loss: 0.427 Vali Loss: 1.137 Vali Acc: 0.550 Test Loss: 1.137 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 13 cost time: 0.7221999168395996
Epoch: 13, Steps: 3 | Train Loss: 0.339 Vali Loss: 1.125 Vali Acc: 0.600 Test Loss: 1.125 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.7007381916046143
Epoch: 14, Steps: 3 | Train Loss: 0.350 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.6572239398956299
Epoch: 15, Steps: 3 | Train Loss: 0.244 Vali Loss: 1.115 Vali Acc: 0.600 Test Loss: 1.115 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6510896682739258
Epoch: 16, Steps: 3 | Train Loss: 0.202 Vali Loss: 1.099 Vali Acc: 0.625 Test Loss: 1.099 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 0.5933413505554199
Epoch: 17, Steps: 3 | Train Loss: 0.142 Vali Loss: 1.091 Vali Acc: 0.650 Test Loss: 1.091 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 0.6443967819213867
Epoch: 18, Steps: 3 | Train Loss: 0.129 Vali Loss: 1.088 Vali Acc: 0.650 Test Loss: 1.088 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 0.5736143589019775
Epoch: 19, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.096 Vali Acc: 0.650 Test Loss: 1.096 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6510851383209229
Epoch: 20, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.106 Vali Acc: 0.675 Test Loss: 1.106 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 21 cost time: 0.578819751739502
Epoch: 21, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.121 Vali Acc: 0.675 Test Loss: 1.121 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6356112957000732
Epoch: 22, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.128 Vali Acc: 0.675 Test Loss: 1.128 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6310346126556396
Epoch: 23, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.130 Vali Acc: 0.675 Test Loss: 1.130 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7102234363555908
Epoch: 24, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.132 Vali Acc: 0.675 Test Loss: 1.132 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.712153434753418
Epoch: 25, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.134 Vali Acc: 0.675 Test Loss: 1.134 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6444704532623291
Epoch: 26, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.138 Vali Acc: 0.675 Test Loss: 1.138 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6146364212036133
Epoch: 27, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.144 Vali Acc: 0.675 Test Loss: 1.144 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.627159833908081
Epoch: 28, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.147 Vali Acc: 0.675 Test Loss: 1.147 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6568920612335205
Epoch: 29, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.148 Vali Acc: 0.675 Test Loss: 1.148 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6715810298919678
Epoch: 30, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.147 Vali Acc: 0.675 Test Loss: 1.147 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm128_nh16_df64_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 274372
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9664697647094727
Epoch: 1, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.448 Vali Acc: 0.300 Test Loss: 1.448 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.0682477951049805
Epoch: 2, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.394 Vali Acc: 0.325 Test Loss: 1.394 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.1779685020446777
Epoch: 3, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.325 Vali Acc: 0.400 Test Loss: 1.325 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.043696403503418
Epoch: 4, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.242 Vali Acc: 0.450 Test Loss: 1.242 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 5 cost time: 1.1956331729888916
Epoch: 5, Steps: 3 | Train Loss: 0.720 Vali Loss: 1.165 Vali Acc: 0.550 Test Loss: 1.165 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 1.1227784156799316
Epoch: 6, Steps: 3 | Train Loss: 0.615 Vali Loss: 1.098 Vali Acc: 0.650 Test Loss: 1.098 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 1.1002440452575684
Epoch: 7, Steps: 3 | Train Loss: 0.500 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.104947805404663
Epoch: 8, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.979 Vali Acc: 0.675 Test Loss: 0.979 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 1.0828948020935059
Epoch: 9, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.977 Vali Acc: 0.675 Test Loss: 0.977 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 10 cost time: 1.0841505527496338
Epoch: 10, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.961 Vali Acc: 0.675 Test Loss: 0.961 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 1.1875097751617432
Epoch: 11, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.925 Vali Acc: 0.675 Test Loss: 0.925 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 12 cost time: 1.0079212188720703
Epoch: 12, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.903 Vali Acc: 0.725 Test Loss: 0.903 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 1.0485167503356934
Epoch: 13, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.902 Vali Acc: 0.750 Test Loss: 0.902 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 1.1517682075500488
Epoch: 14, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.910 Vali Acc: 0.750 Test Loss: 0.910 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9817419052124023
Epoch: 15, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.9402730464935303
Epoch: 16, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.886 Vali Acc: 0.775 Test Loss: 0.886 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 0.9600789546966553
Epoch: 17, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 18 cost time: 1.1008117198944092
Epoch: 18, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.883 Vali Acc: 0.775 Test Loss: 0.883 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1053078174591064
Epoch: 19, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.890 Vali Acc: 0.775 Test Loss: 0.890 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9649744033813477
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.896 Vali Acc: 0.775 Test Loss: 0.896 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0709028244018555
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1371772289276123
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.914 Vali Acc: 0.775 Test Loss: 0.914 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2046928405761719
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.920 Vali Acc: 0.775 Test Loss: 0.920 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9467852115631104
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.924 Vali Acc: 0.775 Test Loss: 0.924 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2043190002441406
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.925 Vali Acc: 0.775 Test Loss: 0.925 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1715521812438965
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.928 Vali Acc: 0.775 Test Loss: 0.928 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0909194946289062
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.775 Test Loss: 0.930 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 227076
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8572590351104736
Epoch: 1, Steps: 3 | Train Loss: 1.520 Vali Loss: 1.379 Vali Acc: 0.250 Test Loss: 1.379 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.9037032127380371
Epoch: 2, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.01888108253479
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.304 Vali Acc: 0.375 Test Loss: 1.304 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.9169237613677979
Epoch: 4, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.8903350830078125
Epoch: 5, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.0424597263336182
Epoch: 6, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.127 Vali Acc: 0.450 Test Loss: 1.127 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449989).  Saving model ...
Epoch: 7 cost time: 0.8585858345031738
Epoch: 7, Steps: 3 | Train Loss: 0.622 Vali Loss: 1.075 Vali Acc: 0.575 Test Loss: 1.075 Test Acc: 0.575
Validation loss decreased (-0.449989 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.9754767417907715
Epoch: 8, Steps: 3 | Train Loss: 0.597 Vali Loss: 1.012 Vali Acc: 0.650 Test Loss: 1.012 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 0.9922776222229004
Epoch: 9, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.973 Vali Acc: 0.650 Test Loss: 0.973 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 1.037522792816162
Epoch: 10, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.929 Vali Acc: 0.675 Test Loss: 0.929 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 11 cost time: 0.8843481540679932
Epoch: 11, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.892 Vali Acc: 0.675 Test Loss: 0.892 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 12 cost time: 0.9792914390563965
Epoch: 12, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.859 Vali Acc: 0.700 Test Loss: 0.859 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 0.8605585098266602
Epoch: 13, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.841 Vali Acc: 0.700 Test Loss: 0.841 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 14 cost time: 1.0440871715545654
Epoch: 14, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.823 Vali Acc: 0.700 Test Loss: 0.823 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 15 cost time: 0.9155480861663818
Epoch: 15, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.824 Vali Acc: 0.775 Test Loss: 0.824 Test Acc: 0.775
Validation loss decreased (-0.699992 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 1.000290870666504
Epoch: 16, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.833 Vali Acc: 0.700 Test Loss: 0.833 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0440914630889893
Epoch: 17, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.841 Vali Acc: 0.725 Test Loss: 0.841 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1028978824615479
Epoch: 18, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.849 Vali Acc: 0.725 Test Loss: 0.849 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0285661220550537
Epoch: 19, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9261810779571533
Epoch: 20, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.841 Vali Acc: 0.775 Test Loss: 0.841 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0916132926940918
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0899834632873535
Epoch: 22, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.833 Vali Acc: 0.775 Test Loss: 0.833 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1077096462249756
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.827 Vali Acc: 0.775 Test Loss: 0.827 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9731197357177734
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.823 Vali Acc: 0.775 Test Loss: 0.823 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 25 cost time: 1.1099929809570312
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.819 Vali Acc: 0.775 Test Loss: 0.819 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 26 cost time: 1.1226611137390137
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.818 Vali Acc: 0.775 Test Loss: 0.818 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 27 cost time: 0.9798059463500977
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.819 Vali Acc: 0.775 Test Loss: 0.819 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9174802303314209
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.818 Vali Acc: 0.775 Test Loss: 0.818 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0585131645202637
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.820 Vali Acc: 0.775 Test Loss: 0.820 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0574841499328613
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.821 Vali Acc: 0.775 Test Loss: 0.821 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9750323295593262
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.826 Vali Acc: 0.775 Test Loss: 0.826 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2063934803009033
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.829 Vali Acc: 0.775 Test Loss: 0.829 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1908588409423828
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.832 Vali Acc: 0.775 Test Loss: 0.832 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0661015510559082
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2087218761444092
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.837 Vali Acc: 0.775 Test Loss: 0.837 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8788602352142334
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 201092
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.704164743423462
Epoch: 1, Steps: 3 | Train Loss: 1.585 Vali Loss: 1.477 Vali Acc: 0.200 Test Loss: 1.477 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.9854419231414795
Epoch: 2, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.439 Vali Acc: 0.200 Test Loss: 1.439 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.9962711334228516
Epoch: 3, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.394 Vali Acc: 0.275 Test Loss: 1.394 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.9893231391906738
Epoch: 4, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
Validation loss decreased (-0.274986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 1.1157660484313965
Epoch: 5, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.304 Vali Acc: 0.475 Test Loss: 1.304 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.990105390548706
Epoch: 6, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.248 Vali Acc: 0.525 Test Loss: 1.248 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.1164655685424805
Epoch: 7, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.193 Vali Acc: 0.525 Test Loss: 1.193 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.8657028675079346
Epoch: 8, Steps: 3 | Train Loss: 0.752 Vali Loss: 1.129 Vali Acc: 0.575 Test Loss: 1.129 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.9697563648223877
Epoch: 9, Steps: 3 | Train Loss: 0.622 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.8984887599945068
Epoch: 10, Steps: 3 | Train Loss: 0.514 Vali Loss: 1.042 Vali Acc: 0.625 Test Loss: 1.042 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.9152567386627197
Epoch: 11, Steps: 3 | Train Loss: 0.355 Vali Loss: 1.017 Vali Acc: 0.675 Test Loss: 1.017 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 1.0040903091430664
Epoch: 12, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.997 Vali Acc: 0.675 Test Loss: 0.997 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 0.833186149597168
Epoch: 13, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.978 Vali Acc: 0.700 Test Loss: 0.978 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 0.9383606910705566
Epoch: 14, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.950 Vali Acc: 0.700 Test Loss: 0.950 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.9720957279205322
Epoch: 15, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.945 Vali Acc: 0.750 Test Loss: 0.945 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.9548213481903076
Epoch: 16, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0311357975006104
Epoch: 17, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.955 Vali Acc: 0.725 Test Loss: 0.955 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0216853618621826
Epoch: 18, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.963 Vali Acc: 0.725 Test Loss: 0.963 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.000664472579956
Epoch: 19, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.969 Vali Acc: 0.725 Test Loss: 0.969 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1068778038024902
Epoch: 20, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.971 Vali Acc: 0.725 Test Loss: 0.971 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0101025104522705
Epoch: 21, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.975 Vali Acc: 0.725 Test Loss: 0.975 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0318984985351562
Epoch: 22, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.982 Vali Acc: 0.725 Test Loss: 0.982 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9961402416229248
Epoch: 23, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.984 Vali Acc: 0.750 Test Loss: 0.984 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9980380535125732
Epoch: 24, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.981 Vali Acc: 0.750 Test Loss: 0.981 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9592745304107666
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.978 Vali Acc: 0.750 Test Loss: 0.978 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 188996
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.588881492614746
Epoch: 1, Steps: 3 | Train Loss: 1.698 Vali Loss: 1.444 Vali Acc: 0.225 Test Loss: 1.444 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.701815128326416
Epoch: 2, Steps: 3 | Train Loss: 1.492 Vali Loss: 1.421 Vali Acc: 0.225 Test Loss: 1.421 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.7595779895782471
Epoch: 3, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.384 Vali Acc: 0.300 Test Loss: 1.384 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.7576181888580322
Epoch: 4, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.335 Vali Acc: 0.425 Test Loss: 1.335 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.7290360927581787
Epoch: 5, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.288 Vali Acc: 0.450 Test Loss: 1.288 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.6970443725585938
Epoch: 6, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.7890708446502686
Epoch: 7, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.197 Vali Acc: 0.550 Test Loss: 1.197 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.7825958728790283
Epoch: 8, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.155 Vali Acc: 0.600 Test Loss: 1.155 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.6828234195709229
Epoch: 9, Steps: 3 | Train Loss: 0.706 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.8294427394866943
Epoch: 10, Steps: 3 | Train Loss: 0.571 Vali Loss: 1.094 Vali Acc: 0.650 Test Loss: 1.094 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 0.7627356052398682
Epoch: 11, Steps: 3 | Train Loss: 0.509 Vali Loss: 1.074 Vali Acc: 0.650 Test Loss: 1.074 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.6747574806213379
Epoch: 12, Steps: 3 | Train Loss: 0.388 Vali Loss: 1.043 Vali Acc: 0.650 Test Loss: 1.043 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 0.8450796604156494
Epoch: 13, Steps: 3 | Train Loss: 0.350 Vali Loss: 1.014 Vali Acc: 0.650 Test Loss: 1.014 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 0.6644723415374756
Epoch: 14, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.990 Vali Acc: 0.650 Test Loss: 0.990 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.7189357280731201
Epoch: 15, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.972 Vali Acc: 0.650 Test Loss: 0.972 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 0.7051723003387451
Epoch: 16, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.955 Vali Acc: 0.675 Test Loss: 0.955 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 0.7847728729248047
Epoch: 17, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.955 Vali Acc: 0.675 Test Loss: 0.955 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 0.7229671478271484
Epoch: 18, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.974 Vali Acc: 0.675 Test Loss: 0.974 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.677332878112793
Epoch: 19, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.987 Vali Acc: 0.700 Test Loss: 0.987 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.7797553539276123
Epoch: 20, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.012 Vali Acc: 0.725 Test Loss: 1.012 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 21 cost time: 0.7622132301330566
Epoch: 21, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.028 Vali Acc: 0.725 Test Loss: 1.028 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.674156665802002
Epoch: 22, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.024 Vali Acc: 0.725 Test Loss: 1.024 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7277951240539551
Epoch: 23, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.026 Vali Acc: 0.725 Test Loss: 1.026 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7274572849273682
Epoch: 24, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.029 Vali Acc: 0.700 Test Loss: 1.029 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.609929084777832
Epoch: 25, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.031 Vali Acc: 0.700 Test Loss: 1.031 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6476941108703613
Epoch: 26, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6157739162445068
Epoch: 27, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6917340755462646
Epoch: 28, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.042 Vali Acc: 0.700 Test Loss: 1.042 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7202012538909912
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.043 Vali Acc: 0.700 Test Loss: 1.043 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6432576179504395
Epoch: 30, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.046 Vali Acc: 0.700 Test Loss: 1.046 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 181444
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3837363719940186
Epoch: 1, Steps: 3 | Train Loss: 1.664 Vali Loss: 1.499 Vali Acc: 0.275 Test Loss: 1.499 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.7010059356689453
Epoch: 2, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.474 Vali Acc: 0.300 Test Loss: 1.474 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.7238016128540039
Epoch: 3, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.447 Vali Acc: 0.275 Test Loss: 1.447 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7485921382904053
Epoch: 4, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.414 Vali Acc: 0.300 Test Loss: 1.414 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.6756587028503418
Epoch: 5, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.377 Vali Acc: 0.375 Test Loss: 1.377 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.6668524742126465
Epoch: 6, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.341 Vali Acc: 0.375 Test Loss: 1.341 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.6922519207000732
Epoch: 7, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.309 Vali Acc: 0.400 Test Loss: 1.309 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.7384560108184814
Epoch: 8, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.286 Vali Acc: 0.425 Test Loss: 1.286 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.6564984321594238
Epoch: 9, Steps: 3 | Train Loss: 0.849 Vali Loss: 1.262 Vali Acc: 0.425 Test Loss: 1.262 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.6685748100280762
Epoch: 10, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.231 Vali Acc: 0.425 Test Loss: 1.231 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 11 cost time: 0.7050249576568604
Epoch: 11, Steps: 3 | Train Loss: 0.720 Vali Loss: 1.201 Vali Acc: 0.425 Test Loss: 1.201 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 12 cost time: 0.6725437641143799
Epoch: 12, Steps: 3 | Train Loss: 0.540 Vali Loss: 1.179 Vali Acc: 0.425 Test Loss: 1.179 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 13 cost time: 0.7050223350524902
Epoch: 13, Steps: 3 | Train Loss: 0.551 Vali Loss: 1.164 Vali Acc: 0.475 Test Loss: 1.164 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 0.6919991970062256
Epoch: 14, Steps: 3 | Train Loss: 0.418 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 0.7091867923736572
Epoch: 15, Steps: 3 | Train Loss: 0.441 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 16 cost time: 0.7240023612976074
Epoch: 16, Steps: 3 | Train Loss: 0.325 Vali Loss: 1.110 Vali Acc: 0.550 Test Loss: 1.110 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 0.6732068061828613
Epoch: 17, Steps: 3 | Train Loss: 0.284 Vali Loss: 1.085 Vali Acc: 0.550 Test Loss: 1.085 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 18 cost time: 0.6938750743865967
Epoch: 18, Steps: 3 | Train Loss: 0.226 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.6790599822998047
Epoch: 19, Steps: 3 | Train Loss: 0.203 Vali Loss: 1.056 Vali Acc: 0.650 Test Loss: 1.056 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.7298128604888916
Epoch: 20, Steps: 3 | Train Loss: 0.158 Vali Loss: 1.042 Vali Acc: 0.675 Test Loss: 1.042 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 21 cost time: 0.6829438209533691
Epoch: 21, Steps: 3 | Train Loss: 0.108 Vali Loss: 1.032 Vali Acc: 0.700 Test Loss: 1.032 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 22 cost time: 0.630699872970581
Epoch: 22, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.026 Vali Acc: 0.700 Test Loss: 1.026 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 0.6947469711303711
Epoch: 23, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.019 Vali Acc: 0.700 Test Loss: 1.019 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 24 cost time: 0.6757984161376953
Epoch: 24, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 25 cost time: 0.6232612133026123
Epoch: 25, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 26 cost time: 0.7533111572265625
Epoch: 26, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.016 Vali Acc: 0.700 Test Loss: 1.016 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7581241130828857
Epoch: 27, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.024 Vali Acc: 0.700 Test Loss: 1.024 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6878097057342529
Epoch: 28, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6655561923980713
Epoch: 29, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.029 Vali Acc: 0.700 Test Loss: 1.029 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.681990385055542
Epoch: 30, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7008011341094971
Epoch: 31, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.035 Vali Acc: 0.700 Test Loss: 1.035 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6139810085296631
Epoch: 32, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.732569694519043
Epoch: 33, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6939303874969482
Epoch: 34, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6563351154327393
Epoch: 35, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.030 Vali Acc: 0.700 Test Loss: 1.030 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 169476
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4067468643188477
Epoch: 1, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.436 Vali Acc: 0.275 Test Loss: 1.436 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.7108004093170166
Epoch: 2, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.411 Vali Acc: 0.275 Test Loss: 1.411 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.7153716087341309
Epoch: 3, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.383 Vali Acc: 0.300 Test Loss: 1.383 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.6485607624053955
Epoch: 4, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.354 Vali Acc: 0.325 Test Loss: 1.354 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.7916121482849121
Epoch: 5, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.322 Vali Acc: 0.325 Test Loss: 1.322 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.7095413208007812
Epoch: 6, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.291 Vali Acc: 0.325 Test Loss: 1.291 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 7 cost time: 0.7443385124206543
Epoch: 7, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.262 Vali Acc: 0.400 Test Loss: 1.262 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.7025318145751953
Epoch: 8, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.234 Vali Acc: 0.475 Test Loss: 1.234 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.7543048858642578
Epoch: 9, Steps: 3 | Train Loss: 0.868 Vali Loss: 1.204 Vali Acc: 0.475 Test Loss: 1.204 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 0.7327046394348145
Epoch: 10, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.180 Vali Acc: 0.475 Test Loss: 1.180 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.7056214809417725
Epoch: 11, Steps: 3 | Train Loss: 0.640 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.7948682308197021
Epoch: 12, Steps: 3 | Train Loss: 0.635 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 0.7289154529571533
Epoch: 13, Steps: 3 | Train Loss: 0.568 Vali Loss: 1.124 Vali Acc: 0.550 Test Loss: 1.124 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549989).  Saving model ...
Epoch: 14 cost time: 0.7487471103668213
Epoch: 14, Steps: 3 | Train Loss: 0.481 Vali Loss: 1.110 Vali Acc: 0.575 Test Loss: 1.110 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 15 cost time: 0.6599612236022949
Epoch: 15, Steps: 3 | Train Loss: 0.405 Vali Loss: 1.097 Vali Acc: 0.575 Test Loss: 1.097 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 16 cost time: 0.6855294704437256
Epoch: 16, Steps: 3 | Train Loss: 0.333 Vali Loss: 1.084 Vali Acc: 0.575 Test Loss: 1.084 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 17 cost time: 0.6639704704284668
Epoch: 17, Steps: 3 | Train Loss: 0.343 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.6657230854034424
Epoch: 18, Steps: 3 | Train Loss: 0.303 Vali Loss: 1.064 Vali Acc: 0.625 Test Loss: 1.064 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.6799290180206299
Epoch: 19, Steps: 3 | Train Loss: 0.218 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6095151901245117
Epoch: 20, Steps: 3 | Train Loss: 0.182 Vali Loss: 1.054 Vali Acc: 0.625 Test Loss: 1.054 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 0.6129617691040039
Epoch: 21, Steps: 3 | Train Loss: 0.193 Vali Loss: 1.057 Vali Acc: 0.650 Test Loss: 1.057 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 22 cost time: 0.6685817241668701
Epoch: 22, Steps: 3 | Train Loss: 0.149 Vali Loss: 1.062 Vali Acc: 0.650 Test Loss: 1.062 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7744970321655273
Epoch: 23, Steps: 3 | Train Loss: 0.101 Vali Loss: 1.058 Vali Acc: 0.650 Test Loss: 1.058 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6293179988861084
Epoch: 24, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.061 Vali Acc: 0.650 Test Loss: 1.061 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.760427713394165
Epoch: 25, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.070 Vali Acc: 0.650 Test Loss: 1.070 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6709725856781006
Epoch: 26, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.072 Vali Acc: 0.650 Test Loss: 1.072 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6951665878295898
Epoch: 27, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.073 Vali Acc: 0.675 Test Loss: 1.073 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 28 cost time: 0.7414345741271973
Epoch: 28, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.071 Vali Acc: 0.675 Test Loss: 1.071 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 29 cost time: 0.6872625350952148
Epoch: 29, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.070 Vali Acc: 0.700 Test Loss: 1.070 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 30 cost time: 0.786360502243042
Epoch: 30, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.069 Vali Acc: 0.700 Test Loss: 1.069 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 31 cost time: 0.7190942764282227
Epoch: 31, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.070 Vali Acc: 0.700 Test Loss: 1.070 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7240104675292969
Epoch: 32, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.070 Vali Acc: 0.700 Test Loss: 1.070 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7331111431121826
Epoch: 33, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.071 Vali Acc: 0.700 Test Loss: 1.071 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.722592830657959
Epoch: 34, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.068 Vali Acc: 0.700 Test Loss: 1.068 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 35 cost time: 0.82489013671875
Epoch: 35, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.071 Vali Acc: 0.700 Test Loss: 1.071 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8809511661529541
Epoch: 36, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.074 Vali Acc: 0.700 Test Loss: 1.074 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8160762786865234
Epoch: 37, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.073 Vali Acc: 0.700 Test Loss: 1.073 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7586500644683838
Epoch: 38, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.075 Vali Acc: 0.700 Test Loss: 1.075 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7346229553222656
Epoch: 39, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.077 Vali Acc: 0.700 Test Loss: 1.077 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7739372253417969
Epoch: 40, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.081 Vali Acc: 0.700 Test Loss: 1.081 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7229280471801758
Epoch: 41, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.087 Vali Acc: 0.700 Test Loss: 1.087 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7742471694946289
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.088 Vali Acc: 0.700 Test Loss: 1.088 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7884209156036377
Epoch: 43, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.088 Vali Acc: 0.700 Test Loss: 1.088 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7503530979156494
Epoch: 44, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.088 Vali Acc: 0.700 Test Loss: 1.088 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 166724
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3207013607025146
Epoch: 1, Steps: 3 | Train Loss: 1.560 Vali Loss: 1.430 Vali Acc: 0.325 Test Loss: 1.430 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.7606461048126221
Epoch: 2, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.402 Vali Acc: 0.300 Test Loss: 1.402 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8101980686187744
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.377 Vali Acc: 0.275 Test Loss: 1.377 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6285035610198975
Epoch: 4, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.350 Vali Acc: 0.250 Test Loss: 1.350 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6762197017669678
Epoch: 5, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.323 Vali Acc: 0.300 Test Loss: 1.323 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6907920837402344
Epoch: 6, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.294 Vali Acc: 0.400 Test Loss: 1.294 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.648792028427124
Epoch: 7, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.269 Vali Acc: 0.375 Test Loss: 1.269 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6441752910614014
Epoch: 8, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.7158348560333252
Epoch: 9, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.229 Vali Acc: 0.425 Test Loss: 1.229 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 10 cost time: 0.7975311279296875
Epoch: 10, Steps: 3 | Train Loss: 0.809 Vali Loss: 1.210 Vali Acc: 0.450 Test Loss: 1.210 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 11 cost time: 0.652390718460083
Epoch: 11, Steps: 3 | Train Loss: 0.856 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.7349474430084229
Epoch: 12, Steps: 3 | Train Loss: 0.748 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 0.6735949516296387
Epoch: 13, Steps: 3 | Train Loss: 0.634 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.8028967380523682
Epoch: 14, Steps: 3 | Train Loss: 0.578 Vali Loss: 1.158 Vali Acc: 0.525 Test Loss: 1.158 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 0.8039059638977051
Epoch: 15, Steps: 3 | Train Loss: 0.489 Vali Loss: 1.148 Vali Acc: 0.525 Test Loss: 1.148 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 16 cost time: 0.6378438472747803
Epoch: 16, Steps: 3 | Train Loss: 0.463 Vali Loss: 1.142 Vali Acc: 0.525 Test Loss: 1.142 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 17 cost time: 0.757009744644165
Epoch: 17, Steps: 3 | Train Loss: 0.419 Vali Loss: 1.132 Vali Acc: 0.525 Test Loss: 1.132 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 18 cost time: 0.7929019927978516
Epoch: 18, Steps: 3 | Train Loss: 0.362 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7643029689788818
Epoch: 19, Steps: 3 | Train Loss: 0.326 Vali Loss: 1.117 Vali Acc: 0.525 Test Loss: 1.117 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 20 cost time: 0.7023684978485107
Epoch: 20, Steps: 3 | Train Loss: 0.284 Vali Loss: 1.112 Vali Acc: 0.525 Test Loss: 1.112 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 21 cost time: 0.7381060123443604
Epoch: 21, Steps: 3 | Train Loss: 0.240 Vali Loss: 1.102 Vali Acc: 0.600 Test Loss: 1.102 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.7031033039093018
Epoch: 22, Steps: 3 | Train Loss: 0.245 Vali Loss: 1.097 Vali Acc: 0.600 Test Loss: 1.097 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.7650911808013916
Epoch: 23, Steps: 3 | Train Loss: 0.161 Vali Loss: 1.093 Vali Acc: 0.650 Test Loss: 1.093 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.7636611461639404
Epoch: 24, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.093 Vali Acc: 0.650 Test Loss: 1.093 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7882084846496582
Epoch: 25, Steps: 3 | Train Loss: 0.153 Vali Loss: 1.097 Vali Acc: 0.675 Test Loss: 1.097 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.7766273021697998
Epoch: 26, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.101 Vali Acc: 0.675 Test Loss: 1.101 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7820949554443359
Epoch: 27, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.102 Vali Acc: 0.675 Test Loss: 1.102 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7055737972259521
Epoch: 28, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7213034629821777
Epoch: 29, Steps: 3 | Train Loss: 0.082 Vali Loss: 1.107 Vali Acc: 0.675 Test Loss: 1.107 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6831011772155762
Epoch: 30, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.108 Vali Acc: 0.675 Test Loss: 1.108 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.751929521560669
Epoch: 31, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.107 Vali Acc: 0.675 Test Loss: 1.107 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7731583118438721
Epoch: 32, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.108 Vali Acc: 0.675 Test Loss: 1.108 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.749096155166626
Epoch: 33, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.106 Vali Acc: 0.675 Test Loss: 1.106 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7214243412017822
Epoch: 34, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.102 Vali Acc: 0.675 Test Loss: 1.102 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7028779983520508
Epoch: 35, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.097 Vali Acc: 0.700 Test Loss: 1.097 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 36 cost time: 0.6815016269683838
Epoch: 36, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.093 Vali Acc: 0.700 Test Loss: 1.093 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 37 cost time: 0.7984728813171387
Epoch: 37, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.090 Vali Acc: 0.700 Test Loss: 1.090 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 38 cost time: 0.720611572265625
Epoch: 38, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.088 Vali Acc: 0.700 Test Loss: 1.088 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 39 cost time: 0.6128683090209961
Epoch: 39, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.086 Vali Acc: 0.675 Test Loss: 1.086 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.580664873123169
Epoch: 40, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.088 Vali Acc: 0.675 Test Loss: 1.088 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6740262508392334
Epoch: 41, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.089 Vali Acc: 0.675 Test Loss: 1.089 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6318502426147461
Epoch: 42, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6951837539672852
Epoch: 43, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.086 Vali Acc: 0.675 Test Loss: 1.086 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6651279926300049
Epoch: 44, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.086 Vali Acc: 0.675 Test Loss: 1.086 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7230732440948486
Epoch: 45, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.082 Vali Acc: 0.675 Test Loss: 1.082 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6574537754058838
Epoch: 46, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.079 Vali Acc: 0.675 Test Loss: 1.079 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6125137805938721
Epoch: 47, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.080 Vali Acc: 0.675 Test Loss: 1.080 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.63468337059021
Epoch: 48, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.080 Vali Acc: 0.675 Test Loss: 1.080 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df256_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 162436
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6417174339294434
Epoch: 1, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.482 Vali Acc: 0.325 Test Loss: 1.482 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 1.0723168849945068
Epoch: 2, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.399 Vali Acc: 0.275 Test Loss: 1.399 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9751288890838623
Epoch: 3, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.307 Vali Acc: 0.375 Test Loss: 1.307 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.034071922302246
Epoch: 4, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.216 Vali Acc: 0.375 Test Loss: 1.216 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 0.9491417407989502
Epoch: 5, Steps: 3 | Train Loss: 0.809 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.374988 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.06355619430542
Epoch: 6, Steps: 3 | Train Loss: 0.686 Vali Loss: 1.051 Vali Acc: 0.525 Test Loss: 1.051 Test Acc: 0.525
Validation loss decreased (-0.399989 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 1.1686046123504639
Epoch: 7, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.993 Vali Acc: 0.675 Test Loss: 0.993 Test Acc: 0.675
Validation loss decreased (-0.524989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 1.1496741771697998
Epoch: 8, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.963 Vali Acc: 0.675 Test Loss: 0.963 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 1.123828649520874
Epoch: 9, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.929 Vali Acc: 0.700 Test Loss: 0.929 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 1.0795977115631104
Epoch: 10, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.900 Vali Acc: 0.675 Test Loss: 0.900 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1642673015594482
Epoch: 11, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 1.103724718093872
Epoch: 12, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 1.1177780628204346
Epoch: 13, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.801 Vali Acc: 0.775 Test Loss: 0.801 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.143784999847412
Epoch: 14, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.843 Vali Acc: 0.775 Test Loss: 0.843 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1204345226287842
Epoch: 15, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.875 Vali Acc: 0.750 Test Loss: 0.875 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0489296913146973
Epoch: 16, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.893 Vali Acc: 0.725 Test Loss: 0.893 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1041457653045654
Epoch: 17, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.885 Vali Acc: 0.750 Test Loss: 0.885 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.120020866394043
Epoch: 18, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.866 Vali Acc: 0.750 Test Loss: 0.866 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0721657276153564
Epoch: 19, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.844 Vali Acc: 0.825 Test Loss: 0.844 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 20 cost time: 1.0496952533721924
Epoch: 20, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 21 cost time: 1.0489842891693115
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.821 Vali Acc: 0.825 Test Loss: 0.821 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 22 cost time: 0.9925186634063721
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.818 Vali Acc: 0.825 Test Loss: 0.818 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 1.0824944972991943
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.819 Vali Acc: 0.825 Test Loss: 0.819 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0633888244628906
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.821 Vali Acc: 0.825 Test Loss: 0.821 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0037429332733154
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.825 Vali Acc: 0.825 Test Loss: 0.825 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.082972526550293
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.830 Vali Acc: 0.825 Test Loss: 0.830 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9345834255218506
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.825 Test Loss: 0.835 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1874756813049316
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.841 Vali Acc: 0.825 Test Loss: 0.841 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9734108448028564
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.825 Test Loss: 0.846 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0498065948486328
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.825 Test Loss: 0.851 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1370198726654053
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.855 Vali Acc: 0.825 Test Loss: 0.855 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.096386194229126
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.825 Test Loss: 0.859 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 177540
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6933929920196533
Epoch: 1, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.472 Vali Acc: 0.250 Test Loss: 1.472 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.8152050971984863
Epoch: 2, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.446 Vali Acc: 0.275 Test Loss: 1.446 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.9840755462646484
Epoch: 3, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.404 Vali Acc: 0.375 Test Loss: 1.404 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.964362382888794
Epoch: 4, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 1.0118775367736816
Epoch: 5, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.8964667320251465
Epoch: 6, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.230 Vali Acc: 0.525 Test Loss: 1.230 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.921351432800293
Epoch: 7, Steps: 3 | Train Loss: 0.633 Vali Loss: 1.145 Vali Acc: 0.600 Test Loss: 1.145 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.985680103302002
Epoch: 8, Steps: 3 | Train Loss: 0.517 Vali Loss: 1.076 Vali Acc: 0.625 Test Loss: 1.076 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.007380723953247
Epoch: 9, Steps: 3 | Train Loss: 0.447 Vali Loss: 1.049 Vali Acc: 0.625 Test Loss: 1.049 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.9434170722961426
Epoch: 10, Steps: 3 | Train Loss: 0.319 Vali Loss: 1.047 Vali Acc: 0.575 Test Loss: 1.047 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9467623233795166
Epoch: 11, Steps: 3 | Train Loss: 0.284 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9300601482391357
Epoch: 12, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.989 Vali Acc: 0.625 Test Loss: 0.989 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 13 cost time: 0.9272072315216064
Epoch: 13, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.957 Vali Acc: 0.650 Test Loss: 0.957 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 0.9316999912261963
Epoch: 14, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.957 Vali Acc: 0.725 Test Loss: 0.957 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724990).  Saving model ...
Epoch: 15 cost time: 0.9184973239898682
Epoch: 15, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.974 Vali Acc: 0.725 Test Loss: 0.974 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0318183898925781
Epoch: 16, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.988 Vali Acc: 0.700 Test Loss: 0.988 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.981067419052124
Epoch: 17, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.999 Vali Acc: 0.700 Test Loss: 0.999 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0032649040222168
Epoch: 18, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9118523597717285
Epoch: 19, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.991 Vali Acc: 0.700 Test Loss: 0.991 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9384791851043701
Epoch: 20, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.983 Vali Acc: 0.700 Test Loss: 0.983 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9268844127655029
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.977 Vali Acc: 0.700 Test Loss: 0.977 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0715720653533936
Epoch: 22, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.972 Vali Acc: 0.700 Test Loss: 0.972 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.986353874206543
Epoch: 23, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.968 Vali Acc: 0.700 Test Loss: 0.968 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.978848934173584
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.968 Vali Acc: 0.700 Test Loss: 0.968 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 151556
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5240182876586914
Epoch: 1, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.488 Vali Acc: 0.375 Test Loss: 1.488 Test Acc: 0.375
Validation loss decreased (inf --> -0.374985).  Saving model ...
Epoch: 2 cost time: 0.9408535957336426
Epoch: 2, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.463 Vali Acc: 0.375 Test Loss: 1.463 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 3 cost time: 1.0338339805603027
Epoch: 3, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.423 Vali Acc: 0.400 Test Loss: 1.423 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.9831254482269287
Epoch: 4, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.376 Vali Acc: 0.450 Test Loss: 1.376 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 5 cost time: 0.9239950180053711
Epoch: 5, Steps: 3 | Train Loss: 0.868 Vali Loss: 1.320 Vali Acc: 0.500 Test Loss: 1.320 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.9769084453582764
Epoch: 6, Steps: 3 | Train Loss: 0.809 Vali Loss: 1.270 Vali Acc: 0.525 Test Loss: 1.270 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.9373769760131836
Epoch: 7, Steps: 3 | Train Loss: 0.718 Vali Loss: 1.230 Vali Acc: 0.550 Test Loss: 1.230 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.9982199668884277
Epoch: 8, Steps: 3 | Train Loss: 0.620 Vali Loss: 1.219 Vali Acc: 0.600 Test Loss: 1.219 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.8269445896148682
Epoch: 9, Steps: 3 | Train Loss: 0.465 Vali Loss: 1.223 Vali Acc: 0.575 Test Loss: 1.223 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.022949457168579
Epoch: 10, Steps: 3 | Train Loss: 0.373 Vali Loss: 1.226 Vali Acc: 0.575 Test Loss: 1.226 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9181919097900391
Epoch: 11, Steps: 3 | Train Loss: 0.384 Vali Loss: 1.198 Vali Acc: 0.600 Test Loss: 1.198 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 0.8692286014556885
Epoch: 12, Steps: 3 | Train Loss: 0.228 Vali Loss: 1.159 Vali Acc: 0.625 Test Loss: 1.159 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 13 cost time: 0.8812606334686279
Epoch: 13, Steps: 3 | Train Loss: 0.208 Vali Loss: 1.135 Vali Acc: 0.650 Test Loss: 1.135 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 1.004565954208374
Epoch: 14, Steps: 3 | Train Loss: 0.144 Vali Loss: 1.118 Vali Acc: 0.650 Test Loss: 1.118 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 0.9357562065124512
Epoch: 15, Steps: 3 | Train Loss: 0.111 Vali Loss: 1.113 Vali Acc: 0.675 Test Loss: 1.113 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 0.9663500785827637
Epoch: 16, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.122 Vali Acc: 0.675 Test Loss: 1.122 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9266400337219238
Epoch: 17, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.130 Vali Acc: 0.650 Test Loss: 1.130 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9876935482025146
Epoch: 18, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.137 Vali Acc: 0.650 Test Loss: 1.137 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9662637710571289
Epoch: 19, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.145 Vali Acc: 0.650 Test Loss: 1.145 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8650915622711182
Epoch: 20, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.153 Vali Acc: 0.650 Test Loss: 1.153 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9827823638916016
Epoch: 21, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.165 Vali Acc: 0.650 Test Loss: 1.165 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9517223834991455
Epoch: 22, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.180 Vali Acc: 0.675 Test Loss: 1.180 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9586446285247803
Epoch: 23, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.196 Vali Acc: 0.650 Test Loss: 1.196 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9118366241455078
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.206 Vali Acc: 0.650 Test Loss: 1.206 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9681198596954346
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.211 Vali Acc: 0.650 Test Loss: 1.211 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 139460
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.295729875564575
Epoch: 1, Steps: 3 | Train Loss: 1.577 Vali Loss: 1.421 Vali Acc: 0.250 Test Loss: 1.421 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.6761641502380371
Epoch: 2, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.389 Vali Acc: 0.225 Test Loss: 1.389 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6872942447662354
Epoch: 3, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.350 Vali Acc: 0.225 Test Loss: 1.350 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.673454999923706
Epoch: 4, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.299 Vali Acc: 0.250 Test Loss: 1.299 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249987).  Saving model ...
Epoch: 5 cost time: 0.7278380393981934
Epoch: 5, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.249 Vali Acc: 0.375 Test Loss: 1.249 Test Acc: 0.375
Validation loss decreased (-0.249987 --> -0.374988).  Saving model ...
Epoch: 6 cost time: 0.6136984825134277
Epoch: 6, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.197 Vali Acc: 0.475 Test Loss: 1.197 Test Acc: 0.475
Validation loss decreased (-0.374988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.633103609085083
Epoch: 7, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.147 Vali Acc: 0.550 Test Loss: 1.147 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.6977858543395996
Epoch: 8, Steps: 3 | Train Loss: 0.718 Vali Loss: 1.109 Vali Acc: 0.625 Test Loss: 1.109 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.5597889423370361
Epoch: 9, Steps: 3 | Train Loss: 0.636 Vali Loss: 1.071 Vali Acc: 0.675 Test Loss: 1.071 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 0.7051653861999512
Epoch: 10, Steps: 3 | Train Loss: 0.532 Vali Loss: 1.040 Vali Acc: 0.650 Test Loss: 1.040 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6256089210510254
Epoch: 11, Steps: 3 | Train Loss: 0.421 Vali Loss: 1.000 Vali Acc: 0.725 Test Loss: 1.000 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.6481988430023193
Epoch: 12, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.974 Vali Acc: 0.725 Test Loss: 0.974 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 0.60585618019104
Epoch: 13, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 0.6443967819213867
Epoch: 14, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.6547801494598389
Epoch: 15, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.937 Vali Acc: 0.725 Test Loss: 0.937 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6277987957000732
Epoch: 16, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.942 Vali Acc: 0.675 Test Loss: 0.942 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6349003314971924
Epoch: 17, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.954 Vali Acc: 0.725 Test Loss: 0.954 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6739711761474609
Epoch: 18, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.973 Vali Acc: 0.725 Test Loss: 0.973 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6405401229858398
Epoch: 19, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.989 Vali Acc: 0.725 Test Loss: 0.989 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6366088390350342
Epoch: 20, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.981 Vali Acc: 0.725 Test Loss: 0.981 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6021323204040527
Epoch: 21, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.969 Vali Acc: 0.725 Test Loss: 0.969 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6198389530181885
Epoch: 22, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.961 Vali Acc: 0.725 Test Loss: 0.961 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7632179260253906
Epoch: 23, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.957 Vali Acc: 0.725 Test Loss: 0.957 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6971244812011719
Epoch: 24, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.956 Vali Acc: 0.725 Test Loss: 0.956 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 131908
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5153255462646484
Epoch: 1, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.398 Vali Acc: 0.300 Test Loss: 1.398 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6730103492736816
Epoch: 2, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.382 Vali Acc: 0.275 Test Loss: 1.382 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6356127262115479
Epoch: 3, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.360 Vali Acc: 0.350 Test Loss: 1.360 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.7407748699188232
Epoch: 4, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.333 Vali Acc: 0.400 Test Loss: 1.333 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.7095224857330322
Epoch: 5, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.302 Vali Acc: 0.400 Test Loss: 1.302 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.6241147518157959
Epoch: 6, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.273 Vali Acc: 0.450 Test Loss: 1.273 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.647416353225708
Epoch: 7, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.247 Vali Acc: 0.450 Test Loss: 1.247 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.6767113208770752
Epoch: 8, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.224 Vali Acc: 0.475 Test Loss: 1.224 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.6368563175201416
Epoch: 9, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.200 Vali Acc: 0.525 Test Loss: 1.200 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 0.6852364540100098
Epoch: 10, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.183 Vali Acc: 0.575 Test Loss: 1.183 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 0.6421294212341309
Epoch: 11, Steps: 3 | Train Loss: 0.717 Vali Loss: 1.166 Vali Acc: 0.600 Test Loss: 1.166 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 0.7166121006011963
Epoch: 12, Steps: 3 | Train Loss: 0.631 Vali Loss: 1.147 Vali Acc: 0.600 Test Loss: 1.147 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.6358978748321533
Epoch: 13, Steps: 3 | Train Loss: 0.519 Vali Loss: 1.132 Vali Acc: 0.600 Test Loss: 1.132 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.677236795425415
Epoch: 14, Steps: 3 | Train Loss: 0.500 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.6637189388275146
Epoch: 15, Steps: 3 | Train Loss: 0.413 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.6851520538330078
Epoch: 16, Steps: 3 | Train Loss: 0.333 Vali Loss: 1.100 Vali Acc: 0.625 Test Loss: 1.100 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 0.691408634185791
Epoch: 17, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.083 Vali Acc: 0.625 Test Loss: 1.083 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.6645224094390869
Epoch: 18, Steps: 3 | Train Loss: 0.242 Vali Loss: 1.074 Vali Acc: 0.625 Test Loss: 1.074 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.6413815021514893
Epoch: 19, Steps: 3 | Train Loss: 0.174 Vali Loss: 1.060 Vali Acc: 0.650 Test Loss: 1.060 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.6619036197662354
Epoch: 20, Steps: 3 | Train Loss: 0.156 Vali Loss: 1.060 Vali Acc: 0.675 Test Loss: 1.060 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 21 cost time: 0.6939132213592529
Epoch: 21, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.071 Vali Acc: 0.675 Test Loss: 1.071 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6597573757171631
Epoch: 22, Steps: 3 | Train Loss: 0.091 Vali Loss: 1.080 Vali Acc: 0.700 Test Loss: 1.080 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 23 cost time: 0.6780107021331787
Epoch: 23, Steps: 3 | Train Loss: 0.074 Vali Loss: 1.083 Vali Acc: 0.750 Test Loss: 1.083 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749989).  Saving model ...
Epoch: 24 cost time: 0.6405351161956787
Epoch: 24, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.087 Vali Acc: 0.750 Test Loss: 1.087 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6876521110534668
Epoch: 25, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.092 Vali Acc: 0.750 Test Loss: 1.092 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6091105937957764
Epoch: 26, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.104 Vali Acc: 0.750 Test Loss: 1.104 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7047183513641357
Epoch: 27, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.114 Vali Acc: 0.750 Test Loss: 1.114 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6698331832885742
Epoch: 28, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.118 Vali Acc: 0.750 Test Loss: 1.118 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6672589778900146
Epoch: 29, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.126 Vali Acc: 0.725 Test Loss: 1.126 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6256849765777588
Epoch: 30, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.134 Vali Acc: 0.725 Test Loss: 1.134 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6389985084533691
Epoch: 31, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.141 Vali Acc: 0.725 Test Loss: 1.141 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6593847274780273
Epoch: 32, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.146 Vali Acc: 0.725 Test Loss: 1.146 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6524662971496582
Epoch: 33, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.151 Vali Acc: 0.725 Test Loss: 1.151 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 119940
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2116432189941406
Epoch: 1, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.525 Vali Acc: 0.375 Test Loss: 1.525 Test Acc: 0.375
Validation loss decreased (inf --> -0.374985).  Saving model ...
Epoch: 2 cost time: 0.5925707817077637
Epoch: 2, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.509 Vali Acc: 0.400 Test Loss: 1.509 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399985).  Saving model ...
Epoch: 3 cost time: 0.7154998779296875
Epoch: 3, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.497 Vali Acc: 0.400 Test Loss: 1.497 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 0.5745861530303955
Epoch: 4, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.473 Vali Acc: 0.350 Test Loss: 1.473 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7519161701202393
Epoch: 5, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.444 Vali Acc: 0.350 Test Loss: 1.444 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6360347270965576
Epoch: 6, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.410 Vali Acc: 0.425 Test Loss: 1.410 Test Acc: 0.425
Validation loss decreased (-0.399985 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 0.742746114730835
Epoch: 7, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.374 Vali Acc: 0.425 Test Loss: 1.374 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 8 cost time: 0.7584342956542969
Epoch: 8, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.336 Vali Acc: 0.425 Test Loss: 1.336 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.6086595058441162
Epoch: 9, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.300 Vali Acc: 0.400 Test Loss: 1.300 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6773297786712646
Epoch: 10, Steps: 3 | Train Loss: 0.793 Vali Loss: 1.264 Vali Acc: 0.475 Test Loss: 1.264 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.6761617660522461
Epoch: 11, Steps: 3 | Train Loss: 0.715 Vali Loss: 1.232 Vali Acc: 0.475 Test Loss: 1.232 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 12 cost time: 0.7766799926757812
Epoch: 12, Steps: 3 | Train Loss: 0.568 Vali Loss: 1.199 Vali Acc: 0.575 Test Loss: 1.199 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 0.6580226421356201
Epoch: 13, Steps: 3 | Train Loss: 0.584 Vali Loss: 1.169 Vali Acc: 0.600 Test Loss: 1.169 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 0.7724826335906982
Epoch: 14, Steps: 3 | Train Loss: 0.484 Vali Loss: 1.148 Vali Acc: 0.575 Test Loss: 1.148 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7127034664154053
Epoch: 15, Steps: 3 | Train Loss: 0.424 Vali Loss: 1.131 Vali Acc: 0.600 Test Loss: 1.131 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.7348117828369141
Epoch: 16, Steps: 3 | Train Loss: 0.341 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 0.6487581729888916
Epoch: 17, Steps: 3 | Train Loss: 0.308 Vali Loss: 1.098 Vali Acc: 0.625 Test Loss: 1.098 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.6820876598358154
Epoch: 18, Steps: 3 | Train Loss: 0.303 Vali Loss: 1.089 Vali Acc: 0.650 Test Loss: 1.089 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 0.8598291873931885
Epoch: 19, Steps: 3 | Train Loss: 0.238 Vali Loss: 1.089 Vali Acc: 0.675 Test Loss: 1.089 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 20 cost time: 0.6929309368133545
Epoch: 20, Steps: 3 | Train Loss: 0.183 Vali Loss: 1.090 Vali Acc: 0.675 Test Loss: 1.090 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6853256225585938
Epoch: 21, Steps: 3 | Train Loss: 0.223 Vali Loss: 1.088 Vali Acc: 0.675 Test Loss: 1.088 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 22 cost time: 0.6953926086425781
Epoch: 22, Steps: 3 | Train Loss: 0.123 Vali Loss: 1.089 Vali Acc: 0.700 Test Loss: 1.089 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 23 cost time: 0.724951982498169
Epoch: 23, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.087 Vali Acc: 0.700 Test Loss: 1.087 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 24 cost time: 0.6842653751373291
Epoch: 24, Steps: 3 | Train Loss: 0.097 Vali Loss: 1.088 Vali Acc: 0.700 Test Loss: 1.088 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7967019081115723
Epoch: 25, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.095 Vali Acc: 0.700 Test Loss: 1.095 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7198288440704346
Epoch: 26, Steps: 3 | Train Loss: 0.074 Vali Loss: 1.097 Vali Acc: 0.700 Test Loss: 1.097 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.667574405670166
Epoch: 27, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.098 Vali Acc: 0.725 Test Loss: 1.098 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 28 cost time: 0.7128758430480957
Epoch: 28, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.101 Vali Acc: 0.725 Test Loss: 1.101 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.691077709197998
Epoch: 29, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.100 Vali Acc: 0.725 Test Loss: 1.100 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7723994255065918
Epoch: 30, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.095 Vali Acc: 0.725 Test Loss: 1.095 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 31 cost time: 0.6957519054412842
Epoch: 31, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.095 Vali Acc: 0.725 Test Loss: 1.095 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9878418445587158
Epoch: 32, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.093 Vali Acc: 0.725 Test Loss: 1.093 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 33 cost time: 0.7044315338134766
Epoch: 33, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.094 Vali Acc: 0.725 Test Loss: 1.094 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7194061279296875
Epoch: 34, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 35 cost time: 0.664984941482544
Epoch: 35, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.090 Vali Acc: 0.725 Test Loss: 1.090 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 36 cost time: 0.8143401145935059
Epoch: 36, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.090 Vali Acc: 0.725 Test Loss: 1.090 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7887289524078369
Epoch: 37, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7983787059783936
Epoch: 38, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.088 Vali Acc: 0.725 Test Loss: 1.088 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 39 cost time: 0.6955792903900146
Epoch: 39, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.088 Vali Acc: 0.725 Test Loss: 1.088 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 40 cost time: 0.730323076248169
Epoch: 40, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.087 Vali Acc: 0.725 Test Loss: 1.087 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 41 cost time: 0.7073371410369873
Epoch: 41, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.086 Vali Acc: 0.725 Test Loss: 1.086 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 42 cost time: 0.7652068138122559
Epoch: 42, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.084 Vali Acc: 0.725 Test Loss: 1.084 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 43 cost time: 0.908409595489502
Epoch: 43, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.083 Vali Acc: 0.725 Test Loss: 1.083 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 44 cost time: 0.6920919418334961
Epoch: 44, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.081 Vali Acc: 0.725 Test Loss: 1.081 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 45 cost time: 0.7058024406433105
Epoch: 45, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.085 Vali Acc: 0.725 Test Loss: 1.085 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7103672027587891
Epoch: 46, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.088 Vali Acc: 0.725 Test Loss: 1.088 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6880707740783691
Epoch: 47, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.708953857421875
Epoch: 48, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7070508003234863
Epoch: 49, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.093 Vali Acc: 0.725 Test Loss: 1.093 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.636054277420044
Epoch: 50, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.092 Vali Acc: 0.725 Test Loss: 1.092 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.7579159736633301
Epoch: 51, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.092 Vali Acc: 0.725 Test Loss: 1.092 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.6749305725097656
Epoch: 52, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.093 Vali Acc: 0.725 Test Loss: 1.093 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.7998130321502686
Epoch: 53, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.094 Vali Acc: 0.725 Test Loss: 1.094 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.7521491050720215
Epoch: 54, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.092 Vali Acc: 0.725 Test Loss: 1.092 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 117188
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2840576171875
Epoch: 1, Steps: 3 | Train Loss: 1.557 Vali Loss: 1.505 Vali Acc: 0.175 Test Loss: 1.505 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.6612071990966797
Epoch: 2, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.497 Vali Acc: 0.200 Test Loss: 1.497 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.6496386528015137
Epoch: 3, Steps: 3 | Train Loss: 1.616 Vali Loss: 1.489 Vali Acc: 0.225 Test Loss: 1.489 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 4 cost time: 0.6763193607330322
Epoch: 4, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.474 Vali Acc: 0.200 Test Loss: 1.474 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6060552597045898
Epoch: 5, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.457 Vali Acc: 0.250 Test Loss: 1.457 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249985).  Saving model ...
Epoch: 6 cost time: 0.6115717887878418
Epoch: 6, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.437 Vali Acc: 0.325 Test Loss: 1.437 Test Acc: 0.325
Validation loss decreased (-0.249985 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.6636877059936523
Epoch: 7, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.415 Vali Acc: 0.325 Test Loss: 1.415 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.7130894660949707
Epoch: 8, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.395 Vali Acc: 0.350 Test Loss: 1.395 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.6792275905609131
Epoch: 9, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.377 Vali Acc: 0.375 Test Loss: 1.377 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 10 cost time: 0.6888644695281982
Epoch: 10, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.360 Vali Acc: 0.425 Test Loss: 1.360 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 11 cost time: 0.6562469005584717
Epoch: 11, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.346 Vali Acc: 0.475 Test Loss: 1.346 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 0.7039327621459961
Epoch: 12, Steps: 3 | Train Loss: 0.763 Vali Loss: 1.334 Vali Acc: 0.550 Test Loss: 1.334 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 13 cost time: 0.8297238349914551
Epoch: 13, Steps: 3 | Train Loss: 0.785 Vali Loss: 1.324 Vali Acc: 0.550 Test Loss: 1.324 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 14 cost time: 0.8113834857940674
Epoch: 14, Steps: 3 | Train Loss: 0.528 Vali Loss: 1.313 Vali Acc: 0.550 Test Loss: 1.313 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 15 cost time: 0.7445590496063232
Epoch: 15, Steps: 3 | Train Loss: 0.623 Vali Loss: 1.306 Vali Acc: 0.550 Test Loss: 1.306 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 16 cost time: 0.7898988723754883
Epoch: 16, Steps: 3 | Train Loss: 0.509 Vali Loss: 1.305 Vali Acc: 0.550 Test Loss: 1.305 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 17 cost time: 0.7403359413146973
Epoch: 17, Steps: 3 | Train Loss: 0.517 Vali Loss: 1.298 Vali Acc: 0.550 Test Loss: 1.298 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 18 cost time: 0.8201398849487305
Epoch: 18, Steps: 3 | Train Loss: 0.431 Vali Loss: 1.293 Vali Acc: 0.600 Test Loss: 1.293 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 19 cost time: 0.7638664245605469
Epoch: 19, Steps: 3 | Train Loss: 0.420 Vali Loss: 1.286 Vali Acc: 0.600 Test Loss: 1.286 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 20 cost time: 0.7599334716796875
Epoch: 20, Steps: 3 | Train Loss: 0.372 Vali Loss: 1.277 Vali Acc: 0.625 Test Loss: 1.277 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624987).  Saving model ...
Epoch: 21 cost time: 0.7390382289886475
Epoch: 21, Steps: 3 | Train Loss: 0.299 Vali Loss: 1.270 Vali Acc: 0.650 Test Loss: 1.270 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 22 cost time: 0.7476041316986084
Epoch: 22, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.267 Vali Acc: 0.650 Test Loss: 1.267 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 23 cost time: 0.7311716079711914
Epoch: 23, Steps: 3 | Train Loss: 0.215 Vali Loss: 1.262 Vali Acc: 0.650 Test Loss: 1.262 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 24 cost time: 0.6862726211547852
Epoch: 24, Steps: 3 | Train Loss: 0.185 Vali Loss: 1.257 Vali Acc: 0.650 Test Loss: 1.257 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 25 cost time: 0.7121779918670654
Epoch: 25, Steps: 3 | Train Loss: 0.178 Vali Loss: 1.252 Vali Acc: 0.650 Test Loss: 1.252 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 26 cost time: 0.7326419353485107
Epoch: 26, Steps: 3 | Train Loss: 0.136 Vali Loss: 1.250 Vali Acc: 0.675 Test Loss: 1.250 Test Acc: 0.675
Validation loss decreased (-0.649987 --> -0.674988).  Saving model ...
Epoch: 27 cost time: 0.734705924987793
Epoch: 27, Steps: 3 | Train Loss: 0.148 Vali Loss: 1.254 Vali Acc: 0.675 Test Loss: 1.254 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.756284236907959
Epoch: 28, Steps: 3 | Train Loss: 0.101 Vali Loss: 1.251 Vali Acc: 0.675 Test Loss: 1.251 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8089950084686279
Epoch: 29, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.245 Vali Acc: 0.675 Test Loss: 1.245 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 30 cost time: 0.7537167072296143
Epoch: 30, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.237 Vali Acc: 0.675 Test Loss: 1.237 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 31 cost time: 0.8672184944152832
Epoch: 31, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.233 Vali Acc: 0.675 Test Loss: 1.233 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 32 cost time: 0.7347743511199951
Epoch: 32, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.235 Vali Acc: 0.675 Test Loss: 1.235 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7199230194091797
Epoch: 33, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.234 Vali Acc: 0.675 Test Loss: 1.234 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7617521286010742
Epoch: 34, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.234 Vali Acc: 0.675 Test Loss: 1.234 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7647418975830078
Epoch: 35, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.232 Vali Acc: 0.675 Test Loss: 1.232 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 36 cost time: 0.7623050212860107
Epoch: 36, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.232 Vali Acc: 0.675 Test Loss: 1.232 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.784325122833252
Epoch: 37, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.233 Vali Acc: 0.675 Test Loss: 1.233 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7096028327941895
Epoch: 38, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.232 Vali Acc: 0.675 Test Loss: 1.232 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7708950042724609
Epoch: 39, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.233 Vali Acc: 0.675 Test Loss: 1.233 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7190003395080566
Epoch: 40, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.236 Vali Acc: 0.675 Test Loss: 1.236 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7829725742340088
Epoch: 41, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.238 Vali Acc: 0.675 Test Loss: 1.238 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7672545909881592
Epoch: 42, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.237 Vali Acc: 0.675 Test Loss: 1.237 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.718076229095459
Epoch: 43, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.240 Vali Acc: 0.675 Test Loss: 1.240 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7667829990386963
Epoch: 44, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.241 Vali Acc: 0.675 Test Loss: 1.241 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7004950046539307
Epoch: 45, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.242 Vali Acc: 0.675 Test Loss: 1.242 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df128_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 112900
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7696995735168457
Epoch: 1, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.395 Vali Acc: 0.225 Test Loss: 1.395 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 1.098559856414795
Epoch: 2, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.349 Vali Acc: 0.275 Test Loss: 1.349 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.9873461723327637
Epoch: 3, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.298 Vali Acc: 0.475 Test Loss: 1.298 Test Acc: 0.475
Validation loss decreased (-0.274987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.146533727645874
Epoch: 4, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.233 Vali Acc: 0.525 Test Loss: 1.233 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 1.0029706954956055
Epoch: 5, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.148 Vali Acc: 0.525 Test Loss: 1.148 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 6 cost time: 1.0475950241088867
Epoch: 6, Steps: 3 | Train Loss: 0.740 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.9761171340942383
Epoch: 7, Steps: 3 | Train Loss: 0.588 Vali Loss: 1.006 Vali Acc: 0.700 Test Loss: 1.006 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 1.017488956451416
Epoch: 8, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.937 Vali Acc: 0.775 Test Loss: 0.937 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 1.1221449375152588
Epoch: 9, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.883 Vali Acc: 0.825 Test Loss: 0.883 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 10 cost time: 1.1138629913330078
Epoch: 10, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.852 Vali Acc: 0.825 Test Loss: 0.852 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 11 cost time: 1.0750796794891357
Epoch: 11, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0954906940460205
Epoch: 12, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.832 Vali Acc: 0.825 Test Loss: 0.832 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 13 cost time: 1.1807653903961182
Epoch: 13, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.803 Vali Acc: 0.825 Test Loss: 0.803 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 14 cost time: 1.1580069065093994
Epoch: 14, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2491769790649414
Epoch: 15, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.824 Vali Acc: 0.800 Test Loss: 0.824 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1568384170532227
Epoch: 16, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.842 Vali Acc: 0.775 Test Loss: 0.842 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1886672973632812
Epoch: 17, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.858 Vali Acc: 0.775 Test Loss: 0.858 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1743011474609375
Epoch: 18, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.875 Vali Acc: 0.775 Test Loss: 0.875 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1506381034851074
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.876 Vali Acc: 0.775 Test Loss: 0.876 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1767992973327637
Epoch: 20, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.871 Vali Acc: 0.775 Test Loss: 0.871 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2213644981384277
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.202627420425415
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.800 Test Loss: 0.863 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1126108169555664
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.862 Vali Acc: 0.800 Test Loss: 0.862 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 152772
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5608201026916504
Epoch: 1, Steps: 3 | Train Loss: 1.593 Vali Loss: 1.427 Vali Acc: 0.200 Test Loss: 1.427 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.9896814823150635
Epoch: 2, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.398 Vali Acc: 0.225 Test Loss: 1.398 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 1.004988431930542
Epoch: 3, Steps: 3 | Train Loss: 1.517 Vali Loss: 1.347 Vali Acc: 0.325 Test Loss: 1.347 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.9130980968475342
Epoch: 4, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.282 Vali Acc: 0.350 Test Loss: 1.282 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.9175968170166016
Epoch: 5, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
Validation loss decreased (-0.349987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.9576292037963867
Epoch: 6, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.148 Vali Acc: 0.525 Test Loss: 1.148 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 0.8173174858093262
Epoch: 7, Steps: 3 | Train Loss: 0.673 Vali Loss: 1.081 Vali Acc: 0.525 Test Loss: 1.081 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 8 cost time: 0.859748125076294
Epoch: 8, Steps: 3 | Train Loss: 0.660 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.925645112991333
Epoch: 9, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.962 Vali Acc: 0.650 Test Loss: 0.962 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.9617919921875
Epoch: 10, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.915 Vali Acc: 0.650 Test Loss: 0.915 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 11 cost time: 1.0265672206878662
Epoch: 11, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.872 Vali Acc: 0.725 Test Loss: 0.872 Test Acc: 0.725
Validation loss decreased (-0.649991 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 0.9609897136688232
Epoch: 12, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.841 Vali Acc: 0.725 Test Loss: 0.841 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 13 cost time: 0.9272706508636475
Epoch: 13, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.818 Vali Acc: 0.725 Test Loss: 0.818 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 14 cost time: 0.9233393669128418
Epoch: 14, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.796 Vali Acc: 0.775 Test Loss: 0.796 Test Acc: 0.775
Validation loss decreased (-0.724992 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 0.9265573024749756
Epoch: 15, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.770 Vali Acc: 0.775 Test Loss: 0.770 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 0.8434765338897705
Epoch: 16, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.764 Vali Acc: 0.775 Test Loss: 0.764 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.8942077159881592
Epoch: 17, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.779 Vali Acc: 0.775 Test Loss: 0.779 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9138154983520508
Epoch: 18, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.996434211730957
Epoch: 19, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.800 Vali Acc: 0.725 Test Loss: 0.800 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0019197463989258
Epoch: 20, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.883882999420166
Epoch: 21, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.786 Vali Acc: 0.775 Test Loss: 0.786 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9448087215423584
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.780 Vali Acc: 0.775 Test Loss: 0.780 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9642713069915771
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 0.936408281326294
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9075462818145752
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.026792287826538
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.780 Vali Acc: 0.800 Test Loss: 0.780 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0906519889831543
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.784 Vali Acc: 0.775 Test Loss: 0.784 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.02451753616333
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0414485931396484
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9196016788482666
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.795 Vali Acc: 0.775 Test Loss: 0.795 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9497697353363037
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.798 Vali Acc: 0.775 Test Loss: 0.798 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8219423294067383
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.802 Vali Acc: 0.775 Test Loss: 0.802 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.013857364654541
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.804 Vali Acc: 0.775 Test Loss: 0.804 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 126788
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6028084754943848
Epoch: 1, Steps: 3 | Train Loss: 1.570 Vali Loss: 1.633 Vali Acc: 0.275 Test Loss: 1.633 Test Acc: 0.275
Validation loss decreased (inf --> -0.274984).  Saving model ...
Epoch: 2 cost time: 1.0844149589538574
Epoch: 2, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.568 Vali Acc: 0.325 Test Loss: 1.568 Test Acc: 0.325
Validation loss decreased (-0.274984 --> -0.324984).  Saving model ...
Epoch: 3 cost time: 1.0460870265960693
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.505 Vali Acc: 0.425 Test Loss: 1.505 Test Acc: 0.425
Validation loss decreased (-0.324984 --> -0.424985).  Saving model ...
Epoch: 4 cost time: 1.003986120223999
Epoch: 4, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
Validation loss decreased (-0.424985 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 1.0646917819976807
Epoch: 5, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.368 Vali Acc: 0.500 Test Loss: 1.368 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 1.0407264232635498
Epoch: 6, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.9020318984985352
Epoch: 7, Steps: 3 | Train Loss: 0.767 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.0340125560760498
Epoch: 8, Steps: 3 | Train Loss: 0.690 Vali Loss: 1.208 Vali Acc: 0.550 Test Loss: 1.208 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 1.0458993911743164
Epoch: 9, Steps: 3 | Train Loss: 0.623 Vali Loss: 1.154 Vali Acc: 0.575 Test Loss: 1.154 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 1.0282833576202393
Epoch: 10, Steps: 3 | Train Loss: 0.474 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 1.0043277740478516
Epoch: 11, Steps: 3 | Train Loss: 0.418 Vali Loss: 1.076 Vali Acc: 0.625 Test Loss: 1.076 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.9031243324279785
Epoch: 12, Steps: 3 | Train Loss: 0.296 Vali Loss: 1.058 Vali Acc: 0.625 Test Loss: 1.058 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.9416155815124512
Epoch: 13, Steps: 3 | Train Loss: 0.236 Vali Loss: 1.020 Vali Acc: 0.650 Test Loss: 1.020 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 0.9165225028991699
Epoch: 14, Steps: 3 | Train Loss: 0.190 Vali Loss: 1.020 Vali Acc: 0.650 Test Loss: 1.020 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.053342580795288
Epoch: 15, Steps: 3 | Train Loss: 0.125 Vali Loss: 1.009 Vali Acc: 0.650 Test Loss: 1.009 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 0.9301941394805908
Epoch: 16, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.995 Vali Acc: 0.700 Test Loss: 0.995 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 0.9779293537139893
Epoch: 17, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.982 Vali Acc: 0.725 Test Loss: 0.982 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 18 cost time: 0.9303555488586426
Epoch: 18, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.974 Vali Acc: 0.725 Test Loss: 0.974 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 19 cost time: 0.8969650268554688
Epoch: 19, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 20 cost time: 0.8940210342407227
Epoch: 20, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.971 Vali Acc: 0.725 Test Loss: 0.971 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9783751964569092
Epoch: 21, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.975 Vali Acc: 0.725 Test Loss: 0.975 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9301269054412842
Epoch: 22, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.982 Vali Acc: 0.725 Test Loss: 0.982 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9130246639251709
Epoch: 23, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.988 Vali Acc: 0.725 Test Loss: 0.988 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8066275119781494
Epoch: 24, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9846785068511963
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.003 Vali Acc: 0.700 Test Loss: 1.003 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0859591960906982
Epoch: 26, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.007 Vali Acc: 0.700 Test Loss: 1.007 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8205046653747559
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0543828010559082
Epoch: 28, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.006 Vali Acc: 0.700 Test Loss: 1.006 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9344289302825928
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.998 Vali Acc: 0.725 Test Loss: 0.998 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 114692
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3029706478118896
Epoch: 1, Steps: 3 | Train Loss: 1.598 Vali Loss: 1.482 Vali Acc: 0.250 Test Loss: 1.482 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.646791934967041
Epoch: 2, Steps: 3 | Train Loss: 1.572 Vali Loss: 1.462 Vali Acc: 0.225 Test Loss: 1.462 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6345596313476562
Epoch: 3, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.435 Vali Acc: 0.200 Test Loss: 1.435 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6354329586029053
Epoch: 4, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.395 Vali Acc: 0.275 Test Loss: 1.395 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.7087967395782471
Epoch: 5, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.350 Vali Acc: 0.375 Test Loss: 1.350 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.6608531475067139
Epoch: 6, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.300 Vali Acc: 0.400 Test Loss: 1.300 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.7392487525939941
Epoch: 7, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.254 Vali Acc: 0.450 Test Loss: 1.254 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.6697530746459961
Epoch: 8, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.6549046039581299
Epoch: 9, Steps: 3 | Train Loss: 0.657 Vali Loss: 1.179 Vali Acc: 0.550 Test Loss: 1.179 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.6483464241027832
Epoch: 10, Steps: 3 | Train Loss: 0.555 Vali Loss: 1.136 Vali Acc: 0.550 Test Loss: 1.136 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 0.7935211658477783
Epoch: 11, Steps: 3 | Train Loss: 0.485 Vali Loss: 1.100 Vali Acc: 0.550 Test Loss: 1.100 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 0.5869600772857666
Epoch: 12, Steps: 3 | Train Loss: 0.382 Vali Loss: 1.078 Vali Acc: 0.575 Test Loss: 1.078 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.7115199565887451
Epoch: 13, Steps: 3 | Train Loss: 0.322 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.6453971862792969
Epoch: 14, Steps: 3 | Train Loss: 0.212 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.6213748455047607
Epoch: 15, Steps: 3 | Train Loss: 0.239 Vali Loss: 1.037 Vali Acc: 0.625 Test Loss: 1.037 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 16 cost time: 0.6490161418914795
Epoch: 16, Steps: 3 | Train Loss: 0.162 Vali Loss: 1.015 Vali Acc: 0.625 Test Loss: 1.015 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 17 cost time: 0.6957011222839355
Epoch: 17, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.998 Vali Acc: 0.675 Test Loss: 0.998 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 0.7689905166625977
Epoch: 18, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.985 Vali Acc: 0.725 Test Loss: 0.985 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 19 cost time: 0.6950266361236572
Epoch: 19, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.978 Vali Acc: 0.725 Test Loss: 0.978 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 20 cost time: 0.7791259288787842
Epoch: 20, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.968 Vali Acc: 0.725 Test Loss: 0.968 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 21 cost time: 0.6406588554382324
Epoch: 21, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.960 Vali Acc: 0.725 Test Loss: 0.960 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 22 cost time: 0.6888241767883301
Epoch: 22, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.962 Vali Acc: 0.725 Test Loss: 0.962 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6224400997161865
Epoch: 23, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.968 Vali Acc: 0.725 Test Loss: 0.968 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6645450592041016
Epoch: 24, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.977 Vali Acc: 0.725 Test Loss: 0.977 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7627086639404297
Epoch: 25, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.983 Vali Acc: 0.725 Test Loss: 0.983 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6703286170959473
Epoch: 26, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.992 Vali Acc: 0.725 Test Loss: 0.992 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6803772449493408
Epoch: 27, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.002 Vali Acc: 0.700 Test Loss: 1.002 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7038285732269287
Epoch: 28, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.012 Vali Acc: 0.725 Test Loss: 1.012 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7191150188446045
Epoch: 29, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.019 Vali Acc: 0.725 Test Loss: 1.019 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6435024738311768
Epoch: 30, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.025 Vali Acc: 0.725 Test Loss: 1.025 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7309927940368652
Epoch: 31, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.028 Vali Acc: 0.725 Test Loss: 1.028 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 107140
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4955410957336426
Epoch: 1, Steps: 3 | Train Loss: 1.680 Vali Loss: 1.603 Vali Acc: 0.100 Test Loss: 1.603 Test Acc: 0.100
Validation loss decreased (inf --> -0.099984).  Saving model ...
Epoch: 2 cost time: 0.7148633003234863
Epoch: 2, Steps: 3 | Train Loss: 1.655 Vali Loss: 1.603 Vali Acc: 0.100 Test Loss: 1.603 Test Acc: 0.100
Validation loss decreased (-0.099984 --> -0.099984).  Saving model ...
Epoch: 3 cost time: 0.6622388362884521
Epoch: 3, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.598 Vali Acc: 0.100 Test Loss: 1.598 Test Acc: 0.100
Validation loss decreased (-0.099984 --> -0.099984).  Saving model ...
Epoch: 4 cost time: 0.7177543640136719
Epoch: 4, Steps: 3 | Train Loss: 1.564 Vali Loss: 1.585 Vali Acc: 0.100 Test Loss: 1.585 Test Acc: 0.100
Validation loss decreased (-0.099984 --> -0.099984).  Saving model ...
Epoch: 5 cost time: 0.7011969089508057
Epoch: 5, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.564 Vali Acc: 0.125 Test Loss: 1.564 Test Acc: 0.125
Validation loss decreased (-0.099984 --> -0.124984).  Saving model ...
Epoch: 6 cost time: 0.7613015174865723
Epoch: 6, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.542 Vali Acc: 0.200 Test Loss: 1.542 Test Acc: 0.200
Validation loss decreased (-0.124984 --> -0.199985).  Saving model ...
Epoch: 7 cost time: 0.7199380397796631
Epoch: 7, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.513 Vali Acc: 0.300 Test Loss: 1.513 Test Acc: 0.300
Validation loss decreased (-0.199985 --> -0.299985).  Saving model ...
Epoch: 8 cost time: 0.7470149993896484
Epoch: 8, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.483 Vali Acc: 0.400 Test Loss: 1.483 Test Acc: 0.400
Validation loss decreased (-0.299985 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 0.679962158203125
Epoch: 9, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.460 Vali Acc: 0.375 Test Loss: 1.460 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.819075345993042
Epoch: 10, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.433 Vali Acc: 0.400 Test Loss: 1.433 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 0.6734185218811035
Epoch: 11, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.402 Vali Acc: 0.450 Test Loss: 1.402 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 12 cost time: 0.6776919364929199
Epoch: 12, Steps: 3 | Train Loss: 0.696 Vali Loss: 1.371 Vali Acc: 0.450 Test Loss: 1.371 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 13 cost time: 0.6587009429931641
Epoch: 13, Steps: 3 | Train Loss: 0.659 Vali Loss: 1.335 Vali Acc: 0.475 Test Loss: 1.335 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 14 cost time: 0.659510612487793
Epoch: 14, Steps: 3 | Train Loss: 0.492 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 15 cost time: 0.7188832759857178
Epoch: 15, Steps: 3 | Train Loss: 0.499 Vali Loss: 1.272 Vali Acc: 0.475 Test Loss: 1.272 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6315929889678955
Epoch: 16, Steps: 3 | Train Loss: 0.402 Vali Loss: 1.248 Vali Acc: 0.525 Test Loss: 1.248 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.6858079433441162
Epoch: 17, Steps: 3 | Train Loss: 0.395 Vali Loss: 1.240 Vali Acc: 0.525 Test Loss: 1.240 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 18 cost time: 0.6564371585845947
Epoch: 18, Steps: 3 | Train Loss: 0.245 Vali Loss: 1.231 Vali Acc: 0.525 Test Loss: 1.231 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 19 cost time: 0.677227258682251
Epoch: 19, Steps: 3 | Train Loss: 0.216 Vali Loss: 1.223 Vali Acc: 0.525 Test Loss: 1.223 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 20 cost time: 0.692969560623169
Epoch: 20, Steps: 3 | Train Loss: 0.213 Vali Loss: 1.226 Vali Acc: 0.575 Test Loss: 1.226 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.6430072784423828
Epoch: 21, Steps: 3 | Train Loss: 0.169 Vali Loss: 1.231 Vali Acc: 0.600 Test Loss: 1.231 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 0.6806600093841553
Epoch: 22, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.236 Vali Acc: 0.575 Test Loss: 1.236 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7615137100219727
Epoch: 23, Steps: 3 | Train Loss: 0.111 Vali Loss: 1.228 Vali Acc: 0.600 Test Loss: 1.228 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 24 cost time: 0.7775726318359375
Epoch: 24, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.220 Vali Acc: 0.600 Test Loss: 1.220 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 25 cost time: 0.732048511505127
Epoch: 25, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.216 Vali Acc: 0.625 Test Loss: 1.216 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 26 cost time: 0.7380220890045166
Epoch: 26, Steps: 3 | Train Loss: 0.060 Vali Loss: 1.222 Vali Acc: 0.625 Test Loss: 1.222 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6227660179138184
Epoch: 27, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.223 Vali Acc: 0.625 Test Loss: 1.223 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7296416759490967
Epoch: 28, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.227 Vali Acc: 0.625 Test Loss: 1.227 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7002665996551514
Epoch: 29, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.232 Vali Acc: 0.625 Test Loss: 1.232 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6131985187530518
Epoch: 30, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.234 Vali Acc: 0.625 Test Loss: 1.234 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.679701566696167
Epoch: 31, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.236 Vali Acc: 0.625 Test Loss: 1.236 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6930661201477051
Epoch: 32, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.240 Vali Acc: 0.625 Test Loss: 1.240 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7022280693054199
Epoch: 33, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.244 Vali Acc: 0.625 Test Loss: 1.244 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6972911357879639
Epoch: 34, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.241 Vali Acc: 0.625 Test Loss: 1.241 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.702397346496582
Epoch: 35, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.240 Vali Acc: 0.625 Test Loss: 1.240 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 95172
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.575247287750244
Epoch: 1, Steps: 3 | Train Loss: 1.644 Vali Loss: 1.431 Vali Acc: 0.275 Test Loss: 1.431 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.7223799228668213
Epoch: 2, Steps: 3 | Train Loss: 1.616 Vali Loss: 1.424 Vali Acc: 0.250 Test Loss: 1.424 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.767418622970581
Epoch: 3, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.411 Vali Acc: 0.275 Test Loss: 1.411 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.6983482837677002
Epoch: 4, Steps: 3 | Train Loss: 1.557 Vali Loss: 1.391 Vali Acc: 0.300 Test Loss: 1.391 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.6821742057800293
Epoch: 5, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.365 Vali Acc: 0.300 Test Loss: 1.365 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.7203271389007568
Epoch: 6, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.332 Vali Acc: 0.375 Test Loss: 1.332 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.802635669708252
Epoch: 7, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.7171938419342041
Epoch: 8, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.259 Vali Acc: 0.450 Test Loss: 1.259 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.722902774810791
Epoch: 9, Steps: 3 | Train Loss: 0.907 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.7946090698242188
Epoch: 10, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.6666491031646729
Epoch: 11, Steps: 3 | Train Loss: 0.861 Vali Loss: 1.169 Vali Acc: 0.525 Test Loss: 1.169 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 0.7939541339874268
Epoch: 12, Steps: 3 | Train Loss: 0.729 Vali Loss: 1.143 Vali Acc: 0.575 Test Loss: 1.143 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.750006914138794
Epoch: 13, Steps: 3 | Train Loss: 0.681 Vali Loss: 1.126 Vali Acc: 0.600 Test Loss: 1.126 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.8922116756439209
Epoch: 14, Steps: 3 | Train Loss: 0.599 Vali Loss: 1.106 Vali Acc: 0.575 Test Loss: 1.106 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6824922561645508
Epoch: 15, Steps: 3 | Train Loss: 0.578 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.707904577255249
Epoch: 16, Steps: 3 | Train Loss: 0.511 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.8086543083190918
Epoch: 17, Steps: 3 | Train Loss: 0.386 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.749767541885376
Epoch: 18, Steps: 3 | Train Loss: 0.325 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.787367582321167
Epoch: 19, Steps: 3 | Train Loss: 0.347 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.7376153469085693
Epoch: 20, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.996 Vali Acc: 0.625 Test Loss: 0.996 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 21 cost time: 0.7114553451538086
Epoch: 21, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.997 Vali Acc: 0.625 Test Loss: 0.997 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7323577404022217
Epoch: 22, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.996 Vali Acc: 0.625 Test Loss: 0.996 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 23 cost time: 0.7399795055389404
Epoch: 23, Steps: 3 | Train Loss: 0.168 Vali Loss: 1.003 Vali Acc: 0.625 Test Loss: 1.003 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8104188442230225
Epoch: 24, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.007 Vali Acc: 0.650 Test Loss: 1.007 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 25 cost time: 0.7830932140350342
Epoch: 25, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.015 Vali Acc: 0.675 Test Loss: 1.015 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 26 cost time: 0.7534699440002441
Epoch: 26, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8049089908599854
Epoch: 27, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.026 Vali Acc: 0.650 Test Loss: 1.026 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7151408195495605
Epoch: 28, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.033 Vali Acc: 0.650 Test Loss: 1.033 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.71073317527771
Epoch: 29, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.039 Vali Acc: 0.675 Test Loss: 1.039 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.707268238067627
Epoch: 30, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.043 Vali Acc: 0.675 Test Loss: 1.043 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.744920015335083
Epoch: 31, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6573019027709961
Epoch: 32, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.049 Vali Acc: 0.675 Test Loss: 1.049 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.675325870513916
Epoch: 33, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.044 Vali Acc: 0.675 Test Loss: 1.044 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6887378692626953
Epoch: 34, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.041 Vali Acc: 0.675 Test Loss: 1.041 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7544882297515869
Epoch: 35, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.035 Vali Acc: 0.675 Test Loss: 1.035 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 92420
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3174054622650146
Epoch: 1, Steps: 3 | Train Loss: 1.540 Vali Loss: 1.416 Vali Acc: 0.350 Test Loss: 1.416 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.6767675876617432
Epoch: 2, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.403 Vali Acc: 0.400 Test Loss: 1.403 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.6381340026855469
Epoch: 3, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.390 Vali Acc: 0.375 Test Loss: 1.390 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6434743404388428
Epoch: 4, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.378 Vali Acc: 0.375 Test Loss: 1.378 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7739565372467041
Epoch: 5, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.362 Vali Acc: 0.400 Test Loss: 1.362 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.6844508647918701
Epoch: 6, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.348 Vali Acc: 0.375 Test Loss: 1.348 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6995997428894043
Epoch: 7, Steps: 3 | Train Loss: 1.121 Vali Loss: 1.333 Vali Acc: 0.400 Test Loss: 1.333 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.7058446407318115
Epoch: 8, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.320 Vali Acc: 0.400 Test Loss: 1.320 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.6718981266021729
Epoch: 9, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.306 Vali Acc: 0.425 Test Loss: 1.306 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.7088360786437988
Epoch: 10, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.292 Vali Acc: 0.425 Test Loss: 1.292 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 11 cost time: 0.791440486907959
Epoch: 11, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.279 Vali Acc: 0.450 Test Loss: 1.279 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.6892092227935791
Epoch: 12, Steps: 3 | Train Loss: 0.813 Vali Loss: 1.266 Vali Acc: 0.450 Test Loss: 1.266 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 13 cost time: 0.6613955497741699
Epoch: 13, Steps: 3 | Train Loss: 0.751 Vali Loss: 1.252 Vali Acc: 0.450 Test Loss: 1.252 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 14 cost time: 0.6721994876861572
Epoch: 14, Steps: 3 | Train Loss: 0.681 Vali Loss: 1.243 Vali Acc: 0.450 Test Loss: 1.243 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 15 cost time: 0.7016186714172363
Epoch: 15, Steps: 3 | Train Loss: 0.611 Vali Loss: 1.235 Vali Acc: 0.425 Test Loss: 1.235 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6633820533752441
Epoch: 16, Steps: 3 | Train Loss: 0.530 Vali Loss: 1.227 Vali Acc: 0.450 Test Loss: 1.227 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 17 cost time: 0.7442173957824707
Epoch: 17, Steps: 3 | Train Loss: 0.522 Vali Loss: 1.215 Vali Acc: 0.450 Test Loss: 1.215 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 18 cost time: 0.8014218807220459
Epoch: 18, Steps: 3 | Train Loss: 0.449 Vali Loss: 1.200 Vali Acc: 0.475 Test Loss: 1.200 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 19 cost time: 0.7583596706390381
Epoch: 19, Steps: 3 | Train Loss: 0.380 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 20 cost time: 0.71610426902771
Epoch: 20, Steps: 3 | Train Loss: 0.337 Vali Loss: 1.176 Vali Acc: 0.525 Test Loss: 1.176 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 21 cost time: 0.7195773124694824
Epoch: 21, Steps: 3 | Train Loss: 0.323 Vali Loss: 1.171 Vali Acc: 0.600 Test Loss: 1.171 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 0.665778636932373
Epoch: 22, Steps: 3 | Train Loss: 0.348 Vali Loss: 1.167 Vali Acc: 0.600 Test Loss: 1.167 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 23 cost time: 0.7950088977813721
Epoch: 23, Steps: 3 | Train Loss: 0.244 Vali Loss: 1.166 Vali Acc: 0.600 Test Loss: 1.166 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 24 cost time: 0.8202700614929199
Epoch: 24, Steps: 3 | Train Loss: 0.214 Vali Loss: 1.168 Vali Acc: 0.600 Test Loss: 1.168 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7617001533508301
Epoch: 25, Steps: 3 | Train Loss: 0.151 Vali Loss: 1.170 Vali Acc: 0.600 Test Loss: 1.170 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.624652624130249
Epoch: 26, Steps: 3 | Train Loss: 0.171 Vali Loss: 1.170 Vali Acc: 0.600 Test Loss: 1.170 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.764054536819458
Epoch: 27, Steps: 3 | Train Loss: 0.142 Vali Loss: 1.172 Vali Acc: 0.600 Test Loss: 1.172 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7156007289886475
Epoch: 28, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.174 Vali Acc: 0.600 Test Loss: 1.174 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7088849544525146
Epoch: 29, Steps: 3 | Train Loss: 0.096 Vali Loss: 1.175 Vali Acc: 0.625 Test Loss: 1.175 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 30 cost time: 0.678743839263916
Epoch: 30, Steps: 3 | Train Loss: 0.081 Vali Loss: 1.174 Vali Acc: 0.625 Test Loss: 1.174 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 31 cost time: 0.7226574420928955
Epoch: 31, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.175 Vali Acc: 0.625 Test Loss: 1.175 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7540152072906494
Epoch: 32, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6863460540771484
Epoch: 33, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.177 Vali Acc: 0.625 Test Loss: 1.177 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7457146644592285
Epoch: 34, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7443141937255859
Epoch: 35, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.177 Vali Acc: 0.625 Test Loss: 1.177 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6512782573699951
Epoch: 36, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7357709407806396
Epoch: 37, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.178 Vali Acc: 0.625 Test Loss: 1.178 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6713991165161133
Epoch: 38, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.186 Vali Acc: 0.625 Test Loss: 1.186 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6322166919708252
Epoch: 39, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.191 Vali Acc: 0.625 Test Loss: 1.191 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7058823108673096
Epoch: 40, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.191 Vali Acc: 0.625 Test Loss: 1.191 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm64_nh16_df64_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 88132
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.595118284225464
Epoch: 1, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.573 Vali Acc: 0.300 Test Loss: 1.573 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.8462185859680176
Epoch: 2, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.489 Vali Acc: 0.300 Test Loss: 1.489 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.9140956401824951
Epoch: 3, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.399 Vali Acc: 0.200 Test Loss: 1.399 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9123821258544922
Epoch: 4, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.326 Vali Acc: 0.350 Test Loss: 1.326 Test Acc: 0.350
Validation loss decreased (-0.299985 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.9308004379272461
Epoch: 5, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.9166145324707031
Epoch: 6, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.221 Vali Acc: 0.425 Test Loss: 1.221 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 0.9129242897033691
Epoch: 7, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.175 Vali Acc: 0.425 Test Loss: 1.175 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 0.8490564823150635
Epoch: 8, Steps: 3 | Train Loss: 0.786 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 0.8915832042694092
Epoch: 9, Steps: 3 | Train Loss: 0.598 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
Validation loss decreased (-0.499989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.9919610023498535
Epoch: 10, Steps: 3 | Train Loss: 0.602 Vali Loss: 1.051 Vali Acc: 0.625 Test Loss: 1.051 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.8549289703369141
Epoch: 11, Steps: 3 | Train Loss: 0.452 Vali Loss: 1.006 Vali Acc: 0.675 Test Loss: 1.006 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 1.0062439441680908
Epoch: 12, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.959 Vali Acc: 0.675 Test Loss: 0.959 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 0.944511890411377
Epoch: 13, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.933 Vali Acc: 0.675 Test Loss: 0.933 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 14 cost time: 1.0162575244903564
Epoch: 14, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.908 Vali Acc: 0.725 Test Loss: 0.908 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 0.9108507633209229
Epoch: 15, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.896 Vali Acc: 0.775 Test Loss: 0.896 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 16 cost time: 0.9285192489624023
Epoch: 16, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.898 Vali Acc: 0.750 Test Loss: 0.898 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9090936183929443
Epoch: 17, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.869 Vali Acc: 0.750 Test Loss: 0.869 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9275197982788086
Epoch: 18, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.832 Vali Acc: 0.825 Test Loss: 0.832 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 1.0845167636871338
Epoch: 19, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 20 cost time: 0.9660460948944092
Epoch: 20, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.800 Vali Acc: 0.825 Test Loss: 0.800 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 21 cost time: 0.9801299571990967
Epoch: 21, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.793 Vali Acc: 0.825 Test Loss: 0.793 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 22 cost time: 1.0303928852081299
Epoch: 22, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.786 Vali Acc: 0.825 Test Loss: 0.786 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 0.958770751953125
Epoch: 23, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.783 Vali Acc: 0.825 Test Loss: 0.783 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 24 cost time: 1.0776946544647217
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.783 Vali Acc: 0.825 Test Loss: 0.783 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9966592788696289
Epoch: 25, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.782 Vali Acc: 0.825 Test Loss: 0.782 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 26 cost time: 0.9723262786865234
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.783 Vali Acc: 0.825 Test Loss: 0.783 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9766199588775635
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.785 Vali Acc: 0.825 Test Loss: 0.785 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9089839458465576
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.825 Test Loss: 0.789 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.009446144104004
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.793 Vali Acc: 0.825 Test Loss: 0.793 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9828505516052246
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.036400556564331
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9510993957519531
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9090762138366699
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.800 Vali Acc: 0.800 Test Loss: 0.800 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0994207859039307
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.801 Vali Acc: 0.800 Test Loss: 0.801 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.190481185913086
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.800 Vali Acc: 0.800 Test Loss: 0.800 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 101636
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.407123565673828
Epoch: 1, Steps: 3 | Train Loss: 1.706 Vali Loss: 1.331 Vali Acc: 0.300 Test Loss: 1.331 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.7368178367614746
Epoch: 2, Steps: 3 | Train Loss: 1.586 Vali Loss: 1.315 Vali Acc: 0.375 Test Loss: 1.315 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.7325315475463867
Epoch: 3, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.6525936126708984
Epoch: 4, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.271 Vali Acc: 0.425 Test Loss: 1.271 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.6384735107421875
Epoch: 5, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.250 Vali Acc: 0.475 Test Loss: 1.250 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.6983110904693604
Epoch: 6, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.226 Vali Acc: 0.550 Test Loss: 1.226 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.6537179946899414
Epoch: 7, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.187 Vali Acc: 0.650 Test Loss: 1.187 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 0.6153740882873535
Epoch: 8, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7165546417236328
Epoch: 9, Steps: 3 | Train Loss: 0.848 Vali Loss: 1.095 Vali Acc: 0.625 Test Loss: 1.095 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.662611722946167
Epoch: 10, Steps: 3 | Train Loss: 0.716 Vali Loss: 1.049 Vali Acc: 0.625 Test Loss: 1.049 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7241964340209961
Epoch: 11, Steps: 3 | Train Loss: 0.697 Vali Loss: 1.004 Vali Acc: 0.675 Test Loss: 1.004 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.7025275230407715
Epoch: 12, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.965 Vali Acc: 0.700 Test Loss: 0.965 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.678403377532959
Epoch: 13, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.928 Vali Acc: 0.700 Test Loss: 0.928 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 0.6736581325531006
Epoch: 14, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.897 Vali Acc: 0.700 Test Loss: 0.897 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 0.6639614105224609
Epoch: 15, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.872 Vali Acc: 0.725 Test Loss: 0.872 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 0.6594266891479492
Epoch: 16, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.848 Vali Acc: 0.725 Test Loss: 0.848 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 17 cost time: 0.6022965908050537
Epoch: 17, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.825 Vali Acc: 0.725 Test Loss: 0.825 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 18 cost time: 0.5673127174377441
Epoch: 18, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.808 Vali Acc: 0.725 Test Loss: 0.808 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 19 cost time: 0.6333048343658447
Epoch: 19, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.794 Vali Acc: 0.725 Test Loss: 0.794 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 20 cost time: 0.5830166339874268
Epoch: 20, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.790 Vali Acc: 0.725 Test Loss: 0.790 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 21 cost time: 0.6091971397399902
Epoch: 21, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.6012973785400391
Epoch: 22, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 0.6602675914764404
Epoch: 23, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.772 Vali Acc: 0.775 Test Loss: 0.772 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 24 cost time: 0.72139573097229
Epoch: 24, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.767 Vali Acc: 0.775 Test Loss: 0.767 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 25 cost time: 0.6169097423553467
Epoch: 25, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.759 Vali Acc: 0.775 Test Loss: 0.759 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 26 cost time: 0.6720418930053711
Epoch: 26, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 27 cost time: 0.6428935527801514
Epoch: 27, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 28 cost time: 0.6469111442565918
Epoch: 28, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 29 cost time: 0.6871342658996582
Epoch: 29, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 30 cost time: 0.6773815155029297
Epoch: 30, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 31 cost time: 0.6232552528381348
Epoch: 31, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 32 cost time: 0.6569919586181641
Epoch: 32, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.740 Vali Acc: 0.800 Test Loss: 0.740 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 33 cost time: 0.648566484451294
Epoch: 33, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.740 Vali Acc: 0.800 Test Loss: 0.740 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7472844123840332
Epoch: 34, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.741 Vali Acc: 0.800 Test Loss: 0.741 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6977009773254395
Epoch: 35, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6873233318328857
Epoch: 36, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6915967464447021
Epoch: 37, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.746 Vali Acc: 0.800 Test Loss: 0.746 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.685711145401001
Epoch: 38, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.747 Vali Acc: 0.800 Test Loss: 0.747 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7807068824768066
Epoch: 39, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6941361427307129
Epoch: 40, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6814167499542236
Epoch: 41, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.750 Vali Acc: 0.800 Test Loss: 0.750 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7875850200653076
Epoch: 42, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 88644
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.270658493041992
Epoch: 1, Steps: 3 | Train Loss: 1.553 Vali Loss: 1.427 Vali Acc: 0.175 Test Loss: 1.427 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.635425329208374
Epoch: 2, Steps: 3 | Train Loss: 1.604 Vali Loss: 1.409 Vali Acc: 0.200 Test Loss: 1.409 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.702582836151123
Epoch: 3, Steps: 3 | Train Loss: 1.582 Vali Loss: 1.387 Vali Acc: 0.200 Test Loss: 1.387 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.670983076095581
Epoch: 4, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.356 Vali Acc: 0.275 Test Loss: 1.356 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.696497917175293
Epoch: 5, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.323 Vali Acc: 0.300 Test Loss: 1.323 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 6 cost time: 0.6488051414489746
Epoch: 6, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.287 Vali Acc: 0.375 Test Loss: 1.287 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.7369928359985352
Epoch: 7, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.246 Vali Acc: 0.375 Test Loss: 1.246 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374988).  Saving model ...
Epoch: 8 cost time: 0.7371759414672852
Epoch: 8, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.205 Vali Acc: 0.425 Test Loss: 1.205 Test Acc: 0.425
Validation loss decreased (-0.374988 --> -0.424988).  Saving model ...
Epoch: 9 cost time: 0.6987004280090332
Epoch: 9, Steps: 3 | Train Loss: 0.868 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.6892030239105225
Epoch: 10, Steps: 3 | Train Loss: 0.778 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 11 cost time: 0.6581175327301025
Epoch: 11, Steps: 3 | Train Loss: 0.745 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
Validation loss decreased (-0.499989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.7256801128387451
Epoch: 12, Steps: 3 | Train Loss: 0.640 Vali Loss: 1.037 Vali Acc: 0.625 Test Loss: 1.037 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 13 cost time: 0.7495718002319336
Epoch: 13, Steps: 3 | Train Loss: 0.614 Vali Loss: 1.002 Vali Acc: 0.650 Test Loss: 1.002 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 0.7252786159515381
Epoch: 14, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.969 Vali Acc: 0.650 Test Loss: 0.969 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.7689476013183594
Epoch: 15, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.945 Vali Acc: 0.675 Test Loss: 0.945 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 16 cost time: 0.728661298751831
Epoch: 16, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.923 Vali Acc: 0.675 Test Loss: 0.923 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 17 cost time: 0.6928415298461914
Epoch: 17, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.916 Vali Acc: 0.675 Test Loss: 0.916 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 18 cost time: 0.7631406784057617
Epoch: 18, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.909 Vali Acc: 0.675 Test Loss: 0.909 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 19 cost time: 0.8265080451965332
Epoch: 19, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.906 Vali Acc: 0.700 Test Loss: 0.906 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 20 cost time: 0.6514441967010498
Epoch: 20, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.898 Vali Acc: 0.700 Test Loss: 0.898 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 21 cost time: 0.7045927047729492
Epoch: 21, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.896 Vali Acc: 0.700 Test Loss: 0.896 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 22 cost time: 0.741074800491333
Epoch: 22, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.884 Vali Acc: 0.700 Test Loss: 0.884 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 23 cost time: 0.6703920364379883
Epoch: 23, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.878 Vali Acc: 0.700 Test Loss: 0.878 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 24 cost time: 0.717766523361206
Epoch: 24, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.882 Vali Acc: 0.725 Test Loss: 0.882 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 25 cost time: 0.7935466766357422
Epoch: 25, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.884 Vali Acc: 0.750 Test Loss: 0.884 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 26 cost time: 0.7744476795196533
Epoch: 26, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 27 cost time: 0.810551643371582
Epoch: 27, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 28 cost time: 0.7164466381072998
Epoch: 28, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.866 Vali Acc: 0.750 Test Loss: 0.866 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 29 cost time: 0.7301120758056641
Epoch: 29, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.867 Vali Acc: 0.725 Test Loss: 0.867 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7081303596496582
Epoch: 30, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.872 Vali Acc: 0.725 Test Loss: 0.872 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7642152309417725
Epoch: 31, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.677436113357544
Epoch: 32, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.880 Vali Acc: 0.725 Test Loss: 0.880 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6825971603393555
Epoch: 33, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.884 Vali Acc: 0.725 Test Loss: 0.884 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7760398387908936
Epoch: 34, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.887 Vali Acc: 0.725 Test Loss: 0.887 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6133594512939453
Epoch: 35, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.888 Vali Acc: 0.725 Test Loss: 0.888 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7153947353363037
Epoch: 36, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.888 Vali Acc: 0.725 Test Loss: 0.888 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7103359699249268
Epoch: 37, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.888 Vali Acc: 0.725 Test Loss: 0.888 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7189836502075195
Epoch: 38, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.887 Vali Acc: 0.750 Test Loss: 0.887 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 82596
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.484314203262329
Epoch: 1, Steps: 3 | Train Loss: 1.519 Vali Loss: 1.371 Vali Acc: 0.225 Test Loss: 1.371 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.7234756946563721
Epoch: 2, Steps: 3 | Train Loss: 1.572 Vali Loss: 1.353 Vali Acc: 0.250 Test Loss: 1.353 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.723304033279419
Epoch: 3, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.334 Vali Acc: 0.225 Test Loss: 1.334 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8228328227996826
Epoch: 4, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.309 Vali Acc: 0.225 Test Loss: 1.309 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7102761268615723
Epoch: 5, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.282 Vali Acc: 0.350 Test Loss: 1.282 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.6744472980499268
Epoch: 6, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.254 Vali Acc: 0.450 Test Loss: 1.254 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.7328078746795654
Epoch: 7, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.229 Vali Acc: 0.475 Test Loss: 1.229 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.7108075618743896
Epoch: 8, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.206 Vali Acc: 0.475 Test Loss: 1.206 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.7565097808837891
Epoch: 9, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.677882194519043
Epoch: 10, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.160 Vali Acc: 0.525 Test Loss: 1.160 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.7649428844451904
Epoch: 11, Steps: 3 | Train Loss: 0.786 Vali Loss: 1.133 Vali Acc: 0.550 Test Loss: 1.133 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 0.7888684272766113
Epoch: 12, Steps: 3 | Train Loss: 0.723 Vali Loss: 1.113 Vali Acc: 0.550 Test Loss: 1.113 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 13 cost time: 0.6887798309326172
Epoch: 13, Steps: 3 | Train Loss: 0.664 Vali Loss: 1.085 Vali Acc: 0.575 Test Loss: 1.085 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 14 cost time: 0.7664411067962646
Epoch: 14, Steps: 3 | Train Loss: 0.579 Vali Loss: 1.052 Vali Acc: 0.625 Test Loss: 1.052 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.7053816318511963
Epoch: 15, Steps: 3 | Train Loss: 0.545 Vali Loss: 1.024 Vali Acc: 0.625 Test Loss: 1.024 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 16 cost time: 0.7870950698852539
Epoch: 16, Steps: 3 | Train Loss: 0.494 Vali Loss: 1.005 Vali Acc: 0.700 Test Loss: 1.005 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 0.7663335800170898
Epoch: 17, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.990 Vali Acc: 0.700 Test Loss: 0.990 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 0.7720575332641602
Epoch: 18, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.970 Vali Acc: 0.700 Test Loss: 0.970 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 19 cost time: 0.7138209342956543
Epoch: 19, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.958 Vali Acc: 0.700 Test Loss: 0.958 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.7451164722442627
Epoch: 20, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.939 Vali Acc: 0.700 Test Loss: 0.939 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 21 cost time: 0.7237882614135742
Epoch: 21, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.924 Vali Acc: 0.725 Test Loss: 0.924 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 22 cost time: 0.7355270385742188
Epoch: 22, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.908 Vali Acc: 0.750 Test Loss: 0.908 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 23 cost time: 0.7253215312957764
Epoch: 23, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 24 cost time: 0.7092568874359131
Epoch: 24, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.878 Vali Acc: 0.750 Test Loss: 0.878 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 25 cost time: 0.6263988018035889
Epoch: 25, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.870 Vali Acc: 0.775 Test Loss: 0.870 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 26 cost time: 0.8570337295532227
Epoch: 26, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.867 Vali Acc: 0.775 Test Loss: 0.867 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 27 cost time: 0.728588342666626
Epoch: 27, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.866 Vali Acc: 0.775 Test Loss: 0.866 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 28 cost time: 0.6916992664337158
Epoch: 28, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.868 Vali Acc: 0.775 Test Loss: 0.868 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7074158191680908
Epoch: 29, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6441349983215332
Epoch: 30, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.865 Vali Acc: 0.750 Test Loss: 0.865 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6778955459594727
Epoch: 31, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.858 Vali Acc: 0.775 Test Loss: 0.858 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 32 cost time: 0.7846136093139648
Epoch: 32, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.851 Vali Acc: 0.775 Test Loss: 0.851 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 33 cost time: 0.6760621070861816
Epoch: 33, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.846 Vali Acc: 0.775 Test Loss: 0.846 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 34 cost time: 0.7363364696502686
Epoch: 34, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.843 Vali Acc: 0.775 Test Loss: 0.843 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 35 cost time: 0.6758739948272705
Epoch: 35, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.845 Vali Acc: 0.775 Test Loss: 0.845 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7257072925567627
Epoch: 36, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7860193252563477
Epoch: 37, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6827781200408936
Epoch: 38, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.851 Vali Acc: 0.750 Test Loss: 0.851 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7212564945220947
Epoch: 39, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.852 Vali Acc: 0.750 Test Loss: 0.852 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7008111476898193
Epoch: 40, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7447688579559326
Epoch: 41, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.845 Vali Acc: 0.750 Test Loss: 0.845 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6631467342376709
Epoch: 42, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.842 Vali Acc: 0.750 Test Loss: 0.842 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7680740356445312
Epoch: 43, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 44 cost time: 0.7066996097564697
Epoch: 44, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 45 cost time: 0.6339111328125
Epoch: 45, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.829 Vali Acc: 0.775 Test Loss: 0.829 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 46 cost time: 0.689206600189209
Epoch: 46, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.825 Vali Acc: 0.775 Test Loss: 0.825 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 47 cost time: 0.7587869167327881
Epoch: 47, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.820 Vali Acc: 0.775 Test Loss: 0.820 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 48 cost time: 0.6691064834594727
Epoch: 48, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.817 Vali Acc: 0.775 Test Loss: 0.817 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 49 cost time: 0.667626142501831
Epoch: 49, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.815 Vali Acc: 0.775 Test Loss: 0.815 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 50 cost time: 0.6309826374053955
Epoch: 50, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 51 cost time: 0.6514041423797607
Epoch: 51, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6825275421142578
Epoch: 52, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6454207897186279
Epoch: 53, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.814 Vali Acc: 0.775 Test Loss: 0.814 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6640529632568359
Epoch: 54, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.814 Vali Acc: 0.775 Test Loss: 0.814 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.7621278762817383
Epoch: 55, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.814 Vali Acc: 0.775 Test Loss: 0.814 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.6496295928955078
Epoch: 56, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.814 Vali Acc: 0.775 Test Loss: 0.814 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.6832053661346436
Epoch: 57, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.817 Vali Acc: 0.775 Test Loss: 0.817 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.7027883529663086
Epoch: 58, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.817 Vali Acc: 0.775 Test Loss: 0.817 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.7331435680389404
Epoch: 59, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.817 Vali Acc: 0.775 Test Loss: 0.817 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.6786813735961914
Epoch: 60, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.818 Vali Acc: 0.775 Test Loss: 0.818 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 78820
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2187252044677734
Epoch: 1, Steps: 3 | Train Loss: 1.548 Vali Loss: 1.561 Vali Acc: 0.225 Test Loss: 1.561 Test Acc: 0.225
Validation loss decreased (inf --> -0.224984).  Saving model ...
Epoch: 2 cost time: 0.6825075149536133
Epoch: 2, Steps: 3 | Train Loss: 1.528 Vali Loss: 1.534 Vali Acc: 0.250 Test Loss: 1.534 Test Acc: 0.250
Validation loss decreased (-0.224984 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.5960590839385986
Epoch: 3, Steps: 3 | Train Loss: 1.576 Vali Loss: 1.515 Vali Acc: 0.275 Test Loss: 1.515 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 0.6959891319274902
Epoch: 4, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.495 Vali Acc: 0.275 Test Loss: 1.495 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 5 cost time: 0.6669578552246094
Epoch: 5, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.473 Vali Acc: 0.275 Test Loss: 1.473 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 6 cost time: 0.6429147720336914
Epoch: 6, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.448 Vali Acc: 0.275 Test Loss: 1.448 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 0.6847810745239258
Epoch: 7, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.420 Vali Acc: 0.275 Test Loss: 1.420 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 8 cost time: 0.6514256000518799
Epoch: 8, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.395 Vali Acc: 0.300 Test Loss: 1.395 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 9 cost time: 0.7441082000732422
Epoch: 9, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.365 Vali Acc: 0.350 Test Loss: 1.365 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 10 cost time: 0.73050856590271
Epoch: 10, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.340 Vali Acc: 0.350 Test Loss: 1.340 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 11 cost time: 0.6477200984954834
Epoch: 11, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.316 Vali Acc: 0.400 Test Loss: 1.316 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.6543102264404297
Epoch: 12, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.294 Vali Acc: 0.400 Test Loss: 1.294 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 0.6589100360870361
Epoch: 13, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.273 Vali Acc: 0.475 Test Loss: 1.273 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 14 cost time: 0.7202835083007812
Epoch: 14, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.255 Vali Acc: 0.475 Test Loss: 1.255 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 15 cost time: 0.8681223392486572
Epoch: 15, Steps: 3 | Train Loss: 0.815 Vali Loss: 1.238 Vali Acc: 0.525 Test Loss: 1.238 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.6816887855529785
Epoch: 16, Steps: 3 | Train Loss: 0.765 Vali Loss: 1.221 Vali Acc: 0.525 Test Loss: 1.221 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.7078907489776611
Epoch: 17, Steps: 3 | Train Loss: 0.725 Vali Loss: 1.201 Vali Acc: 0.600 Test Loss: 1.201 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 18 cost time: 0.6694228649139404
Epoch: 18, Steps: 3 | Train Loss: 0.642 Vali Loss: 1.185 Vali Acc: 0.600 Test Loss: 1.185 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 19 cost time: 0.7088675498962402
Epoch: 19, Steps: 3 | Train Loss: 0.498 Vali Loss: 1.165 Vali Acc: 0.600 Test Loss: 1.165 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 20 cost time: 0.7930397987365723
Epoch: 20, Steps: 3 | Train Loss: 0.539 Vali Loss: 1.149 Vali Acc: 0.600 Test Loss: 1.149 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 0.7019250392913818
Epoch: 21, Steps: 3 | Train Loss: 0.507 Vali Loss: 1.133 Vali Acc: 0.625 Test Loss: 1.133 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 22 cost time: 0.8172869682312012
Epoch: 22, Steps: 3 | Train Loss: 0.466 Vali Loss: 1.120 Vali Acc: 0.625 Test Loss: 1.120 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.6996943950653076
Epoch: 23, Steps: 3 | Train Loss: 0.384 Vali Loss: 1.104 Vali Acc: 0.625 Test Loss: 1.104 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 24 cost time: 0.7015464305877686
Epoch: 24, Steps: 3 | Train Loss: 0.325 Vali Loss: 1.091 Vali Acc: 0.625 Test Loss: 1.091 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 25 cost time: 0.6436779499053955
Epoch: 25, Steps: 3 | Train Loss: 0.274 Vali Loss: 1.074 Vali Acc: 0.625 Test Loss: 1.074 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 26 cost time: 0.6807975769042969
Epoch: 26, Steps: 3 | Train Loss: 0.286 Vali Loss: 1.058 Vali Acc: 0.650 Test Loss: 1.058 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 27 cost time: 0.6712944507598877
Epoch: 27, Steps: 3 | Train Loss: 0.249 Vali Loss: 1.039 Vali Acc: 0.650 Test Loss: 1.039 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 28 cost time: 0.6778943538665771
Epoch: 28, Steps: 3 | Train Loss: 0.188 Vali Loss: 1.030 Vali Acc: 0.650 Test Loss: 1.030 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 29 cost time: 0.6999876499176025
Epoch: 29, Steps: 3 | Train Loss: 0.172 Vali Loss: 1.027 Vali Acc: 0.650 Test Loss: 1.027 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 30 cost time: 0.7413902282714844
Epoch: 30, Steps: 3 | Train Loss: 0.159 Vali Loss: 1.029 Vali Acc: 0.625 Test Loss: 1.029 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6192278861999512
Epoch: 31, Steps: 3 | Train Loss: 0.139 Vali Loss: 1.033 Vali Acc: 0.625 Test Loss: 1.033 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6470673084259033
Epoch: 32, Steps: 3 | Train Loss: 0.124 Vali Loss: 1.037 Vali Acc: 0.650 Test Loss: 1.037 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.691049337387085
Epoch: 33, Steps: 3 | Train Loss: 0.111 Vali Loss: 1.041 Vali Acc: 0.675 Test Loss: 1.041 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 34 cost time: 0.7145004272460938
Epoch: 34, Steps: 3 | Train Loss: 0.115 Vali Loss: 1.048 Vali Acc: 0.675 Test Loss: 1.048 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7598509788513184
Epoch: 35, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7338333129882812
Epoch: 36, Steps: 3 | Train Loss: 0.095 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6712114810943604
Epoch: 37, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.683300256729126
Epoch: 38, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.043 Vali Acc: 0.675 Test Loss: 1.043 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5691266059875488
Epoch: 39, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.042 Vali Acc: 0.675 Test Loss: 1.042 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6537117958068848
Epoch: 40, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.045 Vali Acc: 0.675 Test Loss: 1.045 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7245497703552246
Epoch: 41, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.049 Vali Acc: 0.675 Test Loss: 1.049 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7088713645935059
Epoch: 42, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.678753137588501
Epoch: 43, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.055 Vali Acc: 0.675 Test Loss: 1.055 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 72836
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.370790958404541
Epoch: 1, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.504 Vali Acc: 0.200 Test Loss: 1.504 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.6170089244842529
Epoch: 2, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.496 Vali Acc: 0.250 Test Loss: 1.496 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.782987117767334
Epoch: 3, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.484 Vali Acc: 0.250 Test Loss: 1.484 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 0.6909551620483398
Epoch: 4, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.470 Vali Acc: 0.250 Test Loss: 1.470 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 5 cost time: 0.6765339374542236
Epoch: 5, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.452 Vali Acc: 0.250 Test Loss: 1.452 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 6 cost time: 0.6711881160736084
Epoch: 6, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.430 Vali Acc: 0.275 Test Loss: 1.430 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 0.7961206436157227
Epoch: 7, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.407 Vali Acc: 0.300 Test Loss: 1.407 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 8 cost time: 0.736774206161499
Epoch: 8, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.383 Vali Acc: 0.350 Test Loss: 1.383 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.7340695858001709
Epoch: 9, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.361 Vali Acc: 0.375 Test Loss: 1.361 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 10 cost time: 0.676626443862915
Epoch: 10, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.338 Vali Acc: 0.375 Test Loss: 1.338 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 11 cost time: 0.8378396034240723
Epoch: 11, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.318 Vali Acc: 0.450 Test Loss: 1.318 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.7392592430114746
Epoch: 12, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.296 Vali Acc: 0.475 Test Loss: 1.296 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 13 cost time: 0.6861617565155029
Epoch: 13, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 0.7654528617858887
Epoch: 14, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.254 Vali Acc: 0.450 Test Loss: 1.254 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7612488269805908
Epoch: 15, Steps: 3 | Train Loss: 0.729 Vali Loss: 1.240 Vali Acc: 0.450 Test Loss: 1.240 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.736414909362793
Epoch: 16, Steps: 3 | Train Loss: 0.681 Vali Loss: 1.226 Vali Acc: 0.450 Test Loss: 1.226 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7952497005462646
Epoch: 17, Steps: 3 | Train Loss: 0.610 Vali Loss: 1.213 Vali Acc: 0.450 Test Loss: 1.213 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7969512939453125
Epoch: 18, Steps: 3 | Train Loss: 0.699 Vali Loss: 1.197 Vali Acc: 0.450 Test Loss: 1.197 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7457342147827148
Epoch: 19, Steps: 3 | Train Loss: 0.587 Vali Loss: 1.184 Vali Acc: 0.475 Test Loss: 1.184 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.820932149887085
Epoch: 20, Steps: 3 | Train Loss: 0.543 Vali Loss: 1.168 Vali Acc: 0.550 Test Loss: 1.168 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 21 cost time: 0.8033182621002197
Epoch: 21, Steps: 3 | Train Loss: 0.492 Vali Loss: 1.154 Vali Acc: 0.575 Test Loss: 1.154 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 22 cost time: 0.7238631248474121
Epoch: 22, Steps: 3 | Train Loss: 0.378 Vali Loss: 1.142 Vali Acc: 0.575 Test Loss: 1.142 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 23 cost time: 0.9366631507873535
Epoch: 23, Steps: 3 | Train Loss: 0.397 Vali Loss: 1.127 Vali Acc: 0.625 Test Loss: 1.127 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 24 cost time: 0.7925858497619629
Epoch: 24, Steps: 3 | Train Loss: 0.362 Vali Loss: 1.113 Vali Acc: 0.625 Test Loss: 1.113 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 25 cost time: 0.7331390380859375
Epoch: 25, Steps: 3 | Train Loss: 0.324 Vali Loss: 1.103 Vali Acc: 0.650 Test Loss: 1.103 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 26 cost time: 0.7828929424285889
Epoch: 26, Steps: 3 | Train Loss: 0.268 Vali Loss: 1.096 Vali Acc: 0.675 Test Loss: 1.096 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 27 cost time: 0.7436227798461914
Epoch: 27, Steps: 3 | Train Loss: 0.278 Vali Loss: 1.089 Vali Acc: 0.725 Test Loss: 1.089 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 28 cost time: 0.6795859336853027
Epoch: 28, Steps: 3 | Train Loss: 0.226 Vali Loss: 1.080 Vali Acc: 0.725 Test Loss: 1.080 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 29 cost time: 0.7435050010681152
Epoch: 29, Steps: 3 | Train Loss: 0.191 Vali Loss: 1.071 Vali Acc: 0.725 Test Loss: 1.071 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 30 cost time: 0.7456824779510498
Epoch: 30, Steps: 3 | Train Loss: 0.195 Vali Loss: 1.066 Vali Acc: 0.725 Test Loss: 1.066 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 31 cost time: 0.7551882266998291
Epoch: 31, Steps: 3 | Train Loss: 0.180 Vali Loss: 1.060 Vali Acc: 0.725 Test Loss: 1.060 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 32 cost time: 0.7915277481079102
Epoch: 32, Steps: 3 | Train Loss: 0.163 Vali Loss: 1.055 Vali Acc: 0.725 Test Loss: 1.055 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 33 cost time: 0.7288858890533447
Epoch: 33, Steps: 3 | Train Loss: 0.149 Vali Loss: 1.046 Vali Acc: 0.725 Test Loss: 1.046 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 34 cost time: 0.7151672840118408
Epoch: 34, Steps: 3 | Train Loss: 0.117 Vali Loss: 1.039 Vali Acc: 0.725 Test Loss: 1.039 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 35 cost time: 0.748762845993042
Epoch: 35, Steps: 3 | Train Loss: 0.123 Vali Loss: 1.034 Vali Acc: 0.725 Test Loss: 1.034 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 36 cost time: 0.7097084522247314
Epoch: 36, Steps: 3 | Train Loss: 0.105 Vali Loss: 1.029 Vali Acc: 0.725 Test Loss: 1.029 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 37 cost time: 0.6512603759765625
Epoch: 37, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.024 Vali Acc: 0.725 Test Loss: 1.024 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 38 cost time: 0.7596333026885986
Epoch: 38, Steps: 3 | Train Loss: 0.081 Vali Loss: 1.015 Vali Acc: 0.725 Test Loss: 1.015 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 39 cost time: 0.7234148979187012
Epoch: 39, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.013 Vali Acc: 0.725 Test Loss: 1.013 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 40 cost time: 0.6843400001525879
Epoch: 40, Steps: 3 | Train Loss: 0.070 Vali Loss: 1.011 Vali Acc: 0.725 Test Loss: 1.011 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 41 cost time: 0.7179207801818848
Epoch: 41, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.006 Vali Acc: 0.725 Test Loss: 1.006 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 42 cost time: 0.5716502666473389
Epoch: 42, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.003 Vali Acc: 0.725 Test Loss: 1.003 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 43 cost time: 0.6822116374969482
Epoch: 43, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.003 Vali Acc: 0.725 Test Loss: 1.003 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 44 cost time: 0.6954493522644043
Epoch: 44, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.999 Vali Acc: 0.725 Test Loss: 0.999 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 45 cost time: 0.6716282367706299
Epoch: 45, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.993 Vali Acc: 0.725 Test Loss: 0.993 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 46 cost time: 0.7089259624481201
Epoch: 46, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.989 Vali Acc: 0.725 Test Loss: 0.989 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 47 cost time: 0.732609748840332
Epoch: 47, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.984 Vali Acc: 0.725 Test Loss: 0.984 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 48 cost time: 0.7561969757080078
Epoch: 48, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.981 Vali Acc: 0.725 Test Loss: 0.981 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 49 cost time: 0.597968339920044
Epoch: 49, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.977 Vali Acc: 0.725 Test Loss: 0.977 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 50 cost time: 0.8494994640350342
Epoch: 50, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.976 Vali Acc: 0.725 Test Loss: 0.976 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 51 cost time: 0.6923177242279053
Epoch: 51, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.978 Vali Acc: 0.725 Test Loss: 0.978 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7987358570098877
Epoch: 52, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.977 Vali Acc: 0.725 Test Loss: 0.977 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.8063039779663086
Epoch: 53, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.975 Vali Acc: 0.725 Test Loss: 0.975 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 54 cost time: 0.6246335506439209
Epoch: 54, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.971 Vali Acc: 0.725 Test Loss: 0.971 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 55 cost time: 0.640181303024292
Epoch: 55, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.968 Vali Acc: 0.725 Test Loss: 0.968 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 56 cost time: 0.6862080097198486
Epoch: 56, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 57 cost time: 0.6478116512298584
Epoch: 57, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6768174171447754
Epoch: 58, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.968 Vali Acc: 0.725 Test Loss: 0.968 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.6146881580352783
Epoch: 59, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.965 Vali Acc: 0.725 Test Loss: 0.965 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 60 cost time: 0.6309630870819092
Epoch: 60, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.967 Vali Acc: 0.725 Test Loss: 0.967 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6583242416381836
Epoch: 61, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.964 Vali Acc: 0.725 Test Loss: 0.964 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 62 cost time: 0.5908157825469971
Epoch: 62, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.960 Vali Acc: 0.725 Test Loss: 0.960 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 63 cost time: 0.8459196090698242
Epoch: 63, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.957 Vali Acc: 0.725 Test Loss: 0.957 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 64 cost time: 0.7677099704742432
Epoch: 64, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.950 Vali Acc: 0.725 Test Loss: 0.950 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 65 cost time: 0.6688017845153809
Epoch: 65, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.952 Vali Acc: 0.725 Test Loss: 0.952 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7556247711181641
Epoch: 66, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.951 Vali Acc: 0.725 Test Loss: 0.951 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.6670336723327637
Epoch: 67, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.951 Vali Acc: 0.725 Test Loss: 0.951 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.6877079010009766
Epoch: 68, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.952 Vali Acc: 0.725 Test Loss: 0.952 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.6970572471618652
Epoch: 69, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.952 Vali Acc: 0.725 Test Loss: 0.952 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.6846325397491455
Epoch: 70, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.951 Vali Acc: 0.725 Test Loss: 0.951 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.7331316471099854
Epoch: 71, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.949 Vali Acc: 0.725 Test Loss: 0.949 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 72 cost time: 0.6925199031829834
Epoch: 72, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 73 cost time: 0.6949923038482666
Epoch: 73, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 74 cost time: 0.742006778717041
Epoch: 74, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 75 cost time: 0.7340819835662842
Epoch: 75, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.934 Vali Acc: 0.750 Test Loss: 0.934 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 76 cost time: 0.6975605487823486
Epoch: 76, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 77 cost time: 0.743044376373291
Epoch: 77, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 78 cost time: 0.7600078582763672
Epoch: 78, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7615451812744141
Epoch: 79, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.7408764362335205
Epoch: 80, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.935 Vali Acc: 0.750 Test Loss: 0.935 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.7204864025115967
Epoch: 81, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.935 Vali Acc: 0.750 Test Loss: 0.935 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.7269625663757324
Epoch: 82, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.935 Vali Acc: 0.750 Test Loss: 0.935 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.743579626083374
Epoch: 83, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.936 Vali Acc: 0.750 Test Loss: 0.936 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.698401689529419
Epoch: 84, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.7344279289245605
Epoch: 85, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.939 Vali Acc: 0.750 Test Loss: 0.939 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.7617082595825195
Epoch: 86, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.937 Vali Acc: 0.750 Test Loss: 0.937 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.7245588302612305
Epoch: 87, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.934 Vali Acc: 0.750 Test Loss: 0.934 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 71460
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3225629329681396
Epoch: 1, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.400 Vali Acc: 0.350 Test Loss: 1.400 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.6390559673309326
Epoch: 2, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.369 Vali Acc: 0.350 Test Loss: 1.369 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.6313159465789795
Epoch: 3, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.6178250312805176
Epoch: 4, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.328 Vali Acc: 0.425 Test Loss: 1.328 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.7150249481201172
Epoch: 5, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.311 Vali Acc: 0.450 Test Loss: 1.311 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.5795412063598633
Epoch: 6, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.296 Vali Acc: 0.500 Test Loss: 1.296 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.7304046154022217
Epoch: 7, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.7256669998168945
Epoch: 8, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.265 Vali Acc: 0.525 Test Loss: 1.265 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 0.6583752632141113
Epoch: 9, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.252 Vali Acc: 0.525 Test Loss: 1.252 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 0.6776926517486572
Epoch: 10, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.239 Vali Acc: 0.525 Test Loss: 1.239 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.6740806102752686
Epoch: 11, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.227 Vali Acc: 0.525 Test Loss: 1.227 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 0.6005215644836426
Epoch: 12, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.213 Vali Acc: 0.525 Test Loss: 1.213 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 0.7198114395141602
Epoch: 13, Steps: 3 | Train Loss: 0.833 Vali Loss: 1.200 Vali Acc: 0.525 Test Loss: 1.200 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 0.6566112041473389
Epoch: 14, Steps: 3 | Train Loss: 0.793 Vali Loss: 1.186 Vali Acc: 0.525 Test Loss: 1.186 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 0.699249267578125
Epoch: 15, Steps: 3 | Train Loss: 0.756 Vali Loss: 1.174 Vali Acc: 0.525 Test Loss: 1.174 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.6618468761444092
Epoch: 16, Steps: 3 | Train Loss: 0.800 Vali Loss: 1.164 Vali Acc: 0.575 Test Loss: 1.164 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 17 cost time: 0.6733293533325195
Epoch: 17, Steps: 3 | Train Loss: 0.638 Vali Loss: 1.154 Vali Acc: 0.575 Test Loss: 1.154 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 18 cost time: 0.6565139293670654
Epoch: 18, Steps: 3 | Train Loss: 0.639 Vali Loss: 1.147 Vali Acc: 0.575 Test Loss: 1.147 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 19 cost time: 0.7006683349609375
Epoch: 19, Steps: 3 | Train Loss: 0.538 Vali Loss: 1.139 Vali Acc: 0.575 Test Loss: 1.139 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 20 cost time: 0.716301679611206
Epoch: 20, Steps: 3 | Train Loss: 0.546 Vali Loss: 1.133 Vali Acc: 0.525 Test Loss: 1.133 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.659027099609375
Epoch: 21, Steps: 3 | Train Loss: 0.494 Vali Loss: 1.124 Vali Acc: 0.525 Test Loss: 1.124 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6441302299499512
Epoch: 22, Steps: 3 | Train Loss: 0.502 Vali Loss: 1.117 Vali Acc: 0.550 Test Loss: 1.117 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6795234680175781
Epoch: 23, Steps: 3 | Train Loss: 0.417 Vali Loss: 1.110 Vali Acc: 0.550 Test Loss: 1.110 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5731120109558105
Epoch: 24, Steps: 3 | Train Loss: 0.395 Vali Loss: 1.099 Vali Acc: 0.600 Test Loss: 1.099 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 0.5344536304473877
Epoch: 25, Steps: 3 | Train Loss: 0.337 Vali Loss: 1.094 Vali Acc: 0.600 Test Loss: 1.094 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 0.6544721126556396
Epoch: 26, Steps: 3 | Train Loss: 0.326 Vali Loss: 1.090 Vali Acc: 0.600 Test Loss: 1.090 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 0.6780729293823242
Epoch: 27, Steps: 3 | Train Loss: 0.286 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 28 cost time: 0.6904995441436768
Epoch: 28, Steps: 3 | Train Loss: 0.276 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 29 cost time: 0.6198852062225342
Epoch: 29, Steps: 3 | Train Loss: 0.243 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 30 cost time: 0.6320979595184326
Epoch: 30, Steps: 3 | Train Loss: 0.255 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 31 cost time: 0.6940619945526123
Epoch: 31, Steps: 3 | Train Loss: 0.207 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 32 cost time: 0.6538252830505371
Epoch: 32, Steps: 3 | Train Loss: 0.192 Vali Loss: 1.040 Vali Acc: 0.625 Test Loss: 1.040 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 33 cost time: 0.7540481090545654
Epoch: 33, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.039 Vali Acc: 0.625 Test Loss: 1.039 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 34 cost time: 0.6049058437347412
Epoch: 34, Steps: 3 | Train Loss: 0.182 Vali Loss: 1.035 Vali Acc: 0.650 Test Loss: 1.035 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 35 cost time: 0.7030389308929443
Epoch: 35, Steps: 3 | Train Loss: 0.145 Vali Loss: 1.035 Vali Acc: 0.650 Test Loss: 1.035 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 36 cost time: 0.7093515396118164
Epoch: 36, Steps: 3 | Train Loss: 0.120 Vali Loss: 1.030 Vali Acc: 0.650 Test Loss: 1.030 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 37 cost time: 0.7421317100524902
Epoch: 37, Steps: 3 | Train Loss: 0.111 Vali Loss: 1.026 Vali Acc: 0.650 Test Loss: 1.026 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 38 cost time: 0.6546516418457031
Epoch: 38, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.017 Vali Acc: 0.650 Test Loss: 1.017 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 39 cost time: 0.6981847286224365
Epoch: 39, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.014 Vali Acc: 0.650 Test Loss: 1.014 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 40 cost time: 0.7346587181091309
Epoch: 40, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.012 Vali Acc: 0.650 Test Loss: 1.012 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 41 cost time: 0.6786808967590332
Epoch: 41, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.012 Vali Acc: 0.650 Test Loss: 1.012 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 42 cost time: 0.6475727558135986
Epoch: 42, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.007 Vali Acc: 0.650 Test Loss: 1.007 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 43 cost time: 0.6899614334106445
Epoch: 43, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.002 Vali Acc: 0.650 Test Loss: 1.002 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 44 cost time: 0.756054162979126
Epoch: 44, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.000 Vali Acc: 0.650 Test Loss: 1.000 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 45 cost time: 0.6135399341583252
Epoch: 45, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.997 Vali Acc: 0.650 Test Loss: 0.997 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 46 cost time: 0.7938072681427002
Epoch: 46, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.996 Vali Acc: 0.675 Test Loss: 0.996 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 47 cost time: 0.6987791061401367
Epoch: 47, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.993 Vali Acc: 0.675 Test Loss: 0.993 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 48 cost time: 0.7335801124572754
Epoch: 48, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.994 Vali Acc: 0.675 Test Loss: 0.994 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6528406143188477
Epoch: 49, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.988 Vali Acc: 0.675 Test Loss: 0.988 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 50 cost time: 0.7403156757354736
Epoch: 50, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.983 Vali Acc: 0.675 Test Loss: 0.983 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 51 cost time: 0.6919987201690674
Epoch: 51, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.979 Vali Acc: 0.675 Test Loss: 0.979 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 52 cost time: 0.6554248332977295
Epoch: 52, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.980 Vali Acc: 0.675 Test Loss: 0.980 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6770508289337158
Epoch: 53, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.978 Vali Acc: 0.675 Test Loss: 0.978 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 54 cost time: 0.6341357231140137
Epoch: 54, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.975 Vali Acc: 0.675 Test Loss: 0.975 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 55 cost time: 0.6897015571594238
Epoch: 55, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.969 Vali Acc: 0.675 Test Loss: 0.969 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 56 cost time: 0.6652224063873291
Epoch: 56, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.964 Vali Acc: 0.675 Test Loss: 0.964 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 57 cost time: 0.6628360748291016
Epoch: 57, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.964 Vali Acc: 0.650 Test Loss: 0.964 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7057042121887207
Epoch: 58, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.959 Vali Acc: 0.650 Test Loss: 0.959 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.6640951633453369
Epoch: 59, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.967 Vali Acc: 0.650 Test Loss: 0.967 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7138845920562744
Epoch: 60, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.963 Vali Acc: 0.650 Test Loss: 0.963 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.5921266078948975
Epoch: 61, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.965 Vali Acc: 0.650 Test Loss: 0.965 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9445681571960449
Epoch: 62, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.968 Vali Acc: 0.650 Test Loss: 0.968 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.6932742595672607
Epoch: 63, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.962 Vali Acc: 0.675 Test Loss: 0.962 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 64 cost time: 0.6148288249969482
Epoch: 64, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.964 Vali Acc: 0.675 Test Loss: 0.964 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6549901962280273
Epoch: 65, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.957 Vali Acc: 0.675 Test Loss: 0.957 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 66 cost time: 0.616689920425415
Epoch: 66, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.950 Vali Acc: 0.675 Test Loss: 0.950 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 67 cost time: 0.6138813495635986
Epoch: 67, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.959 Vali Acc: 0.675 Test Loss: 0.959 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6233811378479004
Epoch: 68, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.970 Vali Acc: 0.675 Test Loss: 0.970 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6671884059906006
Epoch: 69, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.966 Vali Acc: 0.675 Test Loss: 0.966 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.6085717678070068
Epoch: 70, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.959 Vali Acc: 0.675 Test Loss: 0.959 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.6436738967895508
Epoch: 71, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.955 Vali Acc: 0.675 Test Loss: 0.955 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.5919013023376465
Epoch: 72, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.953 Vali Acc: 0.675 Test Loss: 0.953 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.7096941471099854
Epoch: 73, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.955 Vali Acc: 0.650 Test Loss: 0.955 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.5628068447113037
Epoch: 74, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.950 Vali Acc: 0.675 Test Loss: 0.950 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 75 cost time: 0.5811820030212402
Epoch: 75, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.955 Vali Acc: 0.650 Test Loss: 0.955 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7447421550750732
Epoch: 76, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.951 Vali Acc: 0.650 Test Loss: 0.951 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.6011919975280762
Epoch: 77, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.946 Vali Acc: 0.650 Test Loss: 0.946 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.5924029350280762
Epoch: 78, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.933 Vali Acc: 0.650 Test Loss: 0.933 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.6687095165252686
Epoch: 79, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.930 Vali Acc: 0.675 Test Loss: 0.930 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 80 cost time: 0.6738522052764893
Epoch: 80, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.935 Vali Acc: 0.675 Test Loss: 0.935 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.6667957305908203
Epoch: 81, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.937 Vali Acc: 0.675 Test Loss: 0.937 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.690711259841919
Epoch: 82, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.935 Vali Acc: 0.675 Test Loss: 0.935 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.6121389865875244
Epoch: 83, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.927 Vali Acc: 0.675 Test Loss: 0.927 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 84 cost time: 0.5968611240386963
Epoch: 84, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.930 Vali Acc: 0.675 Test Loss: 0.930 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.5761539936065674
Epoch: 85, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.928 Vali Acc: 0.675 Test Loss: 0.928 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.5900764465332031
Epoch: 86, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.927 Vali Acc: 0.675 Test Loss: 0.927 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.6904652118682861
Epoch: 87, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.919 Vali Acc: 0.675 Test Loss: 0.919 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 88 cost time: 0.5982809066772461
Epoch: 88, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.921 Vali Acc: 0.675 Test Loss: 0.921 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.7933478355407715
Epoch: 89, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.923 Vali Acc: 0.675 Test Loss: 0.923 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.6616835594177246
Epoch: 90, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.919 Vali Acc: 0.675 Test Loss: 0.919 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.7492921352386475
Epoch: 91, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.921 Vali Acc: 0.675 Test Loss: 0.921 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 0.7365353107452393
Epoch: 92, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.921 Vali Acc: 0.675 Test Loss: 0.921 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 0.6929516792297363
Epoch: 93, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.912 Vali Acc: 0.675 Test Loss: 0.912 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 94 cost time: 0.6922268867492676
Epoch: 94, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.909 Vali Acc: 0.675 Test Loss: 0.909 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 95 cost time: 0.7221686840057373
Epoch: 95, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.912 Vali Acc: 0.675 Test Loss: 0.912 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.7595546245574951
Epoch: 96, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.913 Vali Acc: 0.675 Test Loss: 0.913 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.8238525390625
Epoch: 97, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.905 Vali Acc: 0.675 Test Loss: 0.905 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 98 cost time: 0.7844164371490479
Epoch: 98, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.904 Vali Acc: 0.675 Test Loss: 0.904 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 99 cost time: 0.8664922714233398
Epoch: 99, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.910 Vali Acc: 0.675 Test Loss: 0.910 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.7490122318267822
Epoch: 100, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.909 Vali Acc: 0.675 Test Loss: 0.909 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df256_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 69316
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3378701210021973
Epoch: 1, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.345 Vali Acc: 0.350 Test Loss: 1.345 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.8068013191223145
Epoch: 2, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.314 Vali Acc: 0.350 Test Loss: 1.314 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.7903187274932861
Epoch: 3, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.274 Vali Acc: 0.425 Test Loss: 1.274 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.7185413837432861
Epoch: 4, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.227 Vali Acc: 0.450 Test Loss: 1.227 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 5 cost time: 0.8743908405303955
Epoch: 5, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.175 Vali Acc: 0.450 Test Loss: 1.175 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.8178026676177979
Epoch: 6, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
Validation loss decreased (-0.449988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.8409314155578613
Epoch: 7, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.075 Vali Acc: 0.675 Test Loss: 1.075 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.8529388904571533
Epoch: 8, Steps: 3 | Train Loss: 0.684 Vali Loss: 1.032 Vali Acc: 0.650 Test Loss: 1.032 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8507847785949707
Epoch: 9, Steps: 3 | Train Loss: 0.676 Vali Loss: 0.987 Vali Acc: 0.625 Test Loss: 0.987 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8540430068969727
Epoch: 10, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.971 Vali Acc: 0.650 Test Loss: 0.971 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8403208255767822
Epoch: 11, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.937 Vali Acc: 0.675 Test Loss: 0.937 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674991).  Saving model ...
Epoch: 12 cost time: 0.800234317779541
Epoch: 12, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.882 Vali Acc: 0.700 Test Loss: 0.882 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 0.8094913959503174
Epoch: 13, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 0.8549444675445557
Epoch: 14, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.7809028625488281
Epoch: 15, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.800 Vali Acc: 0.700 Test Loss: 0.800 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9257717132568359
Epoch: 16, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.791 Vali Acc: 0.700 Test Loss: 0.791 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7755718231201172
Epoch: 17, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.775 Vali Acc: 0.700 Test Loss: 0.775 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7465150356292725
Epoch: 18, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.772 Vali Acc: 0.700 Test Loss: 0.772 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7780795097351074
Epoch: 19, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.768 Vali Acc: 0.725 Test Loss: 0.768 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.87984299659729
Epoch: 20, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.763 Vali Acc: 0.725 Test Loss: 0.763 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8728969097137451
Epoch: 21, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.752 Vali Acc: 0.750 Test Loss: 0.752 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.8591229915618896
Epoch: 22, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.735 Vali Acc: 0.775 Test Loss: 0.735 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774993).  Saving model ...
Epoch: 23 cost time: 0.800792932510376
Epoch: 23, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.728 Vali Acc: 0.775 Test Loss: 0.728 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 24 cost time: 0.7990427017211914
Epoch: 24, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.731 Vali Acc: 0.775 Test Loss: 0.731 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7670204639434814
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8485226631164551
Epoch: 26, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.750 Vali Acc: 0.775 Test Loss: 0.750 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8484330177307129
Epoch: 27, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.760 Vali Acc: 0.775 Test Loss: 0.760 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7796881198883057
Epoch: 28, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.768 Vali Acc: 0.750 Test Loss: 0.768 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9147868156433105
Epoch: 29, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.773 Vali Acc: 0.750 Test Loss: 0.773 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7607040405273438
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.774 Vali Acc: 0.750 Test Loss: 0.774 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8642206192016602
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8072154521942139
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.763 Vali Acc: 0.775 Test Loss: 0.763 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7848992347717285
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 76676
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0292508602142334
Epoch: 1, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.307 Vali Acc: 0.375 Test Loss: 1.307 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.5731422901153564
Epoch: 2, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.277 Vali Acc: 0.450 Test Loss: 1.277 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.641075611114502
Epoch: 3, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.246 Vali Acc: 0.450 Test Loss: 1.246 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 4 cost time: 0.5858080387115479
Epoch: 4, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.205 Vali Acc: 0.475 Test Loss: 1.205 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 0.6318626403808594
Epoch: 5, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.164 Vali Acc: 0.475 Test Loss: 1.164 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.5740015506744385
Epoch: 6, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.7046854496002197
Epoch: 7, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.080 Vali Acc: 0.575 Test Loss: 1.080 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.7012219429016113
Epoch: 8, Steps: 3 | Train Loss: 0.735 Vali Loss: 1.043 Vali Acc: 0.675 Test Loss: 1.043 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 0.7372634410858154
Epoch: 9, Steps: 3 | Train Loss: 0.718 Vali Loss: 1.008 Vali Acc: 0.675 Test Loss: 1.008 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 10 cost time: 0.7393364906311035
Epoch: 10, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.976 Vali Acc: 0.675 Test Loss: 0.976 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.6258084774017334
Epoch: 11, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.948 Vali Acc: 0.675 Test Loss: 0.948 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 12 cost time: 0.6388757228851318
Epoch: 12, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.915 Vali Acc: 0.675 Test Loss: 0.915 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 13 cost time: 0.5947728157043457
Epoch: 13, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.880 Vali Acc: 0.700 Test Loss: 0.880 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 0.7360677719116211
Epoch: 14, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.847 Vali Acc: 0.725 Test Loss: 0.847 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724992).  Saving model ...
Epoch: 15 cost time: 0.6759850978851318
Epoch: 15, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.7892792224884033
Epoch: 16, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.792 Vali Acc: 0.725 Test Loss: 0.792 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.668036699295044
Epoch: 17, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.774 Vali Acc: 0.750 Test Loss: 0.774 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 0.7256083488464355
Epoch: 18, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.765 Vali Acc: 0.725 Test Loss: 0.765 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7640368938446045
Epoch: 19, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.758 Vali Acc: 0.725 Test Loss: 0.758 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6882269382476807
Epoch: 20, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.756 Vali Acc: 0.750 Test Loss: 0.756 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 0.7207741737365723
Epoch: 21, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.754 Vali Acc: 0.750 Test Loss: 0.754 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.6886701583862305
Epoch: 22, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.758 Vali Acc: 0.750 Test Loss: 0.758 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.622708797454834
Epoch: 23, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.766 Vali Acc: 0.725 Test Loss: 0.766 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6335129737854004
Epoch: 24, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.773 Vali Acc: 0.725 Test Loss: 0.773 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6149649620056152
Epoch: 25, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.772 Vali Acc: 0.725 Test Loss: 0.772 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6636338233947754
Epoch: 26, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.768 Vali Acc: 0.725 Test Loss: 0.768 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6565005779266357
Epoch: 27, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.762 Vali Acc: 0.725 Test Loss: 0.762 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.673607587814331
Epoch: 28, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.757 Vali Acc: 0.750 Test Loss: 0.757 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6725902557373047
Epoch: 29, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.751 Vali Acc: 0.750 Test Loss: 0.751 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 30 cost time: 0.6347095966339111
Epoch: 30, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 31 cost time: 0.6503498554229736
Epoch: 31, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 32 cost time: 0.7553448677062988
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6484177112579346
Epoch: 33, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.742 Vali Acc: 0.750 Test Loss: 0.742 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7676694393157959
Epoch: 34, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.740 Vali Acc: 0.750 Test Loss: 0.740 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 35 cost time: 0.7641410827636719
Epoch: 35, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.740 Vali Acc: 0.750 Test Loss: 0.740 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 36 cost time: 0.6828579902648926
Epoch: 36, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.740 Vali Acc: 0.750 Test Loss: 0.740 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7791433334350586
Epoch: 37, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.742 Vali Acc: 0.750 Test Loss: 0.742 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6466879844665527
Epoch: 38, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.719149112701416
Epoch: 39, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7211408615112305
Epoch: 40, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.742 Vali Acc: 0.750 Test Loss: 0.742 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7024335861206055
Epoch: 41, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.742 Vali Acc: 0.750 Test Loss: 0.742 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7858419418334961
Epoch: 42, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.740 Vali Acc: 0.750 Test Loss: 0.740 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7446236610412598
Epoch: 43, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6883354187011719
Epoch: 44, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.740 Vali Acc: 0.750 Test Loss: 0.740 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7222352027893066
Epoch: 45, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.740 Vali Acc: 0.750 Test Loss: 0.740 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 63684
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0856809616088867
Epoch: 1, Steps: 3 | Train Loss: 1.492 Vali Loss: 1.420 Vali Acc: 0.325 Test Loss: 1.420 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.6310124397277832
Epoch: 2, Steps: 3 | Train Loss: 1.545 Vali Loss: 1.396 Vali Acc: 0.325 Test Loss: 1.396 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.7063753604888916
Epoch: 3, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.365 Vali Acc: 0.375 Test Loss: 1.365 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.6466350555419922
Epoch: 4, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.6179916858673096
Epoch: 5, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.6233491897583008
Epoch: 6, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.252 Vali Acc: 0.425 Test Loss: 1.252 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.5795459747314453
Epoch: 7, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6774072647094727
Epoch: 8, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.176 Vali Acc: 0.425 Test Loss: 1.176 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 9 cost time: 0.5613949298858643
Epoch: 9, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.144 Vali Acc: 0.475 Test Loss: 1.144 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474989).  Saving model ...
Epoch: 10 cost time: 0.6108419895172119
Epoch: 10, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.106 Vali Acc: 0.550 Test Loss: 1.106 Test Acc: 0.550
Validation loss decreased (-0.474989 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 0.5967955589294434
Epoch: 11, Steps: 3 | Train Loss: 0.808 Vali Loss: 1.073 Vali Acc: 0.550 Test Loss: 1.073 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 0.6580328941345215
Epoch: 12, Steps: 3 | Train Loss: 0.720 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.5985205173492432
Epoch: 13, Steps: 3 | Train Loss: 0.596 Vali Loss: 1.002 Vali Acc: 0.625 Test Loss: 1.002 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 14 cost time: 0.7079596519470215
Epoch: 14, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.975 Vali Acc: 0.650 Test Loss: 0.975 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.6332879066467285
Epoch: 15, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.949 Vali Acc: 0.675 Test Loss: 0.949 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 16 cost time: 0.6435072422027588
Epoch: 16, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.929 Vali Acc: 0.675 Test Loss: 0.929 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 17 cost time: 0.6551251411437988
Epoch: 17, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.914 Vali Acc: 0.700 Test Loss: 0.914 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 0.6758263111114502
Epoch: 18, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.908 Vali Acc: 0.700 Test Loss: 0.908 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 19 cost time: 0.6844477653503418
Epoch: 19, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.910 Vali Acc: 0.700 Test Loss: 0.910 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6950020790100098
Epoch: 20, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.909 Vali Acc: 0.700 Test Loss: 0.909 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6842167377471924
Epoch: 21, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.907 Vali Acc: 0.675 Test Loss: 0.907 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7045376300811768
Epoch: 22, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.903 Vali Acc: 0.675 Test Loss: 0.903 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6256635189056396
Epoch: 23, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.897 Vali Acc: 0.700 Test Loss: 0.897 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 24 cost time: 0.6742336750030518
Epoch: 24, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.886 Vali Acc: 0.700 Test Loss: 0.886 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 25 cost time: 0.6833257675170898
Epoch: 25, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.873 Vali Acc: 0.725 Test Loss: 0.873 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 26 cost time: 0.7273316383361816
Epoch: 26, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.860 Vali Acc: 0.725 Test Loss: 0.860 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 27 cost time: 0.7018437385559082
Epoch: 27, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 28 cost time: 0.6026911735534668
Epoch: 28, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 29 cost time: 0.6776633262634277
Epoch: 29, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.855 Vali Acc: 0.725 Test Loss: 0.855 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7331900596618652
Epoch: 30, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.860 Vali Acc: 0.725 Test Loss: 0.860 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6210806369781494
Epoch: 31, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.866 Vali Acc: 0.725 Test Loss: 0.866 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.695512056350708
Epoch: 32, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.872 Vali Acc: 0.725 Test Loss: 0.872 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8314552307128906
Epoch: 33, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7055699825286865
Epoch: 34, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.877 Vali Acc: 0.725 Test Loss: 0.877 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6656334400177002
Epoch: 35, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.877 Vali Acc: 0.725 Test Loss: 0.877 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6821765899658203
Epoch: 36, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6667795181274414
Epoch: 37, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6842970848083496
Epoch: 38, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.875 Vali Acc: 0.725 Test Loss: 0.875 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 57636
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3042984008789062
Epoch: 1, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.563 Vali Acc: 0.300 Test Loss: 1.563 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.753751277923584
Epoch: 2, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.500 Vali Acc: 0.325 Test Loss: 1.500 Test Acc: 0.325
Validation loss decreased (-0.299984 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.6188175678253174
Epoch: 3, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.456 Vali Acc: 0.375 Test Loss: 1.456 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374985).  Saving model ...
Epoch: 4 cost time: 0.7042839527130127
Epoch: 4, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.419 Vali Acc: 0.450 Test Loss: 1.419 Test Acc: 0.450
Validation loss decreased (-0.374985 --> -0.449986).  Saving model ...
Epoch: 5 cost time: 0.6669130325317383
Epoch: 5, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.379 Vali Acc: 0.425 Test Loss: 1.379 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6831965446472168
Epoch: 6, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.345 Vali Acc: 0.425 Test Loss: 1.345 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.697991132736206
Epoch: 7, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6981086730957031
Epoch: 8, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7870039939880371
Epoch: 9, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.258 Vali Acc: 0.375 Test Loss: 1.258 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.66609787940979
Epoch: 10, Steps: 3 | Train Loss: 0.793 Vali Loss: 1.231 Vali Acc: 0.450 Test Loss: 1.231 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449988).  Saving model ...
Epoch: 11 cost time: 0.6331925392150879
Epoch: 11, Steps: 3 | Train Loss: 0.747 Vali Loss: 1.213 Vali Acc: 0.450 Test Loss: 1.213 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 12 cost time: 0.6346321105957031
Epoch: 12, Steps: 3 | Train Loss: 0.699 Vali Loss: 1.184 Vali Acc: 0.475 Test Loss: 1.184 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 0.7452607154846191
Epoch: 13, Steps: 3 | Train Loss: 0.644 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.6493725776672363
Epoch: 14, Steps: 3 | Train Loss: 0.510 Vali Loss: 1.130 Vali Acc: 0.550 Test Loss: 1.130 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 15 cost time: 0.7425892353057861
Epoch: 15, Steps: 3 | Train Loss: 0.482 Vali Loss: 1.105 Vali Acc: 0.550 Test Loss: 1.105 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 16 cost time: 0.6588077545166016
Epoch: 16, Steps: 3 | Train Loss: 0.390 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.6591172218322754
Epoch: 17, Steps: 3 | Train Loss: 0.451 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.7609438896179199
Epoch: 18, Steps: 3 | Train Loss: 0.372 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.7324297428131104
Epoch: 19, Steps: 3 | Train Loss: 0.292 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.6418516635894775
Epoch: 20, Steps: 3 | Train Loss: 0.227 Vali Loss: 1.014 Vali Acc: 0.625 Test Loss: 1.014 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 21 cost time: 0.7554464340209961
Epoch: 21, Steps: 3 | Train Loss: 0.228 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 22 cost time: 0.6554267406463623
Epoch: 22, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.008 Vali Acc: 0.625 Test Loss: 1.008 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7602341175079346
Epoch: 23, Steps: 3 | Train Loss: 0.166 Vali Loss: 1.019 Vali Acc: 0.625 Test Loss: 1.019 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5944204330444336
Epoch: 24, Steps: 3 | Train Loss: 0.139 Vali Loss: 1.027 Vali Acc: 0.625 Test Loss: 1.027 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7874295711517334
Epoch: 25, Steps: 3 | Train Loss: 0.095 Vali Loss: 1.021 Vali Acc: 0.625 Test Loss: 1.021 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6940252780914307
Epoch: 26, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.018 Vali Acc: 0.650 Test Loss: 1.018 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 27 cost time: 0.6508028507232666
Epoch: 27, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.022 Vali Acc: 0.650 Test Loss: 1.022 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5698018074035645
Epoch: 28, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.015 Vali Acc: 0.650 Test Loss: 1.015 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 29 cost time: 0.6267611980438232
Epoch: 29, Steps: 3 | Train Loss: 0.055 Vali Loss: 1.004 Vali Acc: 0.650 Test Loss: 1.004 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 30 cost time: 0.6562409400939941
Epoch: 30, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.990 Vali Acc: 0.650 Test Loss: 0.990 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 31 cost time: 0.7061293125152588
Epoch: 31, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.981 Vali Acc: 0.700 Test Loss: 0.981 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.6831614971160889
Epoch: 32, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.973 Vali Acc: 0.725 Test Loss: 0.973 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 33 cost time: 0.5891845226287842
Epoch: 33, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.965 Vali Acc: 0.725 Test Loss: 0.965 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 34 cost time: 0.7491228580474854
Epoch: 34, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.953 Vali Acc: 0.725 Test Loss: 0.953 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 35 cost time: 0.6553888320922852
Epoch: 35, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.948 Vali Acc: 0.725 Test Loss: 0.948 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 36 cost time: 0.6103060245513916
Epoch: 36, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.947 Vali Acc: 0.725 Test Loss: 0.947 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 37 cost time: 0.6136457920074463
Epoch: 37, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.943 Vali Acc: 0.725 Test Loss: 0.943 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 38 cost time: 0.6444859504699707
Epoch: 38, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.940 Vali Acc: 0.725 Test Loss: 0.940 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 39 cost time: 0.659353494644165
Epoch: 39, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.938 Vali Acc: 0.725 Test Loss: 0.938 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 40 cost time: 0.7150821685791016
Epoch: 40, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.940 Vali Acc: 0.725 Test Loss: 0.940 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6204185485839844
Epoch: 41, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.937 Vali Acc: 0.725 Test Loss: 0.937 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 42 cost time: 0.751178503036499
Epoch: 42, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.937 Vali Acc: 0.725 Test Loss: 0.937 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 43 cost time: 0.6066763401031494
Epoch: 43, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.937 Vali Acc: 0.725 Test Loss: 0.937 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6327347755432129
Epoch: 44, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.937 Vali Acc: 0.725 Test Loss: 0.937 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 45 cost time: 0.6559445858001709
Epoch: 45, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.937 Vali Acc: 0.725 Test Loss: 0.937 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6867570877075195
Epoch: 46, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.940 Vali Acc: 0.725 Test Loss: 0.940 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6641287803649902
Epoch: 47, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.941 Vali Acc: 0.725 Test Loss: 0.941 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6549949645996094
Epoch: 48, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.944 Vali Acc: 0.725 Test Loss: 0.944 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.700228214263916
Epoch: 49, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.947 Vali Acc: 0.725 Test Loss: 0.947 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7059438228607178
Epoch: 50, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.944 Vali Acc: 0.725 Test Loss: 0.944 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5905675888061523
Epoch: 51, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.943 Vali Acc: 0.725 Test Loss: 0.943 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.6500537395477295
Epoch: 52, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.937 Vali Acc: 0.725 Test Loss: 0.937 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.6796925067901611
Epoch: 53, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.934 Vali Acc: 0.725 Test Loss: 0.934 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 54 cost time: 0.6498768329620361
Epoch: 54, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.931 Vali Acc: 0.725 Test Loss: 0.931 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 55 cost time: 0.6714191436767578
Epoch: 55, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.929 Vali Acc: 0.725 Test Loss: 0.929 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 56 cost time: 0.6952364444732666
Epoch: 56, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.928 Vali Acc: 0.725 Test Loss: 0.928 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 57 cost time: 0.6756527423858643
Epoch: 57, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.928 Vali Acc: 0.725 Test Loss: 0.928 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 58 cost time: 0.7721357345581055
Epoch: 58, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.926 Vali Acc: 0.725 Test Loss: 0.926 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 59 cost time: 0.6719367504119873
Epoch: 59, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.928 Vali Acc: 0.725 Test Loss: 0.928 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7670962810516357
Epoch: 60, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.924 Vali Acc: 0.725 Test Loss: 0.924 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 61 cost time: 0.6726367473602295
Epoch: 61, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.924 Vali Acc: 0.725 Test Loss: 0.924 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6782701015472412
Epoch: 62, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.923 Vali Acc: 0.725 Test Loss: 0.923 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 63 cost time: 0.6943225860595703
Epoch: 63, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.922 Vali Acc: 0.725 Test Loss: 0.922 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 64 cost time: 0.6698451042175293
Epoch: 64, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.920 Vali Acc: 0.725 Test Loss: 0.920 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 65 cost time: 0.6798927783966064
Epoch: 65, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.919 Vali Acc: 0.725 Test Loss: 0.919 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 66 cost time: 0.787639856338501
Epoch: 66, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.917 Vali Acc: 0.725 Test Loss: 0.917 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 67 cost time: 0.719188928604126
Epoch: 67, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.920 Vali Acc: 0.725 Test Loss: 0.920 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7767355442047119
Epoch: 68, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.921 Vali Acc: 0.725 Test Loss: 0.921 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7141575813293457
Epoch: 69, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.919 Vali Acc: 0.725 Test Loss: 0.919 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.6858606338500977
Epoch: 70, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.918 Vali Acc: 0.725 Test Loss: 0.918 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.7477076053619385
Epoch: 71, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.921 Vali Acc: 0.725 Test Loss: 0.921 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.6676433086395264
Epoch: 72, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.923 Vali Acc: 0.725 Test Loss: 0.923 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.6933932304382324
Epoch: 73, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.922 Vali Acc: 0.725 Test Loss: 0.922 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.6515824794769287
Epoch: 74, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.920 Vali Acc: 0.725 Test Loss: 0.920 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.7526993751525879
Epoch: 75, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.921 Vali Acc: 0.725 Test Loss: 0.921 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6607210636138916
Epoch: 76, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.914 Vali Acc: 0.725 Test Loss: 0.914 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 77 cost time: 0.7556884288787842
Epoch: 77, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.916 Vali Acc: 0.725 Test Loss: 0.916 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.6698341369628906
Epoch: 78, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.912 Vali Acc: 0.725 Test Loss: 0.912 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 79 cost time: 0.7763040065765381
Epoch: 79, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.911 Vali Acc: 0.725 Test Loss: 0.911 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 80 cost time: 0.6966660022735596
Epoch: 80, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.911 Vali Acc: 0.725 Test Loss: 0.911 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 81 cost time: 0.703317403793335
Epoch: 81, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.906 Vali Acc: 0.725 Test Loss: 0.906 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 82 cost time: 0.66949462890625
Epoch: 82, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.905 Vali Acc: 0.725 Test Loss: 0.905 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 83 cost time: 0.78839111328125
Epoch: 83, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.904 Vali Acc: 0.725 Test Loss: 0.904 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 84 cost time: 0.5976254940032959
Epoch: 84, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.904 Vali Acc: 0.725 Test Loss: 0.904 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 85 cost time: 0.6969389915466309
Epoch: 85, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.906 Vali Acc: 0.725 Test Loss: 0.906 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.7686960697174072
Epoch: 86, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.7793552875518799
Epoch: 87, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.904 Vali Acc: 0.725 Test Loss: 0.904 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.7962973117828369
Epoch: 88, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.904 Vali Acc: 0.725 Test Loss: 0.904 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.6862735748291016
Epoch: 89, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.900 Vali Acc: 0.725 Test Loss: 0.900 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 90 cost time: 0.6550233364105225
Epoch: 90, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.902 Vali Acc: 0.725 Test Loss: 0.902 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.5964014530181885
Epoch: 91, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.906 Vali Acc: 0.725 Test Loss: 0.906 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.645329475402832
Epoch: 92, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.905 Vali Acc: 0.725 Test Loss: 0.905 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.6677579879760742
Epoch: 93, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.903 Vali Acc: 0.725 Test Loss: 0.903 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.6136956214904785
Epoch: 94, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.901 Vali Acc: 0.725 Test Loss: 0.901 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.6666338443756104
Epoch: 95, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.898 Vali Acc: 0.725 Test Loss: 0.898 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 96 cost time: 0.6599225997924805
Epoch: 96, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.893 Vali Acc: 0.725 Test Loss: 0.893 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 97 cost time: 0.679884672164917
Epoch: 97, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.891 Vali Acc: 0.725 Test Loss: 0.891 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 98 cost time: 0.7782497406005859
Epoch: 98, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.887 Vali Acc: 0.725 Test Loss: 0.887 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 99 cost time: 0.6288578510284424
Epoch: 99, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.884 Vali Acc: 0.725 Test Loss: 0.884 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 100 cost time: 0.7357058525085449
Epoch: 100, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.725 Test Loss: 0.878 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 53860
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.445164203643799
Epoch: 1, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.244 Vali Acc: 0.400 Test Loss: 1.244 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5942368507385254
Epoch: 2, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.229 Vali Acc: 0.425 Test Loss: 1.229 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 3 cost time: 0.6946167945861816
Epoch: 3, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.217 Vali Acc: 0.450 Test Loss: 1.217 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 4 cost time: 0.6340022087097168
Epoch: 4, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.7207458019256592
Epoch: 5, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.6505956649780273
Epoch: 6, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.7265782356262207
Epoch: 7, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.167 Vali Acc: 0.550 Test Loss: 1.167 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.6820566654205322
Epoch: 8, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.155 Vali Acc: 0.575 Test Loss: 1.155 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.6371424198150635
Epoch: 9, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.142 Vali Acc: 0.575 Test Loss: 1.142 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 0.6402063369750977
Epoch: 10, Steps: 3 | Train Loss: 0.919 Vali Loss: 1.129 Vali Acc: 0.625 Test Loss: 1.129 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.7167527675628662
Epoch: 11, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.6948451995849609
Epoch: 12, Steps: 3 | Train Loss: 0.822 Vali Loss: 1.102 Vali Acc: 0.600 Test Loss: 1.102 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6857469081878662
Epoch: 13, Steps: 3 | Train Loss: 0.791 Vali Loss: 1.086 Vali Acc: 0.625 Test Loss: 1.086 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.69063401222229
Epoch: 14, Steps: 3 | Train Loss: 0.721 Vali Loss: 1.069 Vali Acc: 0.650 Test Loss: 1.069 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 0.6677007675170898
Epoch: 15, Steps: 3 | Train Loss: 0.605 Vali Loss: 1.055 Vali Acc: 0.650 Test Loss: 1.055 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 0.7523586750030518
Epoch: 16, Steps: 3 | Train Loss: 0.614 Vali Loss: 1.047 Vali Acc: 0.625 Test Loss: 1.047 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6913883686065674
Epoch: 17, Steps: 3 | Train Loss: 0.552 Vali Loss: 1.039 Vali Acc: 0.650 Test Loss: 1.039 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 18 cost time: 0.6875176429748535
Epoch: 18, Steps: 3 | Train Loss: 0.509 Vali Loss: 1.031 Vali Acc: 0.650 Test Loss: 1.031 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 19 cost time: 0.6642000675201416
Epoch: 19, Steps: 3 | Train Loss: 0.493 Vali Loss: 1.018 Vali Acc: 0.650 Test Loss: 1.018 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 20 cost time: 0.6869549751281738
Epoch: 20, Steps: 3 | Train Loss: 0.416 Vali Loss: 1.012 Vali Acc: 0.650 Test Loss: 1.012 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 21 cost time: 0.7164850234985352
Epoch: 21, Steps: 3 | Train Loss: 0.447 Vali Loss: 1.007 Vali Acc: 0.650 Test Loss: 1.007 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 22 cost time: 0.6733570098876953
Epoch: 22, Steps: 3 | Train Loss: 0.366 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6247985363006592
Epoch: 23, Steps: 3 | Train Loss: 0.344 Vali Loss: 1.004 Vali Acc: 0.650 Test Loss: 1.004 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 0.6856915950775146
Epoch: 24, Steps: 3 | Train Loss: 0.348 Vali Loss: 1.004 Vali Acc: 0.650 Test Loss: 1.004 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 25 cost time: 0.6761467456817627
Epoch: 25, Steps: 3 | Train Loss: 0.274 Vali Loss: 1.000 Vali Acc: 0.675 Test Loss: 1.000 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 26 cost time: 0.6526584625244141
Epoch: 26, Steps: 3 | Train Loss: 0.233 Vali Loss: 1.001 Vali Acc: 0.650 Test Loss: 1.001 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.683175802230835
Epoch: 27, Steps: 3 | Train Loss: 0.210 Vali Loss: 1.002 Vali Acc: 0.625 Test Loss: 1.002 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6373250484466553
Epoch: 28, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.999 Vali Acc: 0.650 Test Loss: 0.999 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7794051170349121
Epoch: 29, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.996 Vali Acc: 0.650 Test Loss: 0.996 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7110977172851562
Epoch: 30, Steps: 3 | Train Loss: 0.154 Vali Loss: 1.002 Vali Acc: 0.650 Test Loss: 1.002 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6859445571899414
Epoch: 31, Steps: 3 | Train Loss: 0.162 Vali Loss: 1.006 Vali Acc: 0.650 Test Loss: 1.006 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6330792903900146
Epoch: 32, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.010 Vali Acc: 0.650 Test Loss: 1.010 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7077491283416748
Epoch: 33, Steps: 3 | Train Loss: 0.105 Vali Loss: 1.014 Vali Acc: 0.650 Test Loss: 1.014 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.675217866897583
Epoch: 34, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.016 Vali Acc: 0.650 Test Loss: 1.016 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6922225952148438
Epoch: 35, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.024 Vali Acc: 0.650 Test Loss: 1.024 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 47876
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.247087240219116
Epoch: 1, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.532 Vali Acc: 0.250 Test Loss: 1.532 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.5802962779998779
Epoch: 2, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.516 Vali Acc: 0.250 Test Loss: 1.516 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.6062347888946533
Epoch: 3, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.503 Vali Acc: 0.225 Test Loss: 1.503 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5385274887084961
Epoch: 4, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.487 Vali Acc: 0.250 Test Loss: 1.487 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 5 cost time: 0.5732572078704834
Epoch: 5, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.467 Vali Acc: 0.250 Test Loss: 1.467 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 6 cost time: 0.6274271011352539
Epoch: 6, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.444 Vali Acc: 0.275 Test Loss: 1.444 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 0.5905561447143555
Epoch: 7, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.421 Vali Acc: 0.275 Test Loss: 1.421 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 8 cost time: 0.6674225330352783
Epoch: 8, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.397 Vali Acc: 0.275 Test Loss: 1.397 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 9 cost time: 0.6104099750518799
Epoch: 9, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.373 Vali Acc: 0.275 Test Loss: 1.373 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 10 cost time: 0.6495754718780518
Epoch: 10, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.347 Vali Acc: 0.225 Test Loss: 1.347 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5859875679016113
Epoch: 11, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.322 Vali Acc: 0.300 Test Loss: 1.322 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 12 cost time: 0.5567677021026611
Epoch: 12, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.296 Vali Acc: 0.325 Test Loss: 1.296 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 13 cost time: 0.590205192565918
Epoch: 13, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.272 Vali Acc: 0.350 Test Loss: 1.272 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 14 cost time: 0.6102004051208496
Epoch: 14, Steps: 3 | Train Loss: 0.839 Vali Loss: 1.248 Vali Acc: 0.425 Test Loss: 1.248 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424988).  Saving model ...
Epoch: 15 cost time: 0.5461719036102295
Epoch: 15, Steps: 3 | Train Loss: 0.763 Vali Loss: 1.226 Vali Acc: 0.450 Test Loss: 1.226 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 16 cost time: 0.6097874641418457
Epoch: 16, Steps: 3 | Train Loss: 0.753 Vali Loss: 1.205 Vali Acc: 0.450 Test Loss: 1.205 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 17 cost time: 0.6618523597717285
Epoch: 17, Steps: 3 | Train Loss: 0.731 Vali Loss: 1.180 Vali Acc: 0.550 Test Loss: 1.180 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549988).  Saving model ...
Epoch: 18 cost time: 0.5327138900756836
Epoch: 18, Steps: 3 | Train Loss: 0.633 Vali Loss: 1.158 Vali Acc: 0.600 Test Loss: 1.158 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 19 cost time: 0.6588728427886963
Epoch: 19, Steps: 3 | Train Loss: 0.578 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 20 cost time: 0.6903393268585205
Epoch: 20, Steps: 3 | Train Loss: 0.600 Vali Loss: 1.123 Vali Acc: 0.625 Test Loss: 1.123 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 0.5807092189788818
Epoch: 21, Steps: 3 | Train Loss: 0.474 Vali Loss: 1.109 Vali Acc: 0.650 Test Loss: 1.109 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 22 cost time: 0.5683295726776123
Epoch: 22, Steps: 3 | Train Loss: 0.417 Vali Loss: 1.096 Vali Acc: 0.675 Test Loss: 1.096 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 23 cost time: 0.5403499603271484
Epoch: 23, Steps: 3 | Train Loss: 0.403 Vali Loss: 1.087 Vali Acc: 0.675 Test Loss: 1.087 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 24 cost time: 0.5243585109710693
Epoch: 24, Steps: 3 | Train Loss: 0.336 Vali Loss: 1.078 Vali Acc: 0.675 Test Loss: 1.078 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.6621181964874268
Epoch: 25, Steps: 3 | Train Loss: 0.333 Vali Loss: 1.067 Vali Acc: 0.675 Test Loss: 1.067 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.5675954818725586
Epoch: 26, Steps: 3 | Train Loss: 0.317 Vali Loss: 1.056 Vali Acc: 0.700 Test Loss: 1.056 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 27 cost time: 0.5857696533203125
Epoch: 27, Steps: 3 | Train Loss: 0.311 Vali Loss: 1.039 Vali Acc: 0.700 Test Loss: 1.039 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 28 cost time: 0.6296470165252686
Epoch: 28, Steps: 3 | Train Loss: 0.282 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 29 cost time: 0.6717925071716309
Epoch: 29, Steps: 3 | Train Loss: 0.228 Vali Loss: 1.014 Vali Acc: 0.700 Test Loss: 1.014 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 30 cost time: 0.6117868423461914
Epoch: 30, Steps: 3 | Train Loss: 0.194 Vali Loss: 1.005 Vali Acc: 0.700 Test Loss: 1.005 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 31 cost time: 0.6197266578674316
Epoch: 31, Steps: 3 | Train Loss: 0.210 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.638568639755249
Epoch: 32, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.993 Vali Acc: 0.700 Test Loss: 0.993 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 33 cost time: 0.5801060199737549
Epoch: 33, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.990 Vali Acc: 0.700 Test Loss: 0.990 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 34 cost time: 0.6686878204345703
Epoch: 34, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.987 Vali Acc: 0.725 Test Loss: 0.987 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 35 cost time: 0.5568897724151611
Epoch: 35, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.987 Vali Acc: 0.725 Test Loss: 0.987 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 36 cost time: 0.639291524887085
Epoch: 36, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.983 Vali Acc: 0.725 Test Loss: 0.983 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 37 cost time: 0.6400070190429688
Epoch: 37, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.976 Vali Acc: 0.725 Test Loss: 0.976 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 38 cost time: 0.6322007179260254
Epoch: 38, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.971 Vali Acc: 0.725 Test Loss: 0.971 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 39 cost time: 0.675534725189209
Epoch: 39, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 40 cost time: 0.7751779556274414
Epoch: 40, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.962 Vali Acc: 0.725 Test Loss: 0.962 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 41 cost time: 0.8597772121429443
Epoch: 41, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.960 Vali Acc: 0.750 Test Loss: 0.960 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 42 cost time: 0.6458766460418701
Epoch: 42, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 43 cost time: 0.7821149826049805
Epoch: 43, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 44 cost time: 0.6694846153259277
Epoch: 44, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 45 cost time: 0.6476294994354248
Epoch: 45, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.725480318069458
Epoch: 46, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.957 Vali Acc: 0.750 Test Loss: 0.957 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7015728950500488
Epoch: 47, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6124608516693115
Epoch: 48, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 49 cost time: 0.7366743087768555
Epoch: 49, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6697852611541748
Epoch: 50, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.957 Vali Acc: 0.750 Test Loss: 0.957 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.722144603729248
Epoch: 51, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.6413006782531738
Epoch: 52, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 53 cost time: 0.6583108901977539
Epoch: 53, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.951 Vali Acc: 0.750 Test Loss: 0.951 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 54 cost time: 0.74383544921875
Epoch: 54, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.950 Vali Acc: 0.750 Test Loss: 0.950 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 55 cost time: 0.6724088191986084
Epoch: 55, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 56 cost time: 0.7011675834655762
Epoch: 56, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7004926204681396
Epoch: 57, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6901090145111084
Epoch: 58, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 59 cost time: 0.7123837471008301
Epoch: 59, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7295563220977783
Epoch: 60, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.948 Vali Acc: 0.750 Test Loss: 0.948 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.6534817218780518
Epoch: 61, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.653864860534668
Epoch: 62, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.948 Vali Acc: 0.750 Test Loss: 0.948 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.7232043743133545
Epoch: 63, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.6810767650604248
Epoch: 64, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.6640908718109131
Epoch: 65, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 66 cost time: 0.7549479007720947
Epoch: 66, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.945 Vali Acc: 0.750 Test Loss: 0.945 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6612491607666016
Epoch: 67, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7611367702484131
Epoch: 68, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.948 Vali Acc: 0.750 Test Loss: 0.948 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.7046489715576172
Epoch: 69, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.950 Vali Acc: 0.750 Test Loss: 0.950 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.7233912944793701
Epoch: 70, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.639035701751709
Epoch: 71, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.5959668159484863
Epoch: 72, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.5551316738128662
Epoch: 73, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.950 Vali Acc: 0.750 Test Loss: 0.950 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.8240070343017578
Epoch: 74, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.948 Vali Acc: 0.750 Test Loss: 0.948 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.5924320220947266
Epoch: 75, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 46500
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0603489875793457
Epoch: 1, Steps: 3 | Train Loss: 1.555 Vali Loss: 1.540 Vali Acc: 0.350 Test Loss: 1.540 Test Acc: 0.350
Validation loss decreased (inf --> -0.349985).  Saving model ...
Epoch: 2 cost time: 0.6917097568511963
Epoch: 2, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.523 Vali Acc: 0.300 Test Loss: 1.523 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.661041259765625
Epoch: 3, Steps: 3 | Train Loss: 1.608 Vali Loss: 1.510 Vali Acc: 0.275 Test Loss: 1.510 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6296520233154297
Epoch: 4, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.498 Vali Acc: 0.275 Test Loss: 1.498 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6311380863189697
Epoch: 5, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.485 Vali Acc: 0.300 Test Loss: 1.485 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6721615791320801
Epoch: 6, Steps: 3 | Train Loss: 1.519 Vali Loss: 1.472 Vali Acc: 0.300 Test Loss: 1.472 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5436139106750488
Epoch: 7, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.458 Vali Acc: 0.375 Test Loss: 1.458 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374985).  Saving model ...
Epoch: 8 cost time: 0.5925970077514648
Epoch: 8, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.443 Vali Acc: 0.400 Test Loss: 1.443 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 0.5683283805847168
Epoch: 9, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.430 Vali Acc: 0.425 Test Loss: 1.430 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 10 cost time: 0.6515617370605469
Epoch: 10, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.417 Vali Acc: 0.475 Test Loss: 1.417 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474986).  Saving model ...
Epoch: 11 cost time: 0.6448154449462891
Epoch: 11, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.403 Vali Acc: 0.475 Test Loss: 1.403 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 12 cost time: 0.6262929439544678
Epoch: 12, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.390 Vali Acc: 0.475 Test Loss: 1.390 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 13 cost time: 0.6327159404754639
Epoch: 13, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.378 Vali Acc: 0.475 Test Loss: 1.378 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 14 cost time: 0.5812327861785889
Epoch: 14, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.365 Vali Acc: 0.500 Test Loss: 1.365 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499986).  Saving model ...
Epoch: 15 cost time: 0.7132177352905273
Epoch: 15, Steps: 3 | Train Loss: 0.882 Vali Loss: 1.351 Vali Acc: 0.500 Test Loss: 1.351 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 16 cost time: 0.7239983081817627
Epoch: 16, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.340 Vali Acc: 0.475 Test Loss: 1.340 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6359214782714844
Epoch: 17, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.330 Vali Acc: 0.475 Test Loss: 1.330 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6482012271881104
Epoch: 18, Steps: 3 | Train Loss: 0.780 Vali Loss: 1.323 Vali Acc: 0.475 Test Loss: 1.323 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7297673225402832
Epoch: 19, Steps: 3 | Train Loss: 0.723 Vali Loss: 1.314 Vali Acc: 0.500 Test Loss: 1.314 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 20 cost time: 0.648047685623169
Epoch: 20, Steps: 3 | Train Loss: 0.656 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 21 cost time: 0.7034091949462891
Epoch: 21, Steps: 3 | Train Loss: 0.625 Vali Loss: 1.297 Vali Acc: 0.525 Test Loss: 1.297 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 22 cost time: 0.6883749961853027
Epoch: 22, Steps: 3 | Train Loss: 0.575 Vali Loss: 1.287 Vali Acc: 0.525 Test Loss: 1.287 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 23 cost time: 0.620924711227417
Epoch: 23, Steps: 3 | Train Loss: 0.583 Vali Loss: 1.274 Vali Acc: 0.525 Test Loss: 1.274 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 24 cost time: 0.6072874069213867
Epoch: 24, Steps: 3 | Train Loss: 0.498 Vali Loss: 1.267 Vali Acc: 0.525 Test Loss: 1.267 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 25 cost time: 0.6433436870574951
Epoch: 25, Steps: 3 | Train Loss: 0.461 Vali Loss: 1.260 Vali Acc: 0.550 Test Loss: 1.260 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 26 cost time: 0.6508316993713379
Epoch: 26, Steps: 3 | Train Loss: 0.415 Vali Loss: 1.250 Vali Acc: 0.550 Test Loss: 1.250 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 27 cost time: 0.6702947616577148
Epoch: 27, Steps: 3 | Train Loss: 0.441 Vali Loss: 1.242 Vali Acc: 0.550 Test Loss: 1.242 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 28 cost time: 0.6840736865997314
Epoch: 28, Steps: 3 | Train Loss: 0.357 Vali Loss: 1.232 Vali Acc: 0.575 Test Loss: 1.232 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 29 cost time: 0.7012403011322021
Epoch: 29, Steps: 3 | Train Loss: 0.436 Vali Loss: 1.223 Vali Acc: 0.575 Test Loss: 1.223 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 30 cost time: 0.6073989868164062
Epoch: 30, Steps: 3 | Train Loss: 0.359 Vali Loss: 1.210 Vali Acc: 0.575 Test Loss: 1.210 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 31 cost time: 0.7395927906036377
Epoch: 31, Steps: 3 | Train Loss: 0.282 Vali Loss: 1.193 Vali Acc: 0.575 Test Loss: 1.193 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 32 cost time: 0.6005048751831055
Epoch: 32, Steps: 3 | Train Loss: 0.358 Vali Loss: 1.183 Vali Acc: 0.575 Test Loss: 1.183 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 33 cost time: 0.6900858879089355
Epoch: 33, Steps: 3 | Train Loss: 0.246 Vali Loss: 1.170 Vali Acc: 0.600 Test Loss: 1.170 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 34 cost time: 0.7300009727478027
Epoch: 34, Steps: 3 | Train Loss: 0.264 Vali Loss: 1.154 Vali Acc: 0.600 Test Loss: 1.154 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 35 cost time: 0.7784972190856934
Epoch: 35, Steps: 3 | Train Loss: 0.225 Vali Loss: 1.144 Vali Acc: 0.600 Test Loss: 1.144 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 36 cost time: 0.7464122772216797
Epoch: 36, Steps: 3 | Train Loss: 0.190 Vali Loss: 1.129 Vali Acc: 0.600 Test Loss: 1.129 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 37 cost time: 0.7146284580230713
Epoch: 37, Steps: 3 | Train Loss: 0.177 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 38 cost time: 0.6020412445068359
Epoch: 38, Steps: 3 | Train Loss: 0.177 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 39 cost time: 0.7253158092498779
Epoch: 39, Steps: 3 | Train Loss: 0.158 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 40 cost time: 0.6919600963592529
Epoch: 40, Steps: 3 | Train Loss: 0.141 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 41 cost time: 0.6370368003845215
Epoch: 41, Steps: 3 | Train Loss: 0.125 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 42 cost time: 0.7113845348358154
Epoch: 42, Steps: 3 | Train Loss: 0.141 Vali Loss: 1.103 Vali Acc: 0.600 Test Loss: 1.103 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 43 cost time: 0.6788785457611084
Epoch: 43, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.102 Vali Acc: 0.600 Test Loss: 1.102 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 44 cost time: 0.7253661155700684
Epoch: 44, Steps: 3 | Train Loss: 0.099 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6709611415863037
Epoch: 45, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 46 cost time: 0.649467945098877
Epoch: 46, Steps: 3 | Train Loss: 0.081 Vali Loss: 1.100 Vali Acc: 0.625 Test Loss: 1.100 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 47 cost time: 0.6332433223724365
Epoch: 47, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.098 Vali Acc: 0.625 Test Loss: 1.098 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 48 cost time: 0.7019374370574951
Epoch: 48, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6784248352050781
Epoch: 49, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.097 Vali Acc: 0.600 Test Loss: 1.097 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6063730716705322
Epoch: 50, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.088 Vali Acc: 0.625 Test Loss: 1.088 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 51 cost time: 0.5749680995941162
Epoch: 51, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.085 Vali Acc: 0.625 Test Loss: 1.085 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 52 cost time: 0.6522572040557861
Epoch: 52, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.085 Vali Acc: 0.625 Test Loss: 1.085 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6190104484558105
Epoch: 53, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.085 Vali Acc: 0.625 Test Loss: 1.085 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6999125480651855
Epoch: 54, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.079 Vali Acc: 0.650 Test Loss: 1.079 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 55 cost time: 0.7260847091674805
Epoch: 55, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.074 Vali Acc: 0.675 Test Loss: 1.074 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 56 cost time: 0.6219885349273682
Epoch: 56, Steps: 3 | Train Loss: 0.060 Vali Loss: 1.064 Vali Acc: 0.675 Test Loss: 1.064 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 57 cost time: 0.6184687614440918
Epoch: 57, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.065 Vali Acc: 0.675 Test Loss: 1.065 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6860496997833252
Epoch: 58, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.051 Vali Acc: 0.700 Test Loss: 1.051 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 59 cost time: 0.6330611705780029
Epoch: 59, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.045 Vali Acc: 0.700 Test Loss: 1.045 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 60 cost time: 0.5799448490142822
Epoch: 60, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 61 cost time: 0.6253507137298584
Epoch: 61, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.042 Vali Acc: 0.700 Test Loss: 1.042 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 62 cost time: 0.6037280559539795
Epoch: 62, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 63 cost time: 0.6673336029052734
Epoch: 63, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 64 cost time: 0.7401790618896484
Epoch: 64, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7011382579803467
Epoch: 65, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.039 Vali Acc: 0.650 Test Loss: 1.039 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.6669285297393799
Epoch: 66, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.039 Vali Acc: 0.650 Test Loss: 1.039 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.6585738658905029
Epoch: 67, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.037 Vali Acc: 0.650 Test Loss: 1.037 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.7175590991973877
Epoch: 68, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.038 Vali Acc: 0.650 Test Loss: 1.038 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.695500373840332
Epoch: 69, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.034 Vali Acc: 0.675 Test Loss: 1.034 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.659168004989624
Epoch: 70, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.039 Vali Acc: 0.650 Test Loss: 1.039 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.6316931247711182
Epoch: 71, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.037 Vali Acc: 0.650 Test Loss: 1.037 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.6133041381835938
Epoch: 72, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.034 Vali Acc: 0.675 Test Loss: 1.034 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.6195461750030518
Epoch: 73, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.032 Vali Acc: 0.675 Test Loss: 1.032 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df128_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 44356
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9499354362487793
Epoch: 1, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.378 Vali Acc: 0.275 Test Loss: 1.378 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.8364663124084473
Epoch: 2, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.349 Vali Acc: 0.300 Test Loss: 1.349 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.9291298389434814
Epoch: 3, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.316 Vali Acc: 0.350 Test Loss: 1.316 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 1.0116560459136963
Epoch: 4, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.278 Vali Acc: 0.425 Test Loss: 1.278 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.8937160968780518
Epoch: 5, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.235 Vali Acc: 0.425 Test Loss: 1.235 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 6 cost time: 0.8738975524902344
Epoch: 6, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.192 Vali Acc: 0.450 Test Loss: 1.192 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 0.9978156089782715
Epoch: 7, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.156 Vali Acc: 0.475 Test Loss: 1.156 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.9159517288208008
Epoch: 8, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.127 Vali Acc: 0.575 Test Loss: 1.127 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 1.0237791538238525
Epoch: 9, Steps: 3 | Train Loss: 0.725 Vali Loss: 1.094 Vali Acc: 0.600 Test Loss: 1.094 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.8211820125579834
Epoch: 10, Steps: 3 | Train Loss: 0.604 Vali Loss: 1.051 Vali Acc: 0.625 Test Loss: 1.051 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.9287459850311279
Epoch: 11, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.990 Vali Acc: 0.625 Test Loss: 0.990 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 12 cost time: 0.8961076736450195
Epoch: 12, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.925 Vali Acc: 0.700 Test Loss: 0.925 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 0.8904411792755127
Epoch: 13, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.878 Vali Acc: 0.725 Test Loss: 0.878 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 0.9390575885772705
Epoch: 14, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.849 Vali Acc: 0.725 Test Loss: 0.849 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 15 cost time: 0.9066989421844482
Epoch: 15, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.846 Vali Acc: 0.725 Test Loss: 0.846 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 16 cost time: 0.9010672569274902
Epoch: 16, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.844 Vali Acc: 0.700 Test Loss: 0.844 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9125776290893555
Epoch: 17, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.842 Vali Acc: 0.675 Test Loss: 0.842 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9654297828674316
Epoch: 18, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.799 Vali Acc: 0.700 Test Loss: 0.799 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9501712322235107
Epoch: 19, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.764 Vali Acc: 0.775 Test Loss: 0.764 Test Acc: 0.775
Validation loss decreased (-0.724992 --> -0.774992).  Saving model ...
Epoch: 20 cost time: 0.9714126586914062
Epoch: 20, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.767 Vali Acc: 0.775 Test Loss: 0.767 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.968048095703125
Epoch: 21, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.768 Vali Acc: 0.775 Test Loss: 0.768 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9529292583465576
Epoch: 22, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.759 Vali Acc: 0.750 Test Loss: 0.759 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9483382701873779
Epoch: 23, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 24 cost time: 1.0046131610870361
Epoch: 24, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.760 Vali Acc: 0.750 Test Loss: 0.760 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0120177268981934
Epoch: 25, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.760 Vali Acc: 0.750 Test Loss: 0.760 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8252806663513184
Epoch: 26, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.761 Vali Acc: 0.775 Test Loss: 0.761 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8586521148681641
Epoch: 27, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.760 Vali Acc: 0.775 Test Loss: 0.760 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8268170356750488
Epoch: 28, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.759 Vali Acc: 0.825 Test Loss: 0.759 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 29 cost time: 0.9457261562347412
Epoch: 29, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.761 Vali Acc: 0.800 Test Loss: 0.761 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8821878433227539
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.762 Vali Acc: 0.800 Test Loss: 0.762 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8460395336151123
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.762 Vali Acc: 0.800 Test Loss: 0.762 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8445839881896973
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9552350044250488
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.757 Vali Acc: 0.825 Test Loss: 0.757 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 34 cost time: 0.8543293476104736
Epoch: 34, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.753 Vali Acc: 0.825 Test Loss: 0.753 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 35 cost time: 0.7857015132904053
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.751 Vali Acc: 0.825 Test Loss: 0.751 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 36 cost time: 0.9343523979187012
Epoch: 36, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.751 Vali Acc: 0.825 Test Loss: 0.751 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 37 cost time: 0.8272178173065186
Epoch: 37, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.753 Vali Acc: 0.825 Test Loss: 0.753 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8901896476745605
Epoch: 38, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.757 Vali Acc: 0.825 Test Loss: 0.757 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8354909420013428
Epoch: 39, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.762 Vali Acc: 0.825 Test Loss: 0.762 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8048250675201416
Epoch: 40, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.765 Vali Acc: 0.825 Test Loss: 0.765 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9285292625427246
Epoch: 41, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.768 Vali Acc: 0.825 Test Loss: 0.768 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8786294460296631
Epoch: 42, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.770 Vali Acc: 0.825 Test Loss: 0.770 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9261751174926758
Epoch: 43, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.773 Vali Acc: 0.825 Test Loss: 0.773 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8774940967559814
Epoch: 44, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.775 Vali Acc: 0.825 Test Loss: 0.775 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8816335201263428
Epoch: 45, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.777 Vali Acc: 0.825 Test Loss: 0.777 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.8736732006072998
Epoch: 46, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 64196
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6041316986083984
Epoch: 1, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.380 Vali Acc: 0.175 Test Loss: 1.380 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.6403813362121582
Epoch: 2, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.359 Vali Acc: 0.225 Test Loss: 1.359 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.737490177154541
Epoch: 3, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.335 Vali Acc: 0.275 Test Loss: 1.335 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.6020054817199707
Epoch: 4, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.308 Vali Acc: 0.375 Test Loss: 1.308 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.6534168720245361
Epoch: 5, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.273 Vali Acc: 0.425 Test Loss: 1.273 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.6206691265106201
Epoch: 6, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.233 Vali Acc: 0.425 Test Loss: 1.233 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 0.6063947677612305
Epoch: 7, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.188 Vali Acc: 0.450 Test Loss: 1.188 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.6408348083496094
Epoch: 8, Steps: 3 | Train Loss: 0.827 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 0.6427254676818848
Epoch: 9, Steps: 3 | Train Loss: 0.705 Vali Loss: 1.101 Vali Acc: 0.525 Test Loss: 1.101 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 0.6083323955535889
Epoch: 10, Steps: 3 | Train Loss: 0.674 Vali Loss: 1.059 Vali Acc: 0.550 Test Loss: 1.059 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 0.6138815879821777
Epoch: 11, Steps: 3 | Train Loss: 0.653 Vali Loss: 1.024 Vali Acc: 0.625 Test Loss: 1.024 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624990).  Saving model ...
Epoch: 12 cost time: 0.587507963180542
Epoch: 12, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.990 Vali Acc: 0.675 Test Loss: 0.990 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 0.6279206275939941
Epoch: 13, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.957 Vali Acc: 0.675 Test Loss: 0.957 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 14 cost time: 0.7225618362426758
Epoch: 14, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.922 Vali Acc: 0.675 Test Loss: 0.922 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 15 cost time: 0.6119534969329834
Epoch: 15, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.896 Vali Acc: 0.700 Test Loss: 0.896 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 0.6463971138000488
Epoch: 16, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.866 Vali Acc: 0.775 Test Loss: 0.866 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 0.6290240287780762
Epoch: 17, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.840 Vali Acc: 0.800 Test Loss: 0.840 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.6663961410522461
Epoch: 18, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.824 Vali Acc: 0.825 Test Loss: 0.824 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 0.5713462829589844
Epoch: 19, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.816 Vali Acc: 0.825 Test Loss: 0.816 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 20 cost time: 0.5896010398864746
Epoch: 20, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.817 Vali Acc: 0.800 Test Loss: 0.817 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6332108974456787
Epoch: 21, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.815 Vali Acc: 0.800 Test Loss: 0.815 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5891809463500977
Epoch: 22, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.816 Vali Acc: 0.800 Test Loss: 0.816 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6557915210723877
Epoch: 23, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.809 Vali Acc: 0.825 Test Loss: 0.809 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 24 cost time: 0.5918726921081543
Epoch: 24, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.790 Vali Acc: 0.850 Test Loss: 0.790 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 25 cost time: 0.5947370529174805
Epoch: 25, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.778 Vali Acc: 0.850 Test Loss: 0.778 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 26 cost time: 0.6911983489990234
Epoch: 26, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.773 Vali Acc: 0.850 Test Loss: 0.773 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 27 cost time: 0.5865411758422852
Epoch: 27, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 28 cost time: 0.5971786975860596
Epoch: 28, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.760 Vali Acc: 0.850 Test Loss: 0.760 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 29 cost time: 0.625251293182373
Epoch: 29, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.757 Vali Acc: 0.850 Test Loss: 0.757 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 30 cost time: 0.6252706050872803
Epoch: 30, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 31 cost time: 0.625751256942749
Epoch: 31, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.756 Vali Acc: 0.850 Test Loss: 0.756 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5908393859863281
Epoch: 32, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 33 cost time: 0.6396241188049316
Epoch: 33, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 34 cost time: 0.5449116230010986
Epoch: 34, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.752 Vali Acc: 0.850 Test Loss: 0.752 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 35 cost time: 0.643460750579834
Epoch: 35, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.750 Vali Acc: 0.850 Test Loss: 0.750 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 36 cost time: 0.5920586585998535
Epoch: 36, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.747 Vali Acc: 0.850 Test Loss: 0.747 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 37 cost time: 0.6389420032501221
Epoch: 37, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.745 Vali Acc: 0.850 Test Loss: 0.745 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 38 cost time: 0.5864558219909668
Epoch: 38, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.743 Vali Acc: 0.850 Test Loss: 0.743 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 39 cost time: 0.6503744125366211
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.743 Vali Acc: 0.850 Test Loss: 0.743 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 40 cost time: 0.7736444473266602
Epoch: 40, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.743 Vali Acc: 0.850 Test Loss: 0.743 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7133762836456299
Epoch: 41, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.744 Vali Acc: 0.850 Test Loss: 0.744 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6487603187561035
Epoch: 42, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.746 Vali Acc: 0.850 Test Loss: 0.746 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6278107166290283
Epoch: 43, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.746 Vali Acc: 0.850 Test Loss: 0.746 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6445498466491699
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.746 Vali Acc: 0.850 Test Loss: 0.746 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.713789701461792
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.747 Vali Acc: 0.850 Test Loss: 0.747 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.5953195095062256
Epoch: 46, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.747 Vali Acc: 0.850 Test Loss: 0.747 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6303925514221191
Epoch: 47, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.5793945789337158
Epoch: 48, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7259948253631592
Epoch: 49, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 51204
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.150055408477783
Epoch: 1, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.367 Vali Acc: 0.375 Test Loss: 1.367 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.6086020469665527
Epoch: 2, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.340 Vali Acc: 0.425 Test Loss: 1.340 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.6094553470611572
Epoch: 3, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.312 Vali Acc: 0.425 Test Loss: 1.312 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.6494243144989014
Epoch: 4, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.284 Vali Acc: 0.425 Test Loss: 1.284 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.6179354190826416
Epoch: 5, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.6074886322021484
Epoch: 6, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.6086335182189941
Epoch: 7, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.188 Vali Acc: 0.550 Test Loss: 1.188 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.6086161136627197
Epoch: 8, Steps: 3 | Train Loss: 0.851 Vali Loss: 1.161 Vali Acc: 0.575 Test Loss: 1.161 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.7284355163574219
Epoch: 9, Steps: 3 | Train Loss: 0.788 Vali Loss: 1.135 Vali Acc: 0.600 Test Loss: 1.135 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.6384694576263428
Epoch: 10, Steps: 3 | Train Loss: 0.755 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.6702976226806641
Epoch: 11, Steps: 3 | Train Loss: 0.667 Vali Loss: 1.095 Vali Acc: 0.600 Test Loss: 1.095 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7319116592407227
Epoch: 12, Steps: 3 | Train Loss: 0.625 Vali Loss: 1.078 Vali Acc: 0.625 Test Loss: 1.078 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.6342859268188477
Epoch: 13, Steps: 3 | Train Loss: 0.507 Vali Loss: 1.059 Vali Acc: 0.625 Test Loss: 1.059 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.6552064418792725
Epoch: 14, Steps: 3 | Train Loss: 0.463 Vali Loss: 1.034 Vali Acc: 0.625 Test Loss: 1.034 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 15 cost time: 0.62557053565979
Epoch: 15, Steps: 3 | Train Loss: 0.400 Vali Loss: 1.009 Vali Acc: 0.650 Test Loss: 1.009 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 0.6357593536376953
Epoch: 16, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.995 Vali Acc: 0.675 Test Loss: 0.995 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 0.6705613136291504
Epoch: 17, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.987 Vali Acc: 0.675 Test Loss: 0.987 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 0.6365852355957031
Epoch: 18, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.980 Vali Acc: 0.675 Test Loss: 0.980 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 19 cost time: 0.7038793563842773
Epoch: 19, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.973 Vali Acc: 0.650 Test Loss: 0.973 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7742171287536621
Epoch: 20, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.971 Vali Acc: 0.675 Test Loss: 0.971 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 21 cost time: 0.6109035015106201
Epoch: 21, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.970 Vali Acc: 0.700 Test Loss: 0.970 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 22 cost time: 0.646204948425293
Epoch: 22, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.976 Vali Acc: 0.700 Test Loss: 0.976 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7257976531982422
Epoch: 23, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.980 Vali Acc: 0.700 Test Loss: 0.980 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6797711849212646
Epoch: 24, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.984 Vali Acc: 0.725 Test Loss: 0.984 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 25 cost time: 0.6416854858398438
Epoch: 25, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.978 Vali Acc: 0.725 Test Loss: 0.978 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 26 cost time: 0.6431906223297119
Epoch: 26, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.968 Vali Acc: 0.725 Test Loss: 0.968 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 27 cost time: 0.6402003765106201
Epoch: 27, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 28 cost time: 0.6162588596343994
Epoch: 28, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 29 cost time: 0.700068473815918
Epoch: 29, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 30 cost time: 0.751849889755249
Epoch: 30, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.937 Vali Acc: 0.750 Test Loss: 0.937 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 31 cost time: 0.7422308921813965
Epoch: 31, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.936 Vali Acc: 0.750 Test Loss: 0.936 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 32 cost time: 0.7886443138122559
Epoch: 32, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6889536380767822
Epoch: 33, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.939 Vali Acc: 0.750 Test Loss: 0.939 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6587417125701904
Epoch: 34, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.943 Vali Acc: 0.750 Test Loss: 0.943 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6073431968688965
Epoch: 35, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.946 Vali Acc: 0.750 Test Loss: 0.946 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6229264736175537
Epoch: 36, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.946 Vali Acc: 0.725 Test Loss: 0.946 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5833241939544678
Epoch: 37, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.945 Vali Acc: 0.725 Test Loss: 0.945 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7493274211883545
Epoch: 38, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.946 Vali Acc: 0.725 Test Loss: 0.946 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6689658164978027
Epoch: 39, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.952 Vali Acc: 0.725 Test Loss: 0.952 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6848320960998535
Epoch: 40, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.958 Vali Acc: 0.725 Test Loss: 0.958 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6305041313171387
Epoch: 41, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.961 Vali Acc: 0.750 Test Loss: 0.961 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 45156
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1575517654418945
Epoch: 1, Steps: 3 | Train Loss: 1.575 Vali Loss: 1.499 Vali Acc: 0.250 Test Loss: 1.499 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.7537579536437988
Epoch: 2, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.475 Vali Acc: 0.275 Test Loss: 1.475 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.6130824089050293
Epoch: 3, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.450 Vali Acc: 0.300 Test Loss: 1.450 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 0.7068498134613037
Epoch: 4, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.419 Vali Acc: 0.325 Test Loss: 1.419 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.6059770584106445
Epoch: 5, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.382 Vali Acc: 0.350 Test Loss: 1.382 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.7225649356842041
Epoch: 6, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.342 Vali Acc: 0.375 Test Loss: 1.342 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.6901133060455322
Epoch: 7, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.301 Vali Acc: 0.400 Test Loss: 1.301 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.6900863647460938
Epoch: 8, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.262 Vali Acc: 0.475 Test Loss: 1.262 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.6156167984008789
Epoch: 9, Steps: 3 | Train Loss: 0.977 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.7300536632537842
Epoch: 10, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.6888139247894287
Epoch: 11, Steps: 3 | Train Loss: 0.863 Vali Loss: 1.164 Vali Acc: 0.550 Test Loss: 1.164 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.6278915405273438
Epoch: 12, Steps: 3 | Train Loss: 0.726 Vali Loss: 1.140 Vali Acc: 0.600 Test Loss: 1.140 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.6002583503723145
Epoch: 13, Steps: 3 | Train Loss: 0.667 Vali Loss: 1.120 Vali Acc: 0.625 Test Loss: 1.120 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.6137547492980957
Epoch: 14, Steps: 3 | Train Loss: 0.587 Vali Loss: 1.099 Vali Acc: 0.625 Test Loss: 1.099 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.7081289291381836
Epoch: 15, Steps: 3 | Train Loss: 0.567 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 0.5315706729888916
Epoch: 16, Steps: 3 | Train Loss: 0.565 Vali Loss: 1.062 Vali Acc: 0.650 Test Loss: 1.062 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 17 cost time: 0.7370963096618652
Epoch: 17, Steps: 3 | Train Loss: 0.440 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 0.6643414497375488
Epoch: 18, Steps: 3 | Train Loss: 0.345 Vali Loss: 1.032 Vali Acc: 0.700 Test Loss: 1.032 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 19 cost time: 0.7049109935760498
Epoch: 19, Steps: 3 | Train Loss: 0.349 Vali Loss: 1.019 Vali Acc: 0.700 Test Loss: 1.019 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.7033510208129883
Epoch: 20, Steps: 3 | Train Loss: 0.313 Vali Loss: 1.002 Vali Acc: 0.700 Test Loss: 1.002 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 21 cost time: 0.7262313365936279
Epoch: 21, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.989 Vali Acc: 0.700 Test Loss: 0.989 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 22 cost time: 0.6443085670471191
Epoch: 22, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.983 Vali Acc: 0.725 Test Loss: 0.983 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 23 cost time: 0.718616247177124
Epoch: 23, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.979 Vali Acc: 0.725 Test Loss: 0.979 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 24 cost time: 0.677187442779541
Epoch: 24, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.980 Vali Acc: 0.750 Test Loss: 0.980 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 25 cost time: 0.6946136951446533
Epoch: 25, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.982 Vali Acc: 0.750 Test Loss: 0.982 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7272450923919678
Epoch: 26, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6762180328369141
Epoch: 27, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.985 Vali Acc: 0.750 Test Loss: 0.985 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6557049751281738
Epoch: 28, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.980 Vali Acc: 0.750 Test Loss: 0.980 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 29 cost time: 0.6524238586425781
Epoch: 29, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.976 Vali Acc: 0.750 Test Loss: 0.976 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 30 cost time: 0.7260942459106445
Epoch: 30, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.970 Vali Acc: 0.750 Test Loss: 0.970 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 31 cost time: 0.7269282341003418
Epoch: 31, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.967 Vali Acc: 0.750 Test Loss: 0.967 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 32 cost time: 0.7644293308258057
Epoch: 32, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.970 Vali Acc: 0.750 Test Loss: 0.970 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.745126485824585
Epoch: 33, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.976 Vali Acc: 0.725 Test Loss: 0.976 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8831040859222412
Epoch: 34, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.980 Vali Acc: 0.725 Test Loss: 0.980 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6224684715270996
Epoch: 35, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.985 Vali Acc: 0.725 Test Loss: 0.985 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7676336765289307
Epoch: 36, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.991 Vali Acc: 0.725 Test Loss: 0.991 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7600302696228027
Epoch: 37, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.995 Vali Acc: 0.725 Test Loss: 0.995 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7082061767578125
Epoch: 38, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.999 Vali Acc: 0.725 Test Loss: 0.999 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8413245677947998
Epoch: 39, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.001 Vali Acc: 0.725 Test Loss: 1.001 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7613651752471924
Epoch: 40, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.003 Vali Acc: 0.725 Test Loss: 1.003 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6967239379882812
Epoch: 41, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.001 Vali Acc: 0.725 Test Loss: 1.001 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 41380
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3917863368988037
Epoch: 1, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.362 Vali Acc: 0.350 Test Loss: 1.362 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.7303159236907959
Epoch: 2, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.344 Vali Acc: 0.350 Test Loss: 1.344 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.7270247936248779
Epoch: 3, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.329 Vali Acc: 0.350 Test Loss: 1.329 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.7028863430023193
Epoch: 4, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.313 Vali Acc: 0.350 Test Loss: 1.313 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.71065354347229
Epoch: 5, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.299 Vali Acc: 0.400 Test Loss: 1.299 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.7750966548919678
Epoch: 6, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.283 Vali Acc: 0.375 Test Loss: 1.283 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6722748279571533
Epoch: 7, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.265 Vali Acc: 0.425 Test Loss: 1.265 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.7267324924468994
Epoch: 8, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.247 Vali Acc: 0.450 Test Loss: 1.247 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 0.7299191951751709
Epoch: 9, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.232 Vali Acc: 0.450 Test Loss: 1.232 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 0.7269062995910645
Epoch: 10, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.6617722511291504
Epoch: 11, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.7235305309295654
Epoch: 12, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 0.683091402053833
Epoch: 13, Steps: 3 | Train Loss: 0.907 Vali Loss: 1.172 Vali Acc: 0.525 Test Loss: 1.172 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 0.6242945194244385
Epoch: 14, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.159 Vali Acc: 0.575 Test Loss: 1.159 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 0.6973018646240234
Epoch: 15, Steps: 3 | Train Loss: 0.746 Vali Loss: 1.145 Vali Acc: 0.575 Test Loss: 1.145 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 16 cost time: 0.6184391975402832
Epoch: 16, Steps: 3 | Train Loss: 0.659 Vali Loss: 1.132 Vali Acc: 0.575 Test Loss: 1.132 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 17 cost time: 0.7036468982696533
Epoch: 17, Steps: 3 | Train Loss: 0.672 Vali Loss: 1.120 Vali Acc: 0.575 Test Loss: 1.120 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 0.5714418888092041
Epoch: 18, Steps: 3 | Train Loss: 0.625 Vali Loss: 1.108 Vali Acc: 0.625 Test Loss: 1.108 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.6987066268920898
Epoch: 19, Steps: 3 | Train Loss: 0.585 Vali Loss: 1.096 Vali Acc: 0.625 Test Loss: 1.096 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 20 cost time: 0.6336674690246582
Epoch: 20, Steps: 3 | Train Loss: 0.532 Vali Loss: 1.085 Vali Acc: 0.625 Test Loss: 1.085 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 0.715548038482666
Epoch: 21, Steps: 3 | Train Loss: 0.485 Vali Loss: 1.074 Vali Acc: 0.625 Test Loss: 1.074 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 22 cost time: 0.6912059783935547
Epoch: 22, Steps: 3 | Train Loss: 0.422 Vali Loss: 1.064 Vali Acc: 0.625 Test Loss: 1.064 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.6663510799407959
Epoch: 23, Steps: 3 | Train Loss: 0.393 Vali Loss: 1.060 Vali Acc: 0.650 Test Loss: 1.060 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.6573047637939453
Epoch: 24, Steps: 3 | Train Loss: 0.395 Vali Loss: 1.054 Vali Acc: 0.650 Test Loss: 1.054 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 25 cost time: 0.6297204494476318
Epoch: 25, Steps: 3 | Train Loss: 0.360 Vali Loss: 1.052 Vali Acc: 0.650 Test Loss: 1.052 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 26 cost time: 0.6526491641998291
Epoch: 26, Steps: 3 | Train Loss: 0.273 Vali Loss: 1.046 Vali Acc: 0.650 Test Loss: 1.046 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 27 cost time: 0.7284858226776123
Epoch: 27, Steps: 3 | Train Loss: 0.236 Vali Loss: 1.045 Vali Acc: 0.650 Test Loss: 1.045 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 28 cost time: 0.6821122169494629
Epoch: 28, Steps: 3 | Train Loss: 0.201 Vali Loss: 1.045 Vali Acc: 0.650 Test Loss: 1.045 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7577695846557617
Epoch: 29, Steps: 3 | Train Loss: 0.181 Vali Loss: 1.042 Vali Acc: 0.650 Test Loss: 1.042 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 30 cost time: 0.5993432998657227
Epoch: 30, Steps: 3 | Train Loss: 0.202 Vali Loss: 1.040 Vali Acc: 0.650 Test Loss: 1.040 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 31 cost time: 0.6750991344451904
Epoch: 31, Steps: 3 | Train Loss: 0.176 Vali Loss: 1.037 Vali Acc: 0.650 Test Loss: 1.037 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 32 cost time: 0.6578137874603271
Epoch: 32, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.038 Vali Acc: 0.650 Test Loss: 1.038 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7744836807250977
Epoch: 33, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.042 Vali Acc: 0.675 Test Loss: 1.042 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 34 cost time: 0.7266778945922852
Epoch: 34, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.727863073348999
Epoch: 35, Steps: 3 | Train Loss: 0.116 Vali Loss: 1.045 Vali Acc: 0.700 Test Loss: 1.045 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 36 cost time: 0.6205306053161621
Epoch: 36, Steps: 3 | Train Loss: 0.099 Vali Loss: 1.048 Vali Acc: 0.700 Test Loss: 1.048 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6310386657714844
Epoch: 37, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.047 Vali Acc: 0.700 Test Loss: 1.047 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5954291820526123
Epoch: 38, Steps: 3 | Train Loss: 0.083 Vali Loss: 1.048 Vali Acc: 0.700 Test Loss: 1.048 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.749279260635376
Epoch: 39, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.048 Vali Acc: 0.700 Test Loss: 1.048 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7364184856414795
Epoch: 40, Steps: 3 | Train Loss: 0.074 Vali Loss: 1.047 Vali Acc: 0.700 Test Loss: 1.047 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7006804943084717
Epoch: 41, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.047 Vali Acc: 0.700 Test Loss: 1.047 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.631537914276123
Epoch: 42, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.046 Vali Acc: 0.700 Test Loss: 1.046 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7588212490081787
Epoch: 43, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.047 Vali Acc: 0.700 Test Loss: 1.047 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6729166507720947
Epoch: 44, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.047 Vali Acc: 0.725 Test Loss: 1.047 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 45 cost time: 0.7110097408294678
Epoch: 45, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.046 Vali Acc: 0.725 Test Loss: 1.046 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 46 cost time: 0.6822316646575928
Epoch: 46, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.048 Vali Acc: 0.750 Test Loss: 1.048 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 47 cost time: 0.7115428447723389
Epoch: 47, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.048 Vali Acc: 0.750 Test Loss: 1.048 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 48 cost time: 0.690678596496582
Epoch: 48, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.049 Vali Acc: 0.750 Test Loss: 1.049 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6731767654418945
Epoch: 49, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.050 Vali Acc: 0.750 Test Loss: 1.050 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6874535083770752
Epoch: 50, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.054 Vali Acc: 0.750 Test Loss: 1.054 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6828188896179199
Epoch: 51, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.055 Vali Acc: 0.750 Test Loss: 1.055 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.8369944095611572
Epoch: 52, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.057 Vali Acc: 0.750 Test Loss: 1.057 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.6851921081542969
Epoch: 53, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.062 Vali Acc: 0.750 Test Loss: 1.062 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6748847961425781
Epoch: 54, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.062 Vali Acc: 0.750 Test Loss: 1.062 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6272001266479492
Epoch: 55, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.065 Vali Acc: 0.750 Test Loss: 1.065 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.7219669818878174
Epoch: 56, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.066 Vali Acc: 0.750 Test Loss: 1.066 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.6959400177001953
Epoch: 57, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.068 Vali Acc: 0.750 Test Loss: 1.068 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 35396
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.382155179977417
Epoch: 1, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.445 Vali Acc: 0.250 Test Loss: 1.445 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.6597995758056641
Epoch: 2, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.426 Vali Acc: 0.250 Test Loss: 1.426 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.6420748233795166
Epoch: 3, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.411 Vali Acc: 0.250 Test Loss: 1.411 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.7679989337921143
Epoch: 4, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.395 Vali Acc: 0.250 Test Loss: 1.395 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.7108769416809082
Epoch: 5, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.376 Vali Acc: 0.350 Test Loss: 1.376 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.6743683815002441
Epoch: 6, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.358 Vali Acc: 0.325 Test Loss: 1.358 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6981954574584961
Epoch: 7, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.339 Vali Acc: 0.375 Test Loss: 1.339 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.7441403865814209
Epoch: 8, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.323 Vali Acc: 0.475 Test Loss: 1.323 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.7297422885894775
Epoch: 9, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.304 Vali Acc: 0.475 Test Loss: 1.304 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.7070858478546143
Epoch: 10, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.288 Vali Acc: 0.425 Test Loss: 1.288 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7167198657989502
Epoch: 11, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.272 Vali Acc: 0.425 Test Loss: 1.272 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7202792167663574
Epoch: 12, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.253 Vali Acc: 0.450 Test Loss: 1.253 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6874775886535645
Epoch: 13, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.237 Vali Acc: 0.475 Test Loss: 1.237 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 0.7014169692993164
Epoch: 14, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.221 Vali Acc: 0.475 Test Loss: 1.221 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 15 cost time: 0.6710166931152344
Epoch: 15, Steps: 3 | Train Loss: 0.813 Vali Loss: 1.206 Vali Acc: 0.525 Test Loss: 1.206 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.7181949615478516
Epoch: 16, Steps: 3 | Train Loss: 0.808 Vali Loss: 1.191 Vali Acc: 0.525 Test Loss: 1.191 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.6267359256744385
Epoch: 17, Steps: 3 | Train Loss: 0.718 Vali Loss: 1.175 Vali Acc: 0.525 Test Loss: 1.175 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 18 cost time: 0.610419750213623
Epoch: 18, Steps: 3 | Train Loss: 0.711 Vali Loss: 1.159 Vali Acc: 0.525 Test Loss: 1.159 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 19 cost time: 0.7186968326568604
Epoch: 19, Steps: 3 | Train Loss: 0.623 Vali Loss: 1.143 Vali Acc: 0.550 Test Loss: 1.143 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 20 cost time: 0.6676287651062012
Epoch: 20, Steps: 3 | Train Loss: 0.625 Vali Loss: 1.131 Vali Acc: 0.575 Test Loss: 1.131 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 21 cost time: 0.5889296531677246
Epoch: 21, Steps: 3 | Train Loss: 0.520 Vali Loss: 1.119 Vali Acc: 0.575 Test Loss: 1.119 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 22 cost time: 0.638965368270874
Epoch: 22, Steps: 3 | Train Loss: 0.591 Vali Loss: 1.107 Vali Acc: 0.600 Test Loss: 1.107 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.6200196743011475
Epoch: 23, Steps: 3 | Train Loss: 0.476 Vali Loss: 1.096 Vali Acc: 0.575 Test Loss: 1.096 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.622511625289917
Epoch: 24, Steps: 3 | Train Loss: 0.435 Vali Loss: 1.087 Vali Acc: 0.575 Test Loss: 1.087 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6596720218658447
Epoch: 25, Steps: 3 | Train Loss: 0.460 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 0.6198172569274902
Epoch: 26, Steps: 3 | Train Loss: 0.330 Vali Loss: 1.068 Vali Acc: 0.625 Test Loss: 1.068 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 27 cost time: 0.5820980072021484
Epoch: 27, Steps: 3 | Train Loss: 0.334 Vali Loss: 1.061 Vali Acc: 0.625 Test Loss: 1.061 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 28 cost time: 0.7076365947723389
Epoch: 28, Steps: 3 | Train Loss: 0.323 Vali Loss: 1.055 Vali Acc: 0.625 Test Loss: 1.055 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 29 cost time: 0.6591017246246338
Epoch: 29, Steps: 3 | Train Loss: 0.290 Vali Loss: 1.049 Vali Acc: 0.625 Test Loss: 1.049 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 30 cost time: 0.699345588684082
Epoch: 30, Steps: 3 | Train Loss: 0.207 Vali Loss: 1.049 Vali Acc: 0.625 Test Loss: 1.049 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 31 cost time: 0.6172661781311035
Epoch: 31, Steps: 3 | Train Loss: 0.245 Vali Loss: 1.045 Vali Acc: 0.625 Test Loss: 1.045 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 32 cost time: 0.6792709827423096
Epoch: 32, Steps: 3 | Train Loss: 0.204 Vali Loss: 1.037 Vali Acc: 0.625 Test Loss: 1.037 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 33 cost time: 0.6341748237609863
Epoch: 33, Steps: 3 | Train Loss: 0.158 Vali Loss: 1.029 Vali Acc: 0.625 Test Loss: 1.029 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 34 cost time: 0.7122306823730469
Epoch: 34, Steps: 3 | Train Loss: 0.177 Vali Loss: 1.020 Vali Acc: 0.650 Test Loss: 1.020 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 35 cost time: 0.6109991073608398
Epoch: 35, Steps: 3 | Train Loss: 0.156 Vali Loss: 1.012 Vali Acc: 0.650 Test Loss: 1.012 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 36 cost time: 0.6642682552337646
Epoch: 36, Steps: 3 | Train Loss: 0.151 Vali Loss: 1.006 Vali Acc: 0.650 Test Loss: 1.006 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 37 cost time: 0.7314627170562744
Epoch: 37, Steps: 3 | Train Loss: 0.127 Vali Loss: 1.002 Vali Acc: 0.650 Test Loss: 1.002 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 38 cost time: 0.5742306709289551
Epoch: 38, Steps: 3 | Train Loss: 0.111 Vali Loss: 1.002 Vali Acc: 0.675 Test Loss: 1.002 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 39 cost time: 0.601752519607544
Epoch: 39, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.999 Vali Acc: 0.675 Test Loss: 0.999 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 40 cost time: 0.5982394218444824
Epoch: 40, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.998 Vali Acc: 0.675 Test Loss: 0.998 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 41 cost time: 0.6308066844940186
Epoch: 41, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.996 Vali Acc: 0.675 Test Loss: 0.996 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 42 cost time: 0.6905031204223633
Epoch: 42, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.995 Vali Acc: 0.675 Test Loss: 0.995 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 43 cost time: 0.6857078075408936
Epoch: 43, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.993 Vali Acc: 0.675 Test Loss: 0.993 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 44 cost time: 0.7834610939025879
Epoch: 44, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.992 Vali Acc: 0.675 Test Loss: 0.992 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 45 cost time: 0.7651033401489258
Epoch: 45, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.997 Vali Acc: 0.675 Test Loss: 0.997 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8140926361083984
Epoch: 46, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.997 Vali Acc: 0.675 Test Loss: 0.997 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7008464336395264
Epoch: 47, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.999 Vali Acc: 0.675 Test Loss: 0.999 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.682283878326416
Epoch: 48, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.000 Vali Acc: 0.675 Test Loss: 1.000 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6775774955749512
Epoch: 49, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.997 Vali Acc: 0.675 Test Loss: 0.997 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7219831943511963
Epoch: 50, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.996 Vali Acc: 0.675 Test Loss: 0.996 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.674675464630127
Epoch: 51, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.993 Vali Acc: 0.675 Test Loss: 0.993 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.7176027297973633
Epoch: 52, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.988 Vali Acc: 0.675 Test Loss: 0.988 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 53 cost time: 0.813424825668335
Epoch: 53, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.983 Vali Acc: 0.675 Test Loss: 0.983 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 54 cost time: 0.6913223266601562
Epoch: 54, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.980 Vali Acc: 0.675 Test Loss: 0.980 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 55 cost time: 0.7487382888793945
Epoch: 55, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.975 Vali Acc: 0.675 Test Loss: 0.975 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 56 cost time: 0.6983764171600342
Epoch: 56, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.970 Vali Acc: 0.675 Test Loss: 0.970 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 57 cost time: 0.6631219387054443
Epoch: 57, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.966 Vali Acc: 0.675 Test Loss: 0.966 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 58 cost time: 0.6355090141296387
Epoch: 58, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.962 Vali Acc: 0.675 Test Loss: 0.962 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 59 cost time: 0.6755075454711914
Epoch: 59, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.960 Vali Acc: 0.700 Test Loss: 0.960 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 60 cost time: 0.7183938026428223
Epoch: 60, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.957 Vali Acc: 0.700 Test Loss: 0.957 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 61 cost time: 0.7508082389831543
Epoch: 61, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.953 Vali Acc: 0.700 Test Loss: 0.953 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 62 cost time: 0.6470448970794678
Epoch: 62, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.951 Vali Acc: 0.700 Test Loss: 0.951 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 63 cost time: 0.6129026412963867
Epoch: 63, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.950 Vali Acc: 0.700 Test Loss: 0.950 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 64 cost time: 0.6425766944885254
Epoch: 64, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.949 Vali Acc: 0.700 Test Loss: 0.949 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 65 cost time: 0.6644463539123535
Epoch: 65, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 66 cost time: 0.6595215797424316
Epoch: 66, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8884670734405518
Epoch: 67, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6780071258544922
Epoch: 68, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.951 Vali Acc: 0.700 Test Loss: 0.951 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.6872403621673584
Epoch: 69, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.950 Vali Acc: 0.700 Test Loss: 0.950 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.659135103225708
Epoch: 70, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.6905934810638428
Epoch: 71, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.6399576663970947
Epoch: 72, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.949 Vali Acc: 0.700 Test Loss: 0.949 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.668428897857666
Epoch: 73, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.6663069725036621
Epoch: 74, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.946 Vali Acc: 0.700 Test Loss: 0.946 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 75 cost time: 0.6327755451202393
Epoch: 75, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.946 Vali Acc: 0.700 Test Loss: 0.946 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 76 cost time: 0.7643837928771973
Epoch: 76, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 77 cost time: 0.6712446212768555
Epoch: 77, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 78 cost time: 0.6565558910369873
Epoch: 78, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.942 Vali Acc: 0.700 Test Loss: 0.942 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 79 cost time: 0.7008271217346191
Epoch: 79, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.940 Vali Acc: 0.700 Test Loss: 0.940 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 80 cost time: 0.601388692855835
Epoch: 80, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.940 Vali Acc: 0.700 Test Loss: 0.940 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.7866322994232178
Epoch: 81, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.939 Vali Acc: 0.700 Test Loss: 0.939 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 82 cost time: 0.6732807159423828
Epoch: 82, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.938 Vali Acc: 0.700 Test Loss: 0.938 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 83 cost time: 0.6561381816864014
Epoch: 83, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.937 Vali Acc: 0.700 Test Loss: 0.937 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 84 cost time: 0.6764023303985596
Epoch: 84, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.935 Vali Acc: 0.700 Test Loss: 0.935 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 85 cost time: 0.6505756378173828
Epoch: 85, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.932 Vali Acc: 0.700 Test Loss: 0.932 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 86 cost time: 0.6916191577911377
Epoch: 86, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.929 Vali Acc: 0.700 Test Loss: 0.929 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 87 cost time: 0.7176620960235596
Epoch: 87, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.926 Vali Acc: 0.700 Test Loss: 0.926 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 88 cost time: 0.5843627452850342
Epoch: 88, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.925 Vali Acc: 0.700 Test Loss: 0.925 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 89 cost time: 0.6683917045593262
Epoch: 89, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.924 Vali Acc: 0.700 Test Loss: 0.924 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 90 cost time: 0.7134218215942383
Epoch: 90, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.923 Vali Acc: 0.700 Test Loss: 0.923 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 91 cost time: 0.6950638294219971
Epoch: 91, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.920 Vali Acc: 0.700 Test Loss: 0.920 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 92 cost time: 0.5930929183959961
Epoch: 92, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.918 Vali Acc: 0.700 Test Loss: 0.918 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 93 cost time: 0.6485095024108887
Epoch: 93, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.916 Vali Acc: 0.700 Test Loss: 0.916 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 94 cost time: 0.5987293720245361
Epoch: 94, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.911 Vali Acc: 0.700 Test Loss: 0.911 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 95 cost time: 0.6086585521697998
Epoch: 95, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.908 Vali Acc: 0.700 Test Loss: 0.908 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 96 cost time: 0.7821733951568604
Epoch: 96, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.906 Vali Acc: 0.700 Test Loss: 0.906 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 97 cost time: 0.751960277557373
Epoch: 97, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.903 Vali Acc: 0.700 Test Loss: 0.903 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 98 cost time: 0.5884382724761963
Epoch: 98, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.900 Vali Acc: 0.700 Test Loss: 0.900 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 99 cost time: 0.7469878196716309
Epoch: 99, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.899 Vali Acc: 0.700 Test Loss: 0.899 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 100 cost time: 0.6157269477844238
Epoch: 100, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.897 Vali Acc: 0.700 Test Loss: 0.897 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 34020
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5069377422332764
Epoch: 1, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.519 Vali Acc: 0.175 Test Loss: 1.519 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.7114651203155518
Epoch: 2, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.518 Vali Acc: 0.200 Test Loss: 1.518 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.7262272834777832
Epoch: 3, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.518 Vali Acc: 0.200 Test Loss: 1.518 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7219574451446533
Epoch: 4, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.515 Vali Acc: 0.225 Test Loss: 1.515 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 5 cost time: 0.8833270072937012
Epoch: 5, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.508 Vali Acc: 0.250 Test Loss: 1.508 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249985).  Saving model ...
Epoch: 6 cost time: 0.7395777702331543
Epoch: 6, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.498 Vali Acc: 0.250 Test Loss: 1.498 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 7 cost time: 0.7436890602111816
Epoch: 7, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.487 Vali Acc: 0.250 Test Loss: 1.487 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 8 cost time: 0.8151609897613525
Epoch: 8, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.474 Vali Acc: 0.275 Test Loss: 1.474 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 9 cost time: 0.7249505519866943
Epoch: 9, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.460 Vali Acc: 0.275 Test Loss: 1.460 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 10 cost time: 0.7316601276397705
Epoch: 10, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.447 Vali Acc: 0.275 Test Loss: 1.447 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 11 cost time: 0.6876530647277832
Epoch: 11, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.433 Vali Acc: 0.275 Test Loss: 1.433 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 12 cost time: 0.7591552734375
Epoch: 12, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.419 Vali Acc: 0.300 Test Loss: 1.419 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 13 cost time: 0.6477012634277344
Epoch: 13, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.404 Vali Acc: 0.375 Test Loss: 1.404 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 14 cost time: 0.7980365753173828
Epoch: 14, Steps: 3 | Train Loss: 0.844 Vali Loss: 1.390 Vali Acc: 0.425 Test Loss: 1.390 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 15 cost time: 0.777517557144165
Epoch: 15, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.377 Vali Acc: 0.425 Test Loss: 1.377 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 16 cost time: 0.84340500831604
Epoch: 16, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.365 Vali Acc: 0.425 Test Loss: 1.365 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 17 cost time: 0.8023171424865723
Epoch: 17, Steps: 3 | Train Loss: 0.711 Vali Loss: 1.353 Vali Acc: 0.425 Test Loss: 1.353 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 18 cost time: 0.6898453235626221
Epoch: 18, Steps: 3 | Train Loss: 0.699 Vali Loss: 1.340 Vali Acc: 0.425 Test Loss: 1.340 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 19 cost time: 0.7778844833374023
Epoch: 19, Steps: 3 | Train Loss: 0.677 Vali Loss: 1.330 Vali Acc: 0.450 Test Loss: 1.330 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 20 cost time: 0.6676082611083984
Epoch: 20, Steps: 3 | Train Loss: 0.597 Vali Loss: 1.320 Vali Acc: 0.450 Test Loss: 1.320 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 21 cost time: 0.7254762649536133
Epoch: 21, Steps: 3 | Train Loss: 0.595 Vali Loss: 1.309 Vali Acc: 0.475 Test Loss: 1.309 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 22 cost time: 0.6943957805633545
Epoch: 22, Steps: 3 | Train Loss: 0.551 Vali Loss: 1.297 Vali Acc: 0.550 Test Loss: 1.297 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 23 cost time: 0.7570865154266357
Epoch: 23, Steps: 3 | Train Loss: 0.518 Vali Loss: 1.286 Vali Acc: 0.550 Test Loss: 1.286 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 24 cost time: 0.7470488548278809
Epoch: 24, Steps: 3 | Train Loss: 0.486 Vali Loss: 1.276 Vali Acc: 0.525 Test Loss: 1.276 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7248959541320801
Epoch: 25, Steps: 3 | Train Loss: 0.503 Vali Loss: 1.265 Vali Acc: 0.550 Test Loss: 1.265 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 26 cost time: 0.6887514591217041
Epoch: 26, Steps: 3 | Train Loss: 0.475 Vali Loss: 1.255 Vali Acc: 0.575 Test Loss: 1.255 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 27 cost time: 0.7074143886566162
Epoch: 27, Steps: 3 | Train Loss: 0.389 Vali Loss: 1.243 Vali Acc: 0.575 Test Loss: 1.243 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 28 cost time: 0.7124648094177246
Epoch: 28, Steps: 3 | Train Loss: 0.376 Vali Loss: 1.234 Vali Acc: 0.575 Test Loss: 1.234 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 29 cost time: 0.8751623630523682
Epoch: 29, Steps: 3 | Train Loss: 0.369 Vali Loss: 1.223 Vali Acc: 0.575 Test Loss: 1.223 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 30 cost time: 0.6515233516693115
Epoch: 30, Steps: 3 | Train Loss: 0.324 Vali Loss: 1.214 Vali Acc: 0.600 Test Loss: 1.214 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 31 cost time: 0.7557156085968018
Epoch: 31, Steps: 3 | Train Loss: 0.328 Vali Loss: 1.206 Vali Acc: 0.600 Test Loss: 1.206 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 32 cost time: 0.6808111667633057
Epoch: 32, Steps: 3 | Train Loss: 0.266 Vali Loss: 1.199 Vali Acc: 0.600 Test Loss: 1.199 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 33 cost time: 0.6418881416320801
Epoch: 33, Steps: 3 | Train Loss: 0.255 Vali Loss: 1.190 Vali Acc: 0.625 Test Loss: 1.190 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 34 cost time: 0.7608585357666016
Epoch: 34, Steps: 3 | Train Loss: 0.236 Vali Loss: 1.182 Vali Acc: 0.625 Test Loss: 1.182 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 35 cost time: 0.6416842937469482
Epoch: 35, Steps: 3 | Train Loss: 0.230 Vali Loss: 1.177 Vali Acc: 0.625 Test Loss: 1.177 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 36 cost time: 0.6946737766265869
Epoch: 36, Steps: 3 | Train Loss: 0.205 Vali Loss: 1.176 Vali Acc: 0.650 Test Loss: 1.176 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 37 cost time: 0.7543666362762451
Epoch: 37, Steps: 3 | Train Loss: 0.229 Vali Loss: 1.175 Vali Acc: 0.675 Test Loss: 1.175 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 38 cost time: 0.6209676265716553
Epoch: 38, Steps: 3 | Train Loss: 0.210 Vali Loss: 1.173 Vali Acc: 0.675 Test Loss: 1.173 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 39 cost time: 0.6296920776367188
Epoch: 39, Steps: 3 | Train Loss: 0.212 Vali Loss: 1.172 Vali Acc: 0.675 Test Loss: 1.172 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 40 cost time: 0.6980915069580078
Epoch: 40, Steps: 3 | Train Loss: 0.150 Vali Loss: 1.173 Vali Acc: 0.675 Test Loss: 1.173 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6718590259552002
Epoch: 41, Steps: 3 | Train Loss: 0.136 Vali Loss: 1.171 Vali Acc: 0.675 Test Loss: 1.171 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 42 cost time: 0.6189146041870117
Epoch: 42, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.168 Vali Acc: 0.675 Test Loss: 1.168 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 43 cost time: 0.6185343265533447
Epoch: 43, Steps: 3 | Train Loss: 0.123 Vali Loss: 1.167 Vali Acc: 0.675 Test Loss: 1.167 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 44 cost time: 0.6146132946014404
Epoch: 44, Steps: 3 | Train Loss: 0.118 Vali Loss: 1.165 Vali Acc: 0.675 Test Loss: 1.165 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 45 cost time: 0.6555109024047852
Epoch: 45, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.160 Vali Acc: 0.675 Test Loss: 1.160 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 46 cost time: 0.7386906147003174
Epoch: 46, Steps: 3 | Train Loss: 0.098 Vali Loss: 1.157 Vali Acc: 0.675 Test Loss: 1.157 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 47 cost time: 0.6616153717041016
Epoch: 47, Steps: 3 | Train Loss: 0.099 Vali Loss: 1.155 Vali Acc: 0.675 Test Loss: 1.155 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 48 cost time: 0.6933774948120117
Epoch: 48, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.150 Vali Acc: 0.675 Test Loss: 1.150 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 49 cost time: 0.7163145542144775
Epoch: 49, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.147 Vali Acc: 0.675 Test Loss: 1.147 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 50 cost time: 0.7619423866271973
Epoch: 50, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.144 Vali Acc: 0.675 Test Loss: 1.144 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 51 cost time: 0.6597781181335449
Epoch: 51, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.140 Vali Acc: 0.675 Test Loss: 1.140 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 52 cost time: 0.6579194068908691
Epoch: 52, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.137 Vali Acc: 0.675 Test Loss: 1.137 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 53 cost time: 0.7163901329040527
Epoch: 53, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.136 Vali Acc: 0.675 Test Loss: 1.136 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 54 cost time: 0.651113748550415
Epoch: 54, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.135 Vali Acc: 0.675 Test Loss: 1.135 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 55 cost time: 0.7261519432067871
Epoch: 55, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.132 Vali Acc: 0.675 Test Loss: 1.132 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 56 cost time: 0.720435380935669
Epoch: 56, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.129 Vali Acc: 0.675 Test Loss: 1.129 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 57 cost time: 0.7076647281646729
Epoch: 57, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.126 Vali Acc: 0.675 Test Loss: 1.126 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 58 cost time: 0.6355843544006348
Epoch: 58, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.122 Vali Acc: 0.675 Test Loss: 1.122 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 59 cost time: 0.6336934566497803
Epoch: 59, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.122 Vali Acc: 0.675 Test Loss: 1.122 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 60 cost time: 0.580909013748169
Epoch: 60, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.120 Vali Acc: 0.675 Test Loss: 1.120 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 61 cost time: 0.7349109649658203
Epoch: 61, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.119 Vali Acc: 0.675 Test Loss: 1.119 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 62 cost time: 0.702214241027832
Epoch: 62, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.114 Vali Acc: 0.675 Test Loss: 1.114 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 63 cost time: 0.5744755268096924
Epoch: 63, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.112 Vali Acc: 0.675 Test Loss: 1.112 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 64 cost time: 0.6304850578308105
Epoch: 64, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.110 Vali Acc: 0.675 Test Loss: 1.110 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 65 cost time: 0.7021551132202148
Epoch: 65, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.107 Vali Acc: 0.675 Test Loss: 1.107 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 66 cost time: 0.7129926681518555
Epoch: 66, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 67 cost time: 0.7467527389526367
Epoch: 67, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 68 cost time: 0.7195339202880859
Epoch: 68, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.107 Vali Acc: 0.675 Test Loss: 1.107 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.6457357406616211
Epoch: 69, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.7362864017486572
Epoch: 70, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.7720773220062256
Epoch: 71, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 72 cost time: 0.7576215267181396
Epoch: 72, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.099 Vali Acc: 0.675 Test Loss: 1.099 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 73 cost time: 0.6878964900970459
Epoch: 73, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.101 Vali Acc: 0.675 Test Loss: 1.101 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7412347793579102
Epoch: 74, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.100 Vali Acc: 0.675 Test Loss: 1.100 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.7396426200866699
Epoch: 75, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.095 Vali Acc: 0.675 Test Loss: 1.095 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 76 cost time: 0.6176669597625732
Epoch: 76, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 77 cost time: 0.6525990962982178
Epoch: 77, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.093 Vali Acc: 0.675 Test Loss: 1.093 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.7613024711608887
Epoch: 78, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.095 Vali Acc: 0.675 Test Loss: 1.095 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.650444746017456
Epoch: 79, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.095 Vali Acc: 0.675 Test Loss: 1.095 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.7763123512268066
Epoch: 80, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.094 Vali Acc: 0.675 Test Loss: 1.094 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.5836045742034912
Epoch: 81, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 82 cost time: 0.728888750076294
Epoch: 82, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.6515164375305176
Epoch: 83, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.089 Vali Acc: 0.675 Test Loss: 1.089 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 84 cost time: 0.6378366947174072
Epoch: 84, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.090 Vali Acc: 0.675 Test Loss: 1.090 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.6966617107391357
Epoch: 85, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.086 Vali Acc: 0.675 Test Loss: 1.086 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 86 cost time: 0.6306684017181396
Epoch: 86, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.087 Vali Acc: 0.675 Test Loss: 1.087 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.6853961944580078
Epoch: 87, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.084 Vali Acc: 0.675 Test Loss: 1.084 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 88 cost time: 0.8504664897918701
Epoch: 88, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.081 Vali Acc: 0.675 Test Loss: 1.081 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 89 cost time: 0.7064976692199707
Epoch: 89, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.079 Vali Acc: 0.675 Test Loss: 1.079 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 90 cost time: 0.7632348537445068
Epoch: 90, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.077 Vali Acc: 0.675 Test Loss: 1.077 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 91 cost time: 0.7572543621063232
Epoch: 91, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.075 Vali Acc: 0.675 Test Loss: 1.075 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 92 cost time: 0.6540603637695312
Epoch: 92, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.071 Vali Acc: 0.675 Test Loss: 1.071 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 93 cost time: 0.6155602931976318
Epoch: 93, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.071 Vali Acc: 0.675 Test Loss: 1.071 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.7067301273345947
Epoch: 94, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.069 Vali Acc: 0.675 Test Loss: 1.069 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 95 cost time: 0.7612206935882568
Epoch: 95, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.070 Vali Acc: 0.675 Test Loss: 1.070 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.648036003112793
Epoch: 96, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.070 Vali Acc: 0.675 Test Loss: 1.070 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.7812235355377197
Epoch: 97, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.068 Vali Acc: 0.675 Test Loss: 1.068 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 98 cost time: 0.637474775314331
Epoch: 98, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.064 Vali Acc: 0.675 Test Loss: 1.064 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 99 cost time: 0.640753984451294
Epoch: 99, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.060 Vali Acc: 0.675 Test Loss: 1.060 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 100 cost time: 0.6960885524749756
Epoch: 100, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.065 Vali Acc: 0.675 Test Loss: 1.065 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm32_nh4_df64_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 31876
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.410520553588867
Epoch: 1, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.433 Vali Acc: 0.350 Test Loss: 1.433 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.6080617904663086
Epoch: 2, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.390 Vali Acc: 0.400 Test Loss: 1.390 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.6553680896759033
Epoch: 3, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.345 Vali Acc: 0.425 Test Loss: 1.345 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.6583857536315918
Epoch: 4, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.296 Vali Acc: 0.425 Test Loss: 1.296 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.7065932750701904
Epoch: 5, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.251 Vali Acc: 0.475 Test Loss: 1.251 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.6085770130157471
Epoch: 6, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.206 Vali Acc: 0.525 Test Loss: 1.206 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.7094814777374268
Epoch: 7, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.171 Vali Acc: 0.525 Test Loss: 1.171 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.6131558418273926
Epoch: 8, Steps: 3 | Train Loss: 0.897 Vali Loss: 1.135 Vali Acc: 0.650 Test Loss: 1.135 Test Acc: 0.650
Validation loss decreased (-0.524988 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.6460816860198975
Epoch: 9, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 0.6563124656677246
Epoch: 10, Steps: 3 | Train Loss: 0.794 Vali Loss: 1.055 Vali Acc: 0.675 Test Loss: 1.055 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.6937699317932129
Epoch: 11, Steps: 3 | Train Loss: 0.665 Vali Loss: 1.033 Vali Acc: 0.675 Test Loss: 1.033 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.6069521903991699
Epoch: 12, Steps: 3 | Train Loss: 0.603 Vali Loss: 1.002 Vali Acc: 0.700 Test Loss: 1.002 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.6367819309234619
Epoch: 13, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.972 Vali Acc: 0.700 Test Loss: 0.972 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 0.6417224407196045
Epoch: 14, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.928 Vali Acc: 0.700 Test Loss: 0.928 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 0.5979821681976318
Epoch: 15, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.893 Vali Acc: 0.700 Test Loss: 0.893 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 0.621492862701416
Epoch: 16, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.864 Vali Acc: 0.700 Test Loss: 0.864 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 17 cost time: 0.6289949417114258
Epoch: 17, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.833 Vali Acc: 0.725 Test Loss: 0.833 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724992).  Saving model ...
Epoch: 18 cost time: 0.6255507469177246
Epoch: 18, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.815 Vali Acc: 0.775 Test Loss: 0.815 Test Acc: 0.775
Validation loss decreased (-0.724992 --> -0.774992).  Saving model ...
Epoch: 19 cost time: 0.7370860576629639
Epoch: 19, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.801 Vali Acc: 0.800 Test Loss: 0.801 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 0.60546875
Epoch: 20, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 0.6778833866119385
Epoch: 21, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.761 Vali Acc: 0.800 Test Loss: 0.761 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 22 cost time: 0.5262196063995361
Epoch: 22, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.731 Vali Acc: 0.825 Test Loss: 0.731 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 23 cost time: 0.5837695598602295
Epoch: 23, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.710 Vali Acc: 0.825 Test Loss: 0.710 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 24 cost time: 0.6593728065490723
Epoch: 24, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.700 Vali Acc: 0.825 Test Loss: 0.700 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 25 cost time: 0.7021167278289795
Epoch: 25, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.693 Vali Acc: 0.825 Test Loss: 0.693 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 26 cost time: 0.6508998870849609
Epoch: 26, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.691 Vali Acc: 0.825 Test Loss: 0.691 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 27 cost time: 0.5568094253540039
Epoch: 27, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.696 Vali Acc: 0.825 Test Loss: 0.696 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7063944339752197
Epoch: 28, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.697 Vali Acc: 0.825 Test Loss: 0.697 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.567537784576416
Epoch: 29, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.695 Vali Acc: 0.825 Test Loss: 0.695 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6061198711395264
Epoch: 30, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.693 Vali Acc: 0.825 Test Loss: 0.693 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7002320289611816
Epoch: 31, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.690 Vali Acc: 0.825 Test Loss: 0.690 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 32 cost time: 0.617795467376709
Epoch: 32, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.688 Vali Acc: 0.825 Test Loss: 0.688 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 33 cost time: 0.5982921123504639
Epoch: 33, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.685 Vali Acc: 0.825 Test Loss: 0.685 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 34 cost time: 0.5752575397491455
Epoch: 34, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.683 Vali Acc: 0.825 Test Loss: 0.683 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 35 cost time: 0.7476420402526855
Epoch: 35, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.680 Vali Acc: 0.825 Test Loss: 0.680 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 36 cost time: 0.694556713104248
Epoch: 36, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.680 Vali Acc: 0.825 Test Loss: 0.680 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 37 cost time: 0.5788545608520508
Epoch: 37, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.678 Vali Acc: 0.825 Test Loss: 0.678 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 38 cost time: 0.6174163818359375
Epoch: 38, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.678 Vali Acc: 0.825 Test Loss: 0.678 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 39 cost time: 0.6190197467803955
Epoch: 39, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.675 Vali Acc: 0.825 Test Loss: 0.675 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 40 cost time: 0.5785872936248779
Epoch: 40, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.673 Vali Acc: 0.825 Test Loss: 0.673 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 41 cost time: 0.6090588569641113
Epoch: 41, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.672 Vali Acc: 0.825 Test Loss: 0.672 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 42 cost time: 0.6159543991088867
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.670 Vali Acc: 0.825 Test Loss: 0.670 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 43 cost time: 0.606778621673584
Epoch: 43, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.668 Vali Acc: 0.825 Test Loss: 0.668 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 44 cost time: 0.7732818126678467
Epoch: 44, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.666 Vali Acc: 0.825 Test Loss: 0.666 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 45 cost time: 0.5694234371185303
Epoch: 45, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 46 cost time: 0.6262493133544922
Epoch: 46, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.664 Vali Acc: 0.825 Test Loss: 0.664 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 47 cost time: 0.5928637981414795
Epoch: 47, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.664 Vali Acc: 0.825 Test Loss: 0.664 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 48 cost time: 0.5763087272644043
Epoch: 48, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.663 Vali Acc: 0.825 Test Loss: 0.663 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 49 cost time: 0.6049544811248779
Epoch: 49, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 50 cost time: 0.6111741065979004
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.661 Vali Acc: 0.825 Test Loss: 0.661 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 51 cost time: 0.6444299221038818
Epoch: 51, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.659 Vali Acc: 0.825 Test Loss: 0.659 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 52 cost time: 0.6731767654418945
Epoch: 52, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.658 Vali Acc: 0.825 Test Loss: 0.658 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 53 cost time: 0.6307706832885742
Epoch: 53, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.659 Vali Acc: 0.825 Test Loss: 0.659 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.682701587677002
Epoch: 54, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.659 Vali Acc: 0.825 Test Loss: 0.659 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5841934680938721
Epoch: 55, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.658 Vali Acc: 0.825 Test Loss: 0.658 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 56 cost time: 0.6266462802886963
Epoch: 56, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.657 Vali Acc: 0.825 Test Loss: 0.657 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 57 cost time: 0.6744165420532227
Epoch: 57, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.657 Vali Acc: 0.825 Test Loss: 0.657 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6692070960998535
Epoch: 58, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.657 Vali Acc: 0.825 Test Loss: 0.657 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.6344649791717529
Epoch: 59, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.658 Vali Acc: 0.825 Test Loss: 0.658 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7331998348236084
Epoch: 60, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.660 Vali Acc: 0.825 Test Loss: 0.660 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.7635157108306885
Epoch: 61, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.660 Vali Acc: 0.825 Test Loss: 0.660 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.6297869682312012
Epoch: 62, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.661 Vali Acc: 0.825 Test Loss: 0.661 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.6852321624755859
Epoch: 63, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.661 Vali Acc: 0.825 Test Loss: 0.661 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.6002447605133057
Epoch: 64, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.7442061901092529
Epoch: 65, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.663 Vali Acc: 0.825 Test Loss: 0.663 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.7490599155426025
Epoch: 66, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 48132
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3361105918884277
Epoch: 1, Steps: 3 | Train Loss: 1.635 Vali Loss: 1.560 Vali Acc: 0.225 Test Loss: 1.560 Test Acc: 0.225
Validation loss decreased (inf --> -0.224984).  Saving model ...
Epoch: 2 cost time: 0.6681292057037354
Epoch: 2, Steps: 3 | Train Loss: 1.591 Vali Loss: 1.524 Vali Acc: 0.250 Test Loss: 1.524 Test Acc: 0.250
Validation loss decreased (-0.224984 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.829766035079956
Epoch: 3, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.497 Vali Acc: 0.250 Test Loss: 1.497 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 0.6464002132415771
Epoch: 4, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.470 Vali Acc: 0.300 Test Loss: 1.470 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 0.6607804298400879
Epoch: 5, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.440 Vali Acc: 0.325 Test Loss: 1.440 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.6631369590759277
Epoch: 6, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.411 Vali Acc: 0.325 Test Loss: 1.411 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.6465387344360352
Epoch: 7, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.381 Vali Acc: 0.375 Test Loss: 1.381 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.8512101173400879
Epoch: 8, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.7594425678253174
Epoch: 9, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 0.7095763683319092
Epoch: 10, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.679234504699707
Epoch: 11, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.243 Vali Acc: 0.450 Test Loss: 1.243 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 12 cost time: 0.7171509265899658
Epoch: 12, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.215 Vali Acc: 0.475 Test Loss: 1.215 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 0.6446623802185059
Epoch: 13, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.7009642124176025
Epoch: 14, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.162 Vali Acc: 0.525 Test Loss: 1.162 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 0.8505492210388184
Epoch: 15, Steps: 3 | Train Loss: 0.715 Vali Loss: 1.139 Vali Acc: 0.550 Test Loss: 1.139 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 16 cost time: 0.7088813781738281
Epoch: 16, Steps: 3 | Train Loss: 0.690 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.762244701385498
Epoch: 17, Steps: 3 | Train Loss: 0.612 Vali Loss: 1.087 Vali Acc: 0.625 Test Loss: 1.087 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.5878536701202393
Epoch: 18, Steps: 3 | Train Loss: 0.551 Vali Loss: 1.055 Vali Acc: 0.650 Test Loss: 1.055 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 0.694666862487793
Epoch: 19, Steps: 3 | Train Loss: 0.516 Vali Loss: 1.026 Vali Acc: 0.675 Test Loss: 1.026 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 20 cost time: 0.6545464992523193
Epoch: 20, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.997 Vali Acc: 0.750 Test Loss: 0.997 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749990).  Saving model ...
Epoch: 21 cost time: 0.6388607025146484
Epoch: 21, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.968 Vali Acc: 0.775 Test Loss: 0.968 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 22 cost time: 0.6688401699066162
Epoch: 22, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.944 Vali Acc: 0.775 Test Loss: 0.944 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 23 cost time: 0.7112293243408203
Epoch: 23, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.919 Vali Acc: 0.750 Test Loss: 0.919 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7411344051361084
Epoch: 24, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.906 Vali Acc: 0.725 Test Loss: 0.906 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6728260517120361
Epoch: 25, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.896 Vali Acc: 0.700 Test Loss: 0.896 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6238288879394531
Epoch: 26, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.887 Vali Acc: 0.700 Test Loss: 0.887 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6247520446777344
Epoch: 27, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.869 Vali Acc: 0.675 Test Loss: 0.869 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7369799613952637
Epoch: 28, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.847 Vali Acc: 0.725 Test Loss: 0.847 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7496519088745117
Epoch: 29, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.836 Vali Acc: 0.725 Test Loss: 0.836 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7122869491577148
Epoch: 30, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.836 Vali Acc: 0.725 Test Loss: 0.836 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6707680225372314
Epoch: 31, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.837 Vali Acc: 0.750 Test Loss: 0.837 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8476481437683105
Epoch: 32, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.835 Vali Acc: 0.750 Test Loss: 0.835 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 41636
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.508953809738159
Epoch: 1, Steps: 3 | Train Loss: 1.548 Vali Loss: 1.687 Vali Acc: 0.225 Test Loss: 1.687 Test Acc: 0.225
Validation loss decreased (inf --> -0.224983).  Saving model ...
Epoch: 2 cost time: 0.7682301998138428
Epoch: 2, Steps: 3 | Train Loss: 1.571 Vali Loss: 1.631 Vali Acc: 0.225 Test Loss: 1.631 Test Acc: 0.225
Validation loss decreased (-0.224983 --> -0.224984).  Saving model ...
Epoch: 3 cost time: 0.6667804718017578
Epoch: 3, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.588 Vali Acc: 0.225 Test Loss: 1.588 Test Acc: 0.225
Validation loss decreased (-0.224984 --> -0.224984).  Saving model ...
Epoch: 4 cost time: 0.6847119331359863
Epoch: 4, Steps: 3 | Train Loss: 1.559 Vali Loss: 1.547 Vali Acc: 0.200 Test Loss: 1.547 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6527101993560791
Epoch: 5, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.505 Vali Acc: 0.325 Test Loss: 1.505 Test Acc: 0.325
Validation loss decreased (-0.224984 --> -0.324985).  Saving model ...
Epoch: 6 cost time: 0.6926591396331787
Epoch: 6, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.470 Vali Acc: 0.425 Test Loss: 1.470 Test Acc: 0.425
Validation loss decreased (-0.324985 --> -0.424985).  Saving model ...
Epoch: 7 cost time: 0.6773486137390137
Epoch: 7, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.433 Vali Acc: 0.375 Test Loss: 1.433 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6894450187683105
Epoch: 8, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.399 Vali Acc: 0.450 Test Loss: 1.399 Test Acc: 0.450
Validation loss decreased (-0.424985 --> -0.449986).  Saving model ...
Epoch: 9 cost time: 0.6866025924682617
Epoch: 9, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.365 Vali Acc: 0.450 Test Loss: 1.365 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 10 cost time: 0.7009978294372559
Epoch: 10, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.333 Vali Acc: 0.450 Test Loss: 1.333 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.743018388748169
Epoch: 11, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.297 Vali Acc: 0.450 Test Loss: 1.297 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.7559859752655029
Epoch: 12, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.724907398223877
Epoch: 13, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.6757509708404541
Epoch: 14, Steps: 3 | Train Loss: 0.846 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 0.648489236831665
Epoch: 15, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.184 Vali Acc: 0.525 Test Loss: 1.184 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.7394542694091797
Epoch: 16, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.161 Vali Acc: 0.525 Test Loss: 1.161 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.8126888275146484
Epoch: 17, Steps: 3 | Train Loss: 0.626 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6862263679504395
Epoch: 18, Steps: 3 | Train Loss: 0.632 Vali Loss: 1.121 Vali Acc: 0.550 Test Loss: 1.121 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 19 cost time: 0.8670568466186523
Epoch: 19, Steps: 3 | Train Loss: 0.604 Vali Loss: 1.104 Vali Acc: 0.550 Test Loss: 1.104 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 20 cost time: 0.6985063552856445
Epoch: 20, Steps: 3 | Train Loss: 0.513 Vali Loss: 1.084 Vali Acc: 0.575 Test Loss: 1.084 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 21 cost time: 0.7963364124298096
Epoch: 21, Steps: 3 | Train Loss: 0.534 Vali Loss: 1.055 Vali Acc: 0.575 Test Loss: 1.055 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 22 cost time: 0.724571704864502
Epoch: 22, Steps: 3 | Train Loss: 0.445 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.7104737758636475
Epoch: 23, Steps: 3 | Train Loss: 0.428 Vali Loss: 1.015 Vali Acc: 0.625 Test Loss: 1.015 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 24 cost time: 0.6711962223052979
Epoch: 24, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.995 Vali Acc: 0.625 Test Loss: 0.995 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 25 cost time: 0.7310945987701416
Epoch: 25, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.969 Vali Acc: 0.625 Test Loss: 0.969 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 26 cost time: 0.6757543087005615
Epoch: 26, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699991).  Saving model ...
Epoch: 27 cost time: 0.680394172668457
Epoch: 27, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.937 Vali Acc: 0.675 Test Loss: 0.937 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8726882934570312
Epoch: 28, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.930 Vali Acc: 0.650 Test Loss: 0.930 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6584868431091309
Epoch: 29, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.928 Vali Acc: 0.625 Test Loss: 0.928 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6118204593658447
Epoch: 30, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.923 Vali Acc: 0.600 Test Loss: 0.923 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6010324954986572
Epoch: 31, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.919 Vali Acc: 0.600 Test Loss: 0.919 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6421623229980469
Epoch: 32, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.922 Vali Acc: 0.600 Test Loss: 0.922 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.64626145362854
Epoch: 33, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.921 Vali Acc: 0.600 Test Loss: 0.921 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.670738697052002
Epoch: 34, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.913 Vali Acc: 0.600 Test Loss: 0.913 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7801566123962402
Epoch: 35, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.908 Vali Acc: 0.600 Test Loss: 0.908 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.704261302947998
Epoch: 36, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.902 Vali Acc: 0.600 Test Loss: 0.902 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 38612
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.317901849746704
Epoch: 1, Steps: 3 | Train Loss: 1.564 Vali Loss: 1.460 Vali Acc: 0.225 Test Loss: 1.460 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.7027578353881836
Epoch: 2, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.448 Vali Acc: 0.250 Test Loss: 1.448 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.647559642791748
Epoch: 3, Steps: 3 | Train Loss: 1.522 Vali Loss: 1.434 Vali Acc: 0.250 Test Loss: 1.434 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.6400682926177979
Epoch: 4, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.416 Vali Acc: 0.250 Test Loss: 1.416 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.6101396083831787
Epoch: 5, Steps: 3 | Train Loss: 1.512 Vali Loss: 1.395 Vali Acc: 0.275 Test Loss: 1.395 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 0.5818233489990234
Epoch: 6, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.371 Vali Acc: 0.300 Test Loss: 1.371 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 0.6704912185668945
Epoch: 7, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.346 Vali Acc: 0.325 Test Loss: 1.346 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 8 cost time: 0.6447477340698242
Epoch: 8, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.319 Vali Acc: 0.400 Test Loss: 1.319 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.7670142650604248
Epoch: 9, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 0.7517337799072266
Epoch: 10, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.270 Vali Acc: 0.400 Test Loss: 1.270 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.6818587779998779
Epoch: 11, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.244 Vali Acc: 0.400 Test Loss: 1.244 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.713193416595459
Epoch: 12, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.220 Vali Acc: 0.425 Test Loss: 1.220 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 13 cost time: 0.7582623958587646
Epoch: 13, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.193 Vali Acc: 0.425 Test Loss: 1.193 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 14 cost time: 0.6966536045074463
Epoch: 14, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.168 Vali Acc: 0.450 Test Loss: 1.168 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 15 cost time: 0.8391830921173096
Epoch: 15, Steps: 3 | Train Loss: 0.801 Vali Loss: 1.140 Vali Acc: 0.450 Test Loss: 1.140 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449989).  Saving model ...
Epoch: 16 cost time: 0.6950576305389404
Epoch: 16, Steps: 3 | Train Loss: 0.718 Vali Loss: 1.117 Vali Acc: 0.525 Test Loss: 1.117 Test Acc: 0.525
Validation loss decreased (-0.449989 --> -0.524989).  Saving model ...
Epoch: 17 cost time: 0.6099803447723389
Epoch: 17, Steps: 3 | Train Loss: 0.757 Vali Loss: 1.091 Vali Acc: 0.550 Test Loss: 1.091 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 18 cost time: 0.8005495071411133
Epoch: 18, Steps: 3 | Train Loss: 0.724 Vali Loss: 1.071 Vali Acc: 0.550 Test Loss: 1.071 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 19 cost time: 0.6969163417816162
Epoch: 19, Steps: 3 | Train Loss: 0.649 Vali Loss: 1.049 Vali Acc: 0.550 Test Loss: 1.049 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549990).  Saving model ...
Epoch: 20 cost time: 0.7207131385803223
Epoch: 20, Steps: 3 | Train Loss: 0.648 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
Validation loss decreased (-0.549990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.7471959590911865
Epoch: 21, Steps: 3 | Train Loss: 0.582 Vali Loss: 1.012 Vali Acc: 0.600 Test Loss: 1.012 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.6927905082702637
Epoch: 22, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.999 Vali Acc: 0.600 Test Loss: 0.999 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.6712019443511963
Epoch: 23, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.986 Vali Acc: 0.625 Test Loss: 0.986 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 24 cost time: 0.7363383769989014
Epoch: 24, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.975 Vali Acc: 0.625 Test Loss: 0.975 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 25 cost time: 0.6992104053497314
Epoch: 25, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.961 Vali Acc: 0.650 Test Loss: 0.961 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 26 cost time: 0.6842560768127441
Epoch: 26, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.945 Vali Acc: 0.675 Test Loss: 0.945 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 27 cost time: 0.7170977592468262
Epoch: 27, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.920 Vali Acc: 0.650 Test Loss: 0.920 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7730522155761719
Epoch: 28, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.909 Vali Acc: 0.675 Test Loss: 0.909 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 29 cost time: 0.6634097099304199
Epoch: 29, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.896 Vali Acc: 0.675 Test Loss: 0.896 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 30 cost time: 0.6794145107269287
Epoch: 30, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.885 Vali Acc: 0.675 Test Loss: 0.885 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 31 cost time: 0.710885763168335
Epoch: 31, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.873 Vali Acc: 0.700 Test Loss: 0.873 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 32 cost time: 0.682119607925415
Epoch: 32, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.862 Vali Acc: 0.725 Test Loss: 0.862 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 33 cost time: 0.6498568058013916
Epoch: 33, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.850 Vali Acc: 0.725 Test Loss: 0.850 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 34 cost time: 0.6870877742767334
Epoch: 34, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 35 cost time: 0.6895918846130371
Epoch: 35, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 36 cost time: 0.7267675399780273
Epoch: 36, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 37 cost time: 0.7465839385986328
Epoch: 37, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6833837032318115
Epoch: 38, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 39 cost time: 0.6930902004241943
Epoch: 39, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 40 cost time: 0.7120516300201416
Epoch: 40, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.826 Vali Acc: 0.750 Test Loss: 0.826 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 41 cost time: 0.7419912815093994
Epoch: 41, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 42 cost time: 0.7093462944030762
Epoch: 42, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.825 Vali Acc: 0.725 Test Loss: 0.825 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6224648952484131
Epoch: 43, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 44 cost time: 0.7722342014312744
Epoch: 44, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.819 Vali Acc: 0.750 Test Loss: 0.819 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 45 cost time: 0.6163132190704346
Epoch: 45, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.815 Vali Acc: 0.775 Test Loss: 0.815 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 46 cost time: 0.6634762287139893
Epoch: 46, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 47 cost time: 0.6579558849334717
Epoch: 47, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6419398784637451
Epoch: 48, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.806 Vali Acc: 0.750 Test Loss: 0.806 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7075397968292236
Epoch: 49, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6783368587493896
Epoch: 50, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 51 cost time: 0.6800165176391602
Epoch: 51, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6117744445800781
Epoch: 52, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.789 Vali Acc: 0.750 Test Loss: 0.789 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6509754657745361
Epoch: 53, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6737239360809326
Epoch: 54, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.6411004066467285
Epoch: 55, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.6451785564422607
Epoch: 56, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 57 cost time: 0.7562777996063232
Epoch: 57, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.783 Vali Acc: 0.775 Test Loss: 0.783 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 58 cost time: 0.659003734588623
Epoch: 58, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.778 Vali Acc: 0.775 Test Loss: 0.778 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 59 cost time: 0.7577106952667236
Epoch: 59, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.776 Vali Acc: 0.775 Test Loss: 0.776 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 60 cost time: 0.6808302402496338
Epoch: 60, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.776 Vali Acc: 0.750 Test Loss: 0.776 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.671363353729248
Epoch: 61, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.773 Vali Acc: 0.750 Test Loss: 0.773 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8337011337280273
Epoch: 62, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.772 Vali Acc: 0.750 Test Loss: 0.772 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.650742769241333
Epoch: 63, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.6631767749786377
Epoch: 64, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.6556181907653809
Epoch: 65, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.8124916553497314
Epoch: 66, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.7003049850463867
Epoch: 67, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.772 Vali Acc: 0.750 Test Loss: 0.772 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.7764277458190918
Epoch: 68, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.772 Vali Acc: 0.775 Test Loss: 0.772 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 69 cost time: 0.7753598690032959
Epoch: 69, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7270898818969727
Epoch: 70, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.769 Vali Acc: 0.750 Test Loss: 0.769 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.8516273498535156
Epoch: 71, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.767 Vali Acc: 0.775 Test Loss: 0.767 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 72 cost time: 0.7338793277740479
Epoch: 72, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.766 Vali Acc: 0.775 Test Loss: 0.766 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 73 cost time: 0.6440343856811523
Epoch: 73, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 74 cost time: 0.713383674621582
Epoch: 74, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 75 cost time: 0.638230562210083
Epoch: 75, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.764 Vali Acc: 0.775 Test Loss: 0.764 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 76 cost time: 0.6912920475006104
Epoch: 76, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.760 Vali Acc: 0.775 Test Loss: 0.760 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 77 cost time: 0.8307685852050781
Epoch: 77, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.757 Vali Acc: 0.775 Test Loss: 0.757 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 78 cost time: 0.6519486904144287
Epoch: 78, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 79 cost time: 0.6965658664703369
Epoch: 79, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.754 Vali Acc: 0.775 Test Loss: 0.754 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 80 cost time: 0.6537671089172363
Epoch: 80, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.751 Vali Acc: 0.775 Test Loss: 0.751 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 81 cost time: 0.6494662761688232
Epoch: 81, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.712608814239502
Epoch: 82, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.7086739540100098
Epoch: 83, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.6734414100646973
Epoch: 84, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.6952404975891113
Epoch: 85, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.6776955127716064
Epoch: 86, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.754 Vali Acc: 0.775 Test Loss: 0.754 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.6576433181762695
Epoch: 87, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.755 Vali Acc: 0.775 Test Loss: 0.755 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.708686113357544
Epoch: 88, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.755 Vali Acc: 0.775 Test Loss: 0.755 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.8339743614196777
Epoch: 89, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.755 Vali Acc: 0.775 Test Loss: 0.755 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.752204179763794
Epoch: 90, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 36724
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4197421073913574
Epoch: 1, Steps: 3 | Train Loss: 1.543 Vali Loss: 1.436 Vali Acc: 0.350 Test Loss: 1.436 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.684239387512207
Epoch: 2, Steps: 3 | Train Loss: 1.559 Vali Loss: 1.415 Vali Acc: 0.300 Test Loss: 1.415 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6399736404418945
Epoch: 3, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.400 Vali Acc: 0.300 Test Loss: 1.400 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6295166015625
Epoch: 4, Steps: 3 | Train Loss: 1.471 Vali Loss: 1.387 Vali Acc: 0.350 Test Loss: 1.387 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.6803090572357178
Epoch: 5, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.376 Vali Acc: 0.400 Test Loss: 1.376 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.8138322830200195
Epoch: 6, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.365 Vali Acc: 0.375 Test Loss: 1.365 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7823045253753662
Epoch: 7, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.354 Vali Acc: 0.400 Test Loss: 1.354 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 0.6851058006286621
Epoch: 8, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.340 Vali Acc: 0.375 Test Loss: 1.340 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7326626777648926
Epoch: 9, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.327 Vali Acc: 0.475 Test Loss: 1.327 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.6353826522827148
Epoch: 10, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.313 Vali Acc: 0.475 Test Loss: 1.313 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.7331323623657227
Epoch: 11, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.300 Vali Acc: 0.475 Test Loss: 1.300 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 0.7019975185394287
Epoch: 12, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.7453024387359619
Epoch: 13, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.271 Vali Acc: 0.525 Test Loss: 1.271 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 14 cost time: 0.6857495307922363
Epoch: 14, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.257 Vali Acc: 0.550 Test Loss: 1.257 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 15 cost time: 0.7268722057342529
Epoch: 15, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.244 Vali Acc: 0.550 Test Loss: 1.244 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 16 cost time: 0.6908645629882812
Epoch: 16, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.236 Vali Acc: 0.575 Test Loss: 1.236 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 17 cost time: 0.6978321075439453
Epoch: 17, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.225 Vali Acc: 0.575 Test Loss: 1.225 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 18 cost time: 0.634662389755249
Epoch: 18, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.214 Vali Acc: 0.575 Test Loss: 1.214 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.663628101348877
Epoch: 19, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.205 Vali Acc: 0.575 Test Loss: 1.205 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.754479169845581
Epoch: 20, Steps: 3 | Train Loss: 0.818 Vali Loss: 1.196 Vali Acc: 0.575 Test Loss: 1.196 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.6968779563903809
Epoch: 21, Steps: 3 | Train Loss: 0.814 Vali Loss: 1.187 Vali Acc: 0.575 Test Loss: 1.187 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 22 cost time: 0.759913444519043
Epoch: 22, Steps: 3 | Train Loss: 0.711 Vali Loss: 1.179 Vali Acc: 0.575 Test Loss: 1.179 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 23 cost time: 0.6735610961914062
Epoch: 23, Steps: 3 | Train Loss: 0.769 Vali Loss: 1.170 Vali Acc: 0.600 Test Loss: 1.170 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 24 cost time: 0.6635532379150391
Epoch: 24, Steps: 3 | Train Loss: 0.694 Vali Loss: 1.161 Vali Acc: 0.600 Test Loss: 1.161 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 25 cost time: 0.606309175491333
Epoch: 25, Steps: 3 | Train Loss: 0.667 Vali Loss: 1.152 Vali Acc: 0.625 Test Loss: 1.152 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 26 cost time: 0.8215885162353516
Epoch: 26, Steps: 3 | Train Loss: 0.670 Vali Loss: 1.140 Vali Acc: 0.625 Test Loss: 1.140 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 27 cost time: 0.6962063312530518
Epoch: 27, Steps: 3 | Train Loss: 0.528 Vali Loss: 1.129 Vali Acc: 0.625 Test Loss: 1.129 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 28 cost time: 0.6921772956848145
Epoch: 28, Steps: 3 | Train Loss: 0.565 Vali Loss: 1.114 Vali Acc: 0.625 Test Loss: 1.114 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 29 cost time: 0.7030854225158691
Epoch: 29, Steps: 3 | Train Loss: 0.562 Vali Loss: 1.100 Vali Acc: 0.625 Test Loss: 1.100 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 30 cost time: 0.6290810108184814
Epoch: 30, Steps: 3 | Train Loss: 0.519 Vali Loss: 1.089 Vali Acc: 0.650 Test Loss: 1.089 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 31 cost time: 0.6895923614501953
Epoch: 31, Steps: 3 | Train Loss: 0.488 Vali Loss: 1.080 Vali Acc: 0.650 Test Loss: 1.080 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 32 cost time: 0.7058818340301514
Epoch: 32, Steps: 3 | Train Loss: 0.468 Vali Loss: 1.075 Vali Acc: 0.675 Test Loss: 1.075 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 33 cost time: 0.7687487602233887
Epoch: 33, Steps: 3 | Train Loss: 0.378 Vali Loss: 1.068 Vali Acc: 0.675 Test Loss: 1.068 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 34 cost time: 0.7527613639831543
Epoch: 34, Steps: 3 | Train Loss: 0.375 Vali Loss: 1.060 Vali Acc: 0.675 Test Loss: 1.060 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 35 cost time: 0.785733699798584
Epoch: 35, Steps: 3 | Train Loss: 0.395 Vali Loss: 1.055 Vali Acc: 0.675 Test Loss: 1.055 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 36 cost time: 0.7459502220153809
Epoch: 36, Steps: 3 | Train Loss: 0.364 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 37 cost time: 0.7336137294769287
Epoch: 37, Steps: 3 | Train Loss: 0.275 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7371532917022705
Epoch: 38, Steps: 3 | Train Loss: 0.304 Vali Loss: 1.051 Vali Acc: 0.650 Test Loss: 1.051 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6355125904083252
Epoch: 39, Steps: 3 | Train Loss: 0.273 Vali Loss: 1.051 Vali Acc: 0.650 Test Loss: 1.051 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7343168258666992
Epoch: 40, Steps: 3 | Train Loss: 0.246 Vali Loss: 1.050 Vali Acc: 0.650 Test Loss: 1.050 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7448170185089111
Epoch: 41, Steps: 3 | Train Loss: 0.249 Vali Loss: 1.049 Vali Acc: 0.650 Test Loss: 1.049 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6909677982330322
Epoch: 42, Steps: 3 | Train Loss: 0.218 Vali Loss: 1.048 Vali Acc: 0.675 Test Loss: 1.048 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 43 cost time: 0.7683374881744385
Epoch: 43, Steps: 3 | Train Loss: 0.204 Vali Loss: 1.050 Vali Acc: 0.675 Test Loss: 1.050 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7446763515472412
Epoch: 44, Steps: 3 | Train Loss: 0.206 Vali Loss: 1.047 Vali Acc: 0.650 Test Loss: 1.047 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.708200216293335
Epoch: 45, Steps: 3 | Train Loss: 0.165 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 46 cost time: 0.7581002712249756
Epoch: 46, Steps: 3 | Train Loss: 0.161 Vali Loss: 1.045 Vali Acc: 0.675 Test Loss: 1.045 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 47 cost time: 0.8200132846832275
Epoch: 47, Steps: 3 | Train Loss: 0.155 Vali Loss: 1.044 Vali Acc: 0.675 Test Loss: 1.044 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 48 cost time: 0.6707124710083008
Epoch: 48, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.044 Vali Acc: 0.675 Test Loss: 1.044 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7017459869384766
Epoch: 49, Steps: 3 | Train Loss: 0.122 Vali Loss: 1.042 Vali Acc: 0.650 Test Loss: 1.042 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7490739822387695
Epoch: 50, Steps: 3 | Train Loss: 0.135 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7317850589752197
Epoch: 51, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6553013324737549
Epoch: 52, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.045 Vali Acc: 0.650 Test Loss: 1.045 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.7337319850921631
Epoch: 53, Steps: 3 | Train Loss: 0.110 Vali Loss: 1.047 Vali Acc: 0.650 Test Loss: 1.047 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.7081303596496582
Epoch: 54, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.7563676834106445
Epoch: 55, Steps: 3 | Train Loss: 0.099 Vali Loss: 1.051 Vali Acc: 0.700 Test Loss: 1.051 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699989).  Saving model ...
Epoch: 56 cost time: 0.7680435180664062
Epoch: 56, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.054 Vali Acc: 0.700 Test Loss: 1.054 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7632176876068115
Epoch: 57, Steps: 3 | Train Loss: 0.098 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7550690174102783
Epoch: 58, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6374046802520752
Epoch: 59, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.7760815620422363
Epoch: 60, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.051 Vali Acc: 0.700 Test Loss: 1.051 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 61 cost time: 0.741182804107666
Epoch: 61, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7247462272644043
Epoch: 62, Steps: 3 | Train Loss: 0.079 Vali Loss: 1.051 Vali Acc: 0.700 Test Loss: 1.051 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 63 cost time: 0.6363985538482666
Epoch: 63, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 64 cost time: 0.6115126609802246
Epoch: 64, Steps: 3 | Train Loss: 0.060 Vali Loss: 1.047 Vali Acc: 0.700 Test Loss: 1.047 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 65 cost time: 0.7290134429931641
Epoch: 65, Steps: 3 | Train Loss: 0.055 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 66 cost time: 0.6364822387695312
Epoch: 66, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.042 Vali Acc: 0.675 Test Loss: 1.042 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6711146831512451
Epoch: 67, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.040 Vali Acc: 0.675 Test Loss: 1.040 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6947071552276611
Epoch: 68, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.035 Vali Acc: 0.675 Test Loss: 1.035 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.6815717220306396
Epoch: 69, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.031 Vali Acc: 0.675 Test Loss: 1.031 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.6477444171905518
Epoch: 70, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.028 Vali Acc: 0.675 Test Loss: 1.028 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.6545500755310059
Epoch: 71, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.029 Vali Acc: 0.675 Test Loss: 1.029 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.6472370624542236
Epoch: 72, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.031 Vali Acc: 0.675 Test Loss: 1.031 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.6810727119445801
Epoch: 73, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.034 Vali Acc: 0.675 Test Loss: 1.034 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.7709167003631592
Epoch: 74, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.039 Vali Acc: 0.675 Test Loss: 1.039 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.7096734046936035
Epoch: 75, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.044 Vali Acc: 0.675 Test Loss: 1.044 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 33732
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3691444396972656
Epoch: 1, Steps: 3 | Train Loss: 1.608 Vali Loss: 1.438 Vali Acc: 0.250 Test Loss: 1.438 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.7591304779052734
Epoch: 2, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.436 Vali Acc: 0.275 Test Loss: 1.436 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6072971820831299
Epoch: 3, Steps: 3 | Train Loss: 1.632 Vali Loss: 1.439 Vali Acc: 0.275 Test Loss: 1.439 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8088111877441406
Epoch: 4, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.442 Vali Acc: 0.250 Test Loss: 1.442 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7408874034881592
Epoch: 5, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.442 Vali Acc: 0.300 Test Loss: 1.442 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.8020355701446533
Epoch: 6, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.441 Vali Acc: 0.325 Test Loss: 1.441 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.7204291820526123
Epoch: 7, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.438 Vali Acc: 0.375 Test Loss: 1.438 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.7043642997741699
Epoch: 8, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.434 Vali Acc: 0.375 Test Loss: 1.434 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 9 cost time: 0.7542741298675537
Epoch: 9, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.427 Vali Acc: 0.450 Test Loss: 1.427 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449986).  Saving model ...
Epoch: 10 cost time: 0.7122683525085449
Epoch: 10, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.420 Vali Acc: 0.450 Test Loss: 1.420 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 11 cost time: 0.7196128368377686
Epoch: 11, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.411 Vali Acc: 0.450 Test Loss: 1.411 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 12 cost time: 0.7078583240509033
Epoch: 12, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.401 Vali Acc: 0.450 Test Loss: 1.401 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 13 cost time: 0.7328088283538818
Epoch: 13, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.392 Vali Acc: 0.450 Test Loss: 1.392 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 14 cost time: 0.7390255928039551
Epoch: 14, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.383 Vali Acc: 0.425 Test Loss: 1.383 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7882499694824219
Epoch: 15, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.373 Vali Acc: 0.425 Test Loss: 1.373 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7029318809509277
Epoch: 16, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.363 Vali Acc: 0.425 Test Loss: 1.363 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7195765972137451
Epoch: 17, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.353 Vali Acc: 0.450 Test Loss: 1.353 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 18 cost time: 0.6909570693969727
Epoch: 18, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.344 Vali Acc: 0.450 Test Loss: 1.344 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 19 cost time: 0.7177965641021729
Epoch: 19, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.337 Vali Acc: 0.425 Test Loss: 1.337 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7491466999053955
Epoch: 20, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.329 Vali Acc: 0.425 Test Loss: 1.329 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.733999490737915
Epoch: 21, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.319 Vali Acc: 0.425 Test Loss: 1.319 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7355093955993652
Epoch: 22, Steps: 3 | Train Loss: 0.793 Vali Loss: 1.310 Vali Acc: 0.450 Test Loss: 1.310 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 23 cost time: 0.7062411308288574
Epoch: 23, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.302 Vali Acc: 0.475 Test Loss: 1.302 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 24 cost time: 0.8004956245422363
Epoch: 24, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.291 Vali Acc: 0.475 Test Loss: 1.291 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 25 cost time: 0.7759804725646973
Epoch: 25, Steps: 3 | Train Loss: 0.797 Vali Loss: 1.282 Vali Acc: 0.475 Test Loss: 1.282 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 26 cost time: 0.6587932109832764
Epoch: 26, Steps: 3 | Train Loss: 0.677 Vali Loss: 1.274 Vali Acc: 0.475 Test Loss: 1.274 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 27 cost time: 0.6990280151367188
Epoch: 27, Steps: 3 | Train Loss: 0.633 Vali Loss: 1.269 Vali Acc: 0.475 Test Loss: 1.269 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 28 cost time: 0.711911678314209
Epoch: 28, Steps: 3 | Train Loss: 0.603 Vali Loss: 1.265 Vali Acc: 0.450 Test Loss: 1.265 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7934136390686035
Epoch: 29, Steps: 3 | Train Loss: 0.699 Vali Loss: 1.260 Vali Acc: 0.550 Test Loss: 1.260 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 30 cost time: 0.7036464214324951
Epoch: 30, Steps: 3 | Train Loss: 0.602 Vali Loss: 1.253 Vali Acc: 0.550 Test Loss: 1.253 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 31 cost time: 0.9285924434661865
Epoch: 31, Steps: 3 | Train Loss: 0.591 Vali Loss: 1.244 Vali Acc: 0.575 Test Loss: 1.244 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 32 cost time: 0.733060359954834
Epoch: 32, Steps: 3 | Train Loss: 0.568 Vali Loss: 1.234 Vali Acc: 0.575 Test Loss: 1.234 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 33 cost time: 0.6671884059906006
Epoch: 33, Steps: 3 | Train Loss: 0.515 Vali Loss: 1.222 Vali Acc: 0.575 Test Loss: 1.222 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 34 cost time: 0.7164156436920166
Epoch: 34, Steps: 3 | Train Loss: 0.441 Vali Loss: 1.209 Vali Acc: 0.550 Test Loss: 1.209 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8839540481567383
Epoch: 35, Steps: 3 | Train Loss: 0.530 Vali Loss: 1.195 Vali Acc: 0.575 Test Loss: 1.195 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 36 cost time: 0.7539539337158203
Epoch: 36, Steps: 3 | Train Loss: 0.439 Vali Loss: 1.181 Vali Acc: 0.575 Test Loss: 1.181 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 37 cost time: 0.6051723957061768
Epoch: 37, Steps: 3 | Train Loss: 0.433 Vali Loss: 1.169 Vali Acc: 0.600 Test Loss: 1.169 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 38 cost time: 0.7007660865783691
Epoch: 38, Steps: 3 | Train Loss: 0.413 Vali Loss: 1.159 Vali Acc: 0.625 Test Loss: 1.159 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 39 cost time: 0.7114226818084717
Epoch: 39, Steps: 3 | Train Loss: 0.395 Vali Loss: 1.147 Vali Acc: 0.625 Test Loss: 1.147 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 40 cost time: 0.7086837291717529
Epoch: 40, Steps: 3 | Train Loss: 0.364 Vali Loss: 1.143 Vali Acc: 0.625 Test Loss: 1.143 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 41 cost time: 0.7290492057800293
Epoch: 41, Steps: 3 | Train Loss: 0.329 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 42 cost time: 0.7272934913635254
Epoch: 42, Steps: 3 | Train Loss: 0.310 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6907002925872803
Epoch: 43, Steps: 3 | Train Loss: 0.302 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6431851387023926
Epoch: 44, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6397666931152344
Epoch: 45, Steps: 3 | Train Loss: 0.241 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7085757255554199
Epoch: 46, Steps: 3 | Train Loss: 0.232 Vali Loss: 1.139 Vali Acc: 0.600 Test Loss: 1.139 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6980640888214111
Epoch: 47, Steps: 3 | Train Loss: 0.237 Vali Loss: 1.131 Vali Acc: 0.600 Test Loss: 1.131 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7284317016601562
Epoch: 48, Steps: 3 | Train Loss: 0.216 Vali Loss: 1.122 Vali Acc: 0.625 Test Loss: 1.122 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 49 cost time: 0.7050504684448242
Epoch: 49, Steps: 3 | Train Loss: 0.226 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 50 cost time: 0.6856167316436768
Epoch: 50, Steps: 3 | Train Loss: 0.183 Vali Loss: 1.107 Vali Acc: 0.625 Test Loss: 1.107 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 51 cost time: 0.6516146659851074
Epoch: 51, Steps: 3 | Train Loss: 0.175 Vali Loss: 1.097 Vali Acc: 0.625 Test Loss: 1.097 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 52 cost time: 0.6896893978118896
Epoch: 52, Steps: 3 | Train Loss: 0.162 Vali Loss: 1.086 Vali Acc: 0.625 Test Loss: 1.086 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 53 cost time: 0.6739223003387451
Epoch: 53, Steps: 3 | Train Loss: 0.149 Vali Loss: 1.077 Vali Acc: 0.625 Test Loss: 1.077 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 54 cost time: 0.7473502159118652
Epoch: 54, Steps: 3 | Train Loss: 0.144 Vali Loss: 1.068 Vali Acc: 0.625 Test Loss: 1.068 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 55 cost time: 0.7380151748657227
Epoch: 55, Steps: 3 | Train Loss: 0.153 Vali Loss: 1.059 Vali Acc: 0.625 Test Loss: 1.059 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 56 cost time: 0.6929328441619873
Epoch: 56, Steps: 3 | Train Loss: 0.119 Vali Loss: 1.048 Vali Acc: 0.625 Test Loss: 1.048 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 57 cost time: 0.7354564666748047
Epoch: 57, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.037 Vali Acc: 0.625 Test Loss: 1.037 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 58 cost time: 0.6965370178222656
Epoch: 58, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.029 Vali Acc: 0.625 Test Loss: 1.029 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 59 cost time: 0.8675022125244141
Epoch: 59, Steps: 3 | Train Loss: 0.098 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 60 cost time: 0.8676795959472656
Epoch: 60, Steps: 3 | Train Loss: 0.096 Vali Loss: 1.017 Vali Acc: 0.650 Test Loss: 1.017 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 61 cost time: 0.6884737014770508
Epoch: 61, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.017 Vali Acc: 0.675 Test Loss: 1.017 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 62 cost time: 0.6953120231628418
Epoch: 62, Steps: 3 | Train Loss: 0.093 Vali Loss: 1.012 Vali Acc: 0.675 Test Loss: 1.012 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 63 cost time: 0.8126177787780762
Epoch: 63, Steps: 3 | Train Loss: 0.083 Vali Loss: 1.007 Vali Acc: 0.675 Test Loss: 1.007 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 64 cost time: 0.7706513404846191
Epoch: 64, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.005 Vali Acc: 0.675 Test Loss: 1.005 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 65 cost time: 0.7518112659454346
Epoch: 65, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.003 Vali Acc: 0.675 Test Loss: 1.003 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 66 cost time: 0.8047335147857666
Epoch: 66, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7832398414611816
Epoch: 67, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.002 Vali Acc: 0.675 Test Loss: 1.002 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 68 cost time: 0.7027108669281006
Epoch: 68, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.994 Vali Acc: 0.675 Test Loss: 0.994 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 69 cost time: 0.7306227684020996
Epoch: 69, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.985 Vali Acc: 0.675 Test Loss: 0.985 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 70 cost time: 0.7119271755218506
Epoch: 70, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.984 Vali Acc: 0.675 Test Loss: 0.984 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 71 cost time: 0.7000343799591064
Epoch: 71, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.978 Vali Acc: 0.675 Test Loss: 0.978 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 72 cost time: 0.7095198631286621
Epoch: 72, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.969 Vali Acc: 0.675 Test Loss: 0.969 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 73 cost time: 0.7028820514678955
Epoch: 73, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.965 Vali Acc: 0.675 Test Loss: 0.965 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 74 cost time: 0.7334856986999512
Epoch: 74, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.961 Vali Acc: 0.675 Test Loss: 0.961 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 75 cost time: 0.7268741130828857
Epoch: 75, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.956 Vali Acc: 0.675 Test Loss: 0.956 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 76 cost time: 0.8676323890686035
Epoch: 76, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.953 Vali Acc: 0.675 Test Loss: 0.953 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 77 cost time: 0.7334742546081543
Epoch: 77, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.948 Vali Acc: 0.675 Test Loss: 0.948 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 78 cost time: 0.6775505542755127
Epoch: 78, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.948 Vali Acc: 0.675 Test Loss: 0.948 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.6750946044921875
Epoch: 79, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.944 Vali Acc: 0.650 Test Loss: 0.944 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.6619367599487305
Epoch: 80, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.944 Vali Acc: 0.650 Test Loss: 0.944 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.6428790092468262
Epoch: 81, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.941 Vali Acc: 0.650 Test Loss: 0.941 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.8350193500518799
Epoch: 82, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.941 Vali Acc: 0.650 Test Loss: 0.941 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.7358474731445312
Epoch: 83, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.941 Vali Acc: 0.650 Test Loss: 0.941 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.6305499076843262
Epoch: 84, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.936 Vali Acc: 0.675 Test Loss: 0.936 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 85 cost time: 0.7248663902282715
Epoch: 85, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.938 Vali Acc: 0.650 Test Loss: 0.938 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.8000214099884033
Epoch: 86, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.931 Vali Acc: 0.650 Test Loss: 0.931 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.7462706565856934
Epoch: 87, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.925 Vali Acc: 0.675 Test Loss: 0.925 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 88 cost time: 0.760368824005127
Epoch: 88, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.922 Vali Acc: 0.675 Test Loss: 0.922 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 89 cost time: 0.7862086296081543
Epoch: 89, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.922 Vali Acc: 0.675 Test Loss: 0.922 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 90 cost time: 0.6983304023742676
Epoch: 90, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.923 Vali Acc: 0.675 Test Loss: 0.923 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.7442405223846436
Epoch: 91, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.921 Vali Acc: 0.675 Test Loss: 0.921 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 92 cost time: 0.7357773780822754
Epoch: 92, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.920 Vali Acc: 0.675 Test Loss: 0.920 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 93 cost time: 0.672870397567749
Epoch: 93, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.920 Vali Acc: 0.675 Test Loss: 0.920 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.70058274269104
Epoch: 94, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.916 Vali Acc: 0.675 Test Loss: 0.916 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 95 cost time: 0.7016479969024658
Epoch: 95, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.913 Vali Acc: 0.650 Test Loss: 0.913 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.6467411518096924
Epoch: 96, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.910 Vali Acc: 0.675 Test Loss: 0.910 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 97 cost time: 0.5995073318481445
Epoch: 97, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.907 Vali Acc: 0.675 Test Loss: 0.907 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 98 cost time: 0.7696840763092041
Epoch: 98, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.900 Vali Acc: 0.725 Test Loss: 0.900 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 99 cost time: 0.6620988845825195
Epoch: 99, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 100 cost time: 0.7215023040771484
Epoch: 100, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.892 Vali Acc: 0.750 Test Loss: 0.892 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 33044
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.553591251373291
Epoch: 1, Steps: 3 | Train Loss: 1.645 Vali Loss: 1.664 Vali Acc: 0.100 Test Loss: 1.664 Test Acc: 0.100
Validation loss decreased (inf --> -0.099983).  Saving model ...
Epoch: 2 cost time: 0.640017032623291
Epoch: 2, Steps: 3 | Train Loss: 1.594 Vali Loss: 1.649 Vali Acc: 0.075 Test Loss: 1.649 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7347042560577393
Epoch: 3, Steps: 3 | Train Loss: 1.526 Vali Loss: 1.643 Vali Acc: 0.075 Test Loss: 1.643 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6602368354797363
Epoch: 4, Steps: 3 | Train Loss: 1.664 Vali Loss: 1.639 Vali Acc: 0.100 Test Loss: 1.639 Test Acc: 0.100
Validation loss decreased (-0.099983 --> -0.099984).  Saving model ...
Epoch: 5 cost time: 0.7498531341552734
Epoch: 5, Steps: 3 | Train Loss: 1.587 Vali Loss: 1.634 Vali Acc: 0.100 Test Loss: 1.634 Test Acc: 0.100
Validation loss decreased (-0.099984 --> -0.099984).  Saving model ...
Epoch: 6 cost time: 0.6549911499023438
Epoch: 6, Steps: 3 | Train Loss: 1.581 Vali Loss: 1.628 Vali Acc: 0.125 Test Loss: 1.628 Test Acc: 0.125
Validation loss decreased (-0.099984 --> -0.124984).  Saving model ...
Epoch: 7 cost time: 0.8412387371063232
Epoch: 7, Steps: 3 | Train Loss: 1.569 Vali Loss: 1.621 Vali Acc: 0.100 Test Loss: 1.621 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7082250118255615
Epoch: 8, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.612 Vali Acc: 0.125 Test Loss: 1.612 Test Acc: 0.125
Validation loss decreased (-0.124984 --> -0.124984).  Saving model ...
Epoch: 9 cost time: 0.7529025077819824
Epoch: 9, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.602 Vali Acc: 0.125 Test Loss: 1.602 Test Acc: 0.125
Validation loss decreased (-0.124984 --> -0.124984).  Saving model ...
Epoch: 10 cost time: 0.8616411685943604
Epoch: 10, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.590 Vali Acc: 0.175 Test Loss: 1.590 Test Acc: 0.175
Validation loss decreased (-0.124984 --> -0.174984).  Saving model ...
Epoch: 11 cost time: 0.778282880783081
Epoch: 11, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.577 Vali Acc: 0.200 Test Loss: 1.577 Test Acc: 0.200
Validation loss decreased (-0.174984 --> -0.199984).  Saving model ...
Epoch: 12 cost time: 0.7367353439331055
Epoch: 12, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.565 Vali Acc: 0.175 Test Loss: 1.565 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7307989597320557
Epoch: 13, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.553 Vali Acc: 0.200 Test Loss: 1.553 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 14 cost time: 0.678577184677124
Epoch: 14, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.539 Vali Acc: 0.225 Test Loss: 1.539 Test Acc: 0.225
Validation loss decreased (-0.199984 --> -0.224985).  Saving model ...
Epoch: 15 cost time: 0.7481694221496582
Epoch: 15, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.525 Vali Acc: 0.275 Test Loss: 1.525 Test Acc: 0.275
Validation loss decreased (-0.224985 --> -0.274985).  Saving model ...
Epoch: 16 cost time: 0.8140144348144531
Epoch: 16, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.511 Vali Acc: 0.275 Test Loss: 1.511 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 17 cost time: 0.7338299751281738
Epoch: 17, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.496 Vali Acc: 0.275 Test Loss: 1.496 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 18 cost time: 0.6535189151763916
Epoch: 18, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.482 Vali Acc: 0.275 Test Loss: 1.482 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 19 cost time: 0.7919671535491943
Epoch: 19, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.469 Vali Acc: 0.275 Test Loss: 1.469 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 20 cost time: 0.7616174221038818
Epoch: 20, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.457 Vali Acc: 0.275 Test Loss: 1.457 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 21 cost time: 0.7143111228942871
Epoch: 21, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.446 Vali Acc: 0.250 Test Loss: 1.446 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7387580871582031
Epoch: 22, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.433 Vali Acc: 0.250 Test Loss: 1.433 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6865835189819336
Epoch: 23, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.424 Vali Acc: 0.325 Test Loss: 1.424 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324986).  Saving model ...
Epoch: 24 cost time: 0.6056828498840332
Epoch: 24, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.413 Vali Acc: 0.375 Test Loss: 1.413 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 25 cost time: 0.6724936962127686
Epoch: 25, Steps: 3 | Train Loss: 0.868 Vali Loss: 1.403 Vali Acc: 0.425 Test Loss: 1.403 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 26 cost time: 0.7188665866851807
Epoch: 26, Steps: 3 | Train Loss: 0.816 Vali Loss: 1.394 Vali Acc: 0.425 Test Loss: 1.394 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 27 cost time: 0.7115378379821777
Epoch: 27, Steps: 3 | Train Loss: 0.784 Vali Loss: 1.387 Vali Acc: 0.425 Test Loss: 1.387 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 28 cost time: 0.6370940208435059
Epoch: 28, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.381 Vali Acc: 0.450 Test Loss: 1.381 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 29 cost time: 0.7681772708892822
Epoch: 29, Steps: 3 | Train Loss: 0.711 Vali Loss: 1.375 Vali Acc: 0.450 Test Loss: 1.375 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 30 cost time: 0.704963207244873
Epoch: 30, Steps: 3 | Train Loss: 0.700 Vali Loss: 1.368 Vali Acc: 0.425 Test Loss: 1.368 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7196464538574219
Epoch: 31, Steps: 3 | Train Loss: 0.681 Vali Loss: 1.364 Vali Acc: 0.425 Test Loss: 1.364 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8128888607025146
Epoch: 32, Steps: 3 | Train Loss: 0.694 Vali Loss: 1.360 Vali Acc: 0.425 Test Loss: 1.360 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8453514575958252
Epoch: 33, Steps: 3 | Train Loss: 0.652 Vali Loss: 1.356 Vali Acc: 0.425 Test Loss: 1.356 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.759591817855835
Epoch: 34, Steps: 3 | Train Loss: 0.641 Vali Loss: 1.354 Vali Acc: 0.425 Test Loss: 1.354 Test Acc: 0.425
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7295253276824951
Epoch: 35, Steps: 3 | Train Loss: 0.594 Vali Loss: 1.349 Vali Acc: 0.425 Test Loss: 1.349 Test Acc: 0.425
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8026745319366455
Epoch: 36, Steps: 3 | Train Loss: 0.626 Vali Loss: 1.349 Vali Acc: 0.425 Test Loss: 1.349 Test Acc: 0.425
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7320208549499512
Epoch: 37, Steps: 3 | Train Loss: 0.600 Vali Loss: 1.350 Vali Acc: 0.450 Test Loss: 1.350 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 38 cost time: 0.6347918510437012
Epoch: 38, Steps: 3 | Train Loss: 0.589 Vali Loss: 1.349 Vali Acc: 0.475 Test Loss: 1.349 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 39 cost time: 0.6544525623321533
Epoch: 39, Steps: 3 | Train Loss: 0.596 Vali Loss: 1.345 Vali Acc: 0.475 Test Loss: 1.345 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 40 cost time: 0.6700308322906494
Epoch: 40, Steps: 3 | Train Loss: 0.563 Vali Loss: 1.341 Vali Acc: 0.475 Test Loss: 1.341 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 41 cost time: 0.68436598777771
Epoch: 41, Steps: 3 | Train Loss: 0.518 Vali Loss: 1.338 Vali Acc: 0.475 Test Loss: 1.338 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 42 cost time: 0.6348061561584473
Epoch: 42, Steps: 3 | Train Loss: 0.461 Vali Loss: 1.337 Vali Acc: 0.500 Test Loss: 1.337 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 43 cost time: 0.6679220199584961
Epoch: 43, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.335 Vali Acc: 0.550 Test Loss: 1.335 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 44 cost time: 0.6632912158966064
Epoch: 44, Steps: 3 | Train Loss: 0.429 Vali Loss: 1.338 Vali Acc: 0.550 Test Loss: 1.338 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.633826494216919
Epoch: 45, Steps: 3 | Train Loss: 0.426 Vali Loss: 1.339 Vali Acc: 0.575 Test Loss: 1.339 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 46 cost time: 0.677098274230957
Epoch: 46, Steps: 3 | Train Loss: 0.374 Vali Loss: 1.341 Vali Acc: 0.600 Test Loss: 1.341 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 47 cost time: 0.6536939144134521
Epoch: 47, Steps: 3 | Train Loss: 0.371 Vali Loss: 1.338 Vali Acc: 0.600 Test Loss: 1.338 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 48 cost time: 0.6957972049713135
Epoch: 48, Steps: 3 | Train Loss: 0.333 Vali Loss: 1.332 Vali Acc: 0.600 Test Loss: 1.332 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 49 cost time: 0.6536123752593994
Epoch: 49, Steps: 3 | Train Loss: 0.360 Vali Loss: 1.329 Vali Acc: 0.600 Test Loss: 1.329 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 50 cost time: 0.6537594795227051
Epoch: 50, Steps: 3 | Train Loss: 0.339 Vali Loss: 1.327 Vali Acc: 0.600 Test Loss: 1.327 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 51 cost time: 0.6691372394561768
Epoch: 51, Steps: 3 | Train Loss: 0.313 Vali Loss: 1.322 Vali Acc: 0.600 Test Loss: 1.322 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 52 cost time: 0.8054828643798828
Epoch: 52, Steps: 3 | Train Loss: 0.295 Vali Loss: 1.320 Vali Acc: 0.600 Test Loss: 1.320 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 53 cost time: 0.7163848876953125
Epoch: 53, Steps: 3 | Train Loss: 0.227 Vali Loss: 1.318 Vali Acc: 0.600 Test Loss: 1.318 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 54 cost time: 0.6538913249969482
Epoch: 54, Steps: 3 | Train Loss: 0.259 Vali Loss: 1.311 Vali Acc: 0.600 Test Loss: 1.311 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 55 cost time: 0.6466295719146729
Epoch: 55, Steps: 3 | Train Loss: 0.245 Vali Loss: 1.304 Vali Acc: 0.600 Test Loss: 1.304 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 56 cost time: 0.6835641860961914
Epoch: 56, Steps: 3 | Train Loss: 0.225 Vali Loss: 1.298 Vali Acc: 0.600 Test Loss: 1.298 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 57 cost time: 0.633430004119873
Epoch: 57, Steps: 3 | Train Loss: 0.203 Vali Loss: 1.292 Vali Acc: 0.600 Test Loss: 1.292 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 58 cost time: 0.7992103099822998
Epoch: 58, Steps: 3 | Train Loss: 0.257 Vali Loss: 1.284 Vali Acc: 0.600 Test Loss: 1.284 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 59 cost time: 0.6309998035430908
Epoch: 59, Steps: 3 | Train Loss: 0.214 Vali Loss: 1.282 Vali Acc: 0.600 Test Loss: 1.282 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 60 cost time: 0.7398784160614014
Epoch: 60, Steps: 3 | Train Loss: 0.197 Vali Loss: 1.283 Vali Acc: 0.600 Test Loss: 1.283 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6666717529296875
Epoch: 61, Steps: 3 | Train Loss: 0.170 Vali Loss: 1.285 Vali Acc: 0.600 Test Loss: 1.285 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.7095351219177246
Epoch: 62, Steps: 3 | Train Loss: 0.205 Vali Loss: 1.282 Vali Acc: 0.600 Test Loss: 1.282 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 63 cost time: 0.6476075649261475
Epoch: 63, Steps: 3 | Train Loss: 0.195 Vali Loss: 1.278 Vali Acc: 0.600 Test Loss: 1.278 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 64 cost time: 0.6843957901000977
Epoch: 64, Steps: 3 | Train Loss: 0.183 Vali Loss: 1.271 Vali Acc: 0.600 Test Loss: 1.271 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 65 cost time: 0.6127407550811768
Epoch: 65, Steps: 3 | Train Loss: 0.178 Vali Loss: 1.267 Vali Acc: 0.600 Test Loss: 1.267 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 66 cost time: 0.6289596557617188
Epoch: 66, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.267 Vali Acc: 0.600 Test Loss: 1.267 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 67 cost time: 0.6746718883514404
Epoch: 67, Steps: 3 | Train Loss: 0.168 Vali Loss: 1.265 Vali Acc: 0.600 Test Loss: 1.265 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 68 cost time: 0.7132725715637207
Epoch: 68, Steps: 3 | Train Loss: 0.118 Vali Loss: 1.264 Vali Acc: 0.600 Test Loss: 1.264 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 69 cost time: 0.7305865287780762
Epoch: 69, Steps: 3 | Train Loss: 0.135 Vali Loss: 1.265 Vali Acc: 0.600 Test Loss: 1.265 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7826504707336426
Epoch: 70, Steps: 3 | Train Loss: 0.139 Vali Loss: 1.265 Vali Acc: 0.600 Test Loss: 1.265 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.8171632289886475
Epoch: 71, Steps: 3 | Train Loss: 0.108 Vali Loss: 1.267 Vali Acc: 0.625 Test Loss: 1.267 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624987).  Saving model ...
Epoch: 72 cost time: 0.6798713207244873
Epoch: 72, Steps: 3 | Train Loss: 0.122 Vali Loss: 1.271 Vali Acc: 0.625 Test Loss: 1.271 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.8101356029510498
Epoch: 73, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.274 Vali Acc: 0.625 Test Loss: 1.274 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.7316286563873291
Epoch: 74, Steps: 3 | Train Loss: 0.116 Vali Loss: 1.274 Vali Acc: 0.625 Test Loss: 1.274 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.7300138473510742
Epoch: 75, Steps: 3 | Train Loss: 0.139 Vali Loss: 1.270 Vali Acc: 0.625 Test Loss: 1.270 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.7721631526947021
Epoch: 76, Steps: 3 | Train Loss: 0.091 Vali Loss: 1.277 Vali Acc: 0.625 Test Loss: 1.277 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.7091145515441895
Epoch: 77, Steps: 3 | Train Loss: 0.110 Vali Loss: 1.288 Vali Acc: 0.625 Test Loss: 1.288 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.7894539833068848
Epoch: 78, Steps: 3 | Train Loss: 0.105 Vali Loss: 1.280 Vali Acc: 0.625 Test Loss: 1.280 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.694786548614502
Epoch: 79, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.274 Vali Acc: 0.625 Test Loss: 1.274 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.7067873477935791
Epoch: 80, Steps: 3 | Train Loss: 0.091 Vali Loss: 1.268 Vali Acc: 0.625 Test Loss: 1.268 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.8002018928527832
Epoch: 81, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.260 Vali Acc: 0.625 Test Loss: 1.260 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 82 cost time: 0.6867454051971436
Epoch: 82, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.257 Vali Acc: 0.625 Test Loss: 1.257 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 83 cost time: 0.6851611137390137
Epoch: 83, Steps: 3 | Train Loss: 0.076 Vali Loss: 1.254 Vali Acc: 0.625 Test Loss: 1.254 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 84 cost time: 0.6231029033660889
Epoch: 84, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.250 Vali Acc: 0.625 Test Loss: 1.250 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 85 cost time: 0.7509796619415283
Epoch: 85, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.252 Vali Acc: 0.625 Test Loss: 1.252 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.7521002292633057
Epoch: 86, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.248 Vali Acc: 0.625 Test Loss: 1.248 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624988).  Saving model ...
Epoch: 87 cost time: 0.7343814373016357
Epoch: 87, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.246 Vali Acc: 0.625 Test Loss: 1.246 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 88 cost time: 0.7103502750396729
Epoch: 88, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.243 Vali Acc: 0.625 Test Loss: 1.243 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 89 cost time: 0.8036105632781982
Epoch: 89, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.244 Vali Acc: 0.625 Test Loss: 1.244 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.8638026714324951
Epoch: 90, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.250 Vali Acc: 0.625 Test Loss: 1.250 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.7632567882537842
Epoch: 91, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.248 Vali Acc: 0.625 Test Loss: 1.248 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.944920539855957
Epoch: 92, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.242 Vali Acc: 0.625 Test Loss: 1.242 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 93 cost time: 0.8151640892028809
Epoch: 93, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.237 Vali Acc: 0.625 Test Loss: 1.237 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 94 cost time: 0.6821208000183105
Epoch: 94, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.232 Vali Acc: 0.625 Test Loss: 1.232 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 95 cost time: 0.6962113380432129
Epoch: 95, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.230 Vali Acc: 0.625 Test Loss: 1.230 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 96 cost time: 0.7249102592468262
Epoch: 96, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.234 Vali Acc: 0.625 Test Loss: 1.234 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.7440071105957031
Epoch: 97, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.227 Vali Acc: 0.625 Test Loss: 1.227 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 98 cost time: 0.7081704139709473
Epoch: 98, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.224 Vali Acc: 0.625 Test Loss: 1.224 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 99 cost time: 0.7635011672973633
Epoch: 99, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.220 Vali Acc: 0.625 Test Loss: 1.220 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 100 cost time: 0.8168249130249023
Epoch: 100, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.212 Vali Acc: 0.625 Test Loss: 1.212 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df256_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 31972
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.420534133911133
Epoch: 1, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.476 Vali Acc: 0.250 Test Loss: 1.476 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.6227309703826904
Epoch: 2, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.417 Vali Acc: 0.275 Test Loss: 1.417 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6116104125976562
Epoch: 3, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.360 Vali Acc: 0.300 Test Loss: 1.360 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.8074383735656738
Epoch: 4, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.307 Vali Acc: 0.450 Test Loss: 1.307 Test Acc: 0.450
Validation loss decreased (-0.299986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.6000280380249023
Epoch: 5, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6825551986694336
Epoch: 6, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6316831111907959
Epoch: 7, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.191 Vali Acc: 0.425 Test Loss: 1.191 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6175117492675781
Epoch: 8, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.148 Vali Acc: 0.450 Test Loss: 1.148 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449989).  Saving model ...
Epoch: 9 cost time: 0.7276294231414795
Epoch: 9, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.108 Vali Acc: 0.525 Test Loss: 1.108 Test Acc: 0.525
Validation loss decreased (-0.449989 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 0.6781661510467529
Epoch: 10, Steps: 3 | Train Loss: 0.779 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.670738697052002
Epoch: 11, Steps: 3 | Train Loss: 0.719 Vali Loss: 1.048 Vali Acc: 0.675 Test Loss: 1.048 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.6311662197113037
Epoch: 12, Steps: 3 | Train Loss: 0.670 Vali Loss: 1.009 Vali Acc: 0.650 Test Loss: 1.009 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.661034107208252
Epoch: 13, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.972 Vali Acc: 0.650 Test Loss: 0.972 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6704769134521484
Epoch: 14, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.940 Vali Acc: 0.625 Test Loss: 0.940 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7425408363342285
Epoch: 15, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.905 Vali Acc: 0.625 Test Loss: 0.905 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5757095813751221
Epoch: 16, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.872 Vali Acc: 0.650 Test Loss: 0.872 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6609899997711182
Epoch: 17, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.844 Vali Acc: 0.650 Test Loss: 0.844 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6439034938812256
Epoch: 18, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.813 Vali Acc: 0.675 Test Loss: 0.813 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674992).  Saving model ...
Epoch: 19 cost time: 0.5528130531311035
Epoch: 19, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.797 Vali Acc: 0.675 Test Loss: 0.797 Test Acc: 0.675
Validation loss decreased (-0.674992 --> -0.674992).  Saving model ...
Epoch: 20 cost time: 0.6307618618011475
Epoch: 20, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.785 Vali Acc: 0.700 Test Loss: 0.785 Test Acc: 0.700
Validation loss decreased (-0.674992 --> -0.699992).  Saving model ...
Epoch: 21 cost time: 0.6681008338928223
Epoch: 21, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.764 Vali Acc: 0.700 Test Loss: 0.764 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 22 cost time: 0.7822051048278809
Epoch: 22, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.734 Vali Acc: 0.725 Test Loss: 0.734 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724993).  Saving model ...
Epoch: 23 cost time: 0.6919407844543457
Epoch: 23, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.703 Vali Acc: 0.775 Test Loss: 0.703 Test Acc: 0.775
Validation loss decreased (-0.724993 --> -0.774993).  Saving model ...
Epoch: 24 cost time: 0.8748135566711426
Epoch: 24, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.690 Vali Acc: 0.750 Test Loss: 0.690 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6658420562744141
Epoch: 25, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.684 Vali Acc: 0.750 Test Loss: 0.684 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.729313850402832
Epoch: 26, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.691 Vali Acc: 0.725 Test Loss: 0.691 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7241721153259277
Epoch: 27, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.721250057220459
Epoch: 28, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.698 Vali Acc: 0.750 Test Loss: 0.698 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7513983249664307
Epoch: 29, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6399879455566406
Epoch: 30, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.679 Vali Acc: 0.750 Test Loss: 0.679 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7464182376861572
Epoch: 31, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.661 Vali Acc: 0.775 Test Loss: 0.661 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 32 cost time: 0.6827447414398193
Epoch: 32, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.645 Vali Acc: 0.775 Test Loss: 0.645 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774994).  Saving model ...
Epoch: 33 cost time: 0.7542681694030762
Epoch: 33, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.631 Vali Acc: 0.775 Test Loss: 0.631 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 34 cost time: 0.7821354866027832
Epoch: 34, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.620 Vali Acc: 0.775 Test Loss: 0.620 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 35 cost time: 0.7526116371154785
Epoch: 35, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.614 Vali Acc: 0.775 Test Loss: 0.614 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 36 cost time: 0.7919378280639648
Epoch: 36, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.614 Vali Acc: 0.775 Test Loss: 0.614 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 37 cost time: 0.8244645595550537
Epoch: 37, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.614 Vali Acc: 0.775 Test Loss: 0.614 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 38 cost time: 0.7576460838317871
Epoch: 38, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.615 Vali Acc: 0.775 Test Loss: 0.615 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8427855968475342
Epoch: 39, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.616 Vali Acc: 0.775 Test Loss: 0.616 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8077957630157471
Epoch: 40, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.620 Vali Acc: 0.775 Test Loss: 0.620 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.694666862487793
Epoch: 41, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.624 Vali Acc: 0.775 Test Loss: 0.624 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7558698654174805
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.624 Vali Acc: 0.775 Test Loss: 0.624 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7027697563171387
Epoch: 43, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.625 Vali Acc: 0.775 Test Loss: 0.625 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8416628837585449
Epoch: 44, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.621 Vali Acc: 0.800 Test Loss: 0.621 Test Acc: 0.800
Validation loss decreased (-0.774994 --> -0.799994).  Saving model ...
Epoch: 45 cost time: 0.6430695056915283
Epoch: 45, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 46 cost time: 0.6732099056243896
Epoch: 46, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.609 Vali Acc: 0.800 Test Loss: 0.609 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 47 cost time: 0.6981770992279053
Epoch: 47, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.604 Vali Acc: 0.800 Test Loss: 0.604 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 48 cost time: 0.6909868717193604
Epoch: 48, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.601 Vali Acc: 0.800 Test Loss: 0.601 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 49 cost time: 0.7696425914764404
Epoch: 49, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.597 Vali Acc: 0.800 Test Loss: 0.597 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 50 cost time: 0.7331907749176025
Epoch: 50, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.592 Vali Acc: 0.800 Test Loss: 0.592 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 51 cost time: 0.7597801685333252
Epoch: 51, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.588 Vali Acc: 0.800 Test Loss: 0.588 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 52 cost time: 0.7309038639068604
Epoch: 52, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.584 Vali Acc: 0.800 Test Loss: 0.584 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 53 cost time: 0.7966818809509277
Epoch: 53, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.580 Vali Acc: 0.800 Test Loss: 0.580 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 54 cost time: 0.6826043128967285
Epoch: 54, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.577 Vali Acc: 0.800 Test Loss: 0.577 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 55 cost time: 0.7109994888305664
Epoch: 55, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.577 Vali Acc: 0.800 Test Loss: 0.577 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 56 cost time: 0.6612973213195801
Epoch: 56, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.577 Vali Acc: 0.800 Test Loss: 0.577 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 57 cost time: 0.6005375385284424
Epoch: 57, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 58 cost time: 0.6817209720611572
Epoch: 58, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7667691707611084
Epoch: 59, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.7498295307159424
Epoch: 60, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.578 Vali Acc: 0.800 Test Loss: 0.578 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.7840049266815186
Epoch: 61, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.580 Vali Acc: 0.800 Test Loss: 0.580 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.7729907035827637
Epoch: 62, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.581 Vali Acc: 0.800 Test Loss: 0.581 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.6891639232635498
Epoch: 63, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.580 Vali Acc: 0.800 Test Loss: 0.580 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.7405388355255127
Epoch: 64, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.577 Vali Acc: 0.800 Test Loss: 0.577 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.7395720481872559
Epoch: 65, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.6976134777069092
Epoch: 66, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 67 cost time: 0.6916065216064453
Epoch: 67, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.575 Vali Acc: 0.800 Test Loss: 0.575 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 68 cost time: 0.7271003723144531
Epoch: 68, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.573 Vali Acc: 0.800 Test Loss: 0.573 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 69 cost time: 0.7677507400512695
Epoch: 69, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.572 Vali Acc: 0.800 Test Loss: 0.572 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 70 cost time: 0.5883800983428955
Epoch: 70, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.800 Test Loss: 0.571 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 71 cost time: 0.6141228675842285
Epoch: 71, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.570 Vali Acc: 0.800 Test Loss: 0.570 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 72 cost time: 0.6850442886352539
Epoch: 72, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.800 Test Loss: 0.569 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 73 cost time: 0.8463730812072754
Epoch: 73, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.800 Test Loss: 0.569 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 74 cost time: 0.6604704856872559
Epoch: 74, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.800 Test Loss: 0.568 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 75 cost time: 0.7202229499816895
Epoch: 75, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.800 Test Loss: 0.568 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 76 cost time: 0.640129566192627
Epoch: 76, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.800 Test Loss: 0.568 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 77 cost time: 0.6979262828826904
Epoch: 77, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.800 Test Loss: 0.568 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.6558973789215088
Epoch: 78, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.800 Test Loss: 0.567 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 79 cost time: 0.7268350124359131
Epoch: 79, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.800 Test Loss: 0.567 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 80 cost time: 0.7858989238739014
Epoch: 80, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.800 Test Loss: 0.565 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 81 cost time: 0.6744580268859863
Epoch: 81, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.800 Test Loss: 0.564 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 82 cost time: 0.7431762218475342
Epoch: 82, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.800 Test Loss: 0.563 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 83 cost time: 0.7980823516845703
Epoch: 83, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.800 Test Loss: 0.562 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 84 cost time: 0.7424678802490234
Epoch: 84, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.800 Test Loss: 0.561 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 85 cost time: 0.7091624736785889
Epoch: 85, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 86 cost time: 0.8071904182434082
Epoch: 86, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.800 Test Loss: 0.561 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.7972743511199951
Epoch: 87, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 88 cost time: 0.7422175407409668
Epoch: 88, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.800 Test Loss: 0.561 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.9238126277923584
Epoch: 89, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 90 cost time: 0.8198580741882324
Epoch: 90, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 91 cost time: 0.7621355056762695
Epoch: 91, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.7227625846862793
Epoch: 92, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 93 cost time: 0.7707295417785645
Epoch: 93, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.9273800849914551
Epoch: 94, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 95 cost time: 0.8009674549102783
Epoch: 95, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.800 Test Loss: 0.559 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 96 cost time: 0.7359812259674072
Epoch: 96, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.800 Test Loss: 0.559 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 97 cost time: 0.7978456020355225
Epoch: 97, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.800 Test Loss: 0.558 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 98 cost time: 0.7167236804962158
Epoch: 98, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.800 Test Loss: 0.558 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.8570544719696045
Epoch: 99, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.800 Test Loss: 0.558 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 100 cost time: 0.766566276550293
Epoch: 100, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.800 Test Loss: 0.558 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 35460
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.446439504623413
Epoch: 1, Steps: 3 | Train Loss: 1.601 Vali Loss: 1.519 Vali Acc: 0.200 Test Loss: 1.519 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.6738128662109375
Epoch: 2, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.507 Vali Acc: 0.200 Test Loss: 1.507 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.6454503536224365
Epoch: 3, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.497 Vali Acc: 0.225 Test Loss: 1.497 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 4 cost time: 0.815009593963623
Epoch: 4, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.479 Vali Acc: 0.275 Test Loss: 1.479 Test Acc: 0.275
Validation loss decreased (-0.224985 --> -0.274985).  Saving model ...
Epoch: 5 cost time: 0.8208441734313965
Epoch: 5, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.457 Vali Acc: 0.300 Test Loss: 1.457 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 6 cost time: 0.770899772644043
Epoch: 6, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.430 Vali Acc: 0.300 Test Loss: 1.430 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 0.683314323425293
Epoch: 7, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.402 Vali Acc: 0.350 Test Loss: 1.402 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.6495048999786377
Epoch: 8, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.377 Vali Acc: 0.350 Test Loss: 1.377 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.6089000701904297
Epoch: 9, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.343 Vali Acc: 0.375 Test Loss: 1.343 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 0.6215846538543701
Epoch: 10, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.6629512310028076
Epoch: 11, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.7089540958404541
Epoch: 12, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 0.6262772083282471
Epoch: 13, Steps: 3 | Train Loss: 0.755 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.6731076240539551
Epoch: 14, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.185 Vali Acc: 0.475 Test Loss: 1.185 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6925022602081299
Epoch: 15, Steps: 3 | Train Loss: 0.702 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 0.6456019878387451
Epoch: 16, Steps: 3 | Train Loss: 0.604 Vali Loss: 1.120 Vali Acc: 0.525 Test Loss: 1.120 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 17 cost time: 0.7119107246398926
Epoch: 17, Steps: 3 | Train Loss: 0.547 Vali Loss: 1.102 Vali Acc: 0.525 Test Loss: 1.102 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 18 cost time: 0.6770715713500977
Epoch: 18, Steps: 3 | Train Loss: 0.573 Vali Loss: 1.083 Vali Acc: 0.550 Test Loss: 1.083 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 19 cost time: 0.6912682056427002
Epoch: 19, Steps: 3 | Train Loss: 0.531 Vali Loss: 1.054 Vali Acc: 0.575 Test Loss: 1.054 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 20 cost time: 0.6037027835845947
Epoch: 20, Steps: 3 | Train Loss: 0.436 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.7520651817321777
Epoch: 21, Steps: 3 | Train Loss: 0.405 Vali Loss: 1.012 Vali Acc: 0.625 Test Loss: 1.012 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 22 cost time: 0.657160758972168
Epoch: 22, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.998 Vali Acc: 0.625 Test Loss: 0.998 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 23 cost time: 0.8139464855194092
Epoch: 23, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.984 Vali Acc: 0.650 Test Loss: 0.984 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 0.6749207973480225
Epoch: 24, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.970 Vali Acc: 0.625 Test Loss: 0.970 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7827587127685547
Epoch: 25, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.963 Vali Acc: 0.625 Test Loss: 0.963 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7033121585845947
Epoch: 26, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.952 Vali Acc: 0.625 Test Loss: 0.952 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.809415340423584
Epoch: 27, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.934 Vali Acc: 0.625 Test Loss: 0.934 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7425990104675293
Epoch: 28, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.918 Vali Acc: 0.650 Test Loss: 0.918 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 29 cost time: 0.7169654369354248
Epoch: 29, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.903 Vali Acc: 0.700 Test Loss: 0.903 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699991).  Saving model ...
Epoch: 30 cost time: 0.6129138469696045
Epoch: 30, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 31 cost time: 0.733762264251709
Epoch: 31, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.880 Vali Acc: 0.725 Test Loss: 0.880 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 32 cost time: 0.5870668888092041
Epoch: 32, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.866 Vali Acc: 0.750 Test Loss: 0.866 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 33 cost time: 0.6500508785247803
Epoch: 33, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 34 cost time: 0.729229211807251
Epoch: 34, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 35 cost time: 0.6690492630004883
Epoch: 35, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.847 Vali Acc: 0.725 Test Loss: 0.847 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9076380729675293
Epoch: 36, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 37 cost time: 0.647895336151123
Epoch: 37, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7669048309326172
Epoch: 38, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.851 Vali Acc: 0.750 Test Loss: 0.851 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7727265357971191
Epoch: 39, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.854 Vali Acc: 0.725 Test Loss: 0.854 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7512059211730957
Epoch: 40, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.858 Vali Acc: 0.725 Test Loss: 0.858 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7647192478179932
Epoch: 41, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.861 Vali Acc: 0.725 Test Loss: 0.861 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.736414909362793
Epoch: 42, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.860 Vali Acc: 0.725 Test Loss: 0.860 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7685163021087646
Epoch: 43, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8310158252716064
Epoch: 44, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8265557289123535
Epoch: 45, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7206056118011475
Epoch: 46, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.858 Vali Acc: 0.750 Test Loss: 0.858 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 28964
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.494431495666504
Epoch: 1, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.390 Vali Acc: 0.250 Test Loss: 1.390 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.718193531036377
Epoch: 2, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.372 Vali Acc: 0.275 Test Loss: 1.372 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6409056186676025
Epoch: 3, Steps: 3 | Train Loss: 1.512 Vali Loss: 1.355 Vali Acc: 0.300 Test Loss: 1.355 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.6842153072357178
Epoch: 4, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.336 Vali Acc: 0.325 Test Loss: 1.336 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.830726146697998
Epoch: 5, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.7331511974334717
Epoch: 6, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.289 Vali Acc: 0.425 Test Loss: 1.289 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.7516705989837646
Epoch: 7, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.265 Vali Acc: 0.475 Test Loss: 1.265 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.751154899597168
Epoch: 8, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.242 Vali Acc: 0.475 Test Loss: 1.242 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.690274715423584
Epoch: 9, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.7929723262786865
Epoch: 10, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.8193819522857666
Epoch: 11, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.166 Vali Acc: 0.575 Test Loss: 1.166 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 0.7546377182006836
Epoch: 12, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.146 Vali Acc: 0.600 Test Loss: 1.146 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.7406635284423828
Epoch: 13, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.6820802688598633
Epoch: 14, Steps: 3 | Train Loss: 0.817 Vali Loss: 1.109 Vali Acc: 0.625 Test Loss: 1.109 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.6382255554199219
Epoch: 15, Steps: 3 | Train Loss: 0.809 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.717879056930542
Epoch: 16, Steps: 3 | Train Loss: 0.709 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6385073661804199
Epoch: 17, Steps: 3 | Train Loss: 0.710 Vali Loss: 1.054 Vali Acc: 0.675 Test Loss: 1.054 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 18 cost time: 0.6084320545196533
Epoch: 18, Steps: 3 | Train Loss: 0.717 Vali Loss: 1.035 Vali Acc: 0.700 Test Loss: 1.035 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 19 cost time: 0.7247464656829834
Epoch: 19, Steps: 3 | Train Loss: 0.559 Vali Loss: 1.017 Vali Acc: 0.725 Test Loss: 1.017 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 20 cost time: 0.6394274234771729
Epoch: 20, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.998 Vali Acc: 0.725 Test Loss: 0.998 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 21 cost time: 0.7013571262359619
Epoch: 21, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.983 Vali Acc: 0.750 Test Loss: 0.983 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 22 cost time: 0.7415492534637451
Epoch: 22, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 23 cost time: 0.7225985527038574
Epoch: 23, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.961 Vali Acc: 0.725 Test Loss: 0.961 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.663611888885498
Epoch: 24, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.949 Vali Acc: 0.725 Test Loss: 0.949 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.650984525680542
Epoch: 25, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.938 Vali Acc: 0.725 Test Loss: 0.938 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7466719150543213
Epoch: 26, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.925 Vali Acc: 0.725 Test Loss: 0.925 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7375397682189941
Epoch: 27, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.916 Vali Acc: 0.725 Test Loss: 0.916 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6878006458282471
Epoch: 28, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.908 Vali Acc: 0.725 Test Loss: 0.908 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6712472438812256
Epoch: 29, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.899 Vali Acc: 0.725 Test Loss: 0.899 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7766454219818115
Epoch: 30, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.892 Vali Acc: 0.750 Test Loss: 0.892 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 31 cost time: 0.7123928070068359
Epoch: 31, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 32 cost time: 0.7307562828063965
Epoch: 32, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.884 Vali Acc: 0.725 Test Loss: 0.884 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6137206554412842
Epoch: 33, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.878 Vali Acc: 0.725 Test Loss: 0.878 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6567564010620117
Epoch: 34, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.874 Vali Acc: 0.725 Test Loss: 0.874 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6153783798217773
Epoch: 35, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 36 cost time: 0.7454910278320312
Epoch: 36, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 37 cost time: 0.7048981189727783
Epoch: 37, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.858 Vali Acc: 0.775 Test Loss: 0.858 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 38 cost time: 0.7567214965820312
Epoch: 38, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.858 Vali Acc: 0.775 Test Loss: 0.858 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6453821659088135
Epoch: 39, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.855 Vali Acc: 0.775 Test Loss: 0.855 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 40 cost time: 0.8376262187957764
Epoch: 40, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 41 cost time: 0.6577637195587158
Epoch: 41, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.854 Vali Acc: 0.775 Test Loss: 0.854 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7788591384887695
Epoch: 42, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 43 cost time: 0.7755749225616455
Epoch: 43, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.855 Vali Acc: 0.775 Test Loss: 0.855 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.935377836227417
Epoch: 44, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.854 Vali Acc: 0.775 Test Loss: 0.854 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7559106349945068
Epoch: 45, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6981232166290283
Epoch: 46, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.854 Vali Acc: 0.775 Test Loss: 0.854 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7242143154144287
Epoch: 47, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7295141220092773
Epoch: 48, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.76312255859375
Epoch: 49, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7598690986633301
Epoch: 50, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7232296466827393
Epoch: 51, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.858 Vali Acc: 0.750 Test Loss: 0.858 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.7914402484893799
Epoch: 52, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 25940
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5661628246307373
Epoch: 1, Steps: 3 | Train Loss: 1.479 Vali Loss: 1.478 Vali Acc: 0.300 Test Loss: 1.478 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.6619114875793457
Epoch: 2, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.466 Vali Acc: 0.350 Test Loss: 1.466 Test Acc: 0.350
Validation loss decreased (-0.299985 --> -0.349985).  Saving model ...
Epoch: 3 cost time: 0.7212681770324707
Epoch: 3, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.455 Vali Acc: 0.375 Test Loss: 1.455 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374985).  Saving model ...
Epoch: 4 cost time: 0.665651798248291
Epoch: 4, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.441 Vali Acc: 0.375 Test Loss: 1.441 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.7123401165008545
Epoch: 5, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.425 Vali Acc: 0.400 Test Loss: 1.425 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.742516040802002
Epoch: 6, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.406 Vali Acc: 0.375 Test Loss: 1.406 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6725351810455322
Epoch: 7, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.385 Vali Acc: 0.375 Test Loss: 1.385 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7119779586791992
Epoch: 8, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.364 Vali Acc: 0.375 Test Loss: 1.364 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6555545330047607
Epoch: 9, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.343 Vali Acc: 0.425 Test Loss: 1.343 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.7177646160125732
Epoch: 10, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.322 Vali Acc: 0.400 Test Loss: 1.322 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.652400016784668
Epoch: 11, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.302 Vali Acc: 0.400 Test Loss: 1.302 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6820683479309082
Epoch: 12, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6422679424285889
Epoch: 13, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7705893516540527
Epoch: 14, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.252 Vali Acc: 0.450 Test Loss: 1.252 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 15 cost time: 0.5491693019866943
Epoch: 15, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 0.5843727588653564
Epoch: 16, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 0.5652961730957031
Epoch: 17, Steps: 3 | Train Loss: 0.776 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 0.6225364208221436
Epoch: 18, Steps: 3 | Train Loss: 0.663 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 0.5392251014709473
Epoch: 19, Steps: 3 | Train Loss: 0.641 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 20 cost time: 0.6140568256378174
Epoch: 20, Steps: 3 | Train Loss: 0.681 Vali Loss: 1.162 Vali Acc: 0.525 Test Loss: 1.162 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 21 cost time: 0.558485746383667
Epoch: 21, Steps: 3 | Train Loss: 0.583 Vali Loss: 1.151 Vali Acc: 0.550 Test Loss: 1.151 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 22 cost time: 0.5557527542114258
Epoch: 22, Steps: 3 | Train Loss: 0.503 Vali Loss: 1.140 Vali Acc: 0.550 Test Loss: 1.140 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 23 cost time: 0.6795480251312256
Epoch: 23, Steps: 3 | Train Loss: 0.455 Vali Loss: 1.127 Vali Acc: 0.550 Test Loss: 1.127 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 24 cost time: 0.6321454048156738
Epoch: 24, Steps: 3 | Train Loss: 0.400 Vali Loss: 1.118 Vali Acc: 0.550 Test Loss: 1.118 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 25 cost time: 0.535567045211792
Epoch: 25, Steps: 3 | Train Loss: 0.482 Vali Loss: 1.109 Vali Acc: 0.550 Test Loss: 1.109 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 26 cost time: 0.6386876106262207
Epoch: 26, Steps: 3 | Train Loss: 0.434 Vali Loss: 1.105 Vali Acc: 0.575 Test Loss: 1.105 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 27 cost time: 0.6106410026550293
Epoch: 27, Steps: 3 | Train Loss: 0.412 Vali Loss: 1.097 Vali Acc: 0.575 Test Loss: 1.097 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 28 cost time: 0.6443865299224854
Epoch: 28, Steps: 3 | Train Loss: 0.322 Vali Loss: 1.089 Vali Acc: 0.575 Test Loss: 1.089 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 29 cost time: 0.5851008892059326
Epoch: 29, Steps: 3 | Train Loss: 0.288 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 30 cost time: 0.6645119190216064
Epoch: 30, Steps: 3 | Train Loss: 0.265 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 31 cost time: 0.5935077667236328
Epoch: 31, Steps: 3 | Train Loss: 0.249 Vali Loss: 1.051 Vali Acc: 0.625 Test Loss: 1.051 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 32 cost time: 0.6468572616577148
Epoch: 32, Steps: 3 | Train Loss: 0.227 Vali Loss: 1.044 Vali Acc: 0.625 Test Loss: 1.044 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 33 cost time: 0.6777927875518799
Epoch: 33, Steps: 3 | Train Loss: 0.224 Vali Loss: 1.042 Vali Acc: 0.625 Test Loss: 1.042 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 34 cost time: 0.7018458843231201
Epoch: 34, Steps: 3 | Train Loss: 0.200 Vali Loss: 1.043 Vali Acc: 0.625 Test Loss: 1.043 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6876201629638672
Epoch: 35, Steps: 3 | Train Loss: 0.163 Vali Loss: 1.044 Vali Acc: 0.625 Test Loss: 1.044 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5838315486907959
Epoch: 36, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.047 Vali Acc: 0.625 Test Loss: 1.047 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6995162963867188
Epoch: 37, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.046 Vali Acc: 0.625 Test Loss: 1.046 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6685440540313721
Epoch: 38, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.052 Vali Acc: 0.625 Test Loss: 1.052 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7087693214416504
Epoch: 39, Steps: 3 | Train Loss: 0.111 Vali Loss: 1.056 Vali Acc: 0.625 Test Loss: 1.056 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6638431549072266
Epoch: 40, Steps: 3 | Train Loss: 0.122 Vali Loss: 1.056 Vali Acc: 0.625 Test Loss: 1.056 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7024979591369629
Epoch: 41, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.049 Vali Acc: 0.625 Test Loss: 1.049 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6497035026550293
Epoch: 42, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.041 Vali Acc: 0.625 Test Loss: 1.041 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 43 cost time: 0.6478660106658936
Epoch: 43, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699990).  Saving model ...
Epoch: 44 cost time: 0.6329023838043213
Epoch: 44, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.028 Vali Acc: 0.675 Test Loss: 1.028 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6917264461517334
Epoch: 45, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.023 Vali Acc: 0.675 Test Loss: 1.023 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7645828723907471
Epoch: 46, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 47 cost time: 0.7522022724151611
Epoch: 47, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 48 cost time: 0.7175579071044922
Epoch: 48, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.013 Vali Acc: 0.725 Test Loss: 1.013 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 49 cost time: 0.6567156314849854
Epoch: 49, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.011 Vali Acc: 0.725 Test Loss: 1.011 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 50 cost time: 0.7004890441894531
Epoch: 50, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.008 Vali Acc: 0.725 Test Loss: 1.008 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 51 cost time: 0.6601777076721191
Epoch: 51, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.009 Vali Acc: 0.725 Test Loss: 1.009 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7247059345245361
Epoch: 52, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.008 Vali Acc: 0.725 Test Loss: 1.008 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7017529010772705
Epoch: 53, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.006 Vali Acc: 0.725 Test Loss: 1.006 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 54 cost time: 0.8255634307861328
Epoch: 54, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.003 Vali Acc: 0.725 Test Loss: 1.003 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 55 cost time: 0.8098318576812744
Epoch: 55, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.000 Vali Acc: 0.725 Test Loss: 1.000 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 56 cost time: 0.7250890731811523
Epoch: 56, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.998 Vali Acc: 0.725 Test Loss: 0.998 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 57 cost time: 0.7028849124908447
Epoch: 57, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.997 Vali Acc: 0.725 Test Loss: 0.997 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 58 cost time: 0.7362596988677979
Epoch: 58, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.998 Vali Acc: 0.725 Test Loss: 0.998 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7170372009277344
Epoch: 59, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.001 Vali Acc: 0.725 Test Loss: 1.001 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.7256374359130859
Epoch: 60, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.002 Vali Acc: 0.725 Test Loss: 1.002 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.749675989151001
Epoch: 61, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.005 Vali Acc: 0.775 Test Loss: 1.005 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 62 cost time: 0.6551151275634766
Epoch: 62, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.006 Vali Acc: 0.750 Test Loss: 1.006 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7253530025482178
Epoch: 63, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.006 Vali Acc: 0.750 Test Loss: 1.006 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.6982085704803467
Epoch: 64, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.007 Vali Acc: 0.750 Test Loss: 1.007 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.8745760917663574
Epoch: 65, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.006 Vali Acc: 0.750 Test Loss: 1.006 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.7173230648040771
Epoch: 66, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.006 Vali Acc: 0.750 Test Loss: 1.006 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.7511606216430664
Epoch: 67, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.004 Vali Acc: 0.750 Test Loss: 1.004 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.6219370365142822
Epoch: 68, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.003 Vali Acc: 0.775 Test Loss: 1.003 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 69 cost time: 0.5905508995056152
Epoch: 69, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.003 Vali Acc: 0.750 Test Loss: 1.003 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7015020847320557
Epoch: 70, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.003 Vali Acc: 0.750 Test Loss: 1.003 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.691605806350708
Epoch: 71, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.003 Vali Acc: 0.750 Test Loss: 1.003 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.7299256324768066
Epoch: 72, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.7971906661987305
Epoch: 73, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.6454594135284424
Epoch: 74, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.004 Vali Acc: 0.750 Test Loss: 1.004 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.6879889965057373
Epoch: 75, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.003 Vali Acc: 0.750 Test Loss: 1.003 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.7085661888122559
Epoch: 76, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.001 Vali Acc: 0.750 Test Loss: 1.001 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.7347261905670166
Epoch: 77, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.000 Vali Acc: 0.750 Test Loss: 1.000 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.5913386344909668
Epoch: 78, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.997 Vali Acc: 0.750 Test Loss: 0.997 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 24052
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2784719467163086
Epoch: 1, Steps: 3 | Train Loss: 1.561 Vali Loss: 1.418 Vali Acc: 0.300 Test Loss: 1.418 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6455423831939697
Epoch: 2, Steps: 3 | Train Loss: 1.500 Vali Loss: 1.388 Vali Acc: 0.300 Test Loss: 1.388 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.7433328628540039
Epoch: 3, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.365 Vali Acc: 0.350 Test Loss: 1.365 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.6708226203918457
Epoch: 4, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.347 Vali Acc: 0.350 Test Loss: 1.347 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.6142106056213379
Epoch: 5, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.331 Vali Acc: 0.375 Test Loss: 1.331 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.7117836475372314
Epoch: 6, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.315 Vali Acc: 0.375 Test Loss: 1.315 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.6683883666992188
Epoch: 7, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.302 Vali Acc: 0.400 Test Loss: 1.302 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.7056972980499268
Epoch: 8, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.290 Vali Acc: 0.425 Test Loss: 1.290 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.6406724452972412
Epoch: 9, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6312088966369629
Epoch: 10, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.270 Vali Acc: 0.400 Test Loss: 1.270 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6430573463439941
Epoch: 11, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6311240196228027
Epoch: 12, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.249 Vali Acc: 0.400 Test Loss: 1.249 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6412026882171631
Epoch: 13, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.238 Vali Acc: 0.425 Test Loss: 1.238 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 14 cost time: 0.61128830909729
Epoch: 14, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.227 Vali Acc: 0.450 Test Loss: 1.227 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 15 cost time: 0.5796058177947998
Epoch: 15, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.219 Vali Acc: 0.450 Test Loss: 1.219 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 16 cost time: 0.6026391983032227
Epoch: 16, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.209 Vali Acc: 0.450 Test Loss: 1.209 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 17 cost time: 0.6704957485198975
Epoch: 17, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.200 Vali Acc: 0.475 Test Loss: 1.200 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 18 cost time: 0.6294667720794678
Epoch: 18, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.192 Vali Acc: 0.475 Test Loss: 1.192 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 19 cost time: 0.838813066482544
Epoch: 19, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 20 cost time: 0.7366859912872314
Epoch: 20, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 21 cost time: 0.7926332950592041
Epoch: 21, Steps: 3 | Train Loss: 0.785 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 22 cost time: 0.6397881507873535
Epoch: 22, Steps: 3 | Train Loss: 0.783 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 23 cost time: 0.6985805034637451
Epoch: 23, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 24 cost time: 0.6473801136016846
Epoch: 24, Steps: 3 | Train Loss: 0.698 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 25 cost time: 0.822045087814331
Epoch: 25, Steps: 3 | Train Loss: 0.679 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 26 cost time: 0.7305200099945068
Epoch: 26, Steps: 3 | Train Loss: 0.642 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 27 cost time: 0.805161714553833
Epoch: 27, Steps: 3 | Train Loss: 0.623 Vali Loss: 1.119 Vali Acc: 0.525 Test Loss: 1.119 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 28 cost time: 0.7237792015075684
Epoch: 28, Steps: 3 | Train Loss: 0.596 Vali Loss: 1.106 Vali Acc: 0.525 Test Loss: 1.106 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 29 cost time: 0.6857426166534424
Epoch: 29, Steps: 3 | Train Loss: 0.571 Vali Loss: 1.097 Vali Acc: 0.525 Test Loss: 1.097 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 30 cost time: 0.7596428394317627
Epoch: 30, Steps: 3 | Train Loss: 0.529 Vali Loss: 1.086 Vali Acc: 0.525 Test Loss: 1.086 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 31 cost time: 0.7742874622344971
Epoch: 31, Steps: 3 | Train Loss: 0.488 Vali Loss: 1.076 Vali Acc: 0.550 Test Loss: 1.076 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 32 cost time: 0.746168851852417
Epoch: 32, Steps: 3 | Train Loss: 0.483 Vali Loss: 1.070 Vali Acc: 0.550 Test Loss: 1.070 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 33 cost time: 0.6733160018920898
Epoch: 33, Steps: 3 | Train Loss: 0.392 Vali Loss: 1.067 Vali Acc: 0.550 Test Loss: 1.067 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 34 cost time: 0.7435517311096191
Epoch: 34, Steps: 3 | Train Loss: 0.360 Vali Loss: 1.058 Vali Acc: 0.550 Test Loss: 1.058 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 35 cost time: 0.6737456321716309
Epoch: 35, Steps: 3 | Train Loss: 0.353 Vali Loss: 1.051 Vali Acc: 0.525 Test Loss: 1.051 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7029075622558594
Epoch: 36, Steps: 3 | Train Loss: 0.318 Vali Loss: 1.046 Vali Acc: 0.525 Test Loss: 1.046 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7704436779022217
Epoch: 37, Steps: 3 | Train Loss: 0.291 Vali Loss: 1.040 Vali Acc: 0.550 Test Loss: 1.040 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549990).  Saving model ...
Epoch: 38 cost time: 0.8323540687561035
Epoch: 38, Steps: 3 | Train Loss: 0.303 Vali Loss: 1.036 Vali Acc: 0.550 Test Loss: 1.036 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 39 cost time: 0.896838903427124
Epoch: 39, Steps: 3 | Train Loss: 0.295 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 40 cost time: 0.7549107074737549
Epoch: 40, Steps: 3 | Train Loss: 0.262 Vali Loss: 1.031 Vali Acc: 0.550 Test Loss: 1.031 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 41 cost time: 0.6979639530181885
Epoch: 41, Steps: 3 | Train Loss: 0.223 Vali Loss: 1.030 Vali Acc: 0.550 Test Loss: 1.030 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 42 cost time: 0.7470428943634033
Epoch: 42, Steps: 3 | Train Loss: 0.200 Vali Loss: 1.030 Vali Acc: 0.525 Test Loss: 1.030 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.72934889793396
Epoch: 43, Steps: 3 | Train Loss: 0.237 Vali Loss: 1.032 Vali Acc: 0.525 Test Loss: 1.032 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.777369499206543
Epoch: 44, Steps: 3 | Train Loss: 0.204 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6418006420135498
Epoch: 45, Steps: 3 | Train Loss: 0.179 Vali Loss: 1.032 Vali Acc: 0.575 Test Loss: 1.032 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 46 cost time: 0.7774019241333008
Epoch: 46, Steps: 3 | Train Loss: 0.227 Vali Loss: 1.024 Vali Acc: 0.575 Test Loss: 1.024 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 47 cost time: 0.8091750144958496
Epoch: 47, Steps: 3 | Train Loss: 0.149 Vali Loss: 1.022 Vali Acc: 0.575 Test Loss: 1.022 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 48 cost time: 0.6688907146453857
Epoch: 48, Steps: 3 | Train Loss: 0.139 Vali Loss: 1.018 Vali Acc: 0.575 Test Loss: 1.018 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 49 cost time: 0.7223904132843018
Epoch: 49, Steps: 3 | Train Loss: 0.185 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 50 cost time: 0.6556739807128906
Epoch: 50, Steps: 3 | Train Loss: 0.139 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 51 cost time: 0.7363851070404053
Epoch: 51, Steps: 3 | Train Loss: 0.123 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 52 cost time: 0.700629472732544
Epoch: 52, Steps: 3 | Train Loss: 0.153 Vali Loss: 1.003 Vali Acc: 0.600 Test Loss: 1.003 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 53 cost time: 0.6733410358428955
Epoch: 53, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.999 Vali Acc: 0.600 Test Loss: 0.999 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 54 cost time: 0.7468087673187256
Epoch: 54, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 55 cost time: 0.6316828727722168
Epoch: 55, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.991 Vali Acc: 0.600 Test Loss: 0.991 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 56 cost time: 0.7240128517150879
Epoch: 56, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.986 Vali Acc: 0.600 Test Loss: 0.986 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 57 cost time: 0.6481001377105713
Epoch: 57, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.982 Vali Acc: 0.625 Test Loss: 0.982 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 58 cost time: 0.6956603527069092
Epoch: 58, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.977 Vali Acc: 0.625 Test Loss: 0.977 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 59 cost time: 0.7956712245941162
Epoch: 59, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.976 Vali Acc: 0.675 Test Loss: 0.976 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 60 cost time: 0.7421407699584961
Epoch: 60, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.977 Vali Acc: 0.650 Test Loss: 0.977 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6766223907470703
Epoch: 61, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.977 Vali Acc: 0.650 Test Loss: 0.977 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.6835296154022217
Epoch: 62, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.5935566425323486
Epoch: 63, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.983 Vali Acc: 0.650 Test Loss: 0.983 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.6504125595092773
Epoch: 64, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.985 Vali Acc: 0.650 Test Loss: 0.985 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.5895440578460693
Epoch: 65, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.986 Vali Acc: 0.650 Test Loss: 0.986 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.7210307121276855
Epoch: 66, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.987 Vali Acc: 0.650 Test Loss: 0.987 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.6225719451904297
Epoch: 67, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.988 Vali Acc: 0.650 Test Loss: 0.988 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.657459020614624
Epoch: 68, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.988 Vali Acc: 0.650 Test Loss: 0.988 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.6635205745697021
Epoch: 69, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.988 Vali Acc: 0.650 Test Loss: 0.988 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 21060
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.358051061630249
Epoch: 1, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.369 Vali Acc: 0.225 Test Loss: 1.369 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.6239221096038818
Epoch: 2, Steps: 3 | Train Loss: 1.479 Vali Loss: 1.330 Vali Acc: 0.325 Test Loss: 1.330 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.8004505634307861
Epoch: 3, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.302 Vali Acc: 0.350 Test Loss: 1.302 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.7627661228179932
Epoch: 4, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.6600968837738037
Epoch: 5, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.264 Vali Acc: 0.475 Test Loss: 1.264 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.676668643951416
Epoch: 6, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.249 Vali Acc: 0.475 Test Loss: 1.249 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.6827216148376465
Epoch: 7, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.6880552768707275
Epoch: 8, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.222 Vali Acc: 0.475 Test Loss: 1.222 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6965878009796143
Epoch: 9, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.210 Vali Acc: 0.475 Test Loss: 1.210 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8624007701873779
Epoch: 10, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.198 Vali Acc: 0.525 Test Loss: 1.198 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.7358264923095703
Epoch: 11, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.187 Vali Acc: 0.525 Test Loss: 1.187 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 0.6757135391235352
Epoch: 12, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.177 Vali Acc: 0.525 Test Loss: 1.177 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 0.7130014896392822
Epoch: 13, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.165 Vali Acc: 0.575 Test Loss: 1.165 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 0.629392147064209
Epoch: 14, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.154 Vali Acc: 0.575 Test Loss: 1.154 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 0.6715404987335205
Epoch: 15, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.142 Vali Acc: 0.600 Test Loss: 1.142 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.7207052707672119
Epoch: 16, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.130 Vali Acc: 0.600 Test Loss: 1.130 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.6596479415893555
Epoch: 17, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.7481081485748291
Epoch: 18, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.758514404296875
Epoch: 19, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6676480770111084
Epoch: 20, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.087 Vali Acc: 0.625 Test Loss: 1.087 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 0.7214748859405518
Epoch: 21, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.785254716873169
Epoch: 22, Steps: 3 | Train Loss: 0.858 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6905872821807861
Epoch: 23, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.056 Vali Acc: 0.625 Test Loss: 1.056 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 24 cost time: 0.6754052639007568
Epoch: 24, Steps: 3 | Train Loss: 0.815 Vali Loss: 1.047 Vali Acc: 0.650 Test Loss: 1.047 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 25 cost time: 0.604271411895752
Epoch: 25, Steps: 3 | Train Loss: 0.755 Vali Loss: 1.036 Vali Acc: 0.650 Test Loss: 1.036 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 26 cost time: 0.6707911491394043
Epoch: 26, Steps: 3 | Train Loss: 0.769 Vali Loss: 1.024 Vali Acc: 0.650 Test Loss: 1.024 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 27 cost time: 0.7102138996124268
Epoch: 27, Steps: 3 | Train Loss: 0.688 Vali Loss: 1.012 Vali Acc: 0.650 Test Loss: 1.012 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 28 cost time: 0.6337661743164062
Epoch: 28, Steps: 3 | Train Loss: 0.633 Vali Loss: 1.000 Vali Acc: 0.650 Test Loss: 1.000 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 29 cost time: 0.7254776954650879
Epoch: 29, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.989 Vali Acc: 0.675 Test Loss: 0.989 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 30 cost time: 0.8178966045379639
Epoch: 30, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.977 Vali Acc: 0.675 Test Loss: 0.977 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 31 cost time: 0.7228853702545166
Epoch: 31, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.966 Vali Acc: 0.675 Test Loss: 0.966 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 32 cost time: 0.6956362724304199
Epoch: 32, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.955 Vali Acc: 0.700 Test Loss: 0.955 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 33 cost time: 0.745495080947876
Epoch: 33, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.943 Vali Acc: 0.725 Test Loss: 0.943 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 34 cost time: 0.7350654602050781
Epoch: 34, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 35 cost time: 0.6674363613128662
Epoch: 35, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.924 Vali Acc: 0.725 Test Loss: 0.924 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6727375984191895
Epoch: 36, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.916 Vali Acc: 0.725 Test Loss: 0.916 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7354938983917236
Epoch: 37, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6487512588500977
Epoch: 38, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.900 Vali Acc: 0.725 Test Loss: 0.900 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7397682666778564
Epoch: 39, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 40 cost time: 0.6979570388793945
Epoch: 40, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 41 cost time: 0.6630384922027588
Epoch: 41, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 42 cost time: 0.6543042659759521
Epoch: 42, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.859 Vali Acc: 0.725 Test Loss: 0.859 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6745948791503906
Epoch: 43, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.852 Vali Acc: 0.725 Test Loss: 0.852 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6622273921966553
Epoch: 44, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.845 Vali Acc: 0.750 Test Loss: 0.845 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 45 cost time: 0.6384224891662598
Epoch: 45, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.838 Vali Acc: 0.700 Test Loss: 0.838 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6956653594970703
Epoch: 46, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.831 Vali Acc: 0.700 Test Loss: 0.831 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6570272445678711
Epoch: 47, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.823 Vali Acc: 0.725 Test Loss: 0.823 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7127008438110352
Epoch: 48, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 49 cost time: 0.7169451713562012
Epoch: 49, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 50 cost time: 0.7528448104858398
Epoch: 50, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 51 cost time: 0.7095444202423096
Epoch: 51, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 52 cost time: 0.6745381355285645
Epoch: 52, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.795 Vali Acc: 0.775 Test Loss: 0.795 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 53 cost time: 0.6572544574737549
Epoch: 53, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.791 Vali Acc: 0.750 Test Loss: 0.791 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8048107624053955
Epoch: 54, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7658987045288086
Epoch: 55, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.782 Vali Acc: 0.775 Test Loss: 0.782 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 56 cost time: 0.6683435440063477
Epoch: 56, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.781 Vali Acc: 0.775 Test Loss: 0.781 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 57 cost time: 0.6557202339172363
Epoch: 57, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.780 Vali Acc: 0.775 Test Loss: 0.780 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 58 cost time: 0.6699314117431641
Epoch: 58, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.776 Vali Acc: 0.775 Test Loss: 0.776 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 59 cost time: 0.6509284973144531
Epoch: 59, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.769 Vali Acc: 0.775 Test Loss: 0.769 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 60 cost time: 0.6743292808532715
Epoch: 60, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 61 cost time: 0.629302978515625
Epoch: 61, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 62 cost time: 0.6918351650238037
Epoch: 62, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.751 Vali Acc: 0.775 Test Loss: 0.751 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 63 cost time: 0.6635591983795166
Epoch: 63, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 64 cost time: 0.7721962928771973
Epoch: 64, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.743 Vali Acc: 0.775 Test Loss: 0.743 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 65 cost time: 0.7742042541503906
Epoch: 65, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.738 Vali Acc: 0.775 Test Loss: 0.738 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 66 cost time: 0.6593761444091797
Epoch: 66, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.735 Vali Acc: 0.775 Test Loss: 0.735 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 67 cost time: 0.9843542575836182
Epoch: 67, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.733 Vali Acc: 0.775 Test Loss: 0.733 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 68 cost time: 0.7158451080322266
Epoch: 68, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.727 Vali Acc: 0.775 Test Loss: 0.727 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 69 cost time: 0.8071630001068115
Epoch: 69, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.725 Vali Acc: 0.775 Test Loss: 0.725 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 70 cost time: 0.8610589504241943
Epoch: 70, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.726 Vali Acc: 0.775 Test Loss: 0.726 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7903172969818115
Epoch: 71, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.726 Vali Acc: 0.775 Test Loss: 0.726 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.7540068626403809
Epoch: 72, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.726 Vali Acc: 0.775 Test Loss: 0.726 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.7686853408813477
Epoch: 73, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.725 Vali Acc: 0.775 Test Loss: 0.725 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 74 cost time: 0.8122882843017578
Epoch: 74, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.723 Vali Acc: 0.775 Test Loss: 0.723 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 75 cost time: 0.7990524768829346
Epoch: 75, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.721 Vali Acc: 0.775 Test Loss: 0.721 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 76 cost time: 0.6940693855285645
Epoch: 76, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.721 Vali Acc: 0.775 Test Loss: 0.721 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 77 cost time: 0.748490571975708
Epoch: 77, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.721 Vali Acc: 0.775 Test Loss: 0.721 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 78 cost time: 0.9673221111297607
Epoch: 78, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 79 cost time: 0.765493631362915
Epoch: 79, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.721 Vali Acc: 0.775 Test Loss: 0.721 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.8696353435516357
Epoch: 80, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.6982553005218506
Epoch: 81, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.717 Vali Acc: 0.775 Test Loss: 0.717 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 82 cost time: 0.7829704284667969
Epoch: 82, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.715 Vali Acc: 0.775 Test Loss: 0.715 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 83 cost time: 0.7787694931030273
Epoch: 83, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.713 Vali Acc: 0.775 Test Loss: 0.713 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 84 cost time: 0.8093862533569336
Epoch: 84, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.711 Vali Acc: 0.775 Test Loss: 0.711 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 85 cost time: 0.6398656368255615
Epoch: 85, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 86 cost time: 0.7016496658325195
Epoch: 86, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.700 Vali Acc: 0.775 Test Loss: 0.700 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 87 cost time: 0.8092978000640869
Epoch: 87, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.700 Vali Acc: 0.775 Test Loss: 0.700 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.8138256072998047
Epoch: 88, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.696 Vali Acc: 0.775 Test Loss: 0.696 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 89 cost time: 0.7384886741638184
Epoch: 89, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 90 cost time: 0.6387691497802734
Epoch: 90, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 91 cost time: 0.6614987850189209
Epoch: 91, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.687 Vali Acc: 0.775 Test Loss: 0.687 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 92 cost time: 0.7216224670410156
Epoch: 92, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.685 Vali Acc: 0.775 Test Loss: 0.685 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 93 cost time: 0.7054431438446045
Epoch: 93, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 94 cost time: 0.683645486831665
Epoch: 94, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.7282290458679199
Epoch: 95, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.681 Vali Acc: 0.775 Test Loss: 0.681 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 96 cost time: 0.7135357856750488
Epoch: 96, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.7219810485839844
Epoch: 97, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.682 Vali Acc: 0.750 Test Loss: 0.682 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.8258066177368164
Epoch: 98, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.684 Vali Acc: 0.750 Test Loss: 0.684 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.6586627960205078
Epoch: 99, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.684 Vali Acc: 0.750 Test Loss: 0.684 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.7371728420257568
Epoch: 100, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.684 Vali Acc: 0.750 Test Loss: 0.684 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 20372
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.228397846221924
Epoch: 1, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.473 Vali Acc: 0.325 Test Loss: 1.473 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.7407245635986328
Epoch: 2, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.448 Vali Acc: 0.325 Test Loss: 1.448 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.5837490558624268
Epoch: 3, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.431 Vali Acc: 0.300 Test Loss: 1.431 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6008579730987549
Epoch: 4, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.419 Vali Acc: 0.300 Test Loss: 1.419 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6132965087890625
Epoch: 5, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.409 Vali Acc: 0.250 Test Loss: 1.409 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6711816787719727
Epoch: 6, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.398 Vali Acc: 0.250 Test Loss: 1.398 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5374252796173096
Epoch: 7, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.389 Vali Acc: 0.275 Test Loss: 1.389 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.675412654876709
Epoch: 8, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.380 Vali Acc: 0.300 Test Loss: 1.380 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6384518146514893
Epoch: 9, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.371 Vali Acc: 0.300 Test Loss: 1.371 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6628923416137695
Epoch: 10, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.361 Vali Acc: 0.375 Test Loss: 1.361 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 11 cost time: 0.6405529975891113
Epoch: 11, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.350 Vali Acc: 0.375 Test Loss: 1.350 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 12 cost time: 0.6742620468139648
Epoch: 12, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.342 Vali Acc: 0.400 Test Loss: 1.342 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 0.5867974758148193
Epoch: 13, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.333 Vali Acc: 0.400 Test Loss: 1.333 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 0.5920066833496094
Epoch: 14, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.324 Vali Acc: 0.450 Test Loss: 1.324 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 15 cost time: 0.6763885021209717
Epoch: 15, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.314 Vali Acc: 0.450 Test Loss: 1.314 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 16 cost time: 0.6743862628936768
Epoch: 16, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.303 Vali Acc: 0.475 Test Loss: 1.303 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 17 cost time: 0.5767807960510254
Epoch: 17, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 18 cost time: 0.7514286041259766
Epoch: 18, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 19 cost time: 0.6770689487457275
Epoch: 19, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.275 Vali Acc: 0.525 Test Loss: 1.275 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 20 cost time: 0.8107271194458008
Epoch: 20, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.264 Vali Acc: 0.525 Test Loss: 1.264 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 21 cost time: 0.6551210880279541
Epoch: 21, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.257 Vali Acc: 0.525 Test Loss: 1.257 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 22 cost time: 0.8114392757415771
Epoch: 22, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.248 Vali Acc: 0.525 Test Loss: 1.248 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 23 cost time: 0.6965630054473877
Epoch: 23, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.238 Vali Acc: 0.525 Test Loss: 1.238 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 24 cost time: 0.823474645614624
Epoch: 24, Steps: 3 | Train Loss: 0.832 Vali Loss: 1.230 Vali Acc: 0.550 Test Loss: 1.230 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 25 cost time: 0.6023612022399902
Epoch: 25, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.219 Vali Acc: 0.550 Test Loss: 1.219 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 26 cost time: 0.7478601932525635
Epoch: 26, Steps: 3 | Train Loss: 0.794 Vali Loss: 1.211 Vali Acc: 0.550 Test Loss: 1.211 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 27 cost time: 0.7518215179443359
Epoch: 27, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.204 Vali Acc: 0.550 Test Loss: 1.204 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 28 cost time: 0.6586334705352783
Epoch: 28, Steps: 3 | Train Loss: 0.708 Vali Loss: 1.197 Vali Acc: 0.550 Test Loss: 1.197 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 29 cost time: 0.7511460781097412
Epoch: 29, Steps: 3 | Train Loss: 0.860 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 30 cost time: 0.6984736919403076
Epoch: 30, Steps: 3 | Train Loss: 0.668 Vali Loss: 1.186 Vali Acc: 0.550 Test Loss: 1.186 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 31 cost time: 0.6439263820648193
Epoch: 31, Steps: 3 | Train Loss: 0.640 Vali Loss: 1.180 Vali Acc: 0.550 Test Loss: 1.180 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 32 cost time: 0.8321845531463623
Epoch: 32, Steps: 3 | Train Loss: 0.671 Vali Loss: 1.176 Vali Acc: 0.550 Test Loss: 1.176 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 33 cost time: 0.6512598991394043
Epoch: 33, Steps: 3 | Train Loss: 0.681 Vali Loss: 1.166 Vali Acc: 0.550 Test Loss: 1.166 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 34 cost time: 0.7371835708618164
Epoch: 34, Steps: 3 | Train Loss: 0.522 Vali Loss: 1.160 Vali Acc: 0.600 Test Loss: 1.160 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 35 cost time: 0.6515529155731201
Epoch: 35, Steps: 3 | Train Loss: 0.647 Vali Loss: 1.153 Vali Acc: 0.600 Test Loss: 1.153 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 36 cost time: 0.6854310035705566
Epoch: 36, Steps: 3 | Train Loss: 0.599 Vali Loss: 1.144 Vali Acc: 0.575 Test Loss: 1.144 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5872647762298584
Epoch: 37, Steps: 3 | Train Loss: 0.554 Vali Loss: 1.135 Vali Acc: 0.575 Test Loss: 1.135 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6487090587615967
Epoch: 38, Steps: 3 | Train Loss: 0.500 Vali Loss: 1.129 Vali Acc: 0.575 Test Loss: 1.129 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6663939952850342
Epoch: 39, Steps: 3 | Train Loss: 0.544 Vali Loss: 1.126 Vali Acc: 0.575 Test Loss: 1.126 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8360123634338379
Epoch: 40, Steps: 3 | Train Loss: 0.519 Vali Loss: 1.120 Vali Acc: 0.575 Test Loss: 1.120 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6919140815734863
Epoch: 41, Steps: 3 | Train Loss: 0.558 Vali Loss: 1.114 Vali Acc: 0.575 Test Loss: 1.114 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6590175628662109
Epoch: 42, Steps: 3 | Train Loss: 0.537 Vali Loss: 1.106 Vali Acc: 0.575 Test Loss: 1.106 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6608982086181641
Epoch: 43, Steps: 3 | Train Loss: 0.451 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 44 cost time: 0.7639415264129639
Epoch: 44, Steps: 3 | Train Loss: 0.443 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 45 cost time: 0.6324145793914795
Epoch: 45, Steps: 3 | Train Loss: 0.384 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 46 cost time: 0.7076883316040039
Epoch: 46, Steps: 3 | Train Loss: 0.433 Vali Loss: 1.070 Vali Acc: 0.575 Test Loss: 1.070 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.779728889465332
Epoch: 47, Steps: 3 | Train Loss: 0.332 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 48 cost time: 0.608137845993042
Epoch: 48, Steps: 3 | Train Loss: 0.371 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 49 cost time: 0.6830883026123047
Epoch: 49, Steps: 3 | Train Loss: 0.313 Vali Loss: 1.042 Vali Acc: 0.650 Test Loss: 1.042 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 50 cost time: 0.6551790237426758
Epoch: 50, Steps: 3 | Train Loss: 0.327 Vali Loss: 1.031 Vali Acc: 0.675 Test Loss: 1.031 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 51 cost time: 0.7057216167449951
Epoch: 51, Steps: 3 | Train Loss: 0.316 Vali Loss: 1.027 Vali Acc: 0.675 Test Loss: 1.027 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 52 cost time: 0.6408426761627197
Epoch: 52, Steps: 3 | Train Loss: 0.315 Vali Loss: 1.026 Vali Acc: 0.650 Test Loss: 1.026 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7093381881713867
Epoch: 53, Steps: 3 | Train Loss: 0.310 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9358923435211182
Epoch: 54, Steps: 3 | Train Loss: 0.287 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5994253158569336
Epoch: 55, Steps: 3 | Train Loss: 0.257 Vali Loss: 1.015 Vali Acc: 0.625 Test Loss: 1.015 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.6421406269073486
Epoch: 56, Steps: 3 | Train Loss: 0.278 Vali Loss: 1.010 Vali Acc: 0.625 Test Loss: 1.010 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.6153764724731445
Epoch: 57, Steps: 3 | Train Loss: 0.254 Vali Loss: 1.008 Vali Acc: 0.625 Test Loss: 1.008 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.6113486289978027
Epoch: 58, Steps: 3 | Train Loss: 0.223 Vali Loss: 1.000 Vali Acc: 0.650 Test Loss: 1.000 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.6528265476226807
Epoch: 59, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.997 Vali Acc: 0.650 Test Loss: 0.997 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.6328043937683105
Epoch: 60, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.991 Vali Acc: 0.650 Test Loss: 0.991 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.6707143783569336
Epoch: 61, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.983 Vali Acc: 0.650 Test Loss: 0.983 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df128_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 19300
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.327582597732544
Epoch: 1, Steps: 3 | Train Loss: 1.657 Vali Loss: 1.481 Vali Acc: 0.275 Test Loss: 1.481 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.5720407962799072
Epoch: 2, Steps: 3 | Train Loss: 1.547 Vali Loss: 1.446 Vali Acc: 0.275 Test Loss: 1.446 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.702216386795044
Epoch: 3, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.405 Vali Acc: 0.275 Test Loss: 1.405 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.6371476650238037
Epoch: 4, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.357 Vali Acc: 0.300 Test Loss: 1.357 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.7070510387420654
Epoch: 5, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.314 Vali Acc: 0.375 Test Loss: 1.314 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.6043806076049805
Epoch: 6, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.5920567512512207
Epoch: 7, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.7449965476989746
Epoch: 8, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.235 Vali Acc: 0.525 Test Loss: 1.235 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.6090466976165771
Epoch: 9, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.201 Vali Acc: 0.550 Test Loss: 1.201 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.7205865383148193
Epoch: 10, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.162 Vali Acc: 0.600 Test Loss: 1.162 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 0.7102770805358887
Epoch: 11, Steps: 3 | Train Loss: 0.825 Vali Loss: 1.132 Vali Acc: 0.600 Test Loss: 1.132 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.7058620452880859
Epoch: 12, Steps: 3 | Train Loss: 0.764 Vali Loss: 1.098 Vali Acc: 0.625 Test Loss: 1.098 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.676886796951294
Epoch: 13, Steps: 3 | Train Loss: 0.669 Vali Loss: 1.058 Vali Acc: 0.625 Test Loss: 1.058 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.698408842086792
Epoch: 14, Steps: 3 | Train Loss: 0.571 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.6219325065612793
Epoch: 15, Steps: 3 | Train Loss: 0.509 Vali Loss: 1.000 Vali Acc: 0.650 Test Loss: 1.000 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 0.6606683731079102
Epoch: 16, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.971 Vali Acc: 0.675 Test Loss: 0.971 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 0.6502816677093506
Epoch: 17, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.959 Vali Acc: 0.675 Test Loss: 0.959 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 0.7602512836456299
Epoch: 18, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.940 Vali Acc: 0.675 Test Loss: 0.940 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 19 cost time: 0.728956937789917
Epoch: 19, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.922 Vali Acc: 0.700 Test Loss: 0.922 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 20 cost time: 0.7436778545379639
Epoch: 20, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.912 Vali Acc: 0.700 Test Loss: 0.912 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 21 cost time: 0.7019808292388916
Epoch: 21, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.903 Vali Acc: 0.675 Test Loss: 0.903 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6987400054931641
Epoch: 22, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.867 Vali Acc: 0.750 Test Loss: 0.867 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 23 cost time: 0.7119753360748291
Epoch: 23, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 0.7418212890625
Epoch: 24, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 25 cost time: 0.8129711151123047
Epoch: 25, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.804 Vali Acc: 0.775 Test Loss: 0.804 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 26 cost time: 0.8020005226135254
Epoch: 26, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.805 Vali Acc: 0.775 Test Loss: 0.805 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7710447311401367
Epoch: 27, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.804 Vali Acc: 0.775 Test Loss: 0.804 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.838660717010498
Epoch: 28, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.806 Vali Acc: 0.775 Test Loss: 0.806 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7394595146179199
Epoch: 29, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.800 Vali Acc: 0.775 Test Loss: 0.800 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 30 cost time: 0.7844710350036621
Epoch: 30, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.790 Vali Acc: 0.775 Test Loss: 0.790 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 31 cost time: 0.7384772300720215
Epoch: 31, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.774 Vali Acc: 0.800 Test Loss: 0.774 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 32 cost time: 0.7065935134887695
Epoch: 32, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 33 cost time: 0.6407506465911865
Epoch: 33, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.745 Vali Acc: 0.800 Test Loss: 0.745 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 34 cost time: 0.6577548980712891
Epoch: 34, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 35 cost time: 0.7441220283508301
Epoch: 35, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.733 Vali Acc: 0.800 Test Loss: 0.733 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 36 cost time: 0.7871394157409668
Epoch: 36, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6733841896057129
Epoch: 37, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.742 Vali Acc: 0.800 Test Loss: 0.742 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6342058181762695
Epoch: 38, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.748 Vali Acc: 0.775 Test Loss: 0.748 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7428162097930908
Epoch: 39, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6444895267486572
Epoch: 40, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7576372623443604
Epoch: 41, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7473442554473877
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8537192344665527
Epoch: 43, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.751 Vali Acc: 0.800 Test Loss: 0.751 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6857988834381104
Epoch: 44, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.750 Vali Acc: 0.800 Test Loss: 0.750 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6278603076934814
Epoch: 45, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.746 Vali Acc: 0.800 Test Loss: 0.746 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 29124
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.226200819015503
Epoch: 1, Steps: 3 | Train Loss: 1.525 Vali Loss: 1.455 Vali Acc: 0.275 Test Loss: 1.455 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.5945010185241699
Epoch: 2, Steps: 3 | Train Loss: 1.533 Vali Loss: 1.443 Vali Acc: 0.300 Test Loss: 1.443 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.6847090721130371
Epoch: 3, Steps: 3 | Train Loss: 1.500 Vali Loss: 1.433 Vali Acc: 0.300 Test Loss: 1.433 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.619513988494873
Epoch: 4, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.422 Vali Acc: 0.300 Test Loss: 1.422 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.6128010749816895
Epoch: 5, Steps: 3 | Train Loss: 1.489 Vali Loss: 1.407 Vali Acc: 0.300 Test Loss: 1.407 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.5805332660675049
Epoch: 6, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.390 Vali Acc: 0.325 Test Loss: 1.390 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.6422648429870605
Epoch: 7, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.367 Vali Acc: 0.350 Test Loss: 1.367 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.856818437576294
Epoch: 8, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.342 Vali Acc: 0.400 Test Loss: 1.342 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.679206132888794
Epoch: 9, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.318 Vali Acc: 0.425 Test Loss: 1.318 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.6963927745819092
Epoch: 10, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.294 Vali Acc: 0.450 Test Loss: 1.294 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.6324529647827148
Epoch: 11, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.277 Vali Acc: 0.425 Test Loss: 1.277 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6592812538146973
Epoch: 12, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 0.6209726333618164
Epoch: 13, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.220 Vali Acc: 0.525 Test Loss: 1.220 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 0.6774535179138184
Epoch: 14, Steps: 3 | Train Loss: 0.755 Vali Loss: 1.192 Vali Acc: 0.550 Test Loss: 1.192 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.6191139221191406
Epoch: 15, Steps: 3 | Train Loss: 0.769 Vali Loss: 1.162 Vali Acc: 0.575 Test Loss: 1.162 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 16 cost time: 0.6036996841430664
Epoch: 16, Steps: 3 | Train Loss: 0.667 Vali Loss: 1.139 Vali Acc: 0.575 Test Loss: 1.139 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 17 cost time: 0.6842436790466309
Epoch: 17, Steps: 3 | Train Loss: 0.697 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.7121660709381104
Epoch: 18, Steps: 3 | Train Loss: 0.582 Vali Loss: 1.094 Vali Acc: 0.600 Test Loss: 1.094 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.6920666694641113
Epoch: 19, Steps: 3 | Train Loss: 0.541 Vali Loss: 1.075 Vali Acc: 0.625 Test Loss: 1.075 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 20 cost time: 0.6677961349487305
Epoch: 20, Steps: 3 | Train Loss: 0.511 Vali Loss: 1.055 Vali Acc: 0.625 Test Loss: 1.055 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 0.7636501789093018
Epoch: 21, Steps: 3 | Train Loss: 0.450 Vali Loss: 1.036 Vali Acc: 0.650 Test Loss: 1.036 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 22 cost time: 0.5625655651092529
Epoch: 22, Steps: 3 | Train Loss: 0.427 Vali Loss: 1.015 Vali Acc: 0.650 Test Loss: 1.015 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 23 cost time: 0.6605026721954346
Epoch: 23, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.997 Vali Acc: 0.650 Test Loss: 0.997 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 0.7546112537384033
Epoch: 24, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.980 Vali Acc: 0.650 Test Loss: 0.980 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 25 cost time: 0.7867498397827148
Epoch: 25, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.960 Vali Acc: 0.675 Test Loss: 0.960 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 26 cost time: 0.7537028789520264
Epoch: 26, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.948 Vali Acc: 0.675 Test Loss: 0.948 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 27 cost time: 0.6699275970458984
Epoch: 27, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.938 Vali Acc: 0.675 Test Loss: 0.938 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 28 cost time: 0.7695260047912598
Epoch: 28, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.935 Vali Acc: 0.700 Test Loss: 0.935 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 29 cost time: 0.7546882629394531
Epoch: 29, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.936 Vali Acc: 0.700 Test Loss: 0.936 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6725466251373291
Epoch: 30, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.936 Vali Acc: 0.700 Test Loss: 0.936 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7152700424194336
Epoch: 31, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.937 Vali Acc: 0.700 Test Loss: 0.937 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6860277652740479
Epoch: 32, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.929 Vali Acc: 0.700 Test Loss: 0.929 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 33 cost time: 0.6818032264709473
Epoch: 33, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.920 Vali Acc: 0.725 Test Loss: 0.920 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 34 cost time: 0.7178075313568115
Epoch: 34, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 35 cost time: 0.8356451988220215
Epoch: 35, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.908 Vali Acc: 0.750 Test Loss: 0.908 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 36 cost time: 0.7070283889770508
Epoch: 36, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.906 Vali Acc: 0.750 Test Loss: 0.906 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 37 cost time: 0.7823600769042969
Epoch: 37, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 38 cost time: 0.6814086437225342
Epoch: 38, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 39 cost time: 0.833378791809082
Epoch: 39, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 40 cost time: 0.8458602428436279
Epoch: 40, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 41 cost time: 0.861231803894043
Epoch: 41, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.895 Vali Acc: 0.725 Test Loss: 0.895 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7503485679626465
Epoch: 42, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.894 Vali Acc: 0.725 Test Loss: 0.894 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7896139621734619
Epoch: 43, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.891 Vali Acc: 0.725 Test Loss: 0.891 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9148125648498535
Epoch: 44, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.891 Vali Acc: 0.725 Test Loss: 0.891 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7137110233306885
Epoch: 45, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.889 Vali Acc: 0.725 Test Loss: 0.889 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7716362476348877
Epoch: 46, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.888 Vali Acc: 0.725 Test Loss: 0.888 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6557369232177734
Epoch: 47, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.888 Vali Acc: 0.725 Test Loss: 0.888 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.674675703048706
Epoch: 48, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.887 Vali Acc: 0.725 Test Loss: 0.887 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7211034297943115
Epoch: 49, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.884 Vali Acc: 0.725 Test Loss: 0.884 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.9534335136413574
Epoch: 50, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.882 Vali Acc: 0.725 Test Loss: 0.882 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 22628
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.822112798690796
Epoch: 1, Steps: 3 | Train Loss: 1.539 Vali Loss: 1.427 Vali Acc: 0.200 Test Loss: 1.427 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.636810302734375
Epoch: 2, Steps: 3 | Train Loss: 1.553 Vali Loss: 1.414 Vali Acc: 0.175 Test Loss: 1.414 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.639240026473999
Epoch: 3, Steps: 3 | Train Loss: 1.529 Vali Loss: 1.407 Vali Acc: 0.225 Test Loss: 1.407 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.6292998790740967
Epoch: 4, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.392 Vali Acc: 0.225 Test Loss: 1.392 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.6803994178771973
Epoch: 5, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.374 Vali Acc: 0.325 Test Loss: 1.374 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.6202895641326904
Epoch: 6, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.350 Vali Acc: 0.350 Test Loss: 1.350 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.7320799827575684
Epoch: 7, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.6980195045471191
Epoch: 8, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.298 Vali Acc: 0.375 Test Loss: 1.298 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6223814487457275
Epoch: 9, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.272 Vali Acc: 0.425 Test Loss: 1.272 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.6354331970214844
Epoch: 10, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.248 Vali Acc: 0.425 Test Loss: 1.248 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 11 cost time: 0.6441400051116943
Epoch: 11, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.225 Vali Acc: 0.425 Test Loss: 1.225 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 12 cost time: 0.6295008659362793
Epoch: 12, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 0.7174239158630371
Epoch: 13, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.179 Vali Acc: 0.525 Test Loss: 1.179 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 0.6883225440979004
Epoch: 14, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.160 Vali Acc: 0.550 Test Loss: 1.160 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.5942318439483643
Epoch: 15, Steps: 3 | Train Loss: 0.783 Vali Loss: 1.139 Vali Acc: 0.525 Test Loss: 1.139 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6643021106719971
Epoch: 16, Steps: 3 | Train Loss: 0.718 Vali Loss: 1.116 Vali Acc: 0.550 Test Loss: 1.116 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 0.6387062072753906
Epoch: 17, Steps: 3 | Train Loss: 0.698 Vali Loss: 1.093 Vali Acc: 0.575 Test Loss: 1.093 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 0.6866495609283447
Epoch: 18, Steps: 3 | Train Loss: 0.657 Vali Loss: 1.079 Vali Acc: 0.550 Test Loss: 1.079 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6913595199584961
Epoch: 19, Steps: 3 | Train Loss: 0.642 Vali Loss: 1.062 Vali Acc: 0.550 Test Loss: 1.062 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6624150276184082
Epoch: 20, Steps: 3 | Train Loss: 0.526 Vali Loss: 1.040 Vali Acc: 0.550 Test Loss: 1.040 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6309163570404053
Epoch: 21, Steps: 3 | Train Loss: 0.507 Vali Loss: 1.017 Vali Acc: 0.575 Test Loss: 1.017 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 22 cost time: 0.7278041839599609
Epoch: 22, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.997 Vali Acc: 0.600 Test Loss: 0.997 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.7869958877563477
Epoch: 23, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.980 Vali Acc: 0.600 Test Loss: 0.980 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 0.7425398826599121
Epoch: 24, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.6629209518432617
Epoch: 25, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.953 Vali Acc: 0.600 Test Loss: 0.953 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.7184927463531494
Epoch: 26, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.943 Vali Acc: 0.600 Test Loss: 0.943 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599991).  Saving model ...
Epoch: 27 cost time: 0.738715410232544
Epoch: 27, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.930 Vali Acc: 0.625 Test Loss: 0.930 Test Acc: 0.625
Validation loss decreased (-0.599991 --> -0.624991).  Saving model ...
Epoch: 28 cost time: 0.779620885848999
Epoch: 28, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.916 Vali Acc: 0.650 Test Loss: 0.916 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649991).  Saving model ...
Epoch: 29 cost time: 0.741856575012207
Epoch: 29, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.907 Vali Acc: 0.650 Test Loss: 0.907 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 30 cost time: 0.7686882019042969
Epoch: 30, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.902 Vali Acc: 0.650 Test Loss: 0.902 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 31 cost time: 0.6986210346221924
Epoch: 31, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.898 Vali Acc: 0.650 Test Loss: 0.898 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 32 cost time: 0.7796695232391357
Epoch: 32, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.892 Vali Acc: 0.650 Test Loss: 0.892 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 33 cost time: 0.6822035312652588
Epoch: 33, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.892 Vali Acc: 0.625 Test Loss: 0.892 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6489191055297852
Epoch: 34, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.887 Vali Acc: 0.625 Test Loss: 0.887 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6862087249755859
Epoch: 35, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.885 Vali Acc: 0.625 Test Loss: 0.885 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.73183274269104
Epoch: 36, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.878 Vali Acc: 0.625 Test Loss: 0.878 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6751048564910889
Epoch: 37, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.872 Vali Acc: 0.625 Test Loss: 0.872 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7774312496185303
Epoch: 38, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.866 Vali Acc: 0.650 Test Loss: 0.866 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 39 cost time: 0.8641307353973389
Epoch: 39, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.868 Vali Acc: 0.650 Test Loss: 0.868 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8147213459014893
Epoch: 40, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.872 Vali Acc: 0.650 Test Loss: 0.872 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7735633850097656
Epoch: 41, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.874 Vali Acc: 0.625 Test Loss: 0.874 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7058727741241455
Epoch: 42, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.873 Vali Acc: 0.650 Test Loss: 0.873 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8012869358062744
Epoch: 43, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.873 Vali Acc: 0.650 Test Loss: 0.873 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8739254474639893
Epoch: 44, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.869 Vali Acc: 0.650 Test Loss: 0.869 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7600390911102295
Epoch: 45, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.868 Vali Acc: 0.650 Test Loss: 0.868 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8676919937133789
Epoch: 46, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.864 Vali Acc: 0.650 Test Loss: 0.864 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 47 cost time: 0.6843914985656738
Epoch: 47, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.858 Vali Acc: 0.650 Test Loss: 0.858 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 48 cost time: 0.6445848941802979
Epoch: 48, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.852 Vali Acc: 0.650 Test Loss: 0.852 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 49 cost time: 0.6670453548431396
Epoch: 49, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.849 Vali Acc: 0.650 Test Loss: 0.849 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649992).  Saving model ...
Epoch: 50 cost time: 0.7056727409362793
Epoch: 50, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.846 Vali Acc: 0.650 Test Loss: 0.846 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 51 cost time: 0.7643685340881348
Epoch: 51, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.844 Vali Acc: 0.650 Test Loss: 0.844 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 52 cost time: 0.6751344203948975
Epoch: 52, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.842 Vali Acc: 0.625 Test Loss: 0.842 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6575133800506592
Epoch: 53, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.837 Vali Acc: 0.625 Test Loss: 0.837 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6688690185546875
Epoch: 54, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.832 Vali Acc: 0.625 Test Loss: 0.832 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.7132704257965088
Epoch: 55, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.831 Vali Acc: 0.650 Test Loss: 0.831 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 56 cost time: 0.7213530540466309
Epoch: 56, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.832 Vali Acc: 0.650 Test Loss: 0.832 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7352685928344727
Epoch: 57, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.834 Vali Acc: 0.650 Test Loss: 0.834 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.71730637550354
Epoch: 58, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.837 Vali Acc: 0.650 Test Loss: 0.837 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.7288534641265869
Epoch: 59, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.837 Vali Acc: 0.650 Test Loss: 0.837 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.910698652267456
Epoch: 60, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.840 Vali Acc: 0.650 Test Loss: 0.840 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.8174788951873779
Epoch: 61, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.840 Vali Acc: 0.650 Test Loss: 0.840 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.7815194129943848
Epoch: 62, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.842 Vali Acc: 0.650 Test Loss: 0.842 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.8579986095428467
Epoch: 63, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.841 Vali Acc: 0.650 Test Loss: 0.841 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.7121460437774658
Epoch: 64, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.841 Vali Acc: 0.650 Test Loss: 0.841 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.7207317352294922
Epoch: 65, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.839 Vali Acc: 0.650 Test Loss: 0.839 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 19604
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.202028274536133
Epoch: 1, Steps: 3 | Train Loss: 1.567 Vali Loss: 1.480 Vali Acc: 0.225 Test Loss: 1.480 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.5902738571166992
Epoch: 2, Steps: 3 | Train Loss: 1.518 Vali Loss: 1.449 Vali Acc: 0.200 Test Loss: 1.449 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6248242855072021
Epoch: 3, Steps: 3 | Train Loss: 1.534 Vali Loss: 1.427 Vali Acc: 0.150 Test Loss: 1.427 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6876318454742432
Epoch: 4, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.405 Vali Acc: 0.200 Test Loss: 1.405 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.699711799621582
Epoch: 5, Steps: 3 | Train Loss: 1.505 Vali Loss: 1.384 Vali Acc: 0.175 Test Loss: 1.384 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7122185230255127
Epoch: 6, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.362 Vali Acc: 0.300 Test Loss: 1.362 Test Acc: 0.300
Validation loss decreased (-0.224985 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 0.6168158054351807
Epoch: 7, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.341 Vali Acc: 0.325 Test Loss: 1.341 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 8 cost time: 0.6786091327667236
Epoch: 8, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.321 Vali Acc: 0.375 Test Loss: 1.321 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 0.6325795650482178
Epoch: 9, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 0.7043921947479248
Epoch: 10, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.276 Vali Acc: 0.450 Test Loss: 1.276 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.6529512405395508
Epoch: 11, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.255 Vali Acc: 0.475 Test Loss: 1.255 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 0.6567573547363281
Epoch: 12, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.231 Vali Acc: 0.525 Test Loss: 1.231 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 0.6213643550872803
Epoch: 13, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.212 Vali Acc: 0.550 Test Loss: 1.212 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 0.6880438327789307
Epoch: 14, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.192 Vali Acc: 0.575 Test Loss: 1.192 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 0.6626837253570557
Epoch: 15, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.172 Vali Acc: 0.600 Test Loss: 1.172 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 0.6635794639587402
Epoch: 16, Steps: 3 | Train Loss: 0.898 Vali Loss: 1.157 Vali Acc: 0.625 Test Loss: 1.157 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 17 cost time: 0.7133796215057373
Epoch: 17, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.7285768985748291
Epoch: 18, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7164173126220703
Epoch: 19, Steps: 3 | Train Loss: 0.707 Vali Loss: 1.114 Vali Acc: 0.600 Test Loss: 1.114 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.711402177810669
Epoch: 20, Steps: 3 | Train Loss: 0.627 Vali Loss: 1.101 Vali Acc: 0.600 Test Loss: 1.101 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6597132682800293
Epoch: 21, Steps: 3 | Train Loss: 0.588 Vali Loss: 1.086 Vali Acc: 0.675 Test Loss: 1.086 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 22 cost time: 0.6806981563568115
Epoch: 22, Steps: 3 | Train Loss: 0.607 Vali Loss: 1.072 Vali Acc: 0.675 Test Loss: 1.072 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 23 cost time: 0.716679573059082
Epoch: 23, Steps: 3 | Train Loss: 0.587 Vali Loss: 1.060 Vali Acc: 0.675 Test Loss: 1.060 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 24 cost time: 0.7556889057159424
Epoch: 24, Steps: 3 | Train Loss: 0.483 Vali Loss: 1.049 Vali Acc: 0.675 Test Loss: 1.049 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 25 cost time: 0.6525614261627197
Epoch: 25, Steps: 3 | Train Loss: 0.548 Vali Loss: 1.036 Vali Acc: 0.675 Test Loss: 1.036 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 26 cost time: 0.678971529006958
Epoch: 26, Steps: 3 | Train Loss: 0.461 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 27 cost time: 0.6145920753479004
Epoch: 27, Steps: 3 | Train Loss: 0.467 Vali Loss: 1.015 Vali Acc: 0.675 Test Loss: 1.015 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 28 cost time: 0.6684939861297607
Epoch: 28, Steps: 3 | Train Loss: 0.382 Vali Loss: 1.003 Vali Acc: 0.675 Test Loss: 1.003 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 29 cost time: 0.7544369697570801
Epoch: 29, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.986 Vali Acc: 0.675 Test Loss: 0.986 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 30 cost time: 0.7099459171295166
Epoch: 30, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.975 Vali Acc: 0.675 Test Loss: 0.975 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 31 cost time: 0.6919066905975342
Epoch: 31, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.966 Vali Acc: 0.675 Test Loss: 0.966 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 32 cost time: 0.7564730644226074
Epoch: 32, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.953 Vali Acc: 0.675 Test Loss: 0.953 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 33 cost time: 0.8264169692993164
Epoch: 33, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.948 Vali Acc: 0.725 Test Loss: 0.948 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 34 cost time: 0.7307970523834229
Epoch: 34, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.948 Vali Acc: 0.725 Test Loss: 0.948 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7476751804351807
Epoch: 35, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.952 Vali Acc: 0.725 Test Loss: 0.952 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6967730522155762
Epoch: 36, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.954 Vali Acc: 0.725 Test Loss: 0.954 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7190794944763184
Epoch: 37, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.958 Vali Acc: 0.725 Test Loss: 0.958 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6798036098480225
Epoch: 38, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.960 Vali Acc: 0.725 Test Loss: 0.960 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7273805141448975
Epoch: 39, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6380634307861328
Epoch: 40, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6513233184814453
Epoch: 41, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.963 Vali Acc: 0.725 Test Loss: 0.963 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6146166324615479
Epoch: 42, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.958 Vali Acc: 0.725 Test Loss: 0.958 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.640263557434082
Epoch: 43, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.953 Vali Acc: 0.725 Test Loss: 0.953 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 17716
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3959338665008545
Epoch: 1, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.435 Vali Acc: 0.275 Test Loss: 1.435 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.7231626510620117
Epoch: 2, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.434 Vali Acc: 0.250 Test Loss: 1.434 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.62921142578125
Epoch: 3, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.433 Vali Acc: 0.275 Test Loss: 1.433 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.6442010402679443
Epoch: 4, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.430 Vali Acc: 0.275 Test Loss: 1.430 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.6363656520843506
Epoch: 5, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.424 Vali Acc: 0.300 Test Loss: 1.424 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.6473252773284912
Epoch: 6, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.416 Vali Acc: 0.350 Test Loss: 1.416 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.6200754642486572
Epoch: 7, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.407 Vali Acc: 0.325 Test Loss: 1.407 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7376883029937744
Epoch: 8, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.397 Vali Acc: 0.350 Test Loss: 1.397 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.5854513645172119
Epoch: 9, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.386 Vali Acc: 0.325 Test Loss: 1.386 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6109127998352051
Epoch: 10, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.376 Vali Acc: 0.350 Test Loss: 1.376 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 11 cost time: 0.6178927421569824
Epoch: 11, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.365 Vali Acc: 0.400 Test Loss: 1.365 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 0.5953583717346191
Epoch: 12, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 13 cost time: 0.6398797035217285
Epoch: 13, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.342 Vali Acc: 0.400 Test Loss: 1.342 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 0.6959817409515381
Epoch: 14, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.329 Vali Acc: 0.375 Test Loss: 1.329 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6597652435302734
Epoch: 15, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.319 Vali Acc: 0.400 Test Loss: 1.319 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 16 cost time: 0.7314953804016113
Epoch: 16, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.309 Vali Acc: 0.400 Test Loss: 1.309 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 17 cost time: 0.5615918636322021
Epoch: 17, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.300 Vali Acc: 0.425 Test Loss: 1.300 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 18 cost time: 0.6991174221038818
Epoch: 18, Steps: 3 | Train Loss: 0.840 Vali Loss: 1.292 Vali Acc: 0.425 Test Loss: 1.292 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 19 cost time: 0.6872732639312744
Epoch: 19, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.284 Vali Acc: 0.475 Test Loss: 1.284 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 20 cost time: 0.7260527610778809
Epoch: 20, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 21 cost time: 0.6421241760253906
Epoch: 21, Steps: 3 | Train Loss: 0.836 Vali Loss: 1.266 Vali Acc: 0.525 Test Loss: 1.266 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 22 cost time: 0.6824254989624023
Epoch: 22, Steps: 3 | Train Loss: 0.748 Vali Loss: 1.256 Vali Acc: 0.525 Test Loss: 1.256 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 23 cost time: 0.5855286121368408
Epoch: 23, Steps: 3 | Train Loss: 0.716 Vali Loss: 1.247 Vali Acc: 0.525 Test Loss: 1.247 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 24 cost time: 0.7263877391815186
Epoch: 24, Steps: 3 | Train Loss: 0.732 Vali Loss: 1.236 Vali Acc: 0.525 Test Loss: 1.236 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 25 cost time: 0.6514706611633301
Epoch: 25, Steps: 3 | Train Loss: 0.655 Vali Loss: 1.229 Vali Acc: 0.525 Test Loss: 1.229 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 26 cost time: 0.591364860534668
Epoch: 26, Steps: 3 | Train Loss: 0.591 Vali Loss: 1.221 Vali Acc: 0.525 Test Loss: 1.221 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 27 cost time: 0.6887094974517822
Epoch: 27, Steps: 3 | Train Loss: 0.572 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6056234836578369
Epoch: 28, Steps: 3 | Train Loss: 0.567 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6688334941864014
Epoch: 29, Steps: 3 | Train Loss: 0.530 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6824016571044922
Epoch: 30, Steps: 3 | Train Loss: 0.492 Vali Loss: 1.200 Vali Acc: 0.525 Test Loss: 1.200 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 31 cost time: 0.6543207168579102
Epoch: 31, Steps: 3 | Train Loss: 0.482 Vali Loss: 1.198 Vali Acc: 0.575 Test Loss: 1.198 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 32 cost time: 0.6691780090332031
Epoch: 32, Steps: 3 | Train Loss: 0.463 Vali Loss: 1.197 Vali Acc: 0.575 Test Loss: 1.197 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 33 cost time: 0.6725821495056152
Epoch: 33, Steps: 3 | Train Loss: 0.439 Vali Loss: 1.197 Vali Acc: 0.575 Test Loss: 1.197 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 34 cost time: 0.6956381797790527
Epoch: 34, Steps: 3 | Train Loss: 0.412 Vali Loss: 1.190 Vali Acc: 0.575 Test Loss: 1.190 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 35 cost time: 0.640568733215332
Epoch: 35, Steps: 3 | Train Loss: 0.402 Vali Loss: 1.187 Vali Acc: 0.600 Test Loss: 1.187 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 36 cost time: 0.68442702293396
Epoch: 36, Steps: 3 | Train Loss: 0.366 Vali Loss: 1.187 Vali Acc: 0.600 Test Loss: 1.187 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 37 cost time: 0.6586799621582031
Epoch: 37, Steps: 3 | Train Loss: 0.353 Vali Loss: 1.185 Vali Acc: 0.600 Test Loss: 1.185 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 38 cost time: 0.6590421199798584
Epoch: 38, Steps: 3 | Train Loss: 0.317 Vali Loss: 1.186 Vali Acc: 0.600 Test Loss: 1.186 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6261038780212402
Epoch: 39, Steps: 3 | Train Loss: 0.299 Vali Loss: 1.188 Vali Acc: 0.600 Test Loss: 1.188 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8759908676147461
Epoch: 40, Steps: 3 | Train Loss: 0.311 Vali Loss: 1.187 Vali Acc: 0.625 Test Loss: 1.187 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 41 cost time: 0.6424229145050049
Epoch: 41, Steps: 3 | Train Loss: 0.269 Vali Loss: 1.187 Vali Acc: 0.625 Test Loss: 1.187 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 42 cost time: 0.6637523174285889
Epoch: 42, Steps: 3 | Train Loss: 0.288 Vali Loss: 1.186 Vali Acc: 0.625 Test Loss: 1.186 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 43 cost time: 0.7240517139434814
Epoch: 43, Steps: 3 | Train Loss: 0.244 Vali Loss: 1.183 Vali Acc: 0.625 Test Loss: 1.183 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 44 cost time: 0.6811387538909912
Epoch: 44, Steps: 3 | Train Loss: 0.260 Vali Loss: 1.179 Vali Acc: 0.625 Test Loss: 1.179 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 45 cost time: 0.6813919544219971
Epoch: 45, Steps: 3 | Train Loss: 0.225 Vali Loss: 1.178 Vali Acc: 0.625 Test Loss: 1.178 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 46 cost time: 0.6948871612548828
Epoch: 46, Steps: 3 | Train Loss: 0.175 Vali Loss: 1.175 Vali Acc: 0.625 Test Loss: 1.175 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 47 cost time: 0.6113317012786865
Epoch: 47, Steps: 3 | Train Loss: 0.201 Vali Loss: 1.175 Vali Acc: 0.625 Test Loss: 1.175 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 48 cost time: 0.6706805229187012
Epoch: 48, Steps: 3 | Train Loss: 0.200 Vali Loss: 1.175 Vali Acc: 0.625 Test Loss: 1.175 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 49 cost time: 0.6628038883209229
Epoch: 49, Steps: 3 | Train Loss: 0.183 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8190903663635254
Epoch: 50, Steps: 3 | Train Loss: 0.155 Vali Loss: 1.177 Vali Acc: 0.625 Test Loss: 1.177 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.6631679534912109
Epoch: 51, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.177 Vali Acc: 0.625 Test Loss: 1.177 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.6965017318725586
Epoch: 52, Steps: 3 | Train Loss: 0.159 Vali Loss: 1.178 Vali Acc: 0.625 Test Loss: 1.178 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.6804900169372559
Epoch: 53, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.180 Vali Acc: 0.625 Test Loss: 1.180 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.7545294761657715
Epoch: 54, Steps: 3 | Train Loss: 0.127 Vali Loss: 1.183 Vali Acc: 0.625 Test Loss: 1.183 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.668614387512207
Epoch: 55, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.186 Vali Acc: 0.625 Test Loss: 1.186 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.7684571743011475
Epoch: 56, Steps: 3 | Train Loss: 0.110 Vali Loss: 1.191 Vali Acc: 0.625 Test Loss: 1.191 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.6198689937591553
Epoch: 57, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.194 Vali Acc: 0.625 Test Loss: 1.194 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.7194530963897705
Epoch: 58, Steps: 3 | Train Loss: 0.125 Vali Loss: 1.196 Vali Acc: 0.625 Test Loss: 1.196 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 14724
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.274265766143799
Epoch: 1, Steps: 3 | Train Loss: 1.548 Vali Loss: 1.353 Vali Acc: 0.325 Test Loss: 1.353 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.5841624736785889
Epoch: 2, Steps: 3 | Train Loss: 1.520 Vali Loss: 1.353 Vali Acc: 0.350 Test Loss: 1.353 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.7462284564971924
Epoch: 3, Steps: 3 | Train Loss: 1.530 Vali Loss: 1.356 Vali Acc: 0.325 Test Loss: 1.356 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6431243419647217
Epoch: 4, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.356 Vali Acc: 0.275 Test Loss: 1.356 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6952266693115234
Epoch: 5, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.356 Vali Acc: 0.350 Test Loss: 1.356 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6492762565612793
Epoch: 6, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.353 Vali Acc: 0.375 Test Loss: 1.353 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.5883214473724365
Epoch: 7, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.743070125579834
Epoch: 8, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.340 Vali Acc: 0.450 Test Loss: 1.340 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.6770830154418945
Epoch: 9, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.330 Vali Acc: 0.475 Test Loss: 1.330 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.7111659049987793
Epoch: 10, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.322 Vali Acc: 0.475 Test Loss: 1.322 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.7481467723846436
Epoch: 11, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.313 Vali Acc: 0.475 Test Loss: 1.313 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 0.6773338317871094
Epoch: 12, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.305 Vali Acc: 0.475 Test Loss: 1.305 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 13 cost time: 0.6519887447357178
Epoch: 13, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.295 Vali Acc: 0.450 Test Loss: 1.295 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6211695671081543
Epoch: 14, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.287 Vali Acc: 0.450 Test Loss: 1.287 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5972268581390381
Epoch: 15, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.276 Vali Acc: 0.450 Test Loss: 1.276 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7267293930053711
Epoch: 16, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.265 Vali Acc: 0.450 Test Loss: 1.265 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7485024929046631
Epoch: 17, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 18 cost time: 0.775341272354126
Epoch: 18, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.245 Vali Acc: 0.525 Test Loss: 1.245 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 19 cost time: 0.7409098148345947
Epoch: 19, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.233 Vali Acc: 0.525 Test Loss: 1.233 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 20 cost time: 0.6516029834747314
Epoch: 20, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.224 Vali Acc: 0.525 Test Loss: 1.224 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 21 cost time: 0.6907191276550293
Epoch: 21, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.216 Vali Acc: 0.525 Test Loss: 1.216 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 22 cost time: 0.7449226379394531
Epoch: 22, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.208 Vali Acc: 0.550 Test Loss: 1.208 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 23 cost time: 0.7631850242614746
Epoch: 23, Steps: 3 | Train Loss: 0.885 Vali Loss: 1.199 Vali Acc: 0.550 Test Loss: 1.199 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 24 cost time: 0.7938668727874756
Epoch: 24, Steps: 3 | Train Loss: 0.742 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 25 cost time: 0.6954295635223389
Epoch: 25, Steps: 3 | Train Loss: 0.805 Vali Loss: 1.181 Vali Acc: 0.575 Test Loss: 1.181 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 26 cost time: 0.8028664588928223
Epoch: 26, Steps: 3 | Train Loss: 0.820 Vali Loss: 1.171 Vali Acc: 0.575 Test Loss: 1.171 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 27 cost time: 0.7743844985961914
Epoch: 27, Steps: 3 | Train Loss: 0.785 Vali Loss: 1.163 Vali Acc: 0.575 Test Loss: 1.163 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 28 cost time: 0.7330865859985352
Epoch: 28, Steps: 3 | Train Loss: 0.686 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8151123523712158
Epoch: 29, Steps: 3 | Train Loss: 0.649 Vali Loss: 1.147 Vali Acc: 0.550 Test Loss: 1.147 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8101294040679932
Epoch: 30, Steps: 3 | Train Loss: 0.674 Vali Loss: 1.140 Vali Acc: 0.550 Test Loss: 1.140 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7500913143157959
Epoch: 31, Steps: 3 | Train Loss: 0.635 Vali Loss: 1.135 Vali Acc: 0.550 Test Loss: 1.135 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6592774391174316
Epoch: 32, Steps: 3 | Train Loss: 0.629 Vali Loss: 1.129 Vali Acc: 0.550 Test Loss: 1.129 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9281015396118164
Epoch: 33, Steps: 3 | Train Loss: 0.523 Vali Loss: 1.123 Vali Acc: 0.575 Test Loss: 1.123 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 34 cost time: 0.7877943515777588
Epoch: 34, Steps: 3 | Train Loss: 0.519 Vali Loss: 1.116 Vali Acc: 0.575 Test Loss: 1.116 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 35 cost time: 0.7793221473693848
Epoch: 35, Steps: 3 | Train Loss: 0.512 Vali Loss: 1.110 Vali Acc: 0.575 Test Loss: 1.110 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 36 cost time: 0.7042219638824463
Epoch: 36, Steps: 3 | Train Loss: 0.534 Vali Loss: 1.103 Vali Acc: 0.575 Test Loss: 1.103 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 37 cost time: 0.8291847705841064
Epoch: 37, Steps: 3 | Train Loss: 0.511 Vali Loss: 1.098 Vali Acc: 0.575 Test Loss: 1.098 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 38 cost time: 0.8042113780975342
Epoch: 38, Steps: 3 | Train Loss: 0.471 Vali Loss: 1.091 Vali Acc: 0.575 Test Loss: 1.091 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 39 cost time: 0.7723758220672607
Epoch: 39, Steps: 3 | Train Loss: 0.420 Vali Loss: 1.087 Vali Acc: 0.575 Test Loss: 1.087 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 40 cost time: 0.8130669593811035
Epoch: 40, Steps: 3 | Train Loss: 0.417 Vali Loss: 1.086 Vali Acc: 0.575 Test Loss: 1.086 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 41 cost time: 0.7015612125396729
Epoch: 41, Steps: 3 | Train Loss: 0.449 Vali Loss: 1.085 Vali Acc: 0.575 Test Loss: 1.085 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 42 cost time: 0.7473044395446777
Epoch: 42, Steps: 3 | Train Loss: 0.382 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 43 cost time: 0.7466974258422852
Epoch: 43, Steps: 3 | Train Loss: 0.355 Vali Loss: 1.079 Vali Acc: 0.675 Test Loss: 1.079 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 44 cost time: 0.7956275939941406
Epoch: 44, Steps: 3 | Train Loss: 0.343 Vali Loss: 1.078 Vali Acc: 0.675 Test Loss: 1.078 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 45 cost time: 0.6977634429931641
Epoch: 45, Steps: 3 | Train Loss: 0.337 Vali Loss: 1.075 Vali Acc: 0.675 Test Loss: 1.075 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 46 cost time: 0.7625951766967773
Epoch: 46, Steps: 3 | Train Loss: 0.255 Vali Loss: 1.070 Vali Acc: 0.675 Test Loss: 1.070 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 47 cost time: 0.7094838619232178
Epoch: 47, Steps: 3 | Train Loss: 0.252 Vali Loss: 1.065 Vali Acc: 0.675 Test Loss: 1.065 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 48 cost time: 0.6520524024963379
Epoch: 48, Steps: 3 | Train Loss: 0.259 Vali Loss: 1.062 Vali Acc: 0.650 Test Loss: 1.062 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6810176372528076
Epoch: 49, Steps: 3 | Train Loss: 0.265 Vali Loss: 1.063 Vali Acc: 0.675 Test Loss: 1.063 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 50 cost time: 0.6898746490478516
Epoch: 50, Steps: 3 | Train Loss: 0.227 Vali Loss: 1.062 Vali Acc: 0.675 Test Loss: 1.062 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 51 cost time: 0.8885717391967773
Epoch: 51, Steps: 3 | Train Loss: 0.208 Vali Loss: 1.062 Vali Acc: 0.675 Test Loss: 1.062 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8751111030578613
Epoch: 52, Steps: 3 | Train Loss: 0.244 Vali Loss: 1.066 Vali Acc: 0.675 Test Loss: 1.066 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7404649257659912
Epoch: 53, Steps: 3 | Train Loss: 0.208 Vali Loss: 1.065 Vali Acc: 0.675 Test Loss: 1.065 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.9488589763641357
Epoch: 54, Steps: 3 | Train Loss: 0.217 Vali Loss: 1.064 Vali Acc: 0.675 Test Loss: 1.064 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.7855925559997559
Epoch: 55, Steps: 3 | Train Loss: 0.191 Vali Loss: 1.061 Vali Acc: 0.675 Test Loss: 1.061 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 56 cost time: 0.7292871475219727
Epoch: 56, Steps: 3 | Train Loss: 0.176 Vali Loss: 1.059 Vali Acc: 0.675 Test Loss: 1.059 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 57 cost time: 0.7556028366088867
Epoch: 57, Steps: 3 | Train Loss: 0.173 Vali Loss: 1.057 Vali Acc: 0.675 Test Loss: 1.057 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 58 cost time: 0.7170743942260742
Epoch: 58, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 59 cost time: 0.7548942565917969
Epoch: 59, Steps: 3 | Train Loss: 0.175 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 60 cost time: 0.672490119934082
Epoch: 60, Steps: 3 | Train Loss: 0.148 Vali Loss: 1.050 Vali Acc: 0.675 Test Loss: 1.050 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 61 cost time: 0.6817946434020996
Epoch: 61, Steps: 3 | Train Loss: 0.145 Vali Loss: 1.049 Vali Acc: 0.675 Test Loss: 1.049 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 62 cost time: 0.6687984466552734
Epoch: 62, Steps: 3 | Train Loss: 0.144 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 63 cost time: 0.7119319438934326
Epoch: 63, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6699907779693604
Epoch: 64, Steps: 3 | Train Loss: 0.129 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.6053760051727295
Epoch: 65, Steps: 3 | Train Loss: 0.105 Vali Loss: 1.053 Vali Acc: 0.675 Test Loss: 1.053 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8274452686309814
Epoch: 66, Steps: 3 | Train Loss: 0.093 Vali Loss: 1.055 Vali Acc: 0.675 Test Loss: 1.055 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.7164247035980225
Epoch: 67, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.055 Vali Acc: 0.675 Test Loss: 1.055 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.7414772510528564
Epoch: 68, Steps: 3 | Train Loss: 0.101 Vali Loss: 1.058 Vali Acc: 0.675 Test Loss: 1.058 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.7247602939605713
Epoch: 69, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.062 Vali Acc: 0.675 Test Loss: 1.062 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.6898202896118164
Epoch: 70, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.065 Vali Acc: 0.675 Test Loss: 1.065 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.7366244792938232
Epoch: 71, Steps: 3 | Train Loss: 0.095 Vali Loss: 1.064 Vali Acc: 0.675 Test Loss: 1.064 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.7744672298431396
Epoch: 72, Steps: 3 | Train Loss: 0.095 Vali Loss: 1.061 Vali Acc: 0.675 Test Loss: 1.061 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 14036
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5464844703674316
Epoch: 1, Steps: 3 | Train Loss: 1.666 Vali Loss: 1.559 Vali Acc: 0.250 Test Loss: 1.559 Test Acc: 0.250
Validation loss decreased (inf --> -0.249984).  Saving model ...
Epoch: 2 cost time: 0.8058381080627441
Epoch: 2, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.553 Vali Acc: 0.250 Test Loss: 1.553 Test Acc: 0.250
Validation loss decreased (-0.249984 --> -0.249984).  Saving model ...
Epoch: 3 cost time: 0.7026185989379883
Epoch: 3, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.551 Vali Acc: 0.275 Test Loss: 1.551 Test Acc: 0.275
Validation loss decreased (-0.249984 --> -0.274984).  Saving model ...
Epoch: 4 cost time: 0.6993458271026611
Epoch: 4, Steps: 3 | Train Loss: 1.548 Vali Loss: 1.549 Vali Acc: 0.325 Test Loss: 1.549 Test Acc: 0.325
Validation loss decreased (-0.274984 --> -0.324985).  Saving model ...
Epoch: 5 cost time: 0.7559695243835449
Epoch: 5, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.543 Vali Acc: 0.325 Test Loss: 1.543 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 6 cost time: 0.8143191337585449
Epoch: 6, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.537 Vali Acc: 0.300 Test Loss: 1.537 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.72940993309021
Epoch: 7, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.529 Vali Acc: 0.325 Test Loss: 1.529 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 8 cost time: 0.8532803058624268
Epoch: 8, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.521 Vali Acc: 0.325 Test Loss: 1.521 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 9 cost time: 0.6489222049713135
Epoch: 9, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.512 Vali Acc: 0.300 Test Loss: 1.512 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7754349708557129
Epoch: 10, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.501 Vali Acc: 0.325 Test Loss: 1.501 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 11 cost time: 0.813892126083374
Epoch: 11, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.490 Vali Acc: 0.325 Test Loss: 1.490 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 12 cost time: 0.7325842380523682
Epoch: 12, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.477 Vali Acc: 0.325 Test Loss: 1.477 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 13 cost time: 0.8707380294799805
Epoch: 13, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.467 Vali Acc: 0.325 Test Loss: 1.467 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 14 cost time: 0.9199492931365967
Epoch: 14, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.456 Vali Acc: 0.350 Test Loss: 1.456 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 15 cost time: 0.8577995300292969
Epoch: 15, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.446 Vali Acc: 0.350 Test Loss: 1.446 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349986).  Saving model ...
Epoch: 16 cost time: 0.8541545867919922
Epoch: 16, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.433 Vali Acc: 0.325 Test Loss: 1.433 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7107536792755127
Epoch: 17, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.423 Vali Acc: 0.325 Test Loss: 1.423 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8195583820343018
Epoch: 18, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.414 Vali Acc: 0.350 Test Loss: 1.414 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 19 cost time: 0.7173752784729004
Epoch: 19, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.405 Vali Acc: 0.375 Test Loss: 1.405 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 20 cost time: 0.9784703254699707
Epoch: 20, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.394 Vali Acc: 0.375 Test Loss: 1.394 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 21 cost time: 0.7991631031036377
Epoch: 21, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.383 Vali Acc: 0.375 Test Loss: 1.383 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 22 cost time: 0.7015883922576904
Epoch: 22, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.373 Vali Acc: 0.375 Test Loss: 1.373 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 23 cost time: 0.7576615810394287
Epoch: 23, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.362 Vali Acc: 0.375 Test Loss: 1.362 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 24 cost time: 1.0292057991027832
Epoch: 24, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 25 cost time: 0.7872178554534912
Epoch: 25, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.341 Vali Acc: 0.400 Test Loss: 1.341 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 26 cost time: 0.7403342723846436
Epoch: 26, Steps: 3 | Train Loss: 0.838 Vali Loss: 1.333 Vali Acc: 0.425 Test Loss: 1.333 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 27 cost time: 0.7058427333831787
Epoch: 27, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.324 Vali Acc: 0.425 Test Loss: 1.324 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 28 cost time: 0.7585484981536865
Epoch: 28, Steps: 3 | Train Loss: 0.803 Vali Loss: 1.314 Vali Acc: 0.425 Test Loss: 1.314 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 29 cost time: 0.7375133037567139
Epoch: 29, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.306 Vali Acc: 0.425 Test Loss: 1.306 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 30 cost time: 0.7479555606842041
Epoch: 30, Steps: 3 | Train Loss: 0.779 Vali Loss: 1.298 Vali Acc: 0.425 Test Loss: 1.298 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 31 cost time: 0.7540056705474854
Epoch: 31, Steps: 3 | Train Loss: 0.660 Vali Loss: 1.288 Vali Acc: 0.425 Test Loss: 1.288 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 32 cost time: 0.7516469955444336
Epoch: 32, Steps: 3 | Train Loss: 0.717 Vali Loss: 1.280 Vali Acc: 0.450 Test Loss: 1.280 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 33 cost time: 0.7905282974243164
Epoch: 33, Steps: 3 | Train Loss: 0.740 Vali Loss: 1.268 Vali Acc: 0.475 Test Loss: 1.268 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 34 cost time: 0.6774213314056396
Epoch: 34, Steps: 3 | Train Loss: 0.640 Vali Loss: 1.261 Vali Acc: 0.475 Test Loss: 1.261 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 35 cost time: 0.7871263027191162
Epoch: 35, Steps: 3 | Train Loss: 0.681 Vali Loss: 1.252 Vali Acc: 0.475 Test Loss: 1.252 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 36 cost time: 0.6364259719848633
Epoch: 36, Steps: 3 | Train Loss: 0.595 Vali Loss: 1.242 Vali Acc: 0.475 Test Loss: 1.242 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 37 cost time: 0.7156670093536377
Epoch: 37, Steps: 3 | Train Loss: 0.567 Vali Loss: 1.237 Vali Acc: 0.475 Test Loss: 1.237 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 38 cost time: 0.659867525100708
Epoch: 38, Steps: 3 | Train Loss: 0.582 Vali Loss: 1.227 Vali Acc: 0.475 Test Loss: 1.227 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 39 cost time: 0.6868174076080322
Epoch: 39, Steps: 3 | Train Loss: 0.572 Vali Loss: 1.221 Vali Acc: 0.475 Test Loss: 1.221 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 40 cost time: 0.6218914985656738
Epoch: 40, Steps: 3 | Train Loss: 0.567 Vali Loss: 1.216 Vali Acc: 0.475 Test Loss: 1.216 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 41 cost time: 0.7071099281311035
Epoch: 41, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.207 Vali Acc: 0.475 Test Loss: 1.207 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 42 cost time: 0.7208607196807861
Epoch: 42, Steps: 3 | Train Loss: 0.503 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 43 cost time: 0.7917373180389404
Epoch: 43, Steps: 3 | Train Loss: 0.472 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 44 cost time: 0.7617876529693604
Epoch: 44, Steps: 3 | Train Loss: 0.429 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 45 cost time: 0.7300009727478027
Epoch: 45, Steps: 3 | Train Loss: 0.467 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 46 cost time: 0.7608184814453125
Epoch: 46, Steps: 3 | Train Loss: 0.396 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 47 cost time: 0.8078157901763916
Epoch: 47, Steps: 3 | Train Loss: 0.415 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 48 cost time: 0.7570631504058838
Epoch: 48, Steps: 3 | Train Loss: 0.355 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 49 cost time: 0.6546845436096191
Epoch: 49, Steps: 3 | Train Loss: 0.347 Vali Loss: 1.163 Vali Acc: 0.525 Test Loss: 1.163 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 50 cost time: 0.7869448661804199
Epoch: 50, Steps: 3 | Train Loss: 0.298 Vali Loss: 1.159 Vali Acc: 0.525 Test Loss: 1.159 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 51 cost time: 0.6793808937072754
Epoch: 51, Steps: 3 | Train Loss: 0.304 Vali Loss: 1.158 Vali Acc: 0.550 Test Loss: 1.158 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 52 cost time: 0.6734185218811035
Epoch: 52, Steps: 3 | Train Loss: 0.321 Vali Loss: 1.149 Vali Acc: 0.550 Test Loss: 1.149 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 53 cost time: 0.6612226963043213
Epoch: 53, Steps: 3 | Train Loss: 0.293 Vali Loss: 1.145 Vali Acc: 0.550 Test Loss: 1.145 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 54 cost time: 0.7121219635009766
Epoch: 54, Steps: 3 | Train Loss: 0.309 Vali Loss: 1.143 Vali Acc: 0.550 Test Loss: 1.143 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 55 cost time: 0.6144483089447021
Epoch: 55, Steps: 3 | Train Loss: 0.284 Vali Loss: 1.142 Vali Acc: 0.550 Test Loss: 1.142 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 56 cost time: 0.7279355525970459
Epoch: 56, Steps: 3 | Train Loss: 0.291 Vali Loss: 1.138 Vali Acc: 0.550 Test Loss: 1.138 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 57 cost time: 0.6485118865966797
Epoch: 57, Steps: 3 | Train Loss: 0.289 Vali Loss: 1.131 Vali Acc: 0.575 Test Loss: 1.131 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 58 cost time: 0.7965033054351807
Epoch: 58, Steps: 3 | Train Loss: 0.260 Vali Loss: 1.122 Vali Acc: 0.575 Test Loss: 1.122 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 59 cost time: 0.7032091617584229
Epoch: 59, Steps: 3 | Train Loss: 0.222 Vali Loss: 1.113 Vali Acc: 0.600 Test Loss: 1.113 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 60 cost time: 0.7317845821380615
Epoch: 60, Steps: 3 | Train Loss: 0.240 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 61 cost time: 0.6081383228302002
Epoch: 61, Steps: 3 | Train Loss: 0.219 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 62 cost time: 0.8476243019104004
Epoch: 62, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.096 Vali Acc: 0.650 Test Loss: 1.096 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 63 cost time: 0.7329986095428467
Epoch: 63, Steps: 3 | Train Loss: 0.209 Vali Loss: 1.091 Vali Acc: 0.650 Test Loss: 1.091 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 64 cost time: 0.7179489135742188
Epoch: 64, Steps: 3 | Train Loss: 0.204 Vali Loss: 1.087 Vali Acc: 0.675 Test Loss: 1.087 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 65 cost time: 0.7374227046966553
Epoch: 65, Steps: 3 | Train Loss: 0.192 Vali Loss: 1.085 Vali Acc: 0.675 Test Loss: 1.085 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 66 cost time: 0.7027816772460938
Epoch: 66, Steps: 3 | Train Loss: 0.175 Vali Loss: 1.079 Vali Acc: 0.675 Test Loss: 1.079 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 67 cost time: 0.7290680408477783
Epoch: 67, Steps: 3 | Train Loss: 0.174 Vali Loss: 1.078 Vali Acc: 0.675 Test Loss: 1.078 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 68 cost time: 0.7903602123260498
Epoch: 68, Steps: 3 | Train Loss: 0.141 Vali Loss: 1.078 Vali Acc: 0.675 Test Loss: 1.078 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 69 cost time: 0.7228572368621826
Epoch: 69, Steps: 3 | Train Loss: 0.127 Vali Loss: 1.074 Vali Acc: 0.675 Test Loss: 1.074 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 70 cost time: 0.7911384105682373
Epoch: 70, Steps: 3 | Train Loss: 0.169 Vali Loss: 1.072 Vali Acc: 0.675 Test Loss: 1.072 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 71 cost time: 0.7835893630981445
Epoch: 71, Steps: 3 | Train Loss: 0.152 Vali Loss: 1.071 Vali Acc: 0.675 Test Loss: 1.071 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 72 cost time: 0.7652668952941895
Epoch: 72, Steps: 3 | Train Loss: 0.150 Vali Loss: 1.067 Vali Acc: 0.675 Test Loss: 1.067 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 73 cost time: 0.7645912170410156
Epoch: 73, Steps: 3 | Train Loss: 0.120 Vali Loss: 1.068 Vali Acc: 0.675 Test Loss: 1.068 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7398366928100586
Epoch: 74, Steps: 3 | Train Loss: 0.121 Vali Loss: 1.062 Vali Acc: 0.675 Test Loss: 1.062 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 75 cost time: 0.7217943668365479
Epoch: 75, Steps: 3 | Train Loss: 0.132 Vali Loss: 1.056 Vali Acc: 0.675 Test Loss: 1.056 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 76 cost time: 0.7929646968841553
Epoch: 76, Steps: 3 | Train Loss: 0.108 Vali Loss: 1.048 Vali Acc: 0.675 Test Loss: 1.048 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 77 cost time: 0.7867419719696045
Epoch: 77, Steps: 3 | Train Loss: 0.118 Vali Loss: 1.045 Vali Acc: 0.700 Test Loss: 1.045 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 78 cost time: 0.7421817779541016
Epoch: 78, Steps: 3 | Train Loss: 0.094 Vali Loss: 1.043 Vali Acc: 0.700 Test Loss: 1.043 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 79 cost time: 0.727337121963501
Epoch: 79, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.040 Vali Acc: 0.700 Test Loss: 1.040 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 80 cost time: 0.8038876056671143
Epoch: 80, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.039 Vali Acc: 0.700 Test Loss: 1.039 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 81 cost time: 0.7548015117645264
Epoch: 81, Steps: 3 | Train Loss: 0.105 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 82 cost time: 0.6897919178009033
Epoch: 82, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.029 Vali Acc: 0.700 Test Loss: 1.029 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 83 cost time: 0.6375203132629395
Epoch: 83, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.021 Vali Acc: 0.700 Test Loss: 1.021 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 84 cost time: 0.6629090309143066
Epoch: 84, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.018 Vali Acc: 0.700 Test Loss: 1.018 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 85 cost time: 0.6281416416168213
Epoch: 85, Steps: 3 | Train Loss: 0.083 Vali Loss: 1.016 Vali Acc: 0.700 Test Loss: 1.016 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 86 cost time: 0.8359525203704834
Epoch: 86, Steps: 3 | Train Loss: 0.083 Vali Loss: 1.011 Vali Acc: 0.700 Test Loss: 1.011 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 87 cost time: 0.7813806533813477
Epoch: 87, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.005 Vali Acc: 0.700 Test Loss: 1.005 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 88 cost time: 0.6636128425598145
Epoch: 88, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.998 Vali Acc: 0.700 Test Loss: 0.998 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 89 cost time: 0.6319987773895264
Epoch: 89, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 90 cost time: 0.6480181217193604
Epoch: 90, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.992 Vali Acc: 0.700 Test Loss: 0.992 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 91 cost time: 0.690781831741333
Epoch: 91, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.987 Vali Acc: 0.700 Test Loss: 0.987 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 92 cost time: 0.7864959239959717
Epoch: 92, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.980 Vali Acc: 0.700 Test Loss: 0.980 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 93 cost time: 0.7257776260375977
Epoch: 93, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.972 Vali Acc: 0.700 Test Loss: 0.972 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 94 cost time: 0.7060501575469971
Epoch: 94, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.970 Vali Acc: 0.700 Test Loss: 0.970 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 95 cost time: 0.7141034603118896
Epoch: 95, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 96 cost time: 0.6828663349151611
Epoch: 96, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.970 Vali Acc: 0.700 Test Loss: 0.970 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.7297613620758057
Epoch: 97, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.971 Vali Acc: 0.700 Test Loss: 0.971 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.8687293529510498
Epoch: 98, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.972 Vali Acc: 0.700 Test Loss: 0.972 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.6808841228485107
Epoch: 99, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.970 Vali Acc: 0.700 Test Loss: 0.970 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.7907922267913818
Epoch: 100, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.971 Vali Acc: 0.700 Test Loss: 0.971 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el3_dm16_nh4_df64_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 12964
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.345722198486328
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.447 Vali Acc: 0.275 Test Loss: 1.447 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6988542079925537
Epoch: 2, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.380 Vali Acc: 0.300 Test Loss: 1.380 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.6893787384033203
Epoch: 3, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.303 Vali Acc: 0.300 Test Loss: 1.303 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.7645232677459717
Epoch: 4, Steps: 3 | Train Loss: 0.847 Vali Loss: 1.152 Vali Acc: 0.475 Test Loss: 1.152 Test Acc: 0.475
Validation loss decreased (-0.299987 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 0.8185482025146484
Epoch: 5, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.980 Vali Acc: 0.625 Test Loss: 0.980 Test Acc: 0.625
Validation loss decreased (-0.474988 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 0.6449980735778809
Epoch: 6, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.942 Vali Acc: 0.600 Test Loss: 0.942 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7672414779663086
Epoch: 7, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.906 Vali Acc: 0.600 Test Loss: 0.906 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9400749206542969
Epoch: 8, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.850 Vali Acc: 0.725 Test Loss: 0.850 Test Acc: 0.725
Validation loss decreased (-0.624990 --> -0.724992).  Saving model ...
Epoch: 9 cost time: 0.6998343467712402
Epoch: 9, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
Validation loss decreased (-0.724992 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.7035171985626221
Epoch: 10, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 0.6809344291687012
Epoch: 11, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.806 Vali Acc: 0.800 Test Loss: 0.806 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7249667644500732
Epoch: 12, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.846 Vali Acc: 0.775 Test Loss: 0.846 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8835103511810303
Epoch: 13, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.881 Vali Acc: 0.750 Test Loss: 0.881 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7750463485717773
Epoch: 14, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.751279354095459
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.925 Vali Acc: 0.775 Test Loss: 0.925 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7773106098175049
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.939 Vali Acc: 0.775 Test Loss: 0.939 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0044541358947754
Epoch: 17, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.949 Vali Acc: 0.775 Test Loss: 0.949 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.789689302444458
Epoch: 18, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.956 Vali Acc: 0.775 Test Loss: 0.956 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7071700096130371
Epoch: 19, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.775 Test Loss: 0.959 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7773675918579102
Epoch: 20, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.775 Test Loss: 0.959 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 419204
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.252826452255249
Epoch: 1, Steps: 3 | Train Loss: 1.695 Vali Loss: 1.540 Vali Acc: 0.150 Test Loss: 1.540 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 0.7063360214233398
Epoch: 2, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.466 Vali Acc: 0.200 Test Loss: 1.466 Test Acc: 0.200
Validation loss decreased (-0.149985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.6891748905181885
Epoch: 3, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.346 Vali Acc: 0.325 Test Loss: 1.346 Test Acc: 0.325
Validation loss decreased (-0.199985 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.6737275123596191
Epoch: 4, Steps: 3 | Train Loss: 0.950 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
Validation loss decreased (-0.324987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.6909036636352539
Epoch: 5, Steps: 3 | Train Loss: 0.723 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.6510486602783203
Epoch: 6, Steps: 3 | Train Loss: 0.562 Vali Loss: 1.156 Vali Acc: 0.550 Test Loss: 1.156 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.6774530410766602
Epoch: 7, Steps: 3 | Train Loss: 0.348 Vali Loss: 1.081 Vali Acc: 0.550 Test Loss: 1.081 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.731900691986084
Epoch: 8, Steps: 3 | Train Loss: 0.273 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.7176451683044434
Epoch: 9, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.936 Vali Acc: 0.675 Test Loss: 0.936 Test Acc: 0.675
Validation loss decreased (-0.599990 --> -0.674991).  Saving model ...
Epoch: 10 cost time: 0.6934628486633301
Epoch: 10, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.895 Vali Acc: 0.675 Test Loss: 0.895 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 11 cost time: 0.7572383880615234
Epoch: 11, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.900 Vali Acc: 0.700 Test Loss: 0.900 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 0.6540117263793945
Epoch: 12, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.926 Vali Acc: 0.725 Test Loss: 0.926 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.7378826141357422
Epoch: 13, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.950 Vali Acc: 0.725 Test Loss: 0.950 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7304458618164062
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.968 Vali Acc: 0.700 Test Loss: 0.968 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6595370769500732
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.974 Vali Acc: 0.700 Test Loss: 0.974 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7518539428710938
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.975 Vali Acc: 0.725 Test Loss: 0.975 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6192705631256104
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.977 Vali Acc: 0.725 Test Loss: 0.977 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6181230545043945
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.980 Vali Acc: 0.725 Test Loss: 0.980 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6941025257110596
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.982 Vali Acc: 0.725 Test Loss: 0.982 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8144741058349609
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.725 Test Loss: 0.984 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7158751487731934
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.986 Vali Acc: 0.725 Test Loss: 0.986 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6973485946655273
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749990).  Saving model ...
Epoch: 23 cost time: 0.6589014530181885
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.988 Vali Acc: 0.750 Test Loss: 0.988 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.575751781463623
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.725 Test Loss: 0.990 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6948940753936768
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.992 Vali Acc: 0.725 Test Loss: 0.992 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7244882583618164
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.993 Vali Acc: 0.725 Test Loss: 0.993 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7813639640808105
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.725 Test Loss: 0.995 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7438945770263672
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.998 Vali Acc: 0.725 Test Loss: 0.998 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7220838069915771
Epoch: 29, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.725 Test Loss: 1.000 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8400142192840576
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.725 Test Loss: 1.001 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6659512519836426
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.725 Test Loss: 1.003 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.690305233001709
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.004 Vali Acc: 0.725 Test Loss: 1.004 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 367236
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2419705390930176
Epoch: 1, Steps: 3 | Train Loss: 1.698 Vali Loss: 1.379 Vali Acc: 0.225 Test Loss: 1.379 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.7069225311279297
Epoch: 2, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.351 Vali Acc: 0.350 Test Loss: 1.351 Test Acc: 0.350
Validation loss decreased (-0.224986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.6573190689086914
Epoch: 3, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.294 Vali Acc: 0.475 Test Loss: 1.294 Test Acc: 0.475
Validation loss decreased (-0.349986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.7194256782531738
Epoch: 4, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.7069642543792725
Epoch: 5, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.185 Vali Acc: 0.475 Test Loss: 1.185 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8202314376831055
Epoch: 6, Steps: 3 | Train Loss: 0.707 Vali Loss: 1.117 Vali Acc: 0.525 Test Loss: 1.117 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 0.7121682167053223
Epoch: 7, Steps: 3 | Train Loss: 0.602 Vali Loss: 1.024 Vali Acc: 0.650 Test Loss: 1.024 Test Acc: 0.650
Validation loss decreased (-0.524989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.6633999347686768
Epoch: 8, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.957 Vali Acc: 0.675 Test Loss: 0.957 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 0.7877347469329834
Epoch: 9, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.924 Vali Acc: 0.725 Test Loss: 0.924 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 10 cost time: 0.7713282108306885
Epoch: 10, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.922 Vali Acc: 0.700 Test Loss: 0.922 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7834556102752686
Epoch: 11, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.946 Vali Acc: 0.700 Test Loss: 0.946 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6981549263000488
Epoch: 12, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.981 Vali Acc: 0.675 Test Loss: 0.981 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7751786708831787
Epoch: 13, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.014 Vali Acc: 0.675 Test Loss: 1.014 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6519613265991211
Epoch: 14, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6177546977996826
Epoch: 15, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.089 Vali Acc: 0.675 Test Loss: 1.089 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6852543354034424
Epoch: 16, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.109 Vali Acc: 0.675 Test Loss: 1.109 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6691360473632812
Epoch: 17, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.120 Vali Acc: 0.675 Test Loss: 1.120 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8463060855865479
Epoch: 18, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.127 Vali Acc: 0.675 Test Loss: 1.127 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7702412605285645
Epoch: 19, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.133 Vali Acc: 0.675 Test Loss: 1.133 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 343044
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4839224815368652
Epoch: 1, Steps: 3 | Train Loss: 1.593 Vali Loss: 1.552 Vali Acc: 0.175 Test Loss: 1.552 Test Acc: 0.175
Validation loss decreased (inf --> -0.174984).  Saving model ...
Epoch: 2 cost time: 0.7591180801391602
Epoch: 2, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.492 Vali Acc: 0.250 Test Loss: 1.492 Test Acc: 0.250
Validation loss decreased (-0.174984 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.784066915512085
Epoch: 3, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.414 Vali Acc: 0.375 Test Loss: 1.414 Test Acc: 0.375
Validation loss decreased (-0.249985 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.7543206214904785
Epoch: 4, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.334 Vali Acc: 0.475 Test Loss: 1.334 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.7746748924255371
Epoch: 5, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.249 Vali Acc: 0.525 Test Loss: 1.249 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.6143465042114258
Epoch: 6, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.174 Vali Acc: 0.600 Test Loss: 1.174 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.7522153854370117
Epoch: 7, Steps: 3 | Train Loss: 0.562 Vali Loss: 1.102 Vali Acc: 0.600 Test Loss: 1.102 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.664156436920166
Epoch: 8, Steps: 3 | Train Loss: 0.407 Vali Loss: 1.056 Vali Acc: 0.650 Test Loss: 1.056 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.6633377075195312
Epoch: 9, Steps: 3 | Train Loss: 0.279 Vali Loss: 1.039 Vali Acc: 0.650 Test Loss: 1.039 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.7686996459960938
Epoch: 10, Steps: 3 | Train Loss: 0.268 Vali Loss: 1.030 Vali Acc: 0.625 Test Loss: 1.030 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8091692924499512
Epoch: 11, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.023 Vali Acc: 0.625 Test Loss: 1.023 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7329192161560059
Epoch: 12, Steps: 3 | Train Loss: 0.101 Vali Loss: 1.018 Vali Acc: 0.650 Test Loss: 1.018 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 0.6788618564605713
Epoch: 13, Steps: 3 | Train Loss: 0.055 Vali Loss: 1.019 Vali Acc: 0.675 Test Loss: 1.019 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 14 cost time: 0.6829447746276855
Epoch: 14, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.038 Vali Acc: 0.675 Test Loss: 1.038 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7896537780761719
Epoch: 15, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.044 Vali Acc: 0.725 Test Loss: 1.044 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 16 cost time: 0.7147555351257324
Epoch: 16, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6764767169952393
Epoch: 17, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.058 Vali Acc: 0.700 Test Loss: 1.058 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7835063934326172
Epoch: 18, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.066 Vali Acc: 0.700 Test Loss: 1.066 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7318606376647949
Epoch: 19, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.077 Vali Acc: 0.700 Test Loss: 1.077 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.724945068359375
Epoch: 20, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.082 Vali Acc: 0.700 Test Loss: 1.082 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6088466644287109
Epoch: 21, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.084 Vali Acc: 0.700 Test Loss: 1.084 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6368904113769531
Epoch: 22, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.089 Vali Acc: 0.700 Test Loss: 1.089 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6379437446594238
Epoch: 23, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.092 Vali Acc: 0.700 Test Loss: 1.092 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6851539611816406
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.095 Vali Acc: 0.700 Test Loss: 1.095 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.713402271270752
Epoch: 25, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.095 Vali Acc: 0.725 Test Loss: 1.095 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 327940
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5459022521972656
Epoch: 1, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.570 Vali Acc: 0.275 Test Loss: 1.570 Test Acc: 0.275
Validation loss decreased (inf --> -0.274984).  Saving model ...
Epoch: 2 cost time: 0.7402551174163818
Epoch: 2, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.551 Vali Acc: 0.275 Test Loss: 1.551 Test Acc: 0.275
Validation loss decreased (-0.274984 --> -0.274984).  Saving model ...
Epoch: 3 cost time: 0.6698408126831055
Epoch: 3, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.516 Vali Acc: 0.350 Test Loss: 1.516 Test Acc: 0.350
Validation loss decreased (-0.274984 --> -0.349985).  Saving model ...
Epoch: 4 cost time: 0.7731306552886963
Epoch: 4, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.475 Vali Acc: 0.375 Test Loss: 1.475 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374985).  Saving model ...
Epoch: 5 cost time: 0.6642825603485107
Epoch: 5, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.434 Vali Acc: 0.400 Test Loss: 1.434 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.7206611633300781
Epoch: 6, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.395 Vali Acc: 0.450 Test Loss: 1.395 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 7 cost time: 0.6952638626098633
Epoch: 7, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.363 Vali Acc: 0.450 Test Loss: 1.363 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 8 cost time: 0.6971805095672607
Epoch: 8, Steps: 3 | Train Loss: 0.601 Vali Loss: 1.352 Vali Acc: 0.450 Test Loss: 1.352 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 9 cost time: 0.7317724227905273
Epoch: 9, Steps: 3 | Train Loss: 0.479 Vali Loss: 1.344 Vali Acc: 0.575 Test Loss: 1.344 Test Acc: 0.575
Validation loss decreased (-0.449986 --> -0.574987).  Saving model ...
Epoch: 10 cost time: 0.6870589256286621
Epoch: 10, Steps: 3 | Train Loss: 0.417 Vali Loss: 1.322 Vali Acc: 0.575 Test Loss: 1.322 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 11 cost time: 0.7340116500854492
Epoch: 11, Steps: 3 | Train Loss: 0.296 Vali Loss: 1.314 Vali Acc: 0.600 Test Loss: 1.314 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 0.8161640167236328
Epoch: 12, Steps: 3 | Train Loss: 0.214 Vali Loss: 1.315 Vali Acc: 0.600 Test Loss: 1.315 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8296055793762207
Epoch: 13, Steps: 3 | Train Loss: 0.159 Vali Loss: 1.329 Vali Acc: 0.600 Test Loss: 1.329 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6797235012054443
Epoch: 14, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.352 Vali Acc: 0.575 Test Loss: 1.352 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7286028861999512
Epoch: 15, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.387 Vali Acc: 0.575 Test Loss: 1.387 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7559893131256104
Epoch: 16, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.413 Vali Acc: 0.575 Test Loss: 1.413 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8170175552368164
Epoch: 17, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.420 Vali Acc: 0.575 Test Loss: 1.420 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.753788948059082
Epoch: 18, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.427 Vali Acc: 0.575 Test Loss: 1.427 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8720440864562988
Epoch: 19, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.427 Vali Acc: 0.600 Test Loss: 1.427 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7022221088409424
Epoch: 20, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.423 Vali Acc: 0.625 Test Loss: 1.423 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624986).  Saving model ...
Epoch: 21 cost time: 0.7763886451721191
Epoch: 21, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.421 Vali Acc: 0.625 Test Loss: 1.421 Test Acc: 0.625
Validation loss decreased (-0.624986 --> -0.624986).  Saving model ...
Epoch: 22 cost time: 0.7199313640594482
Epoch: 22, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.422 Vali Acc: 0.625 Test Loss: 1.422 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7490055561065674
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.425 Vali Acc: 0.625 Test Loss: 1.425 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8312840461730957
Epoch: 24, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.428 Vali Acc: 0.650 Test Loss: 1.428 Test Acc: 0.650
Validation loss decreased (-0.624986 --> -0.649986).  Saving model ...
Epoch: 25 cost time: 0.7042975425720215
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.434 Vali Acc: 0.675 Test Loss: 1.434 Test Acc: 0.675
Validation loss decreased (-0.649986 --> -0.674986).  Saving model ...
Epoch: 26 cost time: 0.7731921672821045
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.439 Vali Acc: 0.675 Test Loss: 1.439 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7795953750610352
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.447 Vali Acc: 0.675 Test Loss: 1.447 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8791391849517822
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.453 Vali Acc: 0.675 Test Loss: 1.453 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8881673812866211
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.460 Vali Acc: 0.675 Test Loss: 1.460 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7950799465179443
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.466 Vali Acc: 0.675 Test Loss: 1.466 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8857285976409912
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.476 Vali Acc: 0.675 Test Loss: 1.476 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8043243885040283
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.483 Vali Acc: 0.675 Test Loss: 1.483 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7750265598297119
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.487 Vali Acc: 0.675 Test Loss: 1.487 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9270291328430176
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.492 Vali Acc: 0.675 Test Loss: 1.492 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7335503101348877
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.497 Vali Acc: 0.675 Test Loss: 1.497 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 304004
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.301243782043457
Epoch: 1, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.579 Vali Acc: 0.275 Test Loss: 1.579 Test Acc: 0.275
Validation loss decreased (inf --> -0.274984).  Saving model ...
Epoch: 2 cost time: 0.6713590621948242
Epoch: 2, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.530 Vali Acc: 0.350 Test Loss: 1.530 Test Acc: 0.350
Validation loss decreased (-0.274984 --> -0.349985).  Saving model ...
Epoch: 3 cost time: 0.582859992980957
Epoch: 3, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.480 Vali Acc: 0.350 Test Loss: 1.480 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 4 cost time: 0.6872220039367676
Epoch: 4, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.419 Vali Acc: 0.400 Test Loss: 1.419 Test Acc: 0.400
Validation loss decreased (-0.349985 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.7277922630310059
Epoch: 5, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.360 Vali Acc: 0.400 Test Loss: 1.360 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.6324012279510498
Epoch: 6, Steps: 3 | Train Loss: 0.968 Vali Loss: 1.309 Vali Acc: 0.425 Test Loss: 1.309 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.6465780735015869
Epoch: 7, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.267 Vali Acc: 0.450 Test Loss: 1.267 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.5461745262145996
Epoch: 8, Steps: 3 | Train Loss: 0.634 Vali Loss: 1.230 Vali Acc: 0.450 Test Loss: 1.230 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 0.605963945388794
Epoch: 9, Steps: 3 | Train Loss: 0.546 Vali Loss: 1.201 Vali Acc: 0.475 Test Loss: 1.201 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 0.6051268577575684
Epoch: 10, Steps: 3 | Train Loss: 0.474 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.5944664478302002
Epoch: 11, Steps: 3 | Train Loss: 0.359 Vali Loss: 1.162 Vali Acc: 0.550 Test Loss: 1.162 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.651679277420044
Epoch: 12, Steps: 3 | Train Loss: 0.360 Vali Loss: 1.148 Vali Acc: 0.550 Test Loss: 1.148 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 13 cost time: 0.5531842708587646
Epoch: 13, Steps: 3 | Train Loss: 0.219 Vali Loss: 1.144 Vali Acc: 0.575 Test Loss: 1.144 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 14 cost time: 0.7403030395507812
Epoch: 14, Steps: 3 | Train Loss: 0.208 Vali Loss: 1.151 Vali Acc: 0.600 Test Loss: 1.151 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599988).  Saving model ...
Epoch: 15 cost time: 0.5691604614257812
Epoch: 15, Steps: 3 | Train Loss: 0.163 Vali Loss: 1.165 Vali Acc: 0.600 Test Loss: 1.165 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7649915218353271
Epoch: 16, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.190 Vali Acc: 0.600 Test Loss: 1.190 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6740987300872803
Epoch: 17, Steps: 3 | Train Loss: 0.076 Vali Loss: 1.215 Vali Acc: 0.625 Test Loss: 1.215 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 18 cost time: 0.7155964374542236
Epoch: 18, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.237 Vali Acc: 0.625 Test Loss: 1.237 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7261710166931152
Epoch: 19, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.245 Vali Acc: 0.675 Test Loss: 1.245 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 20 cost time: 0.6782643795013428
Epoch: 20, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.255 Vali Acc: 0.675 Test Loss: 1.255 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6995635032653809
Epoch: 21, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.263 Vali Acc: 0.700 Test Loss: 1.263 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699987).  Saving model ...
Epoch: 22 cost time: 0.7649445533752441
Epoch: 22, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.268 Vali Acc: 0.700 Test Loss: 1.268 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7068922519683838
Epoch: 23, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.270 Vali Acc: 0.700 Test Loss: 1.270 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7690300941467285
Epoch: 24, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.269 Vali Acc: 0.675 Test Loss: 1.269 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6442523002624512
Epoch: 25, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.267 Vali Acc: 0.675 Test Loss: 1.267 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5996649265289307
Epoch: 26, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.266 Vali Acc: 0.675 Test Loss: 1.266 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6862838268280029
Epoch: 27, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.266 Vali Acc: 0.675 Test Loss: 1.266 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7215149402618408
Epoch: 28, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.265 Vali Acc: 0.675 Test Loss: 1.265 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7507772445678711
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.263 Vali Acc: 0.675 Test Loss: 1.263 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6736469268798828
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.263 Vali Acc: 0.675 Test Loss: 1.263 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6100780963897705
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.265 Vali Acc: 0.675 Test Loss: 1.265 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 298500
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6953699588775635
Epoch: 1, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.410 Vali Acc: 0.375 Test Loss: 1.410 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.6869223117828369
Epoch: 2, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.384 Vali Acc: 0.450 Test Loss: 1.384 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 0.7837140560150146
Epoch: 3, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 0.6743602752685547
Epoch: 4, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.609173059463501
Epoch: 5, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.275 Vali Acc: 0.525 Test Loss: 1.275 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.577399492263794
Epoch: 6, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.239 Vali Acc: 0.550 Test Loss: 1.239 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.6071634292602539
Epoch: 7, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.205 Vali Acc: 0.550 Test Loss: 1.205 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.6714591979980469
Epoch: 8, Steps: 3 | Train Loss: 0.807 Vali Loss: 1.177 Vali Acc: 0.525 Test Loss: 1.177 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6232337951660156
Epoch: 9, Steps: 3 | Train Loss: 0.666 Vali Loss: 1.152 Vali Acc: 0.525 Test Loss: 1.152 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6155197620391846
Epoch: 10, Steps: 3 | Train Loss: 0.570 Vali Loss: 1.131 Vali Acc: 0.525 Test Loss: 1.131 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.755124568939209
Epoch: 11, Steps: 3 | Train Loss: 0.481 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7327671051025391
Epoch: 12, Steps: 3 | Train Loss: 0.429 Vali Loss: 1.085 Vali Acc: 0.575 Test Loss: 1.085 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.6650428771972656
Epoch: 13, Steps: 3 | Train Loss: 0.444 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.7104790210723877
Epoch: 14, Steps: 3 | Train Loss: 0.303 Vali Loss: 1.044 Vali Acc: 0.625 Test Loss: 1.044 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 15 cost time: 0.6565477848052979
Epoch: 15, Steps: 3 | Train Loss: 0.236 Vali Loss: 1.026 Vali Acc: 0.625 Test Loss: 1.026 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 16 cost time: 0.7302215099334717
Epoch: 16, Steps: 3 | Train Loss: 0.190 Vali Loss: 1.021 Vali Acc: 0.625 Test Loss: 1.021 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 17 cost time: 0.7201921939849854
Epoch: 17, Steps: 3 | Train Loss: 0.145 Vali Loss: 1.020 Vali Acc: 0.625 Test Loss: 1.020 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 0.6755220890045166
Epoch: 18, Steps: 3 | Train Loss: 0.106 Vali Loss: 1.034 Vali Acc: 0.625 Test Loss: 1.034 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7009239196777344
Epoch: 19, Steps: 3 | Train Loss: 0.093 Vali Loss: 1.053 Vali Acc: 0.625 Test Loss: 1.053 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7480719089508057
Epoch: 20, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.062 Vali Acc: 0.675 Test Loss: 1.062 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674989).  Saving model ...
Epoch: 21 cost time: 0.6239039897918701
Epoch: 21, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.065 Vali Acc: 0.675 Test Loss: 1.065 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6732969284057617
Epoch: 22, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.071 Vali Acc: 0.700 Test Loss: 1.071 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 23 cost time: 0.6433501243591309
Epoch: 23, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.084 Vali Acc: 0.675 Test Loss: 1.084 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7960479259490967
Epoch: 24, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.088 Vali Acc: 0.675 Test Loss: 1.088 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.651080846786499
Epoch: 25, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.094 Vali Acc: 0.675 Test Loss: 1.094 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6887876987457275
Epoch: 26, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.099 Vali Acc: 0.675 Test Loss: 1.099 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6257319450378418
Epoch: 27, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.100 Vali Acc: 0.675 Test Loss: 1.100 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6561267375946045
Epoch: 28, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.101 Vali Acc: 0.675 Test Loss: 1.101 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6069691181182861
Epoch: 29, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.098 Vali Acc: 0.675 Test Loss: 1.098 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7235326766967773
Epoch: 30, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.101 Vali Acc: 0.675 Test Loss: 1.101 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7707104682922363
Epoch: 31, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.100 Vali Acc: 0.675 Test Loss: 1.100 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.662726879119873
Epoch: 32, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.100 Vali Acc: 0.675 Test Loss: 1.100 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df256_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 289924
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4032533168792725
Epoch: 1, Steps: 3 | Train Loss: 1.561 Vali Loss: 1.339 Vali Acc: 0.350 Test Loss: 1.339 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.6739258766174316
Epoch: 2, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.279 Vali Acc: 0.425 Test Loss: 1.279 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.7688031196594238
Epoch: 3, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.196 Vali Acc: 0.550 Test Loss: 1.196 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 0.6268191337585449
Epoch: 4, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.072 Vali Acc: 0.625 Test Loss: 1.072 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.6390953063964844
Epoch: 5, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.949 Vali Acc: 0.575 Test Loss: 0.949 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5757894515991211
Epoch: 6, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.894 Vali Acc: 0.625 Test Loss: 0.894 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624991).  Saving model ...
Epoch: 7 cost time: 0.7282471656799316
Epoch: 7, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
Validation loss decreased (-0.624991 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 0.7120919227600098
Epoch: 8, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.823 Vali Acc: 0.725 Test Loss: 0.823 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7339818477630615
Epoch: 9, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.773 Vali Acc: 0.750 Test Loss: 0.773 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 0.6016335487365723
Epoch: 10, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.760 Vali Acc: 0.825 Test Loss: 0.760 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824992).  Saving model ...
Epoch: 11 cost time: 0.6925218105316162
Epoch: 11, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.783 Vali Acc: 0.825 Test Loss: 0.783 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8069767951965332
Epoch: 12, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.813 Vali Acc: 0.800 Test Loss: 0.813 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8778600692749023
Epoch: 13, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.845 Vali Acc: 0.800 Test Loss: 0.845 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.910778284072876
Epoch: 14, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.873 Vali Acc: 0.800 Test Loss: 0.873 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8257179260253906
Epoch: 15, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.896 Vali Acc: 0.800 Test Loss: 0.896 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8140444755554199
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.800 Test Loss: 0.915 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7574417591094971
Epoch: 17, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.932 Vali Acc: 0.800 Test Loss: 0.932 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9286220073699951
Epoch: 18, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.800 Test Loss: 0.943 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7764577865600586
Epoch: 19, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.800 Test Loss: 0.951 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8050532341003418
Epoch: 20, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.800 Test Loss: 0.957 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 353412
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5433106422424316
Epoch: 1, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.423 Vali Acc: 0.375 Test Loss: 1.423 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.7778756618499756
Epoch: 2, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.365 Vali Acc: 0.375 Test Loss: 1.365 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.7032740116119385
Epoch: 3, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.7669978141784668
Epoch: 4, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.7452936172485352
Epoch: 5, Steps: 3 | Train Loss: 0.732 Vali Loss: 1.122 Vali Acc: 0.525 Test Loss: 1.122 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 6 cost time: 0.7011828422546387
Epoch: 6, Steps: 3 | Train Loss: 0.445 Vali Loss: 1.031 Vali Acc: 0.575 Test Loss: 1.031 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574990).  Saving model ...
Epoch: 7 cost time: 0.7582392692565918
Epoch: 7, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.7449696063995361
Epoch: 8, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.951 Vali Acc: 0.725 Test Loss: 0.951 Test Acc: 0.725
Validation loss decreased (-0.599990 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 0.7431907653808594
Epoch: 9, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.909 Vali Acc: 0.700 Test Loss: 0.909 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8144152164459229
Epoch: 10, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.902 Vali Acc: 0.725 Test Loss: 0.902 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 11 cost time: 0.7215051651000977
Epoch: 11, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.930 Vali Acc: 0.700 Test Loss: 0.930 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.764906644821167
Epoch: 12, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.931 Vali Acc: 0.725 Test Loss: 0.931 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7699804306030273
Epoch: 13, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.944 Vali Acc: 0.725 Test Loss: 0.944 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8250155448913574
Epoch: 14, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.957 Vali Acc: 0.725 Test Loss: 0.957 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8499166965484619
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.985 Vali Acc: 0.700 Test Loss: 0.985 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8198003768920898
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.006 Vali Acc: 0.700 Test Loss: 1.006 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8246934413909912
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.011 Vali Acc: 0.725 Test Loss: 1.011 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8559465408325195
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.013 Vali Acc: 0.725 Test Loss: 1.013 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.806666374206543
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.007 Vali Acc: 0.725 Test Loss: 1.007 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7902445793151855
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.725 Test Loss: 1.002 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 301444
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.128157377243042
Epoch: 1, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.316 Vali Acc: 0.350 Test Loss: 1.316 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.8247249126434326
Epoch: 2, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.297 Vali Acc: 0.375 Test Loss: 1.297 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.7049152851104736
Epoch: 3, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.256 Vali Acc: 0.450 Test Loss: 1.256 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.9090559482574463
Epoch: 4, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.7832036018371582
Epoch: 5, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.151 Vali Acc: 0.600 Test Loss: 1.151 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.6781735420227051
Epoch: 6, Steps: 3 | Train Loss: 0.690 Vali Loss: 1.101 Vali Acc: 0.600 Test Loss: 1.101 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.9279215335845947
Epoch: 7, Steps: 3 | Train Loss: 0.623 Vali Loss: 1.049 Vali Acc: 0.650 Test Loss: 1.049 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.804671049118042
Epoch: 8, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.990 Vali Acc: 0.675 Test Loss: 0.990 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 0.8204071521759033
Epoch: 9, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.997 Vali Acc: 0.650 Test Loss: 0.997 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8295707702636719
Epoch: 10, Steps: 3 | Train Loss: 0.207 Vali Loss: 1.009 Vali Acc: 0.625 Test Loss: 1.009 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8012597560882568
Epoch: 11, Steps: 3 | Train Loss: 0.118 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8234257698059082
Epoch: 12, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.029 Vali Acc: 0.625 Test Loss: 1.029 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.77718186378479
Epoch: 13, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.026 Vali Acc: 0.650 Test Loss: 1.026 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8927528858184814
Epoch: 14, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.051 Vali Acc: 0.650 Test Loss: 1.051 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7753443717956543
Epoch: 15, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.059 Vali Acc: 0.650 Test Loss: 1.059 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7709791660308838
Epoch: 16, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.066 Vali Acc: 0.650 Test Loss: 1.066 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8733270168304443
Epoch: 17, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.078 Vali Acc: 0.675 Test Loss: 1.078 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7677891254425049
Epoch: 18, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.090 Vali Acc: 0.700 Test Loss: 1.090 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 0.8555581569671631
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.101 Vali Acc: 0.700 Test Loss: 1.101 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8482263088226318
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.114 Vali Acc: 0.700 Test Loss: 1.114 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7583560943603516
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.121 Vali Acc: 0.700 Test Loss: 1.121 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8087005615234375
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.128 Vali Acc: 0.700 Test Loss: 1.128 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8796226978302002
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.136 Vali Acc: 0.700 Test Loss: 1.136 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8556127548217773
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.141 Vali Acc: 0.700 Test Loss: 1.141 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8779962062835693
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.149 Vali Acc: 0.700 Test Loss: 1.149 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9645440578460693
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.153 Vali Acc: 0.675 Test Loss: 1.153 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8416352272033691
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.160 Vali Acc: 0.675 Test Loss: 1.160 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7533519268035889
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.164 Vali Acc: 0.675 Test Loss: 1.164 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 277252
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.507230520248413
Epoch: 1, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.371 Vali Acc: 0.325 Test Loss: 1.371 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.803210973739624
Epoch: 2, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.340 Vali Acc: 0.400 Test Loss: 1.340 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.717726469039917
Epoch: 3, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.285 Vali Acc: 0.450 Test Loss: 1.285 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.7533712387084961
Epoch: 4, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.234 Vali Acc: 0.425 Test Loss: 1.234 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7707557678222656
Epoch: 5, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.181 Vali Acc: 0.450 Test Loss: 1.181 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.6945970058441162
Epoch: 6, Steps: 3 | Train Loss: 0.805 Vali Loss: 1.135 Vali Acc: 0.550 Test Loss: 1.135 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 0.8010914325714111
Epoch: 7, Steps: 3 | Train Loss: 0.583 Vali Loss: 1.107 Vali Acc: 0.550 Test Loss: 1.107 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.6981942653656006
Epoch: 8, Steps: 3 | Train Loss: 0.456 Vali Loss: 1.111 Vali Acc: 0.575 Test Loss: 1.111 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.7888057231903076
Epoch: 9, Steps: 3 | Train Loss: 0.315 Vali Loss: 1.108 Vali Acc: 0.650 Test Loss: 1.108 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.6669096946716309
Epoch: 10, Steps: 3 | Train Loss: 0.279 Vali Loss: 1.091 Vali Acc: 0.650 Test Loss: 1.091 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 0.8132703304290771
Epoch: 11, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.054 Vali Acc: 0.675 Test Loss: 1.054 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 0.6642298698425293
Epoch: 12, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.6681675910949707
Epoch: 13, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.057 Vali Acc: 0.700 Test Loss: 1.057 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.674652099609375
Epoch: 14, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7747647762298584
Epoch: 15, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.135 Vali Acc: 0.675 Test Loss: 1.135 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7756261825561523
Epoch: 16, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.153 Vali Acc: 0.675 Test Loss: 1.153 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8701372146606445
Epoch: 17, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.167 Vali Acc: 0.700 Test Loss: 1.167 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7721366882324219
Epoch: 18, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.181 Vali Acc: 0.700 Test Loss: 1.181 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7928774356842041
Epoch: 19, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.189 Vali Acc: 0.700 Test Loss: 1.189 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7993824481964111
Epoch: 20, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.196 Vali Acc: 0.700 Test Loss: 1.196 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8010499477386475
Epoch: 21, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.202 Vali Acc: 0.700 Test Loss: 1.202 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7824621200561523
Epoch: 22, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.206 Vali Acc: 0.700 Test Loss: 1.206 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 262148
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4258294105529785
Epoch: 1, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.485 Vali Acc: 0.175 Test Loss: 1.485 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.7658789157867432
Epoch: 2, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.474 Vali Acc: 0.225 Test Loss: 1.474 Test Acc: 0.225
Validation loss decreased (-0.174985 --> -0.224985).  Saving model ...
Epoch: 3 cost time: 0.7436754703521729
Epoch: 3, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.457 Vali Acc: 0.225 Test Loss: 1.457 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224985).  Saving model ...
Epoch: 4 cost time: 0.7576985359191895
Epoch: 4, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.429 Vali Acc: 0.300 Test Loss: 1.429 Test Acc: 0.300
Validation loss decreased (-0.224985 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.8176958560943604
Epoch: 5, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.400 Vali Acc: 0.350 Test Loss: 1.400 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.7600078582763672
Epoch: 6, Steps: 3 | Train Loss: 0.839 Vali Loss: 1.376 Vali Acc: 0.375 Test Loss: 1.376 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.851438045501709
Epoch: 7, Steps: 3 | Train Loss: 0.667 Vali Loss: 1.355 Vali Acc: 0.400 Test Loss: 1.355 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 0.8597111701965332
Epoch: 8, Steps: 3 | Train Loss: 0.583 Vali Loss: 1.330 Vali Acc: 0.500 Test Loss: 1.330 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.7117671966552734
Epoch: 9, Steps: 3 | Train Loss: 0.535 Vali Loss: 1.312 Vali Acc: 0.525 Test Loss: 1.312 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 0.7588021755218506
Epoch: 10, Steps: 3 | Train Loss: 0.360 Vali Loss: 1.289 Vali Acc: 0.575 Test Loss: 1.289 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 11 cost time: 0.742009162902832
Epoch: 11, Steps: 3 | Train Loss: 0.335 Vali Loss: 1.270 Vali Acc: 0.600 Test Loss: 1.270 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 0.7557854652404785
Epoch: 12, Steps: 3 | Train Loss: 0.222 Vali Loss: 1.263 Vali Acc: 0.600 Test Loss: 1.263 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 13 cost time: 0.9495539665222168
Epoch: 13, Steps: 3 | Train Loss: 0.175 Vali Loss: 1.246 Vali Acc: 0.600 Test Loss: 1.246 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 0.7929391860961914
Epoch: 14, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.250 Vali Acc: 0.600 Test Loss: 1.250 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8273398876190186
Epoch: 15, Steps: 3 | Train Loss: 0.107 Vali Loss: 1.237 Vali Acc: 0.650 Test Loss: 1.237 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 16 cost time: 0.7489712238311768
Epoch: 16, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.237 Vali Acc: 0.675 Test Loss: 1.237 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 17 cost time: 0.8114748001098633
Epoch: 17, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.250 Vali Acc: 0.675 Test Loss: 1.250 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6982340812683105
Epoch: 18, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.255 Vali Acc: 0.675 Test Loss: 1.255 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7751398086547852
Epoch: 19, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.260 Vali Acc: 0.675 Test Loss: 1.260 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7889032363891602
Epoch: 20, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.270 Vali Acc: 0.700 Test Loss: 1.270 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699987).  Saving model ...
Epoch: 21 cost time: 0.7624433040618896
Epoch: 21, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.284 Vali Acc: 0.700 Test Loss: 1.284 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7086822986602783
Epoch: 22, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.296 Vali Acc: 0.700 Test Loss: 1.296 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7345824241638184
Epoch: 23, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.310 Vali Acc: 0.700 Test Loss: 1.310 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7802948951721191
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.318 Vali Acc: 0.700 Test Loss: 1.318 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8509976863861084
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.330 Vali Acc: 0.700 Test Loss: 1.330 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8015189170837402
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.339 Vali Acc: 0.700 Test Loss: 1.339 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7336890697479248
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.347 Vali Acc: 0.700 Test Loss: 1.347 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8315544128417969
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.355 Vali Acc: 0.675 Test Loss: 1.355 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7275419235229492
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.358 Vali Acc: 0.675 Test Loss: 1.358 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7776772975921631
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.362 Vali Acc: 0.675 Test Loss: 1.362 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 238212
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.319808006286621
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.594 Vali Acc: 0.100 Test Loss: 1.594 Test Acc: 0.100
Validation loss decreased (inf --> -0.099984).  Saving model ...
Epoch: 2 cost time: 0.7808682918548584
Epoch: 2, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.577 Vali Acc: 0.125 Test Loss: 1.577 Test Acc: 0.125
Validation loss decreased (-0.099984 --> -0.124984).  Saving model ...
Epoch: 3 cost time: 0.6697525978088379
Epoch: 3, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.544 Vali Acc: 0.200 Test Loss: 1.544 Test Acc: 0.200
Validation loss decreased (-0.124984 --> -0.199985).  Saving model ...
Epoch: 4 cost time: 0.6386940479278564
Epoch: 4, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.501 Vali Acc: 0.275 Test Loss: 1.501 Test Acc: 0.275
Validation loss decreased (-0.199985 --> -0.274985).  Saving model ...
Epoch: 5 cost time: 0.6792259216308594
Epoch: 5, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.450 Vali Acc: 0.325 Test Loss: 1.450 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324985).  Saving model ...
Epoch: 6 cost time: 0.6778550148010254
Epoch: 6, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.405 Vali Acc: 0.300 Test Loss: 1.405 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6564517021179199
Epoch: 7, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.359 Vali Acc: 0.350 Test Loss: 1.359 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.6258790493011475
Epoch: 8, Steps: 3 | Train Loss: 0.673 Vali Loss: 1.326 Vali Acc: 0.400 Test Loss: 1.326 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.7203457355499268
Epoch: 9, Steps: 3 | Train Loss: 0.649 Vali Loss: 1.294 Vali Acc: 0.425 Test Loss: 1.294 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.721560001373291
Epoch: 10, Steps: 3 | Train Loss: 0.506 Vali Loss: 1.275 Vali Acc: 0.475 Test Loss: 1.275 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.6423919200897217
Epoch: 11, Steps: 3 | Train Loss: 0.355 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.6370623111724854
Epoch: 12, Steps: 3 | Train Loss: 0.310 Vali Loss: 1.243 Vali Acc: 0.525 Test Loss: 1.243 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 0.6812944412231445
Epoch: 13, Steps: 3 | Train Loss: 0.292 Vali Loss: 1.233 Vali Acc: 0.550 Test Loss: 1.233 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 0.6852340698242188
Epoch: 14, Steps: 3 | Train Loss: 0.182 Vali Loss: 1.240 Vali Acc: 0.550 Test Loss: 1.240 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7137115001678467
Epoch: 15, Steps: 3 | Train Loss: 0.161 Vali Loss: 1.260 Vali Acc: 0.550 Test Loss: 1.260 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8157281875610352
Epoch: 16, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.278 Vali Acc: 0.525 Test Loss: 1.278 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7023096084594727
Epoch: 17, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.280 Vali Acc: 0.575 Test Loss: 1.280 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574987).  Saving model ...
Epoch: 18 cost time: 0.6559462547302246
Epoch: 18, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.276 Vali Acc: 0.575 Test Loss: 1.276 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 19 cost time: 0.66103196144104
Epoch: 19, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.287 Vali Acc: 0.575 Test Loss: 1.287 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.631467342376709
Epoch: 20, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.299 Vali Acc: 0.600 Test Loss: 1.299 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 21 cost time: 0.6736581325531006
Epoch: 21, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.313 Vali Acc: 0.600 Test Loss: 1.313 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.64874267578125
Epoch: 22, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.318 Vali Acc: 0.600 Test Loss: 1.318 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7140669822692871
Epoch: 23, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.319 Vali Acc: 0.625 Test Loss: 1.319 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624987).  Saving model ...
Epoch: 24 cost time: 0.5894343852996826
Epoch: 24, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.326 Vali Acc: 0.625 Test Loss: 1.326 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7451813220977783
Epoch: 25, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.327 Vali Acc: 0.625 Test Loss: 1.327 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.49158763885498047
Epoch: 26, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.328 Vali Acc: 0.650 Test Loss: 1.328 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 27 cost time: 0.6436300277709961
Epoch: 27, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.333 Vali Acc: 0.625 Test Loss: 1.333 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5728580951690674
Epoch: 28, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.334 Vali Acc: 0.625 Test Loss: 1.334 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6419234275817871
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.333 Vali Acc: 0.625 Test Loss: 1.333 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6415612697601318
Epoch: 30, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.334 Vali Acc: 0.650 Test Loss: 1.334 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6677820682525635
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.331 Vali Acc: 0.650 Test Loss: 1.331 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6545653343200684
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.332 Vali Acc: 0.650 Test Loss: 1.332 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.697617769241333
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.333 Vali Acc: 0.675 Test Loss: 1.333 Test Acc: 0.675
Validation loss decreased (-0.649987 --> -0.674987).  Saving model ...
Epoch: 34 cost time: 0.5364089012145996
Epoch: 34, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.335 Vali Acc: 0.675 Test Loss: 1.335 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5773704051971436
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.335 Vali Acc: 0.675 Test Loss: 1.335 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.545525074005127
Epoch: 36, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.337 Vali Acc: 0.675 Test Loss: 1.337 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6258788108825684
Epoch: 37, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.340 Vali Acc: 0.675 Test Loss: 1.340 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7040956020355225
Epoch: 38, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.341 Vali Acc: 0.675 Test Loss: 1.341 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.662900447845459
Epoch: 39, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.344 Vali Acc: 0.675 Test Loss: 1.344 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7443242073059082
Epoch: 40, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.344 Vali Acc: 0.675 Test Loss: 1.344 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6021993160247803
Epoch: 41, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.350 Vali Acc: 0.675 Test Loss: 1.350 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7065401077270508
Epoch: 42, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.355 Vali Acc: 0.675 Test Loss: 1.355 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6418592929840088
Epoch: 43, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.357 Vali Acc: 0.675 Test Loss: 1.357 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 232708
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.434114694595337
Epoch: 1, Steps: 3 | Train Loss: 1.565 Vali Loss: 1.389 Vali Acc: 0.300 Test Loss: 1.389 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6726758480072021
Epoch: 2, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.374 Vali Acc: 0.300 Test Loss: 1.374 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.700890302658081
Epoch: 3, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.355 Vali Acc: 0.425 Test Loss: 1.355 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.6319751739501953
Epoch: 4, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.330 Vali Acc: 0.400 Test Loss: 1.330 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6060812473297119
Epoch: 5, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.305 Vali Acc: 0.375 Test Loss: 1.305 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6670587062835693
Epoch: 6, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.284 Vali Acc: 0.375 Test Loss: 1.284 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6189227104187012
Epoch: 7, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6482372283935547
Epoch: 8, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.247 Vali Acc: 0.425 Test Loss: 1.247 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424988).  Saving model ...
Epoch: 9 cost time: 0.652630090713501
Epoch: 9, Steps: 3 | Train Loss: 0.688 Vali Loss: 1.232 Vali Acc: 0.425 Test Loss: 1.232 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 10 cost time: 0.6337249279022217
Epoch: 10, Steps: 3 | Train Loss: 0.568 Vali Loss: 1.222 Vali Acc: 0.475 Test Loss: 1.222 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.7168874740600586
Epoch: 11, Steps: 3 | Train Loss: 0.584 Vali Loss: 1.212 Vali Acc: 0.475 Test Loss: 1.212 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 12 cost time: 0.6554923057556152
Epoch: 12, Steps: 3 | Train Loss: 0.518 Vali Loss: 1.205 Vali Acc: 0.475 Test Loss: 1.205 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 0.5887792110443115
Epoch: 13, Steps: 3 | Train Loss: 0.432 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.6318612098693848
Epoch: 14, Steps: 3 | Train Loss: 0.361 Vali Loss: 1.183 Vali Acc: 0.550 Test Loss: 1.183 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.6778428554534912
Epoch: 15, Steps: 3 | Train Loss: 0.234 Vali Loss: 1.168 Vali Acc: 0.550 Test Loss: 1.168 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 16 cost time: 0.6119065284729004
Epoch: 16, Steps: 3 | Train Loss: 0.231 Vali Loss: 1.153 Vali Acc: 0.575 Test Loss: 1.153 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 17 cost time: 0.8426723480224609
Epoch: 17, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.146 Vali Acc: 0.575 Test Loss: 1.146 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 0.6469113826751709
Epoch: 18, Steps: 3 | Train Loss: 0.117 Vali Loss: 1.144 Vali Acc: 0.575 Test Loss: 1.144 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 19 cost time: 0.7591021060943604
Epoch: 19, Steps: 3 | Train Loss: 0.105 Vali Loss: 1.143 Vali Acc: 0.575 Test Loss: 1.143 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 20 cost time: 0.6404750347137451
Epoch: 20, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.145 Vali Acc: 0.575 Test Loss: 1.145 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6908721923828125
Epoch: 21, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.147 Vali Acc: 0.625 Test Loss: 1.147 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 22 cost time: 0.6443941593170166
Epoch: 22, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.151 Vali Acc: 0.650 Test Loss: 1.151 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649988).  Saving model ...
Epoch: 23 cost time: 0.6959629058837891
Epoch: 23, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.161 Vali Acc: 0.650 Test Loss: 1.161 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6852419376373291
Epoch: 24, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.170 Vali Acc: 0.650 Test Loss: 1.170 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6664214134216309
Epoch: 25, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.182 Vali Acc: 0.650 Test Loss: 1.182 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6288819313049316
Epoch: 26, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.190 Vali Acc: 0.650 Test Loss: 1.190 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6722407341003418
Epoch: 27, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.195 Vali Acc: 0.650 Test Loss: 1.195 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5715489387512207
Epoch: 28, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.197 Vali Acc: 0.650 Test Loss: 1.197 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5498404502868652
Epoch: 29, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.200 Vali Acc: 0.675 Test Loss: 1.200 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 30 cost time: 0.585371732711792
Epoch: 30, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.203 Vali Acc: 0.675 Test Loss: 1.203 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5669240951538086
Epoch: 31, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.205 Vali Acc: 0.675 Test Loss: 1.205 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6375405788421631
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.208 Vali Acc: 0.675 Test Loss: 1.208 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5671906471252441
Epoch: 33, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.209 Vali Acc: 0.675 Test Loss: 1.209 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5734891891479492
Epoch: 34, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.211 Vali Acc: 0.675 Test Loss: 1.211 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6277487277984619
Epoch: 35, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.211 Vali Acc: 0.675 Test Loss: 1.211 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5941624641418457
Epoch: 36, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.213 Vali Acc: 0.650 Test Loss: 1.213 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6934783458709717
Epoch: 37, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.216 Vali Acc: 0.650 Test Loss: 1.216 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6737594604492188
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.217 Vali Acc: 0.650 Test Loss: 1.217 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7121734619140625
Epoch: 39, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.218 Vali Acc: 0.650 Test Loss: 1.218 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df128_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 224132
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.647752046585083
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.504 Vali Acc: 0.275 Test Loss: 1.504 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.8570330142974854
Epoch: 2, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.402 Vali Acc: 0.325 Test Loss: 1.402 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.7557389736175537
Epoch: 3, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.268 Vali Acc: 0.425 Test Loss: 1.268 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.7580180168151855
Epoch: 4, Steps: 3 | Train Loss: 0.679 Vali Loss: 1.157 Vali Acc: 0.525 Test Loss: 1.157 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.8053972721099854
Epoch: 5, Steps: 3 | Train Loss: 0.475 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.885551929473877
Epoch: 6, Steps: 3 | Train Loss: 0.293 Vali Loss: 1.085 Vali Acc: 0.625 Test Loss: 1.085 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.7453083992004395
Epoch: 7, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.972 Vali Acc: 0.700 Test Loss: 0.972 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.852912425994873
Epoch: 8, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.916 Vali Acc: 0.725 Test Loss: 0.916 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 9 cost time: 0.8391082286834717
Epoch: 9, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.925 Vali Acc: 0.725 Test Loss: 0.925 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8224923610687256
Epoch: 10, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.929 Vali Acc: 0.725 Test Loss: 0.929 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7899951934814453
Epoch: 11, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.960 Vali Acc: 0.725 Test Loss: 0.960 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8157045841217041
Epoch: 12, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.009 Vali Acc: 0.725 Test Loss: 1.009 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6370220184326172
Epoch: 13, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.067 Vali Acc: 0.725 Test Loss: 1.067 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.83101487159729
Epoch: 14, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8367259502410889
Epoch: 15, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.089 Vali Acc: 0.725 Test Loss: 1.089 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8728508949279785
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.070 Vali Acc: 0.750 Test Loss: 1.070 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749989).  Saving model ...
Epoch: 17 cost time: 0.8185126781463623
Epoch: 17, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.054 Vali Acc: 0.750 Test Loss: 1.054 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 18 cost time: 0.9972743988037109
Epoch: 18, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.043 Vali Acc: 0.775 Test Loss: 1.043 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 19 cost time: 0.7562813758850098
Epoch: 19, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.037 Vali Acc: 0.775 Test Loss: 1.037 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 20 cost time: 0.8250207901000977
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.034 Vali Acc: 0.775 Test Loss: 1.034 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 21 cost time: 0.7918169498443604
Epoch: 21, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.800 Test Loss: 1.036 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 22 cost time: 0.8009963035583496
Epoch: 22, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.800 Test Loss: 1.038 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.816065788269043
Epoch: 23, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.800 Test Loss: 1.041 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7345168590545654
Epoch: 24, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.800 Test Loss: 1.045 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7731342315673828
Epoch: 25, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.800 Test Loss: 1.049 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7683818340301514
Epoch: 26, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.800 Test Loss: 1.054 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7797203063964844
Epoch: 27, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.800 Test Loss: 1.058 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.80830979347229
Epoch: 28, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.800 Test Loss: 1.063 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8742396831512451
Epoch: 29, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.066 Vali Acc: 0.800 Test Loss: 1.066 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8763277530670166
Epoch: 30, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.800 Test Loss: 1.070 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7570500373840332
Epoch: 31, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.800 Test Loss: 1.072 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 320516
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6574957370758057
Epoch: 1, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.505 Vali Acc: 0.300 Test Loss: 1.505 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.8615925312042236
Epoch: 2, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.420 Vali Acc: 0.375 Test Loss: 1.420 Test Acc: 0.375
Validation loss decreased (-0.299985 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.8473949432373047
Epoch: 3, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.317 Vali Acc: 0.475 Test Loss: 1.317 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.6768276691436768
Epoch: 4, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.197 Vali Acc: 0.575 Test Loss: 1.197 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.9869184494018555
Epoch: 5, Steps: 3 | Train Loss: 0.650 Vali Loss: 1.125 Vali Acc: 0.575 Test Loss: 1.125 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.8192501068115234
Epoch: 6, Steps: 3 | Train Loss: 0.636 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.7208983898162842
Epoch: 7, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.933 Vali Acc: 0.700 Test Loss: 0.933 Test Acc: 0.700
Validation loss decreased (-0.599990 --> -0.699991).  Saving model ...
Epoch: 8 cost time: 0.6893911361694336
Epoch: 8, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.881 Vali Acc: 0.700 Test Loss: 0.881 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 9 cost time: 0.720757246017456
Epoch: 9, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.859 Vali Acc: 0.675 Test Loss: 0.859 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7839560508728027
Epoch: 10, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.900 Vali Acc: 0.700 Test Loss: 0.900 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7109673023223877
Epoch: 11, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.906 Vali Acc: 0.700 Test Loss: 0.906 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8964676856994629
Epoch: 12, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.869 Vali Acc: 0.725 Test Loss: 0.869 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.8161547183990479
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 0.746509313583374
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.852 Vali Acc: 0.750 Test Loss: 0.852 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.896510124206543
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.826397180557251
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.902 Vali Acc: 0.750 Test Loss: 0.902 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7867486476898193
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.920 Vali Acc: 0.750 Test Loss: 0.920 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8398544788360596
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.750 Test Loss: 0.936 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8978419303894043
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8839154243469238
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.880272388458252
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.962 Vali Acc: 0.750 Test Loss: 0.962 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.855928897857666
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.967 Vali Acc: 0.750 Test Loss: 0.967 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8104743957519531
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.972 Vali Acc: 0.750 Test Loss: 0.972 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 268548
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.351921558380127
Epoch: 1, Steps: 3 | Train Loss: 1.743 Vali Loss: 1.457 Vali Acc: 0.275 Test Loss: 1.457 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.7900722026824951
Epoch: 2, Steps: 3 | Train Loss: 1.556 Vali Loss: 1.427 Vali Acc: 0.350 Test Loss: 1.427 Test Acc: 0.350
Validation loss decreased (-0.274985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.7302958965301514
Epoch: 3, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.368 Vali Acc: 0.400 Test Loss: 1.368 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.7586028575897217
Epoch: 4, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.291 Vali Acc: 0.350 Test Loss: 1.291 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7376179695129395
Epoch: 5, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.197 Vali Acc: 0.475 Test Loss: 1.197 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.801593542098999
Epoch: 6, Steps: 3 | Train Loss: 0.765 Vali Loss: 1.134 Vali Acc: 0.600 Test Loss: 1.134 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.7035107612609863
Epoch: 7, Steps: 3 | Train Loss: 0.470 Vali Loss: 1.085 Vali Acc: 0.625 Test Loss: 1.085 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 0.8047089576721191
Epoch: 8, Steps: 3 | Train Loss: 0.389 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7391376495361328
Epoch: 9, Steps: 3 | Train Loss: 0.350 Vali Loss: 1.009 Vali Acc: 0.625 Test Loss: 1.009 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.7828464508056641
Epoch: 10, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.988 Vali Acc: 0.650 Test Loss: 0.988 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.7456245422363281
Epoch: 11, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.999 Vali Acc: 0.675 Test Loss: 0.999 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.8032984733581543
Epoch: 12, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.985 Vali Acc: 0.700 Test Loss: 0.985 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.8279721736907959
Epoch: 13, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.967 Vali Acc: 0.725 Test Loss: 0.967 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.7949168682098389
Epoch: 14, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.977 Vali Acc: 0.750 Test Loss: 0.977 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.7416584491729736
Epoch: 15, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.013 Vali Acc: 0.725 Test Loss: 1.013 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7495591640472412
Epoch: 16, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7905623912811279
Epoch: 17, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.092 Vali Acc: 0.675 Test Loss: 1.092 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7193877696990967
Epoch: 18, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.112 Vali Acc: 0.675 Test Loss: 1.112 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7439074516296387
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8139750957489014
Epoch: 20, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.136 Vali Acc: 0.675 Test Loss: 1.136 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8737225532531738
Epoch: 21, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.142 Vali Acc: 0.700 Test Loss: 1.142 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0695977210998535
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.147 Vali Acc: 0.700 Test Loss: 1.147 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7793006896972656
Epoch: 23, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.149 Vali Acc: 0.700 Test Loss: 1.149 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8796184062957764
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.151 Vali Acc: 0.700 Test Loss: 1.151 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 244356
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6860318183898926
Epoch: 1, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.475 Vali Acc: 0.275 Test Loss: 1.475 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.7796154022216797
Epoch: 2, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.436 Vali Acc: 0.275 Test Loss: 1.436 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.7831408977508545
Epoch: 3, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.371 Vali Acc: 0.275 Test Loss: 1.371 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.6719355583190918
Epoch: 4, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.292 Vali Acc: 0.375 Test Loss: 1.292 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.7453343868255615
Epoch: 5, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.212 Vali Acc: 0.375 Test Loss: 1.212 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374988).  Saving model ...
Epoch: 6 cost time: 0.6834561824798584
Epoch: 6, Steps: 3 | Train Loss: 0.776 Vali Loss: 1.161 Vali Acc: 0.550 Test Loss: 1.161 Test Acc: 0.550
Validation loss decreased (-0.374988 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.7852401733398438
Epoch: 7, Steps: 3 | Train Loss: 0.555 Vali Loss: 1.144 Vali Acc: 0.600 Test Loss: 1.144 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.7373034954071045
Epoch: 8, Steps: 3 | Train Loss: 0.475 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.7228889465332031
Epoch: 9, Steps: 3 | Train Loss: 0.284 Vali Loss: 1.090 Vali Acc: 0.625 Test Loss: 1.090 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.7637205123901367
Epoch: 10, Steps: 3 | Train Loss: 0.235 Vali Loss: 1.082 Vali Acc: 0.650 Test Loss: 1.082 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 0.8330106735229492
Epoch: 11, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.068 Vali Acc: 0.650 Test Loss: 1.068 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.7311985492706299
Epoch: 12, Steps: 3 | Train Loss: 0.106 Vali Loss: 1.046 Vali Acc: 0.650 Test Loss: 1.046 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 0.847231388092041
Epoch: 13, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.046 Vali Acc: 0.700 Test Loss: 1.046 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 0.8994054794311523
Epoch: 14, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.063 Vali Acc: 0.700 Test Loss: 1.063 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7923662662506104
Epoch: 15, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.096 Vali Acc: 0.700 Test Loss: 1.096 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.764493465423584
Epoch: 16, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.141 Vali Acc: 0.700 Test Loss: 1.141 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8654470443725586
Epoch: 17, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.188 Vali Acc: 0.700 Test Loss: 1.188 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8852465152740479
Epoch: 18, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.210 Vali Acc: 0.700 Test Loss: 1.210 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7340190410614014
Epoch: 19, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.215 Vali Acc: 0.700 Test Loss: 1.215 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7904677391052246
Epoch: 20, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.213 Vali Acc: 0.700 Test Loss: 1.213 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6632964611053467
Epoch: 21, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.208 Vali Acc: 0.700 Test Loss: 1.208 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9094388484954834
Epoch: 22, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.205 Vali Acc: 0.700 Test Loss: 1.205 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7628071308135986
Epoch: 23, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.198 Vali Acc: 0.700 Test Loss: 1.198 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 229252
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4513449668884277
Epoch: 1, Steps: 3 | Train Loss: 1.528 Vali Loss: 1.576 Vali Acc: 0.175 Test Loss: 1.576 Test Acc: 0.175
Validation loss decreased (inf --> -0.174984).  Saving model ...
Epoch: 2 cost time: 0.8472702503204346
Epoch: 2, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.560 Vali Acc: 0.200 Test Loss: 1.560 Test Acc: 0.200
Validation loss decreased (-0.174984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 0.6863389015197754
Epoch: 3, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.531 Vali Acc: 0.175 Test Loss: 1.531 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8026552200317383
Epoch: 4, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.494 Vali Acc: 0.325 Test Loss: 1.494 Test Acc: 0.325
Validation loss decreased (-0.199984 --> -0.324985).  Saving model ...
Epoch: 5 cost time: 0.695425271987915
Epoch: 5, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.450 Vali Acc: 0.375 Test Loss: 1.450 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374985).  Saving model ...
Epoch: 6 cost time: 0.8203003406524658
Epoch: 6, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.403 Vali Acc: 0.425 Test Loss: 1.403 Test Acc: 0.425
Validation loss decreased (-0.374985 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 0.7148869037628174
Epoch: 7, Steps: 3 | Train Loss: 0.714 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 0.7730257511138916
Epoch: 8, Steps: 3 | Train Loss: 0.619 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.8050968647003174
Epoch: 9, Steps: 3 | Train Loss: 0.514 Vali Loss: 1.284 Vali Acc: 0.550 Test Loss: 1.284 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 10 cost time: 0.7247629165649414
Epoch: 10, Steps: 3 | Train Loss: 0.426 Vali Loss: 1.262 Vali Acc: 0.525 Test Loss: 1.262 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8240926265716553
Epoch: 11, Steps: 3 | Train Loss: 0.314 Vali Loss: 1.240 Vali Acc: 0.525 Test Loss: 1.240 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7947101593017578
Epoch: 12, Steps: 3 | Train Loss: 0.386 Vali Loss: 1.233 Vali Acc: 0.550 Test Loss: 1.233 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 0.704932451248169
Epoch: 13, Steps: 3 | Train Loss: 0.206 Vali Loss: 1.240 Vali Acc: 0.525 Test Loss: 1.240 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7554728984832764
Epoch: 14, Steps: 3 | Train Loss: 0.155 Vali Loss: 1.252 Vali Acc: 0.575 Test Loss: 1.252 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574987).  Saving model ...
Epoch: 15 cost time: 0.8398385047912598
Epoch: 15, Steps: 3 | Train Loss: 0.128 Vali Loss: 1.260 Vali Acc: 0.575 Test Loss: 1.260 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.807443380355835
Epoch: 16, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.264 Vali Acc: 0.600 Test Loss: 1.264 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 17 cost time: 0.7792983055114746
Epoch: 17, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.267 Vali Acc: 0.625 Test Loss: 1.267 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624987).  Saving model ...
Epoch: 18 cost time: 0.7679734230041504
Epoch: 18, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.281 Vali Acc: 0.650 Test Loss: 1.281 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 19 cost time: 0.8682441711425781
Epoch: 19, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.298 Vali Acc: 0.650 Test Loss: 1.298 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7633223533630371
Epoch: 20, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.312 Vali Acc: 0.625 Test Loss: 1.312 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7591674327850342
Epoch: 21, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.323 Vali Acc: 0.625 Test Loss: 1.323 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0301563739776611
Epoch: 22, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.331 Vali Acc: 0.650 Test Loss: 1.331 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7765848636627197
Epoch: 23, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.340 Vali Acc: 0.650 Test Loss: 1.340 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8850429058074951
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.344 Vali Acc: 0.650 Test Loss: 1.344 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8266799449920654
Epoch: 25, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.348 Vali Acc: 0.650 Test Loss: 1.348 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9194602966308594
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.355 Vali Acc: 0.650 Test Loss: 1.355 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8973901271820068
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.361 Vali Acc: 0.650 Test Loss: 1.361 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8242616653442383
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.370 Vali Acc: 0.675 Test Loss: 1.370 Test Acc: 0.675
Validation loss decreased (-0.649987 --> -0.674986).  Saving model ...
Epoch: 29 cost time: 0.768024206161499
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.379 Vali Acc: 0.675 Test Loss: 1.379 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7535796165466309
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.390 Vali Acc: 0.675 Test Loss: 1.390 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8539454936981201
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.400 Vali Acc: 0.675 Test Loss: 1.400 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8293271064758301
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.406 Vali Acc: 0.675 Test Loss: 1.406 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7761008739471436
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.412 Vali Acc: 0.675 Test Loss: 1.412 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7400922775268555
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.418 Vali Acc: 0.675 Test Loss: 1.418 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7282485961914062
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.423 Vali Acc: 0.675 Test Loss: 1.423 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7095496654510498
Epoch: 36, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.428 Vali Acc: 0.675 Test Loss: 1.428 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7445437908172607
Epoch: 37, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.428 Vali Acc: 0.675 Test Loss: 1.428 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6908485889434814
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.431 Vali Acc: 0.675 Test Loss: 1.431 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 205316
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1752424240112305
Epoch: 1, Steps: 3 | Train Loss: 1.500 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.6409356594085693
Epoch: 2, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.370 Vali Acc: 0.225 Test Loss: 1.370 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6533656120300293
Epoch: 3, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.344 Vali Acc: 0.275 Test Loss: 1.344 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.6754584312438965
Epoch: 4, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.309 Vali Acc: 0.350 Test Loss: 1.309 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.6064109802246094
Epoch: 5, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.264 Vali Acc: 0.450 Test Loss: 1.264 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.6548383235931396
Epoch: 6, Steps: 3 | Train Loss: 0.907 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.5086944103240967
Epoch: 7, Steps: 3 | Train Loss: 0.773 Vali Loss: 1.176 Vali Acc: 0.575 Test Loss: 1.176 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.641230583190918
Epoch: 8, Steps: 3 | Train Loss: 0.724 Vali Loss: 1.145 Vali Acc: 0.550 Test Loss: 1.145 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6228897571563721
Epoch: 9, Steps: 3 | Train Loss: 0.540 Vali Loss: 1.120 Vali Acc: 0.600 Test Loss: 1.120 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.6290626525878906
Epoch: 10, Steps: 3 | Train Loss: 0.433 Vali Loss: 1.092 Vali Acc: 0.600 Test Loss: 1.092 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.5818803310394287
Epoch: 11, Steps: 3 | Train Loss: 0.443 Vali Loss: 1.078 Vali Acc: 0.550 Test Loss: 1.078 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6958131790161133
Epoch: 12, Steps: 3 | Train Loss: 0.369 Vali Loss: 1.068 Vali Acc: 0.550 Test Loss: 1.068 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6160595417022705
Epoch: 13, Steps: 3 | Train Loss: 0.254 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.6699419021606445
Epoch: 14, Steps: 3 | Train Loss: 0.198 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6069951057434082
Epoch: 15, Steps: 3 | Train Loss: 0.162 Vali Loss: 1.070 Vali Acc: 0.625 Test Loss: 1.070 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 16 cost time: 0.5841302871704102
Epoch: 16, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.072 Vali Acc: 0.625 Test Loss: 1.072 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6306209564208984
Epoch: 17, Steps: 3 | Train Loss: 0.083 Vali Loss: 1.080 Vali Acc: 0.625 Test Loss: 1.080 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6079154014587402
Epoch: 18, Steps: 3 | Train Loss: 0.070 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 0.6459269523620605
Epoch: 19, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.079 Vali Acc: 0.650 Test Loss: 1.079 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.7300453186035156
Epoch: 20, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.080 Vali Acc: 0.650 Test Loss: 1.080 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6403243541717529
Epoch: 21, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.083 Vali Acc: 0.650 Test Loss: 1.083 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6721746921539307
Epoch: 22, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.089 Vali Acc: 0.650 Test Loss: 1.089 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6739926338195801
Epoch: 23, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.100 Vali Acc: 0.650 Test Loss: 1.100 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7021169662475586
Epoch: 24, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.108 Vali Acc: 0.650 Test Loss: 1.108 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.623572826385498
Epoch: 25, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.116 Vali Acc: 0.650 Test Loss: 1.116 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6428508758544922
Epoch: 26, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.125 Vali Acc: 0.650 Test Loss: 1.125 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.648432731628418
Epoch: 27, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.135 Vali Acc: 0.650 Test Loss: 1.135 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6931827068328857
Epoch: 28, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.144 Vali Acc: 0.650 Test Loss: 1.144 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6807208061218262
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.146 Vali Acc: 0.650 Test Loss: 1.146 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 199812
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6480932235717773
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.502 Vali Acc: 0.300 Test Loss: 1.502 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.6502411365509033
Epoch: 2, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.478 Vali Acc: 0.325 Test Loss: 1.478 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.7210080623626709
Epoch: 3, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.447 Vali Acc: 0.325 Test Loss: 1.447 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.6785802841186523
Epoch: 4, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.410 Vali Acc: 0.350 Test Loss: 1.410 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.718496561050415
Epoch: 5, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.375 Vali Acc: 0.350 Test Loss: 1.375 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.7036774158477783
Epoch: 6, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.343 Vali Acc: 0.400 Test Loss: 1.343 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.6732103824615479
Epoch: 7, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.314 Vali Acc: 0.425 Test Loss: 1.314 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.6597108840942383
Epoch: 8, Steps: 3 | Train Loss: 0.812 Vali Loss: 1.288 Vali Acc: 0.475 Test Loss: 1.288 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.6512150764465332
Epoch: 9, Steps: 3 | Train Loss: 0.667 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.7864038944244385
Epoch: 10, Steps: 3 | Train Loss: 0.547 Vali Loss: 1.246 Vali Acc: 0.525 Test Loss: 1.246 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.5928003787994385
Epoch: 11, Steps: 3 | Train Loss: 0.507 Vali Loss: 1.230 Vali Acc: 0.550 Test Loss: 1.230 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.6469802856445312
Epoch: 12, Steps: 3 | Train Loss: 0.462 Vali Loss: 1.216 Vali Acc: 0.575 Test Loss: 1.216 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 0.6817326545715332
Epoch: 13, Steps: 3 | Train Loss: 0.384 Vali Loss: 1.205 Vali Acc: 0.625 Test Loss: 1.205 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 14 cost time: 0.5865359306335449
Epoch: 14, Steps: 3 | Train Loss: 0.343 Vali Loss: 1.197 Vali Acc: 0.625 Test Loss: 1.197 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 15 cost time: 0.6082131862640381
Epoch: 15, Steps: 3 | Train Loss: 0.260 Vali Loss: 1.193 Vali Acc: 0.625 Test Loss: 1.193 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 16 cost time: 0.6740326881408691
Epoch: 16, Steps: 3 | Train Loss: 0.221 Vali Loss: 1.199 Vali Acc: 0.625 Test Loss: 1.199 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7180802822113037
Epoch: 17, Steps: 3 | Train Loss: 0.172 Vali Loss: 1.204 Vali Acc: 0.625 Test Loss: 1.204 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6047837734222412
Epoch: 18, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.209 Vali Acc: 0.625 Test Loss: 1.209 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7878279685974121
Epoch: 19, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.217 Vali Acc: 0.625 Test Loss: 1.217 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8743648529052734
Epoch: 20, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.224 Vali Acc: 0.625 Test Loss: 1.224 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6539809703826904
Epoch: 21, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.233 Vali Acc: 0.625 Test Loss: 1.233 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6727015972137451
Epoch: 22, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.239 Vali Acc: 0.650 Test Loss: 1.239 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 23 cost time: 0.7112295627593994
Epoch: 23, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.251 Vali Acc: 0.625 Test Loss: 1.251 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7413313388824463
Epoch: 24, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.258 Vali Acc: 0.625 Test Loss: 1.258 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6992073059082031
Epoch: 25, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.266 Vali Acc: 0.625 Test Loss: 1.266 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8172798156738281
Epoch: 26, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.270 Vali Acc: 0.650 Test Loss: 1.270 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6864128112792969
Epoch: 27, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.277 Vali Acc: 0.650 Test Loss: 1.277 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6618313789367676
Epoch: 28, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.286 Vali Acc: 0.650 Test Loss: 1.286 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6889538764953613
Epoch: 29, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.290 Vali Acc: 0.650 Test Loss: 1.290 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6728372573852539
Epoch: 30, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.299 Vali Acc: 0.650 Test Loss: 1.299 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9462878704071045
Epoch: 31, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.299 Vali Acc: 0.650 Test Loss: 1.299 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7581634521484375
Epoch: 32, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.298 Vali Acc: 0.675 Test Loss: 1.298 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674987).  Saving model ...
Epoch: 33 cost time: 0.7003257274627686
Epoch: 33, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.296 Vali Acc: 0.675 Test Loss: 1.296 Test Acc: 0.675
Validation loss decreased (-0.674987 --> -0.674987).  Saving model ...
Epoch: 34 cost time: 0.87945556640625
Epoch: 34, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.299 Vali Acc: 0.675 Test Loss: 1.299 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8430144786834717
Epoch: 35, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.304 Vali Acc: 0.675 Test Loss: 1.304 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8284144401550293
Epoch: 36, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.310 Vali Acc: 0.675 Test Loss: 1.310 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6818714141845703
Epoch: 37, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.316 Vali Acc: 0.675 Test Loss: 1.316 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9078986644744873
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.317 Vali Acc: 0.675 Test Loss: 1.317 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7595772743225098
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.320 Vali Acc: 0.675 Test Loss: 1.320 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8095366954803467
Epoch: 40, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.323 Vali Acc: 0.675 Test Loss: 1.323 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6831822395324707
Epoch: 41, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.324 Vali Acc: 0.675 Test Loss: 1.324 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.751976490020752
Epoch: 42, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.325 Vali Acc: 0.675 Test Loss: 1.325 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7625749111175537
Epoch: 43, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.329 Vali Acc: 0.675 Test Loss: 1.329 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm128_nh16_df64_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 191236
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4525041580200195
Epoch: 1, Steps: 3 | Train Loss: 1.540 Vali Loss: 1.346 Vali Acc: 0.375 Test Loss: 1.346 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.8182158470153809
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.307 Vali Acc: 0.475 Test Loss: 1.307 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.8371634483337402
Epoch: 3, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.274 Vali Acc: 0.475 Test Loss: 1.274 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.7401161193847656
Epoch: 4, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.276 Vali Acc: 0.450 Test Loss: 1.276 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7502965927124023
Epoch: 5, Steps: 3 | Train Loss: 0.796 Vali Loss: 1.206 Vali Acc: 0.450 Test Loss: 1.206 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7866880893707275
Epoch: 6, Steps: 3 | Train Loss: 0.628 Vali Loss: 1.073 Vali Acc: 0.575 Test Loss: 1.073 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.9492006301879883
Epoch: 7, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.968 Vali Acc: 0.650 Test Loss: 0.968 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.8214099407196045
Epoch: 8, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.921 Vali Acc: 0.700 Test Loss: 0.921 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 9 cost time: 0.9009931087493896
Epoch: 9, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.914 Vali Acc: 0.725 Test Loss: 0.914 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 10 cost time: 0.7907085418701172
Epoch: 10, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.939 Vali Acc: 0.700 Test Loss: 0.939 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.766608715057373
Epoch: 11, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.917 Vali Acc: 0.700 Test Loss: 0.917 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9115049839019775
Epoch: 12, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.7512919902801514
Epoch: 13, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.831 Vali Acc: 0.775 Test Loss: 0.831 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 14 cost time: 0.8352360725402832
Epoch: 14, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.830 Vali Acc: 0.775 Test Loss: 0.830 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 0.8221333026885986
Epoch: 15, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.842 Vali Acc: 0.775 Test Loss: 0.842 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7729439735412598
Epoch: 16, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.868 Vali Acc: 0.775 Test Loss: 0.868 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8878762722015381
Epoch: 17, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7407994270324707
Epoch: 18, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.908 Vali Acc: 0.750 Test Loss: 0.908 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0180518627166748
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.907 Vali Acc: 0.750 Test Loss: 0.907 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8422069549560547
Epoch: 20, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.902 Vali Acc: 0.750 Test Loss: 0.902 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7278633117675781
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.897 Vali Acc: 0.775 Test Loss: 0.897 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9352626800537109
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.893 Vali Acc: 0.775 Test Loss: 0.893 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8687534332275391
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.890 Vali Acc: 0.800 Test Loss: 0.890 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799991).  Saving model ...
Epoch: 24 cost time: 0.9002242088317871
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.889 Vali Acc: 0.800 Test Loss: 0.889 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 25 cost time: 0.8747107982635498
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.890 Vali Acc: 0.800 Test Loss: 0.890 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8424854278564453
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.800 Test Loss: 0.891 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8120379447937012
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.894 Vali Acc: 0.800 Test Loss: 0.894 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8601937294006348
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.897 Vali Acc: 0.800 Test Loss: 0.897 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9980597496032715
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.800 Test Loss: 0.899 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7454714775085449
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.900 Vali Acc: 0.800 Test Loss: 0.900 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7079827785491943
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.902 Vali Acc: 0.800 Test Loss: 0.902 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7247815132141113
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.904 Vali Acc: 0.800 Test Loss: 0.904 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7659895420074463
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.907 Vali Acc: 0.800 Test Loss: 0.907 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8789498805999756
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 177092
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4420981407165527
Epoch: 1, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.405 Vali Acc: 0.350 Test Loss: 1.405 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.7840993404388428
Epoch: 2, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.361 Vali Acc: 0.300 Test Loss: 1.361 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.743516206741333
Epoch: 3, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.298 Vali Acc: 0.225 Test Loss: 1.298 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6715967655181885
Epoch: 4, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.233 Vali Acc: 0.375 Test Loss: 1.233 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 0.6225264072418213
Epoch: 5, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.183 Vali Acc: 0.425 Test Loss: 1.183 Test Acc: 0.425
Validation loss decreased (-0.374988 --> -0.424988).  Saving model ...
Epoch: 6 cost time: 0.7707259654998779
Epoch: 6, Steps: 3 | Train Loss: 0.719 Vali Loss: 1.135 Vali Acc: 0.450 Test Loss: 1.135 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449989).  Saving model ...
Epoch: 7 cost time: 0.6582863330841064
Epoch: 7, Steps: 3 | Train Loss: 0.615 Vali Loss: 1.082 Vali Acc: 0.525 Test Loss: 1.082 Test Acc: 0.525
Validation loss decreased (-0.449989 --> -0.524989).  Saving model ...
Epoch: 8 cost time: 0.6482927799224854
Epoch: 8, Steps: 3 | Train Loss: 0.442 Vali Loss: 1.041 Vali Acc: 0.550 Test Loss: 1.041 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549990).  Saving model ...
Epoch: 9 cost time: 0.7540140151977539
Epoch: 9, Steps: 3 | Train Loss: 0.362 Vali Loss: 1.009 Vali Acc: 0.550 Test Loss: 1.009 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 10 cost time: 0.7416176795959473
Epoch: 10, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.968 Vali Acc: 0.575 Test Loss: 0.968 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 11 cost time: 0.6509945392608643
Epoch: 11, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.928 Vali Acc: 0.625 Test Loss: 0.928 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624991).  Saving model ...
Epoch: 12 cost time: 0.7332589626312256
Epoch: 12, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.888 Vali Acc: 0.625 Test Loss: 0.888 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 13 cost time: 0.7171139717102051
Epoch: 13, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
Validation loss decreased (-0.624991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.6743361949920654
Epoch: 14, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.822 Vali Acc: 0.750 Test Loss: 0.822 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.726172924041748
Epoch: 15, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.7354416847229004
Epoch: 16, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.806 Vali Acc: 0.775 Test Loss: 0.806 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.6809597015380859
Epoch: 17, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.821 Vali Acc: 0.725 Test Loss: 0.821 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8557097911834717
Epoch: 18, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.833 Vali Acc: 0.725 Test Loss: 0.833 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7341527938842773
Epoch: 19, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.842 Vali Acc: 0.725 Test Loss: 0.842 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8152256011962891
Epoch: 20, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.848 Vali Acc: 0.700 Test Loss: 0.848 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7251641750335693
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.849 Vali Acc: 0.700 Test Loss: 0.849 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7021973133087158
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.847 Vali Acc: 0.725 Test Loss: 0.847 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7973840236663818
Epoch: 23, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.845 Vali Acc: 0.750 Test Loss: 0.845 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6707339286804199
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.840 Vali Acc: 0.750 Test Loss: 0.840 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8318896293640137
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.835 Vali Acc: 0.750 Test Loss: 0.835 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7542626857757568
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.831 Vali Acc: 0.775 Test Loss: 0.831 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 151108
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.478339433670044
Epoch: 1, Steps: 3 | Train Loss: 1.516 Vali Loss: 1.500 Vali Acc: 0.200 Test Loss: 1.500 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.71299147605896
Epoch: 2, Steps: 3 | Train Loss: 1.558 Vali Loss: 1.473 Vali Acc: 0.325 Test Loss: 1.473 Test Acc: 0.325
Validation loss decreased (-0.199985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.7509491443634033
Epoch: 3, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.439 Vali Acc: 0.425 Test Loss: 1.439 Test Acc: 0.425
Validation loss decreased (-0.324985 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.6123406887054443
Epoch: 4, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.392 Vali Acc: 0.400 Test Loss: 1.392 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8188247680664062
Epoch: 5, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.343 Vali Acc: 0.425 Test Loss: 1.343 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.7492232322692871
Epoch: 6, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.300 Vali Acc: 0.475 Test Loss: 1.300 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.6805558204650879
Epoch: 7, Steps: 3 | Train Loss: 0.677 Vali Loss: 1.249 Vali Acc: 0.525 Test Loss: 1.249 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.7041795253753662
Epoch: 8, Steps: 3 | Train Loss: 0.669 Vali Loss: 1.208 Vali Acc: 0.525 Test Loss: 1.208 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.8040075302124023
Epoch: 9, Steps: 3 | Train Loss: 0.514 Vali Loss: 1.170 Vali Acc: 0.550 Test Loss: 1.170 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.72283935546875
Epoch: 10, Steps: 3 | Train Loss: 0.397 Vali Loss: 1.123 Vali Acc: 0.575 Test Loss: 1.123 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.8325095176696777
Epoch: 11, Steps: 3 | Train Loss: 0.360 Vali Loss: 1.094 Vali Acc: 0.575 Test Loss: 1.094 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.7650079727172852
Epoch: 12, Steps: 3 | Train Loss: 0.262 Vali Loss: 1.071 Vali Acc: 0.625 Test Loss: 1.071 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.7572705745697021
Epoch: 13, Steps: 3 | Train Loss: 0.224 Vali Loss: 1.044 Vali Acc: 0.625 Test Loss: 1.044 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 14 cost time: 0.6965920925140381
Epoch: 14, Steps: 3 | Train Loss: 0.185 Vali Loss: 1.012 Vali Acc: 0.650 Test Loss: 1.012 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.7835724353790283
Epoch: 15, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.993 Vali Acc: 0.650 Test Loss: 0.993 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 0.7953169345855713
Epoch: 16, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.003 Vali Acc: 0.675 Test Loss: 1.003 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 0.8298583030700684
Epoch: 17, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.022 Vali Acc: 0.675 Test Loss: 1.022 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7981283664703369
Epoch: 18, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.049 Vali Acc: 0.675 Test Loss: 1.049 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.752723217010498
Epoch: 19, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.061 Vali Acc: 0.675 Test Loss: 1.061 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7125563621520996
Epoch: 20, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.060 Vali Acc: 0.675 Test Loss: 1.060 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8273177146911621
Epoch: 21, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.054 Vali Acc: 0.700 Test Loss: 1.054 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699989).  Saving model ...
Epoch: 22 cost time: 0.7122058868408203
Epoch: 22, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.046 Vali Acc: 0.700 Test Loss: 1.046 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 0.781090259552002
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 24 cost time: 0.8449690341949463
Epoch: 24, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 25 cost time: 0.8400349617004395
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.035 Vali Acc: 0.700 Test Loss: 1.035 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8434298038482666
Epoch: 26, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6517579555511475
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.039 Vali Acc: 0.700 Test Loss: 1.039 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7476489543914795
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6890432834625244
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8083169460296631
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7576737403869629
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.055 Vali Acc: 0.700 Test Loss: 1.055 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7259459495544434
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.057 Vali Acc: 0.700 Test Loss: 1.057 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7466590404510498
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.061 Vali Acc: 0.700 Test Loss: 1.061 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7164828777313232
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.063 Vali Acc: 0.700 Test Loss: 1.063 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 139012
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5843610763549805
Epoch: 1, Steps: 3 | Train Loss: 1.539 Vali Loss: 1.466 Vali Acc: 0.275 Test Loss: 1.466 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.7040004730224609
Epoch: 2, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.456 Vali Acc: 0.275 Test Loss: 1.456 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.6587305068969727
Epoch: 3, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.429 Vali Acc: 0.400 Test Loss: 1.429 Test Acc: 0.400
Validation loss decreased (-0.274985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.6250944137573242
Epoch: 4, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.387 Vali Acc: 0.400 Test Loss: 1.387 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.6674211025238037
Epoch: 5, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.341 Vali Acc: 0.400 Test Loss: 1.341 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.5934131145477295
Epoch: 6, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.300 Vali Acc: 0.525 Test Loss: 1.300 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.6941754817962646
Epoch: 7, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.256 Vali Acc: 0.550 Test Loss: 1.256 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 0.6698994636535645
Epoch: 8, Steps: 3 | Train Loss: 0.778 Vali Loss: 1.220 Vali Acc: 0.525 Test Loss: 1.220 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6800825595855713
Epoch: 9, Steps: 3 | Train Loss: 0.751 Vali Loss: 1.188 Vali Acc: 0.550 Test Loss: 1.188 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.6431567668914795
Epoch: 10, Steps: 3 | Train Loss: 0.592 Vali Loss: 1.156 Vali Acc: 0.600 Test Loss: 1.156 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 0.7629063129425049
Epoch: 11, Steps: 3 | Train Loss: 0.516 Vali Loss: 1.131 Vali Acc: 0.650 Test Loss: 1.131 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.6429717540740967
Epoch: 12, Steps: 3 | Train Loss: 0.370 Vali Loss: 1.115 Vali Acc: 0.625 Test Loss: 1.115 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6600031852722168
Epoch: 13, Steps: 3 | Train Loss: 0.305 Vali Loss: 1.086 Vali Acc: 0.650 Test Loss: 1.086 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 0.7824091911315918
Epoch: 14, Steps: 3 | Train Loss: 0.248 Vali Loss: 1.064 Vali Acc: 0.650 Test Loss: 1.064 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 0.8503401279449463
Epoch: 15, Steps: 3 | Train Loss: 0.202 Vali Loss: 1.044 Vali Acc: 0.675 Test Loss: 1.044 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 16 cost time: 0.6453492641448975
Epoch: 16, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.027 Vali Acc: 0.675 Test Loss: 1.027 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 0.6986911296844482
Epoch: 17, Steps: 3 | Train Loss: 0.121 Vali Loss: 1.013 Vali Acc: 0.675 Test Loss: 1.013 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 0.6505081653594971
Epoch: 18, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 19 cost time: 0.7220897674560547
Epoch: 19, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.022 Vali Acc: 0.700 Test Loss: 1.022 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7508621215820312
Epoch: 20, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7013874053955078
Epoch: 21, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.053 Vali Acc: 0.700 Test Loss: 1.053 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7895262241363525
Epoch: 22, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.065 Vali Acc: 0.700 Test Loss: 1.065 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6974804401397705
Epoch: 23, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.070 Vali Acc: 0.700 Test Loss: 1.070 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7243537902832031
Epoch: 24, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.077 Vali Acc: 0.700 Test Loss: 1.077 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.746131420135498
Epoch: 25, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.081 Vali Acc: 0.700 Test Loss: 1.081 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7714054584503174
Epoch: 26, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.082 Vali Acc: 0.700 Test Loss: 1.082 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8026371002197266
Epoch: 27, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.082 Vali Acc: 0.700 Test Loss: 1.082 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7095382213592529
Epoch: 28, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.080 Vali Acc: 0.700 Test Loss: 1.080 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 131460
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.496309757232666
Epoch: 1, Steps: 3 | Train Loss: 1.537 Vali Loss: 1.511 Vali Acc: 0.275 Test Loss: 1.511 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.6573567390441895
Epoch: 2, Steps: 3 | Train Loss: 1.490 Vali Loss: 1.491 Vali Acc: 0.275 Test Loss: 1.491 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.5615601539611816
Epoch: 3, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.472 Vali Acc: 0.300 Test Loss: 1.472 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 0.590632438659668
Epoch: 4, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.448 Vali Acc: 0.350 Test Loss: 1.448 Test Acc: 0.350
Validation loss decreased (-0.299985 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.5672087669372559
Epoch: 5, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.417 Vali Acc: 0.325 Test Loss: 1.417 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6379973888397217
Epoch: 6, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.389 Vali Acc: 0.375 Test Loss: 1.389 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.5817115306854248
Epoch: 7, Steps: 3 | Train Loss: 1.014 Vali Loss: 1.363 Vali Acc: 0.425 Test Loss: 1.363 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 8 cost time: 0.5477900505065918
Epoch: 8, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.340 Vali Acc: 0.450 Test Loss: 1.340 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.5831754207611084
Epoch: 9, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.320 Vali Acc: 0.475 Test Loss: 1.320 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.8338797092437744
Epoch: 10, Steps: 3 | Train Loss: 0.735 Vali Loss: 1.300 Vali Acc: 0.500 Test Loss: 1.300 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.65964674949646
Epoch: 11, Steps: 3 | Train Loss: 0.699 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.7477314472198486
Epoch: 12, Steps: 3 | Train Loss: 0.653 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.6206927299499512
Epoch: 13, Steps: 3 | Train Loss: 0.525 Vali Loss: 1.234 Vali Acc: 0.550 Test Loss: 1.234 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 0.6406066417694092
Epoch: 14, Steps: 3 | Train Loss: 0.495 Vali Loss: 1.212 Vali Acc: 0.550 Test Loss: 1.212 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.6856677532196045
Epoch: 15, Steps: 3 | Train Loss: 0.394 Vali Loss: 1.191 Vali Acc: 0.600 Test Loss: 1.191 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 0.613473653793335
Epoch: 16, Steps: 3 | Train Loss: 0.356 Vali Loss: 1.181 Vali Acc: 0.600 Test Loss: 1.181 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 17 cost time: 0.6140508651733398
Epoch: 17, Steps: 3 | Train Loss: 0.345 Vali Loss: 1.172 Vali Acc: 0.625 Test Loss: 1.172 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 18 cost time: 0.6703474521636963
Epoch: 18, Steps: 3 | Train Loss: 0.242 Vali Loss: 1.168 Vali Acc: 0.625 Test Loss: 1.168 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 19 cost time: 0.7161524295806885
Epoch: 19, Steps: 3 | Train Loss: 0.219 Vali Loss: 1.162 Vali Acc: 0.625 Test Loss: 1.162 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 20 cost time: 0.7024281024932861
Epoch: 20, Steps: 3 | Train Loss: 0.168 Vali Loss: 1.162 Vali Acc: 0.625 Test Loss: 1.162 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7527837753295898
Epoch: 21, Steps: 3 | Train Loss: 0.141 Vali Loss: 1.171 Vali Acc: 0.650 Test Loss: 1.171 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 22 cost time: 0.7843194007873535
Epoch: 22, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.182 Vali Acc: 0.650 Test Loss: 1.182 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6150126457214355
Epoch: 23, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.188 Vali Acc: 0.675 Test Loss: 1.188 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 24 cost time: 0.7494106292724609
Epoch: 24, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.197 Vali Acc: 0.700 Test Loss: 1.197 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699988).  Saving model ...
Epoch: 25 cost time: 0.7212905883789062
Epoch: 25, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.204 Vali Acc: 0.700 Test Loss: 1.204 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6230483055114746
Epoch: 26, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.206 Vali Acc: 0.700 Test Loss: 1.206 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6820681095123291
Epoch: 27, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.209 Vali Acc: 0.700 Test Loss: 1.209 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6743631362915039
Epoch: 28, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.208 Vali Acc: 0.700 Test Loss: 1.208 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6911337375640869
Epoch: 29, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.206 Vali Acc: 0.700 Test Loss: 1.206 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6556830406188965
Epoch: 30, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.205 Vali Acc: 0.700 Test Loss: 1.205 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7550196647644043
Epoch: 31, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.205 Vali Acc: 0.700 Test Loss: 1.205 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7262427806854248
Epoch: 32, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.210 Vali Acc: 0.700 Test Loss: 1.210 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7271666526794434
Epoch: 33, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.215 Vali Acc: 0.700 Test Loss: 1.215 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6943621635437012
Epoch: 34, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.222 Vali Acc: 0.700 Test Loss: 1.222 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 119492
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.516211748123169
Epoch: 1, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.439 Vali Acc: 0.200 Test Loss: 1.439 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.7702748775482178
Epoch: 2, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.424 Vali Acc: 0.225 Test Loss: 1.424 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.6705529689788818
Epoch: 3, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.412 Vali Acc: 0.250 Test Loss: 1.412 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.632474422454834
Epoch: 4, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.400 Vali Acc: 0.275 Test Loss: 1.400 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.5528240203857422
Epoch: 5, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.385 Vali Acc: 0.300 Test Loss: 1.385 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.6083984375
Epoch: 6, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.368 Vali Acc: 0.325 Test Loss: 1.368 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.6791903972625732
Epoch: 7, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.347 Vali Acc: 0.350 Test Loss: 1.347 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 8 cost time: 0.6416206359863281
Epoch: 8, Steps: 3 | Train Loss: 0.805 Vali Loss: 1.326 Vali Acc: 0.350 Test Loss: 1.326 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 9 cost time: 0.7207796573638916
Epoch: 9, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.306 Vali Acc: 0.375 Test Loss: 1.306 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 0.5663638114929199
Epoch: 10, Steps: 3 | Train Loss: 0.693 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.6618945598602295
Epoch: 11, Steps: 3 | Train Loss: 0.569 Vali Loss: 1.263 Vali Acc: 0.450 Test Loss: 1.263 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.6228549480438232
Epoch: 12, Steps: 3 | Train Loss: 0.542 Vali Loss: 1.246 Vali Acc: 0.475 Test Loss: 1.246 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 0.6074988842010498
Epoch: 13, Steps: 3 | Train Loss: 0.540 Vali Loss: 1.234 Vali Acc: 0.475 Test Loss: 1.234 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 0.5885710716247559
Epoch: 14, Steps: 3 | Train Loss: 0.505 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 0.6624863147735596
Epoch: 15, Steps: 3 | Train Loss: 0.394 Vali Loss: 1.207 Vali Acc: 0.550 Test Loss: 1.207 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 16 cost time: 0.693321704864502
Epoch: 16, Steps: 3 | Train Loss: 0.408 Vali Loss: 1.190 Vali Acc: 0.550 Test Loss: 1.190 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 17 cost time: 0.6150860786437988
Epoch: 17, Steps: 3 | Train Loss: 0.319 Vali Loss: 1.181 Vali Acc: 0.550 Test Loss: 1.181 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 18 cost time: 0.590254545211792
Epoch: 18, Steps: 3 | Train Loss: 0.293 Vali Loss: 1.176 Vali Acc: 0.550 Test Loss: 1.176 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 19 cost time: 0.6644177436828613
Epoch: 19, Steps: 3 | Train Loss: 0.226 Vali Loss: 1.170 Vali Acc: 0.575 Test Loss: 1.170 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.6712870597839355
Epoch: 20, Steps: 3 | Train Loss: 0.176 Vali Loss: 1.169 Vali Acc: 0.575 Test Loss: 1.169 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.6679465770721436
Epoch: 21, Steps: 3 | Train Loss: 0.165 Vali Loss: 1.176 Vali Acc: 0.600 Test Loss: 1.176 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 0.7158713340759277
Epoch: 22, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.185 Vali Acc: 0.625 Test Loss: 1.185 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 23 cost time: 0.6604282855987549
Epoch: 23, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.198 Vali Acc: 0.625 Test Loss: 1.198 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6838819980621338
Epoch: 24, Steps: 3 | Train Loss: 0.079 Vali Loss: 1.202 Vali Acc: 0.650 Test Loss: 1.202 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 25 cost time: 0.7160794734954834
Epoch: 25, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.205 Vali Acc: 0.675 Test Loss: 1.205 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 26 cost time: 0.6033761501312256
Epoch: 26, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.200 Vali Acc: 0.675 Test Loss: 1.200 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 27 cost time: 0.6694490909576416
Epoch: 27, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.204 Vali Acc: 0.675 Test Loss: 1.204 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6732332706451416
Epoch: 28, Steps: 3 | Train Loss: 0.055 Vali Loss: 1.204 Vali Acc: 0.675 Test Loss: 1.204 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7849743366241455
Epoch: 29, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.207 Vali Acc: 0.675 Test Loss: 1.207 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6614139080047607
Epoch: 30, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.207 Vali Acc: 0.675 Test Loss: 1.207 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6375405788421631
Epoch: 31, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.209 Vali Acc: 0.675 Test Loss: 1.209 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.70713210105896
Epoch: 32, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.213 Vali Acc: 0.675 Test Loss: 1.213 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6357250213623047
Epoch: 33, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.220 Vali Acc: 0.675 Test Loss: 1.220 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7515847682952881
Epoch: 34, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.221 Vali Acc: 0.675 Test Loss: 1.221 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8145923614501953
Epoch: 35, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.224 Vali Acc: 0.675 Test Loss: 1.224 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7149403095245361
Epoch: 36, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.226 Vali Acc: 0.675 Test Loss: 1.226 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 116740
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.449219226837158
Epoch: 1, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.365 Vali Acc: 0.225 Test Loss: 1.365 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.651881217956543
Epoch: 2, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.346 Vali Acc: 0.225 Test Loss: 1.346 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.6898512840270996
Epoch: 3, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.327 Vali Acc: 0.250 Test Loss: 1.327 Test Acc: 0.250
Validation loss decreased (-0.224987 --> -0.249987).  Saving model ...
Epoch: 4 cost time: 0.655876874923706
Epoch: 4, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.306 Vali Acc: 0.325 Test Loss: 1.306 Test Acc: 0.325
Validation loss decreased (-0.249987 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.6706554889678955
Epoch: 5, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.6236343383789062
Epoch: 6, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.254 Vali Acc: 0.400 Test Loss: 1.254 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.5829102993011475
Epoch: 7, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.7241973876953125
Epoch: 8, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.210 Vali Acc: 0.425 Test Loss: 1.210 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 9 cost time: 0.6341407299041748
Epoch: 9, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.190 Vali Acc: 0.450 Test Loss: 1.190 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 0.7388815879821777
Epoch: 10, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.6144835948944092
Epoch: 11, Steps: 3 | Train Loss: 0.851 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.5660965442657471
Epoch: 12, Steps: 3 | Train Loss: 0.716 Vali Loss: 1.145 Vali Acc: 0.525 Test Loss: 1.145 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 13 cost time: 0.6958563327789307
Epoch: 13, Steps: 3 | Train Loss: 0.710 Vali Loss: 1.137 Vali Acc: 0.525 Test Loss: 1.137 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 14 cost time: 0.660130500793457
Epoch: 14, Steps: 3 | Train Loss: 0.614 Vali Loss: 1.132 Vali Acc: 0.550 Test Loss: 1.132 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 15 cost time: 0.5607407093048096
Epoch: 15, Steps: 3 | Train Loss: 0.549 Vali Loss: 1.122 Vali Acc: 0.550 Test Loss: 1.122 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 16 cost time: 0.5951018333435059
Epoch: 16, Steps: 3 | Train Loss: 0.528 Vali Loss: 1.115 Vali Acc: 0.600 Test Loss: 1.115 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.6472113132476807
Epoch: 17, Steps: 3 | Train Loss: 0.505 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.561722993850708
Epoch: 18, Steps: 3 | Train Loss: 0.427 Vali Loss: 1.103 Vali Acc: 0.600 Test Loss: 1.103 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.6117374897003174
Epoch: 19, Steps: 3 | Train Loss: 0.415 Vali Loss: 1.101 Vali Acc: 0.600 Test Loss: 1.101 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.6518373489379883
Epoch: 20, Steps: 3 | Train Loss: 0.351 Vali Loss: 1.100 Vali Acc: 0.575 Test Loss: 1.100 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7942097187042236
Epoch: 21, Steps: 3 | Train Loss: 0.285 Vali Loss: 1.101 Vali Acc: 0.575 Test Loss: 1.101 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.655982494354248
Epoch: 22, Steps: 3 | Train Loss: 0.285 Vali Loss: 1.109 Vali Acc: 0.575 Test Loss: 1.109 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7781460285186768
Epoch: 23, Steps: 3 | Train Loss: 0.237 Vali Loss: 1.115 Vali Acc: 0.625 Test Loss: 1.115 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 24 cost time: 0.7201046943664551
Epoch: 24, Steps: 3 | Train Loss: 0.195 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7983479499816895
Epoch: 25, Steps: 3 | Train Loss: 0.169 Vali Loss: 1.121 Vali Acc: 0.625 Test Loss: 1.121 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6776375770568848
Epoch: 26, Steps: 3 | Train Loss: 0.132 Vali Loss: 1.121 Vali Acc: 0.625 Test Loss: 1.121 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7918610572814941
Epoch: 27, Steps: 3 | Train Loss: 0.117 Vali Loss: 1.122 Vali Acc: 0.625 Test Loss: 1.122 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7276015281677246
Epoch: 28, Steps: 3 | Train Loss: 0.126 Vali Loss: 1.123 Vali Acc: 0.650 Test Loss: 1.123 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 29 cost time: 0.6044566631317139
Epoch: 29, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.129 Vali Acc: 0.650 Test Loss: 1.129 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.67411208152771
Epoch: 30, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.132 Vali Acc: 0.650 Test Loss: 1.132 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6552376747131348
Epoch: 31, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.130 Vali Acc: 0.650 Test Loss: 1.130 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7546334266662598
Epoch: 32, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.132 Vali Acc: 0.675 Test Loss: 1.132 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 33 cost time: 0.8237762451171875
Epoch: 33, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.133 Vali Acc: 0.675 Test Loss: 1.133 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.858574390411377
Epoch: 34, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.136 Vali Acc: 0.675 Test Loss: 1.136 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7628185749053955
Epoch: 35, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.143 Vali Acc: 0.675 Test Loss: 1.143 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7276103496551514
Epoch: 36, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.148 Vali Acc: 0.675 Test Loss: 1.148 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7578520774841309
Epoch: 37, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.152 Vali Acc: 0.675 Test Loss: 1.152 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7636058330535889
Epoch: 38, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.151 Vali Acc: 0.675 Test Loss: 1.151 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7205929756164551
Epoch: 39, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.151 Vali Acc: 0.675 Test Loss: 1.151 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7632613182067871
Epoch: 40, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.153 Vali Acc: 0.675 Test Loss: 1.153 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7847154140472412
Epoch: 41, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.155 Vali Acc: 0.675 Test Loss: 1.155 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7178773880004883
Epoch: 42, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.158 Vali Acc: 0.675 Test Loss: 1.158 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df256_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 112452
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4594686031341553
Epoch: 1, Steps: 3 | Train Loss: 1.638 Vali Loss: 1.443 Vali Acc: 0.225 Test Loss: 1.443 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.8552610874176025
Epoch: 2, Steps: 3 | Train Loss: 1.568 Vali Loss: 1.412 Vali Acc: 0.200 Test Loss: 1.412 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7558412551879883
Epoch: 3, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.380 Vali Acc: 0.325 Test Loss: 1.380 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.7362949848175049
Epoch: 4, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.327 Vali Acc: 0.450 Test Loss: 1.327 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.8264989852905273
Epoch: 5, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.242 Vali Acc: 0.450 Test Loss: 1.242 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.7298414707183838
Epoch: 6, Steps: 3 | Train Loss: 0.647 Vali Loss: 1.165 Vali Acc: 0.475 Test Loss: 1.165 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.8263852596282959
Epoch: 7, Steps: 3 | Train Loss: 0.537 Vali Loss: 1.111 Vali Acc: 0.475 Test Loss: 1.111 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474989).  Saving model ...
Epoch: 8 cost time: 0.8343102931976318
Epoch: 8, Steps: 3 | Train Loss: 0.452 Vali Loss: 1.071 Vali Acc: 0.625 Test Loss: 1.071 Test Acc: 0.625
Validation loss decreased (-0.474989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.8487982749938965
Epoch: 9, Steps: 3 | Train Loss: 0.302 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 10 cost time: 0.7938852310180664
Epoch: 10, Steps: 3 | Train Loss: 0.222 Vali Loss: 1.023 Vali Acc: 0.650 Test Loss: 1.023 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8599853515625
Epoch: 11, Steps: 3 | Train Loss: 0.150 Vali Loss: 1.009 Vali Acc: 0.725 Test Loss: 1.009 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.7854220867156982
Epoch: 12, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.969 Vali Acc: 0.775 Test Loss: 0.969 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 13 cost time: 0.8455467224121094
Epoch: 13, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.963 Vali Acc: 0.725 Test Loss: 0.963 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7978537082672119
Epoch: 14, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.971 Vali Acc: 0.725 Test Loss: 0.971 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8059155941009521
Epoch: 15, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.804917573928833
Epoch: 16, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.970 Vali Acc: 0.775 Test Loss: 0.970 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9562058448791504
Epoch: 17, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.976 Vali Acc: 0.775 Test Loss: 0.976 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8560152053833008
Epoch: 18, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.988 Vali Acc: 0.750 Test Loss: 0.988 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9894900321960449
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.999 Vali Acc: 0.750 Test Loss: 0.999 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7815978527069092
Epoch: 20, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.010 Vali Acc: 0.750 Test Loss: 1.010 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7784194946289062
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.015 Vali Acc: 0.750 Test Loss: 1.015 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.815239667892456
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.016 Vali Acc: 0.750 Test Loss: 1.016 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 144068
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.543360710144043
Epoch: 1, Steps: 3 | Train Loss: 1.513 Vali Loss: 1.522 Vali Acc: 0.225 Test Loss: 1.522 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.8209202289581299
Epoch: 2, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.434 Vali Acc: 0.250 Test Loss: 1.434 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.8289322853088379
Epoch: 3, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
Validation loss decreased (-0.249986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.7688579559326172
Epoch: 4, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.240 Vali Acc: 0.525 Test Loss: 1.240 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.7797279357910156
Epoch: 5, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.162 Vali Acc: 0.525 Test Loss: 1.162 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.8081367015838623
Epoch: 6, Steps: 3 | Train Loss: 0.795 Vali Loss: 1.107 Vali Acc: 0.550 Test Loss: 1.107 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 0.8114218711853027
Epoch: 7, Steps: 3 | Train Loss: 0.780 Vali Loss: 1.052 Vali Acc: 0.575 Test Loss: 1.052 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.7897772789001465
Epoch: 8, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
Validation loss decreased (-0.574989 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 0.8453898429870605
Epoch: 9, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.956 Vali Acc: 0.650 Test Loss: 0.956 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8483240604400635
Epoch: 10, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 0.8453600406646729
Epoch: 11, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.837552547454834
Epoch: 12, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.877 Vali Acc: 0.675 Test Loss: 0.877 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7748763561248779
Epoch: 13, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.856 Vali Acc: 0.725 Test Loss: 0.856 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9112992286682129
Epoch: 14, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.836 Vali Acc: 0.725 Test Loss: 0.836 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7169828414916992
Epoch: 15, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.823 Vali Acc: 0.725 Test Loss: 0.823 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7350742816925049
Epoch: 16, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.815 Vali Acc: 0.725 Test Loss: 0.815 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6712703704833984
Epoch: 17, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.815 Vali Acc: 0.725 Test Loss: 0.815 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7364516258239746
Epoch: 18, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.832 Vali Acc: 0.725 Test Loss: 0.832 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7463462352752686
Epoch: 19, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.852 Vali Acc: 0.725 Test Loss: 0.852 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7204279899597168
Epoch: 20, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.860 Vali Acc: 0.725 Test Loss: 0.860 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 118084
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.364623546600342
Epoch: 1, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.330 Vali Acc: 0.325 Test Loss: 1.330 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 0.8173325061798096
Epoch: 2, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.299 Vali Acc: 0.375 Test Loss: 1.299 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.7327759265899658
Epoch: 3, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.7799901962280273
Epoch: 4, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.224 Vali Acc: 0.550 Test Loss: 1.224 Test Acc: 0.550
Validation loss decreased (-0.399987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.8627619743347168
Epoch: 5, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.176 Vali Acc: 0.550 Test Loss: 1.176 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.8927385807037354
Epoch: 6, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.127 Vali Acc: 0.575 Test Loss: 1.127 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.8376510143280029
Epoch: 7, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.086 Vali Acc: 0.625 Test Loss: 1.086 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 0.8686161041259766
Epoch: 8, Steps: 3 | Train Loss: 0.616 Vali Loss: 1.048 Vali Acc: 0.625 Test Loss: 1.048 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 0.8768370151519775
Epoch: 9, Steps: 3 | Train Loss: 0.531 Vali Loss: 1.006 Vali Acc: 0.625 Test Loss: 1.006 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.9299678802490234
Epoch: 10, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.967 Vali Acc: 0.625 Test Loss: 0.967 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.9487380981445312
Epoch: 11, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.942 Vali Acc: 0.650 Test Loss: 0.942 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 12 cost time: 0.9379565715789795
Epoch: 12, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.934 Vali Acc: 0.650 Test Loss: 0.934 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 13 cost time: 0.8908021450042725
Epoch: 13, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.940 Vali Acc: 0.675 Test Loss: 0.940 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 14 cost time: 0.7895073890686035
Epoch: 14, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.932 Vali Acc: 0.675 Test Loss: 0.932 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 15 cost time: 0.8477814197540283
Epoch: 15, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.913 Vali Acc: 0.675 Test Loss: 0.913 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 16 cost time: 0.825833797454834
Epoch: 16, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.904 Vali Acc: 0.675 Test Loss: 0.904 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 17 cost time: 0.84360671043396
Epoch: 17, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.896 Vali Acc: 0.675 Test Loss: 0.896 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 18 cost time: 0.8678934574127197
Epoch: 18, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.898 Vali Acc: 0.700 Test Loss: 0.898 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 19 cost time: 0.7254860401153564
Epoch: 19, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.903 Vali Acc: 0.700 Test Loss: 0.903 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7683365345001221
Epoch: 20, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.922 Vali Acc: 0.700 Test Loss: 0.922 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8386557102203369
Epoch: 21, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.943 Vali Acc: 0.700 Test Loss: 0.943 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7554090023040771
Epoch: 22, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.960 Vali Acc: 0.700 Test Loss: 0.960 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8022158145904541
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.973 Vali Acc: 0.700 Test Loss: 0.973 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9277710914611816
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.979 Vali Acc: 0.725 Test Loss: 0.979 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724990).  Saving model ...
Epoch: 25 cost time: 0.8967299461364746
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.978 Vali Acc: 0.725 Test Loss: 0.978 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 26 cost time: 0.9370298385620117
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.972 Vali Acc: 0.725 Test Loss: 0.972 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 27 cost time: 0.9814295768737793
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.968 Vali Acc: 0.725 Test Loss: 0.968 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 28 cost time: 0.7893774509429932
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.969 Vali Acc: 0.725 Test Loss: 0.969 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8312830924987793
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.971 Vali Acc: 0.700 Test Loss: 0.971 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9059662818908691
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.972 Vali Acc: 0.700 Test Loss: 0.972 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8919243812561035
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.975 Vali Acc: 0.700 Test Loss: 0.975 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9647359848022461
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.976 Vali Acc: 0.700 Test Loss: 0.976 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8512372970581055
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.977 Vali Acc: 0.700 Test Loss: 0.977 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7764761447906494
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.977 Vali Acc: 0.725 Test Loss: 0.977 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7324507236480713
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.978 Vali Acc: 0.725 Test Loss: 0.978 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8508899211883545
Epoch: 36, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.979 Vali Acc: 0.725 Test Loss: 0.979 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7127225399017334
Epoch: 37, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.979 Vali Acc: 0.725 Test Loss: 0.979 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 105988
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2693896293640137
Epoch: 1, Steps: 3 | Train Loss: 1.568 Vali Loss: 1.389 Vali Acc: 0.250 Test Loss: 1.389 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.6148366928100586
Epoch: 2, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.373 Vali Acc: 0.325 Test Loss: 1.373 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.5458559989929199
Epoch: 3, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.346 Vali Acc: 0.325 Test Loss: 1.346 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.6285345554351807
Epoch: 4, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.301 Vali Acc: 0.375 Test Loss: 1.301 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.5965714454650879
Epoch: 5, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.254 Vali Acc: 0.450 Test Loss: 1.254 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.6534106731414795
Epoch: 6, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.214 Vali Acc: 0.525 Test Loss: 1.214 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.634446382522583
Epoch: 7, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7062523365020752
Epoch: 8, Steps: 3 | Train Loss: 0.762 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6646275520324707
Epoch: 9, Steps: 3 | Train Loss: 0.639 Vali Loss: 1.106 Vali Acc: 0.525 Test Loss: 1.106 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 0.6127357482910156
Epoch: 10, Steps: 3 | Train Loss: 0.541 Vali Loss: 1.068 Vali Acc: 0.575 Test Loss: 1.068 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.635242223739624
Epoch: 11, Steps: 3 | Train Loss: 0.485 Vali Loss: 1.041 Vali Acc: 0.575 Test Loss: 1.041 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 12 cost time: 0.6119935512542725
Epoch: 12, Steps: 3 | Train Loss: 0.388 Vali Loss: 1.024 Vali Acc: 0.550 Test Loss: 1.024 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6538858413696289
Epoch: 13, Steps: 3 | Train Loss: 0.374 Vali Loss: 1.019 Vali Acc: 0.575 Test Loss: 1.019 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 14 cost time: 0.6436641216278076
Epoch: 14, Steps: 3 | Train Loss: 0.271 Vali Loss: 1.014 Vali Acc: 0.575 Test Loss: 1.014 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 15 cost time: 0.5841116905212402
Epoch: 15, Steps: 3 | Train Loss: 0.228 Vali Loss: 1.004 Vali Acc: 0.575 Test Loss: 1.004 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 16 cost time: 0.6577541828155518
Epoch: 16, Steps: 3 | Train Loss: 0.163 Vali Loss: 1.000 Vali Acc: 0.625 Test Loss: 1.000 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624990).  Saving model ...
Epoch: 17 cost time: 0.6439542770385742
Epoch: 17, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.989 Vali Acc: 0.625 Test Loss: 0.989 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 0.6429359912872314
Epoch: 18, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.976 Vali Acc: 0.650 Test Loss: 0.976 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 19 cost time: 0.6865286827087402
Epoch: 19, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.973 Vali Acc: 0.675 Test Loss: 0.973 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 20 cost time: 0.6032459735870361
Epoch: 20, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.984 Vali Acc: 0.675 Test Loss: 0.984 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6708812713623047
Epoch: 21, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.991 Vali Acc: 0.675 Test Loss: 0.991 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6926586627960205
Epoch: 22, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.003 Vali Acc: 0.675 Test Loss: 1.003 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6543691158294678
Epoch: 23, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.009 Vali Acc: 0.675 Test Loss: 1.009 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6643798351287842
Epoch: 24, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.018 Vali Acc: 0.675 Test Loss: 1.018 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6112921237945557
Epoch: 25, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7396974563598633
Epoch: 26, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.023 Vali Acc: 0.675 Test Loss: 1.023 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6300911903381348
Epoch: 27, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.026 Vali Acc: 0.675 Test Loss: 1.026 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6055247783660889
Epoch: 28, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.032 Vali Acc: 0.675 Test Loss: 1.032 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.640357255935669
Epoch: 29, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.033 Vali Acc: 0.675 Test Loss: 1.033 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 98436
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3247833251953125
Epoch: 1, Steps: 3 | Train Loss: 1.641 Vali Loss: 1.460 Vali Acc: 0.275 Test Loss: 1.460 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.5943317413330078
Epoch: 2, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.429 Vali Acc: 0.275 Test Loss: 1.429 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.584052562713623
Epoch: 3, Steps: 3 | Train Loss: 1.471 Vali Loss: 1.397 Vali Acc: 0.325 Test Loss: 1.397 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.7445359230041504
Epoch: 4, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.361 Vali Acc: 0.400 Test Loss: 1.361 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.6039383411407471
Epoch: 5, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.328 Vali Acc: 0.450 Test Loss: 1.328 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.6271390914916992
Epoch: 6, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.293 Vali Acc: 0.450 Test Loss: 1.293 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.6015779972076416
Epoch: 7, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.261 Vali Acc: 0.500 Test Loss: 1.261 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.7060725688934326
Epoch: 8, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.232 Vali Acc: 0.475 Test Loss: 1.232 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.646310567855835
Epoch: 9, Steps: 3 | Train Loss: 0.860 Vali Loss: 1.210 Vali Acc: 0.525 Test Loss: 1.210 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 0.6538591384887695
Epoch: 10, Steps: 3 | Train Loss: 0.761 Vali Loss: 1.187 Vali Acc: 0.525 Test Loss: 1.187 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.6611149311065674
Epoch: 11, Steps: 3 | Train Loss: 0.735 Vali Loss: 1.164 Vali Acc: 0.575 Test Loss: 1.164 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 0.6223201751708984
Epoch: 12, Steps: 3 | Train Loss: 0.644 Vali Loss: 1.142 Vali Acc: 0.575 Test Loss: 1.142 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.5930242538452148
Epoch: 13, Steps: 3 | Train Loss: 0.571 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.6194615364074707
Epoch: 14, Steps: 3 | Train Loss: 0.448 Vali Loss: 1.103 Vali Acc: 0.600 Test Loss: 1.103 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.6563992500305176
Epoch: 15, Steps: 3 | Train Loss: 0.431 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.7145638465881348
Epoch: 16, Steps: 3 | Train Loss: 0.428 Vali Loss: 1.075 Vali Acc: 0.625 Test Loss: 1.075 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 0.651228666305542
Epoch: 17, Steps: 3 | Train Loss: 0.317 Vali Loss: 1.063 Vali Acc: 0.650 Test Loss: 1.063 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 0.700294017791748
Epoch: 18, Steps: 3 | Train Loss: 0.277 Vali Loss: 1.056 Vali Acc: 0.650 Test Loss: 1.056 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 0.7529768943786621
Epoch: 19, Steps: 3 | Train Loss: 0.190 Vali Loss: 1.052 Vali Acc: 0.650 Test Loss: 1.052 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.6140236854553223
Epoch: 20, Steps: 3 | Train Loss: 0.171 Vali Loss: 1.048 Vali Acc: 0.650 Test Loss: 1.048 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 21 cost time: 0.6526129245758057
Epoch: 21, Steps: 3 | Train Loss: 0.142 Vali Loss: 1.050 Vali Acc: 0.675 Test Loss: 1.050 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 22 cost time: 0.6144123077392578
Epoch: 22, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6200859546661377
Epoch: 23, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.053 Vali Acc: 0.700 Test Loss: 1.053 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699989).  Saving model ...
Epoch: 24 cost time: 0.7167093753814697
Epoch: 24, Steps: 3 | Train Loss: 0.079 Vali Loss: 1.060 Vali Acc: 0.700 Test Loss: 1.060 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7752852439880371
Epoch: 25, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.065 Vali Acc: 0.700 Test Loss: 1.065 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6695640087127686
Epoch: 26, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.073 Vali Acc: 0.700 Test Loss: 1.073 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6835644245147705
Epoch: 27, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.079 Vali Acc: 0.700 Test Loss: 1.079 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6657605171203613
Epoch: 28, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.082 Vali Acc: 0.700 Test Loss: 1.082 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6858067512512207
Epoch: 29, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.086 Vali Acc: 0.725 Test Loss: 1.086 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 30 cost time: 0.6792252063751221
Epoch: 30, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.090 Vali Acc: 0.725 Test Loss: 1.090 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6703400611877441
Epoch: 31, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.094 Vali Acc: 0.725 Test Loss: 1.094 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6772110462188721
Epoch: 32, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.096 Vali Acc: 0.725 Test Loss: 1.096 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7489659786224365
Epoch: 33, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.101 Vali Acc: 0.725 Test Loss: 1.101 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6776671409606934
Epoch: 34, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.107 Vali Acc: 0.725 Test Loss: 1.107 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6452162265777588
Epoch: 35, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.112 Vali Acc: 0.725 Test Loss: 1.112 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6735172271728516
Epoch: 36, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.118 Vali Acc: 0.725 Test Loss: 1.118 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7644102573394775
Epoch: 37, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.122 Vali Acc: 0.725 Test Loss: 1.122 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7206087112426758
Epoch: 38, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.125 Vali Acc: 0.725 Test Loss: 1.125 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7096724510192871
Epoch: 39, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.129 Vali Acc: 0.725 Test Loss: 1.129 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 86468
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2118518352508545
Epoch: 1, Steps: 3 | Train Loss: 1.695 Vali Loss: 1.474 Vali Acc: 0.325 Test Loss: 1.474 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.5939385890960693
Epoch: 2, Steps: 3 | Train Loss: 1.530 Vali Loss: 1.467 Vali Acc: 0.325 Test Loss: 1.467 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.6493616104125977
Epoch: 3, Steps: 3 | Train Loss: 1.537 Vali Loss: 1.453 Vali Acc: 0.350 Test Loss: 1.453 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 4 cost time: 0.6393754482269287
Epoch: 4, Steps: 3 | Train Loss: 1.559 Vali Loss: 1.428 Vali Acc: 0.375 Test Loss: 1.428 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.6840336322784424
Epoch: 5, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.400 Vali Acc: 0.400 Test Loss: 1.400 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.7333056926727295
Epoch: 6, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.366 Vali Acc: 0.425 Test Loss: 1.366 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 0.5895957946777344
Epoch: 7, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.331 Vali Acc: 0.425 Test Loss: 1.331 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.6225371360778809
Epoch: 8, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.295 Vali Acc: 0.450 Test Loss: 1.295 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.661475658416748
Epoch: 9, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.6685142517089844
Epoch: 10, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.6412045955657959
Epoch: 11, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.198 Vali Acc: 0.575 Test Loss: 1.198 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 0.6362957954406738
Epoch: 12, Steps: 3 | Train Loss: 0.782 Vali Loss: 1.173 Vali Acc: 0.600 Test Loss: 1.173 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.6031951904296875
Epoch: 13, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.152 Vali Acc: 0.600 Test Loss: 1.152 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 0.6947925090789795
Epoch: 14, Steps: 3 | Train Loss: 0.659 Vali Loss: 1.126 Vali Acc: 0.600 Test Loss: 1.126 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.620927095413208
Epoch: 15, Steps: 3 | Train Loss: 0.535 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.6383717060089111
Epoch: 16, Steps: 3 | Train Loss: 0.589 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.7186286449432373
Epoch: 17, Steps: 3 | Train Loss: 0.445 Vali Loss: 1.083 Vali Acc: 0.625 Test Loss: 1.083 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.6020138263702393
Epoch: 18, Steps: 3 | Train Loss: 0.372 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 0.6747603416442871
Epoch: 19, Steps: 3 | Train Loss: 0.354 Vali Loss: 1.078 Vali Acc: 0.675 Test Loss: 1.078 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 20 cost time: 0.7123827934265137
Epoch: 20, Steps: 3 | Train Loss: 0.270 Vali Loss: 1.078 Vali Acc: 0.675 Test Loss: 1.078 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7218265533447266
Epoch: 21, Steps: 3 | Train Loss: 0.276 Vali Loss: 1.075 Vali Acc: 0.700 Test Loss: 1.075 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 22 cost time: 0.714820384979248
Epoch: 22, Steps: 3 | Train Loss: 0.229 Vali Loss: 1.082 Vali Acc: 0.700 Test Loss: 1.082 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7425758838653564
Epoch: 23, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.092 Vali Acc: 0.700 Test Loss: 1.092 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7330636978149414
Epoch: 24, Steps: 3 | Train Loss: 0.169 Vali Loss: 1.104 Vali Acc: 0.700 Test Loss: 1.104 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6984765529632568
Epoch: 25, Steps: 3 | Train Loss: 0.120 Vali Loss: 1.112 Vali Acc: 0.700 Test Loss: 1.112 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6623780727386475
Epoch: 26, Steps: 3 | Train Loss: 0.116 Vali Loss: 1.119 Vali Acc: 0.725 Test Loss: 1.119 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 27 cost time: 0.7226607799530029
Epoch: 27, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.121 Vali Acc: 0.700 Test Loss: 1.121 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6868658065795898
Epoch: 28, Steps: 3 | Train Loss: 0.070 Vali Loss: 1.120 Vali Acc: 0.700 Test Loss: 1.120 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6194789409637451
Epoch: 29, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.118 Vali Acc: 0.700 Test Loss: 1.118 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6928508281707764
Epoch: 30, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.118 Vali Acc: 0.725 Test Loss: 1.118 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 31 cost time: 0.7666032314300537
Epoch: 31, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.124 Vali Acc: 0.725 Test Loss: 1.124 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7215850353240967
Epoch: 32, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.129 Vali Acc: 0.725 Test Loss: 1.129 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6886630058288574
Epoch: 33, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.132 Vali Acc: 0.725 Test Loss: 1.132 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6232671737670898
Epoch: 34, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.139 Vali Acc: 0.725 Test Loss: 1.139 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6842067241668701
Epoch: 35, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.138 Vali Acc: 0.725 Test Loss: 1.138 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7029018402099609
Epoch: 36, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.138 Vali Acc: 0.725 Test Loss: 1.138 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.681532621383667
Epoch: 37, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.143 Vali Acc: 0.725 Test Loss: 1.143 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.69931960105896
Epoch: 38, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.146 Vali Acc: 0.725 Test Loss: 1.146 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6328203678131104
Epoch: 39, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.150 Vali Acc: 0.725 Test Loss: 1.150 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6918230056762695
Epoch: 40, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.156 Vali Acc: 0.725 Test Loss: 1.156 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 83716
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.451795816421509
Epoch: 1, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.421 Vali Acc: 0.250 Test Loss: 1.421 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.7406396865844727
Epoch: 2, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.398 Vali Acc: 0.300 Test Loss: 1.398 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.5876693725585938
Epoch: 3, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.378 Vali Acc: 0.300 Test Loss: 1.378 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.6270620822906494
Epoch: 4, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.355 Vali Acc: 0.275 Test Loss: 1.355 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6468613147735596
Epoch: 5, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.331 Vali Acc: 0.375 Test Loss: 1.331 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.6374261379241943
Epoch: 6, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.309 Vali Acc: 0.350 Test Loss: 1.309 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6403374671936035
Epoch: 7, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.5833859443664551
Epoch: 8, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.269 Vali Acc: 0.450 Test Loss: 1.269 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.57436203956604
Epoch: 9, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.6752841472625732
Epoch: 10, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.233 Vali Acc: 0.525 Test Loss: 1.233 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.6355886459350586
Epoch: 11, Steps: 3 | Train Loss: 0.840 Vali Loss: 1.218 Vali Acc: 0.575 Test Loss: 1.218 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 0.6978538036346436
Epoch: 12, Steps: 3 | Train Loss: 0.762 Vali Loss: 1.209 Vali Acc: 0.575 Test Loss: 1.209 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 0.67820143699646
Epoch: 13, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.200 Vali Acc: 0.550 Test Loss: 1.200 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5988097190856934
Epoch: 14, Steps: 3 | Train Loss: 0.568 Vali Loss: 1.192 Vali Acc: 0.550 Test Loss: 1.192 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6568818092346191
Epoch: 15, Steps: 3 | Train Loss: 0.625 Vali Loss: 1.177 Vali Acc: 0.550 Test Loss: 1.177 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6163449287414551
Epoch: 16, Steps: 3 | Train Loss: 0.590 Vali Loss: 1.162 Vali Acc: 0.550 Test Loss: 1.162 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6278748512268066
Epoch: 17, Steps: 3 | Train Loss: 0.404 Vali Loss: 1.146 Vali Acc: 0.550 Test Loss: 1.146 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.767009973526001
Epoch: 18, Steps: 3 | Train Loss: 0.437 Vali Loss: 1.128 Vali Acc: 0.550 Test Loss: 1.128 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7803928852081299
Epoch: 19, Steps: 3 | Train Loss: 0.374 Vali Loss: 1.115 Vali Acc: 0.550 Test Loss: 1.115 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7399423122406006
Epoch: 20, Steps: 3 | Train Loss: 0.331 Vali Loss: 1.106 Vali Acc: 0.550 Test Loss: 1.106 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.678673267364502
Epoch: 21, Steps: 3 | Train Loss: 0.293 Vali Loss: 1.100 Vali Acc: 0.550 Test Loss: 1.100 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7321910858154297
Epoch: 22, Steps: 3 | Train Loss: 0.260 Vali Loss: 1.099 Vali Acc: 0.550 Test Loss: 1.099 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df128_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.575
model parameter : 79428
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6405322551727295
Epoch: 1, Steps: 3 | Train Loss: 1.576 Vali Loss: 1.561 Vali Acc: 0.175 Test Loss: 1.561 Test Acc: 0.175
Validation loss decreased (inf --> -0.174984).  Saving model ...
Epoch: 2 cost time: 0.7908027172088623
Epoch: 2, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.477 Vali Acc: 0.200 Test Loss: 1.477 Test Acc: 0.200
Validation loss decreased (-0.174984 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.8193047046661377
Epoch: 3, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.379 Vali Acc: 0.300 Test Loss: 1.379 Test Acc: 0.300
Validation loss decreased (-0.199985 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.8224916458129883
Epoch: 4, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.286 Vali Acc: 0.375 Test Loss: 1.286 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.9025342464447021
Epoch: 5, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.204 Vali Acc: 0.550 Test Loss: 1.204 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.8152880668640137
Epoch: 6, Steps: 3 | Train Loss: 0.750 Vali Loss: 1.142 Vali Acc: 0.550 Test Loss: 1.142 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 0.9377706050872803
Epoch: 7, Steps: 3 | Train Loss: 0.591 Vali Loss: 1.102 Vali Acc: 0.550 Test Loss: 1.102 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.8364765644073486
Epoch: 8, Steps: 3 | Train Loss: 0.499 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
Validation loss decreased (-0.549989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 0.810795783996582
Epoch: 9, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.978 Vali Acc: 0.650 Test Loss: 0.978 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8305151462554932
Epoch: 10, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.962 Vali Acc: 0.675 Test Loss: 0.962 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.7969460487365723
Epoch: 11, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.939 Vali Acc: 0.675 Test Loss: 0.939 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 12 cost time: 0.7623796463012695
Epoch: 12, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.926 Vali Acc: 0.725 Test Loss: 0.926 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.7999711036682129
Epoch: 13, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.950 Vali Acc: 0.700 Test Loss: 0.950 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7230415344238281
Epoch: 14, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.8593459129333496
Epoch: 15, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.925 Vali Acc: 0.725 Test Loss: 0.925 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.716372013092041
Epoch: 16, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.830697774887085
Epoch: 17, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.897 Vali Acc: 0.775 Test Loss: 0.897 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 18 cost time: 0.7990453243255615
Epoch: 18, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.904 Vali Acc: 0.800 Test Loss: 0.904 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 0.7517120838165283
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.922 Vali Acc: 0.775 Test Loss: 0.922 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7758631706237793
Epoch: 20, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.940 Vali Acc: 0.750 Test Loss: 0.940 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.820659875869751
Epoch: 21, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9587032794952393
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.967 Vali Acc: 0.725 Test Loss: 0.967 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.833543062210083
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.980 Vali Acc: 0.725 Test Loss: 0.980 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7755465507507324
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.725 Test Loss: 0.992 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7896771430969238
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.000 Vali Acc: 0.725 Test Loss: 1.000 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8303258419036865
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.007 Vali Acc: 0.725 Test Loss: 1.007 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.725764274597168
Epoch: 27, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.010 Vali Acc: 0.725 Test Loss: 1.010 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7706778049468994
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 127556
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3194329738616943
Epoch: 1, Steps: 3 | Train Loss: 1.540 Vali Loss: 1.442 Vali Acc: 0.375 Test Loss: 1.442 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.7683379650115967
Epoch: 2, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.410 Vali Acc: 0.450 Test Loss: 1.410 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 0.75850510597229
Epoch: 3, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.364 Vali Acc: 0.450 Test Loss: 1.364 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.8679723739624023
Epoch: 4, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.294 Vali Acc: 0.475 Test Loss: 1.294 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.7599537372589111
Epoch: 5, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.222 Vali Acc: 0.475 Test Loss: 1.222 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.7037699222564697
Epoch: 6, Steps: 3 | Train Loss: 0.739 Vali Loss: 1.155 Vali Acc: 0.600 Test Loss: 1.155 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.7562997341156006
Epoch: 7, Steps: 3 | Train Loss: 0.603 Vali Loss: 1.097 Vali Acc: 0.575 Test Loss: 1.097 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7093420028686523
Epoch: 8, Steps: 3 | Train Loss: 0.544 Vali Loss: 1.056 Vali Acc: 0.625 Test Loss: 1.056 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.8239529132843018
Epoch: 9, Steps: 3 | Train Loss: 0.410 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.7336187362670898
Epoch: 10, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.967 Vali Acc: 0.625 Test Loss: 0.967 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7131972312927246
Epoch: 11, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.935 Vali Acc: 0.650 Test Loss: 0.935 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 12 cost time: 0.7096109390258789
Epoch: 12, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.903 Vali Acc: 0.650 Test Loss: 0.903 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 13 cost time: 0.7171375751495361
Epoch: 13, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.886 Vali Acc: 0.700 Test Loss: 0.886 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 0.7324633598327637
Epoch: 14, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.884 Vali Acc: 0.725 Test Loss: 0.884 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 0.7752959728240967
Epoch: 15, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.882 Vali Acc: 0.750 Test Loss: 0.882 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.7240891456604004
Epoch: 16, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.871 Vali Acc: 0.750 Test Loss: 0.871 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.7010290622711182
Epoch: 17, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.859 Vali Acc: 0.700 Test Loss: 0.859 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7297563552856445
Epoch: 18, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.857 Vali Acc: 0.725 Test Loss: 0.857 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7584154605865479
Epoch: 19, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.865 Vali Acc: 0.725 Test Loss: 0.865 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7510538101196289
Epoch: 20, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.873 Vali Acc: 0.700 Test Loss: 0.873 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7711384296417236
Epoch: 21, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.883 Vali Acc: 0.700 Test Loss: 0.883 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7814853191375732
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.892 Vali Acc: 0.700 Test Loss: 0.892 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.867445707321167
Epoch: 23, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.901 Vali Acc: 0.700 Test Loss: 0.901 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7425715923309326
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.911 Vali Acc: 0.700 Test Loss: 0.911 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7282671928405762
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.918 Vali Acc: 0.725 Test Loss: 0.918 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7523679733276367
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.925 Vali Acc: 0.725 Test Loss: 0.925 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 101572
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.353696584701538
Epoch: 1, Steps: 3 | Train Loss: 1.543 Vali Loss: 1.459 Vali Acc: 0.225 Test Loss: 1.459 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.7272312641143799
Epoch: 2, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.412 Vali Acc: 0.250 Test Loss: 1.412 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.7626774311065674
Epoch: 3, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.356 Vali Acc: 0.275 Test Loss: 1.356 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.6666507720947266
Epoch: 4, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.296 Vali Acc: 0.300 Test Loss: 1.296 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.7499537467956543
Epoch: 5, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.244 Vali Acc: 0.425 Test Loss: 1.244 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424988).  Saving model ...
Epoch: 6 cost time: 0.7471938133239746
Epoch: 6, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.193 Vali Acc: 0.475 Test Loss: 1.193 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.7362744808197021
Epoch: 7, Steps: 3 | Train Loss: 0.823 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.7967159748077393
Epoch: 8, Steps: 3 | Train Loss: 0.654 Vali Loss: 1.104 Vali Acc: 0.550 Test Loss: 1.104 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.7409236431121826
Epoch: 9, Steps: 3 | Train Loss: 0.566 Vali Loss: 1.048 Vali Acc: 0.625 Test Loss: 1.048 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.7223787307739258
Epoch: 10, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.987 Vali Acc: 0.650 Test Loss: 0.987 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.8704919815063477
Epoch: 11, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.944 Vali Acc: 0.700 Test Loss: 0.944 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 0.757298469543457
Epoch: 12, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.905 Vali Acc: 0.725 Test Loss: 0.905 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.7837128639221191
Epoch: 13, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.889 Vali Acc: 0.750 Test Loss: 0.889 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.7732586860656738
Epoch: 14, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.7358558177947998
Epoch: 15, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.864 Vali Acc: 0.725 Test Loss: 0.864 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7298221588134766
Epoch: 16, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.869 Vali Acc: 0.725 Test Loss: 0.869 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8484416007995605
Epoch: 17, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.861 Vali Acc: 0.725 Test Loss: 0.861 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7798833847045898
Epoch: 18, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.857 Vali Acc: 0.700 Test Loss: 0.857 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8721919059753418
Epoch: 19, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.861 Vali Acc: 0.725 Test Loss: 0.861 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7450299263000488
Epoch: 20, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.866 Vali Acc: 0.725 Test Loss: 0.866 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8152530193328857
Epoch: 21, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 22 cost time: 0.7380063533782959
Epoch: 22, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.895 Vali Acc: 0.725 Test Loss: 0.895 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9217708110809326
Epoch: 23, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.910 Vali Acc: 0.725 Test Loss: 0.910 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8206741809844971
Epoch: 24, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.924 Vali Acc: 0.725 Test Loss: 0.924 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8757762908935547
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.938 Vali Acc: 0.725 Test Loss: 0.938 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7620906829833984
Epoch: 26, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.942 Vali Acc: 0.725 Test Loss: 0.942 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8425300121307373
Epoch: 27, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.947 Vali Acc: 0.750 Test Loss: 0.947 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7551255226135254
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7788107395172119
Epoch: 29, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7651326656341553
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7551395893096924
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 89476
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2397620677948
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.574 Vali Acc: 0.250 Test Loss: 1.574 Test Acc: 0.250
Validation loss decreased (inf --> -0.249984).  Saving model ...
Epoch: 2 cost time: 0.5747499465942383
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.519 Vali Acc: 0.375 Test Loss: 1.519 Test Acc: 0.375
Validation loss decreased (-0.249984 --> -0.374985).  Saving model ...
Epoch: 3 cost time: 0.559903621673584
Epoch: 3, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.459 Vali Acc: 0.425 Test Loss: 1.459 Test Acc: 0.425
Validation loss decreased (-0.374985 --> -0.424985).  Saving model ...
Epoch: 4 cost time: 0.5876576900482178
Epoch: 4, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.400 Vali Acc: 0.400 Test Loss: 1.400 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6355714797973633
Epoch: 5, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.350 Vali Acc: 0.400 Test Loss: 1.350 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8705153465270996
Epoch: 6, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.298 Vali Acc: 0.450 Test Loss: 1.298 Test Acc: 0.450
Validation loss decreased (-0.424985 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.6096925735473633
Epoch: 7, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.252 Vali Acc: 0.475 Test Loss: 1.252 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.5961329936981201
Epoch: 8, Steps: 3 | Train Loss: 0.761 Vali Loss: 1.205 Vali Acc: 0.525 Test Loss: 1.205 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.6065406799316406
Epoch: 9, Steps: 3 | Train Loss: 0.791 Vali Loss: 1.158 Vali Acc: 0.550 Test Loss: 1.158 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.6064751148223877
Epoch: 10, Steps: 3 | Train Loss: 0.525 Vali Loss: 1.124 Vali Acc: 0.575 Test Loss: 1.124 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.6285450458526611
Epoch: 11, Steps: 3 | Train Loss: 0.478 Vali Loss: 1.099 Vali Acc: 0.675 Test Loss: 1.099 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 0.5988094806671143
Epoch: 12, Steps: 3 | Train Loss: 0.397 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 0.6091859340667725
Epoch: 13, Steps: 3 | Train Loss: 0.289 Vali Loss: 1.089 Vali Acc: 0.650 Test Loss: 1.089 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6382646560668945
Epoch: 14, Steps: 3 | Train Loss: 0.235 Vali Loss: 1.088 Vali Acc: 0.675 Test Loss: 1.088 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 15 cost time: 0.6288080215454102
Epoch: 15, Steps: 3 | Train Loss: 0.252 Vali Loss: 1.078 Vali Acc: 0.675 Test Loss: 1.078 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 0.5818557739257812
Epoch: 16, Steps: 3 | Train Loss: 0.165 Vali Loss: 1.061 Vali Acc: 0.700 Test Loss: 1.061 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 17 cost time: 0.6774241924285889
Epoch: 17, Steps: 3 | Train Loss: 0.111 Vali Loss: 1.043 Vali Acc: 0.700 Test Loss: 1.043 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 0.6893489360809326
Epoch: 18, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.024 Vali Acc: 0.675 Test Loss: 1.024 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6152560710906982
Epoch: 19, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.021 Vali Acc: 0.700 Test Loss: 1.021 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.687401294708252
Epoch: 20, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.031 Vali Acc: 0.725 Test Loss: 1.031 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 21 cost time: 0.6368556022644043
Epoch: 21, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.046 Vali Acc: 0.725 Test Loss: 1.046 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6521904468536377
Epoch: 22, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.057 Vali Acc: 0.725 Test Loss: 1.057 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6870830059051514
Epoch: 23, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.069 Vali Acc: 0.700 Test Loss: 1.069 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.68172287940979
Epoch: 24, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.078 Vali Acc: 0.700 Test Loss: 1.078 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6928017139434814
Epoch: 25, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.084 Vali Acc: 0.700 Test Loss: 1.084 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6348917484283447
Epoch: 26, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.085 Vali Acc: 0.700 Test Loss: 1.085 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8001775741577148
Epoch: 27, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.084 Vali Acc: 0.700 Test Loss: 1.084 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6918444633483887
Epoch: 28, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.083 Vali Acc: 0.700 Test Loss: 1.083 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.704118013381958
Epoch: 29, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.082 Vali Acc: 0.700 Test Loss: 1.082 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7398204803466797
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.078 Vali Acc: 0.725 Test Loss: 1.078 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 81924
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.515610933303833
Epoch: 1, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.405 Vali Acc: 0.350 Test Loss: 1.405 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.7315280437469482
Epoch: 2, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.384 Vali Acc: 0.325 Test Loss: 1.384 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6450612545013428
Epoch: 3, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.364 Vali Acc: 0.350 Test Loss: 1.364 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.6363513469696045
Epoch: 4, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.342 Vali Acc: 0.375 Test Loss: 1.342 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.6801137924194336
Epoch: 5, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.319 Vali Acc: 0.375 Test Loss: 1.319 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.7244679927825928
Epoch: 6, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.295 Vali Acc: 0.375 Test Loss: 1.295 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.6947832107543945
Epoch: 7, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.268 Vali Acc: 0.425 Test Loss: 1.268 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.6550102233886719
Epoch: 8, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.243 Vali Acc: 0.475 Test Loss: 1.243 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.6308128833770752
Epoch: 9, Steps: 3 | Train Loss: 0.894 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.7288007736206055
Epoch: 10, Steps: 3 | Train Loss: 0.811 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.6123347282409668
Epoch: 11, Steps: 3 | Train Loss: 0.676 Vali Loss: 1.181 Vali Acc: 0.450 Test Loss: 1.181 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5699262619018555
Epoch: 12, Steps: 3 | Train Loss: 0.631 Vali Loss: 1.165 Vali Acc: 0.450 Test Loss: 1.165 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6696491241455078
Epoch: 13, Steps: 3 | Train Loss: 0.551 Vali Loss: 1.148 Vali Acc: 0.450 Test Loss: 1.148 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6308722496032715
Epoch: 14, Steps: 3 | Train Loss: 0.488 Vali Loss: 1.137 Vali Acc: 0.475 Test Loss: 1.137 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6342110633850098
Epoch: 15, Steps: 3 | Train Loss: 0.398 Vali Loss: 1.121 Vali Acc: 0.525 Test Loss: 1.121 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 16 cost time: 0.809950590133667
Epoch: 16, Steps: 3 | Train Loss: 0.367 Vali Loss: 1.111 Vali Acc: 0.550 Test Loss: 1.111 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 0.6141345500946045
Epoch: 17, Steps: 3 | Train Loss: 0.292 Vali Loss: 1.108 Vali Acc: 0.575 Test Loss: 1.108 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 0.6121010780334473
Epoch: 18, Steps: 3 | Train Loss: 0.254 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.6820361614227295
Epoch: 19, Steps: 3 | Train Loss: 0.223 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.6044881343841553
Epoch: 20, Steps: 3 | Train Loss: 0.165 Vali Loss: 1.097 Vali Acc: 0.625 Test Loss: 1.097 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 0.6147031784057617
Epoch: 21, Steps: 3 | Train Loss: 0.158 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6910974979400635
Epoch: 22, Steps: 3 | Train Loss: 0.131 Vali Loss: 1.112 Vali Acc: 0.625 Test Loss: 1.112 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6362378597259521
Epoch: 23, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.118 Vali Acc: 0.650 Test Loss: 1.118 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.575340747833252
Epoch: 24, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 25 cost time: 0.6321558952331543
Epoch: 25, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.105 Vali Acc: 0.650 Test Loss: 1.105 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 26 cost time: 0.7028813362121582
Epoch: 26, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.107 Vali Acc: 0.650 Test Loss: 1.107 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5696365833282471
Epoch: 27, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.110 Vali Acc: 0.650 Test Loss: 1.110 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6498527526855469
Epoch: 28, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5921101570129395
Epoch: 29, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6256077289581299
Epoch: 30, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6567568778991699
Epoch: 31, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.131 Vali Acc: 0.650 Test Loss: 1.131 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.828493595123291
Epoch: 32, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.139 Vali Acc: 0.650 Test Loss: 1.139 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7672131061553955
Epoch: 33, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.146 Vali Acc: 0.650 Test Loss: 1.146 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.691901683807373
Epoch: 34, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.150 Vali Acc: 0.650 Test Loss: 1.150 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6286180019378662
Epoch: 35, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.156 Vali Acc: 0.650 Test Loss: 1.156 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 69956
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6267812252044678
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.609 Vali Acc: 0.225 Test Loss: 1.609 Test Acc: 0.225
Validation loss decreased (inf --> -0.224984).  Saving model ...
Epoch: 2 cost time: 0.8629980087280273
Epoch: 2, Steps: 3 | Train Loss: 1.547 Vali Loss: 1.574 Vali Acc: 0.275 Test Loss: 1.574 Test Acc: 0.275
Validation loss decreased (-0.224984 --> -0.274984).  Saving model ...
Epoch: 3 cost time: 0.664823055267334
Epoch: 3, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.541 Vali Acc: 0.225 Test Loss: 1.541 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7726864814758301
Epoch: 4, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.503 Vali Acc: 0.225 Test Loss: 1.503 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8042161464691162
Epoch: 5, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.463 Vali Acc: 0.225 Test Loss: 1.463 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7626523971557617
Epoch: 6, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.418 Vali Acc: 0.275 Test Loss: 1.418 Test Acc: 0.275
Validation loss decreased (-0.274984 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 0.904857873916626
Epoch: 7, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.375 Vali Acc: 0.350 Test Loss: 1.375 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.6478664875030518
Epoch: 8, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.330 Vali Acc: 0.425 Test Loss: 1.330 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.6447625160217285
Epoch: 9, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.288 Vali Acc: 0.475 Test Loss: 1.288 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.7195219993591309
Epoch: 10, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.250 Vali Acc: 0.450 Test Loss: 1.250 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6911125183105469
Epoch: 11, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.216 Vali Acc: 0.475 Test Loss: 1.216 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 12 cost time: 0.6535243988037109
Epoch: 12, Steps: 3 | Train Loss: 0.728 Vali Loss: 1.186 Vali Acc: 0.475 Test Loss: 1.186 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 0.672299861907959
Epoch: 13, Steps: 3 | Train Loss: 0.632 Vali Loss: 1.167 Vali Acc: 0.525 Test Loss: 1.167 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 0.6616814136505127
Epoch: 14, Steps: 3 | Train Loss: 0.574 Vali Loss: 1.148 Vali Acc: 0.550 Test Loss: 1.148 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 15 cost time: 0.6866757869720459
Epoch: 15, Steps: 3 | Train Loss: 0.487 Vali Loss: 1.131 Vali Acc: 0.575 Test Loss: 1.131 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 16 cost time: 0.7110261917114258
Epoch: 16, Steps: 3 | Train Loss: 0.419 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.6707730293273926
Epoch: 17, Steps: 3 | Train Loss: 0.390 Vali Loss: 1.094 Vali Acc: 0.600 Test Loss: 1.094 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.6322057247161865
Epoch: 18, Steps: 3 | Train Loss: 0.362 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.6636233329772949
Epoch: 19, Steps: 3 | Train Loss: 0.338 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.6545264720916748
Epoch: 20, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6475510597229004
Epoch: 21, Steps: 3 | Train Loss: 0.210 Vali Loss: 1.095 Vali Acc: 0.625 Test Loss: 1.095 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 22 cost time: 0.6493840217590332
Epoch: 22, Steps: 3 | Train Loss: 0.171 Vali Loss: 1.090 Vali Acc: 0.625 Test Loss: 1.090 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.6456782817840576
Epoch: 23, Steps: 3 | Train Loss: 0.150 Vali Loss: 1.090 Vali Acc: 0.650 Test Loss: 1.090 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.7653350830078125
Epoch: 24, Steps: 3 | Train Loss: 0.139 Vali Loss: 1.087 Vali Acc: 0.675 Test Loss: 1.087 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.6194250583648682
Epoch: 25, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.088 Vali Acc: 0.675 Test Loss: 1.088 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6936378479003906
Epoch: 26, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.090 Vali Acc: 0.675 Test Loss: 1.090 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6146914958953857
Epoch: 27, Steps: 3 | Train Loss: 0.079 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6978940963745117
Epoch: 28, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.096 Vali Acc: 0.675 Test Loss: 1.096 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6998512744903564
Epoch: 29, Steps: 3 | Train Loss: 0.060 Vali Loss: 1.102 Vali Acc: 0.675 Test Loss: 1.102 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7183144092559814
Epoch: 30, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.113 Vali Acc: 0.675 Test Loss: 1.113 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5388798713684082
Epoch: 31, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.121 Vali Acc: 0.675 Test Loss: 1.121 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.641798734664917
Epoch: 32, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.126 Vali Acc: 0.675 Test Loss: 1.126 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6527009010314941
Epoch: 33, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.130 Vali Acc: 0.675 Test Loss: 1.130 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5926282405853271
Epoch: 34, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.138 Vali Acc: 0.675 Test Loss: 1.138 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 67204
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5720207691192627
Epoch: 1, Steps: 3 | Train Loss: 1.513 Vali Loss: 1.504 Vali Acc: 0.200 Test Loss: 1.504 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.6531980037689209
Epoch: 2, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.493 Vali Acc: 0.200 Test Loss: 1.493 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.6328744888305664
Epoch: 3, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.481 Vali Acc: 0.200 Test Loss: 1.481 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 4 cost time: 0.624476432800293
Epoch: 4, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.464 Vali Acc: 0.225 Test Loss: 1.464 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 5 cost time: 0.7297935485839844
Epoch: 5, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.445 Vali Acc: 0.250 Test Loss: 1.445 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 0.6031975746154785
Epoch: 6, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.424 Vali Acc: 0.275 Test Loss: 1.424 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 0.6556148529052734
Epoch: 7, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.405 Vali Acc: 0.350 Test Loss: 1.405 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.6225848197937012
Epoch: 8, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.386 Vali Acc: 0.400 Test Loss: 1.386 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 0.6809530258178711
Epoch: 9, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.368 Vali Acc: 0.400 Test Loss: 1.368 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.6416540145874023
Epoch: 10, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.349 Vali Acc: 0.400 Test Loss: 1.349 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.5768833160400391
Epoch: 11, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.332 Vali Acc: 0.450 Test Loss: 1.332 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.5516071319580078
Epoch: 12, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.318 Vali Acc: 0.500 Test Loss: 1.318 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.6300923824310303
Epoch: 13, Steps: 3 | Train Loss: 0.778 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 0.5865423679351807
Epoch: 14, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 15 cost time: 0.6626851558685303
Epoch: 15, Steps: 3 | Train Loss: 0.644 Vali Loss: 1.284 Vali Acc: 0.550 Test Loss: 1.284 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 16 cost time: 0.5764737129211426
Epoch: 16, Steps: 3 | Train Loss: 0.564 Vali Loss: 1.276 Vali Acc: 0.550 Test Loss: 1.276 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 17 cost time: 0.7100141048431396
Epoch: 17, Steps: 3 | Train Loss: 0.626 Vali Loss: 1.269 Vali Acc: 0.550 Test Loss: 1.269 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 18 cost time: 0.6254074573516846
Epoch: 18, Steps: 3 | Train Loss: 0.520 Vali Loss: 1.265 Vali Acc: 0.550 Test Loss: 1.265 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 19 cost time: 0.6794888973236084
Epoch: 19, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.257 Vali Acc: 0.600 Test Loss: 1.257 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 20 cost time: 0.6421377658843994
Epoch: 20, Steps: 3 | Train Loss: 0.430 Vali Loss: 1.249 Vali Acc: 0.600 Test Loss: 1.249 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 21 cost time: 0.7374963760375977
Epoch: 21, Steps: 3 | Train Loss: 0.380 Vali Loss: 1.248 Vali Acc: 0.600 Test Loss: 1.248 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 0.6283242702484131
Epoch: 22, Steps: 3 | Train Loss: 0.296 Vali Loss: 1.252 Vali Acc: 0.600 Test Loss: 1.252 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6122674942016602
Epoch: 23, Steps: 3 | Train Loss: 0.270 Vali Loss: 1.259 Vali Acc: 0.600 Test Loss: 1.259 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6081006526947021
Epoch: 24, Steps: 3 | Train Loss: 0.240 Vali Loss: 1.266 Vali Acc: 0.600 Test Loss: 1.266 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.617206335067749
Epoch: 25, Steps: 3 | Train Loss: 0.207 Vali Loss: 1.270 Vali Acc: 0.600 Test Loss: 1.270 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7493298053741455
Epoch: 26, Steps: 3 | Train Loss: 0.191 Vali Loss: 1.274 Vali Acc: 0.600 Test Loss: 1.274 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.561180830001831
Epoch: 27, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.277 Vali Acc: 0.625 Test Loss: 1.277 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624987).  Saving model ...
Epoch: 28 cost time: 0.6133439540863037
Epoch: 28, Steps: 3 | Train Loss: 0.144 Vali Loss: 1.278 Vali Acc: 0.625 Test Loss: 1.278 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.622506856918335
Epoch: 29, Steps: 3 | Train Loss: 0.121 Vali Loss: 1.276 Vali Acc: 0.625 Test Loss: 1.276 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 30 cost time: 0.5709798336029053
Epoch: 30, Steps: 3 | Train Loss: 0.096 Vali Loss: 1.275 Vali Acc: 0.625 Test Loss: 1.275 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 31 cost time: 0.6304376125335693
Epoch: 31, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.274 Vali Acc: 0.625 Test Loss: 1.274 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 32 cost time: 0.5812110900878906
Epoch: 32, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.280 Vali Acc: 0.625 Test Loss: 1.280 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6902730464935303
Epoch: 33, Steps: 3 | Train Loss: 0.079 Vali Loss: 1.287 Vali Acc: 0.625 Test Loss: 1.287 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7022714614868164
Epoch: 34, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.294 Vali Acc: 0.625 Test Loss: 1.294 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6956527233123779
Epoch: 35, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.302 Vali Acc: 0.625 Test Loss: 1.302 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5668821334838867
Epoch: 36, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.313 Vali Acc: 0.625 Test Loss: 1.313 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.584719181060791
Epoch: 37, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.320 Vali Acc: 0.625 Test Loss: 1.320 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6393187046051025
Epoch: 38, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.325 Vali Acc: 0.625 Test Loss: 1.325 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6393001079559326
Epoch: 39, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.333 Vali Acc: 0.625 Test Loss: 1.333 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6585984230041504
Epoch: 40, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.335 Vali Acc: 0.625 Test Loss: 1.335 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.566032886505127
Epoch: 41, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.337 Vali Acc: 0.625 Test Loss: 1.337 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm64_nh16_df64_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 62916
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5549468994140625
Epoch: 1, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.537 Vali Acc: 0.150 Test Loss: 1.537 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 0.7356557846069336
Epoch: 2, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.473 Vali Acc: 0.200 Test Loss: 1.473 Test Acc: 0.200
Validation loss decreased (-0.149985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.7196559906005859
Epoch: 3, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.415 Vali Acc: 0.250 Test Loss: 1.415 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.7343888282775879
Epoch: 4, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.372 Vali Acc: 0.375 Test Loss: 1.372 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.7435343265533447
Epoch: 5, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.332 Vali Acc: 0.425 Test Loss: 1.332 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.8098068237304688
Epoch: 6, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.270 Vali Acc: 0.475 Test Loss: 1.270 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.7733771800994873
Epoch: 7, Steps: 3 | Train Loss: 0.847 Vali Loss: 1.195 Vali Acc: 0.575 Test Loss: 1.195 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.7810719013214111
Epoch: 8, Steps: 3 | Train Loss: 0.711 Vali Loss: 1.122 Vali Acc: 0.600 Test Loss: 1.122 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.778339147567749
Epoch: 9, Steps: 3 | Train Loss: 0.631 Vali Loss: 1.063 Vali Acc: 0.625 Test Loss: 1.063 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.627089262008667
Epoch: 10, Steps: 3 | Train Loss: 0.503 Vali Loss: 1.021 Vali Acc: 0.625 Test Loss: 1.021 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.8428654670715332
Epoch: 11, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.995 Vali Acc: 0.675 Test Loss: 0.995 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.738372802734375
Epoch: 12, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.960 Vali Acc: 0.700 Test Loss: 0.960 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.7104132175445557
Epoch: 13, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.921 Vali Acc: 0.750 Test Loss: 0.921 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.8845207691192627
Epoch: 14, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.8013918399810791
Epoch: 15, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.856 Vali Acc: 0.775 Test Loss: 0.856 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 16 cost time: 0.7533485889434814
Epoch: 16, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.839 Vali Acc: 0.775 Test Loss: 0.839 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.806182861328125
Epoch: 17, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.8210396766662598
Epoch: 18, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.809 Vali Acc: 0.800 Test Loss: 0.809 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 0.6959612369537354
Epoch: 19, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.804 Vali Acc: 0.800 Test Loss: 0.804 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 0.7541842460632324
Epoch: 20, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.803 Vali Acc: 0.800 Test Loss: 0.803 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 0.7087247371673584
Epoch: 21, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.639413595199585
Epoch: 22, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.819 Vali Acc: 0.750 Test Loss: 0.819 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8101844787597656
Epoch: 23, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.821 Vali Acc: 0.750 Test Loss: 0.821 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7518477439880371
Epoch: 24, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7518162727355957
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.810 Vali Acc: 0.775 Test Loss: 0.810 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7613754272460938
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.802 Vali Acc: 0.775 Test Loss: 0.802 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8283393383026123
Epoch: 27, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 28 cost time: 0.862987756729126
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 29 cost time: 0.7203414440155029
Epoch: 29, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7951204776763916
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 31 cost time: 0.7574741840362549
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7157371044158936
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.800 Vali Acc: 0.800 Test Loss: 0.800 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7296698093414307
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7440371513366699
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.804 Vali Acc: 0.800 Test Loss: 0.804 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7156202793121338
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.807 Vali Acc: 0.800 Test Loss: 0.807 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7545905113220215
Epoch: 36, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.808 Vali Acc: 0.800 Test Loss: 0.808 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.79537034034729
Epoch: 37, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.809 Vali Acc: 0.775 Test Loss: 0.809 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7215316295623779
Epoch: 38, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.810 Vali Acc: 0.775 Test Loss: 0.810 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8272688388824463
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.809 Vali Acc: 0.775 Test Loss: 0.809 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7288002967834473
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.809 Vali Acc: 0.775 Test Loss: 0.809 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 80612
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3268728256225586
Epoch: 1, Steps: 3 | Train Loss: 1.696 Vali Loss: 1.482 Vali Acc: 0.225 Test Loss: 1.482 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.6294677257537842
Epoch: 2, Steps: 3 | Train Loss: 1.579 Vali Loss: 1.462 Vali Acc: 0.275 Test Loss: 1.462 Test Acc: 0.275
Validation loss decreased (-0.224985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.6451606750488281
Epoch: 3, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.430 Vali Acc: 0.325 Test Loss: 1.430 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.6246733665466309
Epoch: 4, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.388 Vali Acc: 0.325 Test Loss: 1.388 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.665269136428833
Epoch: 5, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.340 Vali Acc: 0.350 Test Loss: 1.340 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.7791523933410645
Epoch: 6, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.293 Vali Acc: 0.475 Test Loss: 1.293 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.6737847328186035
Epoch: 7, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.250 Vali Acc: 0.475 Test Loss: 1.250 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.6485180854797363
Epoch: 8, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.6014499664306641
Epoch: 9, Steps: 3 | Train Loss: 0.863 Vali Loss: 1.166 Vali Acc: 0.550 Test Loss: 1.166 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.5955297946929932
Epoch: 10, Steps: 3 | Train Loss: 0.701 Vali Loss: 1.123 Vali Acc: 0.600 Test Loss: 1.123 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.6387889385223389
Epoch: 11, Steps: 3 | Train Loss: 0.579 Vali Loss: 1.092 Vali Acc: 0.625 Test Loss: 1.092 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.7323203086853027
Epoch: 12, Steps: 3 | Train Loss: 0.579 Vali Loss: 1.059 Vali Acc: 0.625 Test Loss: 1.059 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.6406300067901611
Epoch: 13, Steps: 3 | Train Loss: 0.409 Vali Loss: 1.017 Vali Acc: 0.650 Test Loss: 1.017 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 0.6683797836303711
Epoch: 14, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.990 Vali Acc: 0.650 Test Loss: 0.990 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.6297445297241211
Epoch: 15, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.968 Vali Acc: 0.650 Test Loss: 0.968 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 0.6467902660369873
Epoch: 16, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.948 Vali Acc: 0.650 Test Loss: 0.948 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 17 cost time: 0.6700551509857178
Epoch: 17, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.936 Vali Acc: 0.675 Test Loss: 0.936 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 18 cost time: 0.6577377319335938
Epoch: 18, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.913 Vali Acc: 0.700 Test Loss: 0.913 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 19 cost time: 0.6504766941070557
Epoch: 19, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.898 Vali Acc: 0.725 Test Loss: 0.898 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 20 cost time: 0.6430389881134033
Epoch: 20, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.892 Vali Acc: 0.725 Test Loss: 0.892 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 21 cost time: 0.6651179790496826
Epoch: 21, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.894 Vali Acc: 0.725 Test Loss: 0.894 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6923215389251709
Epoch: 22, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.902 Vali Acc: 0.725 Test Loss: 0.902 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7110202312469482
Epoch: 23, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.685265302658081
Epoch: 24, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.904 Vali Acc: 0.725 Test Loss: 0.904 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5963943004608154
Epoch: 25, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 26 cost time: 0.702059268951416
Epoch: 26, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.887 Vali Acc: 0.750 Test Loss: 0.887 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 27 cost time: 0.6467127799987793
Epoch: 27, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.875 Vali Acc: 0.750 Test Loss: 0.875 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 28 cost time: 0.6514136791229248
Epoch: 28, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.869 Vali Acc: 0.775 Test Loss: 0.869 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 29 cost time: 0.6600856781005859
Epoch: 29, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.864 Vali Acc: 0.750 Test Loss: 0.864 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7270050048828125
Epoch: 30, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6821129322052002
Epoch: 31, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5914297103881836
Epoch: 32, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.858 Vali Acc: 0.775 Test Loss: 0.858 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 33 cost time: 0.6740355491638184
Epoch: 33, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.859 Vali Acc: 0.775 Test Loss: 0.859 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.641049861907959
Epoch: 34, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.861 Vali Acc: 0.775 Test Loss: 0.861 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6068551540374756
Epoch: 35, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.862 Vali Acc: 0.775 Test Loss: 0.862 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5985941886901855
Epoch: 36, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.863 Vali Acc: 0.775 Test Loss: 0.863 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5983822345733643
Epoch: 37, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.865 Vali Acc: 0.750 Test Loss: 0.865 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.632429838180542
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.867 Vali Acc: 0.750 Test Loss: 0.867 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7087624073028564
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6030020713806152
Epoch: 40, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.869 Vali Acc: 0.750 Test Loss: 0.869 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6401486396789551
Epoch: 41, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.559880256652832
Epoch: 42, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.871 Vali Acc: 0.750 Test Loss: 0.871 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 67620
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0955991744995117
Epoch: 1, Steps: 3 | Train Loss: 1.630 Vali Loss: 1.370 Vali Acc: 0.275 Test Loss: 1.370 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5680954456329346
Epoch: 2, Steps: 3 | Train Loss: 1.578 Vali Loss: 1.345 Vali Acc: 0.325 Test Loss: 1.345 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.5783264636993408
Epoch: 3, Steps: 3 | Train Loss: 1.625 Vali Loss: 1.319 Vali Acc: 0.350 Test Loss: 1.319 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.6344423294067383
Epoch: 4, Steps: 3 | Train Loss: 1.529 Vali Loss: 1.291 Vali Acc: 0.350 Test Loss: 1.291 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.5958383083343506
Epoch: 5, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.259 Vali Acc: 0.375 Test Loss: 1.259 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.6107428073883057
Epoch: 6, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.228 Vali Acc: 0.525 Test Loss: 1.228 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.4781525135040283
Epoch: 7, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.195 Vali Acc: 0.575 Test Loss: 1.195 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.6321878433227539
Epoch: 8, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.164 Vali Acc: 0.625 Test Loss: 1.164 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 9 cost time: 0.572028398513794
Epoch: 9, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.131 Vali Acc: 0.650 Test Loss: 1.131 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.5691006183624268
Epoch: 10, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.092 Vali Acc: 0.650 Test Loss: 1.092 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 0.6222751140594482
Epoch: 11, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.049 Vali Acc: 0.675 Test Loss: 1.049 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.5553708076477051
Epoch: 12, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.6918809413909912
Epoch: 13, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5971214771270752
Epoch: 14, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.953 Vali Acc: 0.650 Test Loss: 0.953 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6943683624267578
Epoch: 15, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.932 Vali Acc: 0.675 Test Loss: 0.932 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6470601558685303
Epoch: 16, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.908 Vali Acc: 0.675 Test Loss: 0.908 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6221840381622314
Epoch: 17, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.894 Vali Acc: 0.675 Test Loss: 0.894 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7169795036315918
Epoch: 18, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.883 Vali Acc: 0.675 Test Loss: 0.883 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6762878894805908
Epoch: 19, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.877 Vali Acc: 0.675 Test Loss: 0.877 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7340383529663086
Epoch: 20, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.872 Vali Acc: 0.675 Test Loss: 0.872 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6865956783294678
Epoch: 21, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.866 Vali Acc: 0.700 Test Loss: 0.866 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 22 cost time: 0.8279242515563965
Epoch: 22, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.860 Vali Acc: 0.725 Test Loss: 0.860 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 23 cost time: 0.6142325401306152
Epoch: 23, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.856 Vali Acc: 0.725 Test Loss: 0.856 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 24 cost time: 0.6063694953918457
Epoch: 24, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.853 Vali Acc: 0.725 Test Loss: 0.853 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 25 cost time: 0.5826482772827148
Epoch: 25, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.854 Vali Acc: 0.725 Test Loss: 0.854 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6155288219451904
Epoch: 26, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.854 Vali Acc: 0.725 Test Loss: 0.854 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6511127948760986
Epoch: 27, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.860 Vali Acc: 0.725 Test Loss: 0.860 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7136917114257812
Epoch: 28, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.864 Vali Acc: 0.725 Test Loss: 0.864 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6182458400726318
Epoch: 29, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.869 Vali Acc: 0.725 Test Loss: 0.869 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6822402477264404
Epoch: 30, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.870 Vali Acc: 0.725 Test Loss: 0.870 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6559417247772217
Epoch: 31, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.873 Vali Acc: 0.725 Test Loss: 0.873 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5945382118225098
Epoch: 32, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.875 Vali Acc: 0.725 Test Loss: 0.875 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6125762462615967
Epoch: 33, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.880 Vali Acc: 0.725 Test Loss: 0.880 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6362354755401611
Epoch: 34, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.886 Vali Acc: 0.725 Test Loss: 0.886 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 61572
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.233546495437622
Epoch: 1, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.493 Vali Acc: 0.225 Test Loss: 1.493 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.5872836112976074
Epoch: 2, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.446 Vali Acc: 0.225 Test Loss: 1.446 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.6664390563964844
Epoch: 3, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.408 Vali Acc: 0.325 Test Loss: 1.408 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.5722441673278809
Epoch: 4, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.372 Vali Acc: 0.325 Test Loss: 1.372 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.6359536647796631
Epoch: 5, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.344 Vali Acc: 0.300 Test Loss: 1.344 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7689549922943115
Epoch: 6, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.317 Vali Acc: 0.300 Test Loss: 1.317 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6154952049255371
Epoch: 7, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.286 Vali Acc: 0.325 Test Loss: 1.286 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 8 cost time: 0.6266226768493652
Epoch: 8, Steps: 3 | Train Loss: 1.014 Vali Loss: 1.247 Vali Acc: 0.425 Test Loss: 1.247 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424988).  Saving model ...
Epoch: 9 cost time: 0.6360247135162354
Epoch: 9, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.215 Vali Acc: 0.450 Test Loss: 1.215 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 0.6935780048370361
Epoch: 10, Steps: 3 | Train Loss: 0.808 Vali Loss: 1.179 Vali Acc: 0.475 Test Loss: 1.179 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.6578373908996582
Epoch: 11, Steps: 3 | Train Loss: 0.719 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 0.6553940773010254
Epoch: 12, Steps: 3 | Train Loss: 0.626 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 0.6097261905670166
Epoch: 13, Steps: 3 | Train Loss: 0.592 Vali Loss: 1.064 Vali Acc: 0.500 Test Loss: 1.064 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 0.7423505783081055
Epoch: 14, Steps: 3 | Train Loss: 0.541 Vali Loss: 1.035 Vali Acc: 0.525 Test Loss: 1.035 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524990).  Saving model ...
Epoch: 15 cost time: 0.6642613410949707
Epoch: 15, Steps: 3 | Train Loss: 0.585 Vali Loss: 1.015 Vali Acc: 0.550 Test Loss: 1.015 Test Acc: 0.550
Validation loss decreased (-0.524990 --> -0.549990).  Saving model ...
Epoch: 16 cost time: 0.6333386898040771
Epoch: 16, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.004 Vali Acc: 0.575 Test Loss: 1.004 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 17 cost time: 0.7413570880889893
Epoch: 17, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.5988891124725342
Epoch: 18, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.625415563583374
Epoch: 19, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.951 Vali Acc: 0.625 Test Loss: 0.951 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 20 cost time: 0.6569631099700928
Epoch: 20, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.931 Vali Acc: 0.625 Test Loss: 0.931 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 21 cost time: 0.6236753463745117
Epoch: 21, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.913 Vali Acc: 0.650 Test Loss: 0.913 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649991).  Saving model ...
Epoch: 22 cost time: 0.6394693851470947
Epoch: 22, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.897 Vali Acc: 0.650 Test Loss: 0.897 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 23 cost time: 0.6794025897979736
Epoch: 23, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.896 Vali Acc: 0.650 Test Loss: 0.896 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 24 cost time: 0.655386209487915
Epoch: 24, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.898 Vali Acc: 0.725 Test Loss: 0.898 Test Acc: 0.725
Validation loss decreased (-0.649991 --> -0.724991).  Saving model ...
Epoch: 25 cost time: 0.6964728832244873
Epoch: 25, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.908 Vali Acc: 0.725 Test Loss: 0.908 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6506872177124023
Epoch: 26, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.920 Vali Acc: 0.700 Test Loss: 0.920 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6761279106140137
Epoch: 27, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.926 Vali Acc: 0.700 Test Loss: 0.926 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6209831237792969
Epoch: 28, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.926 Vali Acc: 0.700 Test Loss: 0.926 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6767573356628418
Epoch: 29, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.922 Vali Acc: 0.700 Test Loss: 0.922 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6234467029571533
Epoch: 30, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.914 Vali Acc: 0.725 Test Loss: 0.914 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6517436504364014
Epoch: 31, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.905 Vali Acc: 0.725 Test Loss: 0.905 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6722850799560547
Epoch: 32, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.897 Vali Acc: 0.725 Test Loss: 0.897 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 33 cost time: 0.6627719402313232
Epoch: 33, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.890 Vali Acc: 0.725 Test Loss: 0.890 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 34 cost time: 0.7019526958465576
Epoch: 34, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.888 Vali Acc: 0.725 Test Loss: 0.888 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 35 cost time: 0.7012994289398193
Epoch: 35, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.884 Vali Acc: 0.725 Test Loss: 0.884 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 36 cost time: 0.6505463123321533
Epoch: 36, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.883 Vali Acc: 0.725 Test Loss: 0.883 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 37 cost time: 0.6823279857635498
Epoch: 37, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.878 Vali Acc: 0.725 Test Loss: 0.878 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 38 cost time: 0.7517175674438477
Epoch: 38, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.878 Vali Acc: 0.725 Test Loss: 0.878 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6252985000610352
Epoch: 39, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 40 cost time: 0.6538441181182861
Epoch: 40, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.873 Vali Acc: 0.725 Test Loss: 0.873 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 41 cost time: 0.6367979049682617
Epoch: 41, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.873 Vali Acc: 0.725 Test Loss: 0.873 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5932996273040771
Epoch: 42, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.872 Vali Acc: 0.725 Test Loss: 0.872 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 43 cost time: 0.6356360912322998
Epoch: 43, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.870 Vali Acc: 0.725 Test Loss: 0.870 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 44 cost time: 0.6433961391448975
Epoch: 44, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.868 Vali Acc: 0.725 Test Loss: 0.868 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 45 cost time: 0.6127450466156006
Epoch: 45, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.867 Vali Acc: 0.725 Test Loss: 0.867 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 46 cost time: 0.6811263561248779
Epoch: 46, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.867 Vali Acc: 0.725 Test Loss: 0.867 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6807684898376465
Epoch: 47, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.868 Vali Acc: 0.725 Test Loss: 0.868 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5843586921691895
Epoch: 48, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.867 Vali Acc: 0.725 Test Loss: 0.867 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5811238288879395
Epoch: 49, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.865 Vali Acc: 0.725 Test Loss: 0.865 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 50 cost time: 0.6119658946990967
Epoch: 50, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.864 Vali Acc: 0.725 Test Loss: 0.864 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 51 cost time: 0.6856317520141602
Epoch: 51, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.863 Vali Acc: 0.725 Test Loss: 0.863 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 52 cost time: 0.8374297618865967
Epoch: 52, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.861 Vali Acc: 0.725 Test Loss: 0.861 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 53 cost time: 0.6029055118560791
Epoch: 53, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.858 Vali Acc: 0.725 Test Loss: 0.858 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 54 cost time: 0.6702675819396973
Epoch: 54, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.855 Vali Acc: 0.725 Test Loss: 0.855 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 55 cost time: 0.5912787914276123
Epoch: 55, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.853 Vali Acc: 0.725 Test Loss: 0.853 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 56 cost time: 0.6729819774627686
Epoch: 56, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.853 Vali Acc: 0.725 Test Loss: 0.853 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7545006275177002
Epoch: 57, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.853 Vali Acc: 0.725 Test Loss: 0.853 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7207238674163818
Epoch: 58, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.854 Vali Acc: 0.725 Test Loss: 0.854 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.7371995449066162
Epoch: 59, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.856 Vali Acc: 0.725 Test Loss: 0.856 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.6483578681945801
Epoch: 60, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.857 Vali Acc: 0.725 Test Loss: 0.857 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.7537469863891602
Epoch: 61, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.858 Vali Acc: 0.725 Test Loss: 0.858 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.6439685821533203
Epoch: 62, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.854 Vali Acc: 0.725 Test Loss: 0.854 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.6113495826721191
Epoch: 63, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.852 Vali Acc: 0.725 Test Loss: 0.852 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 64 cost time: 0.6963095664978027
Epoch: 64, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.849 Vali Acc: 0.725 Test Loss: 0.849 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 65 cost time: 0.7298986911773682
Epoch: 65, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.847 Vali Acc: 0.725 Test Loss: 0.847 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 66 cost time: 0.669459342956543
Epoch: 66, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.847 Vali Acc: 0.725 Test Loss: 0.847 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 67 cost time: 0.7248899936676025
Epoch: 67, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.848 Vali Acc: 0.725 Test Loss: 0.848 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7109866142272949
Epoch: 68, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.849 Vali Acc: 0.725 Test Loss: 0.849 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8678796291351318
Epoch: 69, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.850 Vali Acc: 0.725 Test Loss: 0.850 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.6587746143341064
Epoch: 70, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.849 Vali Acc: 0.725 Test Loss: 0.849 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.6850395202636719
Epoch: 71, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.847 Vali Acc: 0.725 Test Loss: 0.847 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.5986714363098145
Epoch: 72, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.848 Vali Acc: 0.725 Test Loss: 0.848 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.7105545997619629
Epoch: 73, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.846 Vali Acc: 0.725 Test Loss: 0.846 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 74 cost time: 0.6345391273498535
Epoch: 74, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.844 Vali Acc: 0.725 Test Loss: 0.844 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 75 cost time: 0.6789796352386475
Epoch: 75, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.845 Vali Acc: 0.725 Test Loss: 0.845 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6568913459777832
Epoch: 76, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.845 Vali Acc: 0.725 Test Loss: 0.845 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.713698148727417
Epoch: 77, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.844 Vali Acc: 0.725 Test Loss: 0.844 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.769122838973999
Epoch: 78, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.844 Vali Acc: 0.725 Test Loss: 0.844 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.6502029895782471
Epoch: 79, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.845 Vali Acc: 0.725 Test Loss: 0.845 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.6367030143737793
Epoch: 80, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.845 Vali Acc: 0.725 Test Loss: 0.845 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.77492356300354
Epoch: 81, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.847 Vali Acc: 0.725 Test Loss: 0.847 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.6522982120513916
Epoch: 82, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.848 Vali Acc: 0.725 Test Loss: 0.848 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.6920421123504639
Epoch: 83, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.848 Vali Acc: 0.725 Test Loss: 0.848 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.6574742794036865
Epoch: 84, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.850 Vali Acc: 0.725 Test Loss: 0.850 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 57796
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4216878414154053
Epoch: 1, Steps: 3 | Train Loss: 1.572 Vali Loss: 1.460 Vali Acc: 0.200 Test Loss: 1.460 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.6162350177764893
Epoch: 2, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.452 Vali Acc: 0.250 Test Loss: 1.452 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.6480007171630859
Epoch: 3, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.442 Vali Acc: 0.275 Test Loss: 1.442 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.6683449745178223
Epoch: 4, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.427 Vali Acc: 0.275 Test Loss: 1.427 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.6667380332946777
Epoch: 5, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.410 Vali Acc: 0.275 Test Loss: 1.410 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 0.6106846332550049
Epoch: 6, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.392 Vali Acc: 0.300 Test Loss: 1.392 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 0.6282346248626709
Epoch: 7, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.374 Vali Acc: 0.300 Test Loss: 1.374 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 8 cost time: 0.6440243721008301
Epoch: 8, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.356 Vali Acc: 0.300 Test Loss: 1.356 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 9 cost time: 0.6820721626281738
Epoch: 9, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.333 Vali Acc: 0.375 Test Loss: 1.333 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 0.668015718460083
Epoch: 10, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.311 Vali Acc: 0.350 Test Loss: 1.311 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7493219375610352
Epoch: 11, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.6186957359313965
Epoch: 12, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.274 Vali Acc: 0.400 Test Loss: 1.274 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 0.7268807888031006
Epoch: 13, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.260 Vali Acc: 0.400 Test Loss: 1.260 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 0.6100263595581055
Epoch: 14, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.243 Vali Acc: 0.475 Test Loss: 1.243 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 15 cost time: 0.6298274993896484
Epoch: 15, Steps: 3 | Train Loss: 0.758 Vali Loss: 1.225 Vali Acc: 0.475 Test Loss: 1.225 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 16 cost time: 0.6519689559936523
Epoch: 16, Steps: 3 | Train Loss: 0.730 Vali Loss: 1.207 Vali Acc: 0.525 Test Loss: 1.207 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.6074230670928955
Epoch: 17, Steps: 3 | Train Loss: 0.584 Vali Loss: 1.192 Vali Acc: 0.525 Test Loss: 1.192 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 18 cost time: 0.640040397644043
Epoch: 18, Steps: 3 | Train Loss: 0.574 Vali Loss: 1.182 Vali Acc: 0.525 Test Loss: 1.182 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 19 cost time: 0.7145204544067383
Epoch: 19, Steps: 3 | Train Loss: 0.553 Vali Loss: 1.169 Vali Acc: 0.575 Test Loss: 1.169 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.6136233806610107
Epoch: 20, Steps: 3 | Train Loss: 0.447 Vali Loss: 1.157 Vali Acc: 0.600 Test Loss: 1.157 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 21 cost time: 0.5929298400878906
Epoch: 21, Steps: 3 | Train Loss: 0.427 Vali Loss: 1.148 Vali Acc: 0.600 Test Loss: 1.148 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.7016720771789551
Epoch: 22, Steps: 3 | Train Loss: 0.470 Vali Loss: 1.145 Vali Acc: 0.625 Test Loss: 1.145 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.7283737659454346
Epoch: 23, Steps: 3 | Train Loss: 0.363 Vali Loss: 1.141 Vali Acc: 0.600 Test Loss: 1.141 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7110409736633301
Epoch: 24, Steps: 3 | Train Loss: 0.340 Vali Loss: 1.139 Vali Acc: 0.625 Test Loss: 1.139 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 25 cost time: 0.7241108417510986
Epoch: 25, Steps: 3 | Train Loss: 0.284 Vali Loss: 1.138 Vali Acc: 0.625 Test Loss: 1.138 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 26 cost time: 0.5833144187927246
Epoch: 26, Steps: 3 | Train Loss: 0.236 Vali Loss: 1.139 Vali Acc: 0.625 Test Loss: 1.139 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.644881010055542
Epoch: 27, Steps: 3 | Train Loss: 0.247 Vali Loss: 1.139 Vali Acc: 0.625 Test Loss: 1.139 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.618067741394043
Epoch: 28, Steps: 3 | Train Loss: 0.204 Vali Loss: 1.136 Vali Acc: 0.625 Test Loss: 1.136 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 29 cost time: 0.6838970184326172
Epoch: 29, Steps: 3 | Train Loss: 0.172 Vali Loss: 1.136 Vali Acc: 0.625 Test Loss: 1.136 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6978380680084229
Epoch: 30, Steps: 3 | Train Loss: 0.185 Vali Loss: 1.139 Vali Acc: 0.600 Test Loss: 1.139 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5163848400115967
Epoch: 31, Steps: 3 | Train Loss: 0.158 Vali Loss: 1.143 Vali Acc: 0.600 Test Loss: 1.143 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6732039451599121
Epoch: 32, Steps: 3 | Train Loss: 0.130 Vali Loss: 1.146 Vali Acc: 0.600 Test Loss: 1.146 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6013436317443848
Epoch: 33, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.148 Vali Acc: 0.575 Test Loss: 1.148 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6574604511260986
Epoch: 34, Steps: 3 | Train Loss: 0.098 Vali Loss: 1.154 Vali Acc: 0.575 Test Loss: 1.154 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5725882053375244
Epoch: 35, Steps: 3 | Train Loss: 0.096 Vali Loss: 1.162 Vali Acc: 0.575 Test Loss: 1.162 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6270909309387207
Epoch: 36, Steps: 3 | Train Loss: 0.096 Vali Loss: 1.172 Vali Acc: 0.575 Test Loss: 1.172 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5759873390197754
Epoch: 37, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.183 Vali Acc: 0.575 Test Loss: 1.183 Test Acc: 0.575
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5585651397705078
Epoch: 38, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.197 Vali Acc: 0.600 Test Loss: 1.197 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 51812
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.440272092819214
Epoch: 1, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.460 Vali Acc: 0.325 Test Loss: 1.460 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.5873217582702637
Epoch: 2, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.415 Vali Acc: 0.375 Test Loss: 1.415 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.6825575828552246
Epoch: 3, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.383 Vali Acc: 0.425 Test Loss: 1.383 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.6522266864776611
Epoch: 4, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.352 Vali Acc: 0.450 Test Loss: 1.352 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 5 cost time: 0.7015960216522217
Epoch: 5, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.323 Vali Acc: 0.475 Test Loss: 1.323 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.6721444129943848
Epoch: 6, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.296 Vali Acc: 0.500 Test Loss: 1.296 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.5929446220397949
Epoch: 7, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.59700608253479
Epoch: 8, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.247 Vali Acc: 0.550 Test Loss: 1.247 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.6644365787506104
Epoch: 9, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.224 Vali Acc: 0.525 Test Loss: 1.224 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6131844520568848
Epoch: 10, Steps: 3 | Train Loss: 0.892 Vali Loss: 1.201 Vali Acc: 0.550 Test Loss: 1.201 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.63570237159729
Epoch: 11, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.182 Vali Acc: 0.550 Test Loss: 1.182 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.5884504318237305
Epoch: 12, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.165 Vali Acc: 0.550 Test Loss: 1.165 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 0.6173486709594727
Epoch: 13, Steps: 3 | Train Loss: 0.780 Vali Loss: 1.147 Vali Acc: 0.600 Test Loss: 1.147 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.6210966110229492
Epoch: 14, Steps: 3 | Train Loss: 0.828 Vali Loss: 1.132 Vali Acc: 0.625 Test Loss: 1.132 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.621690034866333
Epoch: 15, Steps: 3 | Train Loss: 0.834 Vali Loss: 1.119 Vali Acc: 0.575 Test Loss: 1.119 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6201939582824707
Epoch: 16, Steps: 3 | Train Loss: 0.725 Vali Loss: 1.105 Vali Acc: 0.575 Test Loss: 1.105 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7665879726409912
Epoch: 17, Steps: 3 | Train Loss: 0.569 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6645889282226562
Epoch: 18, Steps: 3 | Train Loss: 0.536 Vali Loss: 1.079 Vali Acc: 0.625 Test Loss: 1.079 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.7138736248016357
Epoch: 19, Steps: 3 | Train Loss: 0.564 Vali Loss: 1.070 Vali Acc: 0.625 Test Loss: 1.070 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 20 cost time: 0.661515474319458
Epoch: 20, Steps: 3 | Train Loss: 0.530 Vali Loss: 1.058 Vali Acc: 0.625 Test Loss: 1.058 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 0.6351776123046875
Epoch: 21, Steps: 3 | Train Loss: 0.506 Vali Loss: 1.047 Vali Acc: 0.650 Test Loss: 1.047 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 22 cost time: 0.6369178295135498
Epoch: 22, Steps: 3 | Train Loss: 0.465 Vali Loss: 1.039 Vali Acc: 0.675 Test Loss: 1.039 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 23 cost time: 0.5761654376983643
Epoch: 23, Steps: 3 | Train Loss: 0.377 Vali Loss: 1.031 Vali Acc: 0.675 Test Loss: 1.031 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 24 cost time: 0.5217292308807373
Epoch: 24, Steps: 3 | Train Loss: 0.351 Vali Loss: 1.024 Vali Acc: 0.675 Test Loss: 1.024 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 25 cost time: 0.6940264701843262
Epoch: 25, Steps: 3 | Train Loss: 0.364 Vali Loss: 1.019 Vali Acc: 0.675 Test Loss: 1.019 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 26 cost time: 0.7007706165313721
Epoch: 26, Steps: 3 | Train Loss: 0.297 Vali Loss: 1.013 Vali Acc: 0.675 Test Loss: 1.013 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 27 cost time: 0.6168982982635498
Epoch: 27, Steps: 3 | Train Loss: 0.298 Vali Loss: 1.008 Vali Acc: 0.700 Test Loss: 1.008 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 28 cost time: 0.6655921936035156
Epoch: 28, Steps: 3 | Train Loss: 0.225 Vali Loss: 1.001 Vali Acc: 0.700 Test Loss: 1.001 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 29 cost time: 0.6256594657897949
Epoch: 29, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.995 Vali Acc: 0.700 Test Loss: 0.995 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 30 cost time: 0.6241097450256348
Epoch: 30, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.990 Vali Acc: 0.700 Test Loss: 0.990 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 31 cost time: 0.6916296482086182
Epoch: 31, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.988 Vali Acc: 0.700 Test Loss: 0.988 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.6206111907958984
Epoch: 32, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.986 Vali Acc: 0.700 Test Loss: 0.986 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 33 cost time: 0.650543212890625
Epoch: 33, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.987 Vali Acc: 0.700 Test Loss: 0.987 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.644017219543457
Epoch: 34, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.990 Vali Acc: 0.725 Test Loss: 0.990 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 35 cost time: 0.6856439113616943
Epoch: 35, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.993 Vali Acc: 0.725 Test Loss: 0.993 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7342379093170166
Epoch: 36, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.996 Vali Acc: 0.725 Test Loss: 0.996 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7529261112213135
Epoch: 37, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.999 Vali Acc: 0.725 Test Loss: 0.999 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6962542533874512
Epoch: 38, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.001 Vali Acc: 0.700 Test Loss: 1.001 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7838191986083984
Epoch: 39, Steps: 3 | Train Loss: 0.105 Vali Loss: 1.002 Vali Acc: 0.700 Test Loss: 1.002 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7916808128356934
Epoch: 40, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.004 Vali Acc: 0.700 Test Loss: 1.004 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6063921451568604
Epoch: 41, Steps: 3 | Train Loss: 0.074 Vali Loss: 1.004 Vali Acc: 0.700 Test Loss: 1.004 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7034480571746826
Epoch: 42, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.009 Vali Acc: 0.725 Test Loss: 1.009 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6740288734436035
Epoch: 43, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.013 Vali Acc: 0.725 Test Loss: 1.013 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6840558052062988
Epoch: 44, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.015 Vali Acc: 0.725 Test Loss: 1.015 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 50436
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.492926836013794
Epoch: 1, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.627 Vali Acc: 0.350 Test Loss: 1.627 Test Acc: 0.350
Validation loss decreased (inf --> -0.349984).  Saving model ...
Epoch: 2 cost time: 0.6938614845275879
Epoch: 2, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.590 Vali Acc: 0.375 Test Loss: 1.590 Test Acc: 0.375
Validation loss decreased (-0.349984 --> -0.374984).  Saving model ...
Epoch: 3 cost time: 0.7393321990966797
Epoch: 3, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.567 Vali Acc: 0.375 Test Loss: 1.567 Test Acc: 0.375
Validation loss decreased (-0.374984 --> -0.374984).  Saving model ...
Epoch: 4 cost time: 0.6494524478912354
Epoch: 4, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.545 Vali Acc: 0.400 Test Loss: 1.545 Test Acc: 0.400
Validation loss decreased (-0.374984 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 0.7075667381286621
Epoch: 5, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.525 Vali Acc: 0.400 Test Loss: 1.525 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 0.6323380470275879
Epoch: 6, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.506 Vali Acc: 0.400 Test Loss: 1.506 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 0.6927626132965088
Epoch: 7, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.488 Vali Acc: 0.400 Test Loss: 1.488 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 8 cost time: 0.6055140495300293
Epoch: 8, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.471 Vali Acc: 0.400 Test Loss: 1.471 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 0.5949640274047852
Epoch: 9, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.456 Vali Acc: 0.425 Test Loss: 1.456 Test Acc: 0.425
Validation loss decreased (-0.399985 --> -0.424985).  Saving model ...
Epoch: 10 cost time: 0.5788800716400146
Epoch: 10, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.443 Vali Acc: 0.450 Test Loss: 1.443 Test Acc: 0.450
Validation loss decreased (-0.424985 --> -0.449986).  Saving model ...
Epoch: 11 cost time: 0.6500813961029053
Epoch: 11, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.427 Vali Acc: 0.450 Test Loss: 1.427 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 12 cost time: 0.6446793079376221
Epoch: 12, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.412 Vali Acc: 0.475 Test Loss: 1.412 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 13 cost time: 0.6733086109161377
Epoch: 13, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.398 Vali Acc: 0.475 Test Loss: 1.398 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 14 cost time: 0.7070324420928955
Epoch: 14, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.386 Vali Acc: 0.475 Test Loss: 1.386 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 15 cost time: 0.6541261672973633
Epoch: 15, Steps: 3 | Train Loss: 0.905 Vali Loss: 1.374 Vali Acc: 0.500 Test Loss: 1.374 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499986).  Saving model ...
Epoch: 16 cost time: 0.6034793853759766
Epoch: 16, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.365 Vali Acc: 0.525 Test Loss: 1.365 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524986).  Saving model ...
Epoch: 17 cost time: 0.5692167282104492
Epoch: 17, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.352 Vali Acc: 0.525 Test Loss: 1.352 Test Acc: 0.525
Validation loss decreased (-0.524986 --> -0.524986).  Saving model ...
Epoch: 18 cost time: 0.5958702564239502
Epoch: 18, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.342 Vali Acc: 0.525 Test Loss: 1.342 Test Acc: 0.525
Validation loss decreased (-0.524986 --> -0.524987).  Saving model ...
Epoch: 19 cost time: 0.6738436222076416
Epoch: 19, Steps: 3 | Train Loss: 0.670 Vali Loss: 1.336 Vali Acc: 0.500 Test Loss: 1.336 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7297570705413818
Epoch: 20, Steps: 3 | Train Loss: 0.736 Vali Loss: 1.329 Vali Acc: 0.500 Test Loss: 1.329 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.801886796951294
Epoch: 21, Steps: 3 | Train Loss: 0.627 Vali Loss: 1.325 Vali Acc: 0.500 Test Loss: 1.325 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6353654861450195
Epoch: 22, Steps: 3 | Train Loss: 0.581 Vali Loss: 1.321 Vali Acc: 0.500 Test Loss: 1.321 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7764809131622314
Epoch: 23, Steps: 3 | Train Loss: 0.500 Vali Loss: 1.316 Vali Acc: 0.525 Test Loss: 1.316 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 24 cost time: 0.7675015926361084
Epoch: 24, Steps: 3 | Train Loss: 0.545 Vali Loss: 1.312 Vali Acc: 0.525 Test Loss: 1.312 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 25 cost time: 0.7005243301391602
Epoch: 25, Steps: 3 | Train Loss: 0.374 Vali Loss: 1.311 Vali Acc: 0.525 Test Loss: 1.311 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 26 cost time: 0.7741549015045166
Epoch: 26, Steps: 3 | Train Loss: 0.413 Vali Loss: 1.309 Vali Acc: 0.550 Test Loss: 1.309 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 27 cost time: 0.6746997833251953
Epoch: 27, Steps: 3 | Train Loss: 0.419 Vali Loss: 1.311 Vali Acc: 0.575 Test Loss: 1.311 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 28 cost time: 0.6741976737976074
Epoch: 28, Steps: 3 | Train Loss: 0.398 Vali Loss: 1.317 Vali Acc: 0.575 Test Loss: 1.317 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6516811847686768
Epoch: 29, Steps: 3 | Train Loss: 0.387 Vali Loss: 1.316 Vali Acc: 0.575 Test Loss: 1.316 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7295117378234863
Epoch: 30, Steps: 3 | Train Loss: 0.253 Vali Loss: 1.318 Vali Acc: 0.575 Test Loss: 1.318 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.614201545715332
Epoch: 31, Steps: 3 | Train Loss: 0.285 Vali Loss: 1.317 Vali Acc: 0.600 Test Loss: 1.317 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 32 cost time: 0.6073713302612305
Epoch: 32, Steps: 3 | Train Loss: 0.253 Vali Loss: 1.314 Vali Acc: 0.600 Test Loss: 1.314 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 33 cost time: 0.6336243152618408
Epoch: 33, Steps: 3 | Train Loss: 0.245 Vali Loss: 1.315 Vali Acc: 0.600 Test Loss: 1.315 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7579565048217773
Epoch: 34, Steps: 3 | Train Loss: 0.271 Vali Loss: 1.313 Vali Acc: 0.600 Test Loss: 1.313 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 35 cost time: 0.6627426147460938
Epoch: 35, Steps: 3 | Train Loss: 0.197 Vali Loss: 1.317 Vali Acc: 0.600 Test Loss: 1.317 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7119994163513184
Epoch: 36, Steps: 3 | Train Loss: 0.180 Vali Loss: 1.315 Vali Acc: 0.600 Test Loss: 1.315 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7235136032104492
Epoch: 37, Steps: 3 | Train Loss: 0.190 Vali Loss: 1.324 Vali Acc: 0.600 Test Loss: 1.324 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6061325073242188
Epoch: 38, Steps: 3 | Train Loss: 0.178 Vali Loss: 1.323 Vali Acc: 0.600 Test Loss: 1.323 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6290283203125
Epoch: 39, Steps: 3 | Train Loss: 0.147 Vali Loss: 1.322 Vali Acc: 0.600 Test Loss: 1.322 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7643651962280273
Epoch: 40, Steps: 3 | Train Loss: 0.130 Vali Loss: 1.321 Vali Acc: 0.600 Test Loss: 1.321 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7535591125488281
Epoch: 41, Steps: 3 | Train Loss: 0.119 Vali Loss: 1.318 Vali Acc: 0.600 Test Loss: 1.318 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6211512088775635
Epoch: 42, Steps: 3 | Train Loss: 0.121 Vali Loss: 1.321 Vali Acc: 0.600 Test Loss: 1.321 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5943384170532227
Epoch: 43, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.325 Vali Acc: 0.600 Test Loss: 1.325 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6452417373657227
Epoch: 44, Steps: 3 | Train Loss: 0.115 Vali Loss: 1.331 Vali Acc: 0.600 Test Loss: 1.331 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df256_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.6
model parameter : 48292
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3834407329559326
Epoch: 1, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.347 Vali Acc: 0.300 Test Loss: 1.347 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.6638245582580566
Epoch: 2, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.317 Vali Acc: 0.275 Test Loss: 1.317 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7085509300231934
Epoch: 3, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.280 Vali Acc: 0.375 Test Loss: 1.280 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.7323360443115234
Epoch: 4, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.235 Vali Acc: 0.425 Test Loss: 1.235 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 5 cost time: 0.6661829948425293
Epoch: 5, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.188 Vali Acc: 0.450 Test Loss: 1.188 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.7584686279296875
Epoch: 6, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.138 Vali Acc: 0.525 Test Loss: 1.138 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 0.6993730068206787
Epoch: 7, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.085 Vali Acc: 0.650 Test Loss: 1.085 Test Acc: 0.650
Validation loss decreased (-0.524989 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 0.7571427822113037
Epoch: 8, Steps: 3 | Train Loss: 0.700 Vali Loss: 1.039 Vali Acc: 0.675 Test Loss: 1.039 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 0.7257664203643799
Epoch: 9, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.998 Vali Acc: 0.700 Test Loss: 0.998 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 0.7256639003753662
Epoch: 10, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.965 Vali Acc: 0.725 Test Loss: 0.965 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.7275774478912354
Epoch: 11, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.940 Vali Acc: 0.700 Test Loss: 0.940 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7972042560577393
Epoch: 12, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.902 Vali Acc: 0.750 Test Loss: 0.902 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.7070636749267578
Epoch: 13, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.9068782329559326
Epoch: 14, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 0.7192018032073975
Epoch: 15, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.830 Vali Acc: 0.775 Test Loss: 0.830 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 0.7580933570861816
Epoch: 16, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7181706428527832
Epoch: 17, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.731285810470581
Epoch: 18, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 0.7259118556976318
Epoch: 19, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6994948387145996
Epoch: 20, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.801 Vali Acc: 0.775 Test Loss: 0.801 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8343422412872314
Epoch: 21, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8061754703521729
Epoch: 22, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6385867595672607
Epoch: 23, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.787 Vali Acc: 0.725 Test Loss: 0.787 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7618019580841064
Epoch: 24, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7823750972747803
Epoch: 25, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7571656703948975
Epoch: 26, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.771 Vali Acc: 0.775 Test Loss: 0.771 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7624526023864746
Epoch: 27, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.770 Vali Acc: 0.775 Test Loss: 0.770 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6923673152923584
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.771 Vali Acc: 0.775 Test Loss: 0.771 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 63972
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0796613693237305
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.308 Vali Acc: 0.350 Test Loss: 1.308 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.48216700553894043
Epoch: 2, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.289 Vali Acc: 0.350 Test Loss: 1.289 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.5409889221191406
Epoch: 3, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.266 Vali Acc: 0.350 Test Loss: 1.266 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.6020076274871826
Epoch: 4, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.6276490688323975
Epoch: 5, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.198 Vali Acc: 0.450 Test Loss: 1.198 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.5760245323181152
Epoch: 6, Steps: 3 | Train Loss: 0.977 Vali Loss: 1.160 Vali Acc: 0.575 Test Loss: 1.160 Test Acc: 0.575
Validation loss decreased (-0.449988 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.5961787700653076
Epoch: 7, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.125 Vali Acc: 0.575 Test Loss: 1.125 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.6318778991699219
Epoch: 8, Steps: 3 | Train Loss: 0.858 Vali Loss: 1.085 Vali Acc: 0.650 Test Loss: 1.085 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.574333906173706
Epoch: 9, Steps: 3 | Train Loss: 0.695 Vali Loss: 1.054 Vali Acc: 0.675 Test Loss: 1.054 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 0.6481747627258301
Epoch: 10, Steps: 3 | Train Loss: 0.659 Vali Loss: 1.028 Vali Acc: 0.700 Test Loss: 1.028 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 11 cost time: 0.6779356002807617
Epoch: 11, Steps: 3 | Train Loss: 0.513 Vali Loss: 1.006 Vali Acc: 0.725 Test Loss: 1.006 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.8049309253692627
Epoch: 12, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.982 Vali Acc: 0.725 Test Loss: 0.982 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 0.6059558391571045
Epoch: 13, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.954 Vali Acc: 0.725 Test Loss: 0.954 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.7047083377838135
Epoch: 14, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.929 Vali Acc: 0.700 Test Loss: 0.929 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7022759914398193
Epoch: 15, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.908 Vali Acc: 0.700 Test Loss: 0.908 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6208696365356445
Epoch: 16, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.888 Vali Acc: 0.700 Test Loss: 0.888 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5600466728210449
Epoch: 17, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.861 Vali Acc: 0.775 Test Loss: 0.861 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 18 cost time: 0.5571660995483398
Epoch: 18, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.836 Vali Acc: 0.775 Test Loss: 0.836 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 19 cost time: 0.5788226127624512
Epoch: 19, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.819 Vali Acc: 0.800 Test Loss: 0.819 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 0.6312286853790283
Epoch: 20, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.812 Vali Acc: 0.800 Test Loss: 0.812 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 0.6044518947601318
Epoch: 21, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.806 Vali Acc: 0.800 Test Loss: 0.806 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 22 cost time: 0.5887613296508789
Epoch: 22, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.800 Vali Acc: 0.825 Test Loss: 0.800 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 0.6465127468109131
Epoch: 23, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.798 Vali Acc: 0.775 Test Loss: 0.798 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5308020114898682
Epoch: 24, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5679430961608887
Epoch: 25, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6175167560577393
Epoch: 26, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8082916736602783
Epoch: 27, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.784 Vali Acc: 0.775 Test Loss: 0.784 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6302902698516846
Epoch: 28, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6395976543426514
Epoch: 29, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.781 Vali Acc: 0.800 Test Loss: 0.781 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.619621992111206
Epoch: 30, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.781 Vali Acc: 0.800 Test Loss: 0.781 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5897519588470459
Epoch: 31, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.779 Vali Acc: 0.800 Test Loss: 0.779 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6559381484985352
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.781 Vali Acc: 0.825 Test Loss: 0.781 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 33 cost time: 0.653160810470581
Epoch: 33, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.784 Vali Acc: 0.825 Test Loss: 0.784 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6047942638397217
Epoch: 34, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.785 Vali Acc: 0.825 Test Loss: 0.785 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7031469345092773
Epoch: 35, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.787 Vali Acc: 0.825 Test Loss: 0.787 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.670356035232544
Epoch: 36, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.787 Vali Acc: 0.825 Test Loss: 0.787 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.631101131439209
Epoch: 37, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.786 Vali Acc: 0.825 Test Loss: 0.786 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6096312999725342
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.788 Vali Acc: 0.825 Test Loss: 0.788 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.539522647857666
Epoch: 39, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.788 Vali Acc: 0.825 Test Loss: 0.788 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5821866989135742
Epoch: 40, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.788 Vali Acc: 0.825 Test Loss: 0.788 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6280803680419922
Epoch: 41, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5822606086730957
Epoch: 42, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 50980
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0706875324249268
Epoch: 1, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.380 Vali Acc: 0.375 Test Loss: 1.380 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.6061480045318604
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.357 Vali Acc: 0.350 Test Loss: 1.357 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7037942409515381
Epoch: 3, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.6226387023925781
Epoch: 4, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.303 Vali Acc: 0.375 Test Loss: 1.303 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.585381269454956
Epoch: 5, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.275 Vali Acc: 0.375 Test Loss: 1.275 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7088000774383545
Epoch: 6, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.244 Vali Acc: 0.425 Test Loss: 1.244 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 0.6849260330200195
Epoch: 7, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.212 Vali Acc: 0.475 Test Loss: 1.212 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.6790852546691895
Epoch: 8, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.180 Vali Acc: 0.525 Test Loss: 1.180 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.6402928829193115
Epoch: 9, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.142 Vali Acc: 0.525 Test Loss: 1.142 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 0.6923577785491943
Epoch: 10, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.111 Vali Acc: 0.550 Test Loss: 1.111 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 0.701901912689209
Epoch: 11, Steps: 3 | Train Loss: 0.720 Vali Loss: 1.083 Vali Acc: 0.550 Test Loss: 1.083 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 0.5923020839691162
Epoch: 12, Steps: 3 | Train Loss: 0.595 Vali Loss: 1.057 Vali Acc: 0.650 Test Loss: 1.057 Test Acc: 0.650
Validation loss decreased (-0.549989 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 0.707775354385376
Epoch: 13, Steps: 3 | Train Loss: 0.517 Vali Loss: 1.034 Vali Acc: 0.650 Test Loss: 1.034 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 0.6184232234954834
Epoch: 14, Steps: 3 | Train Loss: 0.421 Vali Loss: 1.004 Vali Acc: 0.650 Test Loss: 1.004 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.6240928173065186
Epoch: 15, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.971 Vali Acc: 0.650 Test Loss: 0.971 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 0.6779134273529053
Epoch: 16, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.945 Vali Acc: 0.675 Test Loss: 0.945 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 17 cost time: 0.7280631065368652
Epoch: 17, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.919 Vali Acc: 0.750 Test Loss: 0.919 Test Acc: 0.750
Validation loss decreased (-0.674991 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 0.6654238700866699
Epoch: 18, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.891 Vali Acc: 0.775 Test Loss: 0.891 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 19 cost time: 0.6497564315795898
Epoch: 19, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6538019180297852
Epoch: 20, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7007231712341309
Epoch: 21, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.883 Vali Acc: 0.700 Test Loss: 0.883 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7040717601776123
Epoch: 22, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.897 Vali Acc: 0.675 Test Loss: 0.897 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8244259357452393
Epoch: 23, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.900 Vali Acc: 0.700 Test Loss: 0.900 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6664292812347412
Epoch: 24, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.899 Vali Acc: 0.700 Test Loss: 0.899 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2613165378570557
Epoch: 25, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.896 Vali Acc: 0.700 Test Loss: 0.896 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.62235426902771
Epoch: 26, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.882 Vali Acc: 0.700 Test Loss: 0.882 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5869507789611816
Epoch: 27, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.872 Vali Acc: 0.725 Test Loss: 0.872 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5998849868774414
Epoch: 28, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.865 Vali Acc: 0.725 Test Loss: 0.865 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 44932
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0397427082061768
Epoch: 1, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.427 Vali Acc: 0.275 Test Loss: 1.427 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.575695276260376
Epoch: 2, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.418 Vali Acc: 0.275 Test Loss: 1.418 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6211631298065186
Epoch: 3, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.406 Vali Acc: 0.325 Test Loss: 1.406 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.6008005142211914
Epoch: 4, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.389 Vali Acc: 0.350 Test Loss: 1.389 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.5981783866882324
Epoch: 5, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.367 Vali Acc: 0.350 Test Loss: 1.367 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.5885331630706787
Epoch: 6, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.344 Vali Acc: 0.425 Test Loss: 1.344 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.6441750526428223
Epoch: 7, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.321 Vali Acc: 0.450 Test Loss: 1.321 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.6336328983306885
Epoch: 8, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.300 Vali Acc: 0.475 Test Loss: 1.300 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.6847624778747559
Epoch: 9, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.277 Vali Acc: 0.475 Test Loss: 1.277 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.6683211326599121
Epoch: 10, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.256 Vali Acc: 0.475 Test Loss: 1.256 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.6964926719665527
Epoch: 11, Steps: 3 | Train Loss: 0.769 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.6063845157623291
Epoch: 12, Steps: 3 | Train Loss: 0.661 Vali Loss: 1.215 Vali Acc: 0.525 Test Loss: 1.215 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 0.784677267074585
Epoch: 13, Steps: 3 | Train Loss: 0.626 Vali Loss: 1.196 Vali Acc: 0.575 Test Loss: 1.196 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 0.6529662609100342
Epoch: 14, Steps: 3 | Train Loss: 0.581 Vali Loss: 1.169 Vali Acc: 0.575 Test Loss: 1.169 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 0.607830286026001
Epoch: 15, Steps: 3 | Train Loss: 0.482 Vali Loss: 1.146 Vali Acc: 0.575 Test Loss: 1.146 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 16 cost time: 0.636284351348877
Epoch: 16, Steps: 3 | Train Loss: 0.463 Vali Loss: 1.129 Vali Acc: 0.575 Test Loss: 1.129 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 17 cost time: 0.5572502613067627
Epoch: 17, Steps: 3 | Train Loss: 0.387 Vali Loss: 1.111 Vali Acc: 0.575 Test Loss: 1.111 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 0.7291762828826904
Epoch: 18, Steps: 3 | Train Loss: 0.375 Vali Loss: 1.099 Vali Acc: 0.575 Test Loss: 1.099 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 19 cost time: 0.7106564044952393
Epoch: 19, Steps: 3 | Train Loss: 0.318 Vali Loss: 1.088 Vali Acc: 0.575 Test Loss: 1.088 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 20 cost time: 0.7012968063354492
Epoch: 20, Steps: 3 | Train Loss: 0.277 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 0.6094396114349365
Epoch: 21, Steps: 3 | Train Loss: 0.241 Vali Loss: 1.061 Vali Acc: 0.625 Test Loss: 1.061 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 22 cost time: 0.6547341346740723
Epoch: 22, Steps: 3 | Train Loss: 0.280 Vali Loss: 1.043 Vali Acc: 0.625 Test Loss: 1.043 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 23 cost time: 0.6520051956176758
Epoch: 23, Steps: 3 | Train Loss: 0.178 Vali Loss: 1.036 Vali Acc: 0.675 Test Loss: 1.036 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 24 cost time: 0.6496877670288086
Epoch: 24, Steps: 3 | Train Loss: 0.155 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 25 cost time: 0.6552140712738037
Epoch: 25, Steps: 3 | Train Loss: 0.154 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6863722801208496
Epoch: 26, Steps: 3 | Train Loss: 0.132 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6843395233154297
Epoch: 27, Steps: 3 | Train Loss: 0.098 Vali Loss: 1.040 Vali Acc: 0.700 Test Loss: 1.040 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7143902778625488
Epoch: 28, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.045 Vali Acc: 0.700 Test Loss: 1.045 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6313009262084961
Epoch: 29, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.050 Vali Acc: 0.700 Test Loss: 1.050 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6149654388427734
Epoch: 30, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.053 Vali Acc: 0.700 Test Loss: 1.053 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6177031993865967
Epoch: 31, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.053 Vali Acc: 0.700 Test Loss: 1.053 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5599358081817627
Epoch: 32, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.055 Vali Acc: 0.700 Test Loss: 1.055 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5887935161590576
Epoch: 33, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.056 Vali Acc: 0.700 Test Loss: 1.056 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5322093963623047
Epoch: 34, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.057 Vali Acc: 0.700 Test Loss: 1.057 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 41156
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3103654384613037
Epoch: 1, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.462 Vali Acc: 0.200 Test Loss: 1.462 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.5673983097076416
Epoch: 2, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.464 Vali Acc: 0.250 Test Loss: 1.464 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.5913920402526855
Epoch: 3, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.464 Vali Acc: 0.275 Test Loss: 1.464 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 0.6884760856628418
Epoch: 4, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.460 Vali Acc: 0.325 Test Loss: 1.460 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324985).  Saving model ...
Epoch: 5 cost time: 0.5983295440673828
Epoch: 5, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.453 Vali Acc: 0.375 Test Loss: 1.453 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374985).  Saving model ...
Epoch: 6 cost time: 0.6026511192321777
Epoch: 6, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.442 Vali Acc: 0.350 Test Loss: 1.442 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6778957843780518
Epoch: 7, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.428 Vali Acc: 0.350 Test Loss: 1.428 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5230908393859863
Epoch: 8, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.412 Vali Acc: 0.425 Test Loss: 1.412 Test Acc: 0.425
Validation loss decreased (-0.374985 --> -0.424986).  Saving model ...
Epoch: 9 cost time: 0.6678013801574707
Epoch: 9, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.397 Vali Acc: 0.450 Test Loss: 1.397 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 10 cost time: 0.5625805854797363
Epoch: 10, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.381 Vali Acc: 0.450 Test Loss: 1.381 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 11 cost time: 0.5798525810241699
Epoch: 11, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.365 Vali Acc: 0.475 Test Loss: 1.365 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 12 cost time: 0.5744502544403076
Epoch: 12, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.348 Vali Acc: 0.475 Test Loss: 1.348 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474987).  Saving model ...
Epoch: 13 cost time: 0.5571703910827637
Epoch: 13, Steps: 3 | Train Loss: 0.833 Vali Loss: 1.332 Vali Acc: 0.450 Test Loss: 1.332 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6104354858398438
Epoch: 14, Steps: 3 | Train Loss: 0.841 Vali Loss: 1.314 Vali Acc: 0.450 Test Loss: 1.314 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6483578681945801
Epoch: 15, Steps: 3 | Train Loss: 0.776 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7105739116668701
Epoch: 16, Steps: 3 | Train Loss: 0.672 Vali Loss: 1.281 Vali Acc: 0.400 Test Loss: 1.281 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5671031475067139
Epoch: 17, Steps: 3 | Train Loss: 0.638 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7245142459869385
Epoch: 18, Steps: 3 | Train Loss: 0.644 Vali Loss: 1.249 Vali Acc: 0.425 Test Loss: 1.249 Test Acc: 0.425
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6706044673919678
Epoch: 19, Steps: 3 | Train Loss: 0.553 Vali Loss: 1.231 Vali Acc: 0.450 Test Loss: 1.231 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6580402851104736
Epoch: 20, Steps: 3 | Train Loss: 0.521 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 21 cost time: 0.6368489265441895
Epoch: 21, Steps: 3 | Train Loss: 0.429 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 22 cost time: 0.5727503299713135
Epoch: 22, Steps: 3 | Train Loss: 0.499 Vali Loss: 1.202 Vali Acc: 0.550 Test Loss: 1.202 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 23 cost time: 0.6380202770233154
Epoch: 23, Steps: 3 | Train Loss: 0.397 Vali Loss: 1.197 Vali Acc: 0.550 Test Loss: 1.197 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 24 cost time: 0.6157941818237305
Epoch: 24, Steps: 3 | Train Loss: 0.389 Vali Loss: 1.195 Vali Acc: 0.550 Test Loss: 1.195 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 25 cost time: 0.628835916519165
Epoch: 25, Steps: 3 | Train Loss: 0.328 Vali Loss: 1.192 Vali Acc: 0.550 Test Loss: 1.192 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 26 cost time: 0.6173253059387207
Epoch: 26, Steps: 3 | Train Loss: 0.272 Vali Loss: 1.194 Vali Acc: 0.575 Test Loss: 1.194 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 27 cost time: 0.5637080669403076
Epoch: 27, Steps: 3 | Train Loss: 0.242 Vali Loss: 1.187 Vali Acc: 0.575 Test Loss: 1.187 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 28 cost time: 0.5596492290496826
Epoch: 28, Steps: 3 | Train Loss: 0.195 Vali Loss: 1.182 Vali Acc: 0.625 Test Loss: 1.182 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 29 cost time: 0.6587331295013428
Epoch: 29, Steps: 3 | Train Loss: 0.211 Vali Loss: 1.175 Vali Acc: 0.625 Test Loss: 1.175 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 30 cost time: 0.743532657623291
Epoch: 30, Steps: 3 | Train Loss: 0.198 Vali Loss: 1.170 Vali Acc: 0.625 Test Loss: 1.170 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 31 cost time: 0.5453438758850098
Epoch: 31, Steps: 3 | Train Loss: 0.194 Vali Loss: 1.163 Vali Acc: 0.625 Test Loss: 1.163 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 32 cost time: 0.5563755035400391
Epoch: 32, Steps: 3 | Train Loss: 0.159 Vali Loss: 1.160 Vali Acc: 0.625 Test Loss: 1.160 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 33 cost time: 0.5416696071624756
Epoch: 33, Steps: 3 | Train Loss: 0.157 Vali Loss: 1.162 Vali Acc: 0.650 Test Loss: 1.162 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 34 cost time: 0.5854785442352295
Epoch: 34, Steps: 3 | Train Loss: 0.128 Vali Loss: 1.164 Vali Acc: 0.650 Test Loss: 1.164 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.585137128829956
Epoch: 35, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.169 Vali Acc: 0.650 Test Loss: 1.169 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6570422649383545
Epoch: 36, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.172 Vali Acc: 0.650 Test Loss: 1.172 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5711982250213623
Epoch: 37, Steps: 3 | Train Loss: 0.095 Vali Loss: 1.176 Vali Acc: 0.650 Test Loss: 1.176 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6425714492797852
Epoch: 38, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.180 Vali Acc: 0.650 Test Loss: 1.180 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5372905731201172
Epoch: 39, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.187 Vali Acc: 0.650 Test Loss: 1.187 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7024490833282471
Epoch: 40, Steps: 3 | Train Loss: 0.076 Vali Loss: 1.195 Vali Acc: 0.650 Test Loss: 1.195 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5532538890838623
Epoch: 41, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.198 Vali Acc: 0.650 Test Loss: 1.198 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5696969032287598
Epoch: 42, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.204 Vali Acc: 0.650 Test Loss: 1.204 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5667669773101807
Epoch: 43, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.211 Vali Acc: 0.650 Test Loss: 1.211 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 35172
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5464208126068115
Epoch: 1, Steps: 3 | Train Loss: 1.594 Vali Loss: 1.514 Vali Acc: 0.250 Test Loss: 1.514 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.6204898357391357
Epoch: 2, Steps: 3 | Train Loss: 1.582 Vali Loss: 1.473 Vali Acc: 0.300 Test Loss: 1.473 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.6014752388000488
Epoch: 3, Steps: 3 | Train Loss: 1.547 Vali Loss: 1.446 Vali Acc: 0.325 Test Loss: 1.446 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.6789932250976562
Epoch: 4, Steps: 3 | Train Loss: 1.567 Vali Loss: 1.422 Vali Acc: 0.325 Test Loss: 1.422 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.6632132530212402
Epoch: 5, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.400 Vali Acc: 0.350 Test Loss: 1.400 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.6249771118164062
Epoch: 6, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.378 Vali Acc: 0.425 Test Loss: 1.378 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 0.7280306816101074
Epoch: 7, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.357 Vali Acc: 0.425 Test Loss: 1.357 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 8 cost time: 0.6329550743103027
Epoch: 8, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.336 Vali Acc: 0.450 Test Loss: 1.336 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.6684870719909668
Epoch: 9, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.316 Vali Acc: 0.450 Test Loss: 1.316 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.6705563068389893
Epoch: 10, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.294 Vali Acc: 0.425 Test Loss: 1.294 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6146600246429443
Epoch: 11, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.275 Vali Acc: 0.450 Test Loss: 1.275 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.6663603782653809
Epoch: 12, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.254 Vali Acc: 0.475 Test Loss: 1.254 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 13 cost time: 0.6650145053863525
Epoch: 13, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.234 Vali Acc: 0.475 Test Loss: 1.234 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 0.5948760509490967
Epoch: 14, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 0.7004032135009766
Epoch: 15, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.193 Vali Acc: 0.525 Test Loss: 1.193 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.641425371170044
Epoch: 16, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.173 Vali Acc: 0.550 Test Loss: 1.173 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 17 cost time: 0.6552321910858154
Epoch: 17, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.152 Vali Acc: 0.600 Test Loss: 1.152 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 18 cost time: 0.6749866008758545
Epoch: 18, Steps: 3 | Train Loss: 0.740 Vali Loss: 1.133 Vali Acc: 0.625 Test Loss: 1.133 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.7024524211883545
Epoch: 19, Steps: 3 | Train Loss: 0.680 Vali Loss: 1.113 Vali Acc: 0.650 Test Loss: 1.113 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.67989182472229
Epoch: 20, Steps: 3 | Train Loss: 0.656 Vali Loss: 1.097 Vali Acc: 0.675 Test Loss: 1.097 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 21 cost time: 0.6347329616546631
Epoch: 21, Steps: 3 | Train Loss: 0.591 Vali Loss: 1.080 Vali Acc: 0.675 Test Loss: 1.080 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 22 cost time: 0.6438705921173096
Epoch: 22, Steps: 3 | Train Loss: 0.492 Vali Loss: 1.065 Vali Acc: 0.650 Test Loss: 1.065 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6955435276031494
Epoch: 23, Steps: 3 | Train Loss: 0.449 Vali Loss: 1.053 Vali Acc: 0.650 Test Loss: 1.053 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.668370246887207
Epoch: 24, Steps: 3 | Train Loss: 0.469 Vali Loss: 1.040 Vali Acc: 0.650 Test Loss: 1.040 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7655413150787354
Epoch: 25, Steps: 3 | Train Loss: 0.417 Vali Loss: 1.028 Vali Acc: 0.650 Test Loss: 1.028 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5566790103912354
Epoch: 26, Steps: 3 | Train Loss: 0.391 Vali Loss: 1.018 Vali Acc: 0.650 Test Loss: 1.018 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5536720752716064
Epoch: 27, Steps: 3 | Train Loss: 0.365 Vali Loss: 1.009 Vali Acc: 0.650 Test Loss: 1.009 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5828778743743896
Epoch: 28, Steps: 3 | Train Loss: 0.323 Vali Loss: 1.002 Vali Acc: 0.650 Test Loss: 1.002 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7229893207550049
Epoch: 29, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.991 Vali Acc: 0.675 Test Loss: 0.991 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 30 cost time: 0.5366854667663574
Epoch: 30, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.978 Vali Acc: 0.700 Test Loss: 0.978 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 31 cost time: 0.5701282024383545
Epoch: 31, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.966 Vali Acc: 0.700 Test Loss: 0.966 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.5868151187896729
Epoch: 32, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.958 Vali Acc: 0.700 Test Loss: 0.958 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 33 cost time: 0.6013698577880859
Epoch: 33, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.956 Vali Acc: 0.700 Test Loss: 0.956 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 34 cost time: 0.5287115573883057
Epoch: 34, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.954 Vali Acc: 0.725 Test Loss: 0.954 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 35 cost time: 0.6169753074645996
Epoch: 35, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.955 Vali Acc: 0.725 Test Loss: 0.955 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5317878723144531
Epoch: 36, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.959 Vali Acc: 0.700 Test Loss: 0.959 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6905648708343506
Epoch: 37, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.963 Vali Acc: 0.700 Test Loss: 0.963 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5850775241851807
Epoch: 38, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.967 Vali Acc: 0.725 Test Loss: 0.967 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6338119506835938
Epoch: 39, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.970 Vali Acc: 0.725 Test Loss: 0.970 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5236177444458008
Epoch: 40, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.973 Vali Acc: 0.725 Test Loss: 0.973 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.743494987487793
Epoch: 41, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.975 Vali Acc: 0.725 Test Loss: 0.975 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6192061901092529
Epoch: 42, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.976 Vali Acc: 0.725 Test Loss: 0.976 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7541379928588867
Epoch: 43, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.974 Vali Acc: 0.725 Test Loss: 0.974 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6544041633605957
Epoch: 44, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.971 Vali Acc: 0.725 Test Loss: 0.971 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 33796
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.356635570526123
Epoch: 1, Steps: 3 | Train Loss: 1.559 Vali Loss: 1.476 Vali Acc: 0.250 Test Loss: 1.476 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.6014614105224609
Epoch: 2, Steps: 3 | Train Loss: 1.553 Vali Loss: 1.466 Vali Acc: 0.225 Test Loss: 1.466 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6592440605163574
Epoch: 3, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.458 Vali Acc: 0.275 Test Loss: 1.458 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 0.7035515308380127
Epoch: 4, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.447 Vali Acc: 0.275 Test Loss: 1.447 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.7348270416259766
Epoch: 5, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.435 Vali Acc: 0.325 Test Loss: 1.435 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.5960376262664795
Epoch: 6, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.422 Vali Acc: 0.350 Test Loss: 1.422 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.7332782745361328
Epoch: 7, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.409 Vali Acc: 0.350 Test Loss: 1.409 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.6517360210418701
Epoch: 8, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.395 Vali Acc: 0.350 Test Loss: 1.395 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.6490707397460938
Epoch: 9, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.380 Vali Acc: 0.350 Test Loss: 1.380 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 10 cost time: 0.6677260398864746
Epoch: 10, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.363 Vali Acc: 0.375 Test Loss: 1.363 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 11 cost time: 0.7546436786651611
Epoch: 11, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.6827263832092285
Epoch: 12, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 0.7413628101348877
Epoch: 13, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.313 Vali Acc: 0.425 Test Loss: 1.313 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 14 cost time: 0.5879778861999512
Epoch: 14, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7045023441314697
Epoch: 15, Steps: 3 | Train Loss: 0.888 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6776337623596191
Epoch: 16, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.267 Vali Acc: 0.425 Test Loss: 1.267 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 17 cost time: 0.6516683101654053
Epoch: 17, Steps: 3 | Train Loss: 0.800 Vali Loss: 1.252 Vali Acc: 0.425 Test Loss: 1.252 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 18 cost time: 0.6265366077423096
Epoch: 18, Steps: 3 | Train Loss: 0.813 Vali Loss: 1.240 Vali Acc: 0.425 Test Loss: 1.240 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 19 cost time: 0.6323943138122559
Epoch: 19, Steps: 3 | Train Loss: 0.714 Vali Loss: 1.231 Vali Acc: 0.425 Test Loss: 1.231 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 20 cost time: 0.6054978370666504
Epoch: 20, Steps: 3 | Train Loss: 0.723 Vali Loss: 1.221 Vali Acc: 0.425 Test Loss: 1.221 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 21 cost time: 0.5507066249847412
Epoch: 21, Steps: 3 | Train Loss: 0.738 Vali Loss: 1.216 Vali Acc: 0.450 Test Loss: 1.216 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 22 cost time: 0.5889601707458496
Epoch: 22, Steps: 3 | Train Loss: 0.548 Vali Loss: 1.209 Vali Acc: 0.450 Test Loss: 1.209 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 23 cost time: 0.5697684288024902
Epoch: 23, Steps: 3 | Train Loss: 0.605 Vali Loss: 1.202 Vali Acc: 0.450 Test Loss: 1.202 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 24 cost time: 0.6445250511169434
Epoch: 24, Steps: 3 | Train Loss: 0.557 Vali Loss: 1.194 Vali Acc: 0.450 Test Loss: 1.194 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 25 cost time: 0.6165010929107666
Epoch: 25, Steps: 3 | Train Loss: 0.536 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 26 cost time: 0.6366322040557861
Epoch: 26, Steps: 3 | Train Loss: 0.454 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 27 cost time: 0.6312365531921387
Epoch: 27, Steps: 3 | Train Loss: 0.450 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 28 cost time: 0.6421785354614258
Epoch: 28, Steps: 3 | Train Loss: 0.384 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 29 cost time: 0.6882176399230957
Epoch: 29, Steps: 3 | Train Loss: 0.340 Vali Loss: 1.159 Vali Acc: 0.525 Test Loss: 1.159 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 30 cost time: 0.6668927669525146
Epoch: 30, Steps: 3 | Train Loss: 0.314 Vali Loss: 1.150 Vali Acc: 0.550 Test Loss: 1.150 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 31 cost time: 0.5543467998504639
Epoch: 31, Steps: 3 | Train Loss: 0.303 Vali Loss: 1.144 Vali Acc: 0.575 Test Loss: 1.144 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 32 cost time: 0.611281156539917
Epoch: 32, Steps: 3 | Train Loss: 0.289 Vali Loss: 1.137 Vali Acc: 0.550 Test Loss: 1.137 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6090672016143799
Epoch: 33, Steps: 3 | Train Loss: 0.269 Vali Loss: 1.132 Vali Acc: 0.550 Test Loss: 1.132 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6499307155609131
Epoch: 34, Steps: 3 | Train Loss: 0.230 Vali Loss: 1.126 Vali Acc: 0.600 Test Loss: 1.126 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 35 cost time: 0.6141664981842041
Epoch: 35, Steps: 3 | Train Loss: 0.220 Vali Loss: 1.121 Vali Acc: 0.625 Test Loss: 1.121 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 36 cost time: 0.6166331768035889
Epoch: 36, Steps: 3 | Train Loss: 0.208 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 37 cost time: 0.5667815208435059
Epoch: 37, Steps: 3 | Train Loss: 0.212 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 38 cost time: 0.6233987808227539
Epoch: 38, Steps: 3 | Train Loss: 0.188 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6985886096954346
Epoch: 39, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.657526969909668
Epoch: 40, Steps: 3 | Train Loss: 0.178 Vali Loss: 1.120 Vali Acc: 0.625 Test Loss: 1.120 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6280257701873779
Epoch: 41, Steps: 3 | Train Loss: 0.133 Vali Loss: 1.116 Vali Acc: 0.625 Test Loss: 1.116 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 42 cost time: 0.6543347835540771
Epoch: 42, Steps: 3 | Train Loss: 0.135 Vali Loss: 1.112 Vali Acc: 0.625 Test Loss: 1.112 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 43 cost time: 0.6620762348175049
Epoch: 43, Steps: 3 | Train Loss: 0.131 Vali Loss: 1.115 Vali Acc: 0.625 Test Loss: 1.115 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6880621910095215
Epoch: 44, Steps: 3 | Train Loss: 0.117 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5711534023284912
Epoch: 45, Steps: 3 | Train Loss: 0.110 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6460654735565186
Epoch: 46, Steps: 3 | Train Loss: 0.093 Vali Loss: 1.122 Vali Acc: 0.600 Test Loss: 1.122 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6693353652954102
Epoch: 47, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6778013706207275
Epoch: 48, Steps: 3 | Train Loss: 0.099 Vali Loss: 1.123 Vali Acc: 0.600 Test Loss: 1.123 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7105097770690918
Epoch: 49, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.124 Vali Acc: 0.625 Test Loss: 1.124 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7556371688842773
Epoch: 50, Steps: 3 | Train Loss: 0.082 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6588208675384521
Epoch: 51, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.126 Vali Acc: 0.625 Test Loss: 1.126 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.5889809131622314
Epoch: 52, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.128 Vali Acc: 0.625 Test Loss: 1.128 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df128_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 31652
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2584121227264404
Epoch: 1, Steps: 3 | Train Loss: 1.696 Vali Loss: 1.627 Vali Acc: 0.275 Test Loss: 1.627 Test Acc: 0.275
Validation loss decreased (inf --> -0.274984).  Saving model ...
Epoch: 2 cost time: 0.6731369495391846
Epoch: 2, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.553 Vali Acc: 0.175 Test Loss: 1.553 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6331796646118164
Epoch: 3, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.474 Vali Acc: 0.175 Test Loss: 1.474 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5734193325042725
Epoch: 4, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.404 Vali Acc: 0.300 Test Loss: 1.404 Test Acc: 0.300
Validation loss decreased (-0.274984 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.6933414936065674
Epoch: 5, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.353 Vali Acc: 0.325 Test Loss: 1.353 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.747995138168335
Epoch: 6, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.295 Vali Acc: 0.350 Test Loss: 1.295 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.6292011737823486
Epoch: 7, Steps: 3 | Train Loss: 0.897 Vali Loss: 1.243 Vali Acc: 0.475 Test Loss: 1.243 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.6651763916015625
Epoch: 8, Steps: 3 | Train Loss: 0.845 Vali Loss: 1.198 Vali Acc: 0.600 Test Loss: 1.198 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.633281946182251
Epoch: 9, Steps: 3 | Train Loss: 0.752 Vali Loss: 1.163 Vali Acc: 0.575 Test Loss: 1.163 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6431827545166016
Epoch: 10, Steps: 3 | Train Loss: 0.553 Vali Loss: 1.133 Vali Acc: 0.600 Test Loss: 1.133 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.6620416641235352
Epoch: 11, Steps: 3 | Train Loss: 0.494 Vali Loss: 1.077 Vali Acc: 0.675 Test Loss: 1.077 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 0.6480329036712646
Epoch: 12, Steps: 3 | Train Loss: 0.457 Vali Loss: 1.020 Vali Acc: 0.650 Test Loss: 1.020 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6140909194946289
Epoch: 13, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.990 Vali Acc: 0.675 Test Loss: 0.990 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 14 cost time: 0.6361086368560791
Epoch: 14, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6925935745239258
Epoch: 15, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.961 Vali Acc: 0.675 Test Loss: 0.961 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 16 cost time: 0.7377371788024902
Epoch: 16, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.924 Vali Acc: 0.700 Test Loss: 0.924 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 17 cost time: 0.6276335716247559
Epoch: 17, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.876 Vali Acc: 0.700 Test Loss: 0.876 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 0.7306714057922363
Epoch: 18, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 0.7026333808898926
Epoch: 19, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.829 Vali Acc: 0.775 Test Loss: 0.829 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 20 cost time: 0.6400926113128662
Epoch: 20, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.826 Vali Acc: 0.750 Test Loss: 0.826 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7612564563751221
Epoch: 21, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7003235816955566
Epoch: 22, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.647181510925293
Epoch: 23, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7466235160827637
Epoch: 24, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.848 Vali Acc: 0.725 Test Loss: 0.848 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8299288749694824
Epoch: 25, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6893393993377686
Epoch: 26, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.840 Vali Acc: 0.725 Test Loss: 0.840 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7949783802032471
Epoch: 27, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.835 Vali Acc: 0.725 Test Loss: 0.835 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8189723491668701
Epoch: 28, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.824 Vali Acc: 0.725 Test Loss: 0.824 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7292516231536865
Epoch: 29, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 55652
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4469895362854004
Epoch: 1, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.453 Vali Acc: 0.325 Test Loss: 1.453 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.6020534038543701
Epoch: 2, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.423 Vali Acc: 0.425 Test Loss: 1.423 Test Acc: 0.425
Validation loss decreased (-0.324985 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.5616269111633301
Epoch: 3, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.398 Vali Acc: 0.400 Test Loss: 1.398 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7228937149047852
Epoch: 4, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.369 Vali Acc: 0.425 Test Loss: 1.369 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.6077442169189453
Epoch: 5, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.341 Vali Acc: 0.425 Test Loss: 1.341 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.5538606643676758
Epoch: 6, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.302 Vali Acc: 0.425 Test Loss: 1.302 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.6301460266113281
Epoch: 7, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.253 Vali Acc: 0.450 Test Loss: 1.253 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.5645599365234375
Epoch: 8, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.207 Vali Acc: 0.450 Test Loss: 1.207 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 0.5587141513824463
Epoch: 9, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.6967525482177734
Epoch: 10, Steps: 3 | Train Loss: 0.679 Vali Loss: 1.115 Vali Acc: 0.525 Test Loss: 1.115 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 11 cost time: 0.5793309211730957
Epoch: 11, Steps: 3 | Train Loss: 0.581 Vali Loss: 1.071 Vali Acc: 0.525 Test Loss: 1.071 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 12 cost time: 0.6014163494110107
Epoch: 12, Steps: 3 | Train Loss: 0.523 Vali Loss: 1.025 Vali Acc: 0.525 Test Loss: 1.025 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524990).  Saving model ...
Epoch: 13 cost time: 0.5814378261566162
Epoch: 13, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.982 Vali Acc: 0.625 Test Loss: 0.982 Test Acc: 0.625
Validation loss decreased (-0.524990 --> -0.624990).  Saving model ...
Epoch: 14 cost time: 0.6066737174987793
Epoch: 14, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.942 Vali Acc: 0.700 Test Loss: 0.942 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 0.6236569881439209
Epoch: 15, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.910 Vali Acc: 0.725 Test Loss: 0.910 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 0.6905944347381592
Epoch: 16, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.899 Vali Acc: 0.750 Test Loss: 0.899 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.5666263103485107
Epoch: 17, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 0.6436188220977783
Epoch: 18, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.901 Vali Acc: 0.725 Test Loss: 0.901 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.527137041091919
Epoch: 19, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.909 Vali Acc: 0.725 Test Loss: 0.909 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7567422389984131
Epoch: 20, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.906 Vali Acc: 0.725 Test Loss: 0.906 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5692670345306396
Epoch: 21, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6390476226806641
Epoch: 22, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.878 Vali Acc: 0.700 Test Loss: 0.878 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6261124610900879
Epoch: 23, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.867 Vali Acc: 0.725 Test Loss: 0.867 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.631817102432251
Epoch: 24, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.853 Vali Acc: 0.725 Test Loss: 0.853 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5615189075469971
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.841 Vali Acc: 0.725 Test Loss: 0.841 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6348097324371338
Epoch: 26, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.835 Vali Acc: 0.725 Test Loss: 0.835 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.728428840637207
Epoch: 27, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.832 Vali Acc: 0.725 Test Loss: 0.832 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 42660
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2617437839508057
Epoch: 1, Steps: 3 | Train Loss: 1.519 Vali Loss: 1.502 Vali Acc: 0.350 Test Loss: 1.502 Test Acc: 0.350
Validation loss decreased (inf --> -0.349985).  Saving model ...
Epoch: 2 cost time: 0.58193039894104
Epoch: 2, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.478 Vali Acc: 0.400 Test Loss: 1.478 Test Acc: 0.400
Validation loss decreased (-0.349985 --> -0.399985).  Saving model ...
Epoch: 3 cost time: 0.6749575138092041
Epoch: 3, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.445 Vali Acc: 0.400 Test Loss: 1.445 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.6236400604248047
Epoch: 4, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.409 Vali Acc: 0.350 Test Loss: 1.409 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7077770233154297
Epoch: 5, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7323727607727051
Epoch: 6, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.328 Vali Acc: 0.450 Test Loss: 1.328 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.6596298217773438
Epoch: 7, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.296 Vali Acc: 0.450 Test Loss: 1.296 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.5978326797485352
Epoch: 8, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.262 Vali Acc: 0.475 Test Loss: 1.262 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.6555109024047852
Epoch: 9, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.6274533271789551
Epoch: 10, Steps: 3 | Train Loss: 0.809 Vali Loss: 1.209 Vali Acc: 0.525 Test Loss: 1.209 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.6639025211334229
Epoch: 11, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.188 Vali Acc: 0.525 Test Loss: 1.188 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 0.566866397857666
Epoch: 12, Steps: 3 | Train Loss: 0.618 Vali Loss: 1.158 Vali Acc: 0.575 Test Loss: 1.158 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 0.6645760536193848
Epoch: 13, Steps: 3 | Train Loss: 0.546 Vali Loss: 1.132 Vali Acc: 0.600 Test Loss: 1.132 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.5232596397399902
Epoch: 14, Steps: 3 | Train Loss: 0.558 Vali Loss: 1.107 Vali Acc: 0.600 Test Loss: 1.107 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.5573587417602539
Epoch: 15, Steps: 3 | Train Loss: 0.470 Vali Loss: 1.090 Vali Acc: 0.625 Test Loss: 1.090 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 16 cost time: 0.5278353691101074
Epoch: 16, Steps: 3 | Train Loss: 0.437 Vali Loss: 1.068 Vali Acc: 0.625 Test Loss: 1.068 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 0.5841760635375977
Epoch: 17, Steps: 3 | Train Loss: 0.394 Vali Loss: 1.049 Vali Acc: 0.675 Test Loss: 1.049 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 0.5854384899139404
Epoch: 18, Steps: 3 | Train Loss: 0.299 Vali Loss: 1.036 Vali Acc: 0.675 Test Loss: 1.036 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 19 cost time: 0.6015641689300537
Epoch: 19, Steps: 3 | Train Loss: 0.277 Vali Loss: 1.017 Vali Acc: 0.675 Test Loss: 1.017 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 20 cost time: 0.5549190044403076
Epoch: 20, Steps: 3 | Train Loss: 0.213 Vali Loss: 1.010 Vali Acc: 0.650 Test Loss: 1.010 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6256492137908936
Epoch: 21, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.013 Vali Acc: 0.675 Test Loss: 1.013 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 22 cost time: 0.546717643737793
Epoch: 22, Steps: 3 | Train Loss: 0.130 Vali Loss: 1.020 Vali Acc: 0.650 Test Loss: 1.020 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5485670566558838
Epoch: 23, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.031 Vali Acc: 0.650 Test Loss: 1.031 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5525729656219482
Epoch: 24, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.025 Vali Acc: 0.700 Test Loss: 1.025 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 25 cost time: 0.6108145713806152
Epoch: 25, Steps: 3 | Train Loss: 0.083 Vali Loss: 1.005 Vali Acc: 0.700 Test Loss: 1.005 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 26 cost time: 0.5348024368286133
Epoch: 26, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.984 Vali Acc: 0.725 Test Loss: 0.984 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 27 cost time: 0.5871453285217285
Epoch: 27, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.966 Vali Acc: 0.700 Test Loss: 0.966 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7011713981628418
Epoch: 28, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.957 Vali Acc: 0.700 Test Loss: 0.957 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7523164749145508
Epoch: 29, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.957 Vali Acc: 0.700 Test Loss: 0.957 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.599210262298584
Epoch: 30, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.961 Vali Acc: 0.675 Test Loss: 0.961 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6299505233764648
Epoch: 31, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.971 Vali Acc: 0.675 Test Loss: 0.971 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5845189094543457
Epoch: 32, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.985 Vali Acc: 0.675 Test Loss: 0.985 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6489787101745605
Epoch: 33, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6759042739868164
Epoch: 34, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6793797016143799
Epoch: 35, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.016 Vali Acc: 0.700 Test Loss: 1.016 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6888527870178223
Epoch: 36, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 36612
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.338834524154663
Epoch: 1, Steps: 3 | Train Loss: 1.718 Vali Loss: 1.771 Vali Acc: 0.175 Test Loss: 1.771 Test Acc: 0.175
Validation loss decreased (inf --> -0.174982).  Saving model ...
Epoch: 2 cost time: 0.5702683925628662
Epoch: 2, Steps: 3 | Train Loss: 1.562 Vali Loss: 1.718 Vali Acc: 0.150 Test Loss: 1.718 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6097474098205566
Epoch: 3, Steps: 3 | Train Loss: 1.525 Vali Loss: 1.675 Vali Acc: 0.175 Test Loss: 1.675 Test Acc: 0.175
Validation loss decreased (-0.174982 --> -0.174983).  Saving model ...
Epoch: 4 cost time: 0.5517585277557373
Epoch: 4, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.635 Vali Acc: 0.200 Test Loss: 1.635 Test Acc: 0.200
Validation loss decreased (-0.174983 --> -0.199984).  Saving model ...
Epoch: 5 cost time: 0.7028770446777344
Epoch: 5, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.602 Vali Acc: 0.225 Test Loss: 1.602 Test Acc: 0.225
Validation loss decreased (-0.199984 --> -0.224984).  Saving model ...
Epoch: 6 cost time: 0.6053476333618164
Epoch: 6, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.576 Vali Acc: 0.300 Test Loss: 1.576 Test Acc: 0.300
Validation loss decreased (-0.224984 --> -0.299984).  Saving model ...
Epoch: 7 cost time: 0.5782294273376465
Epoch: 7, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.547 Vali Acc: 0.325 Test Loss: 1.547 Test Acc: 0.325
Validation loss decreased (-0.299984 --> -0.324985).  Saving model ...
Epoch: 8 cost time: 0.5669903755187988
Epoch: 8, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.515 Vali Acc: 0.350 Test Loss: 1.515 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 9 cost time: 0.5938522815704346
Epoch: 9, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.486 Vali Acc: 0.350 Test Loss: 1.486 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 10 cost time: 0.5976738929748535
Epoch: 10, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.456 Vali Acc: 0.425 Test Loss: 1.456 Test Acc: 0.425
Validation loss decreased (-0.349985 --> -0.424985).  Saving model ...
Epoch: 11 cost time: 0.6782858371734619
Epoch: 11, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.426 Vali Acc: 0.475 Test Loss: 1.426 Test Acc: 0.475
Validation loss decreased (-0.424985 --> -0.474986).  Saving model ...
Epoch: 12 cost time: 0.5332348346710205
Epoch: 12, Steps: 3 | Train Loss: 0.889 Vali Loss: 1.401 Vali Acc: 0.450 Test Loss: 1.401 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6298508644104004
Epoch: 13, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.373 Vali Acc: 0.475 Test Loss: 1.373 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 14 cost time: 0.5687663555145264
Epoch: 14, Steps: 3 | Train Loss: 0.725 Vali Loss: 1.352 Vali Acc: 0.500 Test Loss: 1.352 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499986).  Saving model ...
Epoch: 15 cost time: 0.5986435413360596
Epoch: 15, Steps: 3 | Train Loss: 0.604 Vali Loss: 1.335 Vali Acc: 0.500 Test Loss: 1.335 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 16 cost time: 0.51983642578125
Epoch: 16, Steps: 3 | Train Loss: 0.575 Vali Loss: 1.316 Vali Acc: 0.550 Test Loss: 1.316 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 17 cost time: 0.6951127052307129
Epoch: 17, Steps: 3 | Train Loss: 0.475 Vali Loss: 1.303 Vali Acc: 0.550 Test Loss: 1.303 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 18 cost time: 0.5715503692626953
Epoch: 18, Steps: 3 | Train Loss: 0.428 Vali Loss: 1.288 Vali Acc: 0.550 Test Loss: 1.288 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 19 cost time: 0.5069253444671631
Epoch: 19, Steps: 3 | Train Loss: 0.380 Vali Loss: 1.272 Vali Acc: 0.550 Test Loss: 1.272 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 20 cost time: 0.6220262050628662
Epoch: 20, Steps: 3 | Train Loss: 0.341 Vali Loss: 1.256 Vali Acc: 0.550 Test Loss: 1.256 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 21 cost time: 0.5543053150177002
Epoch: 21, Steps: 3 | Train Loss: 0.337 Vali Loss: 1.250 Vali Acc: 0.550 Test Loss: 1.250 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 22 cost time: 0.5144777297973633
Epoch: 22, Steps: 3 | Train Loss: 0.264 Vali Loss: 1.253 Vali Acc: 0.575 Test Loss: 1.253 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 23 cost time: 0.5832474231719971
Epoch: 23, Steps: 3 | Train Loss: 0.259 Vali Loss: 1.251 Vali Acc: 0.575 Test Loss: 1.251 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 24 cost time: 0.583728551864624
Epoch: 24, Steps: 3 | Train Loss: 0.193 Vali Loss: 1.250 Vali Acc: 0.575 Test Loss: 1.250 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 25 cost time: 0.6113741397857666
Epoch: 25, Steps: 3 | Train Loss: 0.152 Vali Loss: 1.252 Vali Acc: 0.575 Test Loss: 1.252 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7171399593353271
Epoch: 26, Steps: 3 | Train Loss: 0.155 Vali Loss: 1.253 Vali Acc: 0.575 Test Loss: 1.253 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6027908325195312
Epoch: 27, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.252 Vali Acc: 0.575 Test Loss: 1.252 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7121574878692627
Epoch: 28, Steps: 3 | Train Loss: 0.118 Vali Loss: 1.240 Vali Acc: 0.575 Test Loss: 1.240 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 29 cost time: 0.6313340663909912
Epoch: 29, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.238 Vali Acc: 0.600 Test Loss: 1.238 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 30 cost time: 0.6852996349334717
Epoch: 30, Steps: 3 | Train Loss: 0.082 Vali Loss: 1.235 Vali Acc: 0.625 Test Loss: 1.235 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 31 cost time: 0.6546118259429932
Epoch: 31, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.231 Vali Acc: 0.625 Test Loss: 1.231 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 32 cost time: 0.6739175319671631
Epoch: 32, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.233 Vali Acc: 0.625 Test Loss: 1.233 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5860457420349121
Epoch: 33, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.233 Vali Acc: 0.650 Test Loss: 1.233 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 34 cost time: 0.6322183609008789
Epoch: 34, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.233 Vali Acc: 0.650 Test Loss: 1.233 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 35 cost time: 0.6011090278625488
Epoch: 35, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.234 Vali Acc: 0.650 Test Loss: 1.234 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.601717472076416
Epoch: 36, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.239 Vali Acc: 0.650 Test Loss: 1.239 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6792986392974854
Epoch: 37, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.243 Vali Acc: 0.650 Test Loss: 1.243 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.659623384475708
Epoch: 38, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.245 Vali Acc: 0.650 Test Loss: 1.245 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6931407451629639
Epoch: 39, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.247 Vali Acc: 0.650 Test Loss: 1.247 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6677279472351074
Epoch: 40, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.244 Vali Acc: 0.675 Test Loss: 1.244 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 41 cost time: 0.628814697265625
Epoch: 41, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.241 Vali Acc: 0.675 Test Loss: 1.241 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 42 cost time: 0.6049432754516602
Epoch: 42, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.241 Vali Acc: 0.675 Test Loss: 1.241 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 43 cost time: 0.6282057762145996
Epoch: 43, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.240 Vali Acc: 0.675 Test Loss: 1.240 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 44 cost time: 0.6154015064239502
Epoch: 44, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.239 Vali Acc: 0.675 Test Loss: 1.239 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 45 cost time: 0.6691226959228516
Epoch: 45, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.240 Vali Acc: 0.675 Test Loss: 1.240 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6825754642486572
Epoch: 46, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.240 Vali Acc: 0.675 Test Loss: 1.240 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6579229831695557
Epoch: 47, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.242 Vali Acc: 0.675 Test Loss: 1.242 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6804404258728027
Epoch: 48, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.244 Vali Acc: 0.675 Test Loss: 1.244 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6271378993988037
Epoch: 49, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.246 Vali Acc: 0.675 Test Loss: 1.246 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6133887767791748
Epoch: 50, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.245 Vali Acc: 0.675 Test Loss: 1.245 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.779984712600708
Epoch: 51, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.249 Vali Acc: 0.675 Test Loss: 1.249 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5870668888092041
Epoch: 52, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.251 Vali Acc: 0.675 Test Loss: 1.251 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.8351681232452393
Epoch: 53, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.253 Vali Acc: 0.675 Test Loss: 1.253 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.6622116565704346
Epoch: 54, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.255 Vali Acc: 0.675 Test Loss: 1.255 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 32836
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.301896095275879
Epoch: 1, Steps: 3 | Train Loss: 1.510 Vali Loss: 1.599 Vali Acc: 0.200 Test Loss: 1.599 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 0.6117510795593262
Epoch: 2, Steps: 3 | Train Loss: 1.565 Vali Loss: 1.574 Vali Acc: 0.225 Test Loss: 1.574 Test Acc: 0.225
Validation loss decreased (-0.199984 --> -0.224984).  Saving model ...
Epoch: 3 cost time: 0.7300088405609131
Epoch: 3, Steps: 3 | Train Loss: 1.554 Vali Loss: 1.556 Vali Acc: 0.175 Test Loss: 1.556 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5604112148284912
Epoch: 4, Steps: 3 | Train Loss: 1.512 Vali Loss: 1.539 Vali Acc: 0.225 Test Loss: 1.539 Test Acc: 0.225
Validation loss decreased (-0.224984 --> -0.224985).  Saving model ...
Epoch: 5 cost time: 0.5778300762176514
Epoch: 5, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.521 Vali Acc: 0.225 Test Loss: 1.521 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224985).  Saving model ...
Epoch: 6 cost time: 0.6160392761230469
Epoch: 6, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.504 Vali Acc: 0.225 Test Loss: 1.504 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224985).  Saving model ...
Epoch: 7 cost time: 0.5716884136199951
Epoch: 7, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.481 Vali Acc: 0.250 Test Loss: 1.481 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249985).  Saving model ...
Epoch: 8 cost time: 0.6389355659484863
Epoch: 8, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.459 Vali Acc: 0.250 Test Loss: 1.459 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 9 cost time: 0.6934242248535156
Epoch: 9, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.436 Vali Acc: 0.275 Test Loss: 1.436 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 10 cost time: 0.6881358623504639
Epoch: 10, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.415 Vali Acc: 0.325 Test Loss: 1.415 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 11 cost time: 0.6257507801055908
Epoch: 11, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.390 Vali Acc: 0.350 Test Loss: 1.390 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 12 cost time: 0.698232889175415
Epoch: 12, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.366 Vali Acc: 0.375 Test Loss: 1.366 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 13 cost time: 0.6777441501617432
Epoch: 13, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.348 Vali Acc: 0.450 Test Loss: 1.348 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 14 cost time: 0.7191047668457031
Epoch: 14, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.327 Vali Acc: 0.475 Test Loss: 1.327 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 15 cost time: 0.7270877361297607
Epoch: 15, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.308 Vali Acc: 0.500 Test Loss: 1.308 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 16 cost time: 0.6619067192077637
Epoch: 16, Steps: 3 | Train Loss: 0.839 Vali Loss: 1.290 Vali Acc: 0.525 Test Loss: 1.290 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 17 cost time: 0.6931955814361572
Epoch: 17, Steps: 3 | Train Loss: 0.638 Vali Loss: 1.271 Vali Acc: 0.525 Test Loss: 1.271 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 18 cost time: 0.5986828804016113
Epoch: 18, Steps: 3 | Train Loss: 0.641 Vali Loss: 1.254 Vali Acc: 0.525 Test Loss: 1.254 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 19 cost time: 0.6478664875030518
Epoch: 19, Steps: 3 | Train Loss: 0.598 Vali Loss: 1.235 Vali Acc: 0.575 Test Loss: 1.235 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.6945931911468506
Epoch: 20, Steps: 3 | Train Loss: 0.523 Vali Loss: 1.217 Vali Acc: 0.575 Test Loss: 1.217 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.637887716293335
Epoch: 21, Steps: 3 | Train Loss: 0.527 Vali Loss: 1.200 Vali Acc: 0.550 Test Loss: 1.200 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5929563045501709
Epoch: 22, Steps: 3 | Train Loss: 0.473 Vali Loss: 1.186 Vali Acc: 0.550 Test Loss: 1.186 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.569267988204956
Epoch: 23, Steps: 3 | Train Loss: 0.453 Vali Loss: 1.179 Vali Acc: 0.575 Test Loss: 1.179 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 24 cost time: 0.6765470504760742
Epoch: 24, Steps: 3 | Train Loss: 0.397 Vali Loss: 1.168 Vali Acc: 0.575 Test Loss: 1.168 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 25 cost time: 0.6149284839630127
Epoch: 25, Steps: 3 | Train Loss: 0.326 Vali Loss: 1.166 Vali Acc: 0.600 Test Loss: 1.166 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 26 cost time: 0.6571152210235596
Epoch: 26, Steps: 3 | Train Loss: 0.341 Vali Loss: 1.168 Vali Acc: 0.600 Test Loss: 1.168 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6030828952789307
Epoch: 27, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.163 Vali Acc: 0.600 Test Loss: 1.163 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 28 cost time: 0.9140713214874268
Epoch: 28, Steps: 3 | Train Loss: 0.229 Vali Loss: 1.154 Vali Acc: 0.625 Test Loss: 1.154 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 29 cost time: 0.6874010562896729
Epoch: 29, Steps: 3 | Train Loss: 0.211 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 30 cost time: 0.6920905113220215
Epoch: 30, Steps: 3 | Train Loss: 0.222 Vali Loss: 1.135 Vali Acc: 0.625 Test Loss: 1.135 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 31 cost time: 0.6568922996520996
Epoch: 31, Steps: 3 | Train Loss: 0.188 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6572518348693848
Epoch: 32, Steps: 3 | Train Loss: 0.148 Vali Loss: 1.143 Vali Acc: 0.625 Test Loss: 1.143 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6987214088439941
Epoch: 33, Steps: 3 | Train Loss: 0.133 Vali Loss: 1.147 Vali Acc: 0.625 Test Loss: 1.147 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.797217845916748
Epoch: 34, Steps: 3 | Train Loss: 0.124 Vali Loss: 1.153 Vali Acc: 0.625 Test Loss: 1.153 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6249251365661621
Epoch: 35, Steps: 3 | Train Loss: 0.127 Vali Loss: 1.154 Vali Acc: 0.625 Test Loss: 1.154 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6647171974182129
Epoch: 36, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.155 Vali Acc: 0.625 Test Loss: 1.155 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6617064476013184
Epoch: 37, Steps: 3 | Train Loss: 0.115 Vali Loss: 1.159 Vali Acc: 0.650 Test Loss: 1.159 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649988).  Saving model ...
Epoch: 38 cost time: 0.6296124458312988
Epoch: 38, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.160 Vali Acc: 0.650 Test Loss: 1.160 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6331963539123535
Epoch: 39, Steps: 3 | Train Loss: 0.074 Vali Loss: 1.160 Vali Acc: 0.650 Test Loss: 1.160 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6256721019744873
Epoch: 40, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.162 Vali Acc: 0.650 Test Loss: 1.162 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.639153003692627
Epoch: 41, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.159 Vali Acc: 0.675 Test Loss: 1.159 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 42 cost time: 0.6841087341308594
Epoch: 42, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.157 Vali Acc: 0.675 Test Loss: 1.157 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 43 cost time: 0.6486735343933105
Epoch: 43, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.156 Vali Acc: 0.675 Test Loss: 1.156 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 44 cost time: 0.6065833568572998
Epoch: 44, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.164 Vali Acc: 0.650 Test Loss: 1.164 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6465861797332764
Epoch: 45, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.170 Vali Acc: 0.650 Test Loss: 1.170 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6069850921630859
Epoch: 46, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.172 Vali Acc: 0.625 Test Loss: 1.172 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5681440830230713
Epoch: 47, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.175 Vali Acc: 0.625 Test Loss: 1.175 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6169290542602539
Epoch: 48, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.172 Vali Acc: 0.650 Test Loss: 1.172 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6194782257080078
Epoch: 49, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.174 Vali Acc: 0.650 Test Loss: 1.174 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6593513488769531
Epoch: 50, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.175 Vali Acc: 0.650 Test Loss: 1.175 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.7234718799591064
Epoch: 51, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.175 Vali Acc: 0.650 Test Loss: 1.175 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.679095983505249
Epoch: 52, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.177 Vali Acc: 0.650 Test Loss: 1.177 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.8185012340545654
Epoch: 53, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.175 Vali Acc: 0.650 Test Loss: 1.175 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 26852
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4388506412506104
Epoch: 1, Steps: 3 | Train Loss: 1.584 Vali Loss: 1.482 Vali Acc: 0.200 Test Loss: 1.482 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.7022836208343506
Epoch: 2, Steps: 3 | Train Loss: 1.605 Vali Loss: 1.491 Vali Acc: 0.175 Test Loss: 1.491 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6413114070892334
Epoch: 3, Steps: 3 | Train Loss: 1.583 Vali Loss: 1.500 Vali Acc: 0.200 Test Loss: 1.500 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7752895355224609
Epoch: 4, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.504 Vali Acc: 0.250 Test Loss: 1.504 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249985).  Saving model ...
Epoch: 5 cost time: 0.6210289001464844
Epoch: 5, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.504 Vali Acc: 0.225 Test Loss: 1.504 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.72048020362854
Epoch: 6, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.496 Vali Acc: 0.225 Test Loss: 1.496 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6964125633239746
Epoch: 7, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.486 Vali Acc: 0.200 Test Loss: 1.486 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6992096900939941
Epoch: 8, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.472 Vali Acc: 0.250 Test Loss: 1.472 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 9 cost time: 0.5803639888763428
Epoch: 9, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.456 Vali Acc: 0.250 Test Loss: 1.456 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 10 cost time: 0.6803627014160156
Epoch: 10, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.437 Vali Acc: 0.250 Test Loss: 1.437 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 11 cost time: 0.7049095630645752
Epoch: 11, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.418 Vali Acc: 0.275 Test Loss: 1.418 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 12 cost time: 0.6973202228546143
Epoch: 12, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.398 Vali Acc: 0.275 Test Loss: 1.398 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 13 cost time: 0.7336935997009277
Epoch: 13, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.381 Vali Acc: 0.350 Test Loss: 1.381 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 14 cost time: 0.6345937252044678
Epoch: 14, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.364 Vali Acc: 0.350 Test Loss: 1.364 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 15 cost time: 0.6051850318908691
Epoch: 15, Steps: 3 | Train Loss: 0.955 Vali Loss: 1.343 Vali Acc: 0.375 Test Loss: 1.343 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 16 cost time: 0.6061029434204102
Epoch: 16, Steps: 3 | Train Loss: 0.896 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 17 cost time: 0.7361700534820557
Epoch: 17, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.307 Vali Acc: 0.400 Test Loss: 1.307 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 18 cost time: 0.626516580581665
Epoch: 18, Steps: 3 | Train Loss: 0.794 Vali Loss: 1.293 Vali Acc: 0.475 Test Loss: 1.293 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 19 cost time: 0.6439876556396484
Epoch: 19, Steps: 3 | Train Loss: 0.795 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 20 cost time: 0.6890277862548828
Epoch: 20, Steps: 3 | Train Loss: 0.672 Vali Loss: 1.267 Vali Acc: 0.525 Test Loss: 1.267 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 21 cost time: 0.613353967666626
Epoch: 21, Steps: 3 | Train Loss: 0.671 Vali Loss: 1.254 Vali Acc: 0.525 Test Loss: 1.254 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 22 cost time: 0.5993092060089111
Epoch: 22, Steps: 3 | Train Loss: 0.687 Vali Loss: 1.245 Vali Acc: 0.525 Test Loss: 1.245 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 23 cost time: 0.6287312507629395
Epoch: 23, Steps: 3 | Train Loss: 0.611 Vali Loss: 1.233 Vali Acc: 0.525 Test Loss: 1.233 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 24 cost time: 0.6239328384399414
Epoch: 24, Steps: 3 | Train Loss: 0.529 Vali Loss: 1.223 Vali Acc: 0.525 Test Loss: 1.223 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 25 cost time: 0.6070563793182373
Epoch: 25, Steps: 3 | Train Loss: 0.547 Vali Loss: 1.212 Vali Acc: 0.525 Test Loss: 1.212 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 26 cost time: 0.6149203777313232
Epoch: 26, Steps: 3 | Train Loss: 0.476 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5787873268127441
Epoch: 27, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5763635635375977
Epoch: 28, Steps: 3 | Train Loss: 0.425 Vali Loss: 1.188 Vali Acc: 0.525 Test Loss: 1.188 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 29 cost time: 0.5763154029846191
Epoch: 29, Steps: 3 | Train Loss: 0.401 Vali Loss: 1.180 Vali Acc: 0.525 Test Loss: 1.180 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 30 cost time: 0.5684099197387695
Epoch: 30, Steps: 3 | Train Loss: 0.312 Vali Loss: 1.171 Vali Acc: 0.525 Test Loss: 1.171 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 31 cost time: 0.6155235767364502
Epoch: 31, Steps: 3 | Train Loss: 0.309 Vali Loss: 1.165 Vali Acc: 0.525 Test Loss: 1.165 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 32 cost time: 0.7795326709747314
Epoch: 32, Steps: 3 | Train Loss: 0.311 Vali Loss: 1.158 Vali Acc: 0.550 Test Loss: 1.158 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 33 cost time: 0.6578981876373291
Epoch: 33, Steps: 3 | Train Loss: 0.263 Vali Loss: 1.154 Vali Acc: 0.575 Test Loss: 1.154 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 34 cost time: 0.6584029197692871
Epoch: 34, Steps: 3 | Train Loss: 0.253 Vali Loss: 1.148 Vali Acc: 0.600 Test Loss: 1.148 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 35 cost time: 0.7702698707580566
Epoch: 35, Steps: 3 | Train Loss: 0.198 Vali Loss: 1.144 Vali Acc: 0.575 Test Loss: 1.144 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6051921844482422
Epoch: 36, Steps: 3 | Train Loss: 0.187 Vali Loss: 1.142 Vali Acc: 0.575 Test Loss: 1.142 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6245298385620117
Epoch: 37, Steps: 3 | Train Loss: 0.174 Vali Loss: 1.138 Vali Acc: 0.600 Test Loss: 1.138 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 38 cost time: 0.7187728881835938
Epoch: 38, Steps: 3 | Train Loss: 0.156 Vali Loss: 1.133 Vali Acc: 0.600 Test Loss: 1.133 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 39 cost time: 0.6456377506256104
Epoch: 39, Steps: 3 | Train Loss: 0.142 Vali Loss: 1.128 Vali Acc: 0.600 Test Loss: 1.128 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 40 cost time: 0.7228686809539795
Epoch: 40, Steps: 3 | Train Loss: 0.119 Vali Loss: 1.125 Vali Acc: 0.600 Test Loss: 1.125 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 41 cost time: 0.755584716796875
Epoch: 41, Steps: 3 | Train Loss: 0.108 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 42 cost time: 0.7170767784118652
Epoch: 42, Steps: 3 | Train Loss: 0.101 Vali Loss: 1.114 Vali Acc: 0.625 Test Loss: 1.114 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 43 cost time: 0.6443381309509277
Epoch: 43, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.109 Vali Acc: 0.625 Test Loss: 1.109 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 44 cost time: 0.7626872062683105
Epoch: 44, Steps: 3 | Train Loss: 0.098 Vali Loss: 1.104 Vali Acc: 0.650 Test Loss: 1.104 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 45 cost time: 0.6454637050628662
Epoch: 45, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 46 cost time: 0.6555488109588623
Epoch: 46, Steps: 3 | Train Loss: 0.083 Vali Loss: 1.102 Vali Acc: 0.675 Test Loss: 1.102 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 47 cost time: 0.6623501777648926
Epoch: 47, Steps: 3 | Train Loss: 0.082 Vali Loss: 1.099 Vali Acc: 0.675 Test Loss: 1.099 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 48 cost time: 0.8030941486358643
Epoch: 48, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.102 Vali Acc: 0.675 Test Loss: 1.102 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.66963791847229
Epoch: 49, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.104 Vali Acc: 0.675 Test Loss: 1.104 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7302134037017822
Epoch: 50, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.8060917854309082
Epoch: 51, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.106 Vali Acc: 0.675 Test Loss: 1.106 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.698432207107544
Epoch: 52, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.788433313369751
Epoch: 53, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.107 Vali Acc: 0.675 Test Loss: 1.107 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6306257247924805
Epoch: 54, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.107 Vali Acc: 0.675 Test Loss: 1.107 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.7359051704406738
Epoch: 55, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.107 Vali Acc: 0.675 Test Loss: 1.107 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.654754638671875
Epoch: 56, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.106 Vali Acc: 0.675 Test Loss: 1.106 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.6564195156097412
Epoch: 57, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.108 Vali Acc: 0.675 Test Loss: 1.108 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 25476
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.404907464981079
Epoch: 1, Steps: 3 | Train Loss: 1.606 Vali Loss: 1.572 Vali Acc: 0.250 Test Loss: 1.572 Test Acc: 0.250
Validation loss decreased (inf --> -0.249984).  Saving model ...
Epoch: 2 cost time: 0.7439601421356201
Epoch: 2, Steps: 3 | Train Loss: 1.561 Vali Loss: 1.559 Vali Acc: 0.300 Test Loss: 1.559 Test Acc: 0.300
Validation loss decreased (-0.249984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 0.6807780265808105
Epoch: 3, Steps: 3 | Train Loss: 1.612 Vali Loss: 1.553 Vali Acc: 0.325 Test Loss: 1.553 Test Acc: 0.325
Validation loss decreased (-0.299984 --> -0.324984).  Saving model ...
Epoch: 4 cost time: 0.6981480121612549
Epoch: 4, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.540 Vali Acc: 0.325 Test Loss: 1.540 Test Acc: 0.325
Validation loss decreased (-0.324984 --> -0.324985).  Saving model ...
Epoch: 5 cost time: 0.6123917102813721
Epoch: 5, Steps: 3 | Train Loss: 1.531 Vali Loss: 1.524 Vali Acc: 0.375 Test Loss: 1.524 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374985).  Saving model ...
Epoch: 6 cost time: 0.6902656555175781
Epoch: 6, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.506 Vali Acc: 0.375 Test Loss: 1.506 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 7 cost time: 0.6938192844390869
Epoch: 7, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.486 Vali Acc: 0.425 Test Loss: 1.486 Test Acc: 0.425
Validation loss decreased (-0.374985 --> -0.424985).  Saving model ...
Epoch: 8 cost time: 0.7541425228118896
Epoch: 8, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.466 Vali Acc: 0.450 Test Loss: 1.466 Test Acc: 0.450
Validation loss decreased (-0.424985 --> -0.449985).  Saving model ...
Epoch: 9 cost time: 0.6240627765655518
Epoch: 9, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.446 Vali Acc: 0.475 Test Loss: 1.446 Test Acc: 0.475
Validation loss decreased (-0.449985 --> -0.474986).  Saving model ...
Epoch: 10 cost time: 0.6276431083679199
Epoch: 10, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.427 Vali Acc: 0.450 Test Loss: 1.427 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.741278886795044
Epoch: 11, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.406 Vali Acc: 0.425 Test Loss: 1.406 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6169278621673584
Epoch: 12, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.387 Vali Acc: 0.425 Test Loss: 1.387 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6402976512908936
Epoch: 13, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.370 Vali Acc: 0.450 Test Loss: 1.370 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.669407844543457
Epoch: 14, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.355 Vali Acc: 0.475 Test Loss: 1.355 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 15 cost time: 0.6927714347839355
Epoch: 15, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.337 Vali Acc: 0.475 Test Loss: 1.337 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474987).  Saving model ...
Epoch: 16 cost time: 0.6257407665252686
Epoch: 16, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.322 Vali Acc: 0.475 Test Loss: 1.322 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 17 cost time: 0.6386632919311523
Epoch: 17, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 18 cost time: 0.5802016258239746
Epoch: 18, Steps: 3 | Train Loss: 0.796 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 19 cost time: 0.7230124473571777
Epoch: 19, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.277 Vali Acc: 0.450 Test Loss: 1.277 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7072334289550781
Epoch: 20, Steps: 3 | Train Loss: 0.730 Vali Loss: 1.265 Vali Acc: 0.450 Test Loss: 1.265 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8935832977294922
Epoch: 21, Steps: 3 | Train Loss: 0.670 Vali Loss: 1.250 Vali Acc: 0.450 Test Loss: 1.250 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7131731510162354
Epoch: 22, Steps: 3 | Train Loss: 0.628 Vali Loss: 1.245 Vali Acc: 0.450 Test Loss: 1.245 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6531381607055664
Epoch: 23, Steps: 3 | Train Loss: 0.656 Vali Loss: 1.240 Vali Acc: 0.450 Test Loss: 1.240 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6450169086456299
Epoch: 24, Steps: 3 | Train Loss: 0.653 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 25 cost time: 0.7201228141784668
Epoch: 25, Steps: 3 | Train Loss: 0.537 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 26 cost time: 0.642615795135498
Epoch: 26, Steps: 3 | Train Loss: 0.538 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 27 cost time: 0.6134610176086426
Epoch: 27, Steps: 3 | Train Loss: 0.525 Vali Loss: 1.215 Vali Acc: 0.525 Test Loss: 1.215 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 28 cost time: 0.6832060813903809
Epoch: 28, Steps: 3 | Train Loss: 0.439 Vali Loss: 1.210 Vali Acc: 0.525 Test Loss: 1.210 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 29 cost time: 0.6357913017272949
Epoch: 29, Steps: 3 | Train Loss: 0.396 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6850636005401611
Epoch: 30, Steps: 3 | Train Loss: 0.388 Vali Loss: 1.206 Vali Acc: 0.525 Test Loss: 1.206 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 31 cost time: 0.6866707801818848
Epoch: 31, Steps: 3 | Train Loss: 0.334 Vali Loss: 1.199 Vali Acc: 0.525 Test Loss: 1.199 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 32 cost time: 0.6088154315948486
Epoch: 32, Steps: 3 | Train Loss: 0.410 Vali Loss: 1.198 Vali Acc: 0.525 Test Loss: 1.198 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 33 cost time: 0.6558728218078613
Epoch: 33, Steps: 3 | Train Loss: 0.348 Vali Loss: 1.200 Vali Acc: 0.525 Test Loss: 1.200 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6969819068908691
Epoch: 34, Steps: 3 | Train Loss: 0.292 Vali Loss: 1.194 Vali Acc: 0.550 Test Loss: 1.194 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 35 cost time: 0.5938067436218262
Epoch: 35, Steps: 3 | Train Loss: 0.259 Vali Loss: 1.195 Vali Acc: 0.575 Test Loss: 1.195 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 36 cost time: 0.5927016735076904
Epoch: 36, Steps: 3 | Train Loss: 0.241 Vali Loss: 1.192 Vali Acc: 0.575 Test Loss: 1.192 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 37 cost time: 0.6429288387298584
Epoch: 37, Steps: 3 | Train Loss: 0.243 Vali Loss: 1.191 Vali Acc: 0.575 Test Loss: 1.191 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 38 cost time: 0.5943567752838135
Epoch: 38, Steps: 3 | Train Loss: 0.238 Vali Loss: 1.191 Vali Acc: 0.575 Test Loss: 1.191 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 39 cost time: 0.6498873233795166
Epoch: 39, Steps: 3 | Train Loss: 0.256 Vali Loss: 1.191 Vali Acc: 0.575 Test Loss: 1.191 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6835532188415527
Epoch: 40, Steps: 3 | Train Loss: 0.213 Vali Loss: 1.189 Vali Acc: 0.600 Test Loss: 1.189 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 41 cost time: 0.6632113456726074
Epoch: 41, Steps: 3 | Train Loss: 0.223 Vali Loss: 1.184 Vali Acc: 0.600 Test Loss: 1.184 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 42 cost time: 0.6060500144958496
Epoch: 42, Steps: 3 | Train Loss: 0.191 Vali Loss: 1.181 Vali Acc: 0.650 Test Loss: 1.181 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 43 cost time: 0.6656062602996826
Epoch: 43, Steps: 3 | Train Loss: 0.153 Vali Loss: 1.182 Vali Acc: 0.650 Test Loss: 1.182 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6201515197753906
Epoch: 44, Steps: 3 | Train Loss: 0.154 Vali Loss: 1.181 Vali Acc: 0.675 Test Loss: 1.181 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 45 cost time: 0.6183443069458008
Epoch: 45, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.187 Vali Acc: 0.675 Test Loss: 1.187 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5713565349578857
Epoch: 46, Steps: 3 | Train Loss: 0.142 Vali Loss: 1.190 Vali Acc: 0.700 Test Loss: 1.190 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699988).  Saving model ...
Epoch: 47 cost time: 0.7119381427764893
Epoch: 47, Steps: 3 | Train Loss: 0.129 Vali Loss: 1.197 Vali Acc: 0.675 Test Loss: 1.197 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7148211002349854
Epoch: 48, Steps: 3 | Train Loss: 0.108 Vali Loss: 1.201 Vali Acc: 0.675 Test Loss: 1.201 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7097420692443848
Epoch: 49, Steps: 3 | Train Loss: 0.107 Vali Loss: 1.205 Vali Acc: 0.650 Test Loss: 1.205 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7269818782806396
Epoch: 50, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.211 Vali Acc: 0.650 Test Loss: 1.211 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6865525245666504
Epoch: 51, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.217 Vali Acc: 0.650 Test Loss: 1.217 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6490225791931152
Epoch: 52, Steps: 3 | Train Loss: 0.096 Vali Loss: 1.225 Vali Acc: 0.650 Test Loss: 1.225 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.7114126682281494
Epoch: 53, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.233 Vali Acc: 0.650 Test Loss: 1.233 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.7079904079437256
Epoch: 54, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.237 Vali Acc: 0.650 Test Loss: 1.237 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7603545188903809
Epoch: 55, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.241 Vali Acc: 0.650 Test Loss: 1.241 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.7062585353851318
Epoch: 56, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.239 Vali Acc: 0.650 Test Loss: 1.239 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm32_nh4_df64_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 23332
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5151925086975098
Epoch: 1, Steps: 3 | Train Loss: 1.543 Vali Loss: 1.528 Vali Acc: 0.275 Test Loss: 1.528 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.6800937652587891
Epoch: 2, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.488 Vali Acc: 0.325 Test Loss: 1.488 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.6883397102355957
Epoch: 3, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.452 Vali Acc: 0.350 Test Loss: 1.452 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 4 cost time: 0.8309323787689209
Epoch: 4, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.404 Vali Acc: 0.350 Test Loss: 1.404 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.6842565536499023
Epoch: 5, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.360 Vali Acc: 0.400 Test Loss: 1.360 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.6376852989196777
Epoch: 6, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.6416592597961426
Epoch: 7, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.280 Vali Acc: 0.450 Test Loss: 1.280 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.7155802249908447
Epoch: 8, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.251 Vali Acc: 0.450 Test Loss: 1.251 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.7112998962402344
Epoch: 9, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.218 Vali Acc: 0.475 Test Loss: 1.218 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 0.6180236339569092
Epoch: 10, Steps: 3 | Train Loss: 0.823 Vali Loss: 1.181 Vali Acc: 0.575 Test Loss: 1.181 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 0.6902995109558105
Epoch: 11, Steps: 3 | Train Loss: 0.727 Vali Loss: 1.148 Vali Acc: 0.575 Test Loss: 1.148 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.7053420543670654
Epoch: 12, Steps: 3 | Train Loss: 0.613 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.6900196075439453
Epoch: 13, Steps: 3 | Train Loss: 0.605 Vali Loss: 1.061 Vali Acc: 0.625 Test Loss: 1.061 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.6256859302520752
Epoch: 14, Steps: 3 | Train Loss: 0.463 Vali Loss: 1.017 Vali Acc: 0.650 Test Loss: 1.017 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.6629486083984375
Epoch: 15, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.968 Vali Acc: 0.650 Test Loss: 0.968 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 0.6894950866699219
Epoch: 16, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.946 Vali Acc: 0.650 Test Loss: 0.946 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 17 cost time: 0.644298791885376
Epoch: 17, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.930 Vali Acc: 0.675 Test Loss: 0.930 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 18 cost time: 0.6039316654205322
Epoch: 18, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.911 Vali Acc: 0.675 Test Loss: 0.911 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 19 cost time: 0.6557300090789795
Epoch: 19, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.886 Vali Acc: 0.650 Test Loss: 0.886 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6794531345367432
Epoch: 20, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.849 Vali Acc: 0.675 Test Loss: 0.849 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674992).  Saving model ...
Epoch: 21 cost time: 0.6374819278717041
Epoch: 21, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
Validation loss decreased (-0.674992 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.6325597763061523
Epoch: 22, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.773 Vali Acc: 0.800 Test Loss: 0.773 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 23 cost time: 0.7714376449584961
Epoch: 23, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.755 Vali Acc: 0.775 Test Loss: 0.755 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6718170642852783
Epoch: 24, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 25 cost time: 0.6904692649841309
Epoch: 25, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.750 Vali Acc: 0.800 Test Loss: 0.750 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6768741607666016
Epoch: 26, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.761 Vali Acc: 0.750 Test Loss: 0.761 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7564537525177002
Epoch: 27, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.762 Vali Acc: 0.725 Test Loss: 0.762 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8429584503173828
Epoch: 28, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.756 Vali Acc: 0.750 Test Loss: 0.756 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7423298358917236
Epoch: 29, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 30 cost time: 0.6950387954711914
Epoch: 30, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.732 Vali Acc: 0.800 Test Loss: 0.732 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 31 cost time: 0.7319819927215576
Epoch: 31, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.727 Vali Acc: 0.800 Test Loss: 0.727 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 32 cost time: 0.8108294010162354
Epoch: 32, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.722 Vali Acc: 0.775 Test Loss: 0.722 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8673288822174072
Epoch: 33, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.802100419998169
Epoch: 34, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.714 Vali Acc: 0.800 Test Loss: 0.714 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 35 cost time: 0.6242618560791016
Epoch: 35, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.711 Vali Acc: 0.800 Test Loss: 0.711 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 36 cost time: 0.7608404159545898
Epoch: 36, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7803220748901367
Epoch: 37, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.714 Vali Acc: 0.800 Test Loss: 0.714 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7784595489501953
Epoch: 38, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.716 Vali Acc: 0.800 Test Loss: 0.716 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7111895084381104
Epoch: 39, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.719 Vali Acc: 0.800 Test Loss: 0.719 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7815506458282471
Epoch: 40, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.722 Vali Acc: 0.800 Test Loss: 0.722 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6357607841491699
Epoch: 41, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.725 Vali Acc: 0.800 Test Loss: 0.725 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7675950527191162
Epoch: 42, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6724882125854492
Epoch: 43, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7542972564697266
Epoch: 44, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.727 Vali Acc: 0.775 Test Loss: 0.727 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6677212715148926
Epoch: 45, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.726 Vali Acc: 0.775 Test Loss: 0.726 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 38516
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0590546131134033
Epoch: 1, Steps: 3 | Train Loss: 1.580 Vali Loss: 1.573 Vali Acc: 0.225 Test Loss: 1.573 Test Acc: 0.225
Validation loss decreased (inf --> -0.224984).  Saving model ...
Epoch: 2 cost time: 0.7800321578979492
Epoch: 2, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.538 Vali Acc: 0.225 Test Loss: 1.538 Test Acc: 0.225
Validation loss decreased (-0.224984 --> -0.224985).  Saving model ...
Epoch: 3 cost time: 0.6696896553039551
Epoch: 3, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.509 Vali Acc: 0.225 Test Loss: 1.509 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224985).  Saving model ...
Epoch: 4 cost time: 0.693835973739624
Epoch: 4, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.466 Vali Acc: 0.200 Test Loss: 1.466 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6311140060424805
Epoch: 5, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.420 Vali Acc: 0.275 Test Loss: 1.420 Test Acc: 0.275
Validation loss decreased (-0.224985 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 0.8217196464538574
Epoch: 6, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.378 Vali Acc: 0.325 Test Loss: 1.378 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.6110708713531494
Epoch: 7, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.338 Vali Acc: 0.375 Test Loss: 1.338 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.7408843040466309
Epoch: 8, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.296 Vali Acc: 0.425 Test Loss: 1.296 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.6885080337524414
Epoch: 9, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.258 Vali Acc: 0.425 Test Loss: 1.258 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.7265527248382568
Epoch: 10, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.226 Vali Acc: 0.425 Test Loss: 1.226 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 11 cost time: 0.7306349277496338
Epoch: 11, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.189 Vali Acc: 0.425 Test Loss: 1.189 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 12 cost time: 0.7689359188079834
Epoch: 12, Steps: 3 | Train Loss: 0.861 Vali Loss: 1.158 Vali Acc: 0.475 Test Loss: 1.158 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 0.7347133159637451
Epoch: 13, Steps: 3 | Train Loss: 0.788 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 0.7872703075408936
Epoch: 14, Steps: 3 | Train Loss: 0.737 Vali Loss: 1.119 Vali Acc: 0.500 Test Loss: 1.119 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 0.7334423065185547
Epoch: 15, Steps: 3 | Train Loss: 0.621 Vali Loss: 1.101 Vali Acc: 0.500 Test Loss: 1.101 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 16 cost time: 0.7222387790679932
Epoch: 16, Steps: 3 | Train Loss: 0.625 Vali Loss: 1.078 Vali Acc: 0.525 Test Loss: 1.078 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 17 cost time: 0.6760280132293701
Epoch: 17, Steps: 3 | Train Loss: 0.570 Vali Loss: 1.053 Vali Acc: 0.575 Test Loss: 1.053 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 0.7793393135070801
Epoch: 18, Steps: 3 | Train Loss: 0.483 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.7509725093841553
Epoch: 19, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.991 Vali Acc: 0.650 Test Loss: 0.991 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 20 cost time: 0.7437403202056885
Epoch: 20, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.968 Vali Acc: 0.650 Test Loss: 0.968 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 21 cost time: 0.7083983421325684
Epoch: 21, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.946 Vali Acc: 0.650 Test Loss: 0.946 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 22 cost time: 0.7536401748657227
Epoch: 22, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.934 Vali Acc: 0.675 Test Loss: 0.934 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 23 cost time: 0.6517009735107422
Epoch: 23, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.928 Vali Acc: 0.675 Test Loss: 0.928 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 24 cost time: 0.8114748001098633
Epoch: 24, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.915 Vali Acc: 0.725 Test Loss: 0.915 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 25 cost time: 0.6876344680786133
Epoch: 25, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.899 Vali Acc: 0.750 Test Loss: 0.899 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 26 cost time: 0.7540595531463623
Epoch: 26, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.887 Vali Acc: 0.750 Test Loss: 0.887 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 27 cost time: 0.7986569404602051
Epoch: 27, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.873 Vali Acc: 0.750 Test Loss: 0.873 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 28 cost time: 0.760176420211792
Epoch: 28, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.863 Vali Acc: 0.750 Test Loss: 0.863 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 29 cost time: 0.7533800601959229
Epoch: 29, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 30 cost time: 0.814342737197876
Epoch: 30, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7658400535583496
Epoch: 31, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 32 cost time: 0.7310440540313721
Epoch: 32, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 33 cost time: 0.7898752689361572
Epoch: 33, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.845 Vali Acc: 0.750 Test Loss: 0.845 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 34 cost time: 0.7403221130371094
Epoch: 34, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.839 Vali Acc: 0.750 Test Loss: 0.839 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 35 cost time: 0.7551491260528564
Epoch: 35, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 36 cost time: 0.6772856712341309
Epoch: 36, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.826 Vali Acc: 0.750 Test Loss: 0.826 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 37 cost time: 0.6888501644134521
Epoch: 37, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 38 cost time: 0.6948349475860596
Epoch: 38, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.809 Vali Acc: 0.750 Test Loss: 0.809 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 39 cost time: 0.8660900592803955
Epoch: 39, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 40 cost time: 0.6424486637115479
Epoch: 40, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.803 Vali Acc: 0.750 Test Loss: 0.803 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 41 cost time: 0.7364888191223145
Epoch: 41, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.802 Vali Acc: 0.750 Test Loss: 0.802 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 42 cost time: 0.6548395156860352
Epoch: 42, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.803 Vali Acc: 0.750 Test Loss: 0.803 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6537420749664307
Epoch: 43, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.806 Vali Acc: 0.750 Test Loss: 0.806 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5570757389068604
Epoch: 44, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8098502159118652
Epoch: 45, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6960906982421875
Epoch: 46, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.820 Vali Acc: 0.750 Test Loss: 0.820 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7013578414916992
Epoch: 47, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.826 Vali Acc: 0.750 Test Loss: 0.826 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.5833797454833984
Epoch: 48, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.828 Vali Acc: 0.750 Test Loss: 0.828 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6936264038085938
Epoch: 49, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.827 Vali Acc: 0.750 Test Loss: 0.827 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7107939720153809
Epoch: 50, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.619041919708252
Epoch: 51, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.822 Vali Acc: 0.750 Test Loss: 0.822 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 32020
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4086098670959473
Epoch: 1, Steps: 3 | Train Loss: 1.627 Vali Loss: 1.443 Vali Acc: 0.250 Test Loss: 1.443 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.6620216369628906
Epoch: 2, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.435 Vali Acc: 0.225 Test Loss: 1.435 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.722984790802002
Epoch: 3, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.426 Vali Acc: 0.250 Test Loss: 1.426 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.7310211658477783
Epoch: 4, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.411 Vali Acc: 0.250 Test Loss: 1.411 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.7049055099487305
Epoch: 5, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.394 Vali Acc: 0.275 Test Loss: 1.394 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 0.6343233585357666
Epoch: 6, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.6499245166778564
Epoch: 7, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.350 Vali Acc: 0.400 Test Loss: 1.350 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 0.755911111831665
Epoch: 8, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.328 Vali Acc: 0.425 Test Loss: 1.328 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.7010314464569092
Epoch: 9, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.300 Vali Acc: 0.500 Test Loss: 1.300 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.6312456130981445
Epoch: 10, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.8276305198669434
Epoch: 11, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.247 Vali Acc: 0.475 Test Loss: 1.247 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7169132232666016
Epoch: 12, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 0.622025728225708
Epoch: 13, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.8067643642425537
Epoch: 14, Steps: 3 | Train Loss: 0.868 Vali Loss: 1.172 Vali Acc: 0.525 Test Loss: 1.172 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 0.6950700283050537
Epoch: 15, Steps: 3 | Train Loss: 0.805 Vali Loss: 1.148 Vali Acc: 0.525 Test Loss: 1.148 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 16 cost time: 0.773082971572876
Epoch: 16, Steps: 3 | Train Loss: 0.722 Vali Loss: 1.122 Vali Acc: 0.575 Test Loss: 1.122 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 17 cost time: 0.6326210498809814
Epoch: 17, Steps: 3 | Train Loss: 0.640 Vali Loss: 1.100 Vali Acc: 0.575 Test Loss: 1.100 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 0.6158032417297363
Epoch: 18, Steps: 3 | Train Loss: 0.614 Vali Loss: 1.080 Vali Acc: 0.550 Test Loss: 1.080 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6836481094360352
Epoch: 19, Steps: 3 | Train Loss: 0.572 Vali Loss: 1.064 Vali Acc: 0.550 Test Loss: 1.064 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6906681060791016
Epoch: 20, Steps: 3 | Train Loss: 0.498 Vali Loss: 1.042 Vali Acc: 0.575 Test Loss: 1.042 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 21 cost time: 0.7139713764190674
Epoch: 21, Steps: 3 | Train Loss: 0.466 Vali Loss: 1.026 Vali Acc: 0.575 Test Loss: 1.026 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 22 cost time: 0.6541538238525391
Epoch: 22, Steps: 3 | Train Loss: 0.449 Vali Loss: 1.007 Vali Acc: 0.575 Test Loss: 1.007 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 23 cost time: 0.7192237377166748
Epoch: 23, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.993 Vali Acc: 0.575 Test Loss: 0.993 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 24 cost time: 0.5618288516998291
Epoch: 24, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.977 Vali Acc: 0.600 Test Loss: 0.977 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.6621084213256836
Epoch: 25, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.975 Vali Acc: 0.550 Test Loss: 0.975 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6278793811798096
Epoch: 26, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.967 Vali Acc: 0.575 Test Loss: 0.967 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5852069854736328
Epoch: 27, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.960 Vali Acc: 0.575 Test Loss: 0.960 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6231529712677002
Epoch: 28, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.955 Vali Acc: 0.625 Test Loss: 0.955 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 29 cost time: 0.6035816669464111
Epoch: 29, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.953 Vali Acc: 0.625 Test Loss: 0.953 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 30 cost time: 0.6764082908630371
Epoch: 30, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.934 Vali Acc: 0.650 Test Loss: 0.934 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 31 cost time: 0.6842851638793945
Epoch: 31, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.918 Vali Acc: 0.675 Test Loss: 0.918 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 32 cost time: 0.6807615756988525
Epoch: 32, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.903 Vali Acc: 0.675 Test Loss: 0.903 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 33 cost time: 0.6814069747924805
Epoch: 33, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 34 cost time: 0.7551395893096924
Epoch: 34, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.879 Vali Acc: 0.725 Test Loss: 0.879 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 35 cost time: 0.7376871109008789
Epoch: 35, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.867 Vali Acc: 0.725 Test Loss: 0.867 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 36 cost time: 0.5792737007141113
Epoch: 36, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.863 Vali Acc: 0.725 Test Loss: 0.863 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 37 cost time: 0.6273565292358398
Epoch: 37, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.861 Vali Acc: 0.725 Test Loss: 0.861 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 38 cost time: 0.635565996170044
Epoch: 38, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.858 Vali Acc: 0.700 Test Loss: 0.858 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6431155204772949
Epoch: 39, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.858 Vali Acc: 0.700 Test Loss: 0.858 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6798698902130127
Epoch: 40, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.855 Vali Acc: 0.700 Test Loss: 0.855 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6253738403320312
Epoch: 41, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.851 Vali Acc: 0.700 Test Loss: 0.851 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6393978595733643
Epoch: 42, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.848 Vali Acc: 0.700 Test Loss: 0.848 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6153299808502197
Epoch: 43, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.849 Vali Acc: 0.700 Test Loss: 0.849 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6452212333679199
Epoch: 44, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.849 Vali Acc: 0.700 Test Loss: 0.849 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7080531120300293
Epoch: 45, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.847 Vali Acc: 0.700 Test Loss: 0.847 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7100000381469727
Epoch: 46, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.847 Vali Acc: 0.700 Test Loss: 0.847 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6589651107788086
Epoch: 47, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.845 Vali Acc: 0.700 Test Loss: 0.845 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 28996
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.576416254043579
Epoch: 1, Steps: 3 | Train Loss: 1.591 Vali Loss: 1.434 Vali Acc: 0.150 Test Loss: 1.434 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.6510119438171387
Epoch: 2, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.426 Vali Acc: 0.150 Test Loss: 1.426 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.672400712966919
Epoch: 3, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.419 Vali Acc: 0.175 Test Loss: 1.419 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.7027206420898438
Epoch: 4, Steps: 3 | Train Loss: 1.510 Vali Loss: 1.410 Vali Acc: 0.175 Test Loss: 1.410 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 5 cost time: 0.6319456100463867
Epoch: 5, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.397 Vali Acc: 0.175 Test Loss: 1.397 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 6 cost time: 0.6807711124420166
Epoch: 6, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.381 Vali Acc: 0.150 Test Loss: 1.381 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6548492908477783
Epoch: 7, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.363 Vali Acc: 0.175 Test Loss: 1.363 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 8 cost time: 0.6683378219604492
Epoch: 8, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.344 Vali Acc: 0.225 Test Loss: 1.344 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224987).  Saving model ...
Epoch: 9 cost time: 0.6495122909545898
Epoch: 9, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.324 Vali Acc: 0.250 Test Loss: 1.324 Test Acc: 0.250
Validation loss decreased (-0.224987 --> -0.249987).  Saving model ...
Epoch: 10 cost time: 0.7016816139221191
Epoch: 10, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.301 Vali Acc: 0.275 Test Loss: 1.301 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 11 cost time: 0.707618236541748
Epoch: 11, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.278 Vali Acc: 0.325 Test Loss: 1.278 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 12 cost time: 0.6647448539733887
Epoch: 12, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.257 Vali Acc: 0.350 Test Loss: 1.257 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 13 cost time: 0.6900525093078613
Epoch: 13, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.238 Vali Acc: 0.425 Test Loss: 1.238 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424988).  Saving model ...
Epoch: 14 cost time: 0.685819149017334
Epoch: 14, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.219 Vali Acc: 0.450 Test Loss: 1.219 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 15 cost time: 0.781639575958252
Epoch: 15, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.201 Vali Acc: 0.475 Test Loss: 1.201 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 16 cost time: 0.6066062450408936
Epoch: 16, Steps: 3 | Train Loss: 0.763 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 0.6734063625335693
Epoch: 17, Steps: 3 | Train Loss: 0.795 Vali Loss: 1.163 Vali Acc: 0.525 Test Loss: 1.163 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 18 cost time: 0.6190800666809082
Epoch: 18, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.143 Vali Acc: 0.525 Test Loss: 1.143 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 19 cost time: 0.7700240612030029
Epoch: 19, Steps: 3 | Train Loss: 0.715 Vali Loss: 1.123 Vali Acc: 0.525 Test Loss: 1.123 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 20 cost time: 0.6379609107971191
Epoch: 20, Steps: 3 | Train Loss: 0.661 Vali Loss: 1.105 Vali Acc: 0.550 Test Loss: 1.105 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 21 cost time: 0.7832870483398438
Epoch: 21, Steps: 3 | Train Loss: 0.577 Vali Loss: 1.087 Vali Acc: 0.525 Test Loss: 1.087 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6715447902679443
Epoch: 22, Steps: 3 | Train Loss: 0.567 Vali Loss: 1.070 Vali Acc: 0.550 Test Loss: 1.070 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 23 cost time: 0.6471920013427734
Epoch: 23, Steps: 3 | Train Loss: 0.504 Vali Loss: 1.057 Vali Acc: 0.575 Test Loss: 1.057 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 24 cost time: 0.6079235076904297
Epoch: 24, Steps: 3 | Train Loss: 0.463 Vali Loss: 1.041 Vali Acc: 0.575 Test Loss: 1.041 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 25 cost time: 0.6981370449066162
Epoch: 25, Steps: 3 | Train Loss: 0.412 Vali Loss: 1.025 Vali Acc: 0.575 Test Loss: 1.025 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 26 cost time: 0.7531790733337402
Epoch: 26, Steps: 3 | Train Loss: 0.398 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 27 cost time: 0.7055611610412598
Epoch: 27, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.994 Vali Acc: 0.625 Test Loss: 0.994 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 28 cost time: 0.7409853935241699
Epoch: 28, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.982 Vali Acc: 0.625 Test Loss: 0.982 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 29 cost time: 0.6598241329193115
Epoch: 29, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.971 Vali Acc: 0.650 Test Loss: 0.971 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 30 cost time: 0.652839183807373
Epoch: 30, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.961 Vali Acc: 0.675 Test Loss: 0.961 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 31 cost time: 0.8422353267669678
Epoch: 31, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.953 Vali Acc: 0.675 Test Loss: 0.953 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 32 cost time: 0.7185723781585693
Epoch: 32, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.947 Vali Acc: 0.675 Test Loss: 0.947 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 33 cost time: 0.6982259750366211
Epoch: 33, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.943 Vali Acc: 0.675 Test Loss: 0.943 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 34 cost time: 0.6776561737060547
Epoch: 34, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.938 Vali Acc: 0.675 Test Loss: 0.938 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 35 cost time: 0.6101701259613037
Epoch: 35, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.936 Vali Acc: 0.675 Test Loss: 0.936 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 36 cost time: 0.8402543067932129
Epoch: 36, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.932 Vali Acc: 0.675 Test Loss: 0.932 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 37 cost time: 0.7041800022125244
Epoch: 37, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.927 Vali Acc: 0.675 Test Loss: 0.927 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 38 cost time: 0.8030605316162109
Epoch: 38, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.925 Vali Acc: 0.675 Test Loss: 0.925 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 39 cost time: 0.8740561008453369
Epoch: 39, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.925 Vali Acc: 0.700 Test Loss: 0.925 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 40 cost time: 0.7082555294036865
Epoch: 40, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.923 Vali Acc: 0.700 Test Loss: 0.923 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 41 cost time: 0.7339894771575928
Epoch: 41, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.920 Vali Acc: 0.700 Test Loss: 0.920 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 42 cost time: 0.6337494850158691
Epoch: 42, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.920 Vali Acc: 0.700 Test Loss: 0.920 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 43 cost time: 0.6404709815979004
Epoch: 43, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.918 Vali Acc: 0.700 Test Loss: 0.918 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 44 cost time: 0.7053120136260986
Epoch: 44, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.917 Vali Acc: 0.725 Test Loss: 0.917 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 45 cost time: 0.6515648365020752
Epoch: 45, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.915 Vali Acc: 0.725 Test Loss: 0.915 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 46 cost time: 0.633080005645752
Epoch: 46, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.912 Vali Acc: 0.725 Test Loss: 0.912 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 47 cost time: 0.7048041820526123
Epoch: 47, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.912 Vali Acc: 0.725 Test Loss: 0.912 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 48 cost time: 0.6791379451751709
Epoch: 48, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.910 Vali Acc: 0.725 Test Loss: 0.910 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 49 cost time: 0.7001566886901855
Epoch: 49, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.909 Vali Acc: 0.725 Test Loss: 0.909 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 50 cost time: 0.7002336978912354
Epoch: 50, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 51 cost time: 0.6661267280578613
Epoch: 51, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.906 Vali Acc: 0.725 Test Loss: 0.906 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 52 cost time: 0.6540892124176025
Epoch: 52, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.903 Vali Acc: 0.725 Test Loss: 0.903 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 53 cost time: 0.5850749015808105
Epoch: 53, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.900 Vali Acc: 0.725 Test Loss: 0.900 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 54 cost time: 0.6869292259216309
Epoch: 54, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.898 Vali Acc: 0.725 Test Loss: 0.898 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 55 cost time: 0.6504497528076172
Epoch: 55, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.900 Vali Acc: 0.725 Test Loss: 0.900 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7522227764129639
Epoch: 56, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.902 Vali Acc: 0.725 Test Loss: 0.902 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6031513214111328
Epoch: 57, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.902 Vali Acc: 0.725 Test Loss: 0.902 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6809847354888916
Epoch: 58, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.902 Vali Acc: 0.725 Test Loss: 0.902 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6979923248291016
Epoch: 59, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.902 Vali Acc: 0.725 Test Loss: 0.902 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.7110068798065186
Epoch: 60, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.903 Vali Acc: 0.725 Test Loss: 0.903 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.7800192832946777
Epoch: 61, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.905 Vali Acc: 0.725 Test Loss: 0.905 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.7476770877838135
Epoch: 62, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.906 Vali Acc: 0.725 Test Loss: 0.906 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.8918459415435791
Epoch: 63, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.7629764080047607
Epoch: 64, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.911 Vali Acc: 0.725 Test Loss: 0.911 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 27108
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7478606700897217
Epoch: 1, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.396 Vali Acc: 0.300 Test Loss: 1.396 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6476891040802002
Epoch: 2, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.398 Vali Acc: 0.275 Test Loss: 1.398 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.677922248840332
Epoch: 3, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.400 Vali Acc: 0.275 Test Loss: 1.400 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.705129861831665
Epoch: 4, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.400 Vali Acc: 0.275 Test Loss: 1.400 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8043408393859863
Epoch: 5, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.398 Vali Acc: 0.300 Test Loss: 1.398 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7589268684387207
Epoch: 6, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.394 Vali Acc: 0.350 Test Loss: 1.394 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.6769068241119385
Epoch: 7, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.388 Vali Acc: 0.350 Test Loss: 1.388 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.7028920650482178
Epoch: 8, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.381 Vali Acc: 0.425 Test Loss: 1.381 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 9 cost time: 0.844167947769165
Epoch: 9, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.375 Vali Acc: 0.425 Test Loss: 1.375 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 10 cost time: 0.9048969745635986
Epoch: 10, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.367 Vali Acc: 0.425 Test Loss: 1.367 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 11 cost time: 0.7238173484802246
Epoch: 11, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.358 Vali Acc: 0.425 Test Loss: 1.358 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 12 cost time: 0.6459064483642578
Epoch: 12, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.349 Vali Acc: 0.400 Test Loss: 1.349 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.685218334197998
Epoch: 13, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6823399066925049
Epoch: 14, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.329 Vali Acc: 0.450 Test Loss: 1.329 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 15 cost time: 0.6808819770812988
Epoch: 15, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.319 Vali Acc: 0.425 Test Loss: 1.319 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7529122829437256
Epoch: 16, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.311 Vali Acc: 0.450 Test Loss: 1.311 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 17 cost time: 0.6533796787261963
Epoch: 17, Steps: 3 | Train Loss: 0.919 Vali Loss: 1.303 Vali Acc: 0.425 Test Loss: 1.303 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6540813446044922
Epoch: 18, Steps: 3 | Train Loss: 0.871 Vali Loss: 1.294 Vali Acc: 0.450 Test Loss: 1.294 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 19 cost time: 0.7550640106201172
Epoch: 19, Steps: 3 | Train Loss: 0.818 Vali Loss: 1.284 Vali Acc: 0.475 Test Loss: 1.284 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 20 cost time: 0.6736025810241699
Epoch: 20, Steps: 3 | Train Loss: 0.865 Vali Loss: 1.277 Vali Acc: 0.475 Test Loss: 1.277 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 21 cost time: 0.5965347290039062
Epoch: 21, Steps: 3 | Train Loss: 0.776 Vali Loss: 1.268 Vali Acc: 0.475 Test Loss: 1.268 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 22 cost time: 0.6146402359008789
Epoch: 22, Steps: 3 | Train Loss: 0.759 Vali Loss: 1.260 Vali Acc: 0.525 Test Loss: 1.260 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 23 cost time: 0.6243195533752441
Epoch: 23, Steps: 3 | Train Loss: 0.741 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6216020584106445
Epoch: 24, Steps: 3 | Train Loss: 0.751 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6575312614440918
Epoch: 25, Steps: 3 | Train Loss: 0.696 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6845002174377441
Epoch: 26, Steps: 3 | Train Loss: 0.609 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7648789882659912
Epoch: 27, Steps: 3 | Train Loss: 0.526 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6198186874389648
Epoch: 28, Steps: 3 | Train Loss: 0.564 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6738457679748535
Epoch: 29, Steps: 3 | Train Loss: 0.584 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6401667594909668
Epoch: 30, Steps: 3 | Train Loss: 0.514 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.619720458984375
Epoch: 31, Steps: 3 | Train Loss: 0.484 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5788450241088867
Epoch: 32, Steps: 3 | Train Loss: 0.431 Vali Loss: 1.162 Vali Acc: 0.525 Test Loss: 1.162 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 33 cost time: 0.6087851524353027
Epoch: 33, Steps: 3 | Train Loss: 0.407 Vali Loss: 1.153 Vali Acc: 0.525 Test Loss: 1.153 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 34 cost time: 0.5835199356079102
Epoch: 34, Steps: 3 | Train Loss: 0.415 Vali Loss: 1.142 Vali Acc: 0.550 Test Loss: 1.142 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 35 cost time: 0.6784565448760986
Epoch: 35, Steps: 3 | Train Loss: 0.417 Vali Loss: 1.134 Vali Acc: 0.550 Test Loss: 1.134 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 36 cost time: 0.7925028800964355
Epoch: 36, Steps: 3 | Train Loss: 0.342 Vali Loss: 1.129 Vali Acc: 0.550 Test Loss: 1.129 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 37 cost time: 0.7026660442352295
Epoch: 37, Steps: 3 | Train Loss: 0.330 Vali Loss: 1.125 Vali Acc: 0.550 Test Loss: 1.125 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 38 cost time: 0.5814259052276611
Epoch: 38, Steps: 3 | Train Loss: 0.322 Vali Loss: 1.121 Vali Acc: 0.550 Test Loss: 1.121 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 39 cost time: 0.6799604892730713
Epoch: 39, Steps: 3 | Train Loss: 0.256 Vali Loss: 1.118 Vali Acc: 0.550 Test Loss: 1.118 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 40 cost time: 0.740880012512207
Epoch: 40, Steps: 3 | Train Loss: 0.240 Vali Loss: 1.117 Vali Acc: 0.550 Test Loss: 1.117 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 41 cost time: 0.6665222644805908
Epoch: 41, Steps: 3 | Train Loss: 0.227 Vali Loss: 1.117 Vali Acc: 0.575 Test Loss: 1.117 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 42 cost time: 0.6060543060302734
Epoch: 42, Steps: 3 | Train Loss: 0.246 Vali Loss: 1.118 Vali Acc: 0.575 Test Loss: 1.118 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6130564212799072
Epoch: 43, Steps: 3 | Train Loss: 0.211 Vali Loss: 1.118 Vali Acc: 0.575 Test Loss: 1.118 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6740331649780273
Epoch: 44, Steps: 3 | Train Loss: 0.213 Vali Loss: 1.123 Vali Acc: 0.575 Test Loss: 1.123 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5799367427825928
Epoch: 45, Steps: 3 | Train Loss: 0.235 Vali Loss: 1.125 Vali Acc: 0.575 Test Loss: 1.125 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7348308563232422
Epoch: 46, Steps: 3 | Train Loss: 0.150 Vali Loss: 1.126 Vali Acc: 0.575 Test Loss: 1.126 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6714675426483154
Epoch: 47, Steps: 3 | Train Loss: 0.169 Vali Loss: 1.126 Vali Acc: 0.575 Test Loss: 1.126 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7180740833282471
Epoch: 48, Steps: 3 | Train Loss: 0.159 Vali Loss: 1.126 Vali Acc: 0.575 Test Loss: 1.126 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6900296211242676
Epoch: 49, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.122 Vali Acc: 0.600 Test Loss: 1.122 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 50 cost time: 0.6698226928710938
Epoch: 50, Steps: 3 | Train Loss: 0.167 Vali Loss: 1.120 Vali Acc: 0.575 Test Loss: 1.120 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8646509647369385
Epoch: 51, Steps: 3 | Train Loss: 0.130 Vali Loss: 1.115 Vali Acc: 0.575 Test Loss: 1.115 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.6126608848571777
Epoch: 52, Steps: 3 | Train Loss: 0.111 Vali Loss: 1.114 Vali Acc: 0.575 Test Loss: 1.114 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.6022405624389648
Epoch: 53, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.111 Vali Acc: 0.575 Test Loss: 1.111 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7540104389190674
Epoch: 54, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 55 cost time: 0.6754274368286133
Epoch: 55, Steps: 3 | Train Loss: 0.120 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6247067451477051
Epoch: 56, Steps: 3 | Train Loss: 0.107 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 57 cost time: 0.546776533126831
Epoch: 57, Steps: 3 | Train Loss: 0.111 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6010472774505615
Epoch: 58, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 59 cost time: 0.5777528285980225
Epoch: 59, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.105 Vali Acc: 0.625 Test Loss: 1.105 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 60 cost time: 0.5839405059814453
Epoch: 60, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.104 Vali Acc: 0.650 Test Loss: 1.104 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 61 cost time: 0.7626705169677734
Epoch: 61, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.100 Vali Acc: 0.650 Test Loss: 1.100 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 62 cost time: 0.5651068687438965
Epoch: 62, Steps: 3 | Train Loss: 0.082 Vali Loss: 1.098 Vali Acc: 0.650 Test Loss: 1.098 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 63 cost time: 0.7281289100646973
Epoch: 63, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.098 Vali Acc: 0.650 Test Loss: 1.098 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 64 cost time: 0.6815352439880371
Epoch: 64, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.096 Vali Acc: 0.650 Test Loss: 1.096 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 65 cost time: 0.6537597179412842
Epoch: 65, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.097 Vali Acc: 0.650 Test Loss: 1.097 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.6019282341003418
Epoch: 66, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.096 Vali Acc: 0.650 Test Loss: 1.096 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 67 cost time: 0.678546667098999
Epoch: 67, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.096 Vali Acc: 0.650 Test Loss: 1.096 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6461336612701416
Epoch: 68, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.099 Vali Acc: 0.650 Test Loss: 1.099 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6241285800933838
Epoch: 69, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.102 Vali Acc: 0.650 Test Loss: 1.102 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.8396646976470947
Epoch: 70, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.104 Vali Acc: 0.625 Test Loss: 1.104 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.6671175956726074
Epoch: 71, Steps: 3 | Train Loss: 0.055 Vali Loss: 1.104 Vali Acc: 0.625 Test Loss: 1.104 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.6191811561584473
Epoch: 72, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.636542797088623
Epoch: 73, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.102 Vali Acc: 0.625 Test Loss: 1.102 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.7200601100921631
Epoch: 74, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.104 Vali Acc: 0.625 Test Loss: 1.104 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.6935174465179443
Epoch: 75, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.106 Vali Acc: 0.625 Test Loss: 1.106 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6653032302856445
Epoch: 76, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.111 Vali Acc: 0.625 Test Loss: 1.111 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 24116
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.054553508758545
Epoch: 1, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.380 Vali Acc: 0.300 Test Loss: 1.380 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6320879459381104
Epoch: 2, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.383 Vali Acc: 0.325 Test Loss: 1.383 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.5992326736450195
Epoch: 3, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.387 Vali Acc: 0.275 Test Loss: 1.387 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6432464122772217
Epoch: 4, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.388 Vali Acc: 0.275 Test Loss: 1.388 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.631582498550415
Epoch: 5, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.385 Vali Acc: 0.350 Test Loss: 1.385 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.6613736152648926
Epoch: 6, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.379 Vali Acc: 0.350 Test Loss: 1.379 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.6870410442352295
Epoch: 7, Steps: 3 | Train Loss: 1.552 Vali Loss: 1.370 Vali Acc: 0.375 Test Loss: 1.370 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.6359610557556152
Epoch: 8, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.359 Vali Acc: 0.425 Test Loss: 1.359 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 9 cost time: 0.5988023281097412
Epoch: 9, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.347 Vali Acc: 0.450 Test Loss: 1.347 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.6843283176422119
Epoch: 10, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.332 Vali Acc: 0.450 Test Loss: 1.332 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.6645605564117432
Epoch: 11, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.318 Vali Acc: 0.475 Test Loss: 1.318 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 0.6450071334838867
Epoch: 12, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.303 Vali Acc: 0.475 Test Loss: 1.303 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 13 cost time: 0.7077839374542236
Epoch: 13, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.289 Vali Acc: 0.475 Test Loss: 1.289 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 14 cost time: 0.6831185817718506
Epoch: 14, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.276 Vali Acc: 0.475 Test Loss: 1.276 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 15 cost time: 0.6712369918823242
Epoch: 15, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.262 Vali Acc: 0.525 Test Loss: 1.262 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 16 cost time: 0.6377077102661133
Epoch: 16, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.247 Vali Acc: 0.525 Test Loss: 1.247 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.6468679904937744
Epoch: 17, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.233 Vali Acc: 0.525 Test Loss: 1.233 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 18 cost time: 0.7017979621887207
Epoch: 18, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.220 Vali Acc: 0.525 Test Loss: 1.220 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 19 cost time: 0.5947742462158203
Epoch: 19, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.208 Vali Acc: 0.525 Test Loss: 1.208 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 20 cost time: 0.6299889087677002
Epoch: 20, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.195 Vali Acc: 0.525 Test Loss: 1.195 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 21 cost time: 0.6629443168640137
Epoch: 21, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.183 Vali Acc: 0.550 Test Loss: 1.183 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 22 cost time: 0.5709793567657471
Epoch: 22, Steps: 3 | Train Loss: 0.814 Vali Loss: 1.171 Vali Acc: 0.550 Test Loss: 1.171 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 23 cost time: 0.6722626686096191
Epoch: 23, Steps: 3 | Train Loss: 0.802 Vali Loss: 1.160 Vali Acc: 0.550 Test Loss: 1.160 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 24 cost time: 0.5289733409881592
Epoch: 24, Steps: 3 | Train Loss: 0.820 Vali Loss: 1.148 Vali Acc: 0.550 Test Loss: 1.148 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 25 cost time: 0.6571590900421143
Epoch: 25, Steps: 3 | Train Loss: 0.767 Vali Loss: 1.136 Vali Acc: 0.550 Test Loss: 1.136 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 26 cost time: 0.6527957916259766
Epoch: 26, Steps: 3 | Train Loss: 0.678 Vali Loss: 1.124 Vali Acc: 0.575 Test Loss: 1.124 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 27 cost time: 0.7662637233734131
Epoch: 27, Steps: 3 | Train Loss: 0.600 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 28 cost time: 0.5645902156829834
Epoch: 28, Steps: 3 | Train Loss: 0.655 Vali Loss: 1.097 Vali Acc: 0.600 Test Loss: 1.097 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 29 cost time: 0.5222382545471191
Epoch: 29, Steps: 3 | Train Loss: 0.658 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 30 cost time: 0.6936323642730713
Epoch: 30, Steps: 3 | Train Loss: 0.694 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 31 cost time: 0.648521900177002
Epoch: 31, Steps: 3 | Train Loss: 0.538 Vali Loss: 1.060 Vali Acc: 0.625 Test Loss: 1.060 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 32 cost time: 0.6287000179290771
Epoch: 32, Steps: 3 | Train Loss: 0.517 Vali Loss: 1.048 Vali Acc: 0.650 Test Loss: 1.048 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 33 cost time: 0.7024021148681641
Epoch: 33, Steps: 3 | Train Loss: 0.509 Vali Loss: 1.038 Vali Acc: 0.650 Test Loss: 1.038 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 34 cost time: 0.6502642631530762
Epoch: 34, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.029 Vali Acc: 0.650 Test Loss: 1.029 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 35 cost time: 0.7436134815216064
Epoch: 35, Steps: 3 | Train Loss: 0.447 Vali Loss: 1.021 Vali Acc: 0.675 Test Loss: 1.021 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 36 cost time: 0.6503713130950928
Epoch: 36, Steps: 3 | Train Loss: 0.383 Vali Loss: 1.016 Vali Acc: 0.700 Test Loss: 1.016 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 37 cost time: 0.6860902309417725
Epoch: 37, Steps: 3 | Train Loss: 0.440 Vali Loss: 1.011 Vali Acc: 0.700 Test Loss: 1.011 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 38 cost time: 0.6012763977050781
Epoch: 38, Steps: 3 | Train Loss: 0.363 Vali Loss: 1.004 Vali Acc: 0.700 Test Loss: 1.004 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 39 cost time: 0.6128511428833008
Epoch: 39, Steps: 3 | Train Loss: 0.433 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 40 cost time: 0.7384066581726074
Epoch: 40, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.995 Vali Acc: 0.700 Test Loss: 0.995 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 41 cost time: 0.6620385646820068
Epoch: 41, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.989 Vali Acc: 0.700 Test Loss: 0.989 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 42 cost time: 0.6249294281005859
Epoch: 42, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.983 Vali Acc: 0.700 Test Loss: 0.983 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 43 cost time: 0.7627394199371338
Epoch: 43, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.978 Vali Acc: 0.725 Test Loss: 0.978 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 44 cost time: 0.6430337429046631
Epoch: 44, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.974 Vali Acc: 0.725 Test Loss: 0.974 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 45 cost time: 0.6348080635070801
Epoch: 45, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.972 Vali Acc: 0.725 Test Loss: 0.972 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 46 cost time: 0.6060519218444824
Epoch: 46, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.969 Vali Acc: 0.700 Test Loss: 0.969 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6257421970367432
Epoch: 47, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.966 Vali Acc: 0.700 Test Loss: 0.966 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.667851448059082
Epoch: 48, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6052138805389404
Epoch: 49, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.963 Vali Acc: 0.700 Test Loss: 0.963 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7244083881378174
Epoch: 50, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.959 Vali Acc: 0.700 Test Loss: 0.959 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.6717450618743896
Epoch: 51, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.957 Vali Acc: 0.700 Test Loss: 0.957 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.6289665699005127
Epoch: 52, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.955 Vali Acc: 0.700 Test Loss: 0.955 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.5645277500152588
Epoch: 53, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.953 Vali Acc: 0.700 Test Loss: 0.953 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.6245343685150146
Epoch: 54, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.952 Vali Acc: 0.700 Test Loss: 0.952 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.5990853309631348
Epoch: 55, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.950 Vali Acc: 0.700 Test Loss: 0.950 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 23428
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5611348152160645
Epoch: 1, Steps: 3 | Train Loss: 1.585 Vali Loss: 1.726 Vali Acc: 0.225 Test Loss: 1.726 Test Acc: 0.225
Validation loss decreased (inf --> -0.224983).  Saving model ...
Epoch: 2 cost time: 0.6683456897735596
Epoch: 2, Steps: 3 | Train Loss: 1.547 Vali Loss: 1.696 Vali Acc: 0.225 Test Loss: 1.696 Test Acc: 0.225
Validation loss decreased (-0.224983 --> -0.224983).  Saving model ...
Epoch: 3 cost time: 0.6691272258758545
Epoch: 3, Steps: 3 | Train Loss: 1.632 Vali Loss: 1.676 Vali Acc: 0.225 Test Loss: 1.676 Test Acc: 0.225
Validation loss decreased (-0.224983 --> -0.224983).  Saving model ...
Epoch: 4 cost time: 0.6446459293365479
Epoch: 4, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.660 Vali Acc: 0.225 Test Loss: 1.660 Test Acc: 0.225
Validation loss decreased (-0.224983 --> -0.224983).  Saving model ...
Epoch: 5 cost time: 0.676788330078125
Epoch: 5, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.645 Vali Acc: 0.250 Test Loss: 1.645 Test Acc: 0.250
Validation loss decreased (-0.224983 --> -0.249984).  Saving model ...
Epoch: 6 cost time: 0.689323902130127
Epoch: 6, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.630 Vali Acc: 0.225 Test Loss: 1.630 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6616640090942383
Epoch: 7, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.615 Vali Acc: 0.225 Test Loss: 1.615 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7329895496368408
Epoch: 8, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.599 Vali Acc: 0.225 Test Loss: 1.599 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6513082981109619
Epoch: 9, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.581 Vali Acc: 0.275 Test Loss: 1.581 Test Acc: 0.275
Validation loss decreased (-0.249984 --> -0.274984).  Saving model ...
Epoch: 10 cost time: 0.6682448387145996
Epoch: 10, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.563 Vali Acc: 0.275 Test Loss: 1.563 Test Acc: 0.275
Validation loss decreased (-0.274984 --> -0.274984).  Saving model ...
Epoch: 11 cost time: 0.6562187671661377
Epoch: 11, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.546 Vali Acc: 0.325 Test Loss: 1.546 Test Acc: 0.325
Validation loss decreased (-0.274984 --> -0.324985).  Saving model ...
Epoch: 12 cost time: 0.6992592811584473
Epoch: 12, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.529 Vali Acc: 0.300 Test Loss: 1.529 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7216334342956543
Epoch: 13, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.512 Vali Acc: 0.300 Test Loss: 1.512 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5993602275848389
Epoch: 14, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.497 Vali Acc: 0.300 Test Loss: 1.497 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6902797222137451
Epoch: 15, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.481 Vali Acc: 0.300 Test Loss: 1.481 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7620532512664795
Epoch: 16, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.463 Vali Acc: 0.350 Test Loss: 1.463 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 17 cost time: 0.6136932373046875
Epoch: 17, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.447 Vali Acc: 0.350 Test Loss: 1.447 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349986).  Saving model ...
Epoch: 18 cost time: 0.6732778549194336
Epoch: 18, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.430 Vali Acc: 0.400 Test Loss: 1.430 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 19 cost time: 0.6801495552062988
Epoch: 19, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.415 Vali Acc: 0.400 Test Loss: 1.415 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 20 cost time: 0.7594180107116699
Epoch: 20, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.400 Vali Acc: 0.425 Test Loss: 1.400 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 21 cost time: 0.6857962608337402
Epoch: 21, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.383 Vali Acc: 0.425 Test Loss: 1.383 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 22 cost time: 0.7289338111877441
Epoch: 22, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.368 Vali Acc: 0.450 Test Loss: 1.368 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 23 cost time: 0.7849724292755127
Epoch: 23, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.352 Vali Acc: 0.450 Test Loss: 1.352 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 24 cost time: 0.7018077373504639
Epoch: 24, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.341 Vali Acc: 0.450 Test Loss: 1.341 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 25 cost time: 0.6448929309844971
Epoch: 25, Steps: 3 | Train Loss: 0.774 Vali Loss: 1.326 Vali Acc: 0.450 Test Loss: 1.326 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 26 cost time: 0.6370396614074707
Epoch: 26, Steps: 3 | Train Loss: 0.860 Vali Loss: 1.314 Vali Acc: 0.450 Test Loss: 1.314 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 27 cost time: 0.5959875583648682
Epoch: 27, Steps: 3 | Train Loss: 0.750 Vali Loss: 1.302 Vali Acc: 0.450 Test Loss: 1.302 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 28 cost time: 0.5500545501708984
Epoch: 28, Steps: 3 | Train Loss: 0.860 Vali Loss: 1.291 Vali Acc: 0.475 Test Loss: 1.291 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 29 cost time: 0.7821686267852783
Epoch: 29, Steps: 3 | Train Loss: 0.807 Vali Loss: 1.279 Vali Acc: 0.475 Test Loss: 1.279 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 30 cost time: 0.658667802810669
Epoch: 30, Steps: 3 | Train Loss: 0.723 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 31 cost time: 0.6784806251525879
Epoch: 31, Steps: 3 | Train Loss: 0.670 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 32 cost time: 0.6060175895690918
Epoch: 32, Steps: 3 | Train Loss: 0.676 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 33 cost time: 0.8421707153320312
Epoch: 33, Steps: 3 | Train Loss: 0.671 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 34 cost time: 0.6501979827880859
Epoch: 34, Steps: 3 | Train Loss: 0.602 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 35 cost time: 0.7407958507537842
Epoch: 35, Steps: 3 | Train Loss: 0.590 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 36 cost time: 0.6515860557556152
Epoch: 36, Steps: 3 | Train Loss: 0.579 Vali Loss: 1.218 Vali Acc: 0.475 Test Loss: 1.218 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7559812068939209
Epoch: 37, Steps: 3 | Train Loss: 0.552 Vali Loss: 1.213 Vali Acc: 0.475 Test Loss: 1.213 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6598529815673828
Epoch: 38, Steps: 3 | Train Loss: 0.520 Vali Loss: 1.207 Vali Acc: 0.475 Test Loss: 1.207 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7591228485107422
Epoch: 39, Steps: 3 | Train Loss: 0.484 Vali Loss: 1.205 Vali Acc: 0.475 Test Loss: 1.205 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7293882369995117
Epoch: 40, Steps: 3 | Train Loss: 0.466 Vali Loss: 1.199 Vali Acc: 0.475 Test Loss: 1.199 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6468296051025391
Epoch: 41, Steps: 3 | Train Loss: 0.447 Vali Loss: 1.191 Vali Acc: 0.475 Test Loss: 1.191 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6885390281677246
Epoch: 42, Steps: 3 | Train Loss: 0.402 Vali Loss: 1.186 Vali Acc: 0.475 Test Loss: 1.186 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6295981407165527
Epoch: 43, Steps: 3 | Train Loss: 0.385 Vali Loss: 1.181 Vali Acc: 0.475 Test Loss: 1.181 Test Acc: 0.475
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6879990100860596
Epoch: 44, Steps: 3 | Train Loss: 0.367 Vali Loss: 1.176 Vali Acc: 0.475 Test Loss: 1.176 Test Acc: 0.475
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7846615314483643
Epoch: 45, Steps: 3 | Train Loss: 0.398 Vali Loss: 1.173 Vali Acc: 0.525 Test Loss: 1.173 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 46 cost time: 0.7070767879486084
Epoch: 46, Steps: 3 | Train Loss: 0.369 Vali Loss: 1.165 Vali Acc: 0.525 Test Loss: 1.165 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 47 cost time: 0.6397068500518799
Epoch: 47, Steps: 3 | Train Loss: 0.373 Vali Loss: 1.159 Vali Acc: 0.550 Test Loss: 1.159 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 48 cost time: 0.7705340385437012
Epoch: 48, Steps: 3 | Train Loss: 0.332 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 49 cost time: 0.624525785446167
Epoch: 49, Steps: 3 | Train Loss: 0.325 Vali Loss: 1.144 Vali Acc: 0.550 Test Loss: 1.144 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 50 cost time: 0.7920799255371094
Epoch: 50, Steps: 3 | Train Loss: 0.295 Vali Loss: 1.137 Vali Acc: 0.550 Test Loss: 1.137 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 51 cost time: 0.741436243057251
Epoch: 51, Steps: 3 | Train Loss: 0.306 Vali Loss: 1.129 Vali Acc: 0.550 Test Loss: 1.129 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 52 cost time: 0.6828658580780029
Epoch: 52, Steps: 3 | Train Loss: 0.274 Vali Loss: 1.124 Vali Acc: 0.550 Test Loss: 1.124 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 53 cost time: 0.7321658134460449
Epoch: 53, Steps: 3 | Train Loss: 0.276 Vali Loss: 1.116 Vali Acc: 0.550 Test Loss: 1.116 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 54 cost time: 0.7238638401031494
Epoch: 54, Steps: 3 | Train Loss: 0.312 Vali Loss: 1.111 Vali Acc: 0.575 Test Loss: 1.111 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 55 cost time: 0.6099860668182373
Epoch: 55, Steps: 3 | Train Loss: 0.244 Vali Loss: 1.106 Vali Acc: 0.575 Test Loss: 1.106 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 56 cost time: 0.7232694625854492
Epoch: 56, Steps: 3 | Train Loss: 0.213 Vali Loss: 1.100 Vali Acc: 0.600 Test Loss: 1.100 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 57 cost time: 0.705540657043457
Epoch: 57, Steps: 3 | Train Loss: 0.206 Vali Loss: 1.092 Vali Acc: 0.600 Test Loss: 1.092 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 58 cost time: 0.6656084060668945
Epoch: 58, Steps: 3 | Train Loss: 0.211 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 59 cost time: 0.7014303207397461
Epoch: 59, Steps: 3 | Train Loss: 0.192 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 60 cost time: 0.686244010925293
Epoch: 60, Steps: 3 | Train Loss: 0.206 Vali Loss: 1.075 Vali Acc: 0.625 Test Loss: 1.075 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 61 cost time: 0.6370091438293457
Epoch: 61, Steps: 3 | Train Loss: 0.197 Vali Loss: 1.073 Vali Acc: 0.625 Test Loss: 1.073 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 62 cost time: 0.7633233070373535
Epoch: 62, Steps: 3 | Train Loss: 0.159 Vali Loss: 1.070 Vali Acc: 0.625 Test Loss: 1.070 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 63 cost time: 0.7250118255615234
Epoch: 63, Steps: 3 | Train Loss: 0.185 Vali Loss: 1.069 Vali Acc: 0.625 Test Loss: 1.069 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 64 cost time: 0.7133462429046631
Epoch: 64, Steps: 3 | Train Loss: 0.162 Vali Loss: 1.067 Vali Acc: 0.625 Test Loss: 1.067 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 65 cost time: 0.7393839359283447
Epoch: 65, Steps: 3 | Train Loss: 0.152 Vali Loss: 1.066 Vali Acc: 0.625 Test Loss: 1.066 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 66 cost time: 0.7332417964935303
Epoch: 66, Steps: 3 | Train Loss: 0.151 Vali Loss: 1.062 Vali Acc: 0.625 Test Loss: 1.062 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 67 cost time: 0.6649200916290283
Epoch: 67, Steps: 3 | Train Loss: 0.123 Vali Loss: 1.055 Vali Acc: 0.650 Test Loss: 1.055 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 68 cost time: 0.7259800434112549
Epoch: 68, Steps: 3 | Train Loss: 0.152 Vali Loss: 1.052 Vali Acc: 0.650 Test Loss: 1.052 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 69 cost time: 0.7167348861694336
Epoch: 69, Steps: 3 | Train Loss: 0.131 Vali Loss: 1.046 Vali Acc: 0.650 Test Loss: 1.046 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 70 cost time: 0.7431936264038086
Epoch: 70, Steps: 3 | Train Loss: 0.133 Vali Loss: 1.042 Vali Acc: 0.675 Test Loss: 1.042 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 71 cost time: 0.7968146800994873
Epoch: 71, Steps: 3 | Train Loss: 0.124 Vali Loss: 1.036 Vali Acc: 0.675 Test Loss: 1.036 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 72 cost time: 0.8275909423828125
Epoch: 72, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.031 Vali Acc: 0.675 Test Loss: 1.031 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 73 cost time: 0.6811668872833252
Epoch: 73, Steps: 3 | Train Loss: 0.118 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 74 cost time: 0.5809810161590576
Epoch: 74, Steps: 3 | Train Loss: 0.141 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 75 cost time: 0.7763488292694092
Epoch: 75, Steps: 3 | Train Loss: 0.119 Vali Loss: 1.012 Vali Acc: 0.675 Test Loss: 1.012 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 76 cost time: 0.7360579967498779
Epoch: 76, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.007 Vali Acc: 0.675 Test Loss: 1.007 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 77 cost time: 0.8372936248779297
Epoch: 77, Steps: 3 | Train Loss: 0.101 Vali Loss: 1.003 Vali Acc: 0.675 Test Loss: 1.003 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 78 cost time: 0.6930468082427979
Epoch: 78, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7797741889953613
Epoch: 79, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.6933205127716064
Epoch: 80, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.8179628849029541
Epoch: 81, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.001 Vali Acc: 0.650 Test Loss: 1.001 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.6788163185119629
Epoch: 82, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.000 Vali Acc: 0.650 Test Loss: 1.000 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.8775382041931152
Epoch: 83, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.998 Vali Acc: 0.650 Test Loss: 0.998 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.629260778427124
Epoch: 84, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.998 Vali Acc: 0.650 Test Loss: 0.998 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.6713643074035645
Epoch: 85, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.999 Vali Acc: 0.650 Test Loss: 0.999 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.8257961273193359
Epoch: 86, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.995 Vali Acc: 0.650 Test Loss: 0.995 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.6472258567810059
Epoch: 87, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.992 Vali Acc: 0.650 Test Loss: 0.992 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df256_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 22356
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.398535966873169
Epoch: 1, Steps: 3 | Train Loss: 1.612 Vali Loss: 1.377 Vali Acc: 0.250 Test Loss: 1.377 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.6950790882110596
Epoch: 2, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.361 Vali Acc: 0.275 Test Loss: 1.361 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.7147922515869141
Epoch: 3, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.344 Vali Acc: 0.250 Test Loss: 1.344 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7029237747192383
Epoch: 4, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.321 Vali Acc: 0.300 Test Loss: 1.321 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.6963238716125488
Epoch: 5, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.294 Vali Acc: 0.350 Test Loss: 1.294 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.5910248756408691
Epoch: 6, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.261 Vali Acc: 0.425 Test Loss: 1.261 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.6673846244812012
Epoch: 7, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.7040224075317383
Epoch: 8, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.183 Vali Acc: 0.525 Test Loss: 1.183 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.7100329399108887
Epoch: 9, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.140 Vali Acc: 0.550 Test Loss: 1.140 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 0.6106765270233154
Epoch: 10, Steps: 3 | Train Loss: 0.822 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.7546141147613525
Epoch: 11, Steps: 3 | Train Loss: 0.821 Vali Loss: 1.052 Vali Acc: 0.625 Test Loss: 1.052 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.6164751052856445
Epoch: 12, Steps: 3 | Train Loss: 0.704 Vali Loss: 1.013 Vali Acc: 0.650 Test Loss: 1.013 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 0.6735930442810059
Epoch: 13, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.980 Vali Acc: 0.650 Test Loss: 0.980 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 0.7972497940063477
Epoch: 14, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.957 Vali Acc: 0.650 Test Loss: 0.957 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.7639176845550537
Epoch: 15, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.930 Vali Acc: 0.650 Test Loss: 0.930 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 16 cost time: 0.6822395324707031
Epoch: 16, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.909 Vali Acc: 0.650 Test Loss: 0.909 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 17 cost time: 0.5975873470306396
Epoch: 17, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.876 Vali Acc: 0.650 Test Loss: 0.876 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 18 cost time: 0.684354305267334
Epoch: 18, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.848 Vali Acc: 0.700 Test Loss: 0.848 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699992).  Saving model ...
Epoch: 19 cost time: 0.620589017868042
Epoch: 19, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.813 Vali Acc: 0.700 Test Loss: 0.813 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 20 cost time: 0.6920225620269775
Epoch: 20, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.788 Vali Acc: 0.725 Test Loss: 0.788 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724992).  Saving model ...
Epoch: 21 cost time: 0.8375599384307861
Epoch: 21, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.766 Vali Acc: 0.725 Test Loss: 0.766 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 22 cost time: 0.6512887477874756
Epoch: 22, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.751 Vali Acc: 0.750 Test Loss: 0.751 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 0.665111780166626
Epoch: 23, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.740 Vali Acc: 0.750 Test Loss: 0.740 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 24 cost time: 0.6056506633758545
Epoch: 24, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.734 Vali Acc: 0.775 Test Loss: 0.734 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 25 cost time: 0.6947646141052246
Epoch: 25, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.725 Vali Acc: 0.775 Test Loss: 0.725 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 26 cost time: 0.7129158973693848
Epoch: 26, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 27 cost time: 0.7022442817687988
Epoch: 27, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.696 Vali Acc: 0.775 Test Loss: 0.696 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 28 cost time: 0.657376766204834
Epoch: 28, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.687 Vali Acc: 0.775 Test Loss: 0.687 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 29 cost time: 0.6186559200286865
Epoch: 29, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 30 cost time: 0.585341215133667
Epoch: 30, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.680 Vali Acc: 0.775 Test Loss: 0.680 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 31 cost time: 0.6279914379119873
Epoch: 31, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.676 Vali Acc: 0.775 Test Loss: 0.676 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 32 cost time: 0.7447199821472168
Epoch: 32, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.670 Vali Acc: 0.775 Test Loss: 0.670 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 33 cost time: 0.5705342292785645
Epoch: 33, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.665 Vali Acc: 0.775 Test Loss: 0.665 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 34 cost time: 0.5938489437103271
Epoch: 34, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.660 Vali Acc: 0.800 Test Loss: 0.660 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 35 cost time: 0.6182093620300293
Epoch: 35, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 36 cost time: 0.569025993347168
Epoch: 36, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.650 Vali Acc: 0.800 Test Loss: 0.650 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 37 cost time: 0.6900410652160645
Epoch: 37, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 38 cost time: 0.7060849666595459
Epoch: 38, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6135597229003906
Epoch: 39, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5702905654907227
Epoch: 40, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.646 Vali Acc: 0.800 Test Loss: 0.646 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 41 cost time: 0.725928783416748
Epoch: 41, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 42 cost time: 0.5971839427947998
Epoch: 42, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.643 Vali Acc: 0.800 Test Loss: 0.643 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 43 cost time: 0.6047279834747314
Epoch: 43, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6417825222015381
Epoch: 44, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.646 Vali Acc: 0.800 Test Loss: 0.646 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6932642459869385
Epoch: 45, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6029179096221924
Epoch: 46, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6397123336791992
Epoch: 47, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6654112339019775
Epoch: 48, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7342252731323242
Epoch: 49, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6548235416412354
Epoch: 50, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.647 Vali Acc: 0.800 Test Loss: 0.647 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.8161182403564453
Epoch: 51, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.645 Vali Acc: 0.800 Test Loss: 0.645 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6262352466583252
Epoch: 52, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.643 Vali Acc: 0.800 Test Loss: 0.643 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 53 cost time: 0.5713686943054199
Epoch: 53, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.800 Test Loss: 0.642 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 54 cost time: 0.6989924907684326
Epoch: 54, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.641 Vali Acc: 0.800 Test Loss: 0.641 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 55 cost time: 0.6454601287841797
Epoch: 55, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.800 Test Loss: 0.642 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5647456645965576
Epoch: 56, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.800 Test Loss: 0.643 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6097595691680908
Epoch: 57, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6319546699523926
Epoch: 58, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.645 Vali Acc: 0.800 Test Loss: 0.645 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6726999282836914
Epoch: 59, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.647 Vali Acc: 0.800 Test Loss: 0.647 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.7155451774597168
Epoch: 60, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.648 Vali Acc: 0.775 Test Loss: 0.648 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.6736311912536621
Epoch: 61, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.648 Vali Acc: 0.775 Test Loss: 0.648 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.7086131572723389
Epoch: 62, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.7489209175109863
Epoch: 63, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.647 Vali Acc: 0.800 Test Loss: 0.647 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.7168502807617188
Epoch: 64, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 30068
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2463228702545166
Epoch: 1, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.337 Vali Acc: 0.275 Test Loss: 1.337 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.585507869720459
Epoch: 2, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.328 Vali Acc: 0.300 Test Loss: 1.328 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.6144227981567383
Epoch: 3, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.319 Vali Acc: 0.300 Test Loss: 1.319 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.6338186264038086
Epoch: 4, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.305 Vali Acc: 0.300 Test Loss: 1.305 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.6499438285827637
Epoch: 5, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.285 Vali Acc: 0.325 Test Loss: 1.285 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.6549100875854492
Epoch: 6, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.262 Vali Acc: 0.350 Test Loss: 1.262 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.6009669303894043
Epoch: 7, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.5329358577728271
Epoch: 8, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.6518936157226562
Epoch: 9, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.5916070938110352
Epoch: 10, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.159 Vali Acc: 0.475 Test Loss: 1.159 Test Acc: 0.475
Validation loss decreased (-0.399988 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.5862891674041748
Epoch: 11, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 0.610424280166626
Epoch: 12, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 0.6070213317871094
Epoch: 13, Steps: 3 | Train Loss: 0.729 Vali Loss: 1.090 Vali Acc: 0.550 Test Loss: 1.090 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549989).  Saving model ...
Epoch: 14 cost time: 0.6917743682861328
Epoch: 14, Steps: 3 | Train Loss: 0.678 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.7518150806427002
Epoch: 15, Steps: 3 | Train Loss: 0.575 Vali Loss: 1.041 Vali Acc: 0.575 Test Loss: 1.041 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7491950988769531
Epoch: 16, Steps: 3 | Train Loss: 0.555 Vali Loss: 1.018 Vali Acc: 0.625 Test Loss: 1.018 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 17 cost time: 0.6522185802459717
Epoch: 17, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.998 Vali Acc: 0.625 Test Loss: 0.998 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 0.6393523216247559
Epoch: 18, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.982 Vali Acc: 0.625 Test Loss: 0.982 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 19 cost time: 0.6233823299407959
Epoch: 19, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.969 Vali Acc: 0.650 Test Loss: 0.969 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 20 cost time: 0.6859345436096191
Epoch: 20, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.949 Vali Acc: 0.650 Test Loss: 0.949 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 21 cost time: 0.6632168292999268
Epoch: 21, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.931 Vali Acc: 0.675 Test Loss: 0.931 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 22 cost time: 0.6269321441650391
Epoch: 22, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.909 Vali Acc: 0.675 Test Loss: 0.909 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 23 cost time: 0.766826868057251
Epoch: 23, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.887 Vali Acc: 0.675 Test Loss: 0.887 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 24 cost time: 0.5739810466766357
Epoch: 24, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.870 Vali Acc: 0.700 Test Loss: 0.870 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 25 cost time: 0.6195774078369141
Epoch: 25, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.856 Vali Acc: 0.675 Test Loss: 0.856 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5177810192108154
Epoch: 26, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.845 Vali Acc: 0.725 Test Loss: 0.845 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724992).  Saving model ...
Epoch: 27 cost time: 0.5602664947509766
Epoch: 27, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.838 Vali Acc: 0.725 Test Loss: 0.838 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 28 cost time: 0.6328089237213135
Epoch: 28, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.834 Vali Acc: 0.725 Test Loss: 0.834 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 29 cost time: 0.5963835716247559
Epoch: 29, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.832 Vali Acc: 0.725 Test Loss: 0.832 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 30 cost time: 0.6301593780517578
Epoch: 30, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.829 Vali Acc: 0.725 Test Loss: 0.829 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 31 cost time: 0.71370530128479
Epoch: 31, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.824 Vali Acc: 0.725 Test Loss: 0.824 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 32 cost time: 0.5976390838623047
Epoch: 32, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.818 Vali Acc: 0.725 Test Loss: 0.818 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 33 cost time: 0.6108803749084473
Epoch: 33, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.813 Vali Acc: 0.725 Test Loss: 0.813 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 34 cost time: 0.6723999977111816
Epoch: 34, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.808 Vali Acc: 0.725 Test Loss: 0.808 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 35 cost time: 0.6309547424316406
Epoch: 35, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.801 Vali Acc: 0.725 Test Loss: 0.801 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 36 cost time: 0.6791651248931885
Epoch: 36, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.795 Vali Acc: 0.725 Test Loss: 0.795 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 37 cost time: 0.6302087306976318
Epoch: 37, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.790 Vali Acc: 0.725 Test Loss: 0.790 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 38 cost time: 0.5892195701599121
Epoch: 38, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.787 Vali Acc: 0.725 Test Loss: 0.787 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 39 cost time: 0.6093542575836182
Epoch: 39, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.785 Vali Acc: 0.725 Test Loss: 0.785 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 40 cost time: 0.5507645606994629
Epoch: 40, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.783 Vali Acc: 0.725 Test Loss: 0.783 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 41 cost time: 0.6423449516296387
Epoch: 41, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.781 Vali Acc: 0.725 Test Loss: 0.781 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 42 cost time: 0.5562386512756348
Epoch: 42, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.781 Vali Acc: 0.725 Test Loss: 0.781 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5966536998748779
Epoch: 43, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.781 Vali Acc: 0.725 Test Loss: 0.781 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5632786750793457
Epoch: 44, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.781 Vali Acc: 0.725 Test Loss: 0.781 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 45 cost time: 0.6184182167053223
Epoch: 45, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.779 Vali Acc: 0.725 Test Loss: 0.779 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 46 cost time: 0.6492233276367188
Epoch: 46, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.777 Vali Acc: 0.725 Test Loss: 0.777 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 47 cost time: 0.6694254875183105
Epoch: 47, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.777 Vali Acc: 0.725 Test Loss: 0.777 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6340570449829102
Epoch: 48, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.777 Vali Acc: 0.725 Test Loss: 0.777 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.629157304763794
Epoch: 49, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.778 Vali Acc: 0.725 Test Loss: 0.778 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7144651412963867
Epoch: 50, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.777 Vali Acc: 0.725 Test Loss: 0.777 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 51 cost time: 0.6403629779815674
Epoch: 51, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.777 Vali Acc: 0.725 Test Loss: 0.777 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7049753665924072
Epoch: 52, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.779 Vali Acc: 0.725 Test Loss: 0.779 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7038960456848145
Epoch: 53, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.780 Vali Acc: 0.725 Test Loss: 0.780 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.5680861473083496
Epoch: 54, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.779 Vali Acc: 0.725 Test Loss: 0.779 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.7177667617797852
Epoch: 55, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.777 Vali Acc: 0.725 Test Loss: 0.777 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.7231948375701904
Epoch: 56, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.776 Vali Acc: 0.725 Test Loss: 0.776 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 57 cost time: 0.6199657917022705
Epoch: 57, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.775 Vali Acc: 0.725 Test Loss: 0.775 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 58 cost time: 0.6479356288909912
Epoch: 58, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.774 Vali Acc: 0.725 Test Loss: 0.774 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 59 cost time: 0.597398042678833
Epoch: 59, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.772 Vali Acc: 0.725 Test Loss: 0.772 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 60 cost time: 0.549731969833374
Epoch: 60, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.771 Vali Acc: 0.725 Test Loss: 0.771 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 61 cost time: 0.7111184597015381
Epoch: 61, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.770 Vali Acc: 0.725 Test Loss: 0.770 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 62 cost time: 0.5861263275146484
Epoch: 62, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.770 Vali Acc: 0.725 Test Loss: 0.770 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6487352848052979
Epoch: 63, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.770 Vali Acc: 0.725 Test Loss: 0.770 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 64 cost time: 0.6549246311187744
Epoch: 64, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.768 Vali Acc: 0.725 Test Loss: 0.768 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 65 cost time: 0.7572202682495117
Epoch: 65, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.768 Vali Acc: 0.725 Test Loss: 0.768 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 66 cost time: 0.5461230278015137
Epoch: 66, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.768 Vali Acc: 0.725 Test Loss: 0.768 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 67 cost time: 0.6738729476928711
Epoch: 67, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.768 Vali Acc: 0.725 Test Loss: 0.768 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6956467628479004
Epoch: 68, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.768 Vali Acc: 0.725 Test Loss: 0.768 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6362957954406738
Epoch: 69, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.769 Vali Acc: 0.725 Test Loss: 0.769 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.6809465885162354
Epoch: 70, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.770 Vali Acc: 0.725 Test Loss: 0.770 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.7064449787139893
Epoch: 71, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.770 Vali Acc: 0.725 Test Loss: 0.770 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.7302370071411133
Epoch: 72, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.770 Vali Acc: 0.725 Test Loss: 0.770 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.761824369430542
Epoch: 73, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.772 Vali Acc: 0.725 Test Loss: 0.772 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.6921579837799072
Epoch: 74, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.772 Vali Acc: 0.725 Test Loss: 0.772 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.7013230323791504
Epoch: 75, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.773 Vali Acc: 0.725 Test Loss: 0.773 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6493842601776123
Epoch: 76, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.774 Vali Acc: 0.725 Test Loss: 0.774 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 23572
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.534061908721924
Epoch: 1, Steps: 3 | Train Loss: 1.536 Vali Loss: 1.478 Vali Acc: 0.375 Test Loss: 1.478 Test Acc: 0.375
Validation loss decreased (inf --> -0.374985).  Saving model ...
Epoch: 2 cost time: 0.6616356372833252
Epoch: 2, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.457 Vali Acc: 0.350 Test Loss: 1.457 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6916286945343018
Epoch: 3, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.435 Vali Acc: 0.325 Test Loss: 1.435 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5162873268127441
Epoch: 4, Steps: 3 | Train Loss: 1.492 Vali Loss: 1.408 Vali Acc: 0.300 Test Loss: 1.408 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6121125221252441
Epoch: 5, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.377 Vali Acc: 0.300 Test Loss: 1.377 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6347997188568115
Epoch: 6, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.344 Vali Acc: 0.425 Test Loss: 1.344 Test Acc: 0.425
Validation loss decreased (-0.374985 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.639580488204956
Epoch: 7, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6681499481201172
Epoch: 8, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6495621204376221
Epoch: 9, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.250 Vali Acc: 0.350 Test Loss: 1.250 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7703051567077637
Epoch: 10, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6898214817047119
Epoch: 11, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.202 Vali Acc: 0.425 Test Loss: 1.202 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 12 cost time: 0.6636104583740234
Epoch: 12, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6481525897979736
Epoch: 13, Steps: 3 | Train Loss: 0.907 Vali Loss: 1.164 Vali Acc: 0.475 Test Loss: 1.164 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 0.6494994163513184
Epoch: 14, Steps: 3 | Train Loss: 0.865 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 0.6709613800048828
Epoch: 15, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.129 Vali Acc: 0.525 Test Loss: 1.129 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 16 cost time: 0.6593770980834961
Epoch: 16, Steps: 3 | Train Loss: 0.765 Vali Loss: 1.112 Vali Acc: 0.525 Test Loss: 1.112 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 17 cost time: 0.6511776447296143
Epoch: 17, Steps: 3 | Train Loss: 0.685 Vali Loss: 1.095 Vali Acc: 0.550 Test Loss: 1.095 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 18 cost time: 0.732654333114624
Epoch: 18, Steps: 3 | Train Loss: 0.618 Vali Loss: 1.078 Vali Acc: 0.550 Test Loss: 1.078 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 19 cost time: 0.6630027294158936
Epoch: 19, Steps: 3 | Train Loss: 0.619 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.7443454265594482
Epoch: 20, Steps: 3 | Train Loss: 0.596 Vali Loss: 1.052 Vali Acc: 0.575 Test Loss: 1.052 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6017622947692871
Epoch: 21, Steps: 3 | Train Loss: 0.497 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.6562724113464355
Epoch: 22, Steps: 3 | Train Loss: 0.434 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.818427562713623
Epoch: 23, Steps: 3 | Train Loss: 0.438 Vali Loss: 1.007 Vali Acc: 0.625 Test Loss: 1.007 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 24 cost time: 0.6664168834686279
Epoch: 24, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.989 Vali Acc: 0.650 Test Loss: 0.989 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 25 cost time: 0.6127350330352783
Epoch: 25, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.968 Vali Acc: 0.650 Test Loss: 0.968 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 26 cost time: 0.6551249027252197
Epoch: 26, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.953 Vali Acc: 0.650 Test Loss: 0.953 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 27 cost time: 0.6273143291473389
Epoch: 27, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.938 Vali Acc: 0.650 Test Loss: 0.938 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 28 cost time: 0.7073547840118408
Epoch: 28, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.924 Vali Acc: 0.675 Test Loss: 0.924 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 29 cost time: 0.851496696472168
Epoch: 29, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.906 Vali Acc: 0.675 Test Loss: 0.906 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 30 cost time: 0.6523213386535645
Epoch: 30, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.895 Vali Acc: 0.675 Test Loss: 0.895 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 31 cost time: 0.6550230979919434
Epoch: 31, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.883 Vali Acc: 0.675 Test Loss: 0.883 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 32 cost time: 0.644183874130249
Epoch: 32, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.868 Vali Acc: 0.700 Test Loss: 0.868 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 33 cost time: 0.6469173431396484
Epoch: 33, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.859 Vali Acc: 0.700 Test Loss: 0.859 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 34 cost time: 0.6477940082550049
Epoch: 34, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.852 Vali Acc: 0.700 Test Loss: 0.852 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 35 cost time: 0.693162202835083
Epoch: 35, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.845 Vali Acc: 0.700 Test Loss: 0.845 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 36 cost time: 0.6728148460388184
Epoch: 36, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.845 Vali Acc: 0.700 Test Loss: 0.845 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6083693504333496
Epoch: 37, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.843 Vali Acc: 0.700 Test Loss: 0.843 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 38 cost time: 0.6237072944641113
Epoch: 38, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.837 Vali Acc: 0.725 Test Loss: 0.837 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724992).  Saving model ...
Epoch: 39 cost time: 0.6696996688842773
Epoch: 39, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 40 cost time: 0.6338856220245361
Epoch: 40, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.835 Vali Acc: 0.750 Test Loss: 0.835 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 41 cost time: 0.8727757930755615
Epoch: 41, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.834 Vali Acc: 0.750 Test Loss: 0.834 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 42 cost time: 0.5764434337615967
Epoch: 42, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.835 Vali Acc: 0.750 Test Loss: 0.835 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.73313307762146
Epoch: 43, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.585946798324585
Epoch: 44, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.834 Vali Acc: 0.725 Test Loss: 0.834 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5820217132568359
Epoch: 45, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.831 Vali Acc: 0.725 Test Loss: 0.831 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6059296131134033
Epoch: 46, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.825 Vali Acc: 0.725 Test Loss: 0.825 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6356322765350342
Epoch: 47, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.820 Vali Acc: 0.725 Test Loss: 0.820 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6690747737884521
Epoch: 48, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.814 Vali Acc: 0.725 Test Loss: 0.814 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.5986051559448242
Epoch: 49, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.812 Vali Acc: 0.725 Test Loss: 0.812 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6863696575164795
Epoch: 50, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 51 cost time: 0.7361621856689453
Epoch: 51, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 52 cost time: 0.6191139221191406
Epoch: 52, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 53 cost time: 0.7182905673980713
Epoch: 53, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 54 cost time: 0.6299014091491699
Epoch: 54, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.803 Vali Acc: 0.750 Test Loss: 0.803 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 55 cost time: 0.717926025390625
Epoch: 55, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.802 Vali Acc: 0.725 Test Loss: 0.802 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.660308837890625
Epoch: 56, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.803 Vali Acc: 0.725 Test Loss: 0.803 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.7429840564727783
Epoch: 57, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.807 Vali Acc: 0.725 Test Loss: 0.807 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.5311970710754395
Epoch: 58, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.808 Vali Acc: 0.725 Test Loss: 0.808 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6002764701843262
Epoch: 59, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.809 Vali Acc: 0.725 Test Loss: 0.809 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.5878758430480957
Epoch: 60, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.809 Vali Acc: 0.725 Test Loss: 0.809 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.7496819496154785
Epoch: 61, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.808 Vali Acc: 0.725 Test Loss: 0.808 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.7154064178466797
Epoch: 62, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.808 Vali Acc: 0.725 Test Loss: 0.808 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.6389412879943848
Epoch: 63, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.808 Vali Acc: 0.725 Test Loss: 0.808 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.7132678031921387
Epoch: 64, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.808 Vali Acc: 0.725 Test Loss: 0.808 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 20548
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.214787006378174
Epoch: 1, Steps: 3 | Train Loss: 1.608 Vali Loss: 1.473 Vali Acc: 0.300 Test Loss: 1.473 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.6271474361419678
Epoch: 2, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.454 Vali Acc: 0.300 Test Loss: 1.454 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.71797776222229
Epoch: 3, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.438 Vali Acc: 0.275 Test Loss: 1.438 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6522955894470215
Epoch: 4, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.419 Vali Acc: 0.275 Test Loss: 1.419 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6778557300567627
Epoch: 5, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.397 Vali Acc: 0.250 Test Loss: 1.397 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6952743530273438
Epoch: 6, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.372 Vali Acc: 0.325 Test Loss: 1.372 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.711400032043457
Epoch: 7, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.348 Vali Acc: 0.375 Test Loss: 1.348 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.5997273921966553
Epoch: 8, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.325 Vali Acc: 0.425 Test Loss: 1.325 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.6131255626678467
Epoch: 9, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.302 Vali Acc: 0.475 Test Loss: 1.302 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.6862552165985107
Epoch: 10, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.278 Vali Acc: 0.450 Test Loss: 1.278 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6794610023498535
Epoch: 11, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.257 Vali Acc: 0.450 Test Loss: 1.257 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5902547836303711
Epoch: 12, Steps: 3 | Train Loss: 0.977 Vali Loss: 1.236 Vali Acc: 0.475 Test Loss: 1.236 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 0.6062116622924805
Epoch: 13, Steps: 3 | Train Loss: 0.892 Vali Loss: 1.214 Vali Acc: 0.475 Test Loss: 1.214 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 0.7226896286010742
Epoch: 14, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.193 Vali Acc: 0.525 Test Loss: 1.193 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 0.5969829559326172
Epoch: 15, Steps: 3 | Train Loss: 0.888 Vali Loss: 1.178 Vali Acc: 0.575 Test Loss: 1.178 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 16 cost time: 0.6060030460357666
Epoch: 16, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.160 Vali Acc: 0.575 Test Loss: 1.160 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 17 cost time: 0.6259555816650391
Epoch: 17, Steps: 3 | Train Loss: 0.735 Vali Loss: 1.144 Vali Acc: 0.600 Test Loss: 1.144 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.64479660987854
Epoch: 18, Steps: 3 | Train Loss: 0.656 Vali Loss: 1.130 Vali Acc: 0.600 Test Loss: 1.130 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.7233703136444092
Epoch: 19, Steps: 3 | Train Loss: 0.701 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.7351889610290527
Epoch: 20, Steps: 3 | Train Loss: 0.590 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 0.6698970794677734
Epoch: 21, Steps: 3 | Train Loss: 0.624 Vali Loss: 1.091 Vali Acc: 0.625 Test Loss: 1.091 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 22 cost time: 0.668581485748291
Epoch: 22, Steps: 3 | Train Loss: 0.525 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 23 cost time: 0.6242330074310303
Epoch: 23, Steps: 3 | Train Loss: 0.478 Vali Loss: 1.072 Vali Acc: 0.625 Test Loss: 1.072 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6383447647094727
Epoch: 24, Steps: 3 | Train Loss: 0.445 Vali Loss: 1.065 Vali Acc: 0.675 Test Loss: 1.065 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.7486846446990967
Epoch: 25, Steps: 3 | Train Loss: 0.459 Vali Loss: 1.057 Vali Acc: 0.675 Test Loss: 1.057 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.6896584033966064
Epoch: 26, Steps: 3 | Train Loss: 0.411 Vali Loss: 1.048 Vali Acc: 0.675 Test Loss: 1.048 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 27 cost time: 0.6668059825897217
Epoch: 27, Steps: 3 | Train Loss: 0.424 Vali Loss: 1.039 Vali Acc: 0.675 Test Loss: 1.039 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 28 cost time: 0.6212921142578125
Epoch: 28, Steps: 3 | Train Loss: 0.316 Vali Loss: 1.030 Vali Acc: 0.675 Test Loss: 1.030 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 29 cost time: 0.5452182292938232
Epoch: 29, Steps: 3 | Train Loss: 0.309 Vali Loss: 1.023 Vali Acc: 0.675 Test Loss: 1.023 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 30 cost time: 0.7377679347991943
Epoch: 30, Steps: 3 | Train Loss: 0.260 Vali Loss: 1.022 Vali Acc: 0.675 Test Loss: 1.022 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 31 cost time: 0.7027871608734131
Epoch: 31, Steps: 3 | Train Loss: 0.207 Vali Loss: 1.022 Vali Acc: 0.675 Test Loss: 1.022 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5539414882659912
Epoch: 32, Steps: 3 | Train Loss: 0.249 Vali Loss: 1.018 Vali Acc: 0.700 Test Loss: 1.018 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 33 cost time: 0.7311971187591553
Epoch: 33, Steps: 3 | Train Loss: 0.181 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 34 cost time: 0.5725505352020264
Epoch: 34, Steps: 3 | Train Loss: 0.197 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 35 cost time: 0.599522590637207
Epoch: 35, Steps: 3 | Train Loss: 0.195 Vali Loss: 1.018 Vali Acc: 0.700 Test Loss: 1.018 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7527310848236084
Epoch: 36, Steps: 3 | Train Loss: 0.162 Vali Loss: 1.022 Vali Acc: 0.700 Test Loss: 1.022 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6477570533752441
Epoch: 37, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.025 Vali Acc: 0.700 Test Loss: 1.025 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.682781457901001
Epoch: 38, Steps: 3 | Train Loss: 0.132 Vali Loss: 1.028 Vali Acc: 0.700 Test Loss: 1.028 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6617846488952637
Epoch: 39, Steps: 3 | Train Loss: 0.136 Vali Loss: 1.032 Vali Acc: 0.700 Test Loss: 1.032 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7075519561767578
Epoch: 40, Steps: 3 | Train Loss: 0.118 Vali Loss: 1.035 Vali Acc: 0.700 Test Loss: 1.035 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6582474708557129
Epoch: 41, Steps: 3 | Train Loss: 0.119 Vali Loss: 1.034 Vali Acc: 0.700 Test Loss: 1.034 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6553363800048828
Epoch: 42, Steps: 3 | Train Loss: 0.091 Vali Loss: 1.031 Vali Acc: 0.675 Test Loss: 1.031 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6224281787872314
Epoch: 43, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.031 Vali Acc: 0.675 Test Loss: 1.031 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6345055103302002
Epoch: 44, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.028 Vali Acc: 0.675 Test Loss: 1.028 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 18660
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4807004928588867
Epoch: 1, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.571 Vali Acc: 0.200 Test Loss: 1.571 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 0.5750036239624023
Epoch: 2, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.573 Vali Acc: 0.150 Test Loss: 1.573 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5955910682678223
Epoch: 3, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.574 Vali Acc: 0.200 Test Loss: 1.574 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7003514766693115
Epoch: 4, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.572 Vali Acc: 0.200 Test Loss: 1.572 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5597829818725586
Epoch: 5, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.569 Vali Acc: 0.200 Test Loss: 1.569 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 6 cost time: 0.675847053527832
Epoch: 6, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.564 Vali Acc: 0.200 Test Loss: 1.564 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 7 cost time: 0.6621115207672119
Epoch: 7, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.557 Vali Acc: 0.250 Test Loss: 1.557 Test Acc: 0.250
Validation loss decreased (-0.199984 --> -0.249984).  Saving model ...
Epoch: 8 cost time: 0.6523516178131104
Epoch: 8, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.549 Vali Acc: 0.250 Test Loss: 1.549 Test Acc: 0.250
Validation loss decreased (-0.249984 --> -0.249985).  Saving model ...
Epoch: 9 cost time: 0.6750929355621338
Epoch: 9, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.541 Vali Acc: 0.250 Test Loss: 1.541 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 10 cost time: 0.6135554313659668
Epoch: 10, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.532 Vali Acc: 0.250 Test Loss: 1.532 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 11 cost time: 0.6213526725769043
Epoch: 11, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.521 Vali Acc: 0.275 Test Loss: 1.521 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 12 cost time: 0.589850902557373
Epoch: 12, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.509 Vali Acc: 0.300 Test Loss: 1.509 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 13 cost time: 0.661292314529419
Epoch: 13, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.498 Vali Acc: 0.325 Test Loss: 1.498 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 14 cost time: 0.6723501682281494
Epoch: 14, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.485 Vali Acc: 0.325 Test Loss: 1.485 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 15 cost time: 0.6036124229431152
Epoch: 15, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.472 Vali Acc: 0.325 Test Loss: 1.472 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 16 cost time: 0.6805381774902344
Epoch: 16, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.460 Vali Acc: 0.325 Test Loss: 1.460 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 17 cost time: 0.7266814708709717
Epoch: 17, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.448 Vali Acc: 0.350 Test Loss: 1.448 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349986).  Saving model ...
Epoch: 18 cost time: 0.7018845081329346
Epoch: 18, Steps: 3 | Train Loss: 0.897 Vali Loss: 1.434 Vali Acc: 0.350 Test Loss: 1.434 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 19 cost time: 0.6007533073425293
Epoch: 19, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.421 Vali Acc: 0.350 Test Loss: 1.421 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 20 cost time: 0.669081449508667
Epoch: 20, Steps: 3 | Train Loss: 0.843 Vali Loss: 1.407 Vali Acc: 0.350 Test Loss: 1.407 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 21 cost time: 0.7720203399658203
Epoch: 21, Steps: 3 | Train Loss: 0.816 Vali Loss: 1.395 Vali Acc: 0.350 Test Loss: 1.395 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 22 cost time: 0.6623101234436035
Epoch: 22, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.385 Vali Acc: 0.400 Test Loss: 1.385 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 23 cost time: 0.6641793251037598
Epoch: 23, Steps: 3 | Train Loss: 0.795 Vali Loss: 1.374 Vali Acc: 0.425 Test Loss: 1.374 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 24 cost time: 0.6260240077972412
Epoch: 24, Steps: 3 | Train Loss: 0.764 Vali Loss: 1.368 Vali Acc: 0.425 Test Loss: 1.368 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 25 cost time: 0.6865367889404297
Epoch: 25, Steps: 3 | Train Loss: 0.723 Vali Loss: 1.361 Vali Acc: 0.425 Test Loss: 1.361 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 26 cost time: 0.578932523727417
Epoch: 26, Steps: 3 | Train Loss: 0.653 Vali Loss: 1.355 Vali Acc: 0.425 Test Loss: 1.355 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 27 cost time: 0.622077465057373
Epoch: 27, Steps: 3 | Train Loss: 0.645 Vali Loss: 1.348 Vali Acc: 0.450 Test Loss: 1.348 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 28 cost time: 0.6040973663330078
Epoch: 28, Steps: 3 | Train Loss: 0.618 Vali Loss: 1.340 Vali Acc: 0.475 Test Loss: 1.340 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 29 cost time: 0.6417186260223389
Epoch: 29, Steps: 3 | Train Loss: 0.642 Vali Loss: 1.334 Vali Acc: 0.500 Test Loss: 1.334 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 30 cost time: 0.7413897514343262
Epoch: 30, Steps: 3 | Train Loss: 0.551 Vali Loss: 1.327 Vali Acc: 0.500 Test Loss: 1.327 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 31 cost time: 0.6520130634307861
Epoch: 31, Steps: 3 | Train Loss: 0.490 Vali Loss: 1.319 Vali Acc: 0.500 Test Loss: 1.319 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 32 cost time: 0.6420137882232666
Epoch: 32, Steps: 3 | Train Loss: 0.458 Vali Loss: 1.312 Vali Acc: 0.500 Test Loss: 1.312 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 33 cost time: 0.701465368270874
Epoch: 33, Steps: 3 | Train Loss: 0.440 Vali Loss: 1.302 Vali Acc: 0.500 Test Loss: 1.302 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 34 cost time: 0.6030521392822266
Epoch: 34, Steps: 3 | Train Loss: 0.485 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 35 cost time: 0.6330111026763916
Epoch: 35, Steps: 3 | Train Loss: 0.395 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 36 cost time: 0.6435565948486328
Epoch: 36, Steps: 3 | Train Loss: 0.378 Vali Loss: 1.282 Vali Acc: 0.500 Test Loss: 1.282 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 37 cost time: 0.5909826755523682
Epoch: 37, Steps: 3 | Train Loss: 0.396 Vali Loss: 1.279 Vali Acc: 0.500 Test Loss: 1.279 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 38 cost time: 0.8238329887390137
Epoch: 38, Steps: 3 | Train Loss: 0.348 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 39 cost time: 0.6418776512145996
Epoch: 39, Steps: 3 | Train Loss: 0.327 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 40 cost time: 0.8031070232391357
Epoch: 40, Steps: 3 | Train Loss: 0.293 Vali Loss: 1.265 Vali Acc: 0.475 Test Loss: 1.265 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5323390960693359
Epoch: 41, Steps: 3 | Train Loss: 0.252 Vali Loss: 1.259 Vali Acc: 0.475 Test Loss: 1.259 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6705441474914551
Epoch: 42, Steps: 3 | Train Loss: 0.294 Vali Loss: 1.254 Vali Acc: 0.475 Test Loss: 1.254 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6329379081726074
Epoch: 43, Steps: 3 | Train Loss: 0.265 Vali Loss: 1.251 Vali Acc: 0.475 Test Loss: 1.251 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6693592071533203
Epoch: 44, Steps: 3 | Train Loss: 0.212 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 45 cost time: 0.6694388389587402
Epoch: 45, Steps: 3 | Train Loss: 0.227 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 46 cost time: 0.7239034175872803
Epoch: 46, Steps: 3 | Train Loss: 0.237 Vali Loss: 1.247 Vali Acc: 0.525 Test Loss: 1.247 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 47 cost time: 0.6711761951446533
Epoch: 47, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.245 Vali Acc: 0.525 Test Loss: 1.245 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 48 cost time: 0.7561795711517334
Epoch: 48, Steps: 3 | Train Loss: 0.189 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8150732517242432
Epoch: 49, Steps: 3 | Train Loss: 0.161 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7022075653076172
Epoch: 50, Steps: 3 | Train Loss: 0.166 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6536214351654053
Epoch: 51, Steps: 3 | Train Loss: 0.171 Vali Loss: 1.243 Vali Acc: 0.550 Test Loss: 1.243 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 52 cost time: 0.5846459865570068
Epoch: 52, Steps: 3 | Train Loss: 0.173 Vali Loss: 1.240 Vali Acc: 0.550 Test Loss: 1.240 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 53 cost time: 0.6083872318267822
Epoch: 53, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.240 Vali Acc: 0.550 Test Loss: 1.240 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 54 cost time: 0.7046158313751221
Epoch: 54, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.237 Vali Acc: 0.550 Test Loss: 1.237 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 55 cost time: 0.6523122787475586
Epoch: 55, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.231 Vali Acc: 0.575 Test Loss: 1.231 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 56 cost time: 0.655602216720581
Epoch: 56, Steps: 3 | Train Loss: 0.127 Vali Loss: 1.230 Vali Acc: 0.575 Test Loss: 1.230 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 57 cost time: 0.5933182239532471
Epoch: 57, Steps: 3 | Train Loss: 0.098 Vali Loss: 1.232 Vali Acc: 0.575 Test Loss: 1.232 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6009445190429688
Epoch: 58, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.236 Vali Acc: 0.575 Test Loss: 1.236 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.647756814956665
Epoch: 59, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.239 Vali Acc: 0.575 Test Loss: 1.239 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5986080169677734
Epoch: 60, Steps: 3 | Train Loss: 0.106 Vali Loss: 1.243 Vali Acc: 0.575 Test Loss: 1.243 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.6384787559509277
Epoch: 61, Steps: 3 | Train Loss: 0.091 Vali Loss: 1.245 Vali Acc: 0.625 Test Loss: 1.245 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 62 cost time: 0.6446268558502197
Epoch: 62, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.249 Vali Acc: 0.625 Test Loss: 1.249 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6435437202453613
Epoch: 63, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.252 Vali Acc: 0.625 Test Loss: 1.252 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.7586443424224854
Epoch: 64, Steps: 3 | Train Loss: 0.070 Vali Loss: 1.254 Vali Acc: 0.625 Test Loss: 1.254 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.7874937057495117
Epoch: 65, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.257 Vali Acc: 0.625 Test Loss: 1.257 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.6718080043792725
Epoch: 66, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.259 Vali Acc: 0.625 Test Loss: 1.259 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.6332852840423584
Epoch: 67, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.259 Vali Acc: 0.625 Test Loss: 1.259 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.6058199405670166
Epoch: 68, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.262 Vali Acc: 0.625 Test Loss: 1.262 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.5983905792236328
Epoch: 69, Steps: 3 | Train Loss: 0.076 Vali Loss: 1.266 Vali Acc: 0.625 Test Loss: 1.266 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.7157247066497803
Epoch: 70, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.268 Vali Acc: 0.625 Test Loss: 1.268 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.6997866630554199
Epoch: 71, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.270 Vali Acc: 0.625 Test Loss: 1.270 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 15668
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.508814573287964
Epoch: 1, Steps: 3 | Train Loss: 1.543 Vali Loss: 1.437 Vali Acc: 0.200 Test Loss: 1.437 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.6869251728057861
Epoch: 2, Steps: 3 | Train Loss: 1.548 Vali Loss: 1.442 Vali Acc: 0.225 Test Loss: 1.442 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.6135396957397461
Epoch: 3, Steps: 3 | Train Loss: 1.477 Vali Loss: 1.446 Vali Acc: 0.250 Test Loss: 1.446 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.6008191108703613
Epoch: 4, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.449 Vali Acc: 0.250 Test Loss: 1.449 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7113535404205322
Epoch: 5, Steps: 3 | Train Loss: 1.524 Vali Loss: 1.450 Vali Acc: 0.250 Test Loss: 1.450 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6069638729095459
Epoch: 6, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.448 Vali Acc: 0.250 Test Loss: 1.448 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5896186828613281
Epoch: 7, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.445 Vali Acc: 0.250 Test Loss: 1.445 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 8 cost time: 0.5592453479766846
Epoch: 8, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.440 Vali Acc: 0.250 Test Loss: 1.440 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 0.5739841461181641
Epoch: 9, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.435 Vali Acc: 0.300 Test Loss: 1.435 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 10 cost time: 0.5362040996551514
Epoch: 10, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.427 Vali Acc: 0.300 Test Loss: 1.427 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 11 cost time: 0.5922996997833252
Epoch: 11, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.418 Vali Acc: 0.325 Test Loss: 1.418 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 12 cost time: 0.6661636829376221
Epoch: 12, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.408 Vali Acc: 0.350 Test Loss: 1.408 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 13 cost time: 0.650078535079956
Epoch: 13, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.398 Vali Acc: 0.400 Test Loss: 1.398 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 14 cost time: 0.5782806873321533
Epoch: 14, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.388 Vali Acc: 0.450 Test Loss: 1.388 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 15 cost time: 0.6980099678039551
Epoch: 15, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.377 Vali Acc: 0.450 Test Loss: 1.377 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 16 cost time: 0.7974536418914795
Epoch: 16, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.367 Vali Acc: 0.450 Test Loss: 1.367 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 17 cost time: 0.59513258934021
Epoch: 17, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.357 Vali Acc: 0.425 Test Loss: 1.357 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6723511219024658
Epoch: 18, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.347 Vali Acc: 0.500 Test Loss: 1.347 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499987).  Saving model ...
Epoch: 19 cost time: 0.6473081111907959
Epoch: 19, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.338 Vali Acc: 0.475 Test Loss: 1.338 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.630634069442749
Epoch: 20, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 21 cost time: 0.6491045951843262
Epoch: 21, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 22 cost time: 0.6424736976623535
Epoch: 22, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 23 cost time: 0.6193592548370361
Epoch: 23, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 24 cost time: 0.7240667343139648
Epoch: 24, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.277 Vali Acc: 0.500 Test Loss: 1.277 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 25 cost time: 0.6265702247619629
Epoch: 25, Steps: 3 | Train Loss: 0.804 Vali Loss: 1.263 Vali Acc: 0.500 Test Loss: 1.263 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 26 cost time: 0.6053130626678467
Epoch: 26, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 27 cost time: 0.588970422744751
Epoch: 27, Steps: 3 | Train Loss: 0.705 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 28 cost time: 0.6029384136199951
Epoch: 28, Steps: 3 | Train Loss: 0.746 Vali Loss: 1.227 Vali Acc: 0.525 Test Loss: 1.227 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 29 cost time: 0.6569521427154541
Epoch: 29, Steps: 3 | Train Loss: 0.738 Vali Loss: 1.216 Vali Acc: 0.525 Test Loss: 1.216 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 30 cost time: 0.6948225498199463
Epoch: 30, Steps: 3 | Train Loss: 0.610 Vali Loss: 1.206 Vali Acc: 0.525 Test Loss: 1.206 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 31 cost time: 0.6160640716552734
Epoch: 31, Steps: 3 | Train Loss: 0.557 Vali Loss: 1.196 Vali Acc: 0.525 Test Loss: 1.196 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 32 cost time: 0.6618189811706543
Epoch: 32, Steps: 3 | Train Loss: 0.563 Vali Loss: 1.187 Vali Acc: 0.575 Test Loss: 1.187 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 33 cost time: 0.6730031967163086
Epoch: 33, Steps: 3 | Train Loss: 0.581 Vali Loss: 1.176 Vali Acc: 0.575 Test Loss: 1.176 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 34 cost time: 0.6148927211761475
Epoch: 34, Steps: 3 | Train Loss: 0.506 Vali Loss: 1.164 Vali Acc: 0.600 Test Loss: 1.164 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 35 cost time: 0.5944874286651611
Epoch: 35, Steps: 3 | Train Loss: 0.502 Vali Loss: 1.157 Vali Acc: 0.600 Test Loss: 1.157 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 36 cost time: 0.5917413234710693
Epoch: 36, Steps: 3 | Train Loss: 0.469 Vali Loss: 1.149 Vali Acc: 0.625 Test Loss: 1.149 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 37 cost time: 0.6388919353485107
Epoch: 37, Steps: 3 | Train Loss: 0.461 Vali Loss: 1.144 Vali Acc: 0.625 Test Loss: 1.144 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 38 cost time: 0.686737060546875
Epoch: 38, Steps: 3 | Train Loss: 0.394 Vali Loss: 1.139 Vali Acc: 0.625 Test Loss: 1.139 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 39 cost time: 0.7059640884399414
Epoch: 39, Steps: 3 | Train Loss: 0.410 Vali Loss: 1.133 Vali Acc: 0.625 Test Loss: 1.133 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 40 cost time: 0.6350951194763184
Epoch: 40, Steps: 3 | Train Loss: 0.393 Vali Loss: 1.125 Vali Acc: 0.650 Test Loss: 1.125 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 41 cost time: 0.7060976028442383
Epoch: 41, Steps: 3 | Train Loss: 0.356 Vali Loss: 1.115 Vali Acc: 0.650 Test Loss: 1.115 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 42 cost time: 0.6267983913421631
Epoch: 42, Steps: 3 | Train Loss: 0.376 Vali Loss: 1.109 Vali Acc: 0.650 Test Loss: 1.109 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 43 cost time: 0.6317179203033447
Epoch: 43, Steps: 3 | Train Loss: 0.307 Vali Loss: 1.102 Vali Acc: 0.650 Test Loss: 1.102 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 44 cost time: 0.6298003196716309
Epoch: 44, Steps: 3 | Train Loss: 0.266 Vali Loss: 1.095 Vali Acc: 0.675 Test Loss: 1.095 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 45 cost time: 0.5527958869934082
Epoch: 45, Steps: 3 | Train Loss: 0.275 Vali Loss: 1.086 Vali Acc: 0.650 Test Loss: 1.086 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5882437229156494
Epoch: 46, Steps: 3 | Train Loss: 0.260 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5945794582366943
Epoch: 47, Steps: 3 | Train Loss: 0.232 Vali Loss: 1.079 Vali Acc: 0.650 Test Loss: 1.079 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.577063798904419
Epoch: 48, Steps: 3 | Train Loss: 0.263 Vali Loss: 1.078 Vali Acc: 0.675 Test Loss: 1.078 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 49 cost time: 0.725095272064209
Epoch: 49, Steps: 3 | Train Loss: 0.265 Vali Loss: 1.076 Vali Acc: 0.675 Test Loss: 1.076 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 50 cost time: 0.5702159404754639
Epoch: 50, Steps: 3 | Train Loss: 0.236 Vali Loss: 1.072 Vali Acc: 0.675 Test Loss: 1.072 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 51 cost time: 0.6032588481903076
Epoch: 51, Steps: 3 | Train Loss: 0.226 Vali Loss: 1.071 Vali Acc: 0.675 Test Loss: 1.071 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 52 cost time: 0.652634859085083
Epoch: 52, Steps: 3 | Train Loss: 0.182 Vali Loss: 1.071 Vali Acc: 0.675 Test Loss: 1.071 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 53 cost time: 0.666210412979126
Epoch: 53, Steps: 3 | Train Loss: 0.163 Vali Loss: 1.069 Vali Acc: 0.675 Test Loss: 1.069 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 54 cost time: 0.6792356967926025
Epoch: 54, Steps: 3 | Train Loss: 0.195 Vali Loss: 1.071 Vali Acc: 0.675 Test Loss: 1.071 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.637256383895874
Epoch: 55, Steps: 3 | Train Loss: 0.167 Vali Loss: 1.070 Vali Acc: 0.700 Test Loss: 1.070 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 56 cost time: 0.6253495216369629
Epoch: 56, Steps: 3 | Train Loss: 0.167 Vali Loss: 1.068 Vali Acc: 0.700 Test Loss: 1.068 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 57 cost time: 0.5954983234405518
Epoch: 57, Steps: 3 | Train Loss: 0.158 Vali Loss: 1.066 Vali Acc: 0.700 Test Loss: 1.066 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 58 cost time: 0.6724462509155273
Epoch: 58, Steps: 3 | Train Loss: 0.135 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 59 cost time: 0.6494483947753906
Epoch: 59, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.062 Vali Acc: 0.700 Test Loss: 1.062 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 60 cost time: 0.6665420532226562
Epoch: 60, Steps: 3 | Train Loss: 0.142 Vali Loss: 1.056 Vali Acc: 0.700 Test Loss: 1.056 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 61 cost time: 0.6336870193481445
Epoch: 61, Steps: 3 | Train Loss: 0.131 Vali Loss: 1.054 Vali Acc: 0.700 Test Loss: 1.054 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 62 cost time: 0.6163768768310547
Epoch: 62, Steps: 3 | Train Loss: 0.125 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 63 cost time: 0.619657039642334
Epoch: 63, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.051 Vali Acc: 0.700 Test Loss: 1.051 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 64 cost time: 0.6317088603973389
Epoch: 64, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.048 Vali Acc: 0.700 Test Loss: 1.048 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 65 cost time: 0.5873255729675293
Epoch: 65, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.046 Vali Acc: 0.700 Test Loss: 1.046 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 66 cost time: 0.6759617328643799
Epoch: 66, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.041 Vali Acc: 0.700 Test Loss: 1.041 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 67 cost time: 0.6815683841705322
Epoch: 67, Steps: 3 | Train Loss: 0.083 Vali Loss: 1.040 Vali Acc: 0.700 Test Loss: 1.040 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 68 cost time: 0.6160509586334229
Epoch: 68, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.042 Vali Acc: 0.700 Test Loss: 1.042 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7250914573669434
Epoch: 69, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.041 Vali Acc: 0.700 Test Loss: 1.041 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.6245462894439697
Epoch: 70, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.040 Vali Acc: 0.700 Test Loss: 1.040 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.5565166473388672
Epoch: 71, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.041 Vali Acc: 0.700 Test Loss: 1.041 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.5805177688598633
Epoch: 72, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.039 Vali Acc: 0.700 Test Loss: 1.039 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 73 cost time: 0.691627025604248
Epoch: 73, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 74 cost time: 0.6490392684936523
Epoch: 74, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 75 cost time: 0.6571810245513916
Epoch: 75, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.035 Vali Acc: 0.700 Test Loss: 1.035 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 76 cost time: 0.6351814270019531
Epoch: 76, Steps: 3 | Train Loss: 0.070 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.6488516330718994
Epoch: 77, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.5748889446258545
Epoch: 78, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.039 Vali Acc: 0.700 Test Loss: 1.039 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.7018923759460449
Epoch: 79, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.6686804294586182
Epoch: 80, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.6568808555603027
Epoch: 81, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.6531963348388672
Epoch: 82, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.032 Vali Acc: 0.700 Test Loss: 1.032 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 83 cost time: 0.6478466987609863
Epoch: 83, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 84 cost time: 0.6957476139068604
Epoch: 84, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.023 Vali Acc: 0.700 Test Loss: 1.023 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 85 cost time: 0.5967590808868408
Epoch: 85, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.021 Vali Acc: 0.700 Test Loss: 1.021 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 86 cost time: 0.6844384670257568
Epoch: 86, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 87 cost time: 0.6385941505432129
Epoch: 87, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 88 cost time: 0.583294153213501
Epoch: 88, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 89 cost time: 0.7110371589660645
Epoch: 89, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.014 Vali Acc: 0.700 Test Loss: 1.014 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.5871422290802002
Epoch: 90, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.014 Vali Acc: 0.700 Test Loss: 1.014 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.7280583381652832
Epoch: 91, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.011 Vali Acc: 0.700 Test Loss: 1.011 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 92 cost time: 0.7837831974029541
Epoch: 92, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 93 cost time: 0.6682448387145996
Epoch: 93, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 94 cost time: 0.6694188117980957
Epoch: 94, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.014 Vali Acc: 0.700 Test Loss: 1.014 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.6844666004180908
Epoch: 95, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.5863571166992188
Epoch: 96, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.7409372329711914
Epoch: 97, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.018 Vali Acc: 0.700 Test Loss: 1.018 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 0.7547321319580078
Epoch: 98, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.018 Vali Acc: 0.700 Test Loss: 1.018 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 0.62253737449646
Epoch: 99, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.019 Vali Acc: 0.700 Test Loss: 1.019 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 0.7244465351104736
Epoch: 100, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.018 Vali Acc: 0.700 Test Loss: 1.018 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 14980
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.318798065185547
Epoch: 1, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.524 Vali Acc: 0.200 Test Loss: 1.524 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.6617326736450195
Epoch: 2, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.511 Vali Acc: 0.175 Test Loss: 1.511 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5400533676147461
Epoch: 3, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.505 Vali Acc: 0.175 Test Loss: 1.505 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6023876667022705
Epoch: 4, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.500 Vali Acc: 0.200 Test Loss: 1.500 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 5 cost time: 0.580470085144043
Epoch: 5, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.497 Vali Acc: 0.225 Test Loss: 1.497 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 6 cost time: 0.626861572265625
Epoch: 6, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.494 Vali Acc: 0.250 Test Loss: 1.494 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249985).  Saving model ...
Epoch: 7 cost time: 0.6747972965240479
Epoch: 7, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.490 Vali Acc: 0.250 Test Loss: 1.490 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 8 cost time: 0.6421234607696533
Epoch: 8, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.484 Vali Acc: 0.275 Test Loss: 1.484 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 9 cost time: 0.674210786819458
Epoch: 9, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.476 Vali Acc: 0.300 Test Loss: 1.476 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 10 cost time: 0.7546167373657227
Epoch: 10, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.469 Vali Acc: 0.300 Test Loss: 1.469 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 11 cost time: 0.5848300457000732
Epoch: 11, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.462 Vali Acc: 0.275 Test Loss: 1.462 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5704014301300049
Epoch: 12, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.453 Vali Acc: 0.275 Test Loss: 1.453 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6760904788970947
Epoch: 13, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.444 Vali Acc: 0.275 Test Loss: 1.444 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5778994560241699
Epoch: 14, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.435 Vali Acc: 0.275 Test Loss: 1.435 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6335651874542236
Epoch: 15, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.426 Vali Acc: 0.275 Test Loss: 1.426 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6282651424407959
Epoch: 16, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.417 Vali Acc: 0.300 Test Loss: 1.417 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 17 cost time: 0.6407315731048584
Epoch: 17, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.407 Vali Acc: 0.300 Test Loss: 1.407 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 18 cost time: 0.5555500984191895
Epoch: 18, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.399 Vali Acc: 0.325 Test Loss: 1.399 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 19 cost time: 0.6268107891082764
Epoch: 19, Steps: 3 | Train Loss: 0.999 Vali Loss: 1.390 Vali Acc: 0.350 Test Loss: 1.390 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 20 cost time: 0.6342124938964844
Epoch: 20, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.379 Vali Acc: 0.350 Test Loss: 1.379 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 21 cost time: 0.6388068199157715
Epoch: 21, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.370 Vali Acc: 0.325 Test Loss: 1.370 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7007112503051758
Epoch: 22, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.362 Vali Acc: 0.325 Test Loss: 1.362 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6900804042816162
Epoch: 23, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.354 Vali Acc: 0.325 Test Loss: 1.354 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5989551544189453
Epoch: 24, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.344 Vali Acc: 0.325 Test Loss: 1.344 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5946733951568604
Epoch: 25, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.335 Vali Acc: 0.350 Test Loss: 1.335 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 26 cost time: 0.678922176361084
Epoch: 26, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.326 Vali Acc: 0.375 Test Loss: 1.326 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 27 cost time: 0.6326873302459717
Epoch: 27, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.316 Vali Acc: 0.400 Test Loss: 1.316 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 28 cost time: 0.6011688709259033
Epoch: 28, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 29 cost time: 0.6545696258544922
Epoch: 29, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.299 Vali Acc: 0.400 Test Loss: 1.299 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 30 cost time: 0.6467716693878174
Epoch: 30, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 31 cost time: 0.6786973476409912
Epoch: 31, Steps: 3 | Train Loss: 0.754 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 32 cost time: 0.6867778301239014
Epoch: 32, Steps: 3 | Train Loss: 0.645 Vali Loss: 1.271 Vali Acc: 0.400 Test Loss: 1.271 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 33 cost time: 0.5851976871490479
Epoch: 33, Steps: 3 | Train Loss: 0.804 Vali Loss: 1.263 Vali Acc: 0.425 Test Loss: 1.263 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 34 cost time: 0.6884651184082031
Epoch: 34, Steps: 3 | Train Loss: 0.562 Vali Loss: 1.257 Vali Acc: 0.475 Test Loss: 1.257 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 35 cost time: 0.6246969699859619
Epoch: 35, Steps: 3 | Train Loss: 0.677 Vali Loss: 1.252 Vali Acc: 0.475 Test Loss: 1.252 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 36 cost time: 0.6302282810211182
Epoch: 36, Steps: 3 | Train Loss: 0.613 Vali Loss: 1.248 Vali Acc: 0.475 Test Loss: 1.248 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 37 cost time: 0.6688528060913086
Epoch: 37, Steps: 3 | Train Loss: 0.610 Vali Loss: 1.244 Vali Acc: 0.475 Test Loss: 1.244 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 38 cost time: 0.6571416854858398
Epoch: 38, Steps: 3 | Train Loss: 0.660 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 39 cost time: 0.6189820766448975
Epoch: 39, Steps: 3 | Train Loss: 0.522 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 40 cost time: 0.694068431854248
Epoch: 40, Steps: 3 | Train Loss: 0.562 Vali Loss: 1.228 Vali Acc: 0.525 Test Loss: 1.228 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 41 cost time: 0.6563403606414795
Epoch: 41, Steps: 3 | Train Loss: 0.481 Vali Loss: 1.223 Vali Acc: 0.550 Test Loss: 1.223 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 42 cost time: 0.7115435600280762
Epoch: 42, Steps: 3 | Train Loss: 0.477 Vali Loss: 1.217 Vali Acc: 0.575 Test Loss: 1.217 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 43 cost time: 0.5631568431854248
Epoch: 43, Steps: 3 | Train Loss: 0.452 Vali Loss: 1.212 Vali Acc: 0.575 Test Loss: 1.212 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 44 cost time: 0.5739643573760986
Epoch: 44, Steps: 3 | Train Loss: 0.493 Vali Loss: 1.205 Vali Acc: 0.575 Test Loss: 1.205 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 45 cost time: 0.698049783706665
Epoch: 45, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.202 Vali Acc: 0.575 Test Loss: 1.202 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 46 cost time: 0.6881167888641357
Epoch: 46, Steps: 3 | Train Loss: 0.435 Vali Loss: 1.198 Vali Acc: 0.575 Test Loss: 1.198 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 47 cost time: 0.5599639415740967
Epoch: 47, Steps: 3 | Train Loss: 0.403 Vali Loss: 1.191 Vali Acc: 0.575 Test Loss: 1.191 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 48 cost time: 0.6225728988647461
Epoch: 48, Steps: 3 | Train Loss: 0.442 Vali Loss: 1.184 Vali Acc: 0.575 Test Loss: 1.184 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 49 cost time: 0.6633214950561523
Epoch: 49, Steps: 3 | Train Loss: 0.375 Vali Loss: 1.177 Vali Acc: 0.575 Test Loss: 1.177 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 50 cost time: 0.6233930587768555
Epoch: 50, Steps: 3 | Train Loss: 0.428 Vali Loss: 1.173 Vali Acc: 0.575 Test Loss: 1.173 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 51 cost time: 0.6895115375518799
Epoch: 51, Steps: 3 | Train Loss: 0.373 Vali Loss: 1.167 Vali Acc: 0.575 Test Loss: 1.167 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 52 cost time: 0.5950121879577637
Epoch: 52, Steps: 3 | Train Loss: 0.341 Vali Loss: 1.163 Vali Acc: 0.600 Test Loss: 1.163 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 53 cost time: 0.6727538108825684
Epoch: 53, Steps: 3 | Train Loss: 0.319 Vali Loss: 1.155 Vali Acc: 0.600 Test Loss: 1.155 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 54 cost time: 0.6525623798370361
Epoch: 54, Steps: 3 | Train Loss: 0.274 Vali Loss: 1.148 Vali Acc: 0.625 Test Loss: 1.148 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 55 cost time: 0.5932343006134033
Epoch: 55, Steps: 3 | Train Loss: 0.275 Vali Loss: 1.144 Vali Acc: 0.625 Test Loss: 1.144 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 56 cost time: 0.595473051071167
Epoch: 56, Steps: 3 | Train Loss: 0.310 Vali Loss: 1.139 Vali Acc: 0.625 Test Loss: 1.139 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 57 cost time: 0.6646585464477539
Epoch: 57, Steps: 3 | Train Loss: 0.250 Vali Loss: 1.134 Vali Acc: 0.625 Test Loss: 1.134 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 58 cost time: 0.7021708488464355
Epoch: 58, Steps: 3 | Train Loss: 0.269 Vali Loss: 1.128 Vali Acc: 0.625 Test Loss: 1.128 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 59 cost time: 0.7383062839508057
Epoch: 59, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.125 Vali Acc: 0.650 Test Loss: 1.125 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 60 cost time: 0.7012479305267334
Epoch: 60, Steps: 3 | Train Loss: 0.217 Vali Loss: 1.123 Vali Acc: 0.625 Test Loss: 1.123 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7702052593231201
Epoch: 61, Steps: 3 | Train Loss: 0.208 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.6363387107849121
Epoch: 62, Steps: 3 | Train Loss: 0.204 Vali Loss: 1.125 Vali Acc: 0.625 Test Loss: 1.125 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.6708266735076904
Epoch: 63, Steps: 3 | Train Loss: 0.224 Vali Loss: 1.125 Vali Acc: 0.650 Test Loss: 1.125 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 64 cost time: 0.6296520233154297
Epoch: 64, Steps: 3 | Train Loss: 0.208 Vali Loss: 1.122 Vali Acc: 0.650 Test Loss: 1.122 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 65 cost time: 0.9171772003173828
Epoch: 65, Steps: 3 | Train Loss: 0.212 Vali Loss: 1.117 Vali Acc: 0.650 Test Loss: 1.117 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 66 cost time: 0.6347482204437256
Epoch: 66, Steps: 3 | Train Loss: 0.207 Vali Loss: 1.112 Vali Acc: 0.650 Test Loss: 1.112 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 67 cost time: 0.6586112976074219
Epoch: 67, Steps: 3 | Train Loss: 0.198 Vali Loss: 1.106 Vali Acc: 0.650 Test Loss: 1.106 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 68 cost time: 0.6427669525146484
Epoch: 68, Steps: 3 | Train Loss: 0.157 Vali Loss: 1.102 Vali Acc: 0.650 Test Loss: 1.102 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 69 cost time: 0.7094817161560059
Epoch: 69, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.095 Vali Acc: 0.650 Test Loss: 1.095 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 70 cost time: 0.6795003414154053
Epoch: 70, Steps: 3 | Train Loss: 0.162 Vali Loss: 1.091 Vali Acc: 0.650 Test Loss: 1.091 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 71 cost time: 0.7737867832183838
Epoch: 71, Steps: 3 | Train Loss: 0.148 Vali Loss: 1.087 Vali Acc: 0.650 Test Loss: 1.087 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 72 cost time: 0.6423704624176025
Epoch: 72, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.084 Vali Acc: 0.650 Test Loss: 1.084 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 73 cost time: 0.671607494354248
Epoch: 73, Steps: 3 | Train Loss: 0.120 Vali Loss: 1.079 Vali Acc: 0.650 Test Loss: 1.079 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 74 cost time: 0.664099931716919
Epoch: 74, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.077 Vali Acc: 0.650 Test Loss: 1.077 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 75 cost time: 0.598379373550415
Epoch: 75, Steps: 3 | Train Loss: 0.149 Vali Loss: 1.072 Vali Acc: 0.650 Test Loss: 1.072 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 76 cost time: 0.8086607456207275
Epoch: 76, Steps: 3 | Train Loss: 0.098 Vali Loss: 1.071 Vali Acc: 0.650 Test Loss: 1.071 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 77 cost time: 0.744504451751709
Epoch: 77, Steps: 3 | Train Loss: 0.116 Vali Loss: 1.070 Vali Acc: 0.650 Test Loss: 1.070 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 78 cost time: 0.7038938999176025
Epoch: 78, Steps: 3 | Train Loss: 0.123 Vali Loss: 1.069 Vali Acc: 0.650 Test Loss: 1.069 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 79 cost time: 0.6709330081939697
Epoch: 79, Steps: 3 | Train Loss: 0.124 Vali Loss: 1.068 Vali Acc: 0.650 Test Loss: 1.068 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 80 cost time: 0.6304683685302734
Epoch: 80, Steps: 3 | Train Loss: 0.105 Vali Loss: 1.066 Vali Acc: 0.650 Test Loss: 1.066 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 81 cost time: 0.6628983020782471
Epoch: 81, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.063 Vali Acc: 0.650 Test Loss: 1.063 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 82 cost time: 0.683823823928833
Epoch: 82, Steps: 3 | Train Loss: 0.106 Vali Loss: 1.066 Vali Acc: 0.650 Test Loss: 1.066 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.6960093975067139
Epoch: 83, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.062 Vali Acc: 0.650 Test Loss: 1.062 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 84 cost time: 0.6739790439605713
Epoch: 84, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.062 Vali Acc: 0.650 Test Loss: 1.062 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.6736307144165039
Epoch: 85, Steps: 3 | Train Loss: 0.095 Vali Loss: 1.061 Vali Acc: 0.650 Test Loss: 1.061 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 86 cost time: 0.6863677501678467
Epoch: 86, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.061 Vali Acc: 0.650 Test Loss: 1.061 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 87 cost time: 0.8679184913635254
Epoch: 87, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.060 Vali Acc: 0.650 Test Loss: 1.060 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 88 cost time: 0.7141363620758057
Epoch: 88, Steps: 3 | Train Loss: 0.106 Vali Loss: 1.056 Vali Acc: 0.650 Test Loss: 1.056 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 89 cost time: 0.6340963840484619
Epoch: 89, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.048 Vali Acc: 0.650 Test Loss: 1.048 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 90 cost time: 0.8293948173522949
Epoch: 90, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.047 Vali Acc: 0.650 Test Loss: 1.047 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 91 cost time: 0.7050232887268066
Epoch: 91, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.040 Vali Acc: 0.650 Test Loss: 1.040 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 92 cost time: 0.6989297866821289
Epoch: 92, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.036 Vali Acc: 0.650 Test Loss: 1.036 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 93 cost time: 0.702782154083252
Epoch: 93, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.030 Vali Acc: 0.675 Test Loss: 1.030 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 94 cost time: 0.6253578662872314
Epoch: 94, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 95 cost time: 0.6467649936676025
Epoch: 95, Steps: 3 | Train Loss: 0.074 Vali Loss: 1.024 Vali Acc: 0.675 Test Loss: 1.024 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 96 cost time: 0.809931755065918
Epoch: 96, Steps: 3 | Train Loss: 0.070 Vali Loss: 1.023 Vali Acc: 0.675 Test Loss: 1.023 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 97 cost time: 0.7057828903198242
Epoch: 97, Steps: 3 | Train Loss: 0.076 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 98 cost time: 0.6311659812927246
Epoch: 98, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.018 Vali Acc: 0.675 Test Loss: 1.018 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 99 cost time: 0.6435854434967041
Epoch: 99, Steps: 3 | Train Loss: 0.055 Vali Loss: 1.009 Vali Acc: 0.675 Test Loss: 1.009 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 100 cost time: 0.6973452568054199
Epoch: 100, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.006 Vali Acc: 0.675 Test Loss: 1.006 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df128_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 13908
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.396376848220825
Epoch: 1, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.429 Vali Acc: 0.250 Test Loss: 1.429 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5980265140533447
Epoch: 2, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.404 Vali Acc: 0.275 Test Loss: 1.404 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.5705351829528809
Epoch: 3, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.377 Vali Acc: 0.325 Test Loss: 1.377 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.6843974590301514
Epoch: 4, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.348 Vali Acc: 0.300 Test Loss: 1.348 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.634429931640625
Epoch: 5, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.316 Vali Acc: 0.325 Test Loss: 1.316 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.5831787586212158
Epoch: 6, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.5960290431976318
Epoch: 7, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.258 Vali Acc: 0.425 Test Loss: 1.258 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.6233899593353271
Epoch: 8, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.226 Vali Acc: 0.475 Test Loss: 1.226 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.7037136554718018
Epoch: 9, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.193 Vali Acc: 0.475 Test Loss: 1.193 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 0.6096067428588867
Epoch: 10, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.5861027240753174
Epoch: 11, Steps: 3 | Train Loss: 0.700 Vali Loss: 1.130 Vali Acc: 0.525 Test Loss: 1.130 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 12 cost time: 0.5743229389190674
Epoch: 12, Steps: 3 | Train Loss: 0.705 Vali Loss: 1.100 Vali Acc: 0.550 Test Loss: 1.100 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 13 cost time: 0.5964007377624512
Epoch: 13, Steps: 3 | Train Loss: 0.628 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.6523346900939941
Epoch: 14, Steps: 3 | Train Loss: 0.546 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.5977764129638672
Epoch: 15, Steps: 3 | Train Loss: 0.526 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.6615753173828125
Epoch: 16, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.993 Vali Acc: 0.650 Test Loss: 0.993 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 0.6821045875549316
Epoch: 17, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.961 Vali Acc: 0.700 Test Loss: 0.961 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 0.7105746269226074
Epoch: 18, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.933 Vali Acc: 0.700 Test Loss: 0.933 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 19 cost time: 0.7219254970550537
Epoch: 19, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.903 Vali Acc: 0.750 Test Loss: 0.903 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.5911605358123779
Epoch: 20, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 0.717555046081543
Epoch: 21, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.858 Vali Acc: 0.800 Test Loss: 0.858 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 0.6716361045837402
Epoch: 22, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.839 Vali Acc: 0.800 Test Loss: 0.839 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 23 cost time: 0.6446657180786133
Epoch: 23, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 0.6300725936889648
Epoch: 24, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.815 Vali Acc: 0.800 Test Loss: 0.815 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 0.8300092220306396
Epoch: 25, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.816 Vali Acc: 0.700 Test Loss: 0.816 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6819887161254883
Epoch: 26, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.812 Vali Acc: 0.750 Test Loss: 0.812 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6694276332855225
Epoch: 27, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.805 Vali Acc: 0.775 Test Loss: 0.805 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6875476837158203
Epoch: 28, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.781 Vali Acc: 0.775 Test Loss: 0.781 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6720843315124512
Epoch: 29, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.761 Vali Acc: 0.775 Test Loss: 0.761 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.677342414855957
Epoch: 30, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6232924461364746
Epoch: 31, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.740 Vali Acc: 0.800 Test Loss: 0.740 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 32 cost time: 0.7718884944915771
Epoch: 32, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.734 Vali Acc: 0.800 Test Loss: 0.734 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 33 cost time: 0.6395289897918701
Epoch: 33, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.733 Vali Acc: 0.825 Test Loss: 0.733 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 34 cost time: 0.7287087440490723
Epoch: 34, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.734 Vali Acc: 0.825 Test Loss: 0.734 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7590680122375488
Epoch: 35, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.736 Vali Acc: 0.800 Test Loss: 0.736 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7528088092803955
Epoch: 36, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7384850978851318
Epoch: 37, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.738 Vali Acc: 0.800 Test Loss: 0.738 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6979610919952393
Epoch: 38, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.738 Vali Acc: 0.775 Test Loss: 0.738 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7485356330871582
Epoch: 39, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.736 Vali Acc: 0.775 Test Loss: 0.736 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8173792362213135
Epoch: 40, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.733 Vali Acc: 0.775 Test Loss: 0.733 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6443562507629395
Epoch: 41, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.730 Vali Acc: 0.775 Test Loss: 0.730 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7498745918273926
Epoch: 42, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.728 Vali Acc: 0.775 Test Loss: 0.728 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6271274089813232
Epoch: 43, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.725 Vali Acc: 0.775 Test Loss: 0.725 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 25844
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.329148292541504
Epoch: 1, Steps: 3 | Train Loss: 1.542 Vali Loss: 1.475 Vali Acc: 0.275 Test Loss: 1.475 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.674823522567749
Epoch: 2, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.433 Vali Acc: 0.275 Test Loss: 1.433 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6857733726501465
Epoch: 3, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.400 Vali Acc: 0.350 Test Loss: 1.400 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.6164588928222656
Epoch: 4, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.367 Vali Acc: 0.375 Test Loss: 1.367 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.7095234394073486
Epoch: 5, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.337 Vali Acc: 0.400 Test Loss: 1.337 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.6818978786468506
Epoch: 6, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.305 Vali Acc: 0.475 Test Loss: 1.305 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.7808718681335449
Epoch: 7, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.278 Vali Acc: 0.450 Test Loss: 1.278 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6757073402404785
Epoch: 8, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.6662805080413818
Epoch: 9, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.219 Vali Acc: 0.475 Test Loss: 1.219 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6511294841766357
Epoch: 10, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.621964693069458
Epoch: 11, Steps: 3 | Train Loss: 0.888 Vali Loss: 1.168 Vali Acc: 0.550 Test Loss: 1.168 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.6771109104156494
Epoch: 12, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.149 Vali Acc: 0.600 Test Loss: 1.149 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.6183767318725586
Epoch: 13, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.129 Vali Acc: 0.625 Test Loss: 1.129 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.8278012275695801
Epoch: 14, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.107 Vali Acc: 0.625 Test Loss: 1.107 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.6862668991088867
Epoch: 15, Steps: 3 | Train Loss: 0.721 Vali Loss: 1.094 Vali Acc: 0.600 Test Loss: 1.094 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.651050329208374
Epoch: 16, Steps: 3 | Train Loss: 0.585 Vali Loss: 1.074 Vali Acc: 0.575 Test Loss: 1.074 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6870517730712891
Epoch: 17, Steps: 3 | Train Loss: 0.595 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8037869930267334
Epoch: 18, Steps: 3 | Train Loss: 0.516 Vali Loss: 1.051 Vali Acc: 0.625 Test Loss: 1.051 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.7008392810821533
Epoch: 19, Steps: 3 | Train Loss: 0.499 Vali Loss: 1.030 Vali Acc: 0.625 Test Loss: 1.030 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 20 cost time: 0.6504373550415039
Epoch: 20, Steps: 3 | Train Loss: 0.418 Vali Loss: 1.015 Vali Acc: 0.625 Test Loss: 1.015 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 21 cost time: 0.6903684139251709
Epoch: 21, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.993 Vali Acc: 0.650 Test Loss: 0.993 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 22 cost time: 0.7364504337310791
Epoch: 22, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.975 Vali Acc: 0.650 Test Loss: 0.975 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 23 cost time: 0.6570985317230225
Epoch: 23, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.963 Vali Acc: 0.650 Test Loss: 0.963 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 0.6458733081817627
Epoch: 24, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.958 Vali Acc: 0.675 Test Loss: 0.958 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 25 cost time: 0.6954874992370605
Epoch: 25, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.962 Vali Acc: 0.675 Test Loss: 0.962 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7117781639099121
Epoch: 26, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.959 Vali Acc: 0.675 Test Loss: 0.959 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6478643417358398
Epoch: 27, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.954 Vali Acc: 0.675 Test Loss: 0.954 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 28 cost time: 0.5874688625335693
Epoch: 28, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.941 Vali Acc: 0.675 Test Loss: 0.941 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 29 cost time: 0.7617228031158447
Epoch: 29, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.925 Vali Acc: 0.700 Test Loss: 0.925 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 30 cost time: 0.6188998222351074
Epoch: 30, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 31 cost time: 0.7452867031097412
Epoch: 31, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.893 Vali Acc: 0.725 Test Loss: 0.893 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 32 cost time: 0.6632328033447266
Epoch: 32, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.882 Vali Acc: 0.725 Test Loss: 0.882 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 33 cost time: 0.7780895233154297
Epoch: 33, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.879 Vali Acc: 0.725 Test Loss: 0.879 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 34 cost time: 0.6222314834594727
Epoch: 34, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.881 Vali Acc: 0.725 Test Loss: 0.881 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6388330459594727
Epoch: 35, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.885 Vali Acc: 0.725 Test Loss: 0.885 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6689257621765137
Epoch: 36, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.890 Vali Acc: 0.725 Test Loss: 0.890 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6770575046539307
Epoch: 37, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.900 Vali Acc: 0.725 Test Loss: 0.900 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6908586025238037
Epoch: 38, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.908 Vali Acc: 0.725 Test Loss: 0.908 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6989128589630127
Epoch: 39, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.914 Vali Acc: 0.725 Test Loss: 0.914 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6225974559783936
Epoch: 40, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.915 Vali Acc: 0.725 Test Loss: 0.915 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7171974182128906
Epoch: 41, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.916 Vali Acc: 0.725 Test Loss: 0.916 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7118892669677734
Epoch: 42, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.917 Vali Acc: 0.725 Test Loss: 0.917 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5882611274719238
Epoch: 43, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.917 Vali Acc: 0.725 Test Loss: 0.917 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 19348
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3376176357269287
Epoch: 1, Steps: 3 | Train Loss: 1.597 Vali Loss: 1.796 Vali Acc: 0.250 Test Loss: 1.796 Test Acc: 0.250
Validation loss decreased (inf --> -0.249982).  Saving model ...
Epoch: 2 cost time: 0.6330485343933105
Epoch: 2, Steps: 3 | Train Loss: 1.617 Vali Loss: 1.726 Vali Acc: 0.300 Test Loss: 1.726 Test Acc: 0.300
Validation loss decreased (-0.249982 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 0.5709092617034912
Epoch: 3, Steps: 3 | Train Loss: 1.559 Vali Loss: 1.671 Vali Acc: 0.300 Test Loss: 1.671 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.599052906036377
Epoch: 4, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.619 Vali Acc: 0.325 Test Loss: 1.619 Test Acc: 0.325
Validation loss decreased (-0.299983 --> -0.324984).  Saving model ...
Epoch: 5 cost time: 0.6547775268554688
Epoch: 5, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.566 Vali Acc: 0.325 Test Loss: 1.566 Test Acc: 0.325
Validation loss decreased (-0.324984 --> -0.324984).  Saving model ...
Epoch: 6 cost time: 0.6827592849731445
Epoch: 6, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.522 Vali Acc: 0.325 Test Loss: 1.522 Test Acc: 0.325
Validation loss decreased (-0.324984 --> -0.324985).  Saving model ...
Epoch: 7 cost time: 0.606508731842041
Epoch: 7, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.475 Vali Acc: 0.350 Test Loss: 1.475 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 8 cost time: 0.6321439743041992
Epoch: 8, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.428 Vali Acc: 0.400 Test Loss: 1.428 Test Acc: 0.400
Validation loss decreased (-0.349985 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 0.5870521068572998
Epoch: 9, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.387 Vali Acc: 0.400 Test Loss: 1.387 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.5776998996734619
Epoch: 10, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.348 Vali Acc: 0.450 Test Loss: 1.348 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.4942309856414795
Epoch: 11, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.312 Vali Acc: 0.425 Test Loss: 1.312 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5854041576385498
Epoch: 12, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.276 Vali Acc: 0.450 Test Loss: 1.276 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 13 cost time: 0.6255567073822021
Epoch: 13, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.4825441837310791
Epoch: 14, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 0.6160204410552979
Epoch: 15, Steps: 3 | Train Loss: 0.786 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 0.5678753852844238
Epoch: 16, Steps: 3 | Train Loss: 0.759 Vali Loss: 1.180 Vali Acc: 0.525 Test Loss: 1.180 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.5330207347869873
Epoch: 17, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.159 Vali Acc: 0.525 Test Loss: 1.159 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 18 cost time: 0.6193642616271973
Epoch: 18, Steps: 3 | Train Loss: 0.623 Vali Loss: 1.139 Vali Acc: 0.525 Test Loss: 1.139 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 19 cost time: 0.5397601127624512
Epoch: 19, Steps: 3 | Train Loss: 0.602 Vali Loss: 1.113 Vali Acc: 0.550 Test Loss: 1.113 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 20 cost time: 0.565190315246582
Epoch: 20, Steps: 3 | Train Loss: 0.512 Vali Loss: 1.092 Vali Acc: 0.625 Test Loss: 1.092 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 0.7166228294372559
Epoch: 21, Steps: 3 | Train Loss: 0.609 Vali Loss: 1.079 Vali Acc: 0.650 Test Loss: 1.079 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 22 cost time: 0.6250920295715332
Epoch: 22, Steps: 3 | Train Loss: 0.478 Vali Loss: 1.065 Vali Acc: 0.650 Test Loss: 1.065 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 23 cost time: 0.6140186786651611
Epoch: 23, Steps: 3 | Train Loss: 0.464 Vali Loss: 1.046 Vali Acc: 0.650 Test Loss: 1.046 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 0.5990772247314453
Epoch: 24, Steps: 3 | Train Loss: 0.375 Vali Loss: 1.031 Vali Acc: 0.700 Test Loss: 1.031 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 25 cost time: 0.6502716541290283
Epoch: 25, Steps: 3 | Train Loss: 0.353 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.559215784072876
Epoch: 26, Steps: 3 | Train Loss: 0.324 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6817693710327148
Epoch: 27, Steps: 3 | Train Loss: 0.308 Vali Loss: 1.008 Vali Acc: 0.675 Test Loss: 1.008 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7248623371124268
Epoch: 28, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.997 Vali Acc: 0.675 Test Loss: 0.997 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7183659076690674
Epoch: 29, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.988 Vali Acc: 0.675 Test Loss: 0.988 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5573227405548096
Epoch: 30, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.976 Vali Acc: 0.675 Test Loss: 0.976 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6201257705688477
Epoch: 31, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.964 Vali Acc: 0.675 Test Loss: 0.964 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5732142925262451
Epoch: 32, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.951 Vali Acc: 0.700 Test Loss: 0.951 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 33 cost time: 0.5798180103302002
Epoch: 33, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 34 cost time: 0.664006233215332
Epoch: 34, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.938 Vali Acc: 0.700 Test Loss: 0.938 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 35 cost time: 0.6466858386993408
Epoch: 35, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.932 Vali Acc: 0.700 Test Loss: 0.932 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 36 cost time: 0.5650825500488281
Epoch: 36, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.928 Vali Acc: 0.700 Test Loss: 0.928 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 37 cost time: 0.7519309520721436
Epoch: 37, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.927 Vali Acc: 0.700 Test Loss: 0.927 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 38 cost time: 0.7162826061248779
Epoch: 38, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.927 Vali Acc: 0.700 Test Loss: 0.927 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 39 cost time: 0.6632289886474609
Epoch: 39, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.927 Vali Acc: 0.725 Test Loss: 0.927 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 40 cost time: 0.5516314506530762
Epoch: 40, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.925 Vali Acc: 0.725 Test Loss: 0.925 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 41 cost time: 0.7852814197540283
Epoch: 41, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.922 Vali Acc: 0.725 Test Loss: 0.922 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 42 cost time: 0.5727052688598633
Epoch: 42, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.919 Vali Acc: 0.725 Test Loss: 0.919 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 43 cost time: 0.6824023723602295
Epoch: 43, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.917 Vali Acc: 0.750 Test Loss: 0.917 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 44 cost time: 0.6284594535827637
Epoch: 44, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.920 Vali Acc: 0.750 Test Loss: 0.920 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.660984992980957
Epoch: 45, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.922 Vali Acc: 0.750 Test Loss: 0.922 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6146180629730225
Epoch: 46, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.926 Vali Acc: 0.750 Test Loss: 0.926 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7002642154693604
Epoch: 47, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6179275512695312
Epoch: 48, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6800594329833984
Epoch: 49, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.935 Vali Acc: 0.750 Test Loss: 0.935 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6188099384307861
Epoch: 50, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.936 Vali Acc: 0.750 Test Loss: 0.936 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.7264609336853027
Epoch: 51, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5804011821746826
Epoch: 52, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.6056773662567139
Epoch: 53, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 16324
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3812193870544434
Epoch: 1, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.324 Vali Acc: 0.250 Test Loss: 1.324 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.6653165817260742
Epoch: 2, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.316 Vali Acc: 0.275 Test Loss: 1.316 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.5995361804962158
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.309 Vali Acc: 0.250 Test Loss: 1.309 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5271494388580322
Epoch: 4, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.298 Vali Acc: 0.325 Test Loss: 1.298 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.6088213920593262
Epoch: 5, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.286 Vali Acc: 0.350 Test Loss: 1.286 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.5999867916107178
Epoch: 6, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.270 Vali Acc: 0.325 Test Loss: 1.270 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5726516246795654
Epoch: 7, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.254 Vali Acc: 0.350 Test Loss: 1.254 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 8 cost time: 0.5908448696136475
Epoch: 8, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.238 Vali Acc: 0.375 Test Loss: 1.238 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374988).  Saving model ...
Epoch: 9 cost time: 0.6628146171569824
Epoch: 9, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
Validation loss decreased (-0.374988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.610562801361084
Epoch: 10, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.202 Vali Acc: 0.425 Test Loss: 1.202 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 11 cost time: 0.6556389331817627
Epoch: 11, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.183 Vali Acc: 0.450 Test Loss: 1.183 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 12 cost time: 0.6246337890625
Epoch: 12, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.164 Vali Acc: 0.425 Test Loss: 1.164 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.576056718826294
Epoch: 13, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.145 Vali Acc: 0.475 Test Loss: 1.145 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474989).  Saving model ...
Epoch: 14 cost time: 0.5390934944152832
Epoch: 14, Steps: 3 | Train Loss: 0.818 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 0.7443368434906006
Epoch: 15, Steps: 3 | Train Loss: 0.748 Vali Loss: 1.105 Vali Acc: 0.525 Test Loss: 1.105 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 16 cost time: 0.5797326564788818
Epoch: 16, Steps: 3 | Train Loss: 0.739 Vali Loss: 1.087 Vali Acc: 0.525 Test Loss: 1.087 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 17 cost time: 0.6492900848388672
Epoch: 17, Steps: 3 | Train Loss: 0.709 Vali Loss: 1.070 Vali Acc: 0.550 Test Loss: 1.070 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 18 cost time: 0.5871241092681885
Epoch: 18, Steps: 3 | Train Loss: 0.645 Vali Loss: 1.053 Vali Acc: 0.575 Test Loss: 1.053 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 19 cost time: 0.6455235481262207
Epoch: 19, Steps: 3 | Train Loss: 0.601 Vali Loss: 1.041 Vali Acc: 0.575 Test Loss: 1.041 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 20 cost time: 0.6550498008728027
Epoch: 20, Steps: 3 | Train Loss: 0.615 Vali Loss: 1.028 Vali Acc: 0.575 Test Loss: 1.028 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 21 cost time: 0.6241884231567383
Epoch: 21, Steps: 3 | Train Loss: 0.605 Vali Loss: 1.015 Vali Acc: 0.575 Test Loss: 1.015 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 22 cost time: 0.656400203704834
Epoch: 22, Steps: 3 | Train Loss: 0.513 Vali Loss: 1.005 Vali Acc: 0.575 Test Loss: 1.005 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 23 cost time: 0.626023530960083
Epoch: 23, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.991 Vali Acc: 0.575 Test Loss: 0.991 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 24 cost time: 0.6410012245178223
Epoch: 24, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.980 Vali Acc: 0.600 Test Loss: 0.980 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.8514504432678223
Epoch: 25, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.6107048988342285
Epoch: 26, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 27 cost time: 0.6396682262420654
Epoch: 27, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 28 cost time: 0.6577515602111816
Epoch: 28, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.948 Vali Acc: 0.600 Test Loss: 0.948 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599991).  Saving model ...
Epoch: 29 cost time: 0.5888218879699707
Epoch: 29, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.943 Vali Acc: 0.575 Test Loss: 0.943 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5543005466461182
Epoch: 30, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.937 Vali Acc: 0.625 Test Loss: 0.937 Test Acc: 0.625
Validation loss decreased (-0.599991 --> -0.624991).  Saving model ...
Epoch: 31 cost time: 0.6682894229888916
Epoch: 31, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.932 Vali Acc: 0.625 Test Loss: 0.932 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 32 cost time: 0.5537967681884766
Epoch: 32, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.932 Vali Acc: 0.625 Test Loss: 0.932 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.658806562423706
Epoch: 33, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.930 Vali Acc: 0.650 Test Loss: 0.930 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649991).  Saving model ...
Epoch: 34 cost time: 0.7453734874725342
Epoch: 34, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.931 Vali Acc: 0.625 Test Loss: 0.931 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6178872585296631
Epoch: 35, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.924 Vali Acc: 0.625 Test Loss: 0.924 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6696200370788574
Epoch: 36, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.919 Vali Acc: 0.625 Test Loss: 0.919 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7318429946899414
Epoch: 37, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.910 Vali Acc: 0.650 Test Loss: 0.910 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 38 cost time: 0.6539969444274902
Epoch: 38, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.903 Vali Acc: 0.675 Test Loss: 0.903 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 39 cost time: 0.5831952095031738
Epoch: 39, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.898 Vali Acc: 0.675 Test Loss: 0.898 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 40 cost time: 0.6045384407043457
Epoch: 40, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.894 Vali Acc: 0.700 Test Loss: 0.894 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 41 cost time: 0.5842039585113525
Epoch: 41, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.891 Vali Acc: 0.700 Test Loss: 0.891 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 42 cost time: 0.6934194564819336
Epoch: 42, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.888 Vali Acc: 0.700 Test Loss: 0.888 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 43 cost time: 0.6575376987457275
Epoch: 43, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.887 Vali Acc: 0.700 Test Loss: 0.887 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 44 cost time: 0.6209988594055176
Epoch: 44, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.888 Vali Acc: 0.700 Test Loss: 0.888 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6805548667907715
Epoch: 45, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6622753143310547
Epoch: 46, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6681082248687744
Epoch: 47, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.892 Vali Acc: 0.700 Test Loss: 0.892 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6174633502960205
Epoch: 48, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.893 Vali Acc: 0.700 Test Loss: 0.893 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6479663848876953
Epoch: 49, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.895 Vali Acc: 0.700 Test Loss: 0.895 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.646125078201294
Epoch: 50, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.896 Vali Acc: 0.700 Test Loss: 0.896 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.6984004974365234
Epoch: 51, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.897 Vali Acc: 0.700 Test Loss: 0.897 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.6319983005523682
Epoch: 52, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.898 Vali Acc: 0.700 Test Loss: 0.898 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.7454690933227539
Epoch: 53, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.899 Vali Acc: 0.700 Test Loss: 0.899 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 14436
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3318397998809814
Epoch: 1, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.361 Vali Acc: 0.300 Test Loss: 1.361 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.676262617111206
Epoch: 2, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.343 Vali Acc: 0.325 Test Loss: 1.343 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.5407192707061768
Epoch: 3, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.336 Vali Acc: 0.350 Test Loss: 1.336 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.6970269680023193
Epoch: 4, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.332 Vali Acc: 0.375 Test Loss: 1.332 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.5947744846343994
Epoch: 5, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.329 Vali Acc: 0.350 Test Loss: 1.329 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6060237884521484
Epoch: 6, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.327 Vali Acc: 0.375 Test Loss: 1.327 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.6373708248138428
Epoch: 7, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.322 Vali Acc: 0.425 Test Loss: 1.322 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.7687435150146484
Epoch: 8, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.318 Vali Acc: 0.425 Test Loss: 1.318 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.5786333084106445
Epoch: 9, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.311 Vali Acc: 0.425 Test Loss: 1.311 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.5747151374816895
Epoch: 10, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.304 Vali Acc: 0.450 Test Loss: 1.304 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.6640803813934326
Epoch: 11, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.299 Vali Acc: 0.500 Test Loss: 1.299 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.595618724822998
Epoch: 12, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.6605045795440674
Epoch: 13, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.286 Vali Acc: 0.450 Test Loss: 1.286 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6862413883209229
Epoch: 14, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.278 Vali Acc: 0.450 Test Loss: 1.278 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6656203269958496
Epoch: 15, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.270 Vali Acc: 0.450 Test Loss: 1.270 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6285498142242432
Epoch: 16, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.262 Vali Acc: 0.450 Test Loss: 1.262 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6912562847137451
Epoch: 17, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.253 Vali Acc: 0.450 Test Loss: 1.253 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6690161228179932
Epoch: 18, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.243 Vali Acc: 0.475 Test Loss: 1.243 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7092769145965576
Epoch: 19, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.235 Vali Acc: 0.475 Test Loss: 1.235 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7408707141876221
Epoch: 20, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 21 cost time: 0.6478345394134521
Epoch: 21, Steps: 3 | Train Loss: 0.769 Vali Loss: 1.220 Vali Acc: 0.525 Test Loss: 1.220 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 22 cost time: 0.5506324768066406
Epoch: 22, Steps: 3 | Train Loss: 0.699 Vali Loss: 1.214 Vali Acc: 0.525 Test Loss: 1.214 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 23 cost time: 0.6379179954528809
Epoch: 23, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.206 Vali Acc: 0.525 Test Loss: 1.206 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 24 cost time: 0.7548866271972656
Epoch: 24, Steps: 3 | Train Loss: 0.709 Vali Loss: 1.198 Vali Acc: 0.525 Test Loss: 1.198 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 25 cost time: 0.5705287456512451
Epoch: 25, Steps: 3 | Train Loss: 0.688 Vali Loss: 1.189 Vali Acc: 0.525 Test Loss: 1.189 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 26 cost time: 0.6747298240661621
Epoch: 26, Steps: 3 | Train Loss: 0.624 Vali Loss: 1.180 Vali Acc: 0.525 Test Loss: 1.180 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 27 cost time: 0.6665773391723633
Epoch: 27, Steps: 3 | Train Loss: 0.619 Vali Loss: 1.171 Vali Acc: 0.550 Test Loss: 1.171 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 28 cost time: 0.5862061977386475
Epoch: 28, Steps: 3 | Train Loss: 0.590 Vali Loss: 1.163 Vali Acc: 0.550 Test Loss: 1.163 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 29 cost time: 0.7339587211608887
Epoch: 29, Steps: 3 | Train Loss: 0.571 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 30 cost time: 0.6735498905181885
Epoch: 30, Steps: 3 | Train Loss: 0.516 Vali Loss: 1.146 Vali Acc: 0.575 Test Loss: 1.146 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 31 cost time: 0.655085563659668
Epoch: 31, Steps: 3 | Train Loss: 0.510 Vali Loss: 1.138 Vali Acc: 0.600 Test Loss: 1.138 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 32 cost time: 0.6226489543914795
Epoch: 32, Steps: 3 | Train Loss: 0.429 Vali Loss: 1.131 Vali Acc: 0.600 Test Loss: 1.131 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 33 cost time: 0.5873651504516602
Epoch: 33, Steps: 3 | Train Loss: 0.483 Vali Loss: 1.125 Vali Acc: 0.600 Test Loss: 1.125 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 34 cost time: 0.572742223739624
Epoch: 34, Steps: 3 | Train Loss: 0.483 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 35 cost time: 0.6076860427856445
Epoch: 35, Steps: 3 | Train Loss: 0.421 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 36 cost time: 0.6692657470703125
Epoch: 36, Steps: 3 | Train Loss: 0.331 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 37 cost time: 0.5934362411499023
Epoch: 37, Steps: 3 | Train Loss: 0.329 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6096007823944092
Epoch: 38, Steps: 3 | Train Loss: 0.352 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 39 cost time: 0.7496283054351807
Epoch: 39, Steps: 3 | Train Loss: 0.304 Vali Loss: 1.120 Vali Acc: 0.625 Test Loss: 1.120 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7962987422943115
Epoch: 40, Steps: 3 | Train Loss: 0.320 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6491165161132812
Epoch: 41, Steps: 3 | Train Loss: 0.311 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.765160322189331
Epoch: 42, Steps: 3 | Train Loss: 0.262 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 43 cost time: 0.7497296333312988
Epoch: 43, Steps: 3 | Train Loss: 0.312 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7014901638031006
Epoch: 44, Steps: 3 | Train Loss: 0.231 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7690849304199219
Epoch: 45, Steps: 3 | Train Loss: 0.217 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7184233665466309
Epoch: 46, Steps: 3 | Train Loss: 0.228 Vali Loss: 1.115 Vali Acc: 0.625 Test Loss: 1.115 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8039724826812744
Epoch: 47, Steps: 3 | Train Loss: 0.221 Vali Loss: 1.113 Vali Acc: 0.625 Test Loss: 1.113 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6603879928588867
Epoch: 48, Steps: 3 | Train Loss: 0.184 Vali Loss: 1.111 Vali Acc: 0.625 Test Loss: 1.111 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7573451995849609
Epoch: 49, Steps: 3 | Train Loss: 0.172 Vali Loss: 1.111 Vali Acc: 0.625 Test Loss: 1.111 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7313721179962158
Epoch: 50, Steps: 3 | Train Loss: 0.177 Vali Loss: 1.111 Vali Acc: 0.625 Test Loss: 1.111 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6897609233856201
Epoch: 51, Steps: 3 | Train Loss: 0.175 Vali Loss: 1.113 Vali Acc: 0.625 Test Loss: 1.113 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6661877632141113
Epoch: 52, Steps: 3 | Train Loss: 0.159 Vali Loss: 1.113 Vali Acc: 0.625 Test Loss: 1.113 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 11444
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.139235258102417
Epoch: 1, Steps: 3 | Train Loss: 1.505 Vali Loss: 1.503 Vali Acc: 0.225 Test Loss: 1.503 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.625939130783081
Epoch: 2, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.495 Vali Acc: 0.225 Test Loss: 1.495 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224985).  Saving model ...
Epoch: 3 cost time: 0.6210711002349854
Epoch: 3, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.491 Vali Acc: 0.250 Test Loss: 1.491 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 0.710759162902832
Epoch: 4, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.488 Vali Acc: 0.225 Test Loss: 1.488 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.720970869064331
Epoch: 5, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.485 Vali Acc: 0.225 Test Loss: 1.485 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6041698455810547
Epoch: 6, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.480 Vali Acc: 0.250 Test Loss: 1.480 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 7 cost time: 0.711209774017334
Epoch: 7, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.475 Vali Acc: 0.275 Test Loss: 1.475 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 8 cost time: 0.6289582252502441
Epoch: 8, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.468 Vali Acc: 0.275 Test Loss: 1.468 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 9 cost time: 0.6458549499511719
Epoch: 9, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.460 Vali Acc: 0.275 Test Loss: 1.460 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 10 cost time: 0.6412420272827148
Epoch: 10, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.451 Vali Acc: 0.300 Test Loss: 1.451 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 11 cost time: 0.7624917030334473
Epoch: 11, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.441 Vali Acc: 0.300 Test Loss: 1.441 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 12 cost time: 0.6558051109313965
Epoch: 12, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.430 Vali Acc: 0.300 Test Loss: 1.430 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 13 cost time: 0.6551659107208252
Epoch: 13, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.419 Vali Acc: 0.300 Test Loss: 1.419 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 14 cost time: 0.6198711395263672
Epoch: 14, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.409 Vali Acc: 0.325 Test Loss: 1.409 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 15 cost time: 0.6978285312652588
Epoch: 15, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.399 Vali Acc: 0.350 Test Loss: 1.399 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 16 cost time: 0.6062519550323486
Epoch: 16, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.391 Vali Acc: 0.350 Test Loss: 1.391 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 17 cost time: 0.5282607078552246
Epoch: 17, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.380 Vali Acc: 0.350 Test Loss: 1.380 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 18 cost time: 0.6413350105285645
Epoch: 18, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.369 Vali Acc: 0.350 Test Loss: 1.369 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 19 cost time: 0.693305492401123
Epoch: 19, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.358 Vali Acc: 0.375 Test Loss: 1.358 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 20 cost time: 0.6926727294921875
Epoch: 20, Steps: 3 | Train Loss: 0.955 Vali Loss: 1.348 Vali Acc: 0.375 Test Loss: 1.348 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 21 cost time: 0.7770318984985352
Epoch: 21, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.339 Vali Acc: 0.375 Test Loss: 1.339 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 22 cost time: 0.6594879627227783
Epoch: 22, Steps: 3 | Train Loss: 0.907 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 23 cost time: 0.6909518241882324
Epoch: 23, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.319 Vali Acc: 0.400 Test Loss: 1.319 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 24 cost time: 0.6701216697692871
Epoch: 24, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.310 Vali Acc: 0.400 Test Loss: 1.310 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 25 cost time: 0.8030240535736084
Epoch: 25, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.301 Vali Acc: 0.400 Test Loss: 1.301 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 26 cost time: 0.6997876167297363
Epoch: 26, Steps: 3 | Train Loss: 0.836 Vali Loss: 1.295 Vali Acc: 0.450 Test Loss: 1.295 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 27 cost time: 0.7227880954742432
Epoch: 27, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.288 Vali Acc: 0.450 Test Loss: 1.288 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 28 cost time: 0.700005292892456
Epoch: 28, Steps: 3 | Train Loss: 0.759 Vali Loss: 1.280 Vali Acc: 0.450 Test Loss: 1.280 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 29 cost time: 0.7407095432281494
Epoch: 29, Steps: 3 | Train Loss: 0.671 Vali Loss: 1.272 Vali Acc: 0.450 Test Loss: 1.272 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 30 cost time: 0.6651110649108887
Epoch: 30, Steps: 3 | Train Loss: 0.708 Vali Loss: 1.263 Vali Acc: 0.450 Test Loss: 1.263 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 31 cost time: 0.7162489891052246
Epoch: 31, Steps: 3 | Train Loss: 0.593 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 32 cost time: 0.6801855564117432
Epoch: 32, Steps: 3 | Train Loss: 0.544 Vali Loss: 1.249 Vali Acc: 0.525 Test Loss: 1.249 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 33 cost time: 0.6467161178588867
Epoch: 33, Steps: 3 | Train Loss: 0.527 Vali Loss: 1.241 Vali Acc: 0.525 Test Loss: 1.241 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 34 cost time: 0.7168300151824951
Epoch: 34, Steps: 3 | Train Loss: 0.589 Vali Loss: 1.234 Vali Acc: 0.525 Test Loss: 1.234 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 35 cost time: 0.7821803092956543
Epoch: 35, Steps: 3 | Train Loss: 0.499 Vali Loss: 1.227 Vali Acc: 0.525 Test Loss: 1.227 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 36 cost time: 0.6898179054260254
Epoch: 36, Steps: 3 | Train Loss: 0.537 Vali Loss: 1.221 Vali Acc: 0.575 Test Loss: 1.221 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 37 cost time: 0.6599538326263428
Epoch: 37, Steps: 3 | Train Loss: 0.481 Vali Loss: 1.216 Vali Acc: 0.575 Test Loss: 1.216 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 38 cost time: 0.7330293655395508
Epoch: 38, Steps: 3 | Train Loss: 0.558 Vali Loss: 1.210 Vali Acc: 0.575 Test Loss: 1.210 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 39 cost time: 0.758965015411377
Epoch: 39, Steps: 3 | Train Loss: 0.507 Vali Loss: 1.204 Vali Acc: 0.575 Test Loss: 1.204 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 40 cost time: 0.7037191390991211
Epoch: 40, Steps: 3 | Train Loss: 0.413 Vali Loss: 1.200 Vali Acc: 0.575 Test Loss: 1.200 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 41 cost time: 0.6952018737792969
Epoch: 41, Steps: 3 | Train Loss: 0.416 Vali Loss: 1.195 Vali Acc: 0.575 Test Loss: 1.195 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 42 cost time: 0.6519191265106201
Epoch: 42, Steps: 3 | Train Loss: 0.386 Vali Loss: 1.191 Vali Acc: 0.600 Test Loss: 1.191 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 43 cost time: 0.7267622947692871
Epoch: 43, Steps: 3 | Train Loss: 0.372 Vali Loss: 1.187 Vali Acc: 0.625 Test Loss: 1.187 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 44 cost time: 0.6473615169525146
Epoch: 44, Steps: 3 | Train Loss: 0.302 Vali Loss: 1.185 Vali Acc: 0.625 Test Loss: 1.185 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 45 cost time: 0.6808414459228516
Epoch: 45, Steps: 3 | Train Loss: 0.342 Vali Loss: 1.183 Vali Acc: 0.625 Test Loss: 1.183 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 46 cost time: 0.673027753829956
Epoch: 46, Steps: 3 | Train Loss: 0.273 Vali Loss: 1.181 Vali Acc: 0.625 Test Loss: 1.181 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 47 cost time: 0.7407066822052002
Epoch: 47, Steps: 3 | Train Loss: 0.315 Vali Loss: 1.177 Vali Acc: 0.625 Test Loss: 1.177 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 48 cost time: 0.6660449504852295
Epoch: 48, Steps: 3 | Train Loss: 0.275 Vali Loss: 1.172 Vali Acc: 0.625 Test Loss: 1.172 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 49 cost time: 0.6396677494049072
Epoch: 49, Steps: 3 | Train Loss: 0.276 Vali Loss: 1.167 Vali Acc: 0.625 Test Loss: 1.167 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 50 cost time: 0.7107269763946533
Epoch: 50, Steps: 3 | Train Loss: 0.233 Vali Loss: 1.164 Vali Acc: 0.625 Test Loss: 1.164 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 51 cost time: 0.6761162281036377
Epoch: 51, Steps: 3 | Train Loss: 0.249 Vali Loss: 1.162 Vali Acc: 0.625 Test Loss: 1.162 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 52 cost time: 0.7193636894226074
Epoch: 52, Steps: 3 | Train Loss: 0.243 Vali Loss: 1.160 Vali Acc: 0.625 Test Loss: 1.160 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 53 cost time: 0.7104706764221191
Epoch: 53, Steps: 3 | Train Loss: 0.214 Vali Loss: 1.157 Vali Acc: 0.600 Test Loss: 1.157 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7704966068267822
Epoch: 54, Steps: 3 | Train Loss: 0.208 Vali Loss: 1.157 Vali Acc: 0.600 Test Loss: 1.157 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7041666507720947
Epoch: 55, Steps: 3 | Train Loss: 0.193 Vali Loss: 1.155 Vali Acc: 0.600 Test Loss: 1.155 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6136715412139893
Epoch: 56, Steps: 3 | Train Loss: 0.199 Vali Loss: 1.154 Vali Acc: 0.600 Test Loss: 1.154 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.7011518478393555
Epoch: 57, Steps: 3 | Train Loss: 0.183 Vali Loss: 1.153 Vali Acc: 0.600 Test Loss: 1.153 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.644655704498291
Epoch: 58, Steps: 3 | Train Loss: 0.178 Vali Loss: 1.153 Vali Acc: 0.600 Test Loss: 1.153 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.8042399883270264
Epoch: 59, Steps: 3 | Train Loss: 0.147 Vali Loss: 1.154 Vali Acc: 0.625 Test Loss: 1.154 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 60 cost time: 0.7518219947814941
Epoch: 60, Steps: 3 | Train Loss: 0.143 Vali Loss: 1.152 Vali Acc: 0.625 Test Loss: 1.152 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 61 cost time: 0.6685700416564941
Epoch: 61, Steps: 3 | Train Loss: 0.151 Vali Loss: 1.148 Vali Acc: 0.625 Test Loss: 1.148 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 62 cost time: 0.8676879405975342
Epoch: 62, Steps: 3 | Train Loss: 0.136 Vali Loss: 1.147 Vali Acc: 0.625 Test Loss: 1.147 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 63 cost time: 0.704643726348877
Epoch: 63, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.146 Vali Acc: 0.625 Test Loss: 1.146 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 64 cost time: 0.7304699420928955
Epoch: 64, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.146 Vali Acc: 0.625 Test Loss: 1.146 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 65 cost time: 0.6857404708862305
Epoch: 65, Steps: 3 | Train Loss: 0.126 Vali Loss: 1.145 Vali Acc: 0.625 Test Loss: 1.145 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 66 cost time: 0.6982972621917725
Epoch: 66, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.144 Vali Acc: 0.625 Test Loss: 1.144 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 67 cost time: 0.7118370532989502
Epoch: 67, Steps: 3 | Train Loss: 0.130 Vali Loss: 1.144 Vali Acc: 0.625 Test Loss: 1.144 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6734657287597656
Epoch: 68, Steps: 3 | Train Loss: 0.095 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 69 cost time: 0.6673510074615479
Epoch: 69, Steps: 3 | Train Loss: 0.106 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 70 cost time: 0.6958303451538086
Epoch: 70, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.140 Vali Acc: 0.625 Test Loss: 1.140 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 71 cost time: 0.5843274593353271
Epoch: 71, Steps: 3 | Train Loss: 0.095 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.6963450908660889
Epoch: 72, Steps: 3 | Train Loss: 0.076 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.7073886394500732
Epoch: 73, Steps: 3 | Train Loss: 0.076 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.8121585845947266
Epoch: 74, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.7448956966400146
Epoch: 75, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.7656219005584717
Epoch: 76, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.6638603210449219
Epoch: 77, Steps: 3 | Train Loss: 0.081 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.6458430290222168
Epoch: 78, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.7251088619232178
Epoch: 79, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.143 Vali Acc: 0.625 Test Loss: 1.143 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.6334874629974365
Epoch: 80, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.143 Vali Acc: 0.625 Test Loss: 1.143 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 10756
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.513706922531128
Epoch: 1, Steps: 3 | Train Loss: 1.596 Vali Loss: 1.448 Vali Acc: 0.250 Test Loss: 1.448 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.6395318508148193
Epoch: 2, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.426 Vali Acc: 0.300 Test Loss: 1.426 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.6594521999359131
Epoch: 3, Steps: 3 | Train Loss: 1.548 Vali Loss: 1.412 Vali Acc: 0.325 Test Loss: 1.412 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.6302487850189209
Epoch: 4, Steps: 3 | Train Loss: 1.587 Vali Loss: 1.399 Vali Acc: 0.325 Test Loss: 1.399 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.7167351245880127
Epoch: 5, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.386 Vali Acc: 0.325 Test Loss: 1.386 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.7024664878845215
Epoch: 6, Steps: 3 | Train Loss: 1.506 Vali Loss: 1.375 Vali Acc: 0.375 Test Loss: 1.375 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.7829697132110596
Epoch: 7, Steps: 3 | Train Loss: 1.498 Vali Loss: 1.365 Vali Acc: 0.425 Test Loss: 1.365 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 8 cost time: 0.6044697761535645
Epoch: 8, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.354 Vali Acc: 0.425 Test Loss: 1.354 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 9 cost time: 0.6589531898498535
Epoch: 9, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.344 Vali Acc: 0.400 Test Loss: 1.344 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6144330501556396
Epoch: 10, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.335 Vali Acc: 0.400 Test Loss: 1.335 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6102542877197266
Epoch: 11, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.324 Vali Acc: 0.375 Test Loss: 1.324 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6938703060150146
Epoch: 12, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.314 Vali Acc: 0.375 Test Loss: 1.314 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8259155750274658
Epoch: 13, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.303 Vali Acc: 0.375 Test Loss: 1.303 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5697653293609619
Epoch: 14, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.293 Vali Acc: 0.375 Test Loss: 1.293 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.588270902633667
Epoch: 15, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.283 Vali Acc: 0.375 Test Loss: 1.283 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5920541286468506
Epoch: 16, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.271 Vali Acc: 0.400 Test Loss: 1.271 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7467029094696045
Epoch: 17, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.72007155418396
Epoch: 18, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el2_dm16_nh4_df64_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.425
model parameter : 9684
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6094963550567627
Epoch: 1, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.613 Vali Acc: 0.275 Test Loss: 1.613 Test Acc: 0.275
Validation loss decreased (inf --> -0.274984).  Saving model ...
Epoch: 2 cost time: 0.6726241111755371
Epoch: 2, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.499 Vali Acc: 0.375 Test Loss: 1.499 Test Acc: 0.375
Validation loss decreased (-0.274984 --> -0.374985).  Saving model ...
Epoch: 3 cost time: 0.6184051036834717
Epoch: 3, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.365 Vali Acc: 0.500 Test Loss: 1.365 Test Acc: 0.500
Validation loss decreased (-0.374985 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 0.669367790222168
Epoch: 4, Steps: 3 | Train Loss: 0.832 Vali Loss: 1.272 Vali Acc: 0.450 Test Loss: 1.272 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6406826972961426
Epoch: 5, Steps: 3 | Train Loss: 0.498 Vali Loss: 1.161 Vali Acc: 0.525 Test Loss: 1.161 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.7016196250915527
Epoch: 6, Steps: 3 | Train Loss: 0.302 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.6184396743774414
Epoch: 7, Steps: 3 | Train Loss: 0.218 Vali Loss: 1.005 Vali Acc: 0.675 Test Loss: 1.005 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.681354284286499
Epoch: 8, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 0.6748847961425781
Epoch: 9, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.980 Vali Acc: 0.750 Test Loss: 0.980 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6912376880645752
Epoch: 10, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.983 Vali Acc: 0.750 Test Loss: 0.983 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5966818332672119
Epoch: 11, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.012 Vali Acc: 0.750 Test Loss: 1.012 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7899692058563232
Epoch: 12, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.053 Vali Acc: 0.750 Test Loss: 1.053 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6514105796813965
Epoch: 13, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.088 Vali Acc: 0.750 Test Loss: 1.088 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6122629642486572
Epoch: 14, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.121 Vali Acc: 0.725 Test Loss: 1.121 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6561834812164307
Epoch: 15, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.150 Vali Acc: 0.750 Test Loss: 1.150 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6989402770996094
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.174 Vali Acc: 0.750 Test Loss: 1.174 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.67667555809021
Epoch: 17, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.191 Vali Acc: 0.750 Test Loss: 1.191 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7595322132110596
Epoch: 18, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.750 Test Loss: 1.202 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 286724
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4014618396759033
Epoch: 1, Steps: 3 | Train Loss: 1.607 Vali Loss: 1.471 Vali Acc: 0.225 Test Loss: 1.471 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.8847441673278809
Epoch: 2, Steps: 3 | Train Loss: 1.533 Vali Loss: 1.391 Vali Acc: 0.325 Test Loss: 1.391 Test Acc: 0.325
Validation loss decreased (-0.224985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.6286866664886475
Epoch: 3, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.248 Vali Acc: 0.475 Test Loss: 1.248 Test Acc: 0.475
Validation loss decreased (-0.324986 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.6328229904174805
Epoch: 4, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.147 Vali Acc: 0.525 Test Loss: 1.147 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524989).  Saving model ...
Epoch: 5 cost time: 0.6656386852264404
Epoch: 5, Steps: 3 | Train Loss: 0.772 Vali Loss: 1.066 Vali Acc: 0.650 Test Loss: 1.066 Test Acc: 0.650
Validation loss decreased (-0.524989 --> -0.649989).  Saving model ...
Epoch: 6 cost time: 0.6870622634887695
Epoch: 6, Steps: 3 | Train Loss: 0.598 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.670069694519043
Epoch: 7, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.6389634609222412
Epoch: 8, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.957 Vali Acc: 0.650 Test Loss: 0.957 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 0.6565568447113037
Epoch: 9, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.942 Vali Acc: 0.625 Test Loss: 0.942 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6874902248382568
Epoch: 10, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.921 Vali Acc: 0.700 Test Loss: 0.921 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.5351569652557373
Epoch: 11, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.902 Vali Acc: 0.650 Test Loss: 0.902 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.736060619354248
Epoch: 12, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.906 Vali Acc: 0.675 Test Loss: 0.906 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.652456521987915
Epoch: 13, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.917 Vali Acc: 0.675 Test Loss: 0.917 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5789659023284912
Epoch: 14, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.924 Vali Acc: 0.675 Test Loss: 0.924 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6543927192687988
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.939 Vali Acc: 0.700 Test Loss: 0.939 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4970870018005371
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.960 Vali Acc: 0.700 Test Loss: 0.960 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.595440149307251
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.975 Vali Acc: 0.725 Test Loss: 0.975 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724990).  Saving model ...
Epoch: 18 cost time: 0.7622756958007812
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.986 Vali Acc: 0.725 Test Loss: 0.986 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5924813747406006
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.995 Vali Acc: 0.725 Test Loss: 0.995 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5526814460754395
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.725 Test Loss: 1.001 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6681220531463623
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.004 Vali Acc: 0.750 Test Loss: 1.004 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 22 cost time: 0.6508820056915283
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.677311897277832
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.750 Test Loss: 1.006 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.691063642501831
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5831491947174072
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6793208122253418
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.750 Test Loss: 1.007 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6353433132171631
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.008 Vali Acc: 0.750 Test Loss: 1.008 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6503777503967285
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.010 Vali Acc: 0.750 Test Loss: 1.010 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6008710861206055
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.750 Test Loss: 1.011 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7647957801818848
Epoch: 30, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.750 Test Loss: 1.012 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6641466617584229
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.725 Test Loss: 1.014 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 234756
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4923861026763916
Epoch: 1, Steps: 3 | Train Loss: 1.534 Vali Loss: 1.432 Vali Acc: 0.300 Test Loss: 1.432 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6432020664215088
Epoch: 2, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.398 Vali Acc: 0.350 Test Loss: 1.398 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.6985657215118408
Epoch: 3, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.334 Vali Acc: 0.475 Test Loss: 1.334 Test Acc: 0.475
Validation loss decreased (-0.349986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.6427903175354004
Epoch: 4, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.266 Vali Acc: 0.525 Test Loss: 1.266 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.6968133449554443
Epoch: 5, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.192 Vali Acc: 0.575 Test Loss: 1.192 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 0.6536068916320801
Epoch: 6, Steps: 3 | Train Loss: 0.618 Vali Loss: 1.124 Vali Acc: 0.575 Test Loss: 1.124 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.7305450439453125
Epoch: 7, Steps: 3 | Train Loss: 0.532 Vali Loss: 1.084 Vali Acc: 0.625 Test Loss: 1.084 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 0.6973600387573242
Epoch: 8, Steps: 3 | Train Loss: 0.358 Vali Loss: 1.044 Vali Acc: 0.675 Test Loss: 1.044 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 0.7141191959381104
Epoch: 9, Steps: 3 | Train Loss: 0.270 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 0.6276109218597412
Epoch: 10, Steps: 3 | Train Loss: 0.163 Vali Loss: 1.010 Vali Acc: 0.675 Test Loss: 1.010 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6051108837127686
Epoch: 11, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.053 Vali Acc: 0.625 Test Loss: 1.053 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6707174777984619
Epoch: 12, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.074 Vali Acc: 0.625 Test Loss: 1.074 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.635002613067627
Epoch: 13, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.063 Vali Acc: 0.675 Test Loss: 1.063 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6831858158111572
Epoch: 14, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.062 Vali Acc: 0.675 Test Loss: 1.062 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7334022521972656
Epoch: 15, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.072 Vali Acc: 0.675 Test Loss: 1.072 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6819791793823242
Epoch: 16, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.081 Vali Acc: 0.700 Test Loss: 1.081 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6498723030090332
Epoch: 17, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.093 Vali Acc: 0.700 Test Loss: 1.093 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6173074245452881
Epoch: 18, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.104 Vali Acc: 0.700 Test Loss: 1.104 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6871883869171143
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.118 Vali Acc: 0.700 Test Loss: 1.118 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 210564
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.051389455795288
Epoch: 1, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.345 Vali Acc: 0.375 Test Loss: 1.345 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.6473696231842041
Epoch: 2, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.321 Vali Acc: 0.375 Test Loss: 1.321 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.6373286247253418
Epoch: 3, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.290 Vali Acc: 0.325 Test Loss: 1.290 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.632720947265625
Epoch: 4, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.267 Vali Acc: 0.475 Test Loss: 1.267 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.6854331493377686
Epoch: 5, Steps: 3 | Train Loss: 0.811 Vali Loss: 1.239 Vali Acc: 0.525 Test Loss: 1.239 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.6114366054534912
Epoch: 6, Steps: 3 | Train Loss: 0.640 Vali Loss: 1.193 Vali Acc: 0.550 Test Loss: 1.193 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.6679408550262451
Epoch: 7, Steps: 3 | Train Loss: 0.571 Vali Loss: 1.112 Vali Acc: 0.575 Test Loss: 1.112 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.7488653659820557
Epoch: 8, Steps: 3 | Train Loss: 0.411 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.7545621395111084
Epoch: 9, Steps: 3 | Train Loss: 0.280 Vali Loss: 1.009 Vali Acc: 0.675 Test Loss: 1.009 Test Acc: 0.675
Validation loss decreased (-0.599990 --> -0.674990).  Saving model ...
Epoch: 10 cost time: 0.7173700332641602
Epoch: 10, Steps: 3 | Train Loss: 0.194 Vali Loss: 1.005 Vali Acc: 0.650 Test Loss: 1.005 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6011946201324463
Epoch: 11, Steps: 3 | Train Loss: 0.145 Vali Loss: 1.030 Vali Acc: 0.675 Test Loss: 1.030 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7235682010650635
Epoch: 12, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.072 Vali Acc: 0.650 Test Loss: 1.072 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6867387294769287
Epoch: 13, Steps: 3 | Train Loss: 0.060 Vali Loss: 1.103 Vali Acc: 0.650 Test Loss: 1.103 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6830434799194336
Epoch: 14, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.113 Vali Acc: 0.700 Test Loss: 1.113 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 0.6532318592071533
Epoch: 15, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.110 Vali Acc: 0.700 Test Loss: 1.110 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.7272422313690186
Epoch: 16, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 17 cost time: 0.7194688320159912
Epoch: 17, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.114 Vali Acc: 0.700 Test Loss: 1.114 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6997084617614746
Epoch: 18, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.120 Vali Acc: 0.700 Test Loss: 1.120 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6924057006835938
Epoch: 19, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.131 Vali Acc: 0.700 Test Loss: 1.131 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8376460075378418
Epoch: 20, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.146 Vali Acc: 0.700 Test Loss: 1.146 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.58272385597229
Epoch: 21, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.163 Vali Acc: 0.700 Test Loss: 1.163 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6578645706176758
Epoch: 22, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.179 Vali Acc: 0.700 Test Loss: 1.179 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7126359939575195
Epoch: 23, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.194 Vali Acc: 0.700 Test Loss: 1.194 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7131211757659912
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.205 Vali Acc: 0.700 Test Loss: 1.205 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7090320587158203
Epoch: 25, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.214 Vali Acc: 0.700 Test Loss: 1.214 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7243738174438477
Epoch: 26, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.222 Vali Acc: 0.700 Test Loss: 1.222 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 195460
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3336212635040283
Epoch: 1, Steps: 3 | Train Loss: 1.585 Vali Loss: 1.408 Vali Acc: 0.175 Test Loss: 1.408 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.6573073863983154
Epoch: 2, Steps: 3 | Train Loss: 1.522 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.6169438362121582
Epoch: 3, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.345 Vali Acc: 0.300 Test Loss: 1.345 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.6163084506988525
Epoch: 4, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.304 Vali Acc: 0.425 Test Loss: 1.304 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.6184861660003662
Epoch: 5, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.271 Vali Acc: 0.525 Test Loss: 1.271 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.8307294845581055
Epoch: 6, Steps: 3 | Train Loss: 1.019 Vali Loss: 1.242 Vali Acc: 0.550 Test Loss: 1.242 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.5467808246612549
Epoch: 7, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.215 Vali Acc: 0.575 Test Loss: 1.215 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.5124711990356445
Epoch: 8, Steps: 3 | Train Loss: 0.619 Vali Loss: 1.189 Vali Acc: 0.600 Test Loss: 1.189 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.7830233573913574
Epoch: 9, Steps: 3 | Train Loss: 0.559 Vali Loss: 1.162 Vali Acc: 0.575 Test Loss: 1.162 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6858916282653809
Epoch: 10, Steps: 3 | Train Loss: 0.421 Vali Loss: 1.136 Vali Acc: 0.600 Test Loss: 1.136 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.772580623626709
Epoch: 11, Steps: 3 | Train Loss: 0.383 Vali Loss: 1.120 Vali Acc: 0.600 Test Loss: 1.120 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.618333101272583
Epoch: 12, Steps: 3 | Train Loss: 0.262 Vali Loss: 1.107 Vali Acc: 0.625 Test Loss: 1.107 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.5192298889160156
Epoch: 13, Steps: 3 | Train Loss: 0.189 Vali Loss: 1.104 Vali Acc: 0.625 Test Loss: 1.104 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.5808727741241455
Epoch: 14, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.6320462226867676
Epoch: 15, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6938333511352539
Epoch: 16, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5578334331512451
Epoch: 17, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.169 Vali Acc: 0.650 Test Loss: 1.169 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649988).  Saving model ...
Epoch: 18 cost time: 0.706488847732544
Epoch: 18, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.185 Vali Acc: 0.675 Test Loss: 1.185 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 19 cost time: 0.6530752182006836
Epoch: 19, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.201 Vali Acc: 0.675 Test Loss: 1.201 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5581986904144287
Epoch: 20, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.221 Vali Acc: 0.675 Test Loss: 1.221 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6373224258422852
Epoch: 21, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.241 Vali Acc: 0.675 Test Loss: 1.241 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6641840934753418
Epoch: 22, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.258 Vali Acc: 0.675 Test Loss: 1.258 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6781585216522217
Epoch: 23, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.268 Vali Acc: 0.675 Test Loss: 1.268 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5833213329315186
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.279 Vali Acc: 0.675 Test Loss: 1.279 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6916048526763916
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.288 Vali Acc: 0.675 Test Loss: 1.288 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6068692207336426
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.293 Vali Acc: 0.675 Test Loss: 1.293 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6273753643035889
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.299 Vali Acc: 0.675 Test Loss: 1.299 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7036385536193848
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.302 Vali Acc: 0.700 Test Loss: 1.302 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699987).  Saving model ...
Epoch: 29 cost time: 0.7029604911804199
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.307 Vali Acc: 0.700 Test Loss: 1.307 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5552387237548828
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.312 Vali Acc: 0.700 Test Loss: 1.312 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.657843828201294
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.316 Vali Acc: 0.700 Test Loss: 1.316 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6148006916046143
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.320 Vali Acc: 0.700 Test Loss: 1.320 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6812849044799805
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.327 Vali Acc: 0.700 Test Loss: 1.327 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.71268630027771
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.332 Vali Acc: 0.700 Test Loss: 1.332 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7641160488128662
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.337 Vali Acc: 0.700 Test Loss: 1.337 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6566557884216309
Epoch: 36, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.344 Vali Acc: 0.700 Test Loss: 1.344 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6071679592132568
Epoch: 37, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.352 Vali Acc: 0.700 Test Loss: 1.352 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7897806167602539
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.360 Vali Acc: 0.700 Test Loss: 1.360 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 171524
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7714853286743164
Epoch: 1, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.466 Vali Acc: 0.200 Test Loss: 1.466 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.6264519691467285
Epoch: 2, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.448 Vali Acc: 0.200 Test Loss: 1.448 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.7196428775787354
Epoch: 3, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.425 Vali Acc: 0.325 Test Loss: 1.425 Test Acc: 0.325
Validation loss decreased (-0.199986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.6089909076690674
Epoch: 4, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.394 Vali Acc: 0.375 Test Loss: 1.394 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.6820857524871826
Epoch: 5, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.354 Vali Acc: 0.500 Test Loss: 1.354 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 0.5486669540405273
Epoch: 6, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.313 Vali Acc: 0.525 Test Loss: 1.313 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.6531693935394287
Epoch: 7, Steps: 3 | Train Loss: 0.769 Vali Loss: 1.273 Vali Acc: 0.550 Test Loss: 1.273 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 0.6381645202636719
Epoch: 8, Steps: 3 | Train Loss: 0.750 Vali Loss: 1.245 Vali Acc: 0.575 Test Loss: 1.245 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.6355292797088623
Epoch: 9, Steps: 3 | Train Loss: 0.598 Vali Loss: 1.223 Vali Acc: 0.575 Test Loss: 1.223 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.6244091987609863
Epoch: 10, Steps: 3 | Train Loss: 0.511 Vali Loss: 1.204 Vali Acc: 0.600 Test Loss: 1.204 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 0.6400952339172363
Epoch: 11, Steps: 3 | Train Loss: 0.520 Vali Loss: 1.193 Vali Acc: 0.625 Test Loss: 1.193 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 12 cost time: 0.6079814434051514
Epoch: 12, Steps: 3 | Train Loss: 0.344 Vali Loss: 1.179 Vali Acc: 0.625 Test Loss: 1.179 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 13 cost time: 0.6326742172241211
Epoch: 13, Steps: 3 | Train Loss: 0.245 Vali Loss: 1.177 Vali Acc: 0.625 Test Loss: 1.177 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 14 cost time: 0.5898187160491943
Epoch: 14, Steps: 3 | Train Loss: 0.224 Vali Loss: 1.161 Vali Acc: 0.650 Test Loss: 1.161 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 15 cost time: 0.7895176410675049
Epoch: 15, Steps: 3 | Train Loss: 0.213 Vali Loss: 1.166 Vali Acc: 0.650 Test Loss: 1.166 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6117675304412842
Epoch: 16, Steps: 3 | Train Loss: 0.154 Vali Loss: 1.172 Vali Acc: 0.650 Test Loss: 1.172 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7032907009124756
Epoch: 17, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.184 Vali Acc: 0.675 Test Loss: 1.184 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 18 cost time: 0.6371133327484131
Epoch: 18, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.203 Vali Acc: 0.675 Test Loss: 1.203 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6511421203613281
Epoch: 19, Steps: 3 | Train Loss: 0.057 Vali Loss: 1.225 Vali Acc: 0.700 Test Loss: 1.225 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699988).  Saving model ...
Epoch: 20 cost time: 0.5969173908233643
Epoch: 20, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.251 Vali Acc: 0.700 Test Loss: 1.251 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6967756748199463
Epoch: 21, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.269 Vali Acc: 0.700 Test Loss: 1.269 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6511168479919434
Epoch: 22, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.291 Vali Acc: 0.700 Test Loss: 1.291 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7730545997619629
Epoch: 23, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.306 Vali Acc: 0.700 Test Loss: 1.306 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7717208862304688
Epoch: 24, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.316 Vali Acc: 0.700 Test Loss: 1.316 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7130885124206543
Epoch: 25, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.327 Vali Acc: 0.700 Test Loss: 1.327 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.642909049987793
Epoch: 26, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.335 Vali Acc: 0.700 Test Loss: 1.335 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7788403034210205
Epoch: 27, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.340 Vali Acc: 0.700 Test Loss: 1.340 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.657383918762207
Epoch: 28, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.344 Vali Acc: 0.700 Test Loss: 1.344 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7935795783996582
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.347 Vali Acc: 0.700 Test Loss: 1.347 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 166020
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.644526481628418
Epoch: 1, Steps: 3 | Train Loss: 1.576 Vali Loss: 1.627 Vali Acc: 0.300 Test Loss: 1.627 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.7026576995849609
Epoch: 2, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.583 Vali Acc: 0.250 Test Loss: 1.583 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6432304382324219
Epoch: 3, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.538 Vali Acc: 0.225 Test Loss: 1.538 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.68031907081604
Epoch: 4, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.487 Vali Acc: 0.225 Test Loss: 1.487 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.78271484375
Epoch: 5, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.442 Vali Acc: 0.375 Test Loss: 1.442 Test Acc: 0.375
Validation loss decreased (-0.299984 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.6313743591308594
Epoch: 6, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.401 Vali Acc: 0.450 Test Loss: 1.401 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449986).  Saving model ...
Epoch: 7 cost time: 0.6387777328491211
Epoch: 7, Steps: 3 | Train Loss: 0.919 Vali Loss: 1.364 Vali Acc: 0.525 Test Loss: 1.364 Test Acc: 0.525
Validation loss decreased (-0.449986 --> -0.524986).  Saving model ...
Epoch: 8 cost time: 0.5886936187744141
Epoch: 8, Steps: 3 | Train Loss: 0.763 Vali Loss: 1.336 Vali Acc: 0.525 Test Loss: 1.336 Test Acc: 0.525
Validation loss decreased (-0.524986 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 0.5930240154266357
Epoch: 9, Steps: 3 | Train Loss: 0.671 Vali Loss: 1.305 Vali Acc: 0.525 Test Loss: 1.305 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 0.6469807624816895
Epoch: 10, Steps: 3 | Train Loss: 0.721 Vali Loss: 1.279 Vali Acc: 0.550 Test Loss: 1.279 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 11 cost time: 0.6475687026977539
Epoch: 11, Steps: 3 | Train Loss: 0.522 Vali Loss: 1.260 Vali Acc: 0.550 Test Loss: 1.260 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 12 cost time: 0.6040160655975342
Epoch: 12, Steps: 3 | Train Loss: 0.409 Vali Loss: 1.246 Vali Acc: 0.600 Test Loss: 1.246 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.6951286792755127
Epoch: 13, Steps: 3 | Train Loss: 0.412 Vali Loss: 1.234 Vali Acc: 0.650 Test Loss: 1.234 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 0.5781543254852295
Epoch: 14, Steps: 3 | Train Loss: 0.339 Vali Loss: 1.227 Vali Acc: 0.650 Test Loss: 1.227 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 15 cost time: 0.6989176273345947
Epoch: 15, Steps: 3 | Train Loss: 0.313 Vali Loss: 1.225 Vali Acc: 0.625 Test Loss: 1.225 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6379795074462891
Epoch: 16, Steps: 3 | Train Loss: 0.199 Vali Loss: 1.221 Vali Acc: 0.625 Test Loss: 1.221 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7641782760620117
Epoch: 17, Steps: 3 | Train Loss: 0.166 Vali Loss: 1.219 Vali Acc: 0.625 Test Loss: 1.219 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5782749652862549
Epoch: 18, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.224 Vali Acc: 0.625 Test Loss: 1.224 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6760222911834717
Epoch: 19, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.228 Vali Acc: 0.625 Test Loss: 1.228 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.680708646774292
Epoch: 20, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.237 Vali Acc: 0.575 Test Loss: 1.237 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6444237232208252
Epoch: 21, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.249 Vali Acc: 0.575 Test Loss: 1.249 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6825668811798096
Epoch: 22, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.266 Vali Acc: 0.600 Test Loss: 1.266 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7087266445159912
Epoch: 23, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.280 Vali Acc: 0.600 Test Loss: 1.280 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6286225318908691
Epoch: 24, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.292 Vali Acc: 0.600 Test Loss: 1.292 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df256_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 157444
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0424647331237793
Epoch: 1, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.435 Vali Acc: 0.250 Test Loss: 1.435 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.6185615062713623
Epoch: 2, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.386 Vali Acc: 0.300 Test Loss: 1.386 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.6566684246063232
Epoch: 3, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.304 Vali Acc: 0.425 Test Loss: 1.304 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.593543529510498
Epoch: 4, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.134 Vali Acc: 0.525 Test Loss: 1.134 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524989).  Saving model ...
Epoch: 5 cost time: 0.8101704120635986
Epoch: 5, Steps: 3 | Train Loss: 0.539 Vali Loss: 1.043 Vali Acc: 0.525 Test Loss: 1.043 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524990).  Saving model ...
Epoch: 6 cost time: 0.6266655921936035
Epoch: 6, Steps: 3 | Train Loss: 0.420 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
Validation loss decreased (-0.524990 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.6634721755981445
Epoch: 7, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.895 Vali Acc: 0.725 Test Loss: 0.895 Test Acc: 0.725
Validation loss decreased (-0.599990 --> -0.724991).  Saving model ...
Epoch: 8 cost time: 0.6721842288970947
Epoch: 8, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.6357576847076416
Epoch: 9, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.871 Vali Acc: 0.725 Test Loss: 0.871 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6886708736419678
Epoch: 10, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.934 Vali Acc: 0.725 Test Loss: 0.934 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.672926664352417
Epoch: 11, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.927 Vali Acc: 0.725 Test Loss: 0.927 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6621866226196289
Epoch: 12, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.925 Vali Acc: 0.775 Test Loss: 0.925 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7761778831481934
Epoch: 13, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.937 Vali Acc: 0.750 Test Loss: 0.937 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7591772079467773
Epoch: 14, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.957 Vali Acc: 0.725 Test Loss: 0.957 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6872925758361816
Epoch: 15, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.977 Vali Acc: 0.725 Test Loss: 0.977 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6582345962524414
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.725 Test Loss: 0.994 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5882914066314697
Epoch: 17, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.725 Test Loss: 1.005 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.891643762588501
Epoch: 18, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.725 Test Loss: 1.011 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 253828
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2620038986206055
Epoch: 1, Steps: 3 | Train Loss: 1.711 Vali Loss: 1.510 Vali Acc: 0.200 Test Loss: 1.510 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.7025232315063477
Epoch: 2, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.446 Vali Acc: 0.200 Test Loss: 1.446 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.6557142734527588
Epoch: 3, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.346 Vali Acc: 0.275 Test Loss: 1.346 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.6014103889465332
Epoch: 4, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.244 Vali Acc: 0.400 Test Loss: 1.244 Test Acc: 0.400
Validation loss decreased (-0.274987 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.6208145618438721
Epoch: 5, Steps: 3 | Train Loss: 0.728 Vali Loss: 1.140 Vali Acc: 0.550 Test Loss: 1.140 Test Acc: 0.550
Validation loss decreased (-0.399988 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.551680326461792
Epoch: 6, Steps: 3 | Train Loss: 0.581 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.6616442203521729
Epoch: 7, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.989 Vali Acc: 0.650 Test Loss: 0.989 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.5635106563568115
Epoch: 8, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.946 Vali Acc: 0.675 Test Loss: 0.946 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 9 cost time: 0.6301782131195068
Epoch: 9, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.916 Vali Acc: 0.650 Test Loss: 0.916 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7025282382965088
Epoch: 10, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.904 Vali Acc: 0.700 Test Loss: 0.904 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.5904884338378906
Epoch: 11, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.897 Vali Acc: 0.700 Test Loss: 0.897 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 0.5921268463134766
Epoch: 12, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.893 Vali Acc: 0.725 Test Loss: 0.893 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.6929433345794678
Epoch: 13, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.906 Vali Acc: 0.700 Test Loss: 0.906 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6910727024078369
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.922 Vali Acc: 0.700 Test Loss: 0.922 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8220291137695312
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.931 Vali Acc: 0.700 Test Loss: 0.931 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.699061393737793
Epoch: 16, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.941 Vali Acc: 0.725 Test Loss: 0.941 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6185877323150635
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.952 Vali Acc: 0.725 Test Loss: 0.952 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6569828987121582
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.961 Vali Acc: 0.750 Test Loss: 0.961 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 0.5568664073944092
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6475019454956055
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.975 Vali Acc: 0.750 Test Loss: 0.975 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6703660488128662
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.982 Vali Acc: 0.725 Test Loss: 0.982 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7399492263793945
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.987 Vali Acc: 0.725 Test Loss: 0.987 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7493538856506348
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.993 Vali Acc: 0.750 Test Loss: 0.993 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6993048191070557
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.750 Test Loss: 0.997 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6857919692993164
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.750 Test Loss: 1.001 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7330231666564941
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7022607326507568
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.750 Test Loss: 1.007 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7705748081207275
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.010 Vali Acc: 0.750 Test Loss: 1.010 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 201860
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.352306365966797
Epoch: 1, Steps: 3 | Train Loss: 1.530 Vali Loss: 1.391 Vali Acc: 0.300 Test Loss: 1.391 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6003520488739014
Epoch: 2, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.359 Vali Acc: 0.300 Test Loss: 1.359 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.6589322090148926
Epoch: 3, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.307 Vali Acc: 0.375 Test Loss: 1.307 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.6561775207519531
Epoch: 4, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.243 Vali Acc: 0.425 Test Loss: 1.243 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 5 cost time: 0.6582841873168945
Epoch: 5, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.147 Vali Acc: 0.450 Test Loss: 1.147 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449989).  Saving model ...
Epoch: 6 cost time: 0.6707277297973633
Epoch: 6, Steps: 3 | Train Loss: 0.620 Vali Loss: 1.058 Vali Acc: 0.525 Test Loss: 1.058 Test Acc: 0.525
Validation loss decreased (-0.449989 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 0.6074435710906982
Epoch: 7, Steps: 3 | Train Loss: 0.594 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.6514921188354492
Epoch: 8, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.987 Vali Acc: 0.600 Test Loss: 0.987 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.5735692977905273
Epoch: 9, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.978 Vali Acc: 0.625 Test Loss: 0.978 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.6535747051239014
Epoch: 10, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.975 Vali Acc: 0.650 Test Loss: 0.975 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.6663200855255127
Epoch: 11, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.979 Vali Acc: 0.650 Test Loss: 0.979 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.570054292678833
Epoch: 12, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.971 Vali Acc: 0.675 Test Loss: 0.971 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 0.5405163764953613
Epoch: 13, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.957 Vali Acc: 0.650 Test Loss: 0.957 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7031009197235107
Epoch: 14, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.965 Vali Acc: 0.675 Test Loss: 0.965 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 15 cost time: 0.6014399528503418
Epoch: 15, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.976 Vali Acc: 0.675 Test Loss: 0.976 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5310306549072266
Epoch: 16, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.996 Vali Acc: 0.675 Test Loss: 0.996 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.653545618057251
Epoch: 17, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.019 Vali Acc: 0.650 Test Loss: 1.019 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5845203399658203
Epoch: 18, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.045 Vali Acc: 0.650 Test Loss: 1.045 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7622199058532715
Epoch: 19, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.072 Vali Acc: 0.650 Test Loss: 1.072 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6770238876342773
Epoch: 20, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.093 Vali Acc: 0.650 Test Loss: 1.093 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6670892238616943
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.107 Vali Acc: 0.650 Test Loss: 1.107 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7028300762176514
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.120 Vali Acc: 0.650 Test Loss: 1.120 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6079075336456299
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.129 Vali Acc: 0.650 Test Loss: 1.129 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.645066499710083
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.137 Vali Acc: 0.650 Test Loss: 1.137 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 177668
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.267550468444824
Epoch: 1, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.359 Vali Acc: 0.350 Test Loss: 1.359 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.6863079071044922
Epoch: 2, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.306 Vali Acc: 0.375 Test Loss: 1.306 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.6393816471099854
Epoch: 3, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.239 Vali Acc: 0.450 Test Loss: 1.239 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449988).  Saving model ...
Epoch: 4 cost time: 0.7518529891967773
Epoch: 4, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.161 Vali Acc: 0.550 Test Loss: 1.161 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.6545217037200928
Epoch: 5, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.090 Vali Acc: 0.625 Test Loss: 1.090 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 0.7880074977874756
Epoch: 6, Steps: 3 | Train Loss: 0.690 Vali Loss: 1.040 Vali Acc: 0.675 Test Loss: 1.040 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 7 cost time: 0.7466404438018799
Epoch: 7, Steps: 3 | Train Loss: 0.584 Vali Loss: 0.995 Vali Acc: 0.725 Test Loss: 0.995 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 0.7336363792419434
Epoch: 8, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.949 Vali Acc: 0.775 Test Loss: 0.949 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.711876630783081
Epoch: 9, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 10 cost time: 0.7641980648040771
Epoch: 10, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.899 Vali Acc: 0.775 Test Loss: 0.899 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 0.6846160888671875
Epoch: 11, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.883 Vali Acc: 0.775 Test Loss: 0.883 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 0.7703511714935303
Epoch: 12, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.872 Vali Acc: 0.775 Test Loss: 0.872 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 13 cost time: 0.7411618232727051
Epoch: 13, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.882 Vali Acc: 0.750 Test Loss: 0.882 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6278319358825684
Epoch: 14, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.910 Vali Acc: 0.750 Test Loss: 0.910 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.77286696434021
Epoch: 15, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.954 Vali Acc: 0.725 Test Loss: 0.954 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7141265869140625
Epoch: 16, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.995 Vali Acc: 0.725 Test Loss: 0.995 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7455251216888428
Epoch: 17, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.032 Vali Acc: 0.700 Test Loss: 1.032 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7115664482116699
Epoch: 18, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.056 Vali Acc: 0.675 Test Loss: 1.056 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7270081043243408
Epoch: 19, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.068 Vali Acc: 0.675 Test Loss: 1.068 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6558272838592529
Epoch: 20, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.073 Vali Acc: 0.700 Test Loss: 1.073 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7285854816436768
Epoch: 21, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.076 Vali Acc: 0.700 Test Loss: 1.076 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7694578170776367
Epoch: 22, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.075 Vali Acc: 0.700 Test Loss: 1.075 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 162564
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.408080816268921
Epoch: 1, Steps: 3 | Train Loss: 1.673 Vali Loss: 1.543 Vali Acc: 0.175 Test Loss: 1.543 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.7059736251831055
Epoch: 2, Steps: 3 | Train Loss: 1.622 Vali Loss: 1.526 Vali Acc: 0.175 Test Loss: 1.526 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 3 cost time: 0.6486203670501709
Epoch: 3, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.493 Vali Acc: 0.175 Test Loss: 1.493 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 4 cost time: 0.6953980922698975
Epoch: 4, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.446 Vali Acc: 0.175 Test Loss: 1.446 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174986).  Saving model ...
Epoch: 5 cost time: 0.6573278903961182
Epoch: 5, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.398 Vali Acc: 0.275 Test Loss: 1.398 Test Acc: 0.275
Validation loss decreased (-0.174986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 0.7197058200836182
Epoch: 6, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.356 Vali Acc: 0.425 Test Loss: 1.356 Test Acc: 0.425
Validation loss decreased (-0.274986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 0.6804220676422119
Epoch: 7, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.322 Vali Acc: 0.425 Test Loss: 1.322 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.6746165752410889
Epoch: 8, Steps: 3 | Train Loss: 0.742 Vali Loss: 1.292 Vali Acc: 0.450 Test Loss: 1.292 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.7047152519226074
Epoch: 9, Steps: 3 | Train Loss: 0.698 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.6718192100524902
Epoch: 10, Steps: 3 | Train Loss: 0.537 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.7013654708862305
Epoch: 11, Steps: 3 | Train Loss: 0.434 Vali Loss: 1.232 Vali Acc: 0.550 Test Loss: 1.232 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.6542482376098633
Epoch: 12, Steps: 3 | Train Loss: 0.382 Vali Loss: 1.218 Vali Acc: 0.550 Test Loss: 1.218 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 0.6299557685852051
Epoch: 13, Steps: 3 | Train Loss: 0.237 Vali Loss: 1.202 Vali Acc: 0.575 Test Loss: 1.202 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 0.7427420616149902
Epoch: 14, Steps: 3 | Train Loss: 0.203 Vali Loss: 1.199 Vali Acc: 0.625 Test Loss: 1.199 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 15 cost time: 0.6565299034118652
Epoch: 15, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.197 Vali Acc: 0.650 Test Loss: 1.197 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 16 cost time: 0.6638667583465576
Epoch: 16, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.215 Vali Acc: 0.650 Test Loss: 1.215 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7188806533813477
Epoch: 17, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.245 Vali Acc: 0.650 Test Loss: 1.245 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7525386810302734
Epoch: 18, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.279 Vali Acc: 0.675 Test Loss: 1.279 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674987).  Saving model ...
Epoch: 19 cost time: 0.8431951999664307
Epoch: 19, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.315 Vali Acc: 0.675 Test Loss: 1.315 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7441091537475586
Epoch: 20, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.348 Vali Acc: 0.650 Test Loss: 1.348 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7082300186157227
Epoch: 21, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.368 Vali Acc: 0.650 Test Loss: 1.368 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7515387535095215
Epoch: 22, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.379 Vali Acc: 0.675 Test Loss: 1.379 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7568786144256592
Epoch: 23, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.389 Vali Acc: 0.675 Test Loss: 1.389 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7576014995574951
Epoch: 24, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.393 Vali Acc: 0.675 Test Loss: 1.393 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7521877288818359
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.397 Vali Acc: 0.675 Test Loss: 1.397 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6766178607940674
Epoch: 26, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.401 Vali Acc: 0.675 Test Loss: 1.401 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7325937747955322
Epoch: 27, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.402 Vali Acc: 0.675 Test Loss: 1.402 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7223131656646729
Epoch: 28, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.403 Vali Acc: 0.675 Test Loss: 1.403 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 138628
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5938100814819336
Epoch: 1, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.300 Vali Acc: 0.350 Test Loss: 1.300 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.7451033592224121
Epoch: 2, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.283 Vali Acc: 0.375 Test Loss: 1.283 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.5353677272796631
Epoch: 3, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.6347641944885254
Epoch: 4, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.236 Vali Acc: 0.450 Test Loss: 1.236 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 5 cost time: 0.6424875259399414
Epoch: 5, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.204 Vali Acc: 0.525 Test Loss: 1.204 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.6969764232635498
Epoch: 6, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.172 Vali Acc: 0.550 Test Loss: 1.172 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.6226150989532471
Epoch: 7, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.144 Vali Acc: 0.575 Test Loss: 1.144 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.6280534267425537
Epoch: 8, Steps: 3 | Train Loss: 0.694 Vali Loss: 1.115 Vali Acc: 0.575 Test Loss: 1.115 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.6126551628112793
Epoch: 9, Steps: 3 | Train Loss: 0.610 Vali Loss: 1.087 Vali Acc: 0.650 Test Loss: 1.087 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.641110897064209
Epoch: 10, Steps: 3 | Train Loss: 0.468 Vali Loss: 1.061 Vali Acc: 0.650 Test Loss: 1.061 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 0.6809115409851074
Epoch: 11, Steps: 3 | Train Loss: 0.404 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.6109747886657715
Epoch: 12, Steps: 3 | Train Loss: 0.319 Vali Loss: 1.039 Vali Acc: 0.675 Test Loss: 1.039 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 0.6453735828399658
Epoch: 13, Steps: 3 | Train Loss: 0.230 Vali Loss: 1.042 Vali Acc: 0.675 Test Loss: 1.042 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7692978382110596
Epoch: 14, Steps: 3 | Train Loss: 0.217 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8560183048248291
Epoch: 15, Steps: 3 | Train Loss: 0.170 Vali Loss: 1.061 Vali Acc: 0.650 Test Loss: 1.061 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8529620170593262
Epoch: 16, Steps: 3 | Train Loss: 0.128 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6282467842102051
Epoch: 17, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.102 Vali Acc: 0.650 Test Loss: 1.102 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6983373165130615
Epoch: 18, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.134 Vali Acc: 0.675 Test Loss: 1.134 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6703736782073975
Epoch: 19, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.168 Vali Acc: 0.650 Test Loss: 1.168 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6548671722412109
Epoch: 20, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.196 Vali Acc: 0.675 Test Loss: 1.196 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6766998767852783
Epoch: 21, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.221 Vali Acc: 0.675 Test Loss: 1.221 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5935287475585938
Epoch: 22, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.242 Vali Acc: 0.675 Test Loss: 1.242 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 133124
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.346282720565796
Epoch: 1, Steps: 3 | Train Loss: 1.562 Vali Loss: 1.550 Vali Acc: 0.275 Test Loss: 1.550 Test Acc: 0.275
Validation loss decreased (inf --> -0.274984).  Saving model ...
Epoch: 2 cost time: 0.587338924407959
Epoch: 2, Steps: 3 | Train Loss: 1.516 Vali Loss: 1.485 Vali Acc: 0.300 Test Loss: 1.485 Test Acc: 0.300
Validation loss decreased (-0.274984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.5752007961273193
Epoch: 3, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.430 Vali Acc: 0.300 Test Loss: 1.430 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.7103707790374756
Epoch: 4, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.376 Vali Acc: 0.325 Test Loss: 1.376 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.6559853553771973
Epoch: 5, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.331 Vali Acc: 0.325 Test Loss: 1.331 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.6774992942810059
Epoch: 6, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.290 Vali Acc: 0.325 Test Loss: 1.290 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 7 cost time: 0.7382333278656006
Epoch: 7, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.597043514251709
Epoch: 8, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.5893683433532715
Epoch: 9, Steps: 3 | Train Loss: 0.762 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.6479017734527588
Epoch: 10, Steps: 3 | Train Loss: 0.686 Vali Loss: 1.165 Vali Acc: 0.575 Test Loss: 1.165 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 0.684401273727417
Epoch: 11, Steps: 3 | Train Loss: 0.670 Vali Loss: 1.153 Vali Acc: 0.600 Test Loss: 1.153 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 0.5958387851715088
Epoch: 12, Steps: 3 | Train Loss: 0.509 Vali Loss: 1.143 Vali Acc: 0.600 Test Loss: 1.143 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.6845786571502686
Epoch: 13, Steps: 3 | Train Loss: 0.447 Vali Loss: 1.128 Vali Acc: 0.650 Test Loss: 1.128 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 0.5904388427734375
Epoch: 14, Steps: 3 | Train Loss: 0.398 Vali Loss: 1.118 Vali Acc: 0.650 Test Loss: 1.118 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 0.5926146507263184
Epoch: 15, Steps: 3 | Train Loss: 0.295 Vali Loss: 1.104 Vali Acc: 0.650 Test Loss: 1.104 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 0.6016643047332764
Epoch: 16, Steps: 3 | Train Loss: 0.268 Vali Loss: 1.091 Vali Acc: 0.650 Test Loss: 1.091 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 17 cost time: 0.7534351348876953
Epoch: 17, Steps: 3 | Train Loss: 0.191 Vali Loss: 1.084 Vali Acc: 0.675 Test Loss: 1.084 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 18 cost time: 0.6599636077880859
Epoch: 18, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.077 Vali Acc: 0.700 Test Loss: 1.077 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 0.6563267707824707
Epoch: 19, Steps: 3 | Train Loss: 0.130 Vali Loss: 1.076 Vali Acc: 0.650 Test Loss: 1.076 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8164966106414795
Epoch: 20, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.083 Vali Acc: 0.650 Test Loss: 1.083 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.676830530166626
Epoch: 21, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6818192005157471
Epoch: 22, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.104 Vali Acc: 0.650 Test Loss: 1.104 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7562310695648193
Epoch: 23, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.115 Vali Acc: 0.650 Test Loss: 1.115 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5817277431488037
Epoch: 24, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.124 Vali Acc: 0.650 Test Loss: 1.124 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.598402738571167
Epoch: 25, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.136 Vali Acc: 0.650 Test Loss: 1.136 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6303391456604004
Epoch: 26, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.143 Vali Acc: 0.650 Test Loss: 1.143 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.647106409072876
Epoch: 27, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.153 Vali Acc: 0.650 Test Loss: 1.153 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6191601753234863
Epoch: 28, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.161 Vali Acc: 0.650 Test Loss: 1.161 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df128_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 124548
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.335425615310669
Epoch: 1, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.349 Vali Acc: 0.400 Test Loss: 1.349 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.6412312984466553
Epoch: 2, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.283 Vali Acc: 0.425 Test Loss: 1.283 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.6577105522155762
Epoch: 3, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.589423418045044
Epoch: 4, Steps: 3 | Train Loss: 0.791 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 0.5801897048950195
Epoch: 5, Steps: 3 | Train Loss: 0.649 Vali Loss: 1.057 Vali Acc: 0.525 Test Loss: 1.057 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 6 cost time: 0.5271453857421875
Epoch: 6, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.988 Vali Acc: 0.575 Test Loss: 0.988 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574990).  Saving model ...
Epoch: 7 cost time: 0.6244246959686279
Epoch: 7, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.877 Vali Acc: 0.675 Test Loss: 0.877 Test Acc: 0.675
Validation loss decreased (-0.574990 --> -0.674991).  Saving model ...
Epoch: 8 cost time: 0.7209093570709229
Epoch: 8, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.867 Vali Acc: 0.700 Test Loss: 0.867 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 9 cost time: 0.6844375133514404
Epoch: 9, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.912 Vali Acc: 0.675 Test Loss: 0.912 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6717290878295898
Epoch: 10, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 0.5744984149932861
Epoch: 11, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.829 Vali Acc: 0.800 Test Loss: 0.829 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 0.7103052139282227
Epoch: 12, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.847 Vali Acc: 0.800 Test Loss: 0.847 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7131738662719727
Epoch: 13, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7698116302490234
Epoch: 14, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.912 Vali Acc: 0.775 Test Loss: 0.912 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6885731220245361
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7510201930999756
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7166626453399658
Epoch: 17, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.988 Vali Acc: 0.750 Test Loss: 0.988 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7489686012268066
Epoch: 18, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.750 Test Loss: 1.001 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7151126861572266
Epoch: 19, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.009 Vali Acc: 0.750 Test Loss: 1.009 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6363406181335449
Epoch: 20, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.750 Test Loss: 1.015 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6529650688171387
Epoch: 21, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.750 Test Loss: 1.018 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 237380
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.152108669281006
Epoch: 1, Steps: 3 | Train Loss: 1.569 Vali Loss: 1.521 Vali Acc: 0.175 Test Loss: 1.521 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.5986113548278809
Epoch: 2, Steps: 3 | Train Loss: 1.556 Vali Loss: 1.480 Vali Acc: 0.225 Test Loss: 1.480 Test Acc: 0.225
Validation loss decreased (-0.174985 --> -0.224985).  Saving model ...
Epoch: 3 cost time: 0.6312124729156494
Epoch: 3, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.393 Vali Acc: 0.350 Test Loss: 1.393 Test Acc: 0.350
Validation loss decreased (-0.224985 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.6882646083831787
Epoch: 4, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.310 Vali Acc: 0.425 Test Loss: 1.310 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.6569607257843018
Epoch: 5, Steps: 3 | Train Loss: 0.797 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.655160665512085
Epoch: 6, Steps: 3 | Train Loss: 0.583 Vali Loss: 1.125 Vali Acc: 0.525 Test Loss: 1.125 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 0.6314947605133057
Epoch: 7, Steps: 3 | Train Loss: 0.369 Vali Loss: 1.012 Vali Acc: 0.650 Test Loss: 1.012 Test Acc: 0.650
Validation loss decreased (-0.524989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.6216914653778076
Epoch: 8, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.944 Vali Acc: 0.700 Test Loss: 0.944 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 9 cost time: 0.5567760467529297
Epoch: 9, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.912 Vali Acc: 0.725 Test Loss: 0.912 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 10 cost time: 0.7029328346252441
Epoch: 10, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.861 Vali Acc: 0.700 Test Loss: 0.861 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6115090847015381
Epoch: 11, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.865 Vali Acc: 0.700 Test Loss: 0.865 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7511239051818848
Epoch: 12, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.6474015712738037
Epoch: 13, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.901 Vali Acc: 0.725 Test Loss: 0.901 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6428806781768799
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.924 Vali Acc: 0.725 Test Loss: 0.924 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6912233829498291
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.944 Vali Acc: 0.725 Test Loss: 0.944 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7168762683868408
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.946 Vali Acc: 0.725 Test Loss: 0.946 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6614503860473633
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.944 Vali Acc: 0.725 Test Loss: 0.944 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7827129364013672
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6293706893920898
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.951 Vali Acc: 0.700 Test Loss: 0.951 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7896914482116699
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.700 Test Loss: 0.959 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5910975933074951
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.966 Vali Acc: 0.700 Test Loss: 0.966 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7066776752471924
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.972 Vali Acc: 0.700 Test Loss: 0.972 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 185412
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.394698143005371
Epoch: 1, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.403 Vali Acc: 0.275 Test Loss: 1.403 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6408686637878418
Epoch: 2, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.365 Vali Acc: 0.300 Test Loss: 1.365 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.7298030853271484
Epoch: 3, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.296 Vali Acc: 0.275 Test Loss: 1.296 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6162006855010986
Epoch: 4, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.221 Vali Acc: 0.425 Test Loss: 1.221 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424988).  Saving model ...
Epoch: 5 cost time: 0.6710488796234131
Epoch: 5, Steps: 3 | Train Loss: 0.839 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 0.6772658824920654
Epoch: 6, Steps: 3 | Train Loss: 0.600 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
Validation loss decreased (-0.499989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.6715073585510254
Epoch: 7, Steps: 3 | Train Loss: 0.472 Vali Loss: 1.031 Vali Acc: 0.650 Test Loss: 1.031 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.6510426998138428
Epoch: 8, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.997 Vali Acc: 0.625 Test Loss: 0.997 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7700819969177246
Epoch: 9, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.6509966850280762
Epoch: 10, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.951 Vali Acc: 0.675 Test Loss: 0.951 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.6122188568115234
Epoch: 11, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.933 Vali Acc: 0.675 Test Loss: 0.933 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 12 cost time: 0.652862548828125
Epoch: 12, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.918 Vali Acc: 0.700 Test Loss: 0.918 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 0.6224856376647949
Epoch: 13, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.920 Vali Acc: 0.700 Test Loss: 0.920 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6553237438201904
Epoch: 14, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.938 Vali Acc: 0.700 Test Loss: 0.938 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7048435211181641
Epoch: 15, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.971 Vali Acc: 0.700 Test Loss: 0.971 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8106622695922852
Epoch: 16, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.007 Vali Acc: 0.675 Test Loss: 1.007 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6952459812164307
Epoch: 17, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.039 Vali Acc: 0.675 Test Loss: 1.039 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6769962310791016
Epoch: 18, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.063 Vali Acc: 0.675 Test Loss: 1.063 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6043791770935059
Epoch: 19, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.077 Vali Acc: 0.675 Test Loss: 1.077 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6413509845733643
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.085 Vali Acc: 0.675 Test Loss: 1.085 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7498607635498047
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.090 Vali Acc: 0.675 Test Loss: 1.090 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6422550678253174
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.093 Vali Acc: 0.675 Test Loss: 1.093 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 161220
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.317974090576172
Epoch: 1, Steps: 3 | Train Loss: 1.544 Vali Loss: 1.513 Vali Acc: 0.250 Test Loss: 1.513 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.6584022045135498
Epoch: 2, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.488 Vali Acc: 0.325 Test Loss: 1.488 Test Acc: 0.325
Validation loss decreased (-0.249985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.5904800891876221
Epoch: 3, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.431 Vali Acc: 0.325 Test Loss: 1.431 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.5851802825927734
Epoch: 4, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.353 Vali Acc: 0.350 Test Loss: 1.353 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.6370742321014404
Epoch: 5, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
Validation loss decreased (-0.349986 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.6612653732299805
Epoch: 6, Steps: 3 | Train Loss: 0.674 Vali Loss: 1.216 Vali Acc: 0.600 Test Loss: 1.216 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.7059667110443115
Epoch: 7, Steps: 3 | Train Loss: 0.623 Vali Loss: 1.156 Vali Acc: 0.600 Test Loss: 1.156 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.6714935302734375
Epoch: 8, Steps: 3 | Train Loss: 0.414 Vali Loss: 1.129 Vali Acc: 0.625 Test Loss: 1.129 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.765247106552124
Epoch: 9, Steps: 3 | Train Loss: 0.296 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6599931716918945
Epoch: 10, Steps: 3 | Train Loss: 0.259 Vali Loss: 1.128 Vali Acc: 0.600 Test Loss: 1.128 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.575437068939209
Epoch: 11, Steps: 3 | Train Loss: 0.182 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6171290874481201
Epoch: 12, Steps: 3 | Train Loss: 0.117 Vali Loss: 1.130 Vali Acc: 0.650 Test Loss: 1.130 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 0.6542403697967529
Epoch: 13, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.152 Vali Acc: 0.675 Test Loss: 1.152 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674988).  Saving model ...
Epoch: 14 cost time: 0.5723304748535156
Epoch: 14, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.171 Vali Acc: 0.675 Test Loss: 1.171 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5939536094665527
Epoch: 15, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.185 Vali Acc: 0.675 Test Loss: 1.185 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.757265567779541
Epoch: 16, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.195 Vali Acc: 0.675 Test Loss: 1.195 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.48562049865722656
Epoch: 17, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.204 Vali Acc: 0.675 Test Loss: 1.204 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6364526748657227
Epoch: 18, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.206 Vali Acc: 0.675 Test Loss: 1.206 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6230661869049072
Epoch: 19, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.217 Vali Acc: 0.675 Test Loss: 1.217 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6011991500854492
Epoch: 20, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.233 Vali Acc: 0.675 Test Loss: 1.233 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8102898597717285
Epoch: 21, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.246 Vali Acc: 0.650 Test Loss: 1.246 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7775132656097412
Epoch: 22, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.255 Vali Acc: 0.650 Test Loss: 1.255 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6255033016204834
Epoch: 23, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.262 Vali Acc: 0.650 Test Loss: 1.262 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 146116
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5016896724700928
Epoch: 1, Steps: 3 | Train Loss: 1.561 Vali Loss: 1.365 Vali Acc: 0.350 Test Loss: 1.365 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.6241791248321533
Epoch: 2, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.347 Vali Acc: 0.325 Test Loss: 1.347 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7055072784423828
Epoch: 3, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.322 Vali Acc: 0.350 Test Loss: 1.322 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.6284570693969727
Epoch: 4, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
Validation loss decreased (-0.349987 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.652679443359375
Epoch: 5, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.247 Vali Acc: 0.575 Test Loss: 1.247 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 0.5013611316680908
Epoch: 6, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.211 Vali Acc: 0.625 Test Loss: 1.211 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.6004621982574463
Epoch: 7, Steps: 3 | Train Loss: 0.778 Vali Loss: 1.173 Vali Acc: 0.625 Test Loss: 1.173 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 8 cost time: 0.5705437660217285
Epoch: 8, Steps: 3 | Train Loss: 0.655 Vali Loss: 1.140 Vali Acc: 0.625 Test Loss: 1.140 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.710526704788208
Epoch: 9, Steps: 3 | Train Loss: 0.497 Vali Loss: 1.111 Vali Acc: 0.625 Test Loss: 1.111 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.6481740474700928
Epoch: 10, Steps: 3 | Train Loss: 0.448 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5483779907226562
Epoch: 11, Steps: 3 | Train Loss: 0.364 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.683204174041748
Epoch: 12, Steps: 3 | Train Loss: 0.273 Vali Loss: 1.055 Vali Acc: 0.625 Test Loss: 1.055 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.6833953857421875
Epoch: 13, Steps: 3 | Train Loss: 0.213 Vali Loss: 1.055 Vali Acc: 0.625 Test Loss: 1.055 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.5105302333831787
Epoch: 14, Steps: 3 | Train Loss: 0.182 Vali Loss: 1.065 Vali Acc: 0.650 Test Loss: 1.065 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 0.6390902996063232
Epoch: 15, Steps: 3 | Train Loss: 0.128 Vali Loss: 1.087 Vali Acc: 0.650 Test Loss: 1.087 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.704301118850708
Epoch: 16, Steps: 3 | Train Loss: 0.093 Vali Loss: 1.100 Vali Acc: 0.625 Test Loss: 1.100 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6799085140228271
Epoch: 17, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.600471019744873
Epoch: 18, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.147 Vali Acc: 0.625 Test Loss: 1.147 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.68196702003479
Epoch: 19, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.171 Vali Acc: 0.625 Test Loss: 1.171 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5681018829345703
Epoch: 20, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.190 Vali Acc: 0.650 Test Loss: 1.190 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.636643648147583
Epoch: 21, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.212 Vali Acc: 0.625 Test Loss: 1.212 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.676288366317749
Epoch: 22, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.232 Vali Acc: 0.625 Test Loss: 1.232 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.62068772315979
Epoch: 23, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.248 Vali Acc: 0.625 Test Loss: 1.248 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6057472229003906
Epoch: 24, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.254 Vali Acc: 0.650 Test Loss: 1.254 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 122180
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1859965324401855
Epoch: 1, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.444 Vali Acc: 0.250 Test Loss: 1.444 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5709471702575684
Epoch: 2, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.434 Vali Acc: 0.275 Test Loss: 1.434 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.5726613998413086
Epoch: 3, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.417 Vali Acc: 0.275 Test Loss: 1.417 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.5901703834533691
Epoch: 4, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.393 Vali Acc: 0.325 Test Loss: 1.393 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.6229829788208008
Epoch: 5, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.5773913860321045
Epoch: 6, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.345 Vali Acc: 0.375 Test Loss: 1.345 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4841041564941406
Epoch: 7, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.318 Vali Acc: 0.450 Test Loss: 1.318 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.6098105907440186
Epoch: 8, Steps: 3 | Train Loss: 0.624 Vali Loss: 1.295 Vali Acc: 0.475 Test Loss: 1.295 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.6735811233520508
Epoch: 9, Steps: 3 | Train Loss: 0.562 Vali Loss: 1.267 Vali Acc: 0.475 Test Loss: 1.267 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.6392974853515625
Epoch: 10, Steps: 3 | Train Loss: 0.477 Vali Loss: 1.245 Vali Acc: 0.525 Test Loss: 1.245 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.5742745399475098
Epoch: 11, Steps: 3 | Train Loss: 0.371 Vali Loss: 1.221 Vali Acc: 0.550 Test Loss: 1.221 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.665715217590332
Epoch: 12, Steps: 3 | Train Loss: 0.340 Vali Loss: 1.195 Vali Acc: 0.625 Test Loss: 1.195 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 13 cost time: 0.7410061359405518
Epoch: 13, Steps: 3 | Train Loss: 0.335 Vali Loss: 1.177 Vali Acc: 0.650 Test Loss: 1.177 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 0.7152523994445801
Epoch: 14, Steps: 3 | Train Loss: 0.207 Vali Loss: 1.166 Vali Acc: 0.650 Test Loss: 1.166 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 15 cost time: 0.6425826549530029
Epoch: 15, Steps: 3 | Train Loss: 0.165 Vali Loss: 1.166 Vali Acc: 0.650 Test Loss: 1.166 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8018889427185059
Epoch: 16, Steps: 3 | Train Loss: 0.132 Vali Loss: 1.177 Vali Acc: 0.650 Test Loss: 1.177 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5654449462890625
Epoch: 17, Steps: 3 | Train Loss: 0.096 Vali Loss: 1.201 Vali Acc: 0.650 Test Loss: 1.201 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7644340991973877
Epoch: 18, Steps: 3 | Train Loss: 0.079 Vali Loss: 1.217 Vali Acc: 0.650 Test Loss: 1.217 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.669553279876709
Epoch: 19, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.233 Vali Acc: 0.675 Test Loss: 1.233 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 20 cost time: 0.6186861991882324
Epoch: 20, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.252 Vali Acc: 0.675 Test Loss: 1.252 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7567212581634521
Epoch: 21, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.274 Vali Acc: 0.675 Test Loss: 1.274 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6334695816040039
Epoch: 22, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.288 Vali Acc: 0.675 Test Loss: 1.288 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6235589981079102
Epoch: 23, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.301 Vali Acc: 0.675 Test Loss: 1.301 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6497101783752441
Epoch: 24, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.312 Vali Acc: 0.675 Test Loss: 1.312 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6161341667175293
Epoch: 25, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.323 Vali Acc: 0.675 Test Loss: 1.323 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6729316711425781
Epoch: 26, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.328 Vali Acc: 0.675 Test Loss: 1.328 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5836062431335449
Epoch: 27, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.331 Vali Acc: 0.675 Test Loss: 1.331 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.650214433670044
Epoch: 28, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.339 Vali Acc: 0.675 Test Loss: 1.339 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6153035163879395
Epoch: 29, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.345 Vali Acc: 0.675 Test Loss: 1.345 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 116676
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3971214294433594
Epoch: 1, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.512 Vali Acc: 0.100 Test Loss: 1.512 Test Acc: 0.100
Validation loss decreased (inf --> -0.099985).  Saving model ...
Epoch: 2 cost time: 0.6332638263702393
Epoch: 2, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.473 Vali Acc: 0.100 Test Loss: 1.473 Test Acc: 0.100
Validation loss decreased (-0.099985 --> -0.099985).  Saving model ...
Epoch: 3 cost time: 0.5916552543640137
Epoch: 3, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.435 Vali Acc: 0.200 Test Loss: 1.435 Test Acc: 0.200
Validation loss decreased (-0.099985 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.6078755855560303
Epoch: 4, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.400 Vali Acc: 0.225 Test Loss: 1.400 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.5620191097259521
Epoch: 5, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.364 Vali Acc: 0.325 Test Loss: 1.364 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.5990540981292725
Epoch: 6, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.332 Vali Acc: 0.350 Test Loss: 1.332 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.6752655506134033
Epoch: 7, Steps: 3 | Train Loss: 0.858 Vali Loss: 1.299 Vali Acc: 0.375 Test Loss: 1.299 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.6310043334960938
Epoch: 8, Steps: 3 | Train Loss: 0.834 Vali Loss: 1.274 Vali Acc: 0.450 Test Loss: 1.274 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.626577615737915
Epoch: 9, Steps: 3 | Train Loss: 0.724 Vali Loss: 1.257 Vali Acc: 0.525 Test Loss: 1.257 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 0.5778172016143799
Epoch: 10, Steps: 3 | Train Loss: 0.624 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5578939914703369
Epoch: 11, Steps: 3 | Train Loss: 0.556 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5676157474517822
Epoch: 12, Steps: 3 | Train Loss: 0.515 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6765737533569336
Epoch: 13, Steps: 3 | Train Loss: 0.382 Vali Loss: 1.219 Vali Acc: 0.550 Test Loss: 1.219 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 0.5915708541870117
Epoch: 14, Steps: 3 | Train Loss: 0.312 Vali Loss: 1.214 Vali Acc: 0.550 Test Loss: 1.214 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.695091724395752
Epoch: 15, Steps: 3 | Train Loss: 0.258 Vali Loss: 1.213 Vali Acc: 0.575 Test Loss: 1.213 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 16 cost time: 0.7216708660125732
Epoch: 16, Steps: 3 | Train Loss: 0.256 Vali Loss: 1.219 Vali Acc: 0.575 Test Loss: 1.219 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6068830490112305
Epoch: 17, Steps: 3 | Train Loss: 0.219 Vali Loss: 1.224 Vali Acc: 0.625 Test Loss: 1.224 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 18 cost time: 0.6052694320678711
Epoch: 18, Steps: 3 | Train Loss: 0.163 Vali Loss: 1.225 Vali Acc: 0.625 Test Loss: 1.225 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5761280059814453
Epoch: 19, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.229 Vali Acc: 0.625 Test Loss: 1.229 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6136417388916016
Epoch: 20, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.236 Vali Acc: 0.650 Test Loss: 1.236 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 21 cost time: 0.6856999397277832
Epoch: 21, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.241 Vali Acc: 0.675 Test Loss: 1.241 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 22 cost time: 0.6234750747680664
Epoch: 22, Steps: 3 | Train Loss: 0.060 Vali Loss: 1.252 Vali Acc: 0.675 Test Loss: 1.252 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.595390796661377
Epoch: 23, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.260 Vali Acc: 0.675 Test Loss: 1.260 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7063553333282471
Epoch: 24, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.274 Vali Acc: 0.675 Test Loss: 1.274 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5910501480102539
Epoch: 25, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.288 Vali Acc: 0.675 Test Loss: 1.288 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6019196510314941
Epoch: 26, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.305 Vali Acc: 0.675 Test Loss: 1.305 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6403272151947021
Epoch: 27, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.321 Vali Acc: 0.675 Test Loss: 1.321 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6026504039764404
Epoch: 28, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.334 Vali Acc: 0.675 Test Loss: 1.334 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5660462379455566
Epoch: 29, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.345 Vali Acc: 0.675 Test Loss: 1.345 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6107699871063232
Epoch: 30, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.354 Vali Acc: 0.675 Test Loss: 1.354 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6577911376953125
Epoch: 31, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.361 Vali Acc: 0.675 Test Loss: 1.361 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm128_nh16_df64_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 108100
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5733067989349365
Epoch: 1, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.442 Vali Acc: 0.275 Test Loss: 1.442 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6394798755645752
Epoch: 2, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.366 Vali Acc: 0.275 Test Loss: 1.366 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6648297309875488
Epoch: 3, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.277 Vali Acc: 0.450 Test Loss: 1.277 Test Acc: 0.450
Validation loss decreased (-0.274986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.6154317855834961
Epoch: 4, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.201 Vali Acc: 0.550 Test Loss: 1.201 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.6153464317321777
Epoch: 5, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.123 Vali Acc: 0.650 Test Loss: 1.123 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649989).  Saving model ...
Epoch: 6 cost time: 0.6978795528411865
Epoch: 6, Steps: 3 | Train Loss: 0.628 Vali Loss: 1.054 Vali Acc: 0.675 Test Loss: 1.054 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.6032657623291016
Epoch: 7, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.992 Vali Acc: 0.700 Test Loss: 0.992 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.5835170745849609
Epoch: 8, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.969 Vali Acc: 0.700 Test Loss: 0.969 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 0.6968941688537598
Epoch: 9, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.960 Vali Acc: 0.725 Test Loss: 0.960 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 0.6485269069671631
Epoch: 10, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.948 Vali Acc: 0.725 Test Loss: 0.948 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 11 cost time: 0.5974383354187012
Epoch: 11, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.946 Vali Acc: 0.725 Test Loss: 0.946 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 0.6575784683227539
Epoch: 12, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.925 Vali Acc: 0.725 Test Loss: 0.925 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.5836179256439209
Epoch: 13, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.897 Vali Acc: 0.800 Test Loss: 0.897 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 0.6778426170349121
Epoch: 14, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.902 Vali Acc: 0.800 Test Loss: 0.902 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6176238059997559
Epoch: 15, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.921 Vali Acc: 0.775 Test Loss: 0.921 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6543440818786621
Epoch: 16, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.932 Vali Acc: 0.800 Test Loss: 0.932 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7485201358795166
Epoch: 17, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.946 Vali Acc: 0.775 Test Loss: 0.946 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6251733303070068
Epoch: 18, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.962 Vali Acc: 0.775 Test Loss: 0.962 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5967528820037842
Epoch: 19, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.973 Vali Acc: 0.775 Test Loss: 0.973 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6596493721008301
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.970 Vali Acc: 0.800 Test Loss: 0.970 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.608504056930542
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.970 Vali Acc: 0.800 Test Loss: 0.970 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6546216011047363
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.971 Vali Acc: 0.800 Test Loss: 0.971 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6306886672973633
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.974 Vali Acc: 0.800 Test Loss: 0.974 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 127108
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3445730209350586
Epoch: 1, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.436 Vali Acc: 0.300 Test Loss: 1.436 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.7061765193939209
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.381 Vali Acc: 0.325 Test Loss: 1.381 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.6426403522491455
Epoch: 3, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.7979679107666016
Epoch: 4, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.267 Vali Acc: 0.425 Test Loss: 1.267 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.6683416366577148
Epoch: 5, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.208 Vali Acc: 0.450 Test Loss: 1.208 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.6288282871246338
Epoch: 6, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.142 Vali Acc: 0.525 Test Loss: 1.142 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 0.6612386703491211
Epoch: 7, Steps: 3 | Train Loss: 0.716 Vali Loss: 1.082 Vali Acc: 0.550 Test Loss: 1.082 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.6364250183105469
Epoch: 8, Steps: 3 | Train Loss: 0.531 Vali Loss: 1.042 Vali Acc: 0.575 Test Loss: 1.042 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574990).  Saving model ...
Epoch: 9 cost time: 0.6430521011352539
Epoch: 9, Steps: 3 | Train Loss: 0.512 Vali Loss: 1.012 Vali Acc: 0.625 Test Loss: 1.012 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.6963465213775635
Epoch: 10, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.981 Vali Acc: 0.625 Test Loss: 0.981 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.5757584571838379
Epoch: 11, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.952 Vali Acc: 0.600 Test Loss: 0.952 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7359967231750488
Epoch: 12, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.931 Vali Acc: 0.625 Test Loss: 0.931 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 13 cost time: 0.6873781681060791
Epoch: 13, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.910 Vali Acc: 0.650 Test Loss: 0.910 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649991).  Saving model ...
Epoch: 14 cost time: 0.671154260635376
Epoch: 14, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.877 Vali Acc: 0.675 Test Loss: 0.877 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 15 cost time: 0.6422743797302246
Epoch: 15, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.858 Vali Acc: 0.675 Test Loss: 0.858 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 16 cost time: 0.5961947441101074
Epoch: 16, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.835 Vali Acc: 0.675 Test Loss: 0.835 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674992).  Saving model ...
Epoch: 17 cost time: 0.6315481662750244
Epoch: 17, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.826 Vali Acc: 0.725 Test Loss: 0.826 Test Acc: 0.725
Validation loss decreased (-0.674992 --> -0.724992).  Saving model ...
Epoch: 18 cost time: 0.643726110458374
Epoch: 18, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 0.7305359840393066
Epoch: 19, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.856 Vali Acc: 0.700 Test Loss: 0.856 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7476563453674316
Epoch: 20, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.878 Vali Acc: 0.700 Test Loss: 0.878 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7223639488220215
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.894 Vali Acc: 0.675 Test Loss: 0.894 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6279420852661133
Epoch: 22, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.907 Vali Acc: 0.675 Test Loss: 0.907 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7496821880340576
Epoch: 23, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.920 Vali Acc: 0.675 Test Loss: 0.920 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5595135688781738
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.931 Vali Acc: 0.675 Test Loss: 0.931 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7724385261535645
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.939 Vali Acc: 0.675 Test Loss: 0.939 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6025514602661133
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.944 Vali Acc: 0.675 Test Loss: 0.944 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6249136924743652
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.946 Vali Acc: 0.675 Test Loss: 0.946 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6502830982208252
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.945 Vali Acc: 0.675 Test Loss: 0.945 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 101124
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.211576461791992
Epoch: 1, Steps: 3 | Train Loss: 1.529 Vali Loss: 1.449 Vali Acc: 0.250 Test Loss: 1.449 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.8088445663452148
Epoch: 2, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.428 Vali Acc: 0.300 Test Loss: 1.428 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.6310291290283203
Epoch: 3, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.389 Vali Acc: 0.300 Test Loss: 1.389 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.7011208534240723
Epoch: 4, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.347 Vali Acc: 0.300 Test Loss: 1.347 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.6551303863525391
Epoch: 5, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.302 Vali Acc: 0.350 Test Loss: 1.302 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.6521859169006348
Epoch: 6, Steps: 3 | Train Loss: 0.871 Vali Loss: 1.258 Vali Acc: 0.375 Test Loss: 1.258 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.630051851272583
Epoch: 7, Steps: 3 | Train Loss: 0.653 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.6703090667724609
Epoch: 8, Steps: 3 | Train Loss: 0.681 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
Validation loss decreased (-0.399988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.7129590511322021
Epoch: 9, Steps: 3 | Train Loss: 0.523 Vali Loss: 1.136 Vali Acc: 0.525 Test Loss: 1.136 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 0.6985859870910645
Epoch: 10, Steps: 3 | Train Loss: 0.497 Vali Loss: 1.107 Vali Acc: 0.625 Test Loss: 1.107 Test Acc: 0.625
Validation loss decreased (-0.524989 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.7187292575836182
Epoch: 11, Steps: 3 | Train Loss: 0.357 Vali Loss: 1.081 Vali Acc: 0.625 Test Loss: 1.081 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.717501163482666
Epoch: 12, Steps: 3 | Train Loss: 0.295 Vali Loss: 1.057 Vali Acc: 0.650 Test Loss: 1.057 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 0.7083256244659424
Epoch: 13, Steps: 3 | Train Loss: 0.217 Vali Loss: 1.031 Vali Acc: 0.650 Test Loss: 1.031 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 0.8162355422973633
Epoch: 14, Steps: 3 | Train Loss: 0.171 Vali Loss: 1.009 Vali Acc: 0.675 Test Loss: 1.009 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 15 cost time: 0.6400618553161621
Epoch: 15, Steps: 3 | Train Loss: 0.136 Vali Loss: 1.002 Vali Acc: 0.675 Test Loss: 1.002 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 16 cost time: 0.625582218170166
Epoch: 16, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.006 Vali Acc: 0.650 Test Loss: 1.006 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7013404369354248
Epoch: 17, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.019 Vali Acc: 0.675 Test Loss: 1.019 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7190361022949219
Epoch: 18, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.026 Vali Acc: 0.675 Test Loss: 1.026 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6974887847900391
Epoch: 19, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.040 Vali Acc: 0.675 Test Loss: 1.040 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6665382385253906
Epoch: 20, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.048 Vali Acc: 0.675 Test Loss: 1.048 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6634855270385742
Epoch: 21, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.051 Vali Acc: 0.650 Test Loss: 1.051 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7259318828582764
Epoch: 22, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.055 Vali Acc: 0.650 Test Loss: 1.055 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7468340396881104
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.062 Vali Acc: 0.650 Test Loss: 1.062 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6404309272766113
Epoch: 24, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.066 Vali Acc: 0.675 Test Loss: 1.066 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.664036750793457
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.070 Vali Acc: 0.675 Test Loss: 1.070 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 89028
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3350272178649902
Epoch: 1, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.482 Vali Acc: 0.300 Test Loss: 1.482 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.6206016540527344
Epoch: 2, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.438 Vali Acc: 0.300 Test Loss: 1.438 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.6145195960998535
Epoch: 3, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.384 Vali Acc: 0.300 Test Loss: 1.384 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.6876468658447266
Epoch: 4, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.315 Vali Acc: 0.400 Test Loss: 1.315 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.6706674098968506
Epoch: 5, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.246 Vali Acc: 0.450 Test Loss: 1.246 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.7320544719696045
Epoch: 6, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.189 Vali Acc: 0.475 Test Loss: 1.189 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.6339168548583984
Epoch: 7, Steps: 3 | Train Loss: 0.788 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.6730000972747803
Epoch: 8, Steps: 3 | Train Loss: 0.753 Vali Loss: 1.109 Vali Acc: 0.525 Test Loss: 1.109 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 9 cost time: 0.6118619441986084
Epoch: 9, Steps: 3 | Train Loss: 0.579 Vali Loss: 1.080 Vali Acc: 0.550 Test Loss: 1.080 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 0.5949256420135498
Epoch: 10, Steps: 3 | Train Loss: 0.520 Vali Loss: 1.048 Vali Acc: 0.550 Test Loss: 1.048 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549990).  Saving model ...
Epoch: 11 cost time: 0.6257355213165283
Epoch: 11, Steps: 3 | Train Loss: 0.437 Vali Loss: 1.022 Vali Acc: 0.575 Test Loss: 1.022 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 12 cost time: 0.6243767738342285
Epoch: 12, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.992 Vali Acc: 0.625 Test Loss: 0.992 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624990).  Saving model ...
Epoch: 13 cost time: 0.6660671234130859
Epoch: 13, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.977 Vali Acc: 0.625 Test Loss: 0.977 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 14 cost time: 0.6124997138977051
Epoch: 14, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.969 Vali Acc: 0.625 Test Loss: 0.969 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 15 cost time: 0.6133944988250732
Epoch: 15, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.972 Vali Acc: 0.625 Test Loss: 0.972 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6465506553649902
Epoch: 16, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 0.62424635887146
Epoch: 17, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.985 Vali Acc: 0.625 Test Loss: 0.985 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6087472438812256
Epoch: 18, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 19 cost time: 0.7063333988189697
Epoch: 19, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.987 Vali Acc: 0.650 Test Loss: 0.987 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7051918506622314
Epoch: 20, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.001 Vali Acc: 0.650 Test Loss: 1.001 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6343016624450684
Epoch: 21, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.015 Vali Acc: 0.650 Test Loss: 1.015 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7994506359100342
Epoch: 22, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.024 Vali Acc: 0.650 Test Loss: 1.024 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6026852130889893
Epoch: 23, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.026 Vali Acc: 0.650 Test Loss: 1.026 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7616920471191406
Epoch: 24, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.023 Vali Acc: 0.650 Test Loss: 1.023 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7174642086029053
Epoch: 25, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.796034574508667
Epoch: 26, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.019 Vali Acc: 0.650 Test Loss: 1.019 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5835144519805908
Epoch: 27, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.018 Vali Acc: 0.650 Test Loss: 1.018 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6170735359191895
Epoch: 28, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.019 Vali Acc: 0.650 Test Loss: 1.019 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 81476
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4993972778320312
Epoch: 1, Steps: 3 | Train Loss: 1.577 Vali Loss: 1.310 Vali Acc: 0.375 Test Loss: 1.310 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.6636543273925781
Epoch: 2, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.301 Vali Acc: 0.425 Test Loss: 1.301 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.6613550186157227
Epoch: 3, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.290 Vali Acc: 0.425 Test Loss: 1.290 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.9157257080078125
Epoch: 4, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.274 Vali Acc: 0.450 Test Loss: 1.274 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.7481956481933594
Epoch: 5, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.254 Vali Acc: 0.450 Test Loss: 1.254 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.6450810432434082
Epoch: 6, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.233 Vali Acc: 0.450 Test Loss: 1.233 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 0.6999528408050537
Epoch: 7, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.210 Vali Acc: 0.475 Test Loss: 1.210 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.6549944877624512
Epoch: 8, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.187 Vali Acc: 0.475 Test Loss: 1.187 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.6692302227020264
Epoch: 9, Steps: 3 | Train Loss: 0.811 Vali Loss: 1.169 Vali Acc: 0.475 Test Loss: 1.169 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 0.7544329166412354
Epoch: 10, Steps: 3 | Train Loss: 0.772 Vali Loss: 1.154 Vali Acc: 0.475 Test Loss: 1.154 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.6799530982971191
Epoch: 11, Steps: 3 | Train Loss: 0.664 Vali Loss: 1.140 Vali Acc: 0.475 Test Loss: 1.140 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474989).  Saving model ...
Epoch: 12 cost time: 0.6634962558746338
Epoch: 12, Steps: 3 | Train Loss: 0.667 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 0.721444845199585
Epoch: 13, Steps: 3 | Train Loss: 0.524 Vali Loss: 1.122 Vali Acc: 0.525 Test Loss: 1.122 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 14 cost time: 0.6187169551849365
Epoch: 14, Steps: 3 | Train Loss: 0.400 Vali Loss: 1.118 Vali Acc: 0.525 Test Loss: 1.118 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 15 cost time: 0.6627881526947021
Epoch: 15, Steps: 3 | Train Loss: 0.370 Vali Loss: 1.112 Vali Acc: 0.550 Test Loss: 1.112 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 16 cost time: 0.6353051662445068
Epoch: 16, Steps: 3 | Train Loss: 0.349 Vali Loss: 1.103 Vali Acc: 0.600 Test Loss: 1.103 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.6778624057769775
Epoch: 17, Steps: 3 | Train Loss: 0.280 Vali Loss: 1.085 Vali Acc: 0.625 Test Loss: 1.085 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.5548632144927979
Epoch: 18, Steps: 3 | Train Loss: 0.214 Vali Loss: 1.074 Vali Acc: 0.625 Test Loss: 1.074 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.666754961013794
Epoch: 19, Steps: 3 | Train Loss: 0.236 Vali Loss: 1.074 Vali Acc: 0.625 Test Loss: 1.074 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6333708763122559
Epoch: 20, Steps: 3 | Train Loss: 0.153 Vali Loss: 1.073 Vali Acc: 0.650 Test Loss: 1.073 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 21 cost time: 0.6223328113555908
Epoch: 21, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.071 Vali Acc: 0.650 Test Loss: 1.071 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 22 cost time: 0.5577254295349121
Epoch: 22, Steps: 3 | Train Loss: 0.107 Vali Loss: 1.073 Vali Acc: 0.650 Test Loss: 1.073 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6810576915740967
Epoch: 23, Steps: 3 | Train Loss: 0.091 Vali Loss: 1.077 Vali Acc: 0.675 Test Loss: 1.077 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 24 cost time: 0.7359845638275146
Epoch: 24, Steps: 3 | Train Loss: 0.093 Vali Loss: 1.088 Vali Acc: 0.675 Test Loss: 1.088 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6443169116973877
Epoch: 25, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.100 Vali Acc: 0.675 Test Loss: 1.100 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6500880718231201
Epoch: 26, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.113 Vali Acc: 0.675 Test Loss: 1.113 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6023898124694824
Epoch: 27, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.128 Vali Acc: 0.675 Test Loss: 1.128 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7157514095306396
Epoch: 28, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.144 Vali Acc: 0.675 Test Loss: 1.144 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6090564727783203
Epoch: 29, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.157 Vali Acc: 0.675 Test Loss: 1.157 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7128989696502686
Epoch: 30, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.161 Vali Acc: 0.675 Test Loss: 1.161 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6698718070983887
Epoch: 31, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.165 Vali Acc: 0.675 Test Loss: 1.165 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7707436084747314
Epoch: 32, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.169 Vali Acc: 0.675 Test Loss: 1.169 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6587178707122803
Epoch: 33, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.169 Vali Acc: 0.650 Test Loss: 1.169 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 69508
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.253538131713867
Epoch: 1, Steps: 3 | Train Loss: 1.584 Vali Loss: 1.677 Vali Acc: 0.300 Test Loss: 1.677 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 0.6534342765808105
Epoch: 2, Steps: 3 | Train Loss: 1.622 Vali Loss: 1.636 Vali Acc: 0.325 Test Loss: 1.636 Test Acc: 0.325
Validation loss decreased (-0.299983 --> -0.324984).  Saving model ...
Epoch: 3 cost time: 0.5937113761901855
Epoch: 3, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.599 Vali Acc: 0.350 Test Loss: 1.599 Test Acc: 0.350
Validation loss decreased (-0.324984 --> -0.349984).  Saving model ...
Epoch: 4 cost time: 0.6578395366668701
Epoch: 4, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.558 Vali Acc: 0.350 Test Loss: 1.558 Test Acc: 0.350
Validation loss decreased (-0.349984 --> -0.349984).  Saving model ...
Epoch: 5 cost time: 0.7224521636962891
Epoch: 5, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.519 Vali Acc: 0.400 Test Loss: 1.519 Test Acc: 0.400
Validation loss decreased (-0.349984 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 0.6172990798950195
Epoch: 6, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.482 Vali Acc: 0.425 Test Loss: 1.482 Test Acc: 0.425
Validation loss decreased (-0.399985 --> -0.424985).  Saving model ...
Epoch: 7 cost time: 0.6288726329803467
Epoch: 7, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.445 Vali Acc: 0.475 Test Loss: 1.445 Test Acc: 0.475
Validation loss decreased (-0.424985 --> -0.474986).  Saving model ...
Epoch: 8 cost time: 0.5729188919067383
Epoch: 8, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.413 Vali Acc: 0.450 Test Loss: 1.413 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5347373485565186
Epoch: 9, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.384 Vali Acc: 0.475 Test Loss: 1.384 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 10 cost time: 0.6809535026550293
Epoch: 10, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.359 Vali Acc: 0.450 Test Loss: 1.359 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6079740524291992
Epoch: 11, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.330 Vali Acc: 0.475 Test Loss: 1.330 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 0.6730444431304932
Epoch: 12, Steps: 3 | Train Loss: 0.671 Vali Loss: 1.311 Vali Acc: 0.475 Test Loss: 1.311 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 13 cost time: 0.6305160522460938
Epoch: 13, Steps: 3 | Train Loss: 0.658 Vali Loss: 1.295 Vali Acc: 0.475 Test Loss: 1.295 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 14 cost time: 0.6004848480224609
Epoch: 14, Steps: 3 | Train Loss: 0.553 Vali Loss: 1.276 Vali Acc: 0.500 Test Loss: 1.276 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 15 cost time: 0.6035096645355225
Epoch: 15, Steps: 3 | Train Loss: 0.466 Vali Loss: 1.261 Vali Acc: 0.500 Test Loss: 1.261 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 16 cost time: 0.6172411441802979
Epoch: 16, Steps: 3 | Train Loss: 0.451 Vali Loss: 1.247 Vali Acc: 0.575 Test Loss: 1.247 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 17 cost time: 0.6497373580932617
Epoch: 17, Steps: 3 | Train Loss: 0.383 Vali Loss: 1.236 Vali Acc: 0.575 Test Loss: 1.236 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 18 cost time: 0.6861376762390137
Epoch: 18, Steps: 3 | Train Loss: 0.335 Vali Loss: 1.222 Vali Acc: 0.575 Test Loss: 1.222 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.6924433708190918
Epoch: 19, Steps: 3 | Train Loss: 0.242 Vali Loss: 1.206 Vali Acc: 0.575 Test Loss: 1.206 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.6880390644073486
Epoch: 20, Steps: 3 | Train Loss: 0.265 Vali Loss: 1.198 Vali Acc: 0.575 Test Loss: 1.198 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.61053466796875
Epoch: 21, Steps: 3 | Train Loss: 0.239 Vali Loss: 1.194 Vali Acc: 0.600 Test Loss: 1.194 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 0.5611250400543213
Epoch: 22, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.195 Vali Acc: 0.600 Test Loss: 1.195 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6682758331298828
Epoch: 23, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.203 Vali Acc: 0.600 Test Loss: 1.203 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.57753586769104
Epoch: 24, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.214 Vali Acc: 0.625 Test Loss: 1.214 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 25 cost time: 0.637662410736084
Epoch: 25, Steps: 3 | Train Loss: 0.110 Vali Loss: 1.228 Vali Acc: 0.650 Test Loss: 1.228 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 26 cost time: 0.6729838848114014
Epoch: 26, Steps: 3 | Train Loss: 0.091 Vali Loss: 1.236 Vali Acc: 0.650 Test Loss: 1.236 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7485008239746094
Epoch: 27, Steps: 3 | Train Loss: 0.082 Vali Loss: 1.246 Vali Acc: 0.650 Test Loss: 1.246 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5995099544525146
Epoch: 28, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.254 Vali Acc: 0.650 Test Loss: 1.254 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6034030914306641
Epoch: 29, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.259 Vali Acc: 0.650 Test Loss: 1.259 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.571077823638916
Epoch: 30, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.259 Vali Acc: 0.650 Test Loss: 1.259 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6892859935760498
Epoch: 31, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.268 Vali Acc: 0.650 Test Loss: 1.268 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6545202732086182
Epoch: 32, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.273 Vali Acc: 0.650 Test Loss: 1.273 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6234438419342041
Epoch: 33, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.277 Vali Acc: 0.650 Test Loss: 1.277 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7101254463195801
Epoch: 34, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.285 Vali Acc: 0.650 Test Loss: 1.285 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7163040637969971
Epoch: 35, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.291 Vali Acc: 0.650 Test Loss: 1.291 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 66756
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.381671190261841
Epoch: 1, Steps: 3 | Train Loss: 1.640 Vali Loss: 1.479 Vali Acc: 0.225 Test Loss: 1.479 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.5819728374481201
Epoch: 2, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.454 Vali Acc: 0.250 Test Loss: 1.454 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.590104341506958
Epoch: 3, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.436 Vali Acc: 0.275 Test Loss: 1.436 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.6007544994354248
Epoch: 4, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.420 Vali Acc: 0.325 Test Loss: 1.420 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.5763354301452637
Epoch: 5, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.402 Vali Acc: 0.350 Test Loss: 1.402 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.618746280670166
Epoch: 6, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.385 Vali Acc: 0.325 Test Loss: 1.385 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6513528823852539
Epoch: 7, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.366 Vali Acc: 0.300 Test Loss: 1.366 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5058860778808594
Epoch: 8, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.347 Vali Acc: 0.350 Test Loss: 1.347 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 9 cost time: 0.6010191440582275
Epoch: 9, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.327 Vali Acc: 0.400 Test Loss: 1.327 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 0.5946571826934814
Epoch: 10, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.307 Vali Acc: 0.400 Test Loss: 1.307 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.5395734310150146
Epoch: 11, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.289 Vali Acc: 0.425 Test Loss: 1.289 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 12 cost time: 0.6016232967376709
Epoch: 12, Steps: 3 | Train Loss: 0.742 Vali Loss: 1.275 Vali Acc: 0.425 Test Loss: 1.275 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 0.6097812652587891
Epoch: 13, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.261 Vali Acc: 0.375 Test Loss: 1.261 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5772969722747803
Epoch: 14, Steps: 3 | Train Loss: 0.697 Vali Loss: 1.246 Vali Acc: 0.425 Test Loss: 1.246 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 15 cost time: 0.6032228469848633
Epoch: 15, Steps: 3 | Train Loss: 0.652 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5774955749511719
Epoch: 16, Steps: 3 | Train Loss: 0.589 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5895440578460693
Epoch: 17, Steps: 3 | Train Loss: 0.553 Vali Loss: 1.211 Vali Acc: 0.425 Test Loss: 1.211 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 18 cost time: 0.6994132995605469
Epoch: 18, Steps: 3 | Train Loss: 0.505 Vali Loss: 1.203 Vali Acc: 0.425 Test Loss: 1.203 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 19 cost time: 0.6381356716156006
Epoch: 19, Steps: 3 | Train Loss: 0.382 Vali Loss: 1.195 Vali Acc: 0.425 Test Loss: 1.195 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 20 cost time: 0.6094489097595215
Epoch: 20, Steps: 3 | Train Loss: 0.388 Vali Loss: 1.187 Vali Acc: 0.525 Test Loss: 1.187 Test Acc: 0.525
Validation loss decreased (-0.424988 --> -0.524988).  Saving model ...
Epoch: 21 cost time: 0.5277197360992432
Epoch: 21, Steps: 3 | Train Loss: 0.323 Vali Loss: 1.183 Vali Acc: 0.525 Test Loss: 1.183 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 22 cost time: 0.607067346572876
Epoch: 22, Steps: 3 | Train Loss: 0.289 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5720515251159668
Epoch: 23, Steps: 3 | Train Loss: 0.244 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6063144207000732
Epoch: 24, Steps: 3 | Train Loss: 0.228 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5873246192932129
Epoch: 25, Steps: 3 | Train Loss: 0.245 Vali Loss: 1.169 Vali Acc: 0.525 Test Loss: 1.169 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 26 cost time: 0.6415600776672363
Epoch: 26, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.170 Vali Acc: 0.575 Test Loss: 1.170 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 27 cost time: 0.5455973148345947
Epoch: 27, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.171 Vali Acc: 0.600 Test Loss: 1.171 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 28 cost time: 0.5620737075805664
Epoch: 28, Steps: 3 | Train Loss: 0.144 Vali Loss: 1.171 Vali Acc: 0.600 Test Loss: 1.171 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5502409934997559
Epoch: 29, Steps: 3 | Train Loss: 0.117 Vali Loss: 1.173 Vali Acc: 0.600 Test Loss: 1.173 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5780177116394043
Epoch: 30, Steps: 3 | Train Loss: 0.097 Vali Loss: 1.174 Vali Acc: 0.625 Test Loss: 1.174 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 31 cost time: 0.574495792388916
Epoch: 31, Steps: 3 | Train Loss: 0.107 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5668590068817139
Epoch: 32, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5658681392669678
Epoch: 33, Steps: 3 | Train Loss: 0.074 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5632021427154541
Epoch: 34, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.180 Vali Acc: 0.625 Test Loss: 1.180 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5437319278717041
Epoch: 35, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.181 Vali Acc: 0.625 Test Loss: 1.181 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5235037803649902
Epoch: 36, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.187 Vali Acc: 0.625 Test Loss: 1.187 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6586959362030029
Epoch: 37, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.193 Vali Acc: 0.625 Test Loss: 1.193 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7004568576812744
Epoch: 38, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.196 Vali Acc: 0.625 Test Loss: 1.196 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6904771327972412
Epoch: 39, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.200 Vali Acc: 0.625 Test Loss: 1.200 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6438107490539551
Epoch: 40, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.208 Vali Acc: 0.625 Test Loss: 1.208 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df256_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 62468
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.31744122505188
Epoch: 1, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.344 Vali Acc: 0.300 Test Loss: 1.344 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.6508831977844238
Epoch: 2, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.300 Vali Acc: 0.475 Test Loss: 1.300 Test Acc: 0.475
Validation loss decreased (-0.299987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.5973708629608154
Epoch: 3, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.253 Vali Acc: 0.550 Test Loss: 1.253 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 0.6532042026519775
Epoch: 4, Steps: 3 | Train Loss: 0.999 Vali Loss: 1.202 Vali Acc: 0.475 Test Loss: 1.202 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5762274265289307
Epoch: 5, Steps: 3 | Train Loss: 0.893 Vali Loss: 1.119 Vali Acc: 0.575 Test Loss: 1.119 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.6380527019500732
Epoch: 6, Steps: 3 | Train Loss: 0.712 Vali Loss: 1.038 Vali Acc: 0.650 Test Loss: 1.038 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 7 cost time: 0.6278362274169922
Epoch: 7, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.935 Vali Acc: 0.675 Test Loss: 0.935 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 8 cost time: 0.7361693382263184
Epoch: 8, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.883 Vali Acc: 0.650 Test Loss: 0.883 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6328346729278564
Epoch: 9, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.890 Vali Acc: 0.650 Test Loss: 0.890 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7178070545196533
Epoch: 10, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.847 Vali Acc: 0.700 Test Loss: 0.847 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699992).  Saving model ...
Epoch: 11 cost time: 0.7838289737701416
Epoch: 11, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.784 Vali Acc: 0.750 Test Loss: 0.784 Test Acc: 0.750
Validation loss decreased (-0.699992 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 0.7500483989715576
Epoch: 12, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.763 Vali Acc: 0.800 Test Loss: 0.763 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 0.7345399856567383
Epoch: 13, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.765 Vali Acc: 0.800 Test Loss: 0.765 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8507950305938721
Epoch: 14, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6971182823181152
Epoch: 15, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.802 Vali Acc: 0.775 Test Loss: 0.802 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6419072151184082
Epoch: 16, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7302827835083008
Epoch: 17, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.836 Vali Acc: 0.800 Test Loss: 0.836 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6903343200683594
Epoch: 18, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.835 Vali Acc: 0.800 Test Loss: 0.835 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6810801029205322
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.833 Vali Acc: 0.800 Test Loss: 0.833 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6657333374023438
Epoch: 20, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.831 Vali Acc: 0.800 Test Loss: 0.831 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8811988830566406
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.831 Vali Acc: 0.800 Test Loss: 0.831 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7584655284881592
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.829 Vali Acc: 0.800 Test Loss: 0.829 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 110596
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.563234806060791
Epoch: 1, Steps: 3 | Train Loss: 1.533 Vali Loss: 1.441 Vali Acc: 0.300 Test Loss: 1.441 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6836404800415039
Epoch: 2, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.401 Vali Acc: 0.275 Test Loss: 1.401 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5680136680603027
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.345 Vali Acc: 0.325 Test Loss: 1.345 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.534210205078125
Epoch: 4, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.279 Vali Acc: 0.350 Test Loss: 1.279 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.6510820388793945
Epoch: 5, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.211 Vali Acc: 0.350 Test Loss: 1.211 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349988).  Saving model ...
Epoch: 6 cost time: 0.7476110458374023
Epoch: 6, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.156 Vali Acc: 0.450 Test Loss: 1.156 Test Acc: 0.450
Validation loss decreased (-0.349988 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 0.625629186630249
Epoch: 7, Steps: 3 | Train Loss: 0.727 Vali Loss: 1.106 Vali Acc: 0.525 Test Loss: 1.106 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524989).  Saving model ...
Epoch: 8 cost time: 0.5844943523406982
Epoch: 8, Steps: 3 | Train Loss: 0.540 Vali Loss: 1.052 Vali Acc: 0.575 Test Loss: 1.052 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.6738238334655762
Epoch: 9, Steps: 3 | Train Loss: 0.583 Vali Loss: 1.009 Vali Acc: 0.575 Test Loss: 1.009 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 10 cost time: 0.6704437732696533
Epoch: 10, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.965 Vali Acc: 0.650 Test Loss: 0.965 Test Acc: 0.650
Validation loss decreased (-0.574990 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.6279802322387695
Epoch: 11, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.936 Vali Acc: 0.675 Test Loss: 0.936 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 12 cost time: 0.611713171005249
Epoch: 12, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.913 Vali Acc: 0.700 Test Loss: 0.913 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 0.4935154914855957
Epoch: 13, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.889 Vali Acc: 0.700 Test Loss: 0.889 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 0.5625793933868408
Epoch: 14, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.870 Vali Acc: 0.700 Test Loss: 0.870 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 0.6237087249755859
Epoch: 15, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.867 Vali Acc: 0.725 Test Loss: 0.867 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 0.6450953483581543
Epoch: 16, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.567880392074585
Epoch: 17, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.851 Vali Acc: 0.750 Test Loss: 0.851 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 0.6095173358917236
Epoch: 18, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.854 Vali Acc: 0.750 Test Loss: 0.854 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6362173557281494
Epoch: 19, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7721817493438721
Epoch: 20, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6182775497436523
Epoch: 21, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.875 Vali Acc: 0.750 Test Loss: 0.875 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6280097961425781
Epoch: 22, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7031641006469727
Epoch: 23, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.889 Vali Acc: 0.750 Test Loss: 0.889 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6068875789642334
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.890 Vali Acc: 0.750 Test Loss: 0.890 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5868091583251953
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7125124931335449
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.892 Vali Acc: 0.725 Test Loss: 0.892 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7334818840026855
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.893 Vali Acc: 0.725 Test Loss: 0.893 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 84612
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.267730951309204
Epoch: 1, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.531 Vali Acc: 0.175 Test Loss: 1.531 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.6394624710083008
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.507 Vali Acc: 0.200 Test Loss: 1.507 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.6748144626617432
Epoch: 3, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.472 Vali Acc: 0.250 Test Loss: 1.472 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 0.6186411380767822
Epoch: 4, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.439 Vali Acc: 0.300 Test Loss: 1.439 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.6581182479858398
Epoch: 5, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.402 Vali Acc: 0.425 Test Loss: 1.402 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 0.6089813709259033
Epoch: 6, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.360 Vali Acc: 0.450 Test Loss: 1.360 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 7 cost time: 0.5921928882598877
Epoch: 7, Steps: 3 | Train Loss: 0.728 Vali Loss: 1.320 Vali Acc: 0.425 Test Loss: 1.320 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6448538303375244
Epoch: 8, Steps: 3 | Train Loss: 0.645 Vali Loss: 1.273 Vali Acc: 0.475 Test Loss: 1.273 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.6442968845367432
Epoch: 9, Steps: 3 | Train Loss: 0.565 Vali Loss: 1.217 Vali Acc: 0.525 Test Loss: 1.217 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 0.7621574401855469
Epoch: 10, Steps: 3 | Train Loss: 0.431 Vali Loss: 1.181 Vali Acc: 0.575 Test Loss: 1.181 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 0.6777493953704834
Epoch: 11, Steps: 3 | Train Loss: 0.318 Vali Loss: 1.152 Vali Acc: 0.600 Test Loss: 1.152 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 0.6227691173553467
Epoch: 12, Steps: 3 | Train Loss: 0.253 Vali Loss: 1.122 Vali Acc: 0.625 Test Loss: 1.122 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.6407232284545898
Epoch: 13, Steps: 3 | Train Loss: 0.198 Vali Loss: 1.084 Vali Acc: 0.675 Test Loss: 1.084 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 14 cost time: 0.656604528427124
Epoch: 14, Steps: 3 | Train Loss: 0.148 Vali Loss: 1.068 Vali Acc: 0.675 Test Loss: 1.068 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 15 cost time: 0.655522346496582
Epoch: 15, Steps: 3 | Train Loss: 0.135 Vali Loss: 1.079 Vali Acc: 0.700 Test Loss: 1.079 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.6951897144317627
Epoch: 16, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6698105335235596
Epoch: 17, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.093 Vali Acc: 0.675 Test Loss: 1.093 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7340166568756104
Epoch: 18, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.104 Vali Acc: 0.675 Test Loss: 1.104 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6800003051757812
Epoch: 19, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.113 Vali Acc: 0.675 Test Loss: 1.113 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6566901206970215
Epoch: 20, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.130 Vali Acc: 0.675 Test Loss: 1.130 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6555356979370117
Epoch: 21, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.145 Vali Acc: 0.675 Test Loss: 1.145 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6359472274780273
Epoch: 22, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.161 Vali Acc: 0.675 Test Loss: 1.161 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6712844371795654
Epoch: 23, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.180 Vali Acc: 0.675 Test Loss: 1.180 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6643121242523193
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.194 Vali Acc: 0.675 Test Loss: 1.194 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5961277484893799
Epoch: 25, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.203 Vali Acc: 0.675 Test Loss: 1.203 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 72516
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1392974853515625
Epoch: 1, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.509 Vali Acc: 0.200 Test Loss: 1.509 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.5480554103851318
Epoch: 2, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.486 Vali Acc: 0.275 Test Loss: 1.486 Test Acc: 0.275
Validation loss decreased (-0.199985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.6170186996459961
Epoch: 3, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.458 Vali Acc: 0.275 Test Loss: 1.458 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 0.5041422843933105
Epoch: 4, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.420 Vali Acc: 0.275 Test Loss: 1.420 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.6105177402496338
Epoch: 5, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.5310919284820557
Epoch: 6, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.329 Vali Acc: 0.425 Test Loss: 1.329 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.5017712116241455
Epoch: 7, Steps: 3 | Train Loss: 0.839 Vali Loss: 1.293 Vali Acc: 0.425 Test Loss: 1.293 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.5458450317382812
Epoch: 8, Steps: 3 | Train Loss: 0.693 Vali Loss: 1.259 Vali Acc: 0.450 Test Loss: 1.259 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.6692807674407959
Epoch: 9, Steps: 3 | Train Loss: 0.664 Vali Loss: 1.229 Vali Acc: 0.575 Test Loss: 1.229 Test Acc: 0.575
Validation loss decreased (-0.449987 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.6449129581451416
Epoch: 10, Steps: 3 | Train Loss: 0.613 Vali Loss: 1.213 Vali Acc: 0.625 Test Loss: 1.213 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 11 cost time: 0.6035089492797852
Epoch: 11, Steps: 3 | Train Loss: 0.479 Vali Loss: 1.197 Vali Acc: 0.650 Test Loss: 1.197 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 0.6774067878723145
Epoch: 12, Steps: 3 | Train Loss: 0.411 Vali Loss: 1.177 Vali Acc: 0.650 Test Loss: 1.177 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 13 cost time: 0.6601114273071289
Epoch: 13, Steps: 3 | Train Loss: 0.319 Vali Loss: 1.163 Vali Acc: 0.650 Test Loss: 1.163 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 0.7311267852783203
Epoch: 14, Steps: 3 | Train Loss: 0.262 Vali Loss: 1.144 Vali Acc: 0.650 Test Loss: 1.144 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 0.5902070999145508
Epoch: 15, Steps: 3 | Train Loss: 0.201 Vali Loss: 1.137 Vali Acc: 0.650 Test Loss: 1.137 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 0.6180992126464844
Epoch: 16, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.153 Vali Acc: 0.625 Test Loss: 1.153 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6441864967346191
Epoch: 17, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.162 Vali Acc: 0.625 Test Loss: 1.162 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6247069835662842
Epoch: 18, Steps: 3 | Train Loss: 0.098 Vali Loss: 1.164 Vali Acc: 0.650 Test Loss: 1.164 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5629403591156006
Epoch: 19, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.163 Vali Acc: 0.650 Test Loss: 1.163 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6120176315307617
Epoch: 20, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.168 Vali Acc: 0.675 Test Loss: 1.168 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674988).  Saving model ...
Epoch: 21 cost time: 0.6392292976379395
Epoch: 21, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.167 Vali Acc: 0.675 Test Loss: 1.167 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 22 cost time: 0.7030138969421387
Epoch: 22, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.171 Vali Acc: 0.675 Test Loss: 1.171 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5928401947021484
Epoch: 23, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.183 Vali Acc: 0.675 Test Loss: 1.183 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6785149574279785
Epoch: 24, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.194 Vali Acc: 0.675 Test Loss: 1.194 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6482155323028564
Epoch: 25, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.204 Vali Acc: 0.675 Test Loss: 1.204 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7504384517669678
Epoch: 26, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.214 Vali Acc: 0.675 Test Loss: 1.214 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6541836261749268
Epoch: 27, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.216 Vali Acc: 0.675 Test Loss: 1.216 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5736043453216553
Epoch: 28, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.217 Vali Acc: 0.675 Test Loss: 1.217 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.615863561630249
Epoch: 29, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.219 Vali Acc: 0.675 Test Loss: 1.219 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.654827356338501
Epoch: 30, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.221 Vali Acc: 0.675 Test Loss: 1.221 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7035727500915527
Epoch: 31, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.219 Vali Acc: 0.675 Test Loss: 1.219 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 64964
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.332909107208252
Epoch: 1, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.442 Vali Acc: 0.300 Test Loss: 1.442 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5585103034973145
Epoch: 2, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.437 Vali Acc: 0.300 Test Loss: 1.437 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.5968477725982666
Epoch: 3, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.430 Vali Acc: 0.300 Test Loss: 1.430 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.5506680011749268
Epoch: 4, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.417 Vali Acc: 0.325 Test Loss: 1.417 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.6429135799407959
Epoch: 5, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.401 Vali Acc: 0.375 Test Loss: 1.401 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.5319809913635254
Epoch: 6, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.378 Vali Acc: 0.375 Test Loss: 1.378 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.6469664573669434
Epoch: 7, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.355 Vali Acc: 0.400 Test Loss: 1.355 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 0.5754590034484863
Epoch: 8, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.329 Vali Acc: 0.425 Test Loss: 1.329 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.5910689830780029
Epoch: 9, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.309 Vali Acc: 0.425 Test Loss: 1.309 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.6728379726409912
Epoch: 10, Steps: 3 | Train Loss: 0.851 Vali Loss: 1.291 Vali Acc: 0.450 Test Loss: 1.291 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.8488318920135498
Epoch: 11, Steps: 3 | Train Loss: 0.652 Vali Loss: 1.270 Vali Acc: 0.450 Test Loss: 1.270 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.7214171886444092
Epoch: 12, Steps: 3 | Train Loss: 0.640 Vali Loss: 1.243 Vali Acc: 0.450 Test Loss: 1.243 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 13 cost time: 0.7218117713928223
Epoch: 13, Steps: 3 | Train Loss: 0.637 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.742119312286377
Epoch: 14, Steps: 3 | Train Loss: 0.490 Vali Loss: 1.193 Vali Acc: 0.525 Test Loss: 1.193 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 0.6879651546478271
Epoch: 15, Steps: 3 | Train Loss: 0.448 Vali Loss: 1.172 Vali Acc: 0.575 Test Loss: 1.172 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 16 cost time: 0.7283055782318115
Epoch: 16, Steps: 3 | Train Loss: 0.373 Vali Loss: 1.155 Vali Acc: 0.575 Test Loss: 1.155 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 17 cost time: 0.6818325519561768
Epoch: 17, Steps: 3 | Train Loss: 0.326 Vali Loss: 1.146 Vali Acc: 0.575 Test Loss: 1.146 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 0.7004964351654053
Epoch: 18, Steps: 3 | Train Loss: 0.265 Vali Loss: 1.137 Vali Acc: 0.550 Test Loss: 1.137 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7455534934997559
Epoch: 19, Steps: 3 | Train Loss: 0.247 Vali Loss: 1.132 Vali Acc: 0.550 Test Loss: 1.132 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6944637298583984
Epoch: 20, Steps: 3 | Train Loss: 0.226 Vali Loss: 1.132 Vali Acc: 0.550 Test Loss: 1.132 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7433409690856934
Epoch: 21, Steps: 3 | Train Loss: 0.183 Vali Loss: 1.130 Vali Acc: 0.550 Test Loss: 1.130 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7260563373565674
Epoch: 22, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.127 Vali Acc: 0.575 Test Loss: 1.127 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 23 cost time: 0.6582634449005127
Epoch: 23, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.126 Vali Acc: 0.575 Test Loss: 1.126 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 24 cost time: 0.7300810813903809
Epoch: 24, Steps: 3 | Train Loss: 0.110 Vali Loss: 1.134 Vali Acc: 0.625 Test Loss: 1.134 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 25 cost time: 0.7180819511413574
Epoch: 25, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.150 Vali Acc: 0.625 Test Loss: 1.150 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7106118202209473
Epoch: 26, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.159 Vali Acc: 0.600 Test Loss: 1.159 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7033941745758057
Epoch: 27, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.168 Vali Acc: 0.600 Test Loss: 1.168 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8805787563323975
Epoch: 28, Steps: 3 | Train Loss: 0.060 Vali Loss: 1.171 Vali Acc: 0.600 Test Loss: 1.171 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7374117374420166
Epoch: 29, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.165 Vali Acc: 0.600 Test Loss: 1.165 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8010234832763672
Epoch: 30, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.158 Vali Acc: 0.650 Test Loss: 1.158 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649988).  Saving model ...
Epoch: 31 cost time: 0.8277857303619385
Epoch: 31, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.153 Vali Acc: 0.650 Test Loss: 1.153 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 32 cost time: 0.8629653453826904
Epoch: 32, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.148 Vali Acc: 0.650 Test Loss: 1.148 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 33 cost time: 0.7620844841003418
Epoch: 33, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.142 Vali Acc: 0.650 Test Loss: 1.142 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 34 cost time: 0.7641236782073975
Epoch: 34, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.140 Vali Acc: 0.650 Test Loss: 1.140 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 35 cost time: 0.7458031177520752
Epoch: 35, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.139 Vali Acc: 0.650 Test Loss: 1.139 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 36 cost time: 0.693845272064209
Epoch: 36, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.140 Vali Acc: 0.650 Test Loss: 1.140 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.719353199005127
Epoch: 37, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.144 Vali Acc: 0.650 Test Loss: 1.144 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7303519248962402
Epoch: 38, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.149 Vali Acc: 0.650 Test Loss: 1.149 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8102986812591553
Epoch: 39, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.154 Vali Acc: 0.650 Test Loss: 1.154 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.814683198928833
Epoch: 40, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.156 Vali Acc: 0.650 Test Loss: 1.156 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7004458904266357
Epoch: 41, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.160 Vali Acc: 0.650 Test Loss: 1.160 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7484042644500732
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.166 Vali Acc: 0.675 Test Loss: 1.166 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674988).  Saving model ...
Epoch: 43 cost time: 0.7076845169067383
Epoch: 43, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.169 Vali Acc: 0.675 Test Loss: 1.169 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6821818351745605
Epoch: 44, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.170 Vali Acc: 0.675 Test Loss: 1.170 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7832901477813721
Epoch: 45, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.172 Vali Acc: 0.675 Test Loss: 1.172 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7255182266235352
Epoch: 46, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.175 Vali Acc: 0.675 Test Loss: 1.175 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7220518589019775
Epoch: 47, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.178 Vali Acc: 0.700 Test Loss: 1.178 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699988).  Saving model ...
Epoch: 48 cost time: 0.8416130542755127
Epoch: 48, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.179 Vali Acc: 0.700 Test Loss: 1.179 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6708056926727295
Epoch: 49, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.182 Vali Acc: 0.700 Test Loss: 1.182 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8086273670196533
Epoch: 50, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.184 Vali Acc: 0.700 Test Loss: 1.184 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6320197582244873
Epoch: 51, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.187 Vali Acc: 0.700 Test Loss: 1.187 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.8933331966400146
Epoch: 52, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.189 Vali Acc: 0.700 Test Loss: 1.189 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.6582987308502197
Epoch: 53, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.190 Vali Acc: 0.700 Test Loss: 1.190 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6555099487304688
Epoch: 54, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.192 Vali Acc: 0.700 Test Loss: 1.192 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6118042469024658
Epoch: 55, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.196 Vali Acc: 0.675 Test Loss: 1.196 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.7103269100189209
Epoch: 56, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.199 Vali Acc: 0.700 Test Loss: 1.199 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.5643305778503418
Epoch: 57, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.202 Vali Acc: 0.700 Test Loss: 1.202 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 52996
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.332834005355835
Epoch: 1, Steps: 3 | Train Loss: 1.524 Vali Loss: 1.315 Vali Acc: 0.400 Test Loss: 1.315 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.6211934089660645
Epoch: 2, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.303 Vali Acc: 0.475 Test Loss: 1.303 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.6819093227386475
Epoch: 3, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.291 Vali Acc: 0.475 Test Loss: 1.291 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.5802757740020752
Epoch: 4, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.271 Vali Acc: 0.475 Test Loss: 1.271 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.5647022724151611
Epoch: 5, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.249 Vali Acc: 0.475 Test Loss: 1.249 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.6410706043243408
Epoch: 6, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.225 Vali Acc: 0.525 Test Loss: 1.225 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.6789236068725586
Epoch: 7, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.6895599365234375
Epoch: 8, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.181 Vali Acc: 0.575 Test Loss: 1.181 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6687171459197998
Epoch: 9, Steps: 3 | Train Loss: 1.024 Vali Loss: 1.161 Vali Acc: 0.575 Test Loss: 1.161 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5644006729125977
Epoch: 10, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.145 Vali Acc: 0.600 Test Loss: 1.145 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.5953633785247803
Epoch: 11, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.131 Vali Acc: 0.625 Test Loss: 1.131 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.5764353275299072
Epoch: 12, Steps: 3 | Train Loss: 0.747 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.6236560344696045
Epoch: 13, Steps: 3 | Train Loss: 0.583 Vali Loss: 1.105 Vali Acc: 0.625 Test Loss: 1.105 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.5941753387451172
Epoch: 14, Steps: 3 | Train Loss: 0.563 Vali Loss: 1.094 Vali Acc: 0.625 Test Loss: 1.094 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.5219480991363525
Epoch: 15, Steps: 3 | Train Loss: 0.529 Vali Loss: 1.086 Vali Acc: 0.625 Test Loss: 1.086 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 16 cost time: 0.631140947341919
Epoch: 16, Steps: 3 | Train Loss: 0.530 Vali Loss: 1.082 Vali Acc: 0.625 Test Loss: 1.082 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 0.550875186920166
Epoch: 17, Steps: 3 | Train Loss: 0.351 Vali Loss: 1.077 Vali Acc: 0.650 Test Loss: 1.077 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 0.5969107151031494
Epoch: 18, Steps: 3 | Train Loss: 0.334 Vali Loss: 1.075 Vali Acc: 0.675 Test Loss: 1.075 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 19 cost time: 0.6579422950744629
Epoch: 19, Steps: 3 | Train Loss: 0.276 Vali Loss: 1.071 Vali Acc: 0.650 Test Loss: 1.071 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6678061485290527
Epoch: 20, Steps: 3 | Train Loss: 0.336 Vali Loss: 1.061 Vali Acc: 0.650 Test Loss: 1.061 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6617963314056396
Epoch: 21, Steps: 3 | Train Loss: 0.240 Vali Loss: 1.058 Vali Acc: 0.650 Test Loss: 1.058 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7123486995697021
Epoch: 22, Steps: 3 | Train Loss: 0.169 Vali Loss: 1.059 Vali Acc: 0.650 Test Loss: 1.059 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7234861850738525
Epoch: 23, Steps: 3 | Train Loss: 0.145 Vali Loss: 1.061 Vali Acc: 0.650 Test Loss: 1.061 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.583655595779419
Epoch: 24, Steps: 3 | Train Loss: 0.149 Vali Loss: 1.066 Vali Acc: 0.650 Test Loss: 1.066 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5911188125610352
Epoch: 25, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.075 Vali Acc: 0.675 Test Loss: 1.075 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6154022216796875
Epoch: 26, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.090 Vali Acc: 0.700 Test Loss: 1.090 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 27 cost time: 0.7008717060089111
Epoch: 27, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.110 Vali Acc: 0.700 Test Loss: 1.110 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8062694072723389
Epoch: 28, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.130 Vali Acc: 0.700 Test Loss: 1.130 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7698342800140381
Epoch: 29, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.149 Vali Acc: 0.700 Test Loss: 1.149 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6295690536499023
Epoch: 30, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.163 Vali Acc: 0.700 Test Loss: 1.163 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6185247898101807
Epoch: 31, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.174 Vali Acc: 0.700 Test Loss: 1.174 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5887553691864014
Epoch: 32, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.178 Vali Acc: 0.700 Test Loss: 1.178 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5769057273864746
Epoch: 33, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.178 Vali Acc: 0.700 Test Loss: 1.178 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6591265201568604
Epoch: 34, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.180 Vali Acc: 0.700 Test Loss: 1.180 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5965373516082764
Epoch: 35, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.179 Vali Acc: 0.700 Test Loss: 1.179 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8517980575561523
Epoch: 36, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.178 Vali Acc: 0.700 Test Loss: 1.178 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 50244
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.260773181915283
Epoch: 1, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.358 Vali Acc: 0.275 Test Loss: 1.358 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.70416259765625
Epoch: 2, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.332 Vali Acc: 0.275 Test Loss: 1.332 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.5786774158477783
Epoch: 3, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.311 Vali Acc: 0.350 Test Loss: 1.311 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.6113038063049316
Epoch: 4, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.290 Vali Acc: 0.375 Test Loss: 1.290 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.5510015487670898
Epoch: 5, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.269 Vali Acc: 0.375 Test Loss: 1.269 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.6124663352966309
Epoch: 6, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.6160426139831543
Epoch: 7, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.228 Vali Acc: 0.425 Test Loss: 1.228 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 0.6636643409729004
Epoch: 8, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.211 Vali Acc: 0.475 Test Loss: 1.211 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.6380534172058105
Epoch: 9, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.193 Vali Acc: 0.475 Test Loss: 1.193 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 0.6015715599060059
Epoch: 10, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.177 Vali Acc: 0.475 Test Loss: 1.177 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.5947475433349609
Epoch: 11, Steps: 3 | Train Loss: 0.795 Vali Loss: 1.162 Vali Acc: 0.475 Test Loss: 1.162 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 12 cost time: 0.5931270122528076
Epoch: 12, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.151 Vali Acc: 0.475 Test Loss: 1.151 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 0.7719228267669678
Epoch: 13, Steps: 3 | Train Loss: 0.678 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 0.6378400325775146
Epoch: 14, Steps: 3 | Train Loss: 0.620 Vali Loss: 1.126 Vali Acc: 0.525 Test Loss: 1.126 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 15 cost time: 0.657801628112793
Epoch: 15, Steps: 3 | Train Loss: 0.613 Vali Loss: 1.117 Vali Acc: 0.550 Test Loss: 1.117 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 16 cost time: 0.7179927825927734
Epoch: 16, Steps: 3 | Train Loss: 0.566 Vali Loss: 1.111 Vali Acc: 0.525 Test Loss: 1.111 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5970761775970459
Epoch: 17, Steps: 3 | Train Loss: 0.483 Vali Loss: 1.103 Vali Acc: 0.550 Test Loss: 1.103 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 18 cost time: 0.5884349346160889
Epoch: 18, Steps: 3 | Train Loss: 0.432 Vali Loss: 1.093 Vali Acc: 0.550 Test Loss: 1.093 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 19 cost time: 0.5678870677947998
Epoch: 19, Steps: 3 | Train Loss: 0.417 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.5904068946838379
Epoch: 20, Steps: 3 | Train Loss: 0.411 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 0.566617488861084
Epoch: 21, Steps: 3 | Train Loss: 0.315 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.7062287330627441
Epoch: 22, Steps: 3 | Train Loss: 0.287 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.6954200267791748
Epoch: 23, Steps: 3 | Train Loss: 0.255 Vali Loss: 1.070 Vali Acc: 0.625 Test Loss: 1.070 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 24 cost time: 0.6428523063659668
Epoch: 24, Steps: 3 | Train Loss: 0.214 Vali Loss: 1.067 Vali Acc: 0.625 Test Loss: 1.067 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 25 cost time: 0.622521162033081
Epoch: 25, Steps: 3 | Train Loss: 0.196 Vali Loss: 1.064 Vali Acc: 0.625 Test Loss: 1.064 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 26 cost time: 0.5359904766082764
Epoch: 26, Steps: 3 | Train Loss: 0.181 Vali Loss: 1.059 Vali Acc: 0.625 Test Loss: 1.059 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 27 cost time: 0.6403377056121826
Epoch: 27, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.060 Vali Acc: 0.625 Test Loss: 1.060 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6125564575195312
Epoch: 28, Steps: 3 | Train Loss: 0.122 Vali Loss: 1.066 Vali Acc: 0.650 Test Loss: 1.066 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 29 cost time: 0.6328935623168945
Epoch: 29, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.072 Vali Acc: 0.650 Test Loss: 1.072 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5798807144165039
Epoch: 30, Steps: 3 | Train Loss: 0.106 Vali Loss: 1.076 Vali Acc: 0.650 Test Loss: 1.076 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.681105375289917
Epoch: 31, Steps: 3 | Train Loss: 0.096 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5347299575805664
Epoch: 32, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.085 Vali Acc: 0.675 Test Loss: 1.085 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 33 cost time: 0.7533609867095947
Epoch: 33, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.088 Vali Acc: 0.700 Test Loss: 1.088 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 34 cost time: 0.6802480220794678
Epoch: 34, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.093 Vali Acc: 0.700 Test Loss: 1.093 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5888214111328125
Epoch: 35, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.095 Vali Acc: 0.700 Test Loss: 1.095 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5998897552490234
Epoch: 36, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.096 Vali Acc: 0.700 Test Loss: 1.096 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5568618774414062
Epoch: 37, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.097 Vali Acc: 0.700 Test Loss: 1.097 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6843516826629639
Epoch: 38, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.101 Vali Acc: 0.700 Test Loss: 1.101 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.662886381149292
Epoch: 39, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.102 Vali Acc: 0.700 Test Loss: 1.102 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6295297145843506
Epoch: 40, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.105 Vali Acc: 0.700 Test Loss: 1.105 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.673811674118042
Epoch: 41, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6474452018737793
Epoch: 42, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5347814559936523
Epoch: 43, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.113 Vali Acc: 0.700 Test Loss: 1.113 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df128_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 45956
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.479257822036743
Epoch: 1, Steps: 3 | Train Loss: 1.563 Vali Loss: 1.510 Vali Acc: 0.300 Test Loss: 1.510 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.7029557228088379
Epoch: 2, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.454 Vali Acc: 0.300 Test Loss: 1.454 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.6504285335540771
Epoch: 3, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.365 Vali Acc: 0.375 Test Loss: 1.365 Test Acc: 0.375
Validation loss decreased (-0.299985 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.6235823631286621
Epoch: 4, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.5210161209106445
Epoch: 5, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.173 Vali Acc: 0.550 Test Loss: 1.173 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.5228638648986816
Epoch: 6, Steps: 3 | Train Loss: 0.689 Vali Loss: 1.086 Vali Acc: 0.625 Test Loss: 1.086 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.6509270668029785
Epoch: 7, Steps: 3 | Train Loss: 0.543 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6242854595184326
Epoch: 8, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.969 Vali Acc: 0.650 Test Loss: 0.969 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 0.6437258720397949
Epoch: 9, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.918 Vali Acc: 0.675 Test Loss: 0.918 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 10 cost time: 0.6064057350158691
Epoch: 10, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.901 Vali Acc: 0.700 Test Loss: 0.901 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.599297285079956
Epoch: 11, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.858 Vali Acc: 0.725 Test Loss: 0.858 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 0.7099525928497314
Epoch: 12, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.850 Vali Acc: 0.725 Test Loss: 0.850 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 13 cost time: 0.658543586730957
Epoch: 13, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.850 Vali Acc: 0.775 Test Loss: 0.850 Test Acc: 0.775
Validation loss decreased (-0.724992 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 0.5963382720947266
Epoch: 14, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.844 Vali Acc: 0.750 Test Loss: 0.844 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6334812641143799
Epoch: 15, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6920137405395508
Epoch: 16, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7815566062927246
Epoch: 17, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.871 Vali Acc: 0.750 Test Loss: 0.871 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6290843486785889
Epoch: 18, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.889 Vali Acc: 0.750 Test Loss: 0.889 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6668376922607422
Epoch: 19, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.906 Vali Acc: 0.750 Test Loss: 0.906 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.586188793182373
Epoch: 20, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.921 Vali Acc: 0.750 Test Loss: 0.921 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.696871280670166
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6091761589050293
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.939 Vali Acc: 0.750 Test Loss: 0.939 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7607800960540771
Epoch: 23, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 102340
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2312471866607666
Epoch: 1, Steps: 3 | Train Loss: 1.555 Vali Loss: 1.378 Vali Acc: 0.225 Test Loss: 1.378 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.6820259094238281
Epoch: 2, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.330 Vali Acc: 0.300 Test Loss: 1.330 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.7447817325592041
Epoch: 3, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.260 Vali Acc: 0.325 Test Loss: 1.260 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.5391309261322021
Epoch: 4, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.192 Vali Acc: 0.450 Test Loss: 1.192 Test Acc: 0.450
Validation loss decreased (-0.324987 --> -0.449988).  Saving model ...
Epoch: 5 cost time: 0.7139158248901367
Epoch: 5, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.129 Vali Acc: 0.550 Test Loss: 1.129 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.7676482200622559
Epoch: 6, Steps: 3 | Train Loss: 0.797 Vali Loss: 1.061 Vali Acc: 0.550 Test Loss: 1.061 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 0.6692080497741699
Epoch: 7, Steps: 3 | Train Loss: 0.698 Vali Loss: 1.001 Vali Acc: 0.550 Test Loss: 1.001 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 0.718228816986084
Epoch: 8, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
Validation loss decreased (-0.549990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.7057394981384277
Epoch: 9, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.909 Vali Acc: 0.675 Test Loss: 0.909 Test Acc: 0.675
Validation loss decreased (-0.599990 --> -0.674991).  Saving model ...
Epoch: 10 cost time: 0.7008395195007324
Epoch: 10, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.867 Vali Acc: 0.700 Test Loss: 0.867 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.6763577461242676
Epoch: 11, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.828 Vali Acc: 0.675 Test Loss: 0.828 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9208548069000244
Epoch: 12, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.804 Vali Acc: 0.700 Test Loss: 0.804 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 13 cost time: 0.8992528915405273
Epoch: 13, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.797 Vali Acc: 0.700 Test Loss: 0.797 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 14 cost time: 0.6774654388427734
Epoch: 14, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.799 Vali Acc: 0.725 Test Loss: 0.799 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724992).  Saving model ...
Epoch: 15 cost time: 0.6684701442718506
Epoch: 15, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.6958472728729248
Epoch: 16, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 17 cost time: 0.7179663181304932
Epoch: 17, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.798 Vali Acc: 0.750 Test Loss: 0.798 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 0.7057733535766602
Epoch: 18, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.809 Vali Acc: 0.750 Test Loss: 0.809 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8116245269775391
Epoch: 19, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7765371799468994
Epoch: 20, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.839 Vali Acc: 0.750 Test Loss: 0.839 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7361946105957031
Epoch: 21, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.851 Vali Acc: 0.750 Test Loss: 0.851 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6767504215240479
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7624428272247314
Epoch: 23, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8217709064483643
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.874 Vali Acc: 0.750 Test Loss: 0.874 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6691985130310059
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.701859712600708
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7429735660552979
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.882 Vali Acc: 0.750 Test Loss: 0.882 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 76356
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2089736461639404
Epoch: 1, Steps: 3 | Train Loss: 1.650 Vali Loss: 1.402 Vali Acc: 0.350 Test Loss: 1.402 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5446023941040039
Epoch: 2, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.384 Vali Acc: 0.375 Test Loss: 1.384 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.6336939334869385
Epoch: 3, Steps: 3 | Train Loss: 1.538 Vali Loss: 1.359 Vali Acc: 0.425 Test Loss: 1.359 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.6803016662597656
Epoch: 4, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.335 Vali Acc: 0.425 Test Loss: 1.335 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.5922868251800537
Epoch: 5, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.304 Vali Acc: 0.475 Test Loss: 1.304 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.7696003913879395
Epoch: 6, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.269 Vali Acc: 0.475 Test Loss: 1.269 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.6626923084259033
Epoch: 7, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.225 Vali Acc: 0.475 Test Loss: 1.225 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.7568247318267822
Epoch: 8, Steps: 3 | Train Loss: 0.720 Vali Loss: 1.170 Vali Acc: 0.550 Test Loss: 1.170 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.6790807247161865
Epoch: 9, Steps: 3 | Train Loss: 0.606 Vali Loss: 1.114 Vali Acc: 0.575 Test Loss: 1.114 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 0.6187088489532471
Epoch: 10, Steps: 3 | Train Loss: 0.475 Vali Loss: 1.070 Vali Acc: 0.625 Test Loss: 1.070 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.6484827995300293
Epoch: 11, Steps: 3 | Train Loss: 0.358 Vali Loss: 1.053 Vali Acc: 0.625 Test Loss: 1.053 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.7444479465484619
Epoch: 12, Steps: 3 | Train Loss: 0.304 Vali Loss: 1.038 Vali Acc: 0.625 Test Loss: 1.038 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 13 cost time: 0.6847326755523682
Epoch: 13, Steps: 3 | Train Loss: 0.234 Vali Loss: 1.028 Vali Acc: 0.650 Test Loss: 1.028 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 0.6436841487884521
Epoch: 14, Steps: 3 | Train Loss: 0.172 Vali Loss: 1.002 Vali Acc: 0.650 Test Loss: 1.002 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.7053565979003906
Epoch: 15, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.986 Vali Acc: 0.700 Test Loss: 0.986 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 0.6780102252960205
Epoch: 16, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.989 Vali Acc: 0.700 Test Loss: 0.989 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7186431884765625
Epoch: 17, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.999 Vali Acc: 0.725 Test Loss: 0.999 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 18 cost time: 0.7103044986724854
Epoch: 18, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.004 Vali Acc: 0.700 Test Loss: 1.004 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7529776096343994
Epoch: 19, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6993556022644043
Epoch: 20, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.007 Vali Acc: 0.700 Test Loss: 1.007 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7839210033416748
Epoch: 21, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6781625747680664
Epoch: 22, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6479969024658203
Epoch: 23, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.022 Vali Acc: 0.700 Test Loss: 1.022 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7150602340698242
Epoch: 24, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7633113861083984
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.029 Vali Acc: 0.675 Test Loss: 1.029 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.674959659576416
Epoch: 26, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.033 Vali Acc: 0.675 Test Loss: 1.033 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7097835540771484
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 64260
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.447476387023926
Epoch: 1, Steps: 3 | Train Loss: 1.549 Vali Loss: 1.342 Vali Acc: 0.325 Test Loss: 1.342 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 0.5097994804382324
Epoch: 2, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.323 Vali Acc: 0.350 Test Loss: 1.323 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.5522005558013916
Epoch: 3, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.302 Vali Acc: 0.375 Test Loss: 1.302 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.610252857208252
Epoch: 4, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.271 Vali Acc: 0.425 Test Loss: 1.271 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.6437575817108154
Epoch: 5, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.5992717742919922
Epoch: 6, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.194 Vali Acc: 0.525 Test Loss: 1.194 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.6361677646636963
Epoch: 7, Steps: 3 | Train Loss: 0.851 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6756458282470703
Epoch: 8, Steps: 3 | Train Loss: 0.811 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6813936233520508
Epoch: 9, Steps: 3 | Train Loss: 0.679 Vali Loss: 1.109 Vali Acc: 0.550 Test Loss: 1.109 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 0.5353188514709473
Epoch: 10, Steps: 3 | Train Loss: 0.575 Vali Loss: 1.094 Vali Acc: 0.525 Test Loss: 1.094 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6201293468475342
Epoch: 11, Steps: 3 | Train Loss: 0.499 Vali Loss: 1.066 Vali Acc: 0.525 Test Loss: 1.066 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.48835277557373047
Epoch: 12, Steps: 3 | Train Loss: 0.423 Vali Loss: 1.043 Vali Acc: 0.550 Test Loss: 1.043 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549990).  Saving model ...
Epoch: 13 cost time: 0.6874806880950928
Epoch: 13, Steps: 3 | Train Loss: 0.343 Vali Loss: 1.025 Vali Acc: 0.550 Test Loss: 1.025 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 14 cost time: 0.7549965381622314
Epoch: 14, Steps: 3 | Train Loss: 0.218 Vali Loss: 1.015 Vali Acc: 0.550 Test Loss: 1.015 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 15 cost time: 0.5193653106689453
Epoch: 15, Steps: 3 | Train Loss: 0.205 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
Validation loss decreased (-0.549990 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.6304755210876465
Epoch: 16, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.004 Vali Acc: 0.625 Test Loss: 1.004 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 17 cost time: 0.5371747016906738
Epoch: 17, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.985 Vali Acc: 0.625 Test Loss: 0.985 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 0.6037514209747314
Epoch: 18, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.985 Vali Acc: 0.650 Test Loss: 0.985 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 19 cost time: 0.5848257541656494
Epoch: 19, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.001 Vali Acc: 0.650 Test Loss: 1.001 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5862329006195068
Epoch: 20, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6146595478057861
Epoch: 21, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.048 Vali Acc: 0.650 Test Loss: 1.048 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6005830764770508
Epoch: 22, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.061 Vali Acc: 0.650 Test Loss: 1.061 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6561112403869629
Epoch: 23, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.062 Vali Acc: 0.675 Test Loss: 1.062 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674989).  Saving model ...
Epoch: 24 cost time: 0.4662916660308838
Epoch: 24, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.063 Vali Acc: 0.675 Test Loss: 1.063 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6213624477386475
Epoch: 25, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.060 Vali Acc: 0.675 Test Loss: 1.060 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.5600595474243164
Epoch: 26, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.060 Vali Acc: 0.675 Test Loss: 1.060 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5650551319122314
Epoch: 27, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.063 Vali Acc: 0.675 Test Loss: 1.063 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5812139511108398
Epoch: 28, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.065 Vali Acc: 0.675 Test Loss: 1.065 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5583508014678955
Epoch: 29, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.069 Vali Acc: 0.675 Test Loss: 1.069 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.650505542755127
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.072 Vali Acc: 0.675 Test Loss: 1.072 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5887660980224609
Epoch: 31, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.073 Vali Acc: 0.675 Test Loss: 1.073 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5745534896850586
Epoch: 32, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.075 Vali Acc: 0.675 Test Loss: 1.075 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5683588981628418
Epoch: 33, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.077 Vali Acc: 0.675 Test Loss: 1.077 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.654855489730835
Epoch: 34, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.078 Vali Acc: 0.675 Test Loss: 1.078 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7730660438537598
Epoch: 35, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.080 Vali Acc: 0.675 Test Loss: 1.080 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 56708
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2513062953948975
Epoch: 1, Steps: 3 | Train Loss: 1.627 Vali Loss: 1.485 Vali Acc: 0.250 Test Loss: 1.485 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.5848264694213867
Epoch: 2, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.459 Vali Acc: 0.275 Test Loss: 1.459 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.6192135810852051
Epoch: 3, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.435 Vali Acc: 0.325 Test Loss: 1.435 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.8014936447143555
Epoch: 4, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.405 Vali Acc: 0.350 Test Loss: 1.405 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.5560107231140137
Epoch: 5, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.5828547477722168
Epoch: 6, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.339 Vali Acc: 0.400 Test Loss: 1.339 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.6242499351501465
Epoch: 7, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.309 Vali Acc: 0.400 Test Loss: 1.309 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.5651547908782959
Epoch: 8, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.280 Vali Acc: 0.425 Test Loss: 1.280 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.572232723236084
Epoch: 9, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.253 Vali Acc: 0.425 Test Loss: 1.253 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.7262208461761475
Epoch: 10, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.228 Vali Acc: 0.450 Test Loss: 1.228 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 11 cost time: 0.6717934608459473
Epoch: 11, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.209 Vali Acc: 0.450 Test Loss: 1.209 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 12 cost time: 0.6978907585144043
Epoch: 12, Steps: 3 | Train Loss: 0.628 Vali Loss: 1.190 Vali Acc: 0.475 Test Loss: 1.190 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 0.5951378345489502
Epoch: 13, Steps: 3 | Train Loss: 0.583 Vali Loss: 1.175 Vali Acc: 0.525 Test Loss: 1.175 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 0.5920484066009521
Epoch: 14, Steps: 3 | Train Loss: 0.508 Vali Loss: 1.163 Vali Acc: 0.550 Test Loss: 1.163 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.7147688865661621
Epoch: 15, Steps: 3 | Train Loss: 0.394 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.756188154220581
Epoch: 16, Steps: 3 | Train Loss: 0.378 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6840612888336182
Epoch: 17, Steps: 3 | Train Loss: 0.332 Vali Loss: 1.147 Vali Acc: 0.550 Test Loss: 1.147 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 18 cost time: 0.5941660404205322
Epoch: 18, Steps: 3 | Train Loss: 0.315 Vali Loss: 1.150 Vali Acc: 0.600 Test Loss: 1.150 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.6025912761688232
Epoch: 19, Steps: 3 | Train Loss: 0.228 Vali Loss: 1.143 Vali Acc: 0.625 Test Loss: 1.143 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 20 cost time: 0.6219477653503418
Epoch: 20, Steps: 3 | Train Loss: 0.193 Vali Loss: 1.136 Vali Acc: 0.625 Test Loss: 1.136 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 0.6183168888092041
Epoch: 21, Steps: 3 | Train Loss: 0.153 Vali Loss: 1.130 Vali Acc: 0.650 Test Loss: 1.130 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 22 cost time: 0.6151137351989746
Epoch: 22, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.125 Vali Acc: 0.650 Test Loss: 1.125 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 23 cost time: 0.7945163249969482
Epoch: 23, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7009563446044922
Epoch: 24, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.132 Vali Acc: 0.675 Test Loss: 1.132 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.6421232223510742
Epoch: 25, Steps: 3 | Train Loss: 0.083 Vali Loss: 1.142 Vali Acc: 0.675 Test Loss: 1.142 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5693717002868652
Epoch: 26, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.152 Vali Acc: 0.700 Test Loss: 1.152 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699988).  Saving model ...
Epoch: 27 cost time: 0.6049790382385254
Epoch: 27, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.161 Vali Acc: 0.700 Test Loss: 1.161 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5680415630340576
Epoch: 28, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.170 Vali Acc: 0.700 Test Loss: 1.170 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.696840763092041
Epoch: 29, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.183 Vali Acc: 0.700 Test Loss: 1.183 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6967370510101318
Epoch: 30, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.195 Vali Acc: 0.700 Test Loss: 1.195 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6353375911712646
Epoch: 31, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.206 Vali Acc: 0.675 Test Loss: 1.206 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6559154987335205
Epoch: 32, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.213 Vali Acc: 0.675 Test Loss: 1.213 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6282064914703369
Epoch: 33, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.219 Vali Acc: 0.675 Test Loss: 1.219 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6506509780883789
Epoch: 34, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.223 Vali Acc: 0.675 Test Loss: 1.223 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5938127040863037
Epoch: 35, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.225 Vali Acc: 0.675 Test Loss: 1.225 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7134790420532227
Epoch: 36, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.228 Vali Acc: 0.675 Test Loss: 1.228 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 44740
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5889031887054443
Epoch: 1, Steps: 3 | Train Loss: 1.557 Vali Loss: 1.470 Vali Acc: 0.225 Test Loss: 1.470 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.5826201438903809
Epoch: 2, Steps: 3 | Train Loss: 1.536 Vali Loss: 1.455 Vali Acc: 0.250 Test Loss: 1.455 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.729896068572998
Epoch: 3, Steps: 3 | Train Loss: 1.479 Vali Loss: 1.438 Vali Acc: 0.325 Test Loss: 1.438 Test Acc: 0.325
Validation loss decreased (-0.249985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.6213898658752441
Epoch: 4, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.414 Vali Acc: 0.375 Test Loss: 1.414 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.5549888610839844
Epoch: 5, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.388 Vali Acc: 0.400 Test Loss: 1.388 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.5875024795532227
Epoch: 6, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.360 Vali Acc: 0.425 Test Loss: 1.360 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 0.6072525978088379
Epoch: 7, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.333 Vali Acc: 0.450 Test Loss: 1.333 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.6597096920013428
Epoch: 8, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.302 Vali Acc: 0.450 Test Loss: 1.302 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.6384005546569824
Epoch: 9, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.273 Vali Acc: 0.500 Test Loss: 1.273 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.6079006195068359
Epoch: 10, Steps: 3 | Train Loss: 0.845 Vali Loss: 1.248 Vali Acc: 0.525 Test Loss: 1.248 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.7277522087097168
Epoch: 11, Steps: 3 | Train Loss: 0.817 Vali Loss: 1.220 Vali Acc: 0.550 Test Loss: 1.220 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.5976107120513916
Epoch: 12, Steps: 3 | Train Loss: 0.669 Vali Loss: 1.196 Vali Acc: 0.550 Test Loss: 1.196 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 0.5797927379608154
Epoch: 13, Steps: 3 | Train Loss: 0.654 Vali Loss: 1.178 Vali Acc: 0.575 Test Loss: 1.178 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 0.5942072868347168
Epoch: 14, Steps: 3 | Train Loss: 0.644 Vali Loss: 1.164 Vali Acc: 0.575 Test Loss: 1.164 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 0.7330849170684814
Epoch: 15, Steps: 3 | Train Loss: 0.504 Vali Loss: 1.155 Vali Acc: 0.600 Test Loss: 1.155 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 0.6901965141296387
Epoch: 16, Steps: 3 | Train Loss: 0.490 Vali Loss: 1.148 Vali Acc: 0.650 Test Loss: 1.148 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 17 cost time: 0.7256801128387451
Epoch: 17, Steps: 3 | Train Loss: 0.397 Vali Loss: 1.137 Vali Acc: 0.650 Test Loss: 1.137 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 0.6467580795288086
Epoch: 18, Steps: 3 | Train Loss: 0.335 Vali Loss: 1.133 Vali Acc: 0.650 Test Loss: 1.133 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 0.6698341369628906
Epoch: 19, Steps: 3 | Train Loss: 0.420 Vali Loss: 1.136 Vali Acc: 0.650 Test Loss: 1.136 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7411744594573975
Epoch: 20, Steps: 3 | Train Loss: 0.315 Vali Loss: 1.135 Vali Acc: 0.650 Test Loss: 1.135 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6405606269836426
Epoch: 21, Steps: 3 | Train Loss: 0.240 Vali Loss: 1.133 Vali Acc: 0.650 Test Loss: 1.133 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 22 cost time: 0.7262330055236816
Epoch: 22, Steps: 3 | Train Loss: 0.209 Vali Loss: 1.135 Vali Acc: 0.675 Test Loss: 1.135 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 23 cost time: 0.6474654674530029
Epoch: 23, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.139 Vali Acc: 0.650 Test Loss: 1.139 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.614856481552124
Epoch: 24, Steps: 3 | Train Loss: 0.147 Vali Loss: 1.144 Vali Acc: 0.625 Test Loss: 1.144 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8541021347045898
Epoch: 25, Steps: 3 | Train Loss: 0.141 Vali Loss: 1.152 Vali Acc: 0.625 Test Loss: 1.152 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6455059051513672
Epoch: 26, Steps: 3 | Train Loss: 0.110 Vali Loss: 1.163 Vali Acc: 0.625 Test Loss: 1.163 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5374462604522705
Epoch: 27, Steps: 3 | Train Loss: 0.097 Vali Loss: 1.178 Vali Acc: 0.625 Test Loss: 1.178 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6209971904754639
Epoch: 28, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.188 Vali Acc: 0.625 Test Loss: 1.188 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7725629806518555
Epoch: 29, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.193 Vali Acc: 0.625 Test Loss: 1.193 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6228423118591309
Epoch: 30, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.197 Vali Acc: 0.625 Test Loss: 1.197 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5343599319458008
Epoch: 31, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.205 Vali Acc: 0.625 Test Loss: 1.205 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6800937652587891
Epoch: 32, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.209 Vali Acc: 0.625 Test Loss: 1.209 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 41988
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2196569442749023
Epoch: 1, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.443 Vali Acc: 0.425 Test Loss: 1.443 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.6013479232788086
Epoch: 2, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.389 Vali Acc: 0.525 Test Loss: 1.389 Test Acc: 0.525
Validation loss decreased (-0.424986 --> -0.524986).  Saving model ...
Epoch: 3 cost time: 0.5743100643157959
Epoch: 3, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.347 Vali Acc: 0.575 Test Loss: 1.347 Test Acc: 0.575
Validation loss decreased (-0.524986 --> -0.574987).  Saving model ...
Epoch: 4 cost time: 0.5568804740905762
Epoch: 4, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.315 Vali Acc: 0.600 Test Loss: 1.315 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 0.5758473873138428
Epoch: 5, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.286 Vali Acc: 0.550 Test Loss: 1.286 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6196238994598389
Epoch: 6, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.260 Vali Acc: 0.550 Test Loss: 1.260 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.525007963180542
Epoch: 7, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.241 Vali Acc: 0.550 Test Loss: 1.241 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5591449737548828
Epoch: 8, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.223 Vali Acc: 0.550 Test Loss: 1.223 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5271601676940918
Epoch: 9, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.209 Vali Acc: 0.550 Test Loss: 1.209 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5884208679199219
Epoch: 10, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.193 Vali Acc: 0.525 Test Loss: 1.193 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5990622043609619
Epoch: 11, Steps: 3 | Train Loss: 0.723 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.630258321762085
Epoch: 12, Steps: 3 | Train Loss: 0.686 Vali Loss: 1.166 Vali Acc: 0.525 Test Loss: 1.166 Test Acc: 0.525
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.570669412612915
Epoch: 13, Steps: 3 | Train Loss: 0.622 Vali Loss: 1.157 Vali Acc: 0.575 Test Loss: 1.157 Test Acc: 0.575
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6957039833068848
Epoch: 14, Steps: 3 | Train Loss: 0.571 Vali Loss: 1.147 Vali Acc: 0.550 Test Loss: 1.147 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm64_nh16_df64_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.6
model parameter : 37700
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.329986333847046
Epoch: 1, Steps: 3 | Train Loss: 1.636 Vali Loss: 1.489 Vali Acc: 0.200 Test Loss: 1.489 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.6564574241638184
Epoch: 2, Steps: 3 | Train Loss: 1.510 Vali Loss: 1.450 Vali Acc: 0.250 Test Loss: 1.450 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.5933761596679688
Epoch: 3, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.407 Vali Acc: 0.250 Test Loss: 1.407 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.6184132099151611
Epoch: 4, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.359 Vali Acc: 0.325 Test Loss: 1.359 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.6205296516418457
Epoch: 5, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.311 Vali Acc: 0.350 Test Loss: 1.311 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.6255862712860107
Epoch: 6, Steps: 3 | Train Loss: 0.999 Vali Loss: 1.257 Vali Acc: 0.450 Test Loss: 1.257 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.6428577899932861
Epoch: 7, Steps: 3 | Train Loss: 0.894 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.6872649192810059
Epoch: 8, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.140 Vali Acc: 0.575 Test Loss: 1.140 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.5782356262207031
Epoch: 9, Steps: 3 | Train Loss: 0.659 Vali Loss: 1.097 Vali Acc: 0.625 Test Loss: 1.097 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.5700063705444336
Epoch: 10, Steps: 3 | Train Loss: 0.568 Vali Loss: 1.065 Vali Acc: 0.650 Test Loss: 1.065 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 0.6328837871551514
Epoch: 11, Steps: 3 | Train Loss: 0.454 Vali Loss: 1.041 Vali Acc: 0.675 Test Loss: 1.041 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.646113395690918
Epoch: 12, Steps: 3 | Train Loss: 0.399 Vali Loss: 1.008 Vali Acc: 0.725 Test Loss: 1.008 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 0.5874977111816406
Epoch: 13, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.966 Vali Acc: 0.700 Test Loss: 0.966 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5557394027709961
Epoch: 14, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.944 Vali Acc: 0.675 Test Loss: 0.944 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6568906307220459
Epoch: 15, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.920 Vali Acc: 0.700 Test Loss: 0.920 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5785109996795654
Epoch: 16, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.917 Vali Acc: 0.725 Test Loss: 0.917 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 17 cost time: 0.5976443290710449
Epoch: 17, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.923 Vali Acc: 0.700 Test Loss: 0.923 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5914065837860107
Epoch: 18, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.900 Vali Acc: 0.725 Test Loss: 0.900 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 19 cost time: 0.6402513980865479
Epoch: 19, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.866 Vali Acc: 0.750 Test Loss: 0.866 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.6915040016174316
Epoch: 20, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.5967178344726562
Epoch: 21, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.865 Vali Acc: 0.750 Test Loss: 0.865 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6576766967773438
Epoch: 22, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.869 Vali Acc: 0.775 Test Loss: 0.869 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 23 cost time: 0.6355123519897461
Epoch: 23, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.875 Vali Acc: 0.750 Test Loss: 0.875 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6297545433044434
Epoch: 24, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.883 Vali Acc: 0.775 Test Loss: 0.883 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6434552669525146
Epoch: 25, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.889 Vali Acc: 0.750 Test Loss: 0.889 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7160978317260742
Epoch: 26, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.894 Vali Acc: 0.750 Test Loss: 0.894 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5989198684692383
Epoch: 27, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6358699798583984
Epoch: 28, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.900 Vali Acc: 0.725 Test Loss: 0.900 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6185142993927002
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.899 Vali Acc: 0.750 Test Loss: 0.899 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.662024736404419
Epoch: 30, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.898 Vali Acc: 0.750 Test Loss: 0.898 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6053764820098877
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.895 Vali Acc: 0.750 Test Loss: 0.895 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6637132167816162
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 59588
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.015899419784546
Epoch: 1, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.380 Vali Acc: 0.325 Test Loss: 1.380 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.4831674098968506
Epoch: 2, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.359 Vali Acc: 0.375 Test Loss: 1.359 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.5402159690856934
Epoch: 3, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.336 Vali Acc: 0.425 Test Loss: 1.336 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.5528304576873779
Epoch: 4, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.5555362701416016
Epoch: 5, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.274 Vali Acc: 0.450 Test Loss: 1.274 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5544226169586182
Epoch: 6, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.242 Vali Acc: 0.450 Test Loss: 1.242 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5401442050933838
Epoch: 7, Steps: 3 | Train Loss: 0.817 Vali Loss: 1.210 Vali Acc: 0.475 Test Loss: 1.210 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.575336217880249
Epoch: 8, Steps: 3 | Train Loss: 0.700 Vali Loss: 1.173 Vali Acc: 0.475 Test Loss: 1.173 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5952630043029785
Epoch: 9, Steps: 3 | Train Loss: 0.651 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 0.5831935405731201
Epoch: 10, Steps: 3 | Train Loss: 0.572 Vali Loss: 1.107 Vali Acc: 0.550 Test Loss: 1.107 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 0.5482242107391357
Epoch: 11, Steps: 3 | Train Loss: 0.533 Vali Loss: 1.074 Vali Acc: 0.575 Test Loss: 1.074 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.6530859470367432
Epoch: 12, Steps: 3 | Train Loss: 0.409 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 0.6162655353546143
Epoch: 13, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.992 Vali Acc: 0.650 Test Loss: 0.992 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 0.6176681518554688
Epoch: 14, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.950 Vali Acc: 0.650 Test Loss: 0.950 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.608422040939331
Epoch: 15, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.922 Vali Acc: 0.700 Test Loss: 0.922 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 0.6188275814056396
Epoch: 16, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.902 Vali Acc: 0.750 Test Loss: 0.902 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.6001427173614502
Epoch: 17, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.903 Vali Acc: 0.700 Test Loss: 0.903 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.650620698928833
Epoch: 18, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.911 Vali Acc: 0.700 Test Loss: 0.911 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5388975143432617
Epoch: 19, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.909 Vali Acc: 0.725 Test Loss: 0.909 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6010963916778564
Epoch: 20, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.887 Vali Acc: 0.700 Test Loss: 0.887 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5452625751495361
Epoch: 21, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.870 Vali Acc: 0.700 Test Loss: 0.870 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5342206954956055
Epoch: 22, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.862 Vali Acc: 0.700 Test Loss: 0.862 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5694334506988525
Epoch: 23, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.857 Vali Acc: 0.700 Test Loss: 0.857 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.694399356842041
Epoch: 24, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.861 Vali Acc: 0.700 Test Loss: 0.861 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5436930656433105
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.874 Vali Acc: 0.700 Test Loss: 0.874 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5000350475311279
Epoch: 26, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.882 Vali Acc: 0.700 Test Loss: 0.882 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 46596
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.137645721435547
Epoch: 1, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.414 Vali Acc: 0.275 Test Loss: 1.414 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.590003490447998
Epoch: 2, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.388 Vali Acc: 0.275 Test Loss: 1.388 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6185286045074463
Epoch: 3, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.366 Vali Acc: 0.275 Test Loss: 1.366 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.5322308540344238
Epoch: 4, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.346 Vali Acc: 0.275 Test Loss: 1.346 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 5 cost time: 0.5894021987915039
Epoch: 5, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.5670218467712402
Epoch: 6, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.300 Vali Acc: 0.375 Test Loss: 1.300 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.5150191783905029
Epoch: 7, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.276 Vali Acc: 0.425 Test Loss: 1.276 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.5694096088409424
Epoch: 8, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.245 Vali Acc: 0.450 Test Loss: 1.245 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 0.5007543563842773
Epoch: 9, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.220 Vali Acc: 0.450 Test Loss: 1.220 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 0.5759220123291016
Epoch: 10, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.195 Vali Acc: 0.475 Test Loss: 1.195 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.5427637100219727
Epoch: 11, Steps: 3 | Train Loss: 0.647 Vali Loss: 1.162 Vali Acc: 0.525 Test Loss: 1.162 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 0.5756158828735352
Epoch: 12, Steps: 3 | Train Loss: 0.619 Vali Loss: 1.129 Vali Acc: 0.550 Test Loss: 1.129 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 13 cost time: 0.4555544853210449
Epoch: 13, Steps: 3 | Train Loss: 0.565 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.572045087814331
Epoch: 14, Steps: 3 | Train Loss: 0.505 Vali Loss: 1.060 Vali Acc: 0.625 Test Loss: 1.060 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.5894315242767334
Epoch: 15, Steps: 3 | Train Loss: 0.410 Vali Loss: 1.037 Vali Acc: 0.625 Test Loss: 1.037 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 16 cost time: 0.5446040630340576
Epoch: 16, Steps: 3 | Train Loss: 0.400 Vali Loss: 1.018 Vali Acc: 0.650 Test Loss: 1.018 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 0.5694599151611328
Epoch: 17, Steps: 3 | Train Loss: 0.347 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 18 cost time: 0.6002130508422852
Epoch: 18, Steps: 3 | Train Loss: 0.258 Vali Loss: 1.000 Vali Acc: 0.625 Test Loss: 1.000 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5750575065612793
Epoch: 19, Steps: 3 | Train Loss: 0.222 Vali Loss: 1.001 Vali Acc: 0.625 Test Loss: 1.001 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5702111721038818
Epoch: 20, Steps: 3 | Train Loss: 0.183 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6282737255096436
Epoch: 21, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.015 Vali Acc: 0.625 Test Loss: 1.015 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5729703903198242
Epoch: 22, Steps: 3 | Train Loss: 0.157 Vali Loss: 1.016 Vali Acc: 0.625 Test Loss: 1.016 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.612884521484375
Epoch: 23, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.010 Vali Acc: 0.625 Test Loss: 1.010 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6683523654937744
Epoch: 24, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.989 Vali Acc: 0.675 Test Loss: 0.989 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 25 cost time: 0.5574734210968018
Epoch: 25, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.977 Vali Acc: 0.675 Test Loss: 0.977 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 26 cost time: 0.5635538101196289
Epoch: 26, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.974 Vali Acc: 0.675 Test Loss: 0.974 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 27 cost time: 0.5300617218017578
Epoch: 27, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.974 Vali Acc: 0.675 Test Loss: 0.974 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 28 cost time: 0.49443888664245605
Epoch: 28, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.976 Vali Acc: 0.675 Test Loss: 0.976 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5712671279907227
Epoch: 29, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.984 Vali Acc: 0.675 Test Loss: 0.984 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5578153133392334
Epoch: 30, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.992 Vali Acc: 0.675 Test Loss: 0.992 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5104131698608398
Epoch: 31, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.999 Vali Acc: 0.675 Test Loss: 0.999 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5701987743377686
Epoch: 32, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.006 Vali Acc: 0.675 Test Loss: 1.006 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5803289413452148
Epoch: 33, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.011 Vali Acc: 0.675 Test Loss: 1.011 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5093209743499756
Epoch: 34, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.015 Vali Acc: 0.675 Test Loss: 1.015 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5255100727081299
Epoch: 35, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.49399566650390625
Epoch: 36, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5880329608917236
Epoch: 37, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.030 Vali Acc: 0.675 Test Loss: 1.030 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 40548
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.150872230529785
Epoch: 1, Steps: 3 | Train Loss: 1.630 Vali Loss: 1.650 Vali Acc: 0.200 Test Loss: 1.650 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 0.5205905437469482
Epoch: 2, Steps: 3 | Train Loss: 1.502 Vali Loss: 1.609 Vali Acc: 0.200 Test Loss: 1.609 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 0.5883095264434814
Epoch: 3, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.570 Vali Acc: 0.200 Test Loss: 1.570 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 4 cost time: 0.578977108001709
Epoch: 4, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.533 Vali Acc: 0.225 Test Loss: 1.533 Test Acc: 0.225
Validation loss decreased (-0.199984 --> -0.224985).  Saving model ...
Epoch: 5 cost time: 0.5402076244354248
Epoch: 5, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.495 Vali Acc: 0.275 Test Loss: 1.495 Test Acc: 0.275
Validation loss decreased (-0.224985 --> -0.274985).  Saving model ...
Epoch: 6 cost time: 0.5378248691558838
Epoch: 6, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.462 Vali Acc: 0.325 Test Loss: 1.462 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324985).  Saving model ...
Epoch: 7 cost time: 0.5416667461395264
Epoch: 7, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.428 Vali Acc: 0.375 Test Loss: 1.428 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.5299258232116699
Epoch: 8, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.396 Vali Acc: 0.450 Test Loss: 1.396 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449986).  Saving model ...
Epoch: 9 cost time: 0.5419669151306152
Epoch: 9, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.365 Vali Acc: 0.475 Test Loss: 1.365 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 10 cost time: 0.5545394420623779
Epoch: 10, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.338 Vali Acc: 0.500 Test Loss: 1.338 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.5748598575592041
Epoch: 11, Steps: 3 | Train Loss: 0.841 Vali Loss: 1.311 Vali Acc: 0.500 Test Loss: 1.311 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.5039560794830322
Epoch: 12, Steps: 3 | Train Loss: 0.782 Vali Loss: 1.286 Vali Acc: 0.525 Test Loss: 1.286 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 13 cost time: 0.5162982940673828
Epoch: 13, Steps: 3 | Train Loss: 0.729 Vali Loss: 1.260 Vali Acc: 0.525 Test Loss: 1.260 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 14 cost time: 0.4690093994140625
Epoch: 14, Steps: 3 | Train Loss: 0.647 Vali Loss: 1.235 Vali Acc: 0.550 Test Loss: 1.235 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.5545618534088135
Epoch: 15, Steps: 3 | Train Loss: 0.587 Vali Loss: 1.210 Vali Acc: 0.550 Test Loss: 1.210 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 16 cost time: 0.5902538299560547
Epoch: 16, Steps: 3 | Train Loss: 0.490 Vali Loss: 1.186 Vali Acc: 0.550 Test Loss: 1.186 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 17 cost time: 0.5400946140289307
Epoch: 17, Steps: 3 | Train Loss: 0.395 Vali Loss: 1.162 Vali Acc: 0.550 Test Loss: 1.162 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 18 cost time: 0.6076302528381348
Epoch: 18, Steps: 3 | Train Loss: 0.386 Vali Loss: 1.155 Vali Acc: 0.550 Test Loss: 1.155 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 19 cost time: 0.6365089416503906
Epoch: 19, Steps: 3 | Train Loss: 0.410 Vali Loss: 1.142 Vali Acc: 0.550 Test Loss: 1.142 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 20 cost time: 0.5040044784545898
Epoch: 20, Steps: 3 | Train Loss: 0.334 Vali Loss: 1.135 Vali Acc: 0.575 Test Loss: 1.135 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 21 cost time: 0.6178076267242432
Epoch: 21, Steps: 3 | Train Loss: 0.263 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.6486151218414307
Epoch: 22, Steps: 3 | Train Loss: 0.208 Vali Loss: 1.114 Vali Acc: 0.625 Test Loss: 1.114 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.6046607494354248
Epoch: 23, Steps: 3 | Train Loss: 0.209 Vali Loss: 1.101 Vali Acc: 0.625 Test Loss: 1.101 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 24 cost time: 0.6062912940979004
Epoch: 24, Steps: 3 | Train Loss: 0.161 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.6030890941619873
Epoch: 25, Steps: 3 | Train Loss: 0.150 Vali Loss: 1.095 Vali Acc: 0.675 Test Loss: 1.095 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.639911413192749
Epoch: 26, Steps: 3 | Train Loss: 0.149 Vali Loss: 1.100 Vali Acc: 0.675 Test Loss: 1.100 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5367460250854492
Epoch: 27, Steps: 3 | Train Loss: 0.127 Vali Loss: 1.112 Vali Acc: 0.675 Test Loss: 1.112 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5072047710418701
Epoch: 28, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.111 Vali Acc: 0.675 Test Loss: 1.111 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.618938684463501
Epoch: 29, Steps: 3 | Train Loss: 0.081 Vali Loss: 1.110 Vali Acc: 0.675 Test Loss: 1.110 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6032726764678955
Epoch: 30, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.104 Vali Acc: 0.675 Test Loss: 1.104 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5671846866607666
Epoch: 31, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5808136463165283
Epoch: 32, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5517067909240723
Epoch: 33, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.104 Vali Acc: 0.675 Test Loss: 1.104 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5954666137695312
Epoch: 34, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.105 Vali Acc: 0.700 Test Loss: 1.105 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 35 cost time: 0.5676662921905518
Epoch: 35, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5420916080474854
Epoch: 36, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5581700801849365
Epoch: 37, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5718851089477539
Epoch: 38, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.109 Vali Acc: 0.675 Test Loss: 1.109 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6101245880126953
Epoch: 39, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.4921000003814697
Epoch: 40, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.099 Vali Acc: 0.700 Test Loss: 1.099 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 41 cost time: 0.6303436756134033
Epoch: 41, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.095 Vali Acc: 0.725 Test Loss: 1.095 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 42 cost time: 0.6277279853820801
Epoch: 42, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.093 Vali Acc: 0.725 Test Loss: 1.093 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 43 cost time: 0.5567629337310791
Epoch: 43, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.095 Vali Acc: 0.725 Test Loss: 1.095 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.570167064666748
Epoch: 44, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.100 Vali Acc: 0.700 Test Loss: 1.100 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5997483730316162
Epoch: 45, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.106 Vali Acc: 0.700 Test Loss: 1.106 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6620943546295166
Epoch: 46, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.111 Vali Acc: 0.700 Test Loss: 1.111 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5911364555358887
Epoch: 47, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.119 Vali Acc: 0.700 Test Loss: 1.119 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5574779510498047
Epoch: 48, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.124 Vali Acc: 0.700 Test Loss: 1.124 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6108229160308838
Epoch: 49, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.129 Vali Acc: 0.700 Test Loss: 1.129 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5550925731658936
Epoch: 50, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.132 Vali Acc: 0.725 Test Loss: 1.132 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.643092155456543
Epoch: 51, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.135 Vali Acc: 0.725 Test Loss: 1.135 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.5724139213562012
Epoch: 52, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.137 Vali Acc: 0.725 Test Loss: 1.137 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 36772
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1473114490509033
Epoch: 1, Steps: 3 | Train Loss: 1.651 Vali Loss: 1.436 Vali Acc: 0.200 Test Loss: 1.436 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5398569107055664
Epoch: 2, Steps: 3 | Train Loss: 1.586 Vali Loss: 1.433 Vali Acc: 0.200 Test Loss: 1.433 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.5618696212768555
Epoch: 3, Steps: 3 | Train Loss: 1.516 Vali Loss: 1.429 Vali Acc: 0.200 Test Loss: 1.429 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.561410665512085
Epoch: 4, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.420 Vali Acc: 0.225 Test Loss: 1.420 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.5394001007080078
Epoch: 5, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.405 Vali Acc: 0.250 Test Loss: 1.405 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 0.6555633544921875
Epoch: 6, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.389 Vali Acc: 0.275 Test Loss: 1.389 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 0.5401058197021484
Epoch: 7, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.372 Vali Acc: 0.325 Test Loss: 1.372 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.5674853324890137
Epoch: 8, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.354 Vali Acc: 0.400 Test Loss: 1.354 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 0.5445823669433594
Epoch: 9, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.335 Vali Acc: 0.450 Test Loss: 1.335 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.6146245002746582
Epoch: 10, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.316 Vali Acc: 0.450 Test Loss: 1.316 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.5678997039794922
Epoch: 11, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.297 Vali Acc: 0.525 Test Loss: 1.297 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 12 cost time: 0.6001896858215332
Epoch: 12, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.279 Vali Acc: 0.525 Test Loss: 1.279 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 13 cost time: 0.5969526767730713
Epoch: 13, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.263 Vali Acc: 0.525 Test Loss: 1.263 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 14 cost time: 0.5785596370697021
Epoch: 14, Steps: 3 | Train Loss: 0.847 Vali Loss: 1.248 Vali Acc: 0.525 Test Loss: 1.248 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 0.5303642749786377
Epoch: 15, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.233 Vali Acc: 0.550 Test Loss: 1.233 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 16 cost time: 0.5466063022613525
Epoch: 16, Steps: 3 | Train Loss: 0.825 Vali Loss: 1.217 Vali Acc: 0.525 Test Loss: 1.217 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5233728885650635
Epoch: 17, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.206 Vali Acc: 0.525 Test Loss: 1.206 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5374240875244141
Epoch: 18, Steps: 3 | Train Loss: 0.605 Vali Loss: 1.194 Vali Acc: 0.550 Test Loss: 1.194 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 19 cost time: 0.5565078258514404
Epoch: 19, Steps: 3 | Train Loss: 0.670 Vali Loss: 1.181 Vali Acc: 0.525 Test Loss: 1.181 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.580636739730835
Epoch: 20, Steps: 3 | Train Loss: 0.562 Vali Loss: 1.170 Vali Acc: 0.550 Test Loss: 1.170 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 21 cost time: 0.6113176345825195
Epoch: 21, Steps: 3 | Train Loss: 0.519 Vali Loss: 1.159 Vali Acc: 0.600 Test Loss: 1.159 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 0.589519739151001
Epoch: 22, Steps: 3 | Train Loss: 0.405 Vali Loss: 1.146 Vali Acc: 0.600 Test Loss: 1.146 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.6376032829284668
Epoch: 23, Steps: 3 | Train Loss: 0.423 Vali Loss: 1.140 Vali Acc: 0.600 Test Loss: 1.140 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 24 cost time: 0.5869872570037842
Epoch: 24, Steps: 3 | Train Loss: 0.367 Vali Loss: 1.136 Vali Acc: 0.600 Test Loss: 1.136 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 0.6068882942199707
Epoch: 25, Steps: 3 | Train Loss: 0.340 Vali Loss: 1.133 Vali Acc: 0.600 Test Loss: 1.133 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 0.6236605644226074
Epoch: 26, Steps: 3 | Train Loss: 0.323 Vali Loss: 1.135 Vali Acc: 0.600 Test Loss: 1.135 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9025418758392334
Epoch: 27, Steps: 3 | Train Loss: 0.258 Vali Loss: 1.128 Vali Acc: 0.600 Test Loss: 1.128 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 28 cost time: 0.5863041877746582
Epoch: 28, Steps: 3 | Train Loss: 0.243 Vali Loss: 1.132 Vali Acc: 0.600 Test Loss: 1.132 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6796674728393555
Epoch: 29, Steps: 3 | Train Loss: 0.235 Vali Loss: 1.135 Vali Acc: 0.600 Test Loss: 1.135 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5223238468170166
Epoch: 30, Steps: 3 | Train Loss: 0.197 Vali Loss: 1.138 Vali Acc: 0.600 Test Loss: 1.138 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5563900470733643
Epoch: 31, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.141 Vali Acc: 0.600 Test Loss: 1.141 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5848345756530762
Epoch: 32, Steps: 3 | Train Loss: 0.148 Vali Loss: 1.144 Vali Acc: 0.600 Test Loss: 1.144 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6276602745056152
Epoch: 33, Steps: 3 | Train Loss: 0.153 Vali Loss: 1.149 Vali Acc: 0.600 Test Loss: 1.149 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5421719551086426
Epoch: 34, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.149 Vali Acc: 0.600 Test Loss: 1.149 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5881025791168213
Epoch: 35, Steps: 3 | Train Loss: 0.128 Vali Loss: 1.150 Vali Acc: 0.600 Test Loss: 1.150 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5990164279937744
Epoch: 36, Steps: 3 | Train Loss: 0.101 Vali Loss: 1.154 Vali Acc: 0.625 Test Loss: 1.154 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624988).  Saving model ...
Epoch: 37 cost time: 0.6067368984222412
Epoch: 37, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.156 Vali Acc: 0.625 Test Loss: 1.156 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6110780239105225
Epoch: 38, Steps: 3 | Train Loss: 0.082 Vali Loss: 1.156 Vali Acc: 0.625 Test Loss: 1.156 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5625498294830322
Epoch: 39, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.155 Vali Acc: 0.625 Test Loss: 1.155 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5047750473022461
Epoch: 40, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.155 Vali Acc: 0.625 Test Loss: 1.155 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5593662261962891
Epoch: 41, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.157 Vali Acc: 0.625 Test Loss: 1.157 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5309765338897705
Epoch: 42, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.161 Vali Acc: 0.625 Test Loss: 1.161 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5657134056091309
Epoch: 43, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.160 Vali Acc: 0.625 Test Loss: 1.160 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6100494861602783
Epoch: 44, Steps: 3 | Train Loss: 0.055 Vali Loss: 1.164 Vali Acc: 0.625 Test Loss: 1.164 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5834872722625732
Epoch: 45, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.168 Vali Acc: 0.625 Test Loss: 1.168 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5944557189941406
Epoch: 46, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 30788
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.076735258102417
Epoch: 1, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.422 Vali Acc: 0.300 Test Loss: 1.422 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5766358375549316
Epoch: 2, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.401 Vali Acc: 0.300 Test Loss: 1.401 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.6544477939605713
Epoch: 3, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.384 Vali Acc: 0.325 Test Loss: 1.384 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.5273411273956299
Epoch: 4, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.366 Vali Acc: 0.325 Test Loss: 1.366 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.5616955757141113
Epoch: 5, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.348 Vali Acc: 0.300 Test Loss: 1.348 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6662759780883789
Epoch: 6, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.329 Vali Acc: 0.325 Test Loss: 1.329 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 7 cost time: 0.5836882591247559
Epoch: 7, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.308 Vali Acc: 0.375 Test Loss: 1.308 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.6983418464660645
Epoch: 8, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.6027681827545166
Epoch: 9, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.267 Vali Acc: 0.425 Test Loss: 1.267 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.6480329036712646
Epoch: 10, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.247 Vali Acc: 0.475 Test Loss: 1.247 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.5323352813720703
Epoch: 11, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.574174165725708
Epoch: 12, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 0.5209767818450928
Epoch: 13, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.6109428405761719
Epoch: 14, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 0.7206025123596191
Epoch: 15, Steps: 3 | Train Loss: 0.858 Vali Loss: 1.158 Vali Acc: 0.525 Test Loss: 1.158 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.5910687446594238
Epoch: 16, Steps: 3 | Train Loss: 0.745 Vali Loss: 1.141 Vali Acc: 0.525 Test Loss: 1.141 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 17 cost time: 0.6248002052307129
Epoch: 17, Steps: 3 | Train Loss: 0.758 Vali Loss: 1.126 Vali Acc: 0.550 Test Loss: 1.126 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 18 cost time: 0.6126701831817627
Epoch: 18, Steps: 3 | Train Loss: 0.678 Vali Loss: 1.111 Vali Acc: 0.550 Test Loss: 1.111 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 19 cost time: 0.5870406627655029
Epoch: 19, Steps: 3 | Train Loss: 0.655 Vali Loss: 1.095 Vali Acc: 0.600 Test Loss: 1.095 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.5950889587402344
Epoch: 20, Steps: 3 | Train Loss: 0.596 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 0.6175284385681152
Epoch: 21, Steps: 3 | Train Loss: 0.541 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.5903444290161133
Epoch: 22, Steps: 3 | Train Loss: 0.560 Vali Loss: 1.056 Vali Acc: 0.625 Test Loss: 1.056 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.6058743000030518
Epoch: 23, Steps: 3 | Train Loss: 0.489 Vali Loss: 1.045 Vali Acc: 0.650 Test Loss: 1.045 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 0.6497476100921631
Epoch: 24, Steps: 3 | Train Loss: 0.419 Vali Loss: 1.036 Vali Acc: 0.650 Test Loss: 1.036 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 25 cost time: 0.6239473819732666
Epoch: 25, Steps: 3 | Train Loss: 0.420 Vali Loss: 1.029 Vali Acc: 0.675 Test Loss: 1.029 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 26 cost time: 0.564030647277832
Epoch: 26, Steps: 3 | Train Loss: 0.409 Vali Loss: 1.018 Vali Acc: 0.675 Test Loss: 1.018 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 27 cost time: 0.5430574417114258
Epoch: 27, Steps: 3 | Train Loss: 0.290 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 28 cost time: 0.6262767314910889
Epoch: 28, Steps: 3 | Train Loss: 0.277 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 29 cost time: 0.6068401336669922
Epoch: 29, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.006 Vali Acc: 0.700 Test Loss: 1.006 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 30 cost time: 0.6150219440460205
Epoch: 30, Steps: 3 | Train Loss: 0.238 Vali Loss: 1.003 Vali Acc: 0.700 Test Loss: 1.003 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 31 cost time: 0.643552303314209
Epoch: 31, Steps: 3 | Train Loss: 0.241 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.6695468425750732
Epoch: 32, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.995 Vali Acc: 0.700 Test Loss: 0.995 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 33 cost time: 0.5730171203613281
Epoch: 33, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.990 Vali Acc: 0.725 Test Loss: 0.990 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 34 cost time: 0.5891401767730713
Epoch: 34, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.983 Vali Acc: 0.775 Test Loss: 0.983 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 35 cost time: 0.5761902332305908
Epoch: 35, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.979 Vali Acc: 0.775 Test Loss: 0.979 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 36 cost time: 0.5665616989135742
Epoch: 36, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.978 Vali Acc: 0.775 Test Loss: 0.978 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 37 cost time: 0.6079916954040527
Epoch: 37, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.981 Vali Acc: 0.775 Test Loss: 0.981 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6520757675170898
Epoch: 38, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.982 Vali Acc: 0.775 Test Loss: 0.982 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6085035800933838
Epoch: 39, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.984 Vali Acc: 0.750 Test Loss: 0.984 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6176700592041016
Epoch: 40, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.989 Vali Acc: 0.725 Test Loss: 0.989 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5513632297515869
Epoch: 41, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.992 Vali Acc: 0.725 Test Loss: 0.992 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5438809394836426
Epoch: 42, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.994 Vali Acc: 0.725 Test Loss: 0.994 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5741422176361084
Epoch: 43, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.994 Vali Acc: 0.725 Test Loss: 0.994 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.582233190536499
Epoch: 44, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.995 Vali Acc: 0.725 Test Loss: 0.995 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.573584794998169
Epoch: 45, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.996 Vali Acc: 0.725 Test Loss: 0.996 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5719366073608398
Epoch: 46, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 29412
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1822803020477295
Epoch: 1, Steps: 3 | Train Loss: 1.604 Vali Loss: 1.497 Vali Acc: 0.200 Test Loss: 1.497 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.6983780860900879
Epoch: 2, Steps: 3 | Train Loss: 1.630 Vali Loss: 1.500 Vali Acc: 0.200 Test Loss: 1.500 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5629732608795166
Epoch: 3, Steps: 3 | Train Loss: 1.517 Vali Loss: 1.502 Vali Acc: 0.250 Test Loss: 1.502 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 0.5760962963104248
Epoch: 4, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.500 Vali Acc: 0.250 Test Loss: 1.500 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 5 cost time: 0.6510951519012451
Epoch: 5, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.495 Vali Acc: 0.250 Test Loss: 1.495 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 6 cost time: 0.6163277626037598
Epoch: 6, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.484 Vali Acc: 0.275 Test Loss: 1.484 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 7 cost time: 0.5937788486480713
Epoch: 7, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.473 Vali Acc: 0.325 Test Loss: 1.473 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324985).  Saving model ...
Epoch: 8 cost time: 0.551954984664917
Epoch: 8, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.459 Vali Acc: 0.300 Test Loss: 1.459 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6378524303436279
Epoch: 9, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.445 Vali Acc: 0.325 Test Loss: 1.445 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324986).  Saving model ...
Epoch: 10 cost time: 0.5887413024902344
Epoch: 10, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.429 Vali Acc: 0.325 Test Loss: 1.429 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 11 cost time: 0.6431984901428223
Epoch: 11, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.413 Vali Acc: 0.325 Test Loss: 1.413 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 12 cost time: 0.6265854835510254
Epoch: 12, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.399 Vali Acc: 0.325 Test Loss: 1.399 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 13 cost time: 0.6536195278167725
Epoch: 13, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.388 Vali Acc: 0.325 Test Loss: 1.388 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 14 cost time: 0.6034708023071289
Epoch: 14, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 15 cost time: 0.5765438079833984
Epoch: 15, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.359 Vali Acc: 0.375 Test Loss: 1.359 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 16 cost time: 0.5719161033630371
Epoch: 16, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.343 Vali Acc: 0.375 Test Loss: 1.343 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 17 cost time: 0.6082193851470947
Epoch: 17, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.330 Vali Acc: 0.375 Test Loss: 1.330 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 18 cost time: 0.5469348430633545
Epoch: 18, Steps: 3 | Train Loss: 0.796 Vali Loss: 1.318 Vali Acc: 0.375 Test Loss: 1.318 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 19 cost time: 0.5924177169799805
Epoch: 19, Steps: 3 | Train Loss: 0.738 Vali Loss: 1.309 Vali Acc: 0.425 Test Loss: 1.309 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 20 cost time: 0.5936555862426758
Epoch: 20, Steps: 3 | Train Loss: 0.702 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7029910087585449
Epoch: 21, Steps: 3 | Train Loss: 0.680 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6278510093688965
Epoch: 22, Steps: 3 | Train Loss: 0.672 Vali Loss: 1.280 Vali Acc: 0.425 Test Loss: 1.280 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 23 cost time: 0.5892314910888672
Epoch: 23, Steps: 3 | Train Loss: 0.558 Vali Loss: 1.273 Vali Acc: 0.425 Test Loss: 1.273 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 24 cost time: 0.604074239730835
Epoch: 24, Steps: 3 | Train Loss: 0.607 Vali Loss: 1.266 Vali Acc: 0.450 Test Loss: 1.266 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 25 cost time: 0.5510380268096924
Epoch: 25, Steps: 3 | Train Loss: 0.660 Vali Loss: 1.255 Vali Acc: 0.475 Test Loss: 1.255 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 26 cost time: 0.6220829486846924
Epoch: 26, Steps: 3 | Train Loss: 0.515 Vali Loss: 1.248 Vali Acc: 0.475 Test Loss: 1.248 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 27 cost time: 0.610440731048584
Epoch: 27, Steps: 3 | Train Loss: 0.535 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 28 cost time: 0.5312902927398682
Epoch: 28, Steps: 3 | Train Loss: 0.419 Vali Loss: 1.235 Vali Acc: 0.525 Test Loss: 1.235 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 29 cost time: 0.5407822132110596
Epoch: 29, Steps: 3 | Train Loss: 0.379 Vali Loss: 1.227 Vali Acc: 0.525 Test Loss: 1.227 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 30 cost time: 0.6080923080444336
Epoch: 30, Steps: 3 | Train Loss: 0.375 Vali Loss: 1.227 Vali Acc: 0.525 Test Loss: 1.227 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 31 cost time: 0.7233936786651611
Epoch: 31, Steps: 3 | Train Loss: 0.332 Vali Loss: 1.227 Vali Acc: 0.525 Test Loss: 1.227 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5934257507324219
Epoch: 32, Steps: 3 | Train Loss: 0.352 Vali Loss: 1.225 Vali Acc: 0.550 Test Loss: 1.225 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 33 cost time: 0.5355348587036133
Epoch: 33, Steps: 3 | Train Loss: 0.272 Vali Loss: 1.223 Vali Acc: 0.550 Test Loss: 1.223 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 34 cost time: 0.5784866809844971
Epoch: 34, Steps: 3 | Train Loss: 0.321 Vali Loss: 1.222 Vali Acc: 0.550 Test Loss: 1.222 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 35 cost time: 0.5356521606445312
Epoch: 35, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.222 Vali Acc: 0.550 Test Loss: 1.222 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5377380847930908
Epoch: 36, Steps: 3 | Train Loss: 0.255 Vali Loss: 1.223 Vali Acc: 0.575 Test Loss: 1.223 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 37 cost time: 0.5855152606964111
Epoch: 37, Steps: 3 | Train Loss: 0.221 Vali Loss: 1.222 Vali Acc: 0.625 Test Loss: 1.222 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 38 cost time: 0.6596114635467529
Epoch: 38, Steps: 3 | Train Loss: 0.218 Vali Loss: 1.224 Vali Acc: 0.600 Test Loss: 1.224 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5632851123809814
Epoch: 39, Steps: 3 | Train Loss: 0.217 Vali Loss: 1.228 Vali Acc: 0.625 Test Loss: 1.228 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6355953216552734
Epoch: 40, Steps: 3 | Train Loss: 0.181 Vali Loss: 1.234 Vali Acc: 0.600 Test Loss: 1.234 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5848641395568848
Epoch: 41, Steps: 3 | Train Loss: 0.212 Vali Loss: 1.238 Vali Acc: 0.600 Test Loss: 1.238 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4966874122619629
Epoch: 42, Steps: 3 | Train Loss: 0.173 Vali Loss: 1.239 Vali Acc: 0.625 Test Loss: 1.239 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6546874046325684
Epoch: 43, Steps: 3 | Train Loss: 0.174 Vali Loss: 1.238 Vali Acc: 0.625 Test Loss: 1.238 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5575742721557617
Epoch: 44, Steps: 3 | Train Loss: 0.133 Vali Loss: 1.237 Vali Acc: 0.650 Test Loss: 1.237 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 45 cost time: 0.6674001216888428
Epoch: 45, Steps: 3 | Train Loss: 0.111 Vali Loss: 1.238 Vali Acc: 0.650 Test Loss: 1.238 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.626969575881958
Epoch: 46, Steps: 3 | Train Loss: 0.147 Vali Loss: 1.237 Vali Acc: 0.650 Test Loss: 1.237 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 47 cost time: 0.5721089839935303
Epoch: 47, Steps: 3 | Train Loss: 0.122 Vali Loss: 1.241 Vali Acc: 0.650 Test Loss: 1.241 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5568902492523193
Epoch: 48, Steps: 3 | Train Loss: 0.110 Vali Loss: 1.243 Vali Acc: 0.650 Test Loss: 1.243 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5380105972290039
Epoch: 49, Steps: 3 | Train Loss: 0.111 Vali Loss: 1.243 Vali Acc: 0.650 Test Loss: 1.243 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6041867733001709
Epoch: 50, Steps: 3 | Train Loss: 0.094 Vali Loss: 1.243 Vali Acc: 0.650 Test Loss: 1.243 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5917894840240479
Epoch: 51, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.244 Vali Acc: 0.650 Test Loss: 1.244 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.5434038639068604
Epoch: 52, Steps: 3 | Train Loss: 0.091 Vali Loss: 1.242 Vali Acc: 0.650 Test Loss: 1.242 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.5473008155822754
Epoch: 53, Steps: 3 | Train Loss: 0.082 Vali Loss: 1.240 Vali Acc: 0.650 Test Loss: 1.240 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.656358003616333
Epoch: 54, Steps: 3 | Train Loss: 0.083 Vali Loss: 1.245 Vali Acc: 0.650 Test Loss: 1.245 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.509657621383667
Epoch: 55, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.243 Vali Acc: 0.650 Test Loss: 1.243 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.6241426467895508
Epoch: 56, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.246 Vali Acc: 0.650 Test Loss: 1.246 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df256_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 27268
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.090601921081543
Epoch: 1, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.373 Vali Acc: 0.325 Test Loss: 1.373 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.6376707553863525
Epoch: 2, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.6406779289245605
Epoch: 3, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.337 Vali Acc: 0.350 Test Loss: 1.337 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5916299819946289
Epoch: 4, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.323 Vali Acc: 0.400 Test Loss: 1.323 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.5807864665985107
Epoch: 5, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.309 Vali Acc: 0.425 Test Loss: 1.309 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.5593752861022949
Epoch: 6, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.264 Vali Acc: 0.425 Test Loss: 1.264 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.6019034385681152
Epoch: 7, Steps: 3 | Train Loss: 0.814 Vali Loss: 1.177 Vali Acc: 0.450 Test Loss: 1.177 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.5867969989776611
Epoch: 8, Steps: 3 | Train Loss: 0.707 Vali Loss: 1.103 Vali Acc: 0.525 Test Loss: 1.103 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524989).  Saving model ...
Epoch: 9 cost time: 0.5788285732269287
Epoch: 9, Steps: 3 | Train Loss: 0.635 Vali Loss: 1.038 Vali Acc: 0.650 Test Loss: 1.038 Test Acc: 0.650
Validation loss decreased (-0.524989 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.6598410606384277
Epoch: 10, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.998 Vali Acc: 0.675 Test Loss: 0.998 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.5909037590026855
Epoch: 11, Steps: 3 | Train Loss: 0.417 Vali Loss: 1.002 Vali Acc: 0.625 Test Loss: 1.002 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.584691047668457
Epoch: 12, Steps: 3 | Train Loss: 0.387 Vali Loss: 1.022 Vali Acc: 0.575 Test Loss: 1.022 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5762646198272705
Epoch: 13, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.987 Vali Acc: 0.600 Test Loss: 0.987 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5411016941070557
Epoch: 14, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.923 Vali Acc: 0.675 Test Loss: 0.923 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 15 cost time: 0.5647954940795898
Epoch: 15, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.877 Vali Acc: 0.700 Test Loss: 0.877 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 0.6226749420166016
Epoch: 16, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.6936850547790527
Epoch: 17, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 0.5656170845031738
Epoch: 18, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.858 Vali Acc: 0.725 Test Loss: 0.858 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7307708263397217
Epoch: 19, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.883 Vali Acc: 0.700 Test Loss: 0.883 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6384282112121582
Epoch: 20, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.917 Vali Acc: 0.725 Test Loss: 0.917 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5880722999572754
Epoch: 21, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.933 Vali Acc: 0.725 Test Loss: 0.933 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6020588874816895
Epoch: 22, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.924 Vali Acc: 0.725 Test Loss: 0.924 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6524441242218018
Epoch: 23, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.897 Vali Acc: 0.725 Test Loss: 0.897 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6715307235717773
Epoch: 24, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7058091163635254
Epoch: 25, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5990414619445801
Epoch: 26, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.854 Vali Acc: 0.750 Test Loss: 0.854 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.598092794418335
Epoch: 27, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.851 Vali Acc: 0.750 Test Loss: 0.851 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 51268
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3050007820129395
Epoch: 1, Steps: 3 | Train Loss: 1.540 Vali Loss: 1.578 Vali Acc: 0.300 Test Loss: 1.578 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.6269564628601074
Epoch: 2, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.520 Vali Acc: 0.275 Test Loss: 1.520 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.591820240020752
Epoch: 3, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.459 Vali Acc: 0.325 Test Loss: 1.459 Test Acc: 0.325
Validation loss decreased (-0.299984 --> -0.324985).  Saving model ...
Epoch: 4 cost time: 0.6447305679321289
Epoch: 4, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.392 Vali Acc: 0.375 Test Loss: 1.392 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.6034178733825684
Epoch: 5, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.326 Vali Acc: 0.425 Test Loss: 1.326 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.5699827671051025
Epoch: 6, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.272 Vali Acc: 0.475 Test Loss: 1.272 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.5033276081085205
Epoch: 7, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.220 Vali Acc: 0.475 Test Loss: 1.220 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.5210661888122559
Epoch: 8, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.171 Vali Acc: 0.600 Test Loss: 1.171 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.6039512157440186
Epoch: 9, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.129 Vali Acc: 0.575 Test Loss: 1.129 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5944504737854004
Epoch: 10, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.097 Vali Acc: 0.550 Test Loss: 1.097 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6493077278137207
Epoch: 11, Steps: 3 | Train Loss: 0.592 Vali Loss: 1.078 Vali Acc: 0.550 Test Loss: 1.078 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6625089645385742
Epoch: 12, Steps: 3 | Train Loss: 0.522 Vali Loss: 1.047 Vali Acc: 0.550 Test Loss: 1.047 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5123939514160156
Epoch: 13, Steps: 3 | Train Loss: 0.492 Vali Loss: 1.008 Vali Acc: 0.575 Test Loss: 1.008 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6082518100738525
Epoch: 14, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.958 Vali Acc: 0.600 Test Loss: 0.958 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.5782670974731445
Epoch: 15, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.923 Vali Acc: 0.650 Test Loss: 0.923 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649991).  Saving model ...
Epoch: 16 cost time: 0.5801529884338379
Epoch: 16, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.899 Vali Acc: 0.650 Test Loss: 0.899 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 17 cost time: 0.6283693313598633
Epoch: 17, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.873 Vali Acc: 0.700 Test Loss: 0.873 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 0.709571361541748
Epoch: 18, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 19 cost time: 0.7139208316802979
Epoch: 19, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.842 Vali Acc: 0.750 Test Loss: 0.842 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 0.6437795162200928
Epoch: 20, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 0.6250436305999756
Epoch: 21, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.6025066375732422
Epoch: 22, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 0.5721468925476074
Epoch: 23, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 0.6039621829986572
Epoch: 24, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.814 Vali Acc: 0.725 Test Loss: 0.814 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5762109756469727
Epoch: 25, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.809 Vali Acc: 0.725 Test Loss: 0.809 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6605851650238037
Epoch: 26, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.803 Vali Acc: 0.725 Test Loss: 0.803 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6216115951538086
Epoch: 27, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.801 Vali Acc: 0.725 Test Loss: 0.801 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7603178024291992
Epoch: 28, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.798 Vali Acc: 0.725 Test Loss: 0.798 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5794262886047363
Epoch: 29, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.796 Vali Acc: 0.725 Test Loss: 0.796 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6073324680328369
Epoch: 30, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.794 Vali Acc: 0.725 Test Loss: 0.794 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5358819961547852
Epoch: 31, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.795 Vali Acc: 0.725 Test Loss: 0.795 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6364853382110596
Epoch: 32, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.798 Vali Acc: 0.725 Test Loss: 0.798 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5574374198913574
Epoch: 33, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.800 Vali Acc: 0.725 Test Loss: 0.800 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 38276
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2230992317199707
Epoch: 1, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.518 Vali Acc: 0.250 Test Loss: 1.518 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.5941281318664551
Epoch: 2, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.477 Vali Acc: 0.300 Test Loss: 1.477 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.6100308895111084
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.440 Vali Acc: 0.325 Test Loss: 1.440 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.5363843441009521
Epoch: 4, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.407 Vali Acc: 0.350 Test Loss: 1.407 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.563636302947998
Epoch: 5, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.378 Vali Acc: 0.375 Test Loss: 1.378 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.5880601406097412
Epoch: 6, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.354 Vali Acc: 0.425 Test Loss: 1.354 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 0.5091266632080078
Epoch: 7, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.328 Vali Acc: 0.400 Test Loss: 1.328 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5786757469177246
Epoch: 8, Steps: 3 | Train Loss: 0.955 Vali Loss: 1.304 Vali Acc: 0.400 Test Loss: 1.304 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5498027801513672
Epoch: 9, Steps: 3 | Train Loss: 0.840 Vali Loss: 1.275 Vali Acc: 0.425 Test Loss: 1.275 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.6084499359130859
Epoch: 10, Steps: 3 | Train Loss: 0.757 Vali Loss: 1.241 Vali Acc: 0.450 Test Loss: 1.241 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 11 cost time: 0.5742077827453613
Epoch: 11, Steps: 3 | Train Loss: 0.727 Vali Loss: 1.210 Vali Acc: 0.525 Test Loss: 1.210 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 0.5244777202606201
Epoch: 12, Steps: 3 | Train Loss: 0.598 Vali Loss: 1.169 Vali Acc: 0.525 Test Loss: 1.169 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 0.5882740020751953
Epoch: 13, Steps: 3 | Train Loss: 0.558 Vali Loss: 1.133 Vali Acc: 0.550 Test Loss: 1.133 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 14 cost time: 0.566868782043457
Epoch: 14, Steps: 3 | Train Loss: 0.495 Vali Loss: 1.106 Vali Acc: 0.625 Test Loss: 1.106 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.5894107818603516
Epoch: 15, Steps: 3 | Train Loss: 0.384 Vali Loss: 1.077 Vali Acc: 0.675 Test Loss: 1.077 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 0.5247161388397217
Epoch: 16, Steps: 3 | Train Loss: 0.346 Vali Loss: 1.054 Vali Acc: 0.650 Test Loss: 1.054 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5637671947479248
Epoch: 17, Steps: 3 | Train Loss: 0.278 Vali Loss: 1.033 Vali Acc: 0.650 Test Loss: 1.033 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5371341705322266
Epoch: 18, Steps: 3 | Train Loss: 0.241 Vali Loss: 1.019 Vali Acc: 0.650 Test Loss: 1.019 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5458059310913086
Epoch: 19, Steps: 3 | Train Loss: 0.227 Vali Loss: 1.004 Vali Acc: 0.650 Test Loss: 1.004 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6417934894561768
Epoch: 20, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.993 Vali Acc: 0.675 Test Loss: 0.993 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 21 cost time: 0.5503561496734619
Epoch: 21, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.995 Vali Acc: 0.700 Test Loss: 0.995 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 22 cost time: 0.5368967056274414
Epoch: 22, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.005 Vali Acc: 0.675 Test Loss: 1.005 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6005778312683105
Epoch: 23, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.020 Vali Acc: 0.725 Test Loss: 1.020 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 24 cost time: 0.5345463752746582
Epoch: 24, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5644662380218506
Epoch: 25, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.031 Vali Acc: 0.675 Test Loss: 1.031 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5418276786804199
Epoch: 26, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.021 Vali Acc: 0.675 Test Loss: 1.021 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5894653797149658
Epoch: 27, Steps: 3 | Train Loss: 0.055 Vali Loss: 1.010 Vali Acc: 0.675 Test Loss: 1.010 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5655117034912109
Epoch: 28, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.998 Vali Acc: 0.700 Test Loss: 0.998 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5370683670043945
Epoch: 29, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.987 Vali Acc: 0.700 Test Loss: 0.987 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6540117263793945
Epoch: 30, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.981 Vali Acc: 0.700 Test Loss: 0.981 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6400611400604248
Epoch: 31, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.980 Vali Acc: 0.700 Test Loss: 0.980 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5461304187774658
Epoch: 32, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.984 Vali Acc: 0.700 Test Loss: 0.984 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5248003005981445
Epoch: 33, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.985 Vali Acc: 0.750 Test Loss: 0.985 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 34 cost time: 0.5432860851287842
Epoch: 34, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.986 Vali Acc: 0.750 Test Loss: 0.986 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5970518589019775
Epoch: 35, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.989 Vali Acc: 0.750 Test Loss: 0.989 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5602011680603027
Epoch: 36, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5538227558135986
Epoch: 37, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.001 Vali Acc: 0.750 Test Loss: 1.001 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5881917476654053
Epoch: 38, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.006 Vali Acc: 0.750 Test Loss: 1.006 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6162958145141602
Epoch: 39, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.011 Vali Acc: 0.750 Test Loss: 1.011 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5792217254638672
Epoch: 40, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6454689502716064
Epoch: 41, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.018 Vali Acc: 0.725 Test Loss: 1.018 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5667345523834229
Epoch: 42, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.018 Vali Acc: 0.725 Test Loss: 1.018 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5801377296447754
Epoch: 43, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.020 Vali Acc: 0.725 Test Loss: 1.020 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 32228
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2744140625
Epoch: 1, Steps: 3 | Train Loss: 1.622 Vali Loss: 1.454 Vali Acc: 0.300 Test Loss: 1.454 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.5413384437561035
Epoch: 2, Steps: 3 | Train Loss: 1.600 Vali Loss: 1.428 Vali Acc: 0.300 Test Loss: 1.428 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.614659309387207
Epoch: 3, Steps: 3 | Train Loss: 1.510 Vali Loss: 1.398 Vali Acc: 0.325 Test Loss: 1.398 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.4929337501525879
Epoch: 4, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.358 Vali Acc: 0.325 Test Loss: 1.358 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.6798410415649414
Epoch: 5, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.313 Vali Acc: 0.375 Test Loss: 1.313 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.5771815776824951
Epoch: 6, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.269 Vali Acc: 0.450 Test Loss: 1.269 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.5671360492706299
Epoch: 7, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.224 Vali Acc: 0.475 Test Loss: 1.224 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.5131440162658691
Epoch: 8, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.5818252563476562
Epoch: 9, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.154 Vali Acc: 0.550 Test Loss: 1.154 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.5840964317321777
Epoch: 10, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.124 Vali Acc: 0.575 Test Loss: 1.124 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.6099791526794434
Epoch: 11, Steps: 3 | Train Loss: 0.757 Vali Loss: 1.096 Vali Acc: 0.575 Test Loss: 1.096 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.5551817417144775
Epoch: 12, Steps: 3 | Train Loss: 0.658 Vali Loss: 1.073 Vali Acc: 0.575 Test Loss: 1.073 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.6467723846435547
Epoch: 13, Steps: 3 | Train Loss: 0.615 Vali Loss: 1.054 Vali Acc: 0.550 Test Loss: 1.054 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6503567695617676
Epoch: 14, Steps: 3 | Train Loss: 0.559 Vali Loss: 1.030 Vali Acc: 0.575 Test Loss: 1.030 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 15 cost time: 0.573082685470581
Epoch: 15, Steps: 3 | Train Loss: 0.488 Vali Loss: 1.010 Vali Acc: 0.625 Test Loss: 1.010 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624990).  Saving model ...
Epoch: 16 cost time: 0.60793137550354
Epoch: 16, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.995 Vali Acc: 0.650 Test Loss: 0.995 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 0.7095158100128174
Epoch: 17, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.980 Vali Acc: 0.650 Test Loss: 0.980 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 18 cost time: 0.6124112606048584
Epoch: 18, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.959 Vali Acc: 0.675 Test Loss: 0.959 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 19 cost time: 0.6782777309417725
Epoch: 19, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.941 Vali Acc: 0.675 Test Loss: 0.941 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 20 cost time: 0.5994548797607422
Epoch: 20, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.928 Vali Acc: 0.725 Test Loss: 0.928 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 21 cost time: 0.5381307601928711
Epoch: 21, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.918 Vali Acc: 0.725 Test Loss: 0.918 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 22 cost time: 0.5745470523834229
Epoch: 22, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.913 Vali Acc: 0.775 Test Loss: 0.913 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 23 cost time: 0.6293759346008301
Epoch: 23, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.916 Vali Acc: 0.775 Test Loss: 0.916 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5216083526611328
Epoch: 24, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.919 Vali Acc: 0.750 Test Loss: 0.919 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6659679412841797
Epoch: 25, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5869624614715576
Epoch: 26, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.917 Vali Acc: 0.750 Test Loss: 0.917 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6319994926452637
Epoch: 27, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.915 Vali Acc: 0.750 Test Loss: 0.915 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5658161640167236
Epoch: 28, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.916 Vali Acc: 0.750 Test Loss: 0.916 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5645427703857422
Epoch: 29, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.916 Vali Acc: 0.750 Test Loss: 0.916 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5534927845001221
Epoch: 30, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6086559295654297
Epoch: 31, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6284544467926025
Epoch: 32, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 28452
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1255383491516113
Epoch: 1, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.489 Vali Acc: 0.150 Test Loss: 1.489 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 0.506256103515625
Epoch: 2, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.488 Vali Acc: 0.175 Test Loss: 1.488 Test Acc: 0.175
Validation loss decreased (-0.149985 --> -0.174985).  Saving model ...
Epoch: 3 cost time: 0.5474212169647217
Epoch: 3, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.487 Vali Acc: 0.150 Test Loss: 1.487 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5611584186553955
Epoch: 4, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.481 Vali Acc: 0.200 Test Loss: 1.481 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 5 cost time: 0.5327413082122803
Epoch: 5, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.468 Vali Acc: 0.200 Test Loss: 1.468 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 6 cost time: 0.5597307682037354
Epoch: 6, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.449 Vali Acc: 0.200 Test Loss: 1.449 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199986).  Saving model ...
Epoch: 7 cost time: 0.5876266956329346
Epoch: 7, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.428 Vali Acc: 0.250 Test Loss: 1.428 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 8 cost time: 0.5174236297607422
Epoch: 8, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.402 Vali Acc: 0.350 Test Loss: 1.402 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.5626673698425293
Epoch: 9, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.375 Vali Acc: 0.400 Test Loss: 1.375 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.49419665336608887
Epoch: 10, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.350 Vali Acc: 0.400 Test Loss: 1.350 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 0.5322723388671875
Epoch: 11, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.324 Vali Acc: 0.425 Test Loss: 1.324 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 12 cost time: 0.49452781677246094
Epoch: 12, Steps: 3 | Train Loss: 0.882 Vali Loss: 1.300 Vali Acc: 0.425 Test Loss: 1.300 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 0.5523266792297363
Epoch: 13, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.276 Vali Acc: 0.450 Test Loss: 1.276 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 14 cost time: 0.5280060768127441
Epoch: 14, Steps: 3 | Train Loss: 0.795 Vali Loss: 1.258 Vali Acc: 0.475 Test Loss: 1.258 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 15 cost time: 0.5320956707000732
Epoch: 15, Steps: 3 | Train Loss: 0.697 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 0.5112676620483398
Epoch: 16, Steps: 3 | Train Loss: 0.742 Vali Loss: 1.225 Vali Acc: 0.525 Test Loss: 1.225 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.47916173934936523
Epoch: 17, Steps: 3 | Train Loss: 0.705 Vali Loss: 1.211 Vali Acc: 0.550 Test Loss: 1.211 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 18 cost time: 0.5869042873382568
Epoch: 18, Steps: 3 | Train Loss: 0.559 Vali Loss: 1.201 Vali Acc: 0.575 Test Loss: 1.201 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.46828269958496094
Epoch: 19, Steps: 3 | Train Loss: 0.547 Vali Loss: 1.189 Vali Acc: 0.600 Test Loss: 1.189 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 20 cost time: 0.5589513778686523
Epoch: 20, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.178 Vali Acc: 0.600 Test Loss: 1.178 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 21 cost time: 0.4979434013366699
Epoch: 21, Steps: 3 | Train Loss: 0.411 Vali Loss: 1.168 Vali Acc: 0.600 Test Loss: 1.168 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 0.48694849014282227
Epoch: 22, Steps: 3 | Train Loss: 0.404 Vali Loss: 1.156 Vali Acc: 0.600 Test Loss: 1.156 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 23 cost time: 0.5084164142608643
Epoch: 23, Steps: 3 | Train Loss: 0.374 Vali Loss: 1.147 Vali Acc: 0.600 Test Loss: 1.147 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 24 cost time: 0.5380642414093018
Epoch: 24, Steps: 3 | Train Loss: 0.365 Vali Loss: 1.140 Vali Acc: 0.600 Test Loss: 1.140 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 0.4668262004852295
Epoch: 25, Steps: 3 | Train Loss: 0.333 Vali Loss: 1.135 Vali Acc: 0.575 Test Loss: 1.135 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5727100372314453
Epoch: 26, Steps: 3 | Train Loss: 0.278 Vali Loss: 1.130 Vali Acc: 0.600 Test Loss: 1.130 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 0.5400736331939697
Epoch: 27, Steps: 3 | Train Loss: 0.274 Vali Loss: 1.132 Vali Acc: 0.600 Test Loss: 1.132 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5713152885437012
Epoch: 28, Steps: 3 | Train Loss: 0.210 Vali Loss: 1.132 Vali Acc: 0.600 Test Loss: 1.132 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5289604663848877
Epoch: 29, Steps: 3 | Train Loss: 0.189 Vali Loss: 1.133 Vali Acc: 0.625 Test Loss: 1.133 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 30 cost time: 0.5351674556732178
Epoch: 30, Steps: 3 | Train Loss: 0.163 Vali Loss: 1.134 Vali Acc: 0.625 Test Loss: 1.134 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.47863221168518066
Epoch: 31, Steps: 3 | Train Loss: 0.163 Vali Loss: 1.132 Vali Acc: 0.625 Test Loss: 1.132 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 32 cost time: 0.6446280479431152
Epoch: 32, Steps: 3 | Train Loss: 0.148 Vali Loss: 1.138 Vali Acc: 0.625 Test Loss: 1.138 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5454456806182861
Epoch: 33, Steps: 3 | Train Loss: 0.122 Vali Loss: 1.146 Vali Acc: 0.625 Test Loss: 1.146 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5723607540130615
Epoch: 34, Steps: 3 | Train Loss: 0.117 Vali Loss: 1.154 Vali Acc: 0.625 Test Loss: 1.154 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5691831111907959
Epoch: 35, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.161 Vali Acc: 0.600 Test Loss: 1.161 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5293006896972656
Epoch: 36, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.163 Vali Acc: 0.600 Test Loss: 1.163 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.49791646003723145
Epoch: 37, Steps: 3 | Train Loss: 0.091 Vali Loss: 1.166 Vali Acc: 0.600 Test Loss: 1.166 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5658261775970459
Epoch: 38, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.165 Vali Acc: 0.625 Test Loss: 1.165 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.505018949508667
Epoch: 39, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.164 Vali Acc: 0.625 Test Loss: 1.164 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.517935037612915
Epoch: 40, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.167 Vali Acc: 0.625 Test Loss: 1.167 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.564908504486084
Epoch: 41, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.164 Vali Acc: 0.625 Test Loss: 1.164 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 22468
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2565860748291016
Epoch: 1, Steps: 3 | Train Loss: 1.545 Vali Loss: 1.423 Vali Acc: 0.275 Test Loss: 1.423 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.544424295425415
Epoch: 2, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.412 Vali Acc: 0.300 Test Loss: 1.412 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.550898551940918
Epoch: 3, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.407 Vali Acc: 0.300 Test Loss: 1.407 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.5415968894958496
Epoch: 4, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.397 Vali Acc: 0.250 Test Loss: 1.397 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6056818962097168
Epoch: 5, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5907032489776611
Epoch: 6, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.371 Vali Acc: 0.350 Test Loss: 1.371 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.5924651622772217
Epoch: 7, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.357 Vali Acc: 0.375 Test Loss: 1.357 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.5651845932006836
Epoch: 8, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.341 Vali Acc: 0.375 Test Loss: 1.341 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 0.5577797889709473
Epoch: 9, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.322 Vali Acc: 0.375 Test Loss: 1.322 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 0.5963468551635742
Epoch: 10, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.307 Vali Acc: 0.375 Test Loss: 1.307 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 11 cost time: 0.5154778957366943
Epoch: 11, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.289 Vali Acc: 0.375 Test Loss: 1.289 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 12 cost time: 0.6061792373657227
Epoch: 12, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.273 Vali Acc: 0.400 Test Loss: 1.273 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 0.6313626766204834
Epoch: 13, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.258 Vali Acc: 0.400 Test Loss: 1.258 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 0.5682318210601807
Epoch: 14, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 0.537682056427002
Epoch: 15, Steps: 3 | Train Loss: 0.791 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 0.5921483039855957
Epoch: 16, Steps: 3 | Train Loss: 0.737 Vali Loss: 1.212 Vali Acc: 0.450 Test Loss: 1.212 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449988).  Saving model ...
Epoch: 17 cost time: 0.5249438285827637
Epoch: 17, Steps: 3 | Train Loss: 0.711 Vali Loss: 1.196 Vali Acc: 0.550 Test Loss: 1.196 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549988).  Saving model ...
Epoch: 18 cost time: 0.541459321975708
Epoch: 18, Steps: 3 | Train Loss: 0.658 Vali Loss: 1.182 Vali Acc: 0.575 Test Loss: 1.182 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.5030019283294678
Epoch: 19, Steps: 3 | Train Loss: 0.573 Vali Loss: 1.169 Vali Acc: 0.600 Test Loss: 1.169 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 20 cost time: 0.5125997066497803
Epoch: 20, Steps: 3 | Train Loss: 0.609 Vali Loss: 1.154 Vali Acc: 0.625 Test Loss: 1.154 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 21 cost time: 0.5630233287811279
Epoch: 21, Steps: 3 | Train Loss: 0.561 Vali Loss: 1.143 Vali Acc: 0.650 Test Loss: 1.143 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 22 cost time: 0.5627143383026123
Epoch: 22, Steps: 3 | Train Loss: 0.489 Vali Loss: 1.130 Vali Acc: 0.650 Test Loss: 1.130 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 23 cost time: 0.5702505111694336
Epoch: 23, Steps: 3 | Train Loss: 0.465 Vali Loss: 1.118 Vali Acc: 0.650 Test Loss: 1.118 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.5506532192230225
Epoch: 24, Steps: 3 | Train Loss: 0.422 Vali Loss: 1.111 Vali Acc: 0.675 Test Loss: 1.111 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.5071086883544922
Epoch: 25, Steps: 3 | Train Loss: 0.389 Vali Loss: 1.104 Vali Acc: 0.675 Test Loss: 1.104 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.5692873001098633
Epoch: 26, Steps: 3 | Train Loss: 0.335 Vali Loss: 1.098 Vali Acc: 0.675 Test Loss: 1.098 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 27 cost time: 0.5641295909881592
Epoch: 27, Steps: 3 | Train Loss: 0.321 Vali Loss: 1.093 Vali Acc: 0.650 Test Loss: 1.093 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5827682018280029
Epoch: 28, Steps: 3 | Train Loss: 0.331 Vali Loss: 1.090 Vali Acc: 0.650 Test Loss: 1.090 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7429289817810059
Epoch: 29, Steps: 3 | Train Loss: 0.317 Vali Loss: 1.087 Vali Acc: 0.650 Test Loss: 1.087 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.601048469543457
Epoch: 30, Steps: 3 | Train Loss: 0.240 Vali Loss: 1.083 Vali Acc: 0.625 Test Loss: 1.083 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6291341781616211
Epoch: 31, Steps: 3 | Train Loss: 0.209 Vali Loss: 1.080 Vali Acc: 0.625 Test Loss: 1.080 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5718345642089844
Epoch: 32, Steps: 3 | Train Loss: 0.227 Vali Loss: 1.080 Vali Acc: 0.625 Test Loss: 1.080 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5459041595458984
Epoch: 33, Steps: 3 | Train Loss: 0.206 Vali Loss: 1.083 Vali Acc: 0.650 Test Loss: 1.083 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6616930961608887
Epoch: 34, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.085 Vali Acc: 0.650 Test Loss: 1.085 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6637985706329346
Epoch: 35, Steps: 3 | Train Loss: 0.177 Vali Loss: 1.083 Vali Acc: 0.675 Test Loss: 1.083 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 36 cost time: 0.6168382167816162
Epoch: 36, Steps: 3 | Train Loss: 0.136 Vali Loss: 1.083 Vali Acc: 0.650 Test Loss: 1.083 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5627679824829102
Epoch: 37, Steps: 3 | Train Loss: 0.124 Vali Loss: 1.078 Vali Acc: 0.650 Test Loss: 1.078 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5763921737670898
Epoch: 38, Steps: 3 | Train Loss: 0.115 Vali Loss: 1.074 Vali Acc: 0.650 Test Loss: 1.074 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.595313549041748
Epoch: 39, Steps: 3 | Train Loss: 0.121 Vali Loss: 1.074 Vali Acc: 0.650 Test Loss: 1.074 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5625932216644287
Epoch: 40, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.074 Vali Acc: 0.650 Test Loss: 1.074 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6425809860229492
Epoch: 41, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.074 Vali Acc: 0.650 Test Loss: 1.074 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.567577600479126
Epoch: 42, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.076 Vali Acc: 0.650 Test Loss: 1.076 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.637653112411499
Epoch: 43, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.078 Vali Acc: 0.650 Test Loss: 1.078 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.662116527557373
Epoch: 44, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.080 Vali Acc: 0.675 Test Loss: 1.080 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 45 cost time: 0.5553278923034668
Epoch: 45, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.083 Vali Acc: 0.675 Test Loss: 1.083 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5967800617218018
Epoch: 46, Steps: 3 | Train Loss: 0.079 Vali Loss: 1.087 Vali Acc: 0.675 Test Loss: 1.087 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5920238494873047
Epoch: 47, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.090 Vali Acc: 0.675 Test Loss: 1.090 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6599822044372559
Epoch: 48, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.092 Vali Acc: 0.675 Test Loss: 1.092 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6165771484375
Epoch: 49, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.093 Vali Acc: 0.675 Test Loss: 1.093 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6233060359954834
Epoch: 50, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.096 Vali Acc: 0.675 Test Loss: 1.096 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5159637928009033
Epoch: 51, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.099 Vali Acc: 0.675 Test Loss: 1.099 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5222458839416504
Epoch: 52, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.104 Vali Acc: 0.675 Test Loss: 1.104 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.5461535453796387
Epoch: 53, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.107 Vali Acc: 0.675 Test Loss: 1.107 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.623967170715332
Epoch: 54, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.110 Vali Acc: 0.675 Test Loss: 1.110 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 21092
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1828393936157227
Epoch: 1, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.389 Vali Acc: 0.450 Test Loss: 1.389 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.568446159362793
Epoch: 2, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.376 Vali Acc: 0.450 Test Loss: 1.376 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 0.657752275466919
Epoch: 3, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.370 Vali Acc: 0.475 Test Loss: 1.370 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 4 cost time: 0.5348889827728271
Epoch: 4, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.366 Vali Acc: 0.475 Test Loss: 1.366 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 5 cost time: 0.5883400440216064
Epoch: 5, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.360 Vali Acc: 0.500 Test Loss: 1.360 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 0.5585236549377441
Epoch: 6, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.353 Vali Acc: 0.475 Test Loss: 1.353 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5942251682281494
Epoch: 7, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.346 Vali Acc: 0.475 Test Loss: 1.346 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5353248119354248
Epoch: 8, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.339 Vali Acc: 0.500 Test Loss: 1.339 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.5808939933776855
Epoch: 9, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.330 Vali Acc: 0.525 Test Loss: 1.330 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 0.5741710662841797
Epoch: 10, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.320 Vali Acc: 0.500 Test Loss: 1.320 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5715560913085938
Epoch: 11, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.311 Vali Acc: 0.500 Test Loss: 1.311 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7008421421051025
Epoch: 12, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.302 Vali Acc: 0.500 Test Loss: 1.302 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6560556888580322
Epoch: 13, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.296 Vali Acc: 0.500 Test Loss: 1.296 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.774815559387207
Epoch: 14, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.289 Vali Acc: 0.500 Test Loss: 1.289 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6252000331878662
Epoch: 15, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.282 Vali Acc: 0.475 Test Loss: 1.282 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5546591281890869
Epoch: 16, Steps: 3 | Train Loss: 0.869 Vali Loss: 1.275 Vali Acc: 0.475 Test Loss: 1.275 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6443452835083008
Epoch: 17, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.267 Vali Acc: 0.450 Test Loss: 1.267 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7103016376495361
Epoch: 18, Steps: 3 | Train Loss: 0.849 Vali Loss: 1.262 Vali Acc: 0.450 Test Loss: 1.262 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6332097053527832
Epoch: 19, Steps: 3 | Train Loss: 0.813 Vali Loss: 1.257 Vali Acc: 0.450 Test Loss: 1.257 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df128_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.525
model parameter : 18948
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2867252826690674
Epoch: 1, Steps: 3 | Train Loss: 1.564 Vali Loss: 1.491 Vali Acc: 0.200 Test Loss: 1.491 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.5510048866271973
Epoch: 2, Steps: 3 | Train Loss: 1.620 Vali Loss: 1.457 Vali Acc: 0.225 Test Loss: 1.457 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 3 cost time: 0.6472733020782471
Epoch: 3, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.416 Vali Acc: 0.300 Test Loss: 1.416 Test Acc: 0.300
Validation loss decreased (-0.224985 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.5988521575927734
Epoch: 4, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.365 Vali Acc: 0.325 Test Loss: 1.365 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.574526309967041
Epoch: 5, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.309 Vali Acc: 0.325 Test Loss: 1.309 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.6567981243133545
Epoch: 6, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.245 Vali Acc: 0.425 Test Loss: 1.245 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 0.5689132213592529
Epoch: 7, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.196 Vali Acc: 0.450 Test Loss: 1.196 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.6033735275268555
Epoch: 8, Steps: 3 | Train Loss: 0.773 Vali Loss: 1.172 Vali Acc: 0.550 Test Loss: 1.172 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.6154894828796387
Epoch: 9, Steps: 3 | Train Loss: 0.655 Vali Loss: 1.131 Vali Acc: 0.550 Test Loss: 1.131 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 0.6041357517242432
Epoch: 10, Steps: 3 | Train Loss: 0.580 Vali Loss: 1.072 Vali Acc: 0.575 Test Loss: 1.072 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.6296327114105225
Epoch: 11, Steps: 3 | Train Loss: 0.519 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.5789272785186768
Epoch: 12, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.987 Vali Acc: 0.625 Test Loss: 0.987 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 13 cost time: 0.5741801261901855
Epoch: 13, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.965 Vali Acc: 0.725 Test Loss: 0.965 Test Acc: 0.725
Validation loss decreased (-0.624990 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.5604703426361084
Epoch: 14, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.943 Vali Acc: 0.725 Test Loss: 0.943 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 0.5705158710479736
Epoch: 15, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.5914137363433838
Epoch: 16, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.858 Vali Acc: 0.750 Test Loss: 0.858 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.5866885185241699
Epoch: 17, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.829 Vali Acc: 0.800 Test Loss: 0.829 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.5569086074829102
Epoch: 18, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 0.7902805805206299
Epoch: 19, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.839 Vali Acc: 0.800 Test Loss: 0.839 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6251935958862305
Epoch: 20, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.842 Vali Acc: 0.800 Test Loss: 0.842 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5346567630767822
Epoch: 21, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.835 Vali Acc: 0.800 Test Loss: 0.835 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6184966564178467
Epoch: 22, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.815 Vali Acc: 0.800 Test Loss: 0.815 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 23 cost time: 0.6340389251708984
Epoch: 23, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 0.7366323471069336
Epoch: 24, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 0.6347317695617676
Epoch: 25, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.66575026512146
Epoch: 26, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.803 Vali Acc: 0.800 Test Loss: 0.803 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6938667297363281
Epoch: 27, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.811 Vali Acc: 0.800 Test Loss: 0.811 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7324910163879395
Epoch: 28, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.819 Vali Acc: 0.800 Test Loss: 0.819 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6019761562347412
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.824 Vali Acc: 0.800 Test Loss: 0.824 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5953247547149658
Epoch: 30, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.830 Vali Acc: 0.800 Test Loss: 0.830 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5753200054168701
Epoch: 31, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.834 Vali Acc: 0.800 Test Loss: 0.834 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.645125150680542
Epoch: 32, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.835 Vali Acc: 0.800 Test Loss: 0.835 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.557823657989502
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.833 Vali Acc: 0.800 Test Loss: 0.833 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.715050220489502
Epoch: 34, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.832 Vali Acc: 0.800 Test Loss: 0.832 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 47108
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0538079738616943
Epoch: 1, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.353 Vali Acc: 0.250 Test Loss: 1.353 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5440301895141602
Epoch: 2, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.332 Vali Acc: 0.300 Test Loss: 1.332 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.7182047367095947
Epoch: 3, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.308 Vali Acc: 0.325 Test Loss: 1.308 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.562995433807373
Epoch: 4, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.625542402267456
Epoch: 5, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.672147274017334
Epoch: 6, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.220 Vali Acc: 0.525 Test Loss: 1.220 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.5244665145874023
Epoch: 7, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.177 Vali Acc: 0.550 Test Loss: 1.177 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.5838947296142578
Epoch: 8, Steps: 3 | Train Loss: 0.844 Vali Loss: 1.126 Vali Acc: 0.575 Test Loss: 1.126 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.6063826084136963
Epoch: 9, Steps: 3 | Train Loss: 0.758 Vali Loss: 1.076 Vali Acc: 0.650 Test Loss: 1.076 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.6198060512542725
Epoch: 10, Steps: 3 | Train Loss: 0.677 Vali Loss: 1.030 Vali Acc: 0.675 Test Loss: 1.030 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.5411381721496582
Epoch: 11, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.987 Vali Acc: 0.675 Test Loss: 0.987 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.6293933391571045
Epoch: 12, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.952 Vali Acc: 0.675 Test Loss: 0.952 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 0.6091384887695312
Epoch: 13, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.922 Vali Acc: 0.700 Test Loss: 0.922 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 0.6843945980072021
Epoch: 14, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.896 Vali Acc: 0.725 Test Loss: 0.896 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 0.627155065536499
Epoch: 15, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.884 Vali Acc: 0.725 Test Loss: 0.884 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 0.7144410610198975
Epoch: 16, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.875 Vali Acc: 0.700 Test Loss: 0.875 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5688602924346924
Epoch: 17, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.864 Vali Acc: 0.700 Test Loss: 0.864 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.58209228515625
Epoch: 18, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.852 Vali Acc: 0.725 Test Loss: 0.852 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 19 cost time: 0.6164782047271729
Epoch: 19, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.834 Vali Acc: 0.700 Test Loss: 0.834 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5951595306396484
Epoch: 20, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.817 Vali Acc: 0.725 Test Loss: 0.817 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 21 cost time: 0.7181870937347412
Epoch: 21, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.803 Vali Acc: 0.725 Test Loss: 0.803 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 22 cost time: 0.5980014801025391
Epoch: 22, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.801 Vali Acc: 0.725 Test Loss: 0.801 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 23 cost time: 0.5351972579956055
Epoch: 23, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.806 Vali Acc: 0.725 Test Loss: 0.806 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6069369316101074
Epoch: 24, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.811 Vali Acc: 0.725 Test Loss: 0.811 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5333123207092285
Epoch: 25, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.817 Vali Acc: 0.700 Test Loss: 0.817 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5913686752319336
Epoch: 26, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.823 Vali Acc: 0.725 Test Loss: 0.823 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5529429912567139
Epoch: 27, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.829 Vali Acc: 0.700 Test Loss: 0.829 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6674416065216064
Epoch: 28, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.834 Vali Acc: 0.675 Test Loss: 0.834 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5993936061859131
Epoch: 29, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.831 Vali Acc: 0.675 Test Loss: 0.831 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6238460540771484
Epoch: 30, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.829 Vali Acc: 0.675 Test Loss: 0.829 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.48369812965393066
Epoch: 31, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.823 Vali Acc: 0.700 Test Loss: 0.823 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.516181230545044
Epoch: 32, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.817 Vali Acc: 0.725 Test Loss: 0.817 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 34116
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.162912130355835
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.411 Vali Acc: 0.275 Test Loss: 1.411 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6034407615661621
Epoch: 2, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.397 Vali Acc: 0.275 Test Loss: 1.397 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.5413875579833984
Epoch: 3, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.380 Vali Acc: 0.275 Test Loss: 1.380 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.511350154876709
Epoch: 4, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.356 Vali Acc: 0.325 Test Loss: 1.356 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.47622251510620117
Epoch: 5, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.327 Vali Acc: 0.375 Test Loss: 1.327 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.5891859531402588
Epoch: 6, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.297 Vali Acc: 0.425 Test Loss: 1.297 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.5039639472961426
Epoch: 7, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.268 Vali Acc: 0.400 Test Loss: 1.268 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.49876880645751953
Epoch: 8, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.236 Vali Acc: 0.450 Test Loss: 1.236 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 0.5038204193115234
Epoch: 9, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.202 Vali Acc: 0.475 Test Loss: 1.202 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 0.5276744365692139
Epoch: 10, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.174 Vali Acc: 0.525 Test Loss: 1.174 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.564476728439331
Epoch: 11, Steps: 3 | Train Loss: 0.617 Vali Loss: 1.147 Vali Acc: 0.600 Test Loss: 1.147 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.5223307609558105
Epoch: 12, Steps: 3 | Train Loss: 0.582 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.5466797351837158
Epoch: 13, Steps: 3 | Train Loss: 0.541 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.5436787605285645
Epoch: 14, Steps: 3 | Train Loss: 0.475 Vali Loss: 1.083 Vali Acc: 0.600 Test Loss: 1.083 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.5150983333587646
Epoch: 15, Steps: 3 | Train Loss: 0.382 Vali Loss: 1.073 Vali Acc: 0.575 Test Loss: 1.073 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5373952388763428
Epoch: 16, Steps: 3 | Train Loss: 0.410 Vali Loss: 1.063 Vali Acc: 0.550 Test Loss: 1.063 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5297486782073975
Epoch: 17, Steps: 3 | Train Loss: 0.328 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.5133609771728516
Epoch: 18, Steps: 3 | Train Loss: 0.270 Vali Loss: 1.048 Vali Acc: 0.625 Test Loss: 1.048 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 19 cost time: 0.4954712390899658
Epoch: 19, Steps: 3 | Train Loss: 0.226 Vali Loss: 1.037 Vali Acc: 0.675 Test Loss: 1.037 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 20 cost time: 0.586658239364624
Epoch: 20, Steps: 3 | Train Loss: 0.225 Vali Loss: 1.035 Vali Acc: 0.650 Test Loss: 1.035 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.47278809547424316
Epoch: 21, Steps: 3 | Train Loss: 0.159 Vali Loss: 1.030 Vali Acc: 0.625 Test Loss: 1.030 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5771617889404297
Epoch: 22, Steps: 3 | Train Loss: 0.148 Vali Loss: 1.021 Vali Acc: 0.700 Test Loss: 1.021 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 0.5697760581970215
Epoch: 23, Steps: 3 | Train Loss: 0.116 Vali Loss: 1.011 Vali Acc: 0.700 Test Loss: 1.011 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 24 cost time: 0.5152702331542969
Epoch: 24, Steps: 3 | Train Loss: 0.101 Vali Loss: 1.003 Vali Acc: 0.700 Test Loss: 1.003 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 25 cost time: 0.5303823947906494
Epoch: 25, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.990 Vali Acc: 0.700 Test Loss: 0.990 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 26 cost time: 0.549490213394165
Epoch: 26, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.985 Vali Acc: 0.700 Test Loss: 0.985 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 27 cost time: 0.49442028999328613
Epoch: 27, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.985 Vali Acc: 0.725 Test Loss: 0.985 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 28 cost time: 0.5146222114562988
Epoch: 28, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.993 Vali Acc: 0.700 Test Loss: 0.993 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5977475643157959
Epoch: 29, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5084261894226074
Epoch: 30, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.026 Vali Acc: 0.675 Test Loss: 1.026 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5050737857818604
Epoch: 31, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.040 Vali Acc: 0.675 Test Loss: 1.040 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5133228302001953
Epoch: 32, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6006379127502441
Epoch: 33, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.049 Vali Acc: 0.650 Test Loss: 1.049 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5065221786499023
Epoch: 34, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.053 Vali Acc: 0.675 Test Loss: 1.053 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.45613574981689453
Epoch: 35, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.058 Vali Acc: 0.675 Test Loss: 1.058 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5731480121612549
Epoch: 36, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.061 Vali Acc: 0.675 Test Loss: 1.061 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.47797441482543945
Epoch: 37, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.064 Vali Acc: 0.675 Test Loss: 1.064 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 28068
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.209658145904541
Epoch: 1, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.370 Vali Acc: 0.325 Test Loss: 1.370 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.5371136665344238
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.365 Vali Acc: 0.300 Test Loss: 1.365 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5867841243743896
Epoch: 3, Steps: 3 | Train Loss: 1.524 Vali Loss: 1.362 Vali Acc: 0.350 Test Loss: 1.362 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.5345239639282227
Epoch: 4, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.354 Vali Acc: 0.375 Test Loss: 1.354 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.5559959411621094
Epoch: 5, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.343 Vali Acc: 0.375 Test Loss: 1.343 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.5501546859741211
Epoch: 6, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.329 Vali Acc: 0.375 Test Loss: 1.329 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.5342597961425781
Epoch: 7, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.5505447387695312
Epoch: 8, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.5112593173980713
Epoch: 9, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.277 Vali Acc: 0.425 Test Loss: 1.277 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.5362329483032227
Epoch: 10, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.261 Vali Acc: 0.500 Test Loss: 1.261 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.5044331550598145
Epoch: 11, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.243 Vali Acc: 0.575 Test Loss: 1.243 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 0.48856043815612793
Epoch: 12, Steps: 3 | Train Loss: 0.722 Vali Loss: 1.226 Vali Acc: 0.600 Test Loss: 1.226 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.5803594589233398
Epoch: 13, Steps: 3 | Train Loss: 0.757 Vali Loss: 1.207 Vali Acc: 0.600 Test Loss: 1.207 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 0.5651066303253174
Epoch: 14, Steps: 3 | Train Loss: 0.597 Vali Loss: 1.195 Vali Acc: 0.600 Test Loss: 1.195 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 15 cost time: 0.5159621238708496
Epoch: 15, Steps: 3 | Train Loss: 0.545 Vali Loss: 1.177 Vali Acc: 0.650 Test Loss: 1.177 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 16 cost time: 0.5559329986572266
Epoch: 16, Steps: 3 | Train Loss: 0.510 Vali Loss: 1.157 Vali Acc: 0.625 Test Loss: 1.157 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6078126430511475
Epoch: 17, Steps: 3 | Train Loss: 0.463 Vali Loss: 1.146 Vali Acc: 0.625 Test Loss: 1.146 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5429036617279053
Epoch: 18, Steps: 3 | Train Loss: 0.409 Vali Loss: 1.140 Vali Acc: 0.625 Test Loss: 1.140 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5050544738769531
Epoch: 19, Steps: 3 | Train Loss: 0.337 Vali Loss: 1.132 Vali Acc: 0.650 Test Loss: 1.132 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.49611902236938477
Epoch: 20, Steps: 3 | Train Loss: 0.355 Vali Loss: 1.121 Vali Acc: 0.650 Test Loss: 1.121 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 21 cost time: 0.495927095413208
Epoch: 21, Steps: 3 | Train Loss: 0.261 Vali Loss: 1.115 Vali Acc: 0.650 Test Loss: 1.115 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 22 cost time: 0.5324149131774902
Epoch: 22, Steps: 3 | Train Loss: 0.227 Vali Loss: 1.110 Vali Acc: 0.650 Test Loss: 1.110 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 23 cost time: 0.5176208019256592
Epoch: 23, Steps: 3 | Train Loss: 0.187 Vali Loss: 1.113 Vali Acc: 0.650 Test Loss: 1.113 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5396945476531982
Epoch: 24, Steps: 3 | Train Loss: 0.210 Vali Loss: 1.109 Vali Acc: 0.675 Test Loss: 1.109 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.44740891456604004
Epoch: 25, Steps: 3 | Train Loss: 0.150 Vali Loss: 1.115 Vali Acc: 0.650 Test Loss: 1.115 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.45614194869995117
Epoch: 26, Steps: 3 | Train Loss: 0.121 Vali Loss: 1.125 Vali Acc: 0.650 Test Loss: 1.125 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5315871238708496
Epoch: 27, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.133 Vali Acc: 0.650 Test Loss: 1.133 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5354442596435547
Epoch: 28, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.141 Vali Acc: 0.650 Test Loss: 1.141 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.46953344345092773
Epoch: 29, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.146 Vali Acc: 0.650 Test Loss: 1.146 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.527925968170166
Epoch: 30, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.152 Vali Acc: 0.625 Test Loss: 1.152 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4823789596557617
Epoch: 31, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.153 Vali Acc: 0.675 Test Loss: 1.153 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5531787872314453
Epoch: 32, Steps: 3 | Train Loss: 0.060 Vali Loss: 1.157 Vali Acc: 0.675 Test Loss: 1.157 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.49666929244995117
Epoch: 33, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.155 Vali Acc: 0.675 Test Loss: 1.155 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5384707450866699
Epoch: 34, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.156 Vali Acc: 0.675 Test Loss: 1.156 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 24292
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8484299182891846
Epoch: 1, Steps: 3 | Train Loss: 1.535 Vali Loss: 1.662 Vali Acc: 0.225 Test Loss: 1.662 Test Acc: 0.225
Validation loss decreased (inf --> -0.224983).  Saving model ...
Epoch: 2 cost time: 0.5874488353729248
Epoch: 2, Steps: 3 | Train Loss: 1.573 Vali Loss: 1.648 Vali Acc: 0.225 Test Loss: 1.648 Test Acc: 0.225
Validation loss decreased (-0.224983 --> -0.224984).  Saving model ...
Epoch: 3 cost time: 0.4637794494628906
Epoch: 3, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.637 Vali Acc: 0.225 Test Loss: 1.637 Test Acc: 0.225
Validation loss decreased (-0.224984 --> -0.224984).  Saving model ...
Epoch: 4 cost time: 0.4526982307434082
Epoch: 4, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.623 Vali Acc: 0.250 Test Loss: 1.623 Test Acc: 0.250
Validation loss decreased (-0.224984 --> -0.249984).  Saving model ...
Epoch: 5 cost time: 0.568577766418457
Epoch: 5, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.607 Vali Acc: 0.275 Test Loss: 1.607 Test Acc: 0.275
Validation loss decreased (-0.249984 --> -0.274984).  Saving model ...
Epoch: 6 cost time: 0.44272685050964355
Epoch: 6, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.592 Vali Acc: 0.250 Test Loss: 1.592 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6265368461608887
Epoch: 7, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.572 Vali Acc: 0.325 Test Loss: 1.572 Test Acc: 0.325
Validation loss decreased (-0.274984 --> -0.324984).  Saving model ...
Epoch: 8 cost time: 0.5887937545776367
Epoch: 8, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.548 Vali Acc: 0.350 Test Loss: 1.548 Test Acc: 0.350
Validation loss decreased (-0.324984 --> -0.349985).  Saving model ...
Epoch: 9 cost time: 0.47998595237731934
Epoch: 9, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.526 Vali Acc: 0.350 Test Loss: 1.526 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 10 cost time: 0.5564496517181396
Epoch: 10, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.504 Vali Acc: 0.350 Test Loss: 1.504 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 11 cost time: 0.5162274837493896
Epoch: 11, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.480 Vali Acc: 0.350 Test Loss: 1.480 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 12 cost time: 0.4737560749053955
Epoch: 12, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.457 Vali Acc: 0.400 Test Loss: 1.457 Test Acc: 0.400
Validation loss decreased (-0.349985 --> -0.399985).  Saving model ...
Epoch: 13 cost time: 0.5284097194671631
Epoch: 13, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.438 Vali Acc: 0.425 Test Loss: 1.438 Test Acc: 0.425
Validation loss decreased (-0.399985 --> -0.424986).  Saving model ...
Epoch: 14 cost time: 0.5440948009490967
Epoch: 14, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.418 Vali Acc: 0.425 Test Loss: 1.418 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 15 cost time: 0.4911949634552002
Epoch: 15, Steps: 3 | Train Loss: 0.764 Vali Loss: 1.398 Vali Acc: 0.450 Test Loss: 1.398 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 16 cost time: 0.557687520980835
Epoch: 16, Steps: 3 | Train Loss: 0.722 Vali Loss: 1.382 Vali Acc: 0.450 Test Loss: 1.382 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 17 cost time: 0.6985149383544922
Epoch: 17, Steps: 3 | Train Loss: 0.722 Vali Loss: 1.367 Vali Acc: 0.475 Test Loss: 1.367 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 18 cost time: 0.502770185470581
Epoch: 18, Steps: 3 | Train Loss: 0.646 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499986).  Saving model ...
Epoch: 19 cost time: 0.6302790641784668
Epoch: 19, Steps: 3 | Train Loss: 0.649 Vali Loss: 1.342 Vali Acc: 0.550 Test Loss: 1.342 Test Acc: 0.550
Validation loss decreased (-0.499986 --> -0.549987).  Saving model ...
Epoch: 20 cost time: 0.501558780670166
Epoch: 20, Steps: 3 | Train Loss: 0.507 Vali Loss: 1.331 Vali Acc: 0.575 Test Loss: 1.331 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 21 cost time: 0.5460810661315918
Epoch: 21, Steps: 3 | Train Loss: 0.526 Vali Loss: 1.320 Vali Acc: 0.575 Test Loss: 1.320 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 22 cost time: 0.5347542762756348
Epoch: 22, Steps: 3 | Train Loss: 0.450 Vali Loss: 1.307 Vali Acc: 0.575 Test Loss: 1.307 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 23 cost time: 0.5152852535247803
Epoch: 23, Steps: 3 | Train Loss: 0.445 Vali Loss: 1.298 Vali Acc: 0.575 Test Loss: 1.298 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 24 cost time: 0.5333249568939209
Epoch: 24, Steps: 3 | Train Loss: 0.365 Vali Loss: 1.289 Vali Acc: 0.600 Test Loss: 1.289 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 25 cost time: 0.5417273044586182
Epoch: 25, Steps: 3 | Train Loss: 0.344 Vali Loss: 1.286 Vali Acc: 0.600 Test Loss: 1.286 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 26 cost time: 0.6741390228271484
Epoch: 26, Steps: 3 | Train Loss: 0.319 Vali Loss: 1.283 Vali Acc: 0.600 Test Loss: 1.283 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 27 cost time: 0.5222125053405762
Epoch: 27, Steps: 3 | Train Loss: 0.335 Vali Loss: 1.282 Vali Acc: 0.600 Test Loss: 1.282 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 28 cost time: 0.5111722946166992
Epoch: 28, Steps: 3 | Train Loss: 0.228 Vali Loss: 1.279 Vali Acc: 0.600 Test Loss: 1.279 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 29 cost time: 0.5099442005157471
Epoch: 29, Steps: 3 | Train Loss: 0.252 Vali Loss: 1.283 Vali Acc: 0.600 Test Loss: 1.283 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5608878135681152
Epoch: 30, Steps: 3 | Train Loss: 0.191 Vali Loss: 1.284 Vali Acc: 0.600 Test Loss: 1.284 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4990878105163574
Epoch: 31, Steps: 3 | Train Loss: 0.180 Vali Loss: 1.292 Vali Acc: 0.600 Test Loss: 1.292 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5933446884155273
Epoch: 32, Steps: 3 | Train Loss: 0.151 Vali Loss: 1.301 Vali Acc: 0.600 Test Loss: 1.301 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6262056827545166
Epoch: 33, Steps: 3 | Train Loss: 0.158 Vali Loss: 1.311 Vali Acc: 0.600 Test Loss: 1.311 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5782794952392578
Epoch: 34, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.320 Vali Acc: 0.600 Test Loss: 1.320 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7143697738647461
Epoch: 35, Steps: 3 | Train Loss: 0.133 Vali Loss: 1.325 Vali Acc: 0.600 Test Loss: 1.325 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.46520566940307617
Epoch: 36, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.329 Vali Acc: 0.600 Test Loss: 1.329 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.57071852684021
Epoch: 37, Steps: 3 | Train Loss: 0.107 Vali Loss: 1.331 Vali Acc: 0.600 Test Loss: 1.331 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6171307563781738
Epoch: 38, Steps: 3 | Train Loss: 0.099 Vali Loss: 1.329 Vali Acc: 0.600 Test Loss: 1.329 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.6
model parameter : 18308
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2771668434143066
Epoch: 1, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.449 Vali Acc: 0.100 Test Loss: 1.449 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.5509645938873291
Epoch: 2, Steps: 3 | Train Loss: 1.519 Vali Loss: 1.447 Vali Acc: 0.175 Test Loss: 1.447 Test Acc: 0.175
Validation loss decreased (-0.099986 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 0.6015384197235107
Epoch: 3, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.446 Vali Acc: 0.175 Test Loss: 1.446 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.4919912815093994
Epoch: 4, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.440 Vali Acc: 0.200 Test Loss: 1.440 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 5 cost time: 0.5728366374969482
Epoch: 5, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.431 Vali Acc: 0.200 Test Loss: 1.431 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 6 cost time: 0.5238792896270752
Epoch: 6, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.418 Vali Acc: 0.225 Test Loss: 1.418 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 7 cost time: 0.5526776313781738
Epoch: 7, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.402 Vali Acc: 0.300 Test Loss: 1.402 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 8 cost time: 0.4947996139526367
Epoch: 8, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.385 Vali Acc: 0.300 Test Loss: 1.385 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 9 cost time: 0.5959477424621582
Epoch: 9, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.369 Vali Acc: 0.350 Test Loss: 1.369 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 10 cost time: 0.6419048309326172
Epoch: 10, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.355 Vali Acc: 0.375 Test Loss: 1.355 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 11 cost time: 0.6532065868377686
Epoch: 11, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.336 Vali Acc: 0.450 Test Loss: 1.336 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.5095195770263672
Epoch: 12, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.319 Vali Acc: 0.450 Test Loss: 1.319 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 13 cost time: 0.4917316436767578
Epoch: 13, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.304 Vali Acc: 0.450 Test Loss: 1.304 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 14 cost time: 0.5753257274627686
Epoch: 14, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.284 Vali Acc: 0.425 Test Loss: 1.284 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5649166107177734
Epoch: 15, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.266 Vali Acc: 0.475 Test Loss: 1.266 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 16 cost time: 0.5382013320922852
Epoch: 16, Steps: 3 | Train Loss: 0.712 Vali Loss: 1.249 Vali Acc: 0.475 Test Loss: 1.249 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 17 cost time: 0.5398514270782471
Epoch: 17, Steps: 3 | Train Loss: 0.705 Vali Loss: 1.238 Vali Acc: 0.475 Test Loss: 1.238 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 18 cost time: 0.5062623023986816
Epoch: 18, Steps: 3 | Train Loss: 0.703 Vali Loss: 1.223 Vali Acc: 0.475 Test Loss: 1.223 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 19 cost time: 0.5563828945159912
Epoch: 19, Steps: 3 | Train Loss: 0.687 Vali Loss: 1.205 Vali Acc: 0.550 Test Loss: 1.205 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549988).  Saving model ...
Epoch: 20 cost time: 0.5489649772644043
Epoch: 20, Steps: 3 | Train Loss: 0.618 Vali Loss: 1.190 Vali Acc: 0.525 Test Loss: 1.190 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.48341989517211914
Epoch: 21, Steps: 3 | Train Loss: 0.589 Vali Loss: 1.178 Vali Acc: 0.550 Test Loss: 1.178 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 22 cost time: 0.5613095760345459
Epoch: 22, Steps: 3 | Train Loss: 0.462 Vali Loss: 1.173 Vali Acc: 0.550 Test Loss: 1.173 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 23 cost time: 0.6382067203521729
Epoch: 23, Steps: 3 | Train Loss: 0.453 Vali Loss: 1.164 Vali Acc: 0.550 Test Loss: 1.164 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 24 cost time: 0.5391085147857666
Epoch: 24, Steps: 3 | Train Loss: 0.436 Vali Loss: 1.157 Vali Acc: 0.575 Test Loss: 1.157 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 25 cost time: 0.6389458179473877
Epoch: 25, Steps: 3 | Train Loss: 0.434 Vali Loss: 1.152 Vali Acc: 0.600 Test Loss: 1.152 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 26 cost time: 0.5847940444946289
Epoch: 26, Steps: 3 | Train Loss: 0.381 Vali Loss: 1.147 Vali Acc: 0.600 Test Loss: 1.147 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 0.5752933025360107
Epoch: 27, Steps: 3 | Train Loss: 0.415 Vali Loss: 1.140 Vali Acc: 0.600 Test Loss: 1.140 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 28 cost time: 0.7074582576751709
Epoch: 28, Steps: 3 | Train Loss: 0.268 Vali Loss: 1.133 Vali Acc: 0.600 Test Loss: 1.133 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 29 cost time: 0.5820229053497314
Epoch: 29, Steps: 3 | Train Loss: 0.274 Vali Loss: 1.127 Vali Acc: 0.625 Test Loss: 1.127 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 30 cost time: 0.5885334014892578
Epoch: 30, Steps: 3 | Train Loss: 0.282 Vali Loss: 1.122 Vali Acc: 0.625 Test Loss: 1.122 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 31 cost time: 0.6025781631469727
Epoch: 31, Steps: 3 | Train Loss: 0.279 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 32 cost time: 0.6394000053405762
Epoch: 32, Steps: 3 | Train Loss: 0.188 Vali Loss: 1.117 Vali Acc: 0.650 Test Loss: 1.117 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 33 cost time: 0.5985321998596191
Epoch: 33, Steps: 3 | Train Loss: 0.199 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6076810359954834
Epoch: 34, Steps: 3 | Train Loss: 0.213 Vali Loss: 1.114 Vali Acc: 0.650 Test Loss: 1.114 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 35 cost time: 0.546252965927124
Epoch: 35, Steps: 3 | Train Loss: 0.184 Vali Loss: 1.108 Vali Acc: 0.650 Test Loss: 1.108 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 36 cost time: 0.6285319328308105
Epoch: 36, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5486996173858643
Epoch: 37, Steps: 3 | Train Loss: 0.148 Vali Loss: 1.100 Vali Acc: 0.625 Test Loss: 1.100 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4908723831176758
Epoch: 38, Steps: 3 | Train Loss: 0.143 Vali Loss: 1.097 Vali Acc: 0.625 Test Loss: 1.097 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5890357494354248
Epoch: 39, Steps: 3 | Train Loss: 0.108 Vali Loss: 1.097 Vali Acc: 0.625 Test Loss: 1.097 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5995388031005859
Epoch: 40, Steps: 3 | Train Loss: 0.120 Vali Loss: 1.098 Vali Acc: 0.650 Test Loss: 1.098 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 41 cost time: 0.4931623935699463
Epoch: 41, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.101 Vali Acc: 0.650 Test Loss: 1.101 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5925552845001221
Epoch: 42, Steps: 3 | Train Loss: 0.091 Vali Loss: 1.103 Vali Acc: 0.650 Test Loss: 1.103 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5405402183532715
Epoch: 43, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.100 Vali Acc: 0.650 Test Loss: 1.100 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5424036979675293
Epoch: 44, Steps: 3 | Train Loss: 0.098 Vali Loss: 1.099 Vali Acc: 0.650 Test Loss: 1.099 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5621590614318848
Epoch: 45, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.099 Vali Acc: 0.650 Test Loss: 1.099 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.4768097400665283
Epoch: 46, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.101 Vali Acc: 0.650 Test Loss: 1.101 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5790717601776123
Epoch: 47, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.104 Vali Acc: 0.650 Test Loss: 1.104 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5847036838531494
Epoch: 48, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.103 Vali Acc: 0.650 Test Loss: 1.103 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5573430061340332
Epoch: 49, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.106 Vali Acc: 0.650 Test Loss: 1.106 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.6541295051574707
Epoch: 50, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 16932
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1742208003997803
Epoch: 1, Steps: 3 | Train Loss: 1.640 Vali Loss: 1.463 Vali Acc: 0.300 Test Loss: 1.463 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.6233184337615967
Epoch: 2, Steps: 3 | Train Loss: 1.515 Vali Loss: 1.449 Vali Acc: 0.300 Test Loss: 1.449 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.5701503753662109
Epoch: 3, Steps: 3 | Train Loss: 1.648 Vali Loss: 1.438 Vali Acc: 0.300 Test Loss: 1.438 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.5539021492004395
Epoch: 4, Steps: 3 | Train Loss: 1.541 Vali Loss: 1.426 Vali Acc: 0.300 Test Loss: 1.426 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.5845403671264648
Epoch: 5, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.413 Vali Acc: 0.400 Test Loss: 1.413 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.5471837520599365
Epoch: 6, Steps: 3 | Train Loss: 1.505 Vali Loss: 1.396 Vali Acc: 0.450 Test Loss: 1.396 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 7 cost time: 0.5599849224090576
Epoch: 7, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.378 Vali Acc: 0.450 Test Loss: 1.378 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 8 cost time: 0.561598539352417
Epoch: 8, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.360 Vali Acc: 0.450 Test Loss: 1.360 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 9 cost time: 0.695429801940918
Epoch: 9, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.340 Vali Acc: 0.500 Test Loss: 1.340 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.5756986141204834
Epoch: 10, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.320 Vali Acc: 0.525 Test Loss: 1.320 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 0.5904903411865234
Epoch: 11, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.299 Vali Acc: 0.525 Test Loss: 1.299 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 12 cost time: 0.6016051769256592
Epoch: 12, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.279 Vali Acc: 0.525 Test Loss: 1.279 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 13 cost time: 0.5111773014068604
Epoch: 13, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.263 Vali Acc: 0.525 Test Loss: 1.263 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 14 cost time: 0.5234310626983643
Epoch: 14, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.248 Vali Acc: 0.525 Test Loss: 1.248 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 0.6368269920349121
Epoch: 15, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.229 Vali Acc: 0.525 Test Loss: 1.229 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.5771863460540771
Epoch: 16, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.214 Vali Acc: 0.525 Test Loss: 1.214 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.5728468894958496
Epoch: 17, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.199 Vali Acc: 0.525 Test Loss: 1.199 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 18 cost time: 0.5969364643096924
Epoch: 18, Steps: 3 | Train Loss: 0.892 Vali Loss: 1.188 Vali Acc: 0.525 Test Loss: 1.188 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 19 cost time: 0.6034936904907227
Epoch: 19, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.177 Vali Acc: 0.525 Test Loss: 1.177 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 20 cost time: 0.6833140850067139
Epoch: 20, Steps: 3 | Train Loss: 0.783 Vali Loss: 1.164 Vali Acc: 0.550 Test Loss: 1.164 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 21 cost time: 0.5933215618133545
Epoch: 21, Steps: 3 | Train Loss: 0.735 Vali Loss: 1.153 Vali Acc: 0.575 Test Loss: 1.153 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 22 cost time: 0.5304238796234131
Epoch: 22, Steps: 3 | Train Loss: 0.706 Vali Loss: 1.140 Vali Acc: 0.575 Test Loss: 1.140 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 23 cost time: 0.6144900321960449
Epoch: 23, Steps: 3 | Train Loss: 0.630 Vali Loss: 1.131 Vali Acc: 0.575 Test Loss: 1.131 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 24 cost time: 0.608623743057251
Epoch: 24, Steps: 3 | Train Loss: 0.604 Vali Loss: 1.123 Vali Acc: 0.600 Test Loss: 1.123 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 0.5530555248260498
Epoch: 25, Steps: 3 | Train Loss: 0.635 Vali Loss: 1.114 Vali Acc: 0.575 Test Loss: 1.114 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5676798820495605
Epoch: 26, Steps: 3 | Train Loss: 0.607 Vali Loss: 1.107 Vali Acc: 0.600 Test Loss: 1.107 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 0.6179661750793457
Epoch: 27, Steps: 3 | Train Loss: 0.534 Vali Loss: 1.102 Vali Acc: 0.575 Test Loss: 1.102 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5469083786010742
Epoch: 28, Steps: 3 | Train Loss: 0.512 Vali Loss: 1.096 Vali Acc: 0.575 Test Loss: 1.096 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6079463958740234
Epoch: 29, Steps: 3 | Train Loss: 0.489 Vali Loss: 1.094 Vali Acc: 0.575 Test Loss: 1.094 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6232049465179443
Epoch: 30, Steps: 3 | Train Loss: 0.450 Vali Loss: 1.090 Vali Acc: 0.575 Test Loss: 1.090 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5814754962921143
Epoch: 31, Steps: 3 | Train Loss: 0.418 Vali Loss: 1.085 Vali Acc: 0.575 Test Loss: 1.085 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5347630977630615
Epoch: 32, Steps: 3 | Train Loss: 0.465 Vali Loss: 1.081 Vali Acc: 0.575 Test Loss: 1.081 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5957736968994141
Epoch: 33, Steps: 3 | Train Loss: 0.367 Vali Loss: 1.078 Vali Acc: 0.575 Test Loss: 1.078 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6379554271697998
Epoch: 34, Steps: 3 | Train Loss: 0.345 Vali Loss: 1.076 Vali Acc: 0.575 Test Loss: 1.076 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6556408405303955
Epoch: 35, Steps: 3 | Train Loss: 0.332 Vali Loss: 1.076 Vali Acc: 0.575 Test Loss: 1.076 Test Acc: 0.575
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5984992980957031
Epoch: 36, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.077 Vali Acc: 0.575 Test Loss: 1.077 Test Acc: 0.575
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm32_nh4_df64_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.6
model parameter : 14788
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1209969520568848
Epoch: 1, Steps: 3 | Train Loss: 1.638 Vali Loss: 1.449 Vali Acc: 0.275 Test Loss: 1.449 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6704280376434326
Epoch: 2, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.424 Vali Acc: 0.375 Test Loss: 1.424 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.5458698272705078
Epoch: 3, Steps: 3 | Train Loss: 1.526 Vali Loss: 1.407 Vali Acc: 0.350 Test Loss: 1.407 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5412189960479736
Epoch: 4, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.384 Vali Acc: 0.350 Test Loss: 1.384 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6760642528533936
Epoch: 5, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.364 Vali Acc: 0.350 Test Loss: 1.364 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5956535339355469
Epoch: 6, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.335 Vali Acc: 0.375 Test Loss: 1.335 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.6155376434326172
Epoch: 7, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.5045957565307617
Epoch: 8, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.235 Vali Acc: 0.450 Test Loss: 1.235 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 0.5042729377746582
Epoch: 9, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.582127571105957
Epoch: 10, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.159 Vali Acc: 0.550 Test Loss: 1.159 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.5349972248077393
Epoch: 11, Steps: 3 | Train Loss: 0.823 Vali Loss: 1.117 Vali Acc: 0.600 Test Loss: 1.117 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.54756760597229
Epoch: 12, Steps: 3 | Train Loss: 0.739 Vali Loss: 1.085 Vali Acc: 0.650 Test Loss: 1.085 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 0.5851056575775146
Epoch: 13, Steps: 3 | Train Loss: 0.686 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 14 cost time: 0.631861686706543
Epoch: 14, Steps: 3 | Train Loss: 0.637 Vali Loss: 1.025 Vali Acc: 0.700 Test Loss: 1.025 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.5880153179168701
Epoch: 15, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 0.593245267868042
Epoch: 16, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.970 Vali Acc: 0.700 Test Loss: 0.970 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 0.5443460941314697
Epoch: 17, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 0.5587821006774902
Epoch: 18, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.930 Vali Acc: 0.700 Test Loss: 0.930 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 19 cost time: 0.6041419506072998
Epoch: 19, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.909 Vali Acc: 0.750 Test Loss: 0.909 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.5738906860351562
Epoch: 20, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.5813255310058594
Epoch: 21, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.868 Vali Acc: 0.775 Test Loss: 0.868 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 22 cost time: 0.588829517364502
Epoch: 22, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 23 cost time: 0.5961625576019287
Epoch: 23, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 24 cost time: 0.5732181072235107
Epoch: 24, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 25 cost time: 0.6307992935180664
Epoch: 25, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 26 cost time: 0.49576306343078613
Epoch: 26, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.801 Vali Acc: 0.775 Test Loss: 0.801 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 27 cost time: 0.681605339050293
Epoch: 27, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 28 cost time: 0.5823080539703369
Epoch: 28, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.800 Vali Acc: 0.800 Test Loss: 0.800 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 29 cost time: 0.5143840312957764
Epoch: 29, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.803 Vali Acc: 0.775 Test Loss: 0.803 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5264565944671631
Epoch: 30, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 31 cost time: 0.5289006233215332
Epoch: 31, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.787 Vali Acc: 0.800 Test Loss: 0.787 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 32 cost time: 0.5809128284454346
Epoch: 32, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.777 Vali Acc: 0.800 Test Loss: 0.777 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 33 cost time: 0.6594183444976807
Epoch: 33, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 34 cost time: 0.5977733135223389
Epoch: 34, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.766 Vali Acc: 0.800 Test Loss: 0.766 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 35 cost time: 0.5015854835510254
Epoch: 35, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.763 Vali Acc: 0.800 Test Loss: 0.763 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 36 cost time: 0.6158747673034668
Epoch: 36, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 37 cost time: 0.5247323513031006
Epoch: 37, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 38 cost time: 0.512148380279541
Epoch: 38, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.755 Vali Acc: 0.800 Test Loss: 0.755 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 39 cost time: 0.5195186138153076
Epoch: 39, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 40 cost time: 0.5417928695678711
Epoch: 40, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 41 cost time: 0.5534522533416748
Epoch: 41, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6048569679260254
Epoch: 42, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5844056606292725
Epoch: 43, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6019208431243896
Epoch: 44, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5749912261962891
Epoch: 45, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.761 Vali Acc: 0.800 Test Loss: 0.761 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5419397354125977
Epoch: 46, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.761 Vali Acc: 0.800 Test Loss: 0.761 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5327212810516357
Epoch: 47, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.763 Vali Acc: 0.800 Test Loss: 0.763 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6026122570037842
Epoch: 48, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.765 Vali Acc: 0.800 Test Loss: 0.765 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5373358726501465
Epoch: 49, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.766 Vali Acc: 0.800 Test Loss: 0.766 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.5590066909790039
Epoch: 50, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.766 Vali Acc: 0.800 Test Loss: 0.766 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 28900
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.070554494857788
Epoch: 1, Steps: 3 | Train Loss: 1.549 Vali Loss: 1.351 Vali Acc: 0.350 Test Loss: 1.351 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5826625823974609
Epoch: 2, Steps: 3 | Train Loss: 1.536 Vali Loss: 1.335 Vali Acc: 0.375 Test Loss: 1.335 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.5176060199737549
Epoch: 3, Steps: 3 | Train Loss: 1.558 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.516218900680542
Epoch: 4, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.299 Vali Acc: 0.400 Test Loss: 1.299 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.5577723979949951
Epoch: 5, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.276 Vali Acc: 0.425 Test Loss: 1.276 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.5883941650390625
Epoch: 6, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.249 Vali Acc: 0.475 Test Loss: 1.249 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.5707106590270996
Epoch: 7, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.5349304676055908
Epoch: 8, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.63625168800354
Epoch: 9, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.165 Vali Acc: 0.550 Test Loss: 1.165 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.678471565246582
Epoch: 10, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.140 Vali Acc: 0.550 Test Loss: 1.140 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 0.5795102119445801
Epoch: 11, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.114 Vali Acc: 0.550 Test Loss: 1.114 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 0.6037652492523193
Epoch: 12, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.090 Vali Acc: 0.600 Test Loss: 1.090 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.5553398132324219
Epoch: 13, Steps: 3 | Train Loss: 0.784 Vali Loss: 1.068 Vali Acc: 0.650 Test Loss: 1.068 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 0.5804190635681152
Epoch: 14, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.048 Vali Acc: 0.650 Test Loss: 1.048 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.5537617206573486
Epoch: 15, Steps: 3 | Train Loss: 0.682 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 16 cost time: 0.6120436191558838
Epoch: 16, Steps: 3 | Train Loss: 0.682 Vali Loss: 1.001 Vali Acc: 0.675 Test Loss: 1.001 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 0.5464761257171631
Epoch: 17, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.981 Vali Acc: 0.675 Test Loss: 0.981 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 0.5868520736694336
Epoch: 18, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.963 Vali Acc: 0.675 Test Loss: 0.963 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 19 cost time: 0.5194487571716309
Epoch: 19, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.951 Vali Acc: 0.675 Test Loss: 0.951 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 20 cost time: 0.5884313583374023
Epoch: 20, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.938 Vali Acc: 0.675 Test Loss: 0.938 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 21 cost time: 0.5204794406890869
Epoch: 21, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.926 Vali Acc: 0.700 Test Loss: 0.926 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 22 cost time: 0.6063542366027832
Epoch: 22, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.912 Vali Acc: 0.700 Test Loss: 0.912 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 23 cost time: 0.6198091506958008
Epoch: 23, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.901 Vali Acc: 0.675 Test Loss: 0.901 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.663428544998169
Epoch: 24, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.884 Vali Acc: 0.675 Test Loss: 0.884 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5461106300354004
Epoch: 25, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.870 Vali Acc: 0.675 Test Loss: 0.870 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6499543190002441
Epoch: 26, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.861 Vali Acc: 0.700 Test Loss: 0.861 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 27 cost time: 0.6342971324920654
Epoch: 27, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.852 Vali Acc: 0.700 Test Loss: 0.852 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 28 cost time: 0.5444848537445068
Epoch: 28, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.846 Vali Acc: 0.725 Test Loss: 0.846 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724992).  Saving model ...
Epoch: 29 cost time: 0.6373007297515869
Epoch: 29, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.841 Vali Acc: 0.700 Test Loss: 0.841 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6574897766113281
Epoch: 30, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.838 Vali Acc: 0.725 Test Loss: 0.838 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 31 cost time: 0.5317065715789795
Epoch: 31, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.836 Vali Acc: 0.725 Test Loss: 0.836 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 32 cost time: 0.5362579822540283
Epoch: 32, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 33 cost time: 0.5728192329406738
Epoch: 33, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 34 cost time: 0.5700130462646484
Epoch: 34, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 35 cost time: 0.5812950134277344
Epoch: 35, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.809 Vali Acc: 0.750 Test Loss: 0.809 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 36 cost time: 0.5824406147003174
Epoch: 36, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.806 Vali Acc: 0.750 Test Loss: 0.806 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 37 cost time: 0.5609395503997803
Epoch: 37, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 38 cost time: 0.5119004249572754
Epoch: 38, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 39 cost time: 0.5621848106384277
Epoch: 39, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.792 Vali Acc: 0.750 Test Loss: 0.792 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 40 cost time: 0.5870876312255859
Epoch: 40, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 41 cost time: 0.6175413131713867
Epoch: 41, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 42 cost time: 0.5782763957977295
Epoch: 42, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 43 cost time: 0.5911929607391357
Epoch: 43, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.60154128074646
Epoch: 44, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5686838626861572
Epoch: 45, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5562844276428223
Epoch: 46, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5068333148956299
Epoch: 47, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5046093463897705
Epoch: 48, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.793 Vali Acc: 0.750 Test Loss: 0.793 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5550651550292969
Epoch: 49, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.794 Vali Acc: 0.750 Test Loss: 0.794 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.549363374710083
Epoch: 50, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6183900833129883
Epoch: 51, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6044631004333496
Epoch: 52, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 22404
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2361361980438232
Epoch: 1, Steps: 3 | Train Loss: 1.552 Vali Loss: 1.514 Vali Acc: 0.275 Test Loss: 1.514 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.5418188571929932
Epoch: 2, Steps: 3 | Train Loss: 1.530 Vali Loss: 1.496 Vali Acc: 0.325 Test Loss: 1.496 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.5737752914428711
Epoch: 3, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.483 Vali Acc: 0.350 Test Loss: 1.483 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 4 cost time: 0.5683772563934326
Epoch: 4, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.461 Vali Acc: 0.350 Test Loss: 1.461 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 5 cost time: 0.5697751045227051
Epoch: 5, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.436 Vali Acc: 0.375 Test Loss: 1.436 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.45860791206359863
Epoch: 6, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.405 Vali Acc: 0.425 Test Loss: 1.405 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 0.6626794338226318
Epoch: 7, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.371 Vali Acc: 0.425 Test Loss: 1.371 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 8 cost time: 0.6197359561920166
Epoch: 8, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.342 Vali Acc: 0.475 Test Loss: 1.342 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.5230145454406738
Epoch: 9, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.312 Vali Acc: 0.525 Test Loss: 1.312 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 0.5414276123046875
Epoch: 10, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.280 Vali Acc: 0.525 Test Loss: 1.280 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 0.5691201686859131
Epoch: 11, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.249 Vali Acc: 0.525 Test Loss: 1.249 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 0.4602663516998291
Epoch: 12, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.224 Vali Acc: 0.525 Test Loss: 1.224 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 0.5330581665039062
Epoch: 13, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.203 Vali Acc: 0.550 Test Loss: 1.203 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 0.5463070869445801
Epoch: 14, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.181 Vali Acc: 0.575 Test Loss: 1.181 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 0.588437557220459
Epoch: 15, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.164 Vali Acc: 0.575 Test Loss: 1.164 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 16 cost time: 0.53084397315979
Epoch: 16, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.146 Vali Acc: 0.575 Test Loss: 1.146 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 17 cost time: 0.6105279922485352
Epoch: 17, Steps: 3 | Train Loss: 0.762 Vali Loss: 1.125 Vali Acc: 0.575 Test Loss: 1.125 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 0.5305979251861572
Epoch: 18, Steps: 3 | Train Loss: 0.683 Vali Loss: 1.098 Vali Acc: 0.550 Test Loss: 1.098 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5670318603515625
Epoch: 19, Steps: 3 | Train Loss: 0.629 Vali Loss: 1.071 Vali Acc: 0.550 Test Loss: 1.071 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.609379768371582
Epoch: 20, Steps: 3 | Train Loss: 0.581 Vali Loss: 1.048 Vali Acc: 0.575 Test Loss: 1.048 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 21 cost time: 0.5732326507568359
Epoch: 21, Steps: 3 | Train Loss: 0.483 Vali Loss: 1.030 Vali Acc: 0.625 Test Loss: 1.030 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624990).  Saving model ...
Epoch: 22 cost time: 0.5342450141906738
Epoch: 22, Steps: 3 | Train Loss: 0.477 Vali Loss: 1.014 Vali Acc: 0.650 Test Loss: 1.014 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 23 cost time: 0.5401432514190674
Epoch: 23, Steps: 3 | Train Loss: 0.418 Vali Loss: 1.007 Vali Acc: 0.675 Test Loss: 1.007 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 24 cost time: 0.5689435005187988
Epoch: 24, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.999 Vali Acc: 0.675 Test Loss: 0.999 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 25 cost time: 0.6340744495391846
Epoch: 25, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.994 Vali Acc: 0.650 Test Loss: 0.994 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.583646297454834
Epoch: 26, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.983 Vali Acc: 0.650 Test Loss: 0.983 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6623644828796387
Epoch: 27, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.970 Vali Acc: 0.650 Test Loss: 0.970 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5808150768280029
Epoch: 28, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.952 Vali Acc: 0.650 Test Loss: 0.952 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6565442085266113
Epoch: 29, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.938 Vali Acc: 0.675 Test Loss: 0.938 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 30 cost time: 0.5583770275115967
Epoch: 30, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.936 Vali Acc: 0.675 Test Loss: 0.936 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 31 cost time: 0.5538136959075928
Epoch: 31, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.935 Vali Acc: 0.650 Test Loss: 0.935 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5047361850738525
Epoch: 32, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.932 Vali Acc: 0.650 Test Loss: 0.932 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5595753192901611
Epoch: 33, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.931 Vali Acc: 0.650 Test Loss: 0.931 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5442073345184326
Epoch: 34, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.922 Vali Acc: 0.650 Test Loss: 0.922 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6099343299865723
Epoch: 35, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.915 Vali Acc: 0.650 Test Loss: 0.915 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5881924629211426
Epoch: 36, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.909 Vali Acc: 0.650 Test Loss: 0.909 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.540393590927124
Epoch: 37, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.908 Vali Acc: 0.650 Test Loss: 0.908 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5995385646820068
Epoch: 38, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.909 Vali Acc: 0.675 Test Loss: 0.909 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 39 cost time: 0.6283469200134277
Epoch: 39, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.911 Vali Acc: 0.675 Test Loss: 0.911 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5799121856689453
Epoch: 40, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.912 Vali Acc: 0.675 Test Loss: 0.912 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5866215229034424
Epoch: 41, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.916 Vali Acc: 0.675 Test Loss: 0.916 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.648125410079956
Epoch: 42, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.923 Vali Acc: 0.675 Test Loss: 0.923 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6201488971710205
Epoch: 43, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.923 Vali Acc: 0.675 Test Loss: 0.923 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7275753021240234
Epoch: 44, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.919 Vali Acc: 0.675 Test Loss: 0.919 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5690789222717285
Epoch: 45, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.919 Vali Acc: 0.675 Test Loss: 0.919 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6267390251159668
Epoch: 46, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.915 Vali Acc: 0.675 Test Loss: 0.915 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5678496360778809
Epoch: 47, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.913 Vali Acc: 0.675 Test Loss: 0.913 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5578148365020752
Epoch: 48, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.909 Vali Acc: 0.675 Test Loss: 0.909 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 49 cost time: 0.5443286895751953
Epoch: 49, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.906 Vali Acc: 0.675 Test Loss: 0.906 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 50 cost time: 0.4899873733520508
Epoch: 50, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.903 Vali Acc: 0.675 Test Loss: 0.903 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 51 cost time: 0.5641095638275146
Epoch: 51, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.901 Vali Acc: 0.675 Test Loss: 0.901 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 52 cost time: 0.5752360820770264
Epoch: 52, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.899 Vali Acc: 0.675 Test Loss: 0.899 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 53 cost time: 0.6023781299591064
Epoch: 53, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.899 Vali Acc: 0.675 Test Loss: 0.899 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5959281921386719
Epoch: 54, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.899 Vali Acc: 0.675 Test Loss: 0.899 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.58976149559021
Epoch: 55, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.899 Vali Acc: 0.675 Test Loss: 0.899 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5955655574798584
Epoch: 56, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.897 Vali Acc: 0.675 Test Loss: 0.897 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 57 cost time: 0.5953104496002197
Epoch: 57, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.896 Vali Acc: 0.675 Test Loss: 0.896 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 58 cost time: 0.5946612358093262
Epoch: 58, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.895 Vali Acc: 0.675 Test Loss: 0.895 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 59 cost time: 0.5502340793609619
Epoch: 59, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.894 Vali Acc: 0.675 Test Loss: 0.894 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 60 cost time: 0.585705041885376
Epoch: 60, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.893 Vali Acc: 0.675 Test Loss: 0.893 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 61 cost time: 0.607372522354126
Epoch: 61, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.893 Vali Acc: 0.675 Test Loss: 0.893 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6978120803833008
Epoch: 62, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.894 Vali Acc: 0.675 Test Loss: 0.894 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.6623492240905762
Epoch: 63, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.896 Vali Acc: 0.675 Test Loss: 0.896 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.6836533546447754
Epoch: 64, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.897 Vali Acc: 0.675 Test Loss: 0.897 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.611473560333252
Epoch: 65, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.898 Vali Acc: 0.675 Test Loss: 0.898 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.5208399295806885
Epoch: 66, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.896 Vali Acc: 0.675 Test Loss: 0.896 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.5881478786468506
Epoch: 67, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.895 Vali Acc: 0.675 Test Loss: 0.895 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.667248010635376
Epoch: 68, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.893 Vali Acc: 0.675 Test Loss: 0.893 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 69 cost time: 0.6266751289367676
Epoch: 69, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.891 Vali Acc: 0.675 Test Loss: 0.891 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 70 cost time: 0.6555819511413574
Epoch: 70, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.889 Vali Acc: 0.675 Test Loss: 0.889 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 71 cost time: 0.5937254428863525
Epoch: 71, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.888 Vali Acc: 0.675 Test Loss: 0.888 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 72 cost time: 0.5890066623687744
Epoch: 72, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.887 Vali Acc: 0.675 Test Loss: 0.887 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 73 cost time: 0.6067612171173096
Epoch: 73, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.887 Vali Acc: 0.675 Test Loss: 0.887 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.5841875076293945
Epoch: 74, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.889 Vali Acc: 0.675 Test Loss: 0.889 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.6887969970703125
Epoch: 75, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.889 Vali Acc: 0.675 Test Loss: 0.889 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.7358345985412598
Epoch: 76, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.892 Vali Acc: 0.675 Test Loss: 0.892 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.6044290065765381
Epoch: 77, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.893 Vali Acc: 0.675 Test Loss: 0.893 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.6775734424591064
Epoch: 78, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.897 Vali Acc: 0.675 Test Loss: 0.897 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.5952043533325195
Epoch: 79, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.899 Vali Acc: 0.675 Test Loss: 0.899 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.5782535076141357
Epoch: 80, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.899 Vali Acc: 0.675 Test Loss: 0.899 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.5617172718048096
Epoch: 81, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.901 Vali Acc: 0.675 Test Loss: 0.901 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.6191074848175049
Epoch: 82, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.902 Vali Acc: 0.675 Test Loss: 0.902 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 19380
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3418736457824707
Epoch: 1, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.353 Vali Acc: 0.300 Test Loss: 1.353 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5365171432495117
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.349 Vali Acc: 0.300 Test Loss: 1.349 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.5400171279907227
Epoch: 3, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.345 Vali Acc: 0.325 Test Loss: 1.345 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.5450093746185303
Epoch: 4, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.337 Vali Acc: 0.325 Test Loss: 1.337 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.5143325328826904
Epoch: 5, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.324 Vali Acc: 0.350 Test Loss: 1.324 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.564023494720459
Epoch: 6, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.311 Vali Acc: 0.350 Test Loss: 1.311 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.5964422225952148
Epoch: 7, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.4917275905609131
Epoch: 8, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.647475004196167
Epoch: 9, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.265 Vali Acc: 0.375 Test Loss: 1.265 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5593304634094238
Epoch: 10, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.248 Vali Acc: 0.375 Test Loss: 1.248 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.49099040031433105
Epoch: 11, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.5435938835144043
Epoch: 12, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.212 Vali Acc: 0.425 Test Loss: 1.212 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 13 cost time: 0.5405287742614746
Epoch: 13, Steps: 3 | Train Loss: 0.919 Vali Loss: 1.191 Vali Acc: 0.450 Test Loss: 1.191 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 14 cost time: 0.4987678527832031
Epoch: 14, Steps: 3 | Train Loss: 0.822 Vali Loss: 1.171 Vali Acc: 0.450 Test Loss: 1.171 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 15 cost time: 0.46499133110046387
Epoch: 15, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.152 Vali Acc: 0.475 Test Loss: 1.152 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 16 cost time: 0.4901001453399658
Epoch: 16, Steps: 3 | Train Loss: 0.719 Vali Loss: 1.131 Vali Acc: 0.525 Test Loss: 1.131 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524989).  Saving model ...
Epoch: 17 cost time: 0.4768836498260498
Epoch: 17, Steps: 3 | Train Loss: 0.747 Vali Loss: 1.113 Vali Acc: 0.625 Test Loss: 1.113 Test Acc: 0.625
Validation loss decreased (-0.524989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.5173206329345703
Epoch: 18, Steps: 3 | Train Loss: 0.651 Vali Loss: 1.093 Vali Acc: 0.650 Test Loss: 1.093 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 0.5394461154937744
Epoch: 19, Steps: 3 | Train Loss: 0.676 Vali Loss: 1.075 Vali Acc: 0.650 Test Loss: 1.075 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.5069029331207275
Epoch: 20, Steps: 3 | Train Loss: 0.575 Vali Loss: 1.060 Vali Acc: 0.650 Test Loss: 1.060 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 21 cost time: 0.49515390396118164
Epoch: 21, Steps: 3 | Train Loss: 0.665 Vali Loss: 1.044 Vali Acc: 0.650 Test Loss: 1.044 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 22 cost time: 0.47538042068481445
Epoch: 22, Steps: 3 | Train Loss: 0.476 Vali Loss: 1.031 Vali Acc: 0.625 Test Loss: 1.031 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.47553539276123047
Epoch: 23, Steps: 3 | Train Loss: 0.429 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 0.45287156105041504
Epoch: 24, Steps: 3 | Train Loss: 0.439 Vali Loss: 1.006 Vali Acc: 0.650 Test Loss: 1.006 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 25 cost time: 0.43309593200683594
Epoch: 25, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.994 Vali Acc: 0.675 Test Loss: 0.994 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 26 cost time: 0.46762633323669434
Epoch: 26, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.985 Vali Acc: 0.675 Test Loss: 0.985 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 27 cost time: 0.5186457633972168
Epoch: 27, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.976 Vali Acc: 0.675 Test Loss: 0.976 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 28 cost time: 0.5778965950012207
Epoch: 28, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.968 Vali Acc: 0.675 Test Loss: 0.968 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 29 cost time: 0.6019866466522217
Epoch: 29, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.960 Vali Acc: 0.675 Test Loss: 0.960 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 30 cost time: 0.5280938148498535
Epoch: 30, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.955 Vali Acc: 0.725 Test Loss: 0.955 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 31 cost time: 0.5505790710449219
Epoch: 31, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.952 Vali Acc: 0.725 Test Loss: 0.952 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 32 cost time: 0.570328950881958
Epoch: 32, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.952 Vali Acc: 0.725 Test Loss: 0.952 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 33 cost time: 0.5952703952789307
Epoch: 33, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.956 Vali Acc: 0.700 Test Loss: 0.956 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4962296485900879
Epoch: 34, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.958 Vali Acc: 0.700 Test Loss: 0.958 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5415146350860596
Epoch: 35, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.961 Vali Acc: 0.700 Test Loss: 0.961 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5652174949645996
Epoch: 36, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5153348445892334
Epoch: 37, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.49066853523254395
Epoch: 38, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.965 Vali Acc: 0.700 Test Loss: 0.965 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5626680850982666
Epoch: 39, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.961 Vali Acc: 0.675 Test Loss: 0.961 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5441296100616455
Epoch: 40, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.956 Vali Acc: 0.675 Test Loss: 0.956 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.558544397354126
Epoch: 41, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.947 Vali Acc: 0.675 Test Loss: 0.947 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5242640972137451
Epoch: 42, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.939 Vali Acc: 0.675 Test Loss: 0.939 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 17492
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1484375
Epoch: 1, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5501818656921387
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.4934964179992676
Epoch: 3, Steps: 3 | Train Loss: 1.545 Vali Loss: 1.386 Vali Acc: 0.275 Test Loss: 1.386 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.625664472579956
Epoch: 4, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.382 Vali Acc: 0.275 Test Loss: 1.382 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.5699503421783447
Epoch: 5, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.377 Vali Acc: 0.325 Test Loss: 1.377 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.623011589050293
Epoch: 6, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.371 Vali Acc: 0.325 Test Loss: 1.371 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.6497173309326172
Epoch: 7, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.362 Vali Acc: 0.325 Test Loss: 1.362 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.5688443183898926
Epoch: 8, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.351 Vali Acc: 0.375 Test Loss: 1.351 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 9 cost time: 0.5201413631439209
Epoch: 9, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.339 Vali Acc: 0.375 Test Loss: 1.339 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 0.5634286403656006
Epoch: 10, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.330 Vali Acc: 0.375 Test Loss: 1.330 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 11 cost time: 0.5330014228820801
Epoch: 11, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.318 Vali Acc: 0.375 Test Loss: 1.318 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 12 cost time: 0.6821904182434082
Epoch: 12, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.307 Vali Acc: 0.375 Test Loss: 1.307 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 13 cost time: 0.5275330543518066
Epoch: 13, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 0.6005845069885254
Epoch: 14, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.284 Vali Acc: 0.425 Test Loss: 1.284 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 15 cost time: 0.5732078552246094
Epoch: 15, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.271 Vali Acc: 0.400 Test Loss: 1.271 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5604465007781982
Epoch: 16, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.257 Vali Acc: 0.450 Test Loss: 1.257 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 17 cost time: 0.6758058071136475
Epoch: 17, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.243 Vali Acc: 0.450 Test Loss: 1.243 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 18 cost time: 0.5686438083648682
Epoch: 18, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.232 Vali Acc: 0.450 Test Loss: 1.232 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 19 cost time: 0.5397820472717285
Epoch: 19, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.219 Vali Acc: 0.450 Test Loss: 1.219 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 20 cost time: 0.6106772422790527
Epoch: 20, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.208 Vali Acc: 0.425 Test Loss: 1.208 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5780012607574463
Epoch: 21, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.196 Vali Acc: 0.425 Test Loss: 1.196 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5131399631500244
Epoch: 22, Steps: 3 | Train Loss: 0.802 Vali Loss: 1.185 Vali Acc: 0.425 Test Loss: 1.185 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7072410583496094
Epoch: 23, Steps: 3 | Train Loss: 0.734 Vali Loss: 1.175 Vali Acc: 0.450 Test Loss: 1.175 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 24 cost time: 0.5016295909881592
Epoch: 24, Steps: 3 | Train Loss: 0.678 Vali Loss: 1.165 Vali Acc: 0.450 Test Loss: 1.165 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 25 cost time: 0.49706602096557617
Epoch: 25, Steps: 3 | Train Loss: 0.640 Vali Loss: 1.155 Vali Acc: 0.450 Test Loss: 1.155 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 26 cost time: 0.6207847595214844
Epoch: 26, Steps: 3 | Train Loss: 0.735 Vali Loss: 1.146 Vali Acc: 0.450 Test Loss: 1.146 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449989).  Saving model ...
Epoch: 27 cost time: 0.541691780090332
Epoch: 27, Steps: 3 | Train Loss: 0.638 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
Validation loss decreased (-0.449989 --> -0.499989).  Saving model ...
Epoch: 28 cost time: 0.584087610244751
Epoch: 28, Steps: 3 | Train Loss: 0.550 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 29 cost time: 0.6024999618530273
Epoch: 29, Steps: 3 | Train Loss: 0.561 Vali Loss: 1.125 Vali Acc: 0.475 Test Loss: 1.125 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5447177886962891
Epoch: 30, Steps: 3 | Train Loss: 0.567 Vali Loss: 1.118 Vali Acc: 0.450 Test Loss: 1.118 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5131855010986328
Epoch: 31, Steps: 3 | Train Loss: 0.521 Vali Loss: 1.114 Vali Acc: 0.450 Test Loss: 1.114 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6377172470092773
Epoch: 32, Steps: 3 | Train Loss: 0.459 Vali Loss: 1.106 Vali Acc: 0.475 Test Loss: 1.106 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.61810302734375
Epoch: 33, Steps: 3 | Train Loss: 0.442 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 34 cost time: 0.6322972774505615
Epoch: 34, Steps: 3 | Train Loss: 0.438 Vali Loss: 1.095 Vali Acc: 0.525 Test Loss: 1.095 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 35 cost time: 0.6120328903198242
Epoch: 35, Steps: 3 | Train Loss: 0.370 Vali Loss: 1.089 Vali Acc: 0.525 Test Loss: 1.089 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 36 cost time: 0.6183722019195557
Epoch: 36, Steps: 3 | Train Loss: 0.370 Vali Loss: 1.086 Vali Acc: 0.525 Test Loss: 1.086 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 37 cost time: 0.6909310817718506
Epoch: 37, Steps: 3 | Train Loss: 0.356 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5774145126342773
Epoch: 38, Steps: 3 | Train Loss: 0.308 Vali Loss: 1.086 Vali Acc: 0.525 Test Loss: 1.086 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 39 cost time: 0.600104808807373
Epoch: 39, Steps: 3 | Train Loss: 0.317 Vali Loss: 1.084 Vali Acc: 0.525 Test Loss: 1.084 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 40 cost time: 0.5954890251159668
Epoch: 40, Steps: 3 | Train Loss: 0.318 Vali Loss: 1.081 Vali Acc: 0.525 Test Loss: 1.081 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 41 cost time: 0.5277481079101562
Epoch: 41, Steps: 3 | Train Loss: 0.312 Vali Loss: 1.079 Vali Acc: 0.525 Test Loss: 1.079 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 42 cost time: 0.48036789894104004
Epoch: 42, Steps: 3 | Train Loss: 0.280 Vali Loss: 1.079 Vali Acc: 0.525 Test Loss: 1.079 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5036096572875977
Epoch: 43, Steps: 3 | Train Loss: 0.246 Vali Loss: 1.080 Vali Acc: 0.525 Test Loss: 1.080 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6132771968841553
Epoch: 44, Steps: 3 | Train Loss: 0.204 Vali Loss: 1.078 Vali Acc: 0.525 Test Loss: 1.078 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 45 cost time: 0.6110775470733643
Epoch: 45, Steps: 3 | Train Loss: 0.196 Vali Loss: 1.076 Vali Acc: 0.525 Test Loss: 1.076 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 46 cost time: 0.743715763092041
Epoch: 46, Steps: 3 | Train Loss: 0.197 Vali Loss: 1.072 Vali Acc: 0.575 Test Loss: 1.072 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 47 cost time: 0.6320042610168457
Epoch: 47, Steps: 3 | Train Loss: 0.173 Vali Loss: 1.071 Vali Acc: 0.575 Test Loss: 1.071 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 48 cost time: 0.5316545963287354
Epoch: 48, Steps: 3 | Train Loss: 0.168 Vali Loss: 1.069 Vali Acc: 0.575 Test Loss: 1.069 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 49 cost time: 0.5353062152862549
Epoch: 49, Steps: 3 | Train Loss: 0.161 Vali Loss: 1.067 Vali Acc: 0.575 Test Loss: 1.067 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 50 cost time: 0.4729013442993164
Epoch: 50, Steps: 3 | Train Loss: 0.156 Vali Loss: 1.068 Vali Acc: 0.575 Test Loss: 1.068 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5258979797363281
Epoch: 51, Steps: 3 | Train Loss: 0.154 Vali Loss: 1.069 Vali Acc: 0.575 Test Loss: 1.069 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5725398063659668
Epoch: 52, Steps: 3 | Train Loss: 0.162 Vali Loss: 1.067 Vali Acc: 0.575 Test Loss: 1.067 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.6481301784515381
Epoch: 53, Steps: 3 | Train Loss: 0.148 Vali Loss: 1.069 Vali Acc: 0.575 Test Loss: 1.069 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7224295139312744
Epoch: 54, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.070 Vali Acc: 0.575 Test Loss: 1.070 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5713915824890137
Epoch: 55, Steps: 3 | Train Loss: 0.118 Vali Loss: 1.071 Vali Acc: 0.575 Test Loss: 1.071 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.5800576210021973
Epoch: 56, Steps: 3 | Train Loss: 0.123 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 57 cost time: 0.5309712886810303
Epoch: 57, Steps: 3 | Train Loss: 0.116 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 58 cost time: 0.5002882480621338
Epoch: 58, Steps: 3 | Train Loss: 0.103 Vali Loss: 1.074 Vali Acc: 0.600 Test Loss: 1.074 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5565445423126221
Epoch: 59, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5217745304107666
Epoch: 60, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5678479671478271
Epoch: 61, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.6614425182342529
Epoch: 62, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.5848228931427002
Epoch: 63, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.5947456359863281
Epoch: 64, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.5888299942016602
Epoch: 65, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.6248667240142822
Epoch: 66, Steps: 3 | Train Loss: 0.079 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.6241412162780762
Epoch: 67, Steps: 3 | Train Loss: 0.076 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.6
model parameter : 14500
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.191209554672241
Epoch: 1, Steps: 3 | Train Loss: 1.527 Vali Loss: 1.388 Vali Acc: 0.225 Test Loss: 1.388 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5994429588317871
Epoch: 2, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.363 Vali Acc: 0.300 Test Loss: 1.363 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.5974245071411133
Epoch: 3, Steps: 3 | Train Loss: 1.561 Vali Loss: 1.347 Vali Acc: 0.325 Test Loss: 1.347 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.5870361328125
Epoch: 4, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.337 Vali Acc: 0.350 Test Loss: 1.337 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.5327105522155762
Epoch: 5, Steps: 3 | Train Loss: 1.517 Vali Loss: 1.330 Vali Acc: 0.350 Test Loss: 1.330 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.585456132888794
Epoch: 6, Steps: 3 | Train Loss: 1.515 Vali Loss: 1.323 Vali Acc: 0.375 Test Loss: 1.323 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.5460879802703857
Epoch: 7, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.315 Vali Acc: 0.375 Test Loss: 1.315 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.5422306060791016
Epoch: 8, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.306 Vali Acc: 0.375 Test Loss: 1.306 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 0.5470178127288818
Epoch: 9, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 0.5829675197601318
Epoch: 10, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.285 Vali Acc: 0.425 Test Loss: 1.285 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 11 cost time: 0.580369234085083
Epoch: 11, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.275 Vali Acc: 0.425 Test Loss: 1.275 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 12 cost time: 0.5862963199615479
Epoch: 12, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.264 Vali Acc: 0.425 Test Loss: 1.264 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 0.5273902416229248
Epoch: 13, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 0.5273456573486328
Epoch: 14, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.243 Vali Acc: 0.525 Test Loss: 1.243 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 0.49522924423217773
Epoch: 15, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.232 Vali Acc: 0.550 Test Loss: 1.232 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 16 cost time: 0.4906156063079834
Epoch: 16, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.221 Vali Acc: 0.550 Test Loss: 1.221 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 17 cost time: 0.574040412902832
Epoch: 17, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.211 Vali Acc: 0.575 Test Loss: 1.211 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 18 cost time: 0.4839658737182617
Epoch: 18, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.199 Vali Acc: 0.575 Test Loss: 1.199 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.5965745449066162
Epoch: 19, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.190 Vali Acc: 0.575 Test Loss: 1.190 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.6326303482055664
Epoch: 20, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.180 Vali Acc: 0.575 Test Loss: 1.180 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.5233206748962402
Epoch: 21, Steps: 3 | Train Loss: 0.821 Vali Loss: 1.169 Vali Acc: 0.575 Test Loss: 1.169 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 22 cost time: 0.5532863140106201
Epoch: 22, Steps: 3 | Train Loss: 0.882 Vali Loss: 1.158 Vali Acc: 0.600 Test Loss: 1.158 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 23 cost time: 0.5718579292297363
Epoch: 23, Steps: 3 | Train Loss: 0.782 Vali Loss: 1.149 Vali Acc: 0.600 Test Loss: 1.149 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 24 cost time: 0.6385376453399658
Epoch: 24, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.139 Vali Acc: 0.600 Test Loss: 1.139 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 0.5528497695922852
Epoch: 25, Steps: 3 | Train Loss: 0.750 Vali Loss: 1.130 Vali Acc: 0.600 Test Loss: 1.130 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 0.49521923065185547
Epoch: 26, Steps: 3 | Train Loss: 0.699 Vali Loss: 1.122 Vali Acc: 0.575 Test Loss: 1.122 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5472860336303711
Epoch: 27, Steps: 3 | Train Loss: 0.699 Vali Loss: 1.117 Vali Acc: 0.575 Test Loss: 1.117 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6254072189331055
Epoch: 28, Steps: 3 | Train Loss: 0.650 Vali Loss: 1.112 Vali Acc: 0.550 Test Loss: 1.112 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5508551597595215
Epoch: 29, Steps: 3 | Train Loss: 0.701 Vali Loss: 1.107 Vali Acc: 0.550 Test Loss: 1.107 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6066899299621582
Epoch: 30, Steps: 3 | Train Loss: 0.626 Vali Loss: 1.102 Vali Acc: 0.625 Test Loss: 1.102 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 31 cost time: 0.5795085430145264
Epoch: 31, Steps: 3 | Train Loss: 0.591 Vali Loss: 1.096 Vali Acc: 0.625 Test Loss: 1.096 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 32 cost time: 0.5619537830352783
Epoch: 32, Steps: 3 | Train Loss: 0.577 Vali Loss: 1.092 Vali Acc: 0.625 Test Loss: 1.092 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 33 cost time: 0.5747072696685791
Epoch: 33, Steps: 3 | Train Loss: 0.585 Vali Loss: 1.088 Vali Acc: 0.650 Test Loss: 1.088 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 34 cost time: 0.4805893898010254
Epoch: 34, Steps: 3 | Train Loss: 0.501 Vali Loss: 1.080 Vali Acc: 0.650 Test Loss: 1.080 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 35 cost time: 0.5725154876708984
Epoch: 35, Steps: 3 | Train Loss: 0.519 Vali Loss: 1.075 Vali Acc: 0.650 Test Loss: 1.075 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 36 cost time: 0.5696685314178467
Epoch: 36, Steps: 3 | Train Loss: 0.467 Vali Loss: 1.071 Vali Acc: 0.675 Test Loss: 1.071 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 37 cost time: 0.6512877941131592
Epoch: 37, Steps: 3 | Train Loss: 0.516 Vali Loss: 1.066 Vali Acc: 0.675 Test Loss: 1.066 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 38 cost time: 0.4850788116455078
Epoch: 38, Steps: 3 | Train Loss: 0.361 Vali Loss: 1.060 Vali Acc: 0.675 Test Loss: 1.060 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 39 cost time: 0.5703554153442383
Epoch: 39, Steps: 3 | Train Loss: 0.407 Vali Loss: 1.054 Vali Acc: 0.675 Test Loss: 1.054 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 40 cost time: 0.6233425140380859
Epoch: 40, Steps: 3 | Train Loss: 0.354 Vali Loss: 1.050 Vali Acc: 0.675 Test Loss: 1.050 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 41 cost time: 0.542595624923706
Epoch: 41, Steps: 3 | Train Loss: 0.325 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 42 cost time: 0.5286059379577637
Epoch: 42, Steps: 3 | Train Loss: 0.408 Vali Loss: 1.043 Vali Acc: 0.675 Test Loss: 1.043 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 43 cost time: 0.546839714050293
Epoch: 43, Steps: 3 | Train Loss: 0.336 Vali Loss: 1.037 Vali Acc: 0.675 Test Loss: 1.037 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 44 cost time: 0.5533418655395508
Epoch: 44, Steps: 3 | Train Loss: 0.318 Vali Loss: 1.033 Vali Acc: 0.675 Test Loss: 1.033 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 45 cost time: 0.5846102237701416
Epoch: 45, Steps: 3 | Train Loss: 0.337 Vali Loss: 1.028 Vali Acc: 0.675 Test Loss: 1.028 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 46 cost time: 0.542417049407959
Epoch: 46, Steps: 3 | Train Loss: 0.262 Vali Loss: 1.024 Vali Acc: 0.675 Test Loss: 1.024 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 47 cost time: 0.5748250484466553
Epoch: 47, Steps: 3 | Train Loss: 0.269 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 48 cost time: 0.5701375007629395
Epoch: 48, Steps: 3 | Train Loss: 0.266 Vali Loss: 1.018 Vali Acc: 0.675 Test Loss: 1.018 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 49 cost time: 0.5673818588256836
Epoch: 49, Steps: 3 | Train Loss: 0.262 Vali Loss: 1.016 Vali Acc: 0.675 Test Loss: 1.016 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 50 cost time: 0.5250129699707031
Epoch: 50, Steps: 3 | Train Loss: 0.226 Vali Loss: 1.015 Vali Acc: 0.675 Test Loss: 1.015 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 51 cost time: 0.5930266380310059
Epoch: 51, Steps: 3 | Train Loss: 0.200 Vali Loss: 1.012 Vali Acc: 0.675 Test Loss: 1.012 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 52 cost time: 0.5728414058685303
Epoch: 52, Steps: 3 | Train Loss: 0.190 Vali Loss: 1.011 Vali Acc: 0.675 Test Loss: 1.011 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 53 cost time: 0.5459792613983154
Epoch: 53, Steps: 3 | Train Loss: 0.188 Vali Loss: 1.010 Vali Acc: 0.675 Test Loss: 1.010 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 54 cost time: 0.5613884925842285
Epoch: 54, Steps: 3 | Train Loss: 0.225 Vali Loss: 1.008 Vali Acc: 0.675 Test Loss: 1.008 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 55 cost time: 0.5179581642150879
Epoch: 55, Steps: 3 | Train Loss: 0.185 Vali Loss: 1.006 Vali Acc: 0.675 Test Loss: 1.006 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 56 cost time: 0.6109864711761475
Epoch: 56, Steps: 3 | Train Loss: 0.174 Vali Loss: 1.005 Vali Acc: 0.675 Test Loss: 1.005 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 57 cost time: 0.5805885791778564
Epoch: 57, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.005 Vali Acc: 0.650 Test Loss: 1.005 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5720598697662354
Epoch: 58, Steps: 3 | Train Loss: 0.141 Vali Loss: 1.005 Vali Acc: 0.650 Test Loss: 1.005 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.606694221496582
Epoch: 59, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.005 Vali Acc: 0.650 Test Loss: 1.005 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5708751678466797
Epoch: 60, Steps: 3 | Train Loss: 0.142 Vali Loss: 1.003 Vali Acc: 0.675 Test Loss: 1.003 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 61 cost time: 0.5399644374847412
Epoch: 61, Steps: 3 | Train Loss: 0.139 Vali Loss: 1.004 Vali Acc: 0.675 Test Loss: 1.004 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.48850059509277344
Epoch: 62, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.003 Vali Acc: 0.675 Test Loss: 1.003 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.5907342433929443
Epoch: 63, Steps: 3 | Train Loss: 0.120 Vali Loss: 1.003 Vali Acc: 0.700 Test Loss: 1.003 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 64 cost time: 0.5275082588195801
Epoch: 64, Steps: 3 | Train Loss: 0.110 Vali Loss: 1.004 Vali Acc: 0.700 Test Loss: 1.004 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5802977085113525
Epoch: 65, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.005 Vali Acc: 0.700 Test Loss: 1.005 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.5542953014373779
Epoch: 66, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.006 Vali Acc: 0.700 Test Loss: 1.006 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.6791160106658936
Epoch: 67, Steps: 3 | Train Loss: 0.132 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.6078290939331055
Epoch: 68, Steps: 3 | Train Loss: 0.091 Vali Loss: 1.011 Vali Acc: 0.700 Test Loss: 1.011 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.5303175449371338
Epoch: 69, Steps: 3 | Train Loss: 0.093 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.6124467849731445
Epoch: 70, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.6027307510375977
Epoch: 71, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.5435125827789307
Epoch: 72, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.5799474716186523
Epoch: 73, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.015 Vali Acc: 0.725 Test Loss: 1.015 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 74 cost time: 0.4968256950378418
Epoch: 74, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.5173087120056152
Epoch: 75, Steps: 3 | Train Loss: 0.082 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.5888755321502686
Epoch: 76, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.5850780010223389
Epoch: 77, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.6653330326080322
Epoch: 78, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.018 Vali Acc: 0.725 Test Loss: 1.018 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.5832507610321045
Epoch: 79, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.017 Vali Acc: 0.725 Test Loss: 1.017 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.6161148548126221
Epoch: 80, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.020 Vali Acc: 0.725 Test Loss: 1.020 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.5700438022613525
Epoch: 81, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.023 Vali Acc: 0.725 Test Loss: 1.023 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.5677709579467773
Epoch: 82, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.025 Vali Acc: 0.725 Test Loss: 1.025 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.5765788555145264
Epoch: 83, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.024 Vali Acc: 0.725 Test Loss: 1.024 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 13812
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1777186393737793
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.361 Vali Acc: 0.325 Test Loss: 1.361 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.6028833389282227
Epoch: 2, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.365 Vali Acc: 0.300 Test Loss: 1.365 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5818901062011719
Epoch: 3, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.368 Vali Acc: 0.300 Test Loss: 1.368 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5254755020141602
Epoch: 4, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.371 Vali Acc: 0.275 Test Loss: 1.371 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5201315879821777
Epoch: 5, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.371 Vali Acc: 0.300 Test Loss: 1.371 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5906639099121094
Epoch: 6, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.370 Vali Acc: 0.300 Test Loss: 1.370 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5558681488037109
Epoch: 7, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.368 Vali Acc: 0.300 Test Loss: 1.368 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.510488748550415
Epoch: 8, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.362 Vali Acc: 0.325 Test Loss: 1.362 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5465397834777832
Epoch: 9, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.358 Vali Acc: 0.350 Test Loss: 1.358 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 10 cost time: 0.5647234916687012
Epoch: 10, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 11 cost time: 0.5591573715209961
Epoch: 11, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.344 Vali Acc: 0.350 Test Loss: 1.344 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 12 cost time: 0.5618360042572021
Epoch: 12, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.337 Vali Acc: 0.350 Test Loss: 1.337 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 13 cost time: 0.6073629856109619
Epoch: 13, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.329 Vali Acc: 0.350 Test Loss: 1.329 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 14 cost time: 0.5060446262359619
Epoch: 14, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.322 Vali Acc: 0.375 Test Loss: 1.322 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 15 cost time: 0.6246581077575684
Epoch: 15, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.314 Vali Acc: 0.375 Test Loss: 1.314 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 16 cost time: 0.5626370906829834
Epoch: 16, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.307 Vali Acc: 0.400 Test Loss: 1.307 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 17 cost time: 0.5099847316741943
Epoch: 17, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.298 Vali Acc: 0.450 Test Loss: 1.298 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 18 cost time: 0.5369651317596436
Epoch: 18, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.289 Vali Acc: 0.450 Test Loss: 1.289 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 19 cost time: 0.5761387348175049
Epoch: 19, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.280 Vali Acc: 0.450 Test Loss: 1.280 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 20 cost time: 0.532294750213623
Epoch: 20, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.272 Vali Acc: 0.450 Test Loss: 1.272 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 21 cost time: 0.5639426708221436
Epoch: 21, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.264 Vali Acc: 0.450 Test Loss: 1.264 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 22 cost time: 0.528040885925293
Epoch: 22, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.257 Vali Acc: 0.450 Test Loss: 1.257 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 23 cost time: 0.5501549243927002
Epoch: 23, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.251 Vali Acc: 0.450 Test Loss: 1.251 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 24 cost time: 0.46043872833251953
Epoch: 24, Steps: 3 | Train Loss: 0.841 Vali Loss: 1.245 Vali Acc: 0.475 Test Loss: 1.245 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 25 cost time: 0.5048477649688721
Epoch: 25, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.239 Vali Acc: 0.450 Test Loss: 1.239 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5383663177490234
Epoch: 26, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.232 Vali Acc: 0.475 Test Loss: 1.232 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 27 cost time: 0.5124757289886475
Epoch: 27, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.226 Vali Acc: 0.475 Test Loss: 1.226 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 28 cost time: 0.5441560745239258
Epoch: 28, Steps: 3 | Train Loss: 0.770 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 29 cost time: 0.5663301944732666
Epoch: 29, Steps: 3 | Train Loss: 0.782 Vali Loss: 1.214 Vali Acc: 0.525 Test Loss: 1.214 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 30 cost time: 0.5171792507171631
Epoch: 30, Steps: 3 | Train Loss: 0.716 Vali Loss: 1.209 Vali Acc: 0.550 Test Loss: 1.209 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 31 cost time: 0.49789881706237793
Epoch: 31, Steps: 3 | Train Loss: 0.729 Vali Loss: 1.204 Vali Acc: 0.550 Test Loss: 1.204 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 32 cost time: 0.5570743083953857
Epoch: 32, Steps: 3 | Train Loss: 0.615 Vali Loss: 1.198 Vali Acc: 0.550 Test Loss: 1.198 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 33 cost time: 0.5407896041870117
Epoch: 33, Steps: 3 | Train Loss: 0.679 Vali Loss: 1.193 Vali Acc: 0.525 Test Loss: 1.193 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5319054126739502
Epoch: 34, Steps: 3 | Train Loss: 0.614 Vali Loss: 1.187 Vali Acc: 0.525 Test Loss: 1.187 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5550839900970459
Epoch: 35, Steps: 3 | Train Loss: 0.623 Vali Loss: 1.181 Vali Acc: 0.525 Test Loss: 1.181 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5034432411193848
Epoch: 36, Steps: 3 | Train Loss: 0.548 Vali Loss: 1.176 Vali Acc: 0.525 Test Loss: 1.176 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4952092170715332
Epoch: 37, Steps: 3 | Train Loss: 0.592 Vali Loss: 1.173 Vali Acc: 0.525 Test Loss: 1.173 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.564356803894043
Epoch: 38, Steps: 3 | Train Loss: 0.502 Vali Loss: 1.170 Vali Acc: 0.550 Test Loss: 1.170 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 39 cost time: 0.5873727798461914
Epoch: 39, Steps: 3 | Train Loss: 0.602 Vali Loss: 1.163 Vali Acc: 0.575 Test Loss: 1.163 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 40 cost time: 0.4817698001861572
Epoch: 40, Steps: 3 | Train Loss: 0.527 Vali Loss: 1.156 Vali Acc: 0.600 Test Loss: 1.156 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 41 cost time: 0.5295062065124512
Epoch: 41, Steps: 3 | Train Loss: 0.437 Vali Loss: 1.152 Vali Acc: 0.600 Test Loss: 1.152 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 42 cost time: 0.5723545551300049
Epoch: 42, Steps: 3 | Train Loss: 0.479 Vali Loss: 1.147 Vali Acc: 0.600 Test Loss: 1.147 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 43 cost time: 0.511563777923584
Epoch: 43, Steps: 3 | Train Loss: 0.429 Vali Loss: 1.143 Vali Acc: 0.625 Test Loss: 1.143 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 44 cost time: 0.5575854778289795
Epoch: 44, Steps: 3 | Train Loss: 0.421 Vali Loss: 1.140 Vali Acc: 0.625 Test Loss: 1.140 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 45 cost time: 0.5435349941253662
Epoch: 45, Steps: 3 | Train Loss: 0.424 Vali Loss: 1.136 Vali Acc: 0.625 Test Loss: 1.136 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 46 cost time: 0.6867372989654541
Epoch: 46, Steps: 3 | Train Loss: 0.359 Vali Loss: 1.135 Vali Acc: 0.625 Test Loss: 1.135 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 47 cost time: 0.557995080947876
Epoch: 47, Steps: 3 | Train Loss: 0.369 Vali Loss: 1.136 Vali Acc: 0.625 Test Loss: 1.136 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5133988857269287
Epoch: 48, Steps: 3 | Train Loss: 0.373 Vali Loss: 1.134 Vali Acc: 0.625 Test Loss: 1.134 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 49 cost time: 0.6036698818206787
Epoch: 49, Steps: 3 | Train Loss: 0.413 Vali Loss: 1.131 Vali Acc: 0.625 Test Loss: 1.131 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 50 cost time: 0.5751233100891113
Epoch: 50, Steps: 3 | Train Loss: 0.354 Vali Loss: 1.131 Vali Acc: 0.625 Test Loss: 1.131 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 51 cost time: 0.5356252193450928
Epoch: 51, Steps: 3 | Train Loss: 0.320 Vali Loss: 1.129 Vali Acc: 0.625 Test Loss: 1.129 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 52 cost time: 0.5450417995452881
Epoch: 52, Steps: 3 | Train Loss: 0.282 Vali Loss: 1.127 Vali Acc: 0.625 Test Loss: 1.127 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 53 cost time: 0.6358120441436768
Epoch: 53, Steps: 3 | Train Loss: 0.314 Vali Loss: 1.125 Vali Acc: 0.625 Test Loss: 1.125 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 54 cost time: 0.5644176006317139
Epoch: 54, Steps: 3 | Train Loss: 0.291 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 55 cost time: 0.5523817539215088
Epoch: 55, Steps: 3 | Train Loss: 0.264 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.572990894317627
Epoch: 56, Steps: 3 | Train Loss: 0.328 Vali Loss: 1.116 Vali Acc: 0.625 Test Loss: 1.116 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6035377979278564
Epoch: 57, Steps: 3 | Train Loss: 0.253 Vali Loss: 1.114 Vali Acc: 0.650 Test Loss: 1.114 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 58 cost time: 0.5760588645935059
Epoch: 58, Steps: 3 | Train Loss: 0.246 Vali Loss: 1.110 Vali Acc: 0.675 Test Loss: 1.110 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 59 cost time: 0.521249532699585
Epoch: 59, Steps: 3 | Train Loss: 0.251 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5937168598175049
Epoch: 60, Steps: 3 | Train Loss: 0.262 Vali Loss: 1.107 Vali Acc: 0.650 Test Loss: 1.107 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5854275226593018
Epoch: 61, Steps: 3 | Train Loss: 0.221 Vali Loss: 1.108 Vali Acc: 0.650 Test Loss: 1.108 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.6174795627593994
Epoch: 62, Steps: 3 | Train Loss: 0.214 Vali Loss: 1.106 Vali Acc: 0.675 Test Loss: 1.106 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 63 cost time: 0.6165411472320557
Epoch: 63, Steps: 3 | Train Loss: 0.162 Vali Loss: 1.106 Vali Acc: 0.650 Test Loss: 1.106 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5176839828491211
Epoch: 64, Steps: 3 | Train Loss: 0.208 Vali Loss: 1.105 Vali Acc: 0.650 Test Loss: 1.105 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.4770939350128174
Epoch: 65, Steps: 3 | Train Loss: 0.167 Vali Loss: 1.104 Vali Acc: 0.650 Test Loss: 1.104 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.5859003067016602
Epoch: 66, Steps: 3 | Train Loss: 0.183 Vali Loss: 1.101 Vali Acc: 0.650 Test Loss: 1.101 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.5076925754547119
Epoch: 67, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.100 Vali Acc: 0.650 Test Loss: 1.100 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.5938031673431396
Epoch: 68, Steps: 3 | Train Loss: 0.206 Vali Loss: 1.101 Vali Acc: 0.650 Test Loss: 1.101 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.5900771617889404
Epoch: 69, Steps: 3 | Train Loss: 0.150 Vali Loss: 1.099 Vali Acc: 0.650 Test Loss: 1.099 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.6263120174407959
Epoch: 70, Steps: 3 | Train Loss: 0.154 Vali Loss: 1.099 Vali Acc: 0.625 Test Loss: 1.099 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.6104774475097656
Epoch: 71, Steps: 3 | Train Loss: 0.135 Vali Loss: 1.097 Vali Acc: 0.625 Test Loss: 1.097 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.5176892280578613
Epoch: 72, Steps: 3 | Train Loss: 0.123 Vali Loss: 1.097 Vali Acc: 0.650 Test Loss: 1.097 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df256_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 12740
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.03999924659729
Epoch: 1, Steps: 3 | Train Loss: 1.745 Vali Loss: 1.916 Vali Acc: 0.250 Test Loss: 1.916 Test Acc: 0.250
Validation loss decreased (inf --> -0.249981).  Saving model ...
Epoch: 2 cost time: 0.5470075607299805
Epoch: 2, Steps: 3 | Train Loss: 1.712 Vali Loss: 1.789 Vali Acc: 0.225 Test Loss: 1.789 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6103973388671875
Epoch: 3, Steps: 3 | Train Loss: 1.587 Vali Loss: 1.692 Vali Acc: 0.225 Test Loss: 1.692 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5006618499755859
Epoch: 4, Steps: 3 | Train Loss: 1.500 Vali Loss: 1.601 Vali Acc: 0.150 Test Loss: 1.601 Test Acc: 0.150
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5660152435302734
Epoch: 5, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.521 Vali Acc: 0.200 Test Loss: 1.521 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5016472339630127
Epoch: 6, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.454 Vali Acc: 0.250 Test Loss: 1.454 Test Acc: 0.250
Validation loss decreased (-0.249981 --> -0.249985).  Saving model ...
Epoch: 7 cost time: 0.5206201076507568
Epoch: 7, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.402 Vali Acc: 0.200 Test Loss: 1.402 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.571514368057251
Epoch: 8, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.353 Vali Acc: 0.325 Test Loss: 1.353 Test Acc: 0.325
Validation loss decreased (-0.249985 --> -0.324986).  Saving model ...
Epoch: 9 cost time: 0.6584696769714355
Epoch: 9, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.312 Vali Acc: 0.375 Test Loss: 1.312 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 0.650587797164917
Epoch: 10, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.272 Vali Acc: 0.425 Test Loss: 1.272 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 11 cost time: 0.5506982803344727
Epoch: 11, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5961496829986572
Epoch: 12, Steps: 3 | Train Loss: 0.671 Vali Loss: 1.203 Vali Acc: 0.450 Test Loss: 1.203 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 13 cost time: 0.5993330478668213
Epoch: 13, Steps: 3 | Train Loss: 0.748 Vali Loss: 1.168 Vali Acc: 0.450 Test Loss: 1.168 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 14 cost time: 0.6321375370025635
Epoch: 14, Steps: 3 | Train Loss: 0.680 Vali Loss: 1.135 Vali Acc: 0.525 Test Loss: 1.135 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524989).  Saving model ...
Epoch: 15 cost time: 0.5137720108032227
Epoch: 15, Steps: 3 | Train Loss: 0.518 Vali Loss: 1.100 Vali Acc: 0.600 Test Loss: 1.100 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.5477681159973145
Epoch: 16, Steps: 3 | Train Loss: 0.531 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.527595043182373
Epoch: 17, Steps: 3 | Train Loss: 0.383 Vali Loss: 1.036 Vali Acc: 0.625 Test Loss: 1.036 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 0.5646991729736328
Epoch: 18, Steps: 3 | Train Loss: 0.369 Vali Loss: 1.019 Vali Acc: 0.650 Test Loss: 1.019 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 19 cost time: 0.5291063785552979
Epoch: 19, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.988 Vali Acc: 0.675 Test Loss: 0.988 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 20 cost time: 0.4660038948059082
Epoch: 20, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.958 Vali Acc: 0.700 Test Loss: 0.958 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 21 cost time: 0.5503754615783691
Epoch: 21, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.940 Vali Acc: 0.675 Test Loss: 0.940 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6604793071746826
Epoch: 22, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.924 Vali Acc: 0.725 Test Loss: 0.924 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 23 cost time: 0.6180934906005859
Epoch: 23, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.897 Vali Acc: 0.725 Test Loss: 0.897 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 24 cost time: 0.5911111831665039
Epoch: 24, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.878 Vali Acc: 0.725 Test Loss: 0.878 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 25 cost time: 0.6205008029937744
Epoch: 25, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.864 Vali Acc: 0.725 Test Loss: 0.864 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 26 cost time: 0.6245057582855225
Epoch: 26, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.856 Vali Acc: 0.725 Test Loss: 0.856 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 27 cost time: 0.6355385780334473
Epoch: 27, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.844 Vali Acc: 0.725 Test Loss: 0.844 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 28 cost time: 0.59330153465271
Epoch: 28, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.828 Vali Acc: 0.750 Test Loss: 0.828 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 29 cost time: 0.5671703815460205
Epoch: 29, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.822 Vali Acc: 0.750 Test Loss: 0.822 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 30 cost time: 0.6310172080993652
Epoch: 30, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 31 cost time: 0.6216819286346436
Epoch: 31, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 32 cost time: 0.5750041007995605
Epoch: 32, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.819 Vali Acc: 0.750 Test Loss: 0.819 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5294032096862793
Epoch: 33, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.825 Vali Acc: 0.750 Test Loss: 0.825 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.58241868019104
Epoch: 34, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5862293243408203
Epoch: 35, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.826 Vali Acc: 0.750 Test Loss: 0.826 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5582404136657715
Epoch: 36, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6446144580841064
Epoch: 37, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.809 Vali Acc: 0.750 Test Loss: 0.809 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 38 cost time: 0.540961742401123
Epoch: 38, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 39 cost time: 0.5995194911956787
Epoch: 39, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 40 cost time: 0.5126609802246094
Epoch: 40, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 41 cost time: 0.4999251365661621
Epoch: 41, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.792 Vali Acc: 0.750 Test Loss: 0.792 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 42 cost time: 0.617387056350708
Epoch: 42, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.789 Vali Acc: 0.750 Test Loss: 0.789 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 43 cost time: 0.6481432914733887
Epoch: 43, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 44 cost time: 0.6340053081512451
Epoch: 44, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6161327362060547
Epoch: 45, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 46 cost time: 0.5558171272277832
Epoch: 46, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 47 cost time: 0.6270349025726318
Epoch: 47, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 48 cost time: 0.5811119079589844
Epoch: 48, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5892205238342285
Epoch: 49, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6084887981414795
Epoch: 50, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6289699077606201
Epoch: 51, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.792 Vali Acc: 0.750 Test Loss: 0.792 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.5562505722045898
Epoch: 52, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.791 Vali Acc: 0.750 Test Loss: 0.791 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.5515406131744385
Epoch: 53, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.789 Vali Acc: 0.750 Test Loss: 0.789 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6126101016998291
Epoch: 54, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.5626034736633301
Epoch: 55, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.5380542278289795
Epoch: 56, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.5973024368286133
Epoch: 57, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 58 cost time: 0.5276219844818115
Epoch: 58, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 59 cost time: 0.5776996612548828
Epoch: 59, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 60 cost time: 0.5502498149871826
Epoch: 60, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 61 cost time: 0.5370175838470459
Epoch: 61, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 62 cost time: 0.5653836727142334
Epoch: 62, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 63 cost time: 0.5733380317687988
Epoch: 63, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.779 Vali Acc: 0.750 Test Loss: 0.779 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.613372802734375
Epoch: 64, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.6296334266662598
Epoch: 65, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.5381920337677002
Epoch: 66, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.5695459842681885
Epoch: 67, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.5740737915039062
Epoch: 68, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.5559735298156738
Epoch: 69, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.5932607650756836
Epoch: 70, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.779 Vali Acc: 0.750 Test Loss: 0.779 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.5081312656402588
Epoch: 71, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 72 cost time: 0.5279343128204346
Epoch: 72, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.776 Vali Acc: 0.750 Test Loss: 0.776 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 73 cost time: 0.6097981929779053
Epoch: 73, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 74 cost time: 0.6514883041381836
Epoch: 74, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.777 Vali Acc: 0.750 Test Loss: 0.777 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.6076264381408691
Epoch: 75, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.560582160949707
Epoch: 76, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.5735077857971191
Epoch: 77, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.5631601810455322
Epoch: 78, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.6324453353881836
Epoch: 79, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.6280200481414795
Epoch: 80, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.5389499664306641
Epoch: 81, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.5151379108428955
Epoch: 82, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.784 Vali Acc: 0.750 Test Loss: 0.784 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.5672273635864258
Epoch: 83, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 24676
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.08852481842041
Epoch: 1, Steps: 3 | Train Loss: 1.639 Vali Loss: 1.378 Vali Acc: 0.225 Test Loss: 1.378 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5079779624938965
Epoch: 2, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.371 Vali Acc: 0.275 Test Loss: 1.371 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.5857841968536377
Epoch: 3, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.364 Vali Acc: 0.250 Test Loss: 1.364 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5474298000335693
Epoch: 4, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.352 Vali Acc: 0.375 Test Loss: 1.352 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.5087199211120605
Epoch: 5, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.336 Vali Acc: 0.375 Test Loss: 1.336 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.5951318740844727
Epoch: 6, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.315 Vali Acc: 0.400 Test Loss: 1.315 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.6062359809875488
Epoch: 7, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.293 Vali Acc: 0.425 Test Loss: 1.293 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.601254940032959
Epoch: 8, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.270 Vali Acc: 0.475 Test Loss: 1.270 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.5844461917877197
Epoch: 9, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.247 Vali Acc: 0.475 Test Loss: 1.247 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 0.5896167755126953
Epoch: 10, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.222 Vali Acc: 0.475 Test Loss: 1.222 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.5380642414093018
Epoch: 11, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.5475485324859619
Epoch: 12, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.170 Vali Acc: 0.575 Test Loss: 1.170 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 0.5724284648895264
Epoch: 13, Steps: 3 | Train Loss: 0.845 Vali Loss: 1.152 Vali Acc: 0.625 Test Loss: 1.152 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 14 cost time: 0.6365079879760742
Epoch: 14, Steps: 3 | Train Loss: 0.788 Vali Loss: 1.129 Vali Acc: 0.650 Test Loss: 1.129 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 0.5560803413391113
Epoch: 15, Steps: 3 | Train Loss: 0.749 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5766534805297852
Epoch: 16, Steps: 3 | Train Loss: 0.600 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6487493515014648
Epoch: 17, Steps: 3 | Train Loss: 0.518 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6012544631958008
Epoch: 18, Steps: 3 | Train Loss: 0.523 Vali Loss: 1.050 Vali Acc: 0.625 Test Loss: 1.050 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5702407360076904
Epoch: 19, Steps: 3 | Train Loss: 0.455 Vali Loss: 1.028 Vali Acc: 0.650 Test Loss: 1.028 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 20 cost time: 0.5651707649230957
Epoch: 20, Steps: 3 | Train Loss: 0.389 Vali Loss: 1.014 Vali Acc: 0.650 Test Loss: 1.014 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 21 cost time: 0.6431169509887695
Epoch: 21, Steps: 3 | Train Loss: 0.361 Vali Loss: 1.004 Vali Acc: 0.625 Test Loss: 1.004 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.600266695022583
Epoch: 22, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.993 Vali Acc: 0.650 Test Loss: 0.993 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 23 cost time: 0.6836667060852051
Epoch: 23, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.983 Vali Acc: 0.650 Test Loss: 0.983 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 0.6071391105651855
Epoch: 24, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.978 Vali Acc: 0.650 Test Loss: 0.978 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 25 cost time: 0.5578632354736328
Epoch: 25, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.980 Vali Acc: 0.650 Test Loss: 0.980 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6122124195098877
Epoch: 26, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.978 Vali Acc: 0.625 Test Loss: 0.978 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6866307258605957
Epoch: 27, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.974 Vali Acc: 0.650 Test Loss: 0.974 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 28 cost time: 0.5724334716796875
Epoch: 28, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.960 Vali Acc: 0.675 Test Loss: 0.960 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 29 cost time: 0.5717577934265137
Epoch: 29, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.947 Vali Acc: 0.675 Test Loss: 0.947 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 30 cost time: 0.5823409557342529
Epoch: 30, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.937 Vali Acc: 0.675 Test Loss: 0.937 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 31 cost time: 0.604048490524292
Epoch: 31, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.935 Vali Acc: 0.675 Test Loss: 0.935 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 32 cost time: 0.5920181274414062
Epoch: 32, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.931 Vali Acc: 0.700 Test Loss: 0.931 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 33 cost time: 0.5583815574645996
Epoch: 33, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.932 Vali Acc: 0.700 Test Loss: 0.932 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6851584911346436
Epoch: 34, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.925 Vali Acc: 0.725 Test Loss: 0.925 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 35 cost time: 0.49951601028442383
Epoch: 35, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.921 Vali Acc: 0.725 Test Loss: 0.921 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 36 cost time: 0.5631899833679199
Epoch: 36, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.915 Vali Acc: 0.750 Test Loss: 0.915 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 37 cost time: 0.5918700695037842
Epoch: 37, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.911 Vali Acc: 0.750 Test Loss: 0.911 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 38 cost time: 0.5464668273925781
Epoch: 38, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.909 Vali Acc: 0.750 Test Loss: 0.909 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 39 cost time: 0.6144859790802002
Epoch: 39, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.909 Vali Acc: 0.750 Test Loss: 0.909 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5766911506652832
Epoch: 40, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.913 Vali Acc: 0.700 Test Loss: 0.913 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5961897373199463
Epoch: 41, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.918 Vali Acc: 0.700 Test Loss: 0.918 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5235855579376221
Epoch: 42, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.921 Vali Acc: 0.700 Test Loss: 0.921 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6212179660797119
Epoch: 43, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.927 Vali Acc: 0.725 Test Loss: 0.927 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.618922233581543
Epoch: 44, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.931 Vali Acc: 0.725 Test Loss: 0.931 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5619487762451172
Epoch: 45, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.932 Vali Acc: 0.725 Test Loss: 0.932 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6315233707427979
Epoch: 46, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.929 Vali Acc: 0.725 Test Loss: 0.929 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6047718524932861
Epoch: 47, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5191149711608887
Epoch: 48, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.926 Vali Acc: 0.750 Test Loss: 0.926 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 18180
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.385467052459717
Epoch: 1, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.446 Vali Acc: 0.300 Test Loss: 1.446 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5772261619567871
Epoch: 2, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.413 Vali Acc: 0.275 Test Loss: 1.413 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7623798847198486
Epoch: 3, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.384 Vali Acc: 0.275 Test Loss: 1.384 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5170280933380127
Epoch: 4, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.354 Vali Acc: 0.325 Test Loss: 1.354 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.647484302520752
Epoch: 5, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.322 Vali Acc: 0.375 Test Loss: 1.322 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.5974490642547607
Epoch: 6, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.290 Vali Acc: 0.400 Test Loss: 1.290 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.6297683715820312
Epoch: 7, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.5630381107330322
Epoch: 8, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.234 Vali Acc: 0.525 Test Loss: 1.234 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.5662755966186523
Epoch: 9, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5957849025726318
Epoch: 10, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.178 Vali Acc: 0.550 Test Loss: 1.178 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.5890946388244629
Epoch: 11, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.151 Vali Acc: 0.550 Test Loss: 1.151 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.6008954048156738
Epoch: 12, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.126 Vali Acc: 0.550 Test Loss: 1.126 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 13 cost time: 0.5636696815490723
Epoch: 13, Steps: 3 | Train Loss: 0.814 Vali Loss: 1.102 Vali Acc: 0.600 Test Loss: 1.102 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.548973798751831
Epoch: 14, Steps: 3 | Train Loss: 0.865 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.5353803634643555
Epoch: 15, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.058 Vali Acc: 0.625 Test Loss: 1.058 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 16 cost time: 0.5654246807098389
Epoch: 16, Steps: 3 | Train Loss: 0.645 Vali Loss: 1.036 Vali Acc: 0.625 Test Loss: 1.036 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 17 cost time: 0.5411772727966309
Epoch: 17, Steps: 3 | Train Loss: 0.681 Vali Loss: 1.020 Vali Acc: 0.625 Test Loss: 1.020 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 0.566178560256958
Epoch: 18, Steps: 3 | Train Loss: 0.612 Vali Loss: 1.001 Vali Acc: 0.675 Test Loss: 1.001 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 19 cost time: 0.6311726570129395
Epoch: 19, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.985 Vali Acc: 0.700 Test Loss: 0.985 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.6503832340240479
Epoch: 20, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.968 Vali Acc: 0.725 Test Loss: 0.968 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 21 cost time: 0.6475062370300293
Epoch: 21, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.955 Vali Acc: 0.725 Test Loss: 0.955 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 22 cost time: 0.6689391136169434
Epoch: 22, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.942 Vali Acc: 0.700 Test Loss: 0.942 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6601169109344482
Epoch: 23, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.928 Vali Acc: 0.700 Test Loss: 0.928 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5812942981719971
Epoch: 24, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.917 Vali Acc: 0.700 Test Loss: 0.917 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5034756660461426
Epoch: 25, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.901 Vali Acc: 0.700 Test Loss: 0.901 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.539790153503418
Epoch: 26, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.889 Vali Acc: 0.700 Test Loss: 0.889 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6936790943145752
Epoch: 27, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.881 Vali Acc: 0.725 Test Loss: 0.881 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 28 cost time: 0.5135931968688965
Epoch: 28, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.869 Vali Acc: 0.725 Test Loss: 0.869 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 29 cost time: 0.5933606624603271
Epoch: 29, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.862 Vali Acc: 0.725 Test Loss: 0.862 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 30 cost time: 0.5570011138916016
Epoch: 30, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.857 Vali Acc: 0.725 Test Loss: 0.857 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 31 cost time: 0.5595602989196777
Epoch: 31, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.856 Vali Acc: 0.700 Test Loss: 0.856 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5790669918060303
Epoch: 32, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.859 Vali Acc: 0.675 Test Loss: 0.859 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5692009925842285
Epoch: 33, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.862 Vali Acc: 0.675 Test Loss: 0.862 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5291471481323242
Epoch: 34, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.862 Vali Acc: 0.675 Test Loss: 0.862 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5199496746063232
Epoch: 35, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.861 Vali Acc: 0.675 Test Loss: 0.861 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5250928401947021
Epoch: 36, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.855 Vali Acc: 0.675 Test Loss: 0.855 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5984008312225342
Epoch: 37, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.850 Vali Acc: 0.675 Test Loss: 0.850 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6178510189056396
Epoch: 38, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.847 Vali Acc: 0.675 Test Loss: 0.847 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5946915149688721
Epoch: 39, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.840 Vali Acc: 0.675 Test Loss: 0.840 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5575196743011475
Epoch: 40, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.832 Vali Acc: 0.675 Test Loss: 0.832 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 15156
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3741023540496826
Epoch: 1, Steps: 3 | Train Loss: 1.590 Vali Loss: 1.334 Vali Acc: 0.325 Test Loss: 1.334 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 0.7581818103790283
Epoch: 2, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.322 Vali Acc: 0.250 Test Loss: 1.322 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.590172529220581
Epoch: 3, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.314 Vali Acc: 0.225 Test Loss: 1.314 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49894261360168457
Epoch: 4, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.306 Vali Acc: 0.250 Test Loss: 1.306 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.46802401542663574
Epoch: 5, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.295 Vali Acc: 0.275 Test Loss: 1.295 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5573279857635498
Epoch: 6, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.284 Vali Acc: 0.300 Test Loss: 1.284 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.515554666519165
Epoch: 7, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.271 Vali Acc: 0.325 Test Loss: 1.271 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 8 cost time: 0.6491622924804688
Epoch: 8, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.257 Vali Acc: 0.350 Test Loss: 1.257 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 9 cost time: 0.49060678482055664
Epoch: 9, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.243 Vali Acc: 0.350 Test Loss: 1.243 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349988).  Saving model ...
Epoch: 10 cost time: 0.5239412784576416
Epoch: 10, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.231 Vali Acc: 0.375 Test Loss: 1.231 Test Acc: 0.375
Validation loss decreased (-0.349988 --> -0.374988).  Saving model ...
Epoch: 11 cost time: 0.4923884868621826
Epoch: 11, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.217 Vali Acc: 0.375 Test Loss: 1.217 Test Acc: 0.375
Validation loss decreased (-0.374988 --> -0.374988).  Saving model ...
Epoch: 12 cost time: 0.4933946132659912
Epoch: 12, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
Validation loss decreased (-0.374988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.4955759048461914
Epoch: 13, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.188 Vali Acc: 0.450 Test Loss: 1.188 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449988).  Saving model ...
Epoch: 14 cost time: 0.49440526962280273
Epoch: 14, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.175 Vali Acc: 0.450 Test Loss: 1.175 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 15 cost time: 0.507063627243042
Epoch: 15, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.159 Vali Acc: 0.475 Test Loss: 1.159 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 16 cost time: 0.49256300926208496
Epoch: 16, Steps: 3 | Train Loss: 0.814 Vali Loss: 1.142 Vali Acc: 0.475 Test Loss: 1.142 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474989).  Saving model ...
Epoch: 17 cost time: 0.5326118469238281
Epoch: 17, Steps: 3 | Train Loss: 0.800 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499989).  Saving model ...
Epoch: 18 cost time: 0.5717997550964355
Epoch: 18, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 19 cost time: 0.5591192245483398
Epoch: 19, Steps: 3 | Train Loss: 0.738 Vali Loss: 1.095 Vali Acc: 0.500 Test Loss: 1.095 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 20 cost time: 0.6471643447875977
Epoch: 20, Steps: 3 | Train Loss: 0.603 Vali Loss: 1.080 Vali Acc: 0.500 Test Loss: 1.080 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 21 cost time: 0.4935731887817383
Epoch: 21, Steps: 3 | Train Loss: 0.555 Vali Loss: 1.066 Vali Acc: 0.500 Test Loss: 1.066 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 22 cost time: 0.4810807704925537
Epoch: 22, Steps: 3 | Train Loss: 0.500 Vali Loss: 1.055 Vali Acc: 0.500 Test Loss: 1.055 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 23 cost time: 0.5186965465545654
Epoch: 23, Steps: 3 | Train Loss: 0.505 Vali Loss: 1.046 Vali Acc: 0.525 Test Loss: 1.046 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524990).  Saving model ...
Epoch: 24 cost time: 0.5212001800537109
Epoch: 24, Steps: 3 | Train Loss: 0.455 Vali Loss: 1.037 Vali Acc: 0.525 Test Loss: 1.037 Test Acc: 0.525
Validation loss decreased (-0.524990 --> -0.524990).  Saving model ...
Epoch: 25 cost time: 0.5659794807434082
Epoch: 25, Steps: 3 | Train Loss: 0.444 Vali Loss: 1.028 Vali Acc: 0.525 Test Loss: 1.028 Test Acc: 0.525
Validation loss decreased (-0.524990 --> -0.524990).  Saving model ...
Epoch: 26 cost time: 0.5453968048095703
Epoch: 26, Steps: 3 | Train Loss: 0.397 Vali Loss: 1.018 Vali Acc: 0.550 Test Loss: 1.018 Test Acc: 0.550
Validation loss decreased (-0.524990 --> -0.549990).  Saving model ...
Epoch: 27 cost time: 0.5202243328094482
Epoch: 27, Steps: 3 | Train Loss: 0.375 Vali Loss: 1.007 Vali Acc: 0.575 Test Loss: 1.007 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 28 cost time: 0.5189988613128662
Epoch: 28, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.999 Vali Acc: 0.575 Test Loss: 0.999 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 29 cost time: 0.6114614009857178
Epoch: 29, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.990 Vali Acc: 0.575 Test Loss: 0.990 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 30 cost time: 0.5290408134460449
Epoch: 30, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 31 cost time: 0.5710718631744385
Epoch: 31, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.983 Vali Acc: 0.600 Test Loss: 0.983 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 32 cost time: 0.4995286464691162
Epoch: 32, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.979 Vali Acc: 0.600 Test Loss: 0.979 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 33 cost time: 0.508493185043335
Epoch: 33, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 34 cost time: 0.4726896286010742
Epoch: 34, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.970 Vali Acc: 0.600 Test Loss: 0.970 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 35 cost time: 0.5188989639282227
Epoch: 35, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.965 Vali Acc: 0.625 Test Loss: 0.965 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 36 cost time: 0.5021536350250244
Epoch: 36, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.960 Vali Acc: 0.625 Test Loss: 0.960 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 37 cost time: 0.5018808841705322
Epoch: 37, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.953 Vali Acc: 0.625 Test Loss: 0.953 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 38 cost time: 0.5650331974029541
Epoch: 38, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.946 Vali Acc: 0.625 Test Loss: 0.946 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 39 cost time: 0.4434163570404053
Epoch: 39, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.941 Vali Acc: 0.625 Test Loss: 0.941 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 40 cost time: 0.5292391777038574
Epoch: 40, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.942 Vali Acc: 0.625 Test Loss: 0.942 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.44703125953674316
Epoch: 41, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.944 Vali Acc: 0.625 Test Loss: 0.944 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5762913227081299
Epoch: 42, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.947 Vali Acc: 0.650 Test Loss: 0.947 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649991).  Saving model ...
Epoch: 43 cost time: 0.6178634166717529
Epoch: 43, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.951 Vali Acc: 0.650 Test Loss: 0.951 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5459325313568115
Epoch: 44, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.953 Vali Acc: 0.675 Test Loss: 0.953 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674990).  Saving model ...
Epoch: 45 cost time: 0.5313670635223389
Epoch: 45, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.960 Vali Acc: 0.650 Test Loss: 0.960 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4727754592895508
Epoch: 46, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.965 Vali Acc: 0.650 Test Loss: 0.965 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5297279357910156
Epoch: 47, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.966 Vali Acc: 0.650 Test Loss: 0.966 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5397827625274658
Epoch: 48, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.966 Vali Acc: 0.650 Test Loss: 0.966 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6155092716217041
Epoch: 49, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.962 Vali Acc: 0.650 Test Loss: 0.962 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5148701667785645
Epoch: 50, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.959 Vali Acc: 0.650 Test Loss: 0.959 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5167310237884521
Epoch: 51, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.955 Vali Acc: 0.650 Test Loss: 0.955 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.507502555847168
Epoch: 52, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.950 Vali Acc: 0.675 Test Loss: 0.950 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 53 cost time: 0.5218138694763184
Epoch: 53, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.946 Vali Acc: 0.700 Test Loss: 0.946 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 54 cost time: 0.5365159511566162
Epoch: 54, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.942 Vali Acc: 0.700 Test Loss: 0.942 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 55 cost time: 0.4917781352996826
Epoch: 55, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.939 Vali Acc: 0.700 Test Loss: 0.939 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 56 cost time: 0.46998047828674316
Epoch: 56, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.936 Vali Acc: 0.700 Test Loss: 0.936 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 57 cost time: 0.5034558773040771
Epoch: 57, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.934 Vali Acc: 0.700 Test Loss: 0.934 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 58 cost time: 0.5044140815734863
Epoch: 58, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.931 Vali Acc: 0.700 Test Loss: 0.931 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 59 cost time: 0.5382208824157715
Epoch: 59, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.928 Vali Acc: 0.700 Test Loss: 0.928 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 60 cost time: 0.437518835067749
Epoch: 60, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.927 Vali Acc: 0.700 Test Loss: 0.927 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 61 cost time: 0.6032683849334717
Epoch: 61, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.926 Vali Acc: 0.700 Test Loss: 0.926 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 62 cost time: 0.4825928211212158
Epoch: 62, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.929 Vali Acc: 0.700 Test Loss: 0.929 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.44380879402160645
Epoch: 63, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.931 Vali Acc: 0.675 Test Loss: 0.931 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.5159058570861816
Epoch: 64, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.934 Vali Acc: 0.675 Test Loss: 0.934 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.4807393550872803
Epoch: 65, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.936 Vali Acc: 0.700 Test Loss: 0.936 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.4482295513153076
Epoch: 66, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.939 Vali Acc: 0.725 Test Loss: 0.939 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 67 cost time: 0.6498193740844727
Epoch: 67, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.941 Vali Acc: 0.725 Test Loss: 0.941 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.5104877948760986
Epoch: 68, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.943 Vali Acc: 0.725 Test Loss: 0.943 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.564969539642334
Epoch: 69, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.945 Vali Acc: 0.725 Test Loss: 0.945 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.4787149429321289
Epoch: 70, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.5409829616546631
Epoch: 71, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.946 Vali Acc: 0.700 Test Loss: 0.946 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.4969046115875244
Epoch: 72, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.48310399055480957
Epoch: 73, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.950 Vali Acc: 0.700 Test Loss: 0.950 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.4359712600708008
Epoch: 74, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.951 Vali Acc: 0.700 Test Loss: 0.951 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.45004844665527344
Epoch: 75, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.952 Vali Acc: 0.700 Test Loss: 0.952 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.4555544853210449
Epoch: 76, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.952 Vali Acc: 0.700 Test Loss: 0.952 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 13268
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1165857315063477
Epoch: 1, Steps: 3 | Train Loss: 1.565 Vali Loss: 1.422 Vali Acc: 0.250 Test Loss: 1.422 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.4725313186645508
Epoch: 2, Steps: 3 | Train Loss: 1.598 Vali Loss: 1.419 Vali Acc: 0.250 Test Loss: 1.419 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.5104272365570068
Epoch: 3, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.418 Vali Acc: 0.225 Test Loss: 1.418 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5160565376281738
Epoch: 4, Steps: 3 | Train Loss: 1.570 Vali Loss: 1.412 Vali Acc: 0.225 Test Loss: 1.412 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5194385051727295
Epoch: 5, Steps: 3 | Train Loss: 1.526 Vali Loss: 1.406 Vali Acc: 0.250 Test Loss: 1.406 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 0.5033233165740967
Epoch: 6, Steps: 3 | Train Loss: 1.502 Vali Loss: 1.398 Vali Acc: 0.300 Test Loss: 1.398 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 0.5062835216522217
Epoch: 7, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.387 Vali Acc: 0.325 Test Loss: 1.387 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.526482105255127
Epoch: 8, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.375 Vali Acc: 0.325 Test Loss: 1.375 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 9 cost time: 0.5143592357635498
Epoch: 9, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.363 Vali Acc: 0.325 Test Loss: 1.363 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 10 cost time: 0.5214850902557373
Epoch: 10, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.351 Vali Acc: 0.375 Test Loss: 1.351 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 11 cost time: 0.5569896697998047
Epoch: 11, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.338 Vali Acc: 0.375 Test Loss: 1.338 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 12 cost time: 0.5008914470672607
Epoch: 12, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.325 Vali Acc: 0.425 Test Loss: 1.325 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 0.483295202255249
Epoch: 13, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.311 Vali Acc: 0.425 Test Loss: 1.311 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 14 cost time: 0.533794641494751
Epoch: 14, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.296 Vali Acc: 0.450 Test Loss: 1.296 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 15 cost time: 0.5233755111694336
Epoch: 15, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.281 Vali Acc: 0.500 Test Loss: 1.281 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 16 cost time: 0.5043885707855225
Epoch: 16, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 17 cost time: 0.4775259494781494
Epoch: 17, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.253 Vali Acc: 0.525 Test Loss: 1.253 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 18 cost time: 0.4230384826660156
Epoch: 18, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.239 Vali Acc: 0.550 Test Loss: 1.239 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 19 cost time: 0.48742008209228516
Epoch: 19, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.228 Vali Acc: 0.575 Test Loss: 1.228 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.5012335777282715
Epoch: 20, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.216 Vali Acc: 0.575 Test Loss: 1.216 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.5699939727783203
Epoch: 21, Steps: 3 | Train Loss: 0.907 Vali Loss: 1.204 Vali Acc: 0.575 Test Loss: 1.204 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 22 cost time: 0.5174541473388672
Epoch: 22, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.193 Vali Acc: 0.575 Test Loss: 1.193 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 23 cost time: 0.4684298038482666
Epoch: 23, Steps: 3 | Train Loss: 0.833 Vali Loss: 1.181 Vali Acc: 0.575 Test Loss: 1.181 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 24 cost time: 0.5213909149169922
Epoch: 24, Steps: 3 | Train Loss: 0.804 Vali Loss: 1.172 Vali Acc: 0.600 Test Loss: 1.172 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 25 cost time: 0.5527501106262207
Epoch: 25, Steps: 3 | Train Loss: 0.774 Vali Loss: 1.165 Vali Acc: 0.600 Test Loss: 1.165 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 26 cost time: 0.5125455856323242
Epoch: 26, Steps: 3 | Train Loss: 0.711 Vali Loss: 1.159 Vali Acc: 0.600 Test Loss: 1.159 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 27 cost time: 0.4896280765533447
Epoch: 27, Steps: 3 | Train Loss: 0.688 Vali Loss: 1.150 Vali Acc: 0.600 Test Loss: 1.150 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 28 cost time: 0.509270429611206
Epoch: 28, Steps: 3 | Train Loss: 0.651 Vali Loss: 1.143 Vali Acc: 0.600 Test Loss: 1.143 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 29 cost time: 0.501502275466919
Epoch: 29, Steps: 3 | Train Loss: 0.619 Vali Loss: 1.134 Vali Acc: 0.600 Test Loss: 1.134 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 30 cost time: 0.4897329807281494
Epoch: 30, Steps: 3 | Train Loss: 0.588 Vali Loss: 1.129 Vali Acc: 0.600 Test Loss: 1.129 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 31 cost time: 0.4710240364074707
Epoch: 31, Steps: 3 | Train Loss: 0.523 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 32 cost time: 0.5029313564300537
Epoch: 32, Steps: 3 | Train Loss: 0.546 Vali Loss: 1.115 Vali Acc: 0.600 Test Loss: 1.115 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 33 cost time: 0.5002622604370117
Epoch: 33, Steps: 3 | Train Loss: 0.521 Vali Loss: 1.109 Vali Acc: 0.575 Test Loss: 1.109 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5339028835296631
Epoch: 34, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.108 Vali Acc: 0.575 Test Loss: 1.108 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5902848243713379
Epoch: 35, Steps: 3 | Train Loss: 0.437 Vali Loss: 1.107 Vali Acc: 0.575 Test Loss: 1.107 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.49596333503723145
Epoch: 36, Steps: 3 | Train Loss: 0.405 Vali Loss: 1.105 Vali Acc: 0.575 Test Loss: 1.105 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5192313194274902
Epoch: 37, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.103 Vali Acc: 0.575 Test Loss: 1.103 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4566154479980469
Epoch: 38, Steps: 3 | Train Loss: 0.340 Vali Loss: 1.100 Vali Acc: 0.600 Test Loss: 1.100 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 39 cost time: 0.5226383209228516
Epoch: 39, Steps: 3 | Train Loss: 0.383 Vali Loss: 1.095 Vali Acc: 0.600 Test Loss: 1.095 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 40 cost time: 0.5190091133117676
Epoch: 40, Steps: 3 | Train Loss: 0.348 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 41 cost time: 0.5032646656036377
Epoch: 41, Steps: 3 | Train Loss: 0.316 Vali Loss: 1.093 Vali Acc: 0.575 Test Loss: 1.093 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5427887439727783
Epoch: 42, Steps: 3 | Train Loss: 0.281 Vali Loss: 1.088 Vali Acc: 0.575 Test Loss: 1.088 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.4900641441345215
Epoch: 43, Steps: 3 | Train Loss: 0.277 Vali Loss: 1.085 Vali Acc: 0.575 Test Loss: 1.085 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.514108419418335
Epoch: 44, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.082 Vali Acc: 0.575 Test Loss: 1.082 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5043656826019287
Epoch: 45, Steps: 3 | Train Loss: 0.227 Vali Loss: 1.077 Vali Acc: 0.575 Test Loss: 1.077 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.44994306564331055
Epoch: 46, Steps: 3 | Train Loss: 0.231 Vali Loss: 1.073 Vali Acc: 0.575 Test Loss: 1.073 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5373778343200684
Epoch: 47, Steps: 3 | Train Loss: 0.247 Vali Loss: 1.069 Vali Acc: 0.575 Test Loss: 1.069 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.4687645435333252
Epoch: 48, Steps: 3 | Train Loss: 0.199 Vali Loss: 1.068 Vali Acc: 0.575 Test Loss: 1.068 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.4908316135406494
Epoch: 49, Steps: 3 | Train Loss: 0.199 Vali Loss: 1.067 Vali Acc: 0.575 Test Loss: 1.067 Test Acc: 0.575
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.5723724365234375
Epoch: 50, Steps: 3 | Train Loss: 0.196 Vali Loss: 1.068 Vali Acc: 0.550 Test Loss: 1.068 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.6
model parameter : 10276
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.032491683959961
Epoch: 1, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.376 Vali Acc: 0.200 Test Loss: 1.376 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5185363292694092
Epoch: 2, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.378 Vali Acc: 0.200 Test Loss: 1.378 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5494339466094971
Epoch: 3, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.382 Vali Acc: 0.200 Test Loss: 1.382 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6706821918487549
Epoch: 4, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.382 Vali Acc: 0.175 Test Loss: 1.382 Test Acc: 0.175
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5303530693054199
Epoch: 5, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.380 Vali Acc: 0.175 Test Loss: 1.380 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.552715539932251
Epoch: 6, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.376 Vali Acc: 0.200 Test Loss: 1.376 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 7 cost time: 0.4841907024383545
Epoch: 7, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.370 Vali Acc: 0.225 Test Loss: 1.370 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 8 cost time: 0.6062238216400146
Epoch: 8, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.364 Vali Acc: 0.225 Test Loss: 1.364 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 9 cost time: 0.6408593654632568
Epoch: 9, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.357 Vali Acc: 0.250 Test Loss: 1.357 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 0.5395941734313965
Epoch: 10, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.348 Vali Acc: 0.250 Test Loss: 1.348 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249987).  Saving model ...
Epoch: 11 cost time: 0.5825212001800537
Epoch: 11, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.338 Vali Acc: 0.275 Test Loss: 1.338 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 12 cost time: 0.5445120334625244
Epoch: 12, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.328 Vali Acc: 0.350 Test Loss: 1.328 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349987).  Saving model ...
Epoch: 13 cost time: 0.5545599460601807
Epoch: 13, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.317 Vali Acc: 0.375 Test Loss: 1.317 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 14 cost time: 0.49054408073425293
Epoch: 14, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.307 Vali Acc: 0.375 Test Loss: 1.307 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 15 cost time: 0.6046767234802246
Epoch: 15, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.298 Vali Acc: 0.375 Test Loss: 1.298 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 16 cost time: 0.5035688877105713
Epoch: 16, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.289 Vali Acc: 0.375 Test Loss: 1.289 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 17 cost time: 0.5184247493743896
Epoch: 17, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.280 Vali Acc: 0.375 Test Loss: 1.280 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 18 cost time: 0.536304235458374
Epoch: 18, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.270 Vali Acc: 0.375 Test Loss: 1.270 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 19 cost time: 0.5258817672729492
Epoch: 19, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.260 Vali Acc: 0.400 Test Loss: 1.260 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 20 cost time: 0.5106160640716553
Epoch: 20, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.249 Vali Acc: 0.400 Test Loss: 1.249 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 0.5696384906768799
Epoch: 21, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 22 cost time: 0.5609827041625977
Epoch: 22, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 23 cost time: 0.4385344982147217
Epoch: 23, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.221 Vali Acc: 0.450 Test Loss: 1.221 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449988).  Saving model ...
Epoch: 24 cost time: 0.5324313640594482
Epoch: 24, Steps: 3 | Train Loss: 0.843 Vali Loss: 1.211 Vali Acc: 0.475 Test Loss: 1.211 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 25 cost time: 0.5492868423461914
Epoch: 25, Steps: 3 | Train Loss: 0.750 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 26 cost time: 0.5165057182312012
Epoch: 26, Steps: 3 | Train Loss: 0.698 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 27 cost time: 0.5618729591369629
Epoch: 27, Steps: 3 | Train Loss: 0.675 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 28 cost time: 0.5710391998291016
Epoch: 28, Steps: 3 | Train Loss: 0.662 Vali Loss: 1.171 Vali Acc: 0.525 Test Loss: 1.171 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 29 cost time: 0.6021437644958496
Epoch: 29, Steps: 3 | Train Loss: 0.645 Vali Loss: 1.161 Vali Acc: 0.550 Test Loss: 1.161 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 30 cost time: 0.5378134250640869
Epoch: 30, Steps: 3 | Train Loss: 0.542 Vali Loss: 1.152 Vali Acc: 0.575 Test Loss: 1.152 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 31 cost time: 0.5163474082946777
Epoch: 31, Steps: 3 | Train Loss: 0.601 Vali Loss: 1.143 Vali Acc: 0.600 Test Loss: 1.143 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 32 cost time: 0.5232386589050293
Epoch: 32, Steps: 3 | Train Loss: 0.598 Vali Loss: 1.136 Vali Acc: 0.600 Test Loss: 1.136 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 33 cost time: 0.4347410202026367
Epoch: 33, Steps: 3 | Train Loss: 0.508 Vali Loss: 1.130 Vali Acc: 0.600 Test Loss: 1.130 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 34 cost time: 0.511207103729248
Epoch: 34, Steps: 3 | Train Loss: 0.511 Vali Loss: 1.125 Vali Acc: 0.600 Test Loss: 1.125 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 35 cost time: 0.5057706832885742
Epoch: 35, Steps: 3 | Train Loss: 0.471 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 36 cost time: 0.5487010478973389
Epoch: 36, Steps: 3 | Train Loss: 0.436 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 37 cost time: 0.5193085670471191
Epoch: 37, Steps: 3 | Train Loss: 0.414 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 38 cost time: 0.4728391170501709
Epoch: 38, Steps: 3 | Train Loss: 0.422 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 39 cost time: 0.55889892578125
Epoch: 39, Steps: 3 | Train Loss: 0.373 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 40 cost time: 0.5121376514434814
Epoch: 40, Steps: 3 | Train Loss: 0.407 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 41 cost time: 0.47461843490600586
Epoch: 41, Steps: 3 | Train Loss: 0.380 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 42 cost time: 0.5446245670318604
Epoch: 42, Steps: 3 | Train Loss: 0.363 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 43 cost time: 0.5344841480255127
Epoch: 43, Steps: 3 | Train Loss: 0.363 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 44 cost time: 0.5129537582397461
Epoch: 44, Steps: 3 | Train Loss: 0.334 Vali Loss: 1.074 Vali Acc: 0.600 Test Loss: 1.074 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 45 cost time: 0.6152780055999756
Epoch: 45, Steps: 3 | Train Loss: 0.263 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 46 cost time: 0.6155755519866943
Epoch: 46, Steps: 3 | Train Loss: 0.261 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5743696689605713
Epoch: 47, Steps: 3 | Train Loss: 0.252 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5555322170257568
Epoch: 48, Steps: 3 | Train Loss: 0.257 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.4451773166656494
Epoch: 49, Steps: 3 | Train Loss: 0.203 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 50 cost time: 0.5459065437316895
Epoch: 50, Steps: 3 | Train Loss: 0.228 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 51 cost time: 0.5724155902862549
Epoch: 51, Steps: 3 | Train Loss: 0.212 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 52 cost time: 0.6002254486083984
Epoch: 52, Steps: 3 | Train Loss: 0.198 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 53 cost time: 0.647780179977417
Epoch: 53, Steps: 3 | Train Loss: 0.181 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 54 cost time: 0.5361874103546143
Epoch: 54, Steps: 3 | Train Loss: 0.209 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 55 cost time: 0.6418752670288086
Epoch: 55, Steps: 3 | Train Loss: 0.175 Vali Loss: 1.042 Vali Acc: 0.625 Test Loss: 1.042 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 56 cost time: 0.5448493957519531
Epoch: 56, Steps: 3 | Train Loss: 0.174 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 57 cost time: 0.5093982219696045
Epoch: 57, Steps: 3 | Train Loss: 0.149 Vali Loss: 1.040 Vali Acc: 0.650 Test Loss: 1.040 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 58 cost time: 0.5052542686462402
Epoch: 58, Steps: 3 | Train Loss: 0.169 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5595595836639404
Epoch: 59, Steps: 3 | Train Loss: 0.132 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5560770034790039
Epoch: 60, Steps: 3 | Train Loss: 0.130 Vali Loss: 1.043 Vali Acc: 0.650 Test Loss: 1.043 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.6624369621276855
Epoch: 61, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.042 Vali Acc: 0.650 Test Loss: 1.042 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.6265850067138672
Epoch: 62, Steps: 3 | Train Loss: 0.122 Vali Loss: 1.043 Vali Acc: 0.650 Test Loss: 1.043 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.49430322647094727
Epoch: 63, Steps: 3 | Train Loss: 0.117 Vali Loss: 1.045 Vali Acc: 0.650 Test Loss: 1.045 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.5336856842041016
Epoch: 64, Steps: 3 | Train Loss: 0.130 Vali Loss: 1.046 Vali Acc: 0.650 Test Loss: 1.046 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.5227367877960205
Epoch: 65, Steps: 3 | Train Loss: 0.120 Vali Loss: 1.047 Vali Acc: 0.650 Test Loss: 1.047 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.5503597259521484
Epoch: 66, Steps: 3 | Train Loss: 0.115 Vali Loss: 1.048 Vali Acc: 0.650 Test Loss: 1.048 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.5298333168029785
Epoch: 67, Steps: 3 | Train Loss: 0.095 Vali Loss: 1.047 Vali Acc: 0.650 Test Loss: 1.047 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 9588
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.144451141357422
Epoch: 1, Steps: 3 | Train Loss: 1.490 Vali Loss: 1.653 Vali Acc: 0.175 Test Loss: 1.653 Test Acc: 0.175
Validation loss decreased (inf --> -0.174983).  Saving model ...
Epoch: 2 cost time: 0.5256929397583008
Epoch: 2, Steps: 3 | Train Loss: 1.516 Vali Loss: 1.640 Vali Acc: 0.150 Test Loss: 1.640 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5453019142150879
Epoch: 3, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.635 Vali Acc: 0.175 Test Loss: 1.635 Test Acc: 0.175
Validation loss decreased (-0.174983 --> -0.174984).  Saving model ...
Epoch: 4 cost time: 0.5401642322540283
Epoch: 4, Steps: 3 | Train Loss: 1.528 Vali Loss: 1.630 Vali Acc: 0.175 Test Loss: 1.630 Test Acc: 0.175
Validation loss decreased (-0.174984 --> -0.174984).  Saving model ...
Epoch: 5 cost time: 0.5330259799957275
Epoch: 5, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.625 Vali Acc: 0.175 Test Loss: 1.625 Test Acc: 0.175
Validation loss decreased (-0.174984 --> -0.174984).  Saving model ...
Epoch: 6 cost time: 0.5083508491516113
Epoch: 6, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.618 Vali Acc: 0.250 Test Loss: 1.618 Test Acc: 0.250
Validation loss decreased (-0.174984 --> -0.249984).  Saving model ...
Epoch: 7 cost time: 0.5050461292266846
Epoch: 7, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.612 Vali Acc: 0.275 Test Loss: 1.612 Test Acc: 0.275
Validation loss decreased (-0.249984 --> -0.274984).  Saving model ...
Epoch: 8 cost time: 0.4787483215332031
Epoch: 8, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.602 Vali Acc: 0.250 Test Loss: 1.602 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5207726955413818
Epoch: 9, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.594 Vali Acc: 0.250 Test Loss: 1.594 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.47395920753479004
Epoch: 10, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.585 Vali Acc: 0.275 Test Loss: 1.585 Test Acc: 0.275
Validation loss decreased (-0.274984 --> -0.274984).  Saving model ...
Epoch: 11 cost time: 0.5121440887451172
Epoch: 11, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.575 Vali Acc: 0.250 Test Loss: 1.575 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5103847980499268
Epoch: 12, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.563 Vali Acc: 0.250 Test Loss: 1.563 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.532965898513794
Epoch: 13, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.552 Vali Acc: 0.250 Test Loss: 1.552 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.502631664276123
Epoch: 14, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.540 Vali Acc: 0.300 Test Loss: 1.540 Test Acc: 0.300
Validation loss decreased (-0.274984 --> -0.299985).  Saving model ...
Epoch: 15 cost time: 0.48737335205078125
Epoch: 15, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.528 Vali Acc: 0.325 Test Loss: 1.528 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 16 cost time: 0.5293216705322266
Epoch: 16, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.518 Vali Acc: 0.400 Test Loss: 1.518 Test Acc: 0.400
Validation loss decreased (-0.324985 --> -0.399985).  Saving model ...
Epoch: 17 cost time: 0.6788344383239746
Epoch: 17, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.506 Vali Acc: 0.400 Test Loss: 1.506 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 18 cost time: 0.4732983112335205
Epoch: 18, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.493 Vali Acc: 0.425 Test Loss: 1.493 Test Acc: 0.425
Validation loss decreased (-0.399985 --> -0.424985).  Saving model ...
Epoch: 19 cost time: 0.5920367240905762
Epoch: 19, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.483 Vali Acc: 0.450 Test Loss: 1.483 Test Acc: 0.450
Validation loss decreased (-0.424985 --> -0.449985).  Saving model ...
Epoch: 20 cost time: 0.5384814739227295
Epoch: 20, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.470 Vali Acc: 0.450 Test Loss: 1.470 Test Acc: 0.450
Validation loss decreased (-0.449985 --> -0.449985).  Saving model ...
Epoch: 21 cost time: 0.5365805625915527
Epoch: 21, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.460 Vali Acc: 0.450 Test Loss: 1.460 Test Acc: 0.450
Validation loss decreased (-0.449985 --> -0.449985).  Saving model ...
Epoch: 22 cost time: 0.5499975681304932
Epoch: 22, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.450 Vali Acc: 0.450 Test Loss: 1.450 Test Acc: 0.450
Validation loss decreased (-0.449985 --> -0.449986).  Saving model ...
Epoch: 23 cost time: 0.6494631767272949
Epoch: 23, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.439 Vali Acc: 0.450 Test Loss: 1.439 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 24 cost time: 0.5416905879974365
Epoch: 24, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499986).  Saving model ...
Epoch: 25 cost time: 0.49222731590270996
Epoch: 25, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.421 Vali Acc: 0.500 Test Loss: 1.421 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 26 cost time: 0.4963827133178711
Epoch: 26, Steps: 3 | Train Loss: 0.849 Vali Loss: 1.411 Vali Acc: 0.500 Test Loss: 1.411 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 27 cost time: 0.4982752799987793
Epoch: 27, Steps: 3 | Train Loss: 0.844 Vali Loss: 1.401 Vali Acc: 0.500 Test Loss: 1.401 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 28 cost time: 0.529055118560791
Epoch: 28, Steps: 3 | Train Loss: 0.827 Vali Loss: 1.391 Vali Acc: 0.500 Test Loss: 1.391 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 29 cost time: 0.52099609375
Epoch: 29, Steps: 3 | Train Loss: 0.732 Vali Loss: 1.384 Vali Acc: 0.500 Test Loss: 1.384 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 30 cost time: 0.5931127071380615
Epoch: 30, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.377 Vali Acc: 0.500 Test Loss: 1.377 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 31 cost time: 0.5481717586517334
Epoch: 31, Steps: 3 | Train Loss: 0.671 Vali Loss: 1.370 Vali Acc: 0.500 Test Loss: 1.370 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 32 cost time: 0.5329642295837402
Epoch: 32, Steps: 3 | Train Loss: 0.732 Vali Loss: 1.363 Vali Acc: 0.525 Test Loss: 1.363 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524986).  Saving model ...
Epoch: 33 cost time: 0.5521392822265625
Epoch: 33, Steps: 3 | Train Loss: 0.749 Vali Loss: 1.356 Vali Acc: 0.600 Test Loss: 1.356 Test Acc: 0.600
Validation loss decreased (-0.524986 --> -0.599986).  Saving model ...
Epoch: 34 cost time: 0.5079314708709717
Epoch: 34, Steps: 3 | Train Loss: 0.675 Vali Loss: 1.352 Vali Acc: 0.600 Test Loss: 1.352 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 35 cost time: 0.5612874031066895
Epoch: 35, Steps: 3 | Train Loss: 0.654 Vali Loss: 1.347 Vali Acc: 0.600 Test Loss: 1.347 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 36 cost time: 0.5186347961425781
Epoch: 36, Steps: 3 | Train Loss: 0.625 Vali Loss: 1.343 Vali Acc: 0.600 Test Loss: 1.343 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 37 cost time: 0.514348030090332
Epoch: 37, Steps: 3 | Train Loss: 0.626 Vali Loss: 1.337 Vali Acc: 0.600 Test Loss: 1.337 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 38 cost time: 0.593228816986084
Epoch: 38, Steps: 3 | Train Loss: 0.567 Vali Loss: 1.333 Vali Acc: 0.625 Test Loss: 1.333 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624987).  Saving model ...
Epoch: 39 cost time: 0.5654323101043701
Epoch: 39, Steps: 3 | Train Loss: 0.553 Vali Loss: 1.330 Vali Acc: 0.600 Test Loss: 1.330 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5478591918945312
Epoch: 40, Steps: 3 | Train Loss: 0.487 Vali Loss: 1.327 Vali Acc: 0.600 Test Loss: 1.327 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4553639888763428
Epoch: 41, Steps: 3 | Train Loss: 0.523 Vali Loss: 1.323 Vali Acc: 0.625 Test Loss: 1.323 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 42 cost time: 0.6146829128265381
Epoch: 42, Steps: 3 | Train Loss: 0.493 Vali Loss: 1.320 Vali Acc: 0.600 Test Loss: 1.320 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5827999114990234
Epoch: 43, Steps: 3 | Train Loss: 0.475 Vali Loss: 1.315 Vali Acc: 0.600 Test Loss: 1.315 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.489063024520874
Epoch: 44, Steps: 3 | Train Loss: 0.443 Vali Loss: 1.310 Vali Acc: 0.625 Test Loss: 1.310 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 45 cost time: 0.537747859954834
Epoch: 45, Steps: 3 | Train Loss: 0.470 Vali Loss: 1.305 Vali Acc: 0.650 Test Loss: 1.305 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 46 cost time: 0.5144588947296143
Epoch: 46, Steps: 3 | Train Loss: 0.426 Vali Loss: 1.301 Vali Acc: 0.650 Test Loss: 1.301 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 47 cost time: 0.54109787940979
Epoch: 47, Steps: 3 | Train Loss: 0.423 Vali Loss: 1.297 Vali Acc: 0.650 Test Loss: 1.297 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 48 cost time: 0.5363240242004395
Epoch: 48, Steps: 3 | Train Loss: 0.401 Vali Loss: 1.292 Vali Acc: 0.650 Test Loss: 1.292 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 49 cost time: 0.5653653144836426
Epoch: 49, Steps: 3 | Train Loss: 0.346 Vali Loss: 1.287 Vali Acc: 0.650 Test Loss: 1.287 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 50 cost time: 0.646240234375
Epoch: 50, Steps: 3 | Train Loss: 0.360 Vali Loss: 1.286 Vali Acc: 0.650 Test Loss: 1.286 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 51 cost time: 0.46387529373168945
Epoch: 51, Steps: 3 | Train Loss: 0.322 Vali Loss: 1.282 Vali Acc: 0.650 Test Loss: 1.282 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 52 cost time: 0.4985015392303467
Epoch: 52, Steps: 3 | Train Loss: 0.333 Vali Loss: 1.279 Vali Acc: 0.650 Test Loss: 1.279 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 53 cost time: 0.5498859882354736
Epoch: 53, Steps: 3 | Train Loss: 0.265 Vali Loss: 1.277 Vali Acc: 0.650 Test Loss: 1.277 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 54 cost time: 0.4861946105957031
Epoch: 54, Steps: 3 | Train Loss: 0.306 Vali Loss: 1.275 Vali Acc: 0.650 Test Loss: 1.275 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 55 cost time: 0.519444465637207
Epoch: 55, Steps: 3 | Train Loss: 0.348 Vali Loss: 1.275 Vali Acc: 0.650 Test Loss: 1.275 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 56 cost time: 0.5391345024108887
Epoch: 56, Steps: 3 | Train Loss: 0.308 Vali Loss: 1.275 Vali Acc: 0.650 Test Loss: 1.275 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 57 cost time: 0.6154389381408691
Epoch: 57, Steps: 3 | Train Loss: 0.245 Vali Loss: 1.274 Vali Acc: 0.650 Test Loss: 1.274 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 58 cost time: 0.5040712356567383
Epoch: 58, Steps: 3 | Train Loss: 0.269 Vali Loss: 1.274 Vali Acc: 0.650 Test Loss: 1.274 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.4321157932281494
Epoch: 59, Steps: 3 | Train Loss: 0.245 Vali Loss: 1.273 Vali Acc: 0.650 Test Loss: 1.273 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 60 cost time: 0.4755539894104004
Epoch: 60, Steps: 3 | Train Loss: 0.265 Vali Loss: 1.271 Vali Acc: 0.650 Test Loss: 1.271 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 61 cost time: 0.4649200439453125
Epoch: 61, Steps: 3 | Train Loss: 0.264 Vali Loss: 1.271 Vali Acc: 0.650 Test Loss: 1.271 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.5353333950042725
Epoch: 62, Steps: 3 | Train Loss: 0.232 Vali Loss: 1.267 Vali Acc: 0.650 Test Loss: 1.267 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 63 cost time: 0.5175626277923584
Epoch: 63, Steps: 3 | Train Loss: 0.208 Vali Loss: 1.264 Vali Acc: 0.650 Test Loss: 1.264 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 64 cost time: 0.5233292579650879
Epoch: 64, Steps: 3 | Train Loss: 0.194 Vali Loss: 1.261 Vali Acc: 0.650 Test Loss: 1.261 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 65 cost time: 0.5546755790710449
Epoch: 65, Steps: 3 | Train Loss: 0.214 Vali Loss: 1.262 Vali Acc: 0.650 Test Loss: 1.262 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5351240634918213
Epoch: 66, Steps: 3 | Train Loss: 0.228 Vali Loss: 1.261 Vali Acc: 0.650 Test Loss: 1.261 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 67 cost time: 0.5834624767303467
Epoch: 67, Steps: 3 | Train Loss: 0.178 Vali Loss: 1.259 Vali Acc: 0.650 Test Loss: 1.259 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 68 cost time: 0.546032190322876
Epoch: 68, Steps: 3 | Train Loss: 0.180 Vali Loss: 1.257 Vali Acc: 0.650 Test Loss: 1.257 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 69 cost time: 0.4883992671966553
Epoch: 69, Steps: 3 | Train Loss: 0.170 Vali Loss: 1.257 Vali Acc: 0.650 Test Loss: 1.257 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 70 cost time: 0.5283496379852295
Epoch: 70, Steps: 3 | Train Loss: 0.178 Vali Loss: 1.256 Vali Acc: 0.650 Test Loss: 1.256 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 71 cost time: 0.5537967681884766
Epoch: 71, Steps: 3 | Train Loss: 0.179 Vali Loss: 1.255 Vali Acc: 0.650 Test Loss: 1.255 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 72 cost time: 0.5245907306671143
Epoch: 72, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.255 Vali Acc: 0.650 Test Loss: 1.255 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 73 cost time: 0.5452432632446289
Epoch: 73, Steps: 3 | Train Loss: 0.177 Vali Loss: 1.253 Vali Acc: 0.650 Test Loss: 1.253 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 74 cost time: 0.5444033145904541
Epoch: 74, Steps: 3 | Train Loss: 0.170 Vali Loss: 1.252 Vali Acc: 0.650 Test Loss: 1.252 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 75 cost time: 0.5396113395690918
Epoch: 75, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.251 Vali Acc: 0.650 Test Loss: 1.251 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 76 cost time: 0.45650601387023926
Epoch: 76, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.249 Vali Acc: 0.650 Test Loss: 1.249 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 77 cost time: 0.4667325019836426
Epoch: 77, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.244 Vali Acc: 0.650 Test Loss: 1.244 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 78 cost time: 0.5235519409179688
Epoch: 78, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.241 Vali Acc: 0.650 Test Loss: 1.241 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 79 cost time: 0.5446352958679199
Epoch: 79, Steps: 3 | Train Loss: 0.133 Vali Loss: 1.238 Vali Acc: 0.650 Test Loss: 1.238 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 80 cost time: 0.49868106842041016
Epoch: 80, Steps: 3 | Train Loss: 0.125 Vali Loss: 1.237 Vali Acc: 0.650 Test Loss: 1.237 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 81 cost time: 0.5475144386291504
Epoch: 81, Steps: 3 | Train Loss: 0.128 Vali Loss: 1.233 Vali Acc: 0.650 Test Loss: 1.233 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 82 cost time: 0.4342191219329834
Epoch: 82, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.233 Vali Acc: 0.650 Test Loss: 1.233 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 83 cost time: 0.46425533294677734
Epoch: 83, Steps: 3 | Train Loss: 0.120 Vali Loss: 1.231 Vali Acc: 0.650 Test Loss: 1.231 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 84 cost time: 0.5487184524536133
Epoch: 84, Steps: 3 | Train Loss: 0.108 Vali Loss: 1.234 Vali Acc: 0.650 Test Loss: 1.234 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.5009598731994629
Epoch: 85, Steps: 3 | Train Loss: 0.115 Vali Loss: 1.236 Vali Acc: 0.650 Test Loss: 1.236 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.5042455196380615
Epoch: 86, Steps: 3 | Train Loss: 0.116 Vali Loss: 1.237 Vali Acc: 0.650 Test Loss: 1.237 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.578953742980957
Epoch: 87, Steps: 3 | Train Loss: 0.091 Vali Loss: 1.238 Vali Acc: 0.650 Test Loss: 1.238 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.4943840503692627
Epoch: 88, Steps: 3 | Train Loss: 0.098 Vali Loss: 1.240 Vali Acc: 0.625 Test Loss: 1.240 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.5412440299987793
Epoch: 89, Steps: 3 | Train Loss: 0.094 Vali Loss: 1.239 Vali Acc: 0.625 Test Loss: 1.239 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.49301624298095703
Epoch: 90, Steps: 3 | Train Loss: 0.084 Vali Loss: 1.238 Vali Acc: 0.650 Test Loss: 1.238 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 0.6333091259002686
Epoch: 91, Steps: 3 | Train Loss: 0.082 Vali Loss: 1.238 Vali Acc: 0.675 Test Loss: 1.238 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 92 cost time: 0.5223069190979004
Epoch: 92, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.236 Vali Acc: 0.675 Test Loss: 1.236 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 93 cost time: 0.4996304512023926
Epoch: 93, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.234 Vali Acc: 0.675 Test Loss: 1.234 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 94 cost time: 0.5457737445831299
Epoch: 94, Steps: 3 | Train Loss: 0.081 Vali Loss: 1.232 Vali Acc: 0.675 Test Loss: 1.232 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 95 cost time: 0.5169997215270996
Epoch: 95, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.230 Vali Acc: 0.675 Test Loss: 1.230 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 96 cost time: 0.590200662612915
Epoch: 96, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.228 Vali Acc: 0.675 Test Loss: 1.228 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 97 cost time: 0.49942946434020996
Epoch: 97, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.227 Vali Acc: 0.675 Test Loss: 1.227 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 98 cost time: 0.5978882312774658
Epoch: 98, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.228 Vali Acc: 0.675 Test Loss: 1.228 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.4878082275390625
Epoch: 99, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.227 Vali Acc: 0.675 Test Loss: 1.227 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 100 cost time: 0.5597822666168213
Epoch: 100, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.225 Vali Acc: 0.675 Test Loss: 1.225 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df128_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 8516
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.056320905685425
Epoch: 1, Steps: 3 | Train Loss: 1.561 Vali Loss: 1.453 Vali Acc: 0.225 Test Loss: 1.453 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.45847344398498535
Epoch: 2, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.425 Vali Acc: 0.225 Test Loss: 1.425 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.5199248790740967
Epoch: 3, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.406 Vali Acc: 0.225 Test Loss: 1.406 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.569450855255127
Epoch: 4, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.380 Vali Acc: 0.300 Test Loss: 1.380 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.5264592170715332
Epoch: 5, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.351 Vali Acc: 0.350 Test Loss: 1.351 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.602327823638916
Epoch: 6, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.323 Vali Acc: 0.425 Test Loss: 1.323 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.5276193618774414
Epoch: 7, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.285 Vali Acc: 0.475 Test Loss: 1.285 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.4952361583709717
Epoch: 8, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.5392050743103027
Epoch: 9, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.207 Vali Acc: 0.525 Test Loss: 1.207 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 0.5087511539459229
Epoch: 10, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.171 Vali Acc: 0.550 Test Loss: 1.171 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.5231461524963379
Epoch: 11, Steps: 3 | Train Loss: 0.808 Vali Loss: 1.137 Vali Acc: 0.550 Test Loss: 1.137 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 0.5654151439666748
Epoch: 12, Steps: 3 | Train Loss: 0.668 Vali Loss: 1.101 Vali Acc: 0.550 Test Loss: 1.101 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 13 cost time: 0.5994231700897217
Epoch: 13, Steps: 3 | Train Loss: 0.599 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.48937201499938965
Epoch: 14, Steps: 3 | Train Loss: 0.571 Vali Loss: 1.031 Vali Acc: 0.650 Test Loss: 1.031 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.49825024604797363
Epoch: 15, Steps: 3 | Train Loss: 0.471 Vali Loss: 1.005 Vali Acc: 0.600 Test Loss: 1.005 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5026359558105469
Epoch: 16, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 0.5559346675872803
Epoch: 17, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 0.5614378452301025
Epoch: 18, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.920 Vali Acc: 0.700 Test Loss: 0.920 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 19 cost time: 0.6157801151275635
Epoch: 19, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.893 Vali Acc: 0.725 Test Loss: 0.893 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 20 cost time: 0.5788311958312988
Epoch: 20, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 21 cost time: 0.5207569599151611
Epoch: 21, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.871 Vali Acc: 0.675 Test Loss: 0.871 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5112323760986328
Epoch: 22, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.852 Vali Acc: 0.750 Test Loss: 0.852 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 23 cost time: 0.5277066230773926
Epoch: 23, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.834 Vali Acc: 0.750 Test Loss: 0.834 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 0.5359361171722412
Epoch: 24, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.820 Vali Acc: 0.750 Test Loss: 0.820 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 25 cost time: 0.5200116634368896
Epoch: 25, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 26 cost time: 0.4907350540161133
Epoch: 26, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.800 Vali Acc: 0.775 Test Loss: 0.800 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 27 cost time: 0.5471642017364502
Epoch: 27, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.789 Vali Acc: 0.775 Test Loss: 0.789 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 28 cost time: 0.5093502998352051
Epoch: 28, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 29 cost time: 0.5147032737731934
Epoch: 29, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.764 Vali Acc: 0.800 Test Loss: 0.764 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 30 cost time: 0.47147035598754883
Epoch: 30, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 31 cost time: 0.53680419921875
Epoch: 31, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.617762565612793
Epoch: 32, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4990885257720947
Epoch: 33, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.751 Vali Acc: 0.775 Test Loss: 0.751 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5044286251068115
Epoch: 34, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.747 Vali Acc: 0.775 Test Loss: 0.747 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5313780307769775
Epoch: 35, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.743 Vali Acc: 0.775 Test Loss: 0.743 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5107066631317139
Epoch: 36, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5527431964874268
Epoch: 37, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.738 Vali Acc: 0.800 Test Loss: 0.738 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 38 cost time: 0.5150671005249023
Epoch: 38, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6526005268096924
Epoch: 39, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5046124458312988
Epoch: 40, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.747 Vali Acc: 0.800 Test Loss: 0.747 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5572347640991211
Epoch: 41, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5777595043182373
Epoch: 42, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.750 Vali Acc: 0.800 Test Loss: 0.750 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.605248212814331
Epoch: 43, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.750 Vali Acc: 0.800 Test Loss: 0.750 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5111925601959229
Epoch: 44, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5220496654510498
Epoch: 45, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.47344136238098145
Epoch: 46, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.46959614753723145
Epoch: 47, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.740 Vali Acc: 0.800 Test Loss: 0.740 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 22564
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.217905282974243
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.520 Vali Acc: 0.175 Test Loss: 1.520 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.5046300888061523
Epoch: 2, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.493 Vali Acc: 0.200 Test Loss: 1.493 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.5587959289550781
Epoch: 3, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.465 Vali Acc: 0.175 Test Loss: 1.465 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5405158996582031
Epoch: 4, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.438 Vali Acc: 0.225 Test Loss: 1.438 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.5650911331176758
Epoch: 5, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.404 Vali Acc: 0.300 Test Loss: 1.404 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.4774806499481201
Epoch: 6, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.369 Vali Acc: 0.350 Test Loss: 1.369 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.4965207576751709
Epoch: 7, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.334 Vali Acc: 0.375 Test Loss: 1.334 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.48458313941955566
Epoch: 8, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.305 Vali Acc: 0.425 Test Loss: 1.305 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.608684778213501
Epoch: 9, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.274 Vali Acc: 0.450 Test Loss: 1.274 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.508185863494873
Epoch: 10, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.251 Vali Acc: 0.450 Test Loss: 1.251 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.5564877986907959
Epoch: 11, Steps: 3 | Train Loss: 0.896 Vali Loss: 1.223 Vali Acc: 0.450 Test Loss: 1.223 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 12 cost time: 0.5376324653625488
Epoch: 12, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.199 Vali Acc: 0.450 Test Loss: 1.199 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 13 cost time: 0.45212697982788086
Epoch: 13, Steps: 3 | Train Loss: 0.766 Vali Loss: 1.178 Vali Acc: 0.450 Test Loss: 1.178 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 14 cost time: 0.5263895988464355
Epoch: 14, Steps: 3 | Train Loss: 0.777 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 0.4979867935180664
Epoch: 15, Steps: 3 | Train Loss: 0.702 Vali Loss: 1.133 Vali Acc: 0.575 Test Loss: 1.133 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 16 cost time: 0.5409157276153564
Epoch: 16, Steps: 3 | Train Loss: 0.672 Vali Loss: 1.109 Vali Acc: 0.625 Test Loss: 1.109 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 0.5080692768096924
Epoch: 17, Steps: 3 | Train Loss: 0.648 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 0.505795955657959
Epoch: 18, Steps: 3 | Train Loss: 0.532 Vali Loss: 1.055 Vali Acc: 0.650 Test Loss: 1.055 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 0.48367857933044434
Epoch: 19, Steps: 3 | Train Loss: 0.445 Vali Loss: 1.034 Vali Acc: 0.650 Test Loss: 1.034 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 20 cost time: 0.5008025169372559
Epoch: 20, Steps: 3 | Train Loss: 0.427 Vali Loss: 1.013 Vali Acc: 0.650 Test Loss: 1.013 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 21 cost time: 0.5162019729614258
Epoch: 21, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.987 Vali Acc: 0.725 Test Loss: 0.987 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724990).  Saving model ...
Epoch: 22 cost time: 0.48915934562683105
Epoch: 22, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.974 Vali Acc: 0.700 Test Loss: 0.974 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.49495959281921387
Epoch: 23, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5135862827301025
Epoch: 24, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.957 Vali Acc: 0.700 Test Loss: 0.957 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5438656806945801
Epoch: 25, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.941 Vali Acc: 0.725 Test Loss: 0.941 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 26 cost time: 0.540844202041626
Epoch: 26, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.924 Vali Acc: 0.725 Test Loss: 0.924 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 27 cost time: 0.4882323741912842
Epoch: 27, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.909 Vali Acc: 0.725 Test Loss: 0.909 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 28 cost time: 0.5353193283081055
Epoch: 28, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.896 Vali Acc: 0.725 Test Loss: 0.896 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 29 cost time: 0.48806071281433105
Epoch: 29, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.877 Vali Acc: 0.725 Test Loss: 0.877 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 30 cost time: 0.5508959293365479
Epoch: 30, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.873 Vali Acc: 0.725 Test Loss: 0.873 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 31 cost time: 0.6504943370819092
Epoch: 31, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.873 Vali Acc: 0.725 Test Loss: 0.873 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5396280288696289
Epoch: 32, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.870 Vali Acc: 0.725 Test Loss: 0.870 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 33 cost time: 0.5501632690429688
Epoch: 33, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.873 Vali Acc: 0.725 Test Loss: 0.873 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5114879608154297
Epoch: 34, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 35 cost time: 0.5331106185913086
Epoch: 35, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.881 Vali Acc: 0.750 Test Loss: 0.881 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.521599531173706
Epoch: 36, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5093090534210205
Epoch: 37, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 38 cost time: 0.5479927062988281
Epoch: 38, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 39 cost time: 0.5020973682403564
Epoch: 39, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 40 cost time: 0.5095767974853516
Epoch: 40, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5179831981658936
Epoch: 41, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 42 cost time: 0.5189855098724365
Epoch: 42, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.866 Vali Acc: 0.750 Test Loss: 0.866 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 43 cost time: 0.6573770046234131
Epoch: 43, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.863 Vali Acc: 0.750 Test Loss: 0.863 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 44 cost time: 0.4703831672668457
Epoch: 44, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.863 Vali Acc: 0.750 Test Loss: 0.863 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5447869300842285
Epoch: 45, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.866 Vali Acc: 0.750 Test Loss: 0.866 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5657904148101807
Epoch: 46, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.867 Vali Acc: 0.750 Test Loss: 0.867 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5201950073242188
Epoch: 47, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.867 Vali Acc: 0.750 Test Loss: 0.867 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6007888317108154
Epoch: 48, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5813322067260742
Epoch: 49, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.869 Vali Acc: 0.750 Test Loss: 0.869 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5380935668945312
Epoch: 50, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5185439586639404
Epoch: 51, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.4817671775817871
Epoch: 52, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.6111712455749512
Epoch: 53, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 16068
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0912184715270996
Epoch: 1, Steps: 3 | Train Loss: 1.593 Vali Loss: 1.469 Vali Acc: 0.225 Test Loss: 1.469 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.5109643936157227
Epoch: 2, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.453 Vali Acc: 0.225 Test Loss: 1.453 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224985).  Saving model ...
Epoch: 3 cost time: 0.5727534294128418
Epoch: 3, Steps: 3 | Train Loss: 1.524 Vali Loss: 1.441 Vali Acc: 0.250 Test Loss: 1.441 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.4835629463195801
Epoch: 4, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.425 Vali Acc: 0.250 Test Loss: 1.425 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.4815654754638672
Epoch: 5, Steps: 3 | Train Loss: 1.502 Vali Loss: 1.407 Vali Acc: 0.250 Test Loss: 1.407 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 0.5289969444274902
Epoch: 6, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.388 Vali Acc: 0.325 Test Loss: 1.388 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.6301398277282715
Epoch: 7, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.366 Vali Acc: 0.300 Test Loss: 1.366 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5680780410766602
Epoch: 8, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.343 Vali Acc: 0.325 Test Loss: 1.343 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 9 cost time: 0.451246976852417
Epoch: 9, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.321 Vali Acc: 0.325 Test Loss: 1.321 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 10 cost time: 0.5416343212127686
Epoch: 10, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.295 Vali Acc: 0.375 Test Loss: 1.295 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 11 cost time: 0.5813910961151123
Epoch: 11, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.270 Vali Acc: 0.400 Test Loss: 1.270 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.5496222972869873
Epoch: 12, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.243 Vali Acc: 0.425 Test Loss: 1.243 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 13 cost time: 0.5602173805236816
Epoch: 13, Steps: 3 | Train Loss: 0.977 Vali Loss: 1.221 Vali Acc: 0.475 Test Loss: 1.221 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 0.5129175186157227
Epoch: 14, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 0.5719306468963623
Epoch: 15, Steps: 3 | Train Loss: 0.778 Vali Loss: 1.177 Vali Acc: 0.525 Test Loss: 1.177 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.5625054836273193
Epoch: 16, Steps: 3 | Train Loss: 0.807 Vali Loss: 1.155 Vali Acc: 0.550 Test Loss: 1.155 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 17 cost time: 0.5334415435791016
Epoch: 17, Steps: 3 | Train Loss: 0.761 Vali Loss: 1.138 Vali Acc: 0.575 Test Loss: 1.138 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 0.5363574028015137
Epoch: 18, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.123 Vali Acc: 0.575 Test Loss: 1.123 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 19 cost time: 0.48709821701049805
Epoch: 19, Steps: 3 | Train Loss: 0.681 Vali Loss: 1.105 Vali Acc: 0.600 Test Loss: 1.105 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.530376672744751
Epoch: 20, Steps: 3 | Train Loss: 0.576 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 0.485842227935791
Epoch: 21, Steps: 3 | Train Loss: 0.583 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.631824254989624
Epoch: 22, Steps: 3 | Train Loss: 0.528 Vali Loss: 1.050 Vali Acc: 0.600 Test Loss: 1.050 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.5874996185302734
Epoch: 23, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.034 Vali Acc: 0.625 Test Loss: 1.034 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 24 cost time: 0.5664987564086914
Epoch: 24, Steps: 3 | Train Loss: 0.407 Vali Loss: 1.019 Vali Acc: 0.650 Test Loss: 1.019 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 25 cost time: 0.5365934371948242
Epoch: 25, Steps: 3 | Train Loss: 0.405 Vali Loss: 1.011 Vali Acc: 0.650 Test Loss: 1.011 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 26 cost time: 0.5534937381744385
Epoch: 26, Steps: 3 | Train Loss: 0.364 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 27 cost time: 0.6352212429046631
Epoch: 27, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.998 Vali Acc: 0.650 Test Loss: 0.998 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 28 cost time: 0.596839189529419
Epoch: 28, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.989 Vali Acc: 0.700 Test Loss: 0.989 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 29 cost time: 0.5307304859161377
Epoch: 29, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.984 Vali Acc: 0.650 Test Loss: 0.984 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6351320743560791
Epoch: 30, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.984 Vali Acc: 0.650 Test Loss: 0.984 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.558851957321167
Epoch: 31, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.977 Vali Acc: 0.650 Test Loss: 0.977 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6155135631561279
Epoch: 32, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.974 Vali Acc: 0.675 Test Loss: 0.974 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.4765932559967041
Epoch: 33, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.974 Vali Acc: 0.700 Test Loss: 0.974 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 34 cost time: 0.5447797775268555
Epoch: 34, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.979 Vali Acc: 0.700 Test Loss: 0.979 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.499361515045166
Epoch: 35, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.978 Vali Acc: 0.700 Test Loss: 0.978 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5295829772949219
Epoch: 36, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.977 Vali Acc: 0.700 Test Loss: 0.977 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5407571792602539
Epoch: 37, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.978 Vali Acc: 0.700 Test Loss: 0.978 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5112864971160889
Epoch: 38, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.976 Vali Acc: 0.700 Test Loss: 0.976 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5259006023406982
Epoch: 39, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.977 Vali Acc: 0.700 Test Loss: 0.977 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5221695899963379
Epoch: 40, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.975 Vali Acc: 0.700 Test Loss: 0.975 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5896134376525879
Epoch: 41, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.973 Vali Acc: 0.700 Test Loss: 0.973 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 42 cost time: 0.5160431861877441
Epoch: 42, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.969 Vali Acc: 0.700 Test Loss: 0.969 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 43 cost time: 0.5234146118164062
Epoch: 43, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 44 cost time: 0.5380938053131104
Epoch: 44, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.960 Vali Acc: 0.700 Test Loss: 0.960 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 45 cost time: 0.5568573474884033
Epoch: 45, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.959 Vali Acc: 0.700 Test Loss: 0.959 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 46 cost time: 0.5162343978881836
Epoch: 46, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.957 Vali Acc: 0.700 Test Loss: 0.957 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 47 cost time: 0.5646460056304932
Epoch: 47, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.961 Vali Acc: 0.700 Test Loss: 0.961 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5500242710113525
Epoch: 48, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5678088665008545
Epoch: 49, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.967 Vali Acc: 0.675 Test Loss: 0.967 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5453531742095947
Epoch: 50, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.970 Vali Acc: 0.675 Test Loss: 0.970 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5643181800842285
Epoch: 51, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.974 Vali Acc: 0.675 Test Loss: 0.974 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6032660007476807
Epoch: 52, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.978 Vali Acc: 0.675 Test Loss: 0.978 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.5745241641998291
Epoch: 53, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.4749584197998047
Epoch: 54, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.983 Vali Acc: 0.650 Test Loss: 0.983 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.6052794456481934
Epoch: 55, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.983 Vali Acc: 0.650 Test Loss: 0.983 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.495497465133667
Epoch: 56, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 13044
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0785820484161377
Epoch: 1, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.434 Vali Acc: 0.275 Test Loss: 1.434 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6015136241912842
Epoch: 2, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.424 Vali Acc: 0.275 Test Loss: 1.424 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.524411678314209
Epoch: 3, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.416 Vali Acc: 0.275 Test Loss: 1.416 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.5459718704223633
Epoch: 4, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.402 Vali Acc: 0.300 Test Loss: 1.402 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.4979248046875
Epoch: 5, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.386 Vali Acc: 0.275 Test Loss: 1.386 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5409977436065674
Epoch: 6, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.370 Vali Acc: 0.300 Test Loss: 1.370 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 0.4712364673614502
Epoch: 7, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.352 Vali Acc: 0.325 Test Loss: 1.352 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.46514439582824707
Epoch: 8, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.335 Vali Acc: 0.325 Test Loss: 1.335 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 9 cost time: 0.5748052597045898
Epoch: 9, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.317 Vali Acc: 0.325 Test Loss: 1.317 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 10 cost time: 0.514519453048706
Epoch: 10, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.299 Vali Acc: 0.350 Test Loss: 1.299 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 11 cost time: 0.6276054382324219
Epoch: 11, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.283 Vali Acc: 0.375 Test Loss: 1.283 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 12 cost time: 0.5867898464202881
Epoch: 12, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.268 Vali Acc: 0.450 Test Loss: 1.268 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 13 cost time: 0.5063204765319824
Epoch: 13, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.251 Vali Acc: 0.450 Test Loss: 1.251 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 14 cost time: 0.46126556396484375
Epoch: 14, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.237 Vali Acc: 0.450 Test Loss: 1.237 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 15 cost time: 0.5661365985870361
Epoch: 15, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.223 Vali Acc: 0.475 Test Loss: 1.223 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 16 cost time: 0.6556763648986816
Epoch: 16, Steps: 3 | Train Loss: 0.814 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 0.5916016101837158
Epoch: 17, Steps: 3 | Train Loss: 0.740 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 0.5961394309997559
Epoch: 18, Steps: 3 | Train Loss: 0.727 Vali Loss: 1.184 Vali Acc: 0.525 Test Loss: 1.184 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 19 cost time: 0.6377851963043213
Epoch: 19, Steps: 3 | Train Loss: 0.670 Vali Loss: 1.171 Vali Acc: 0.575 Test Loss: 1.171 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.5698111057281494
Epoch: 20, Steps: 3 | Train Loss: 0.627 Vali Loss: 1.159 Vali Acc: 0.575 Test Loss: 1.159 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.6017448902130127
Epoch: 21, Steps: 3 | Train Loss: 0.709 Vali Loss: 1.146 Vali Acc: 0.575 Test Loss: 1.146 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 22 cost time: 0.5632855892181396
Epoch: 22, Steps: 3 | Train Loss: 0.564 Vali Loss: 1.134 Vali Acc: 0.575 Test Loss: 1.134 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 23 cost time: 0.5913524627685547
Epoch: 23, Steps: 3 | Train Loss: 0.532 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 24 cost time: 0.5659692287445068
Epoch: 24, Steps: 3 | Train Loss: 0.581 Vali Loss: 1.106 Vali Acc: 0.650 Test Loss: 1.106 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 25 cost time: 0.5710210800170898
Epoch: 25, Steps: 3 | Train Loss: 0.470 Vali Loss: 1.097 Vali Acc: 0.650 Test Loss: 1.097 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 26 cost time: 0.5758910179138184
Epoch: 26, Steps: 3 | Train Loss: 0.432 Vali Loss: 1.085 Vali Acc: 0.650 Test Loss: 1.085 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 27 cost time: 0.6219167709350586
Epoch: 27, Steps: 3 | Train Loss: 0.395 Vali Loss: 1.073 Vali Acc: 0.650 Test Loss: 1.073 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 28 cost time: 0.5530116558074951
Epoch: 28, Steps: 3 | Train Loss: 0.389 Vali Loss: 1.068 Vali Acc: 0.650 Test Loss: 1.068 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 29 cost time: 0.5439491271972656
Epoch: 29, Steps: 3 | Train Loss: 0.336 Vali Loss: 1.061 Vali Acc: 0.650 Test Loss: 1.061 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 30 cost time: 0.5408556461334229
Epoch: 30, Steps: 3 | Train Loss: 0.304 Vali Loss: 1.055 Vali Acc: 0.650 Test Loss: 1.055 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 31 cost time: 0.6009538173675537
Epoch: 31, Steps: 3 | Train Loss: 0.285 Vali Loss: 1.052 Vali Acc: 0.650 Test Loss: 1.052 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 32 cost time: 0.6101377010345459
Epoch: 32, Steps: 3 | Train Loss: 0.251 Vali Loss: 1.043 Vali Acc: 0.675 Test Loss: 1.043 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 33 cost time: 0.60733962059021
Epoch: 33, Steps: 3 | Train Loss: 0.264 Vali Loss: 1.036 Vali Acc: 0.675 Test Loss: 1.036 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 34 cost time: 0.6047611236572266
Epoch: 34, Steps: 3 | Train Loss: 0.173 Vali Loss: 1.034 Vali Acc: 0.675 Test Loss: 1.034 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 35 cost time: 0.6084356307983398
Epoch: 35, Steps: 3 | Train Loss: 0.202 Vali Loss: 1.030 Vali Acc: 0.675 Test Loss: 1.030 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 36 cost time: 0.5829718112945557
Epoch: 36, Steps: 3 | Train Loss: 0.185 Vali Loss: 1.029 Vali Acc: 0.675 Test Loss: 1.029 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 37 cost time: 0.5432918071746826
Epoch: 37, Steps: 3 | Train Loss: 0.155 Vali Loss: 1.028 Vali Acc: 0.675 Test Loss: 1.028 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 38 cost time: 0.5828607082366943
Epoch: 38, Steps: 3 | Train Loss: 0.175 Vali Loss: 1.028 Vali Acc: 0.675 Test Loss: 1.028 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6179141998291016
Epoch: 39, Steps: 3 | Train Loss: 0.158 Vali Loss: 1.032 Vali Acc: 0.675 Test Loss: 1.032 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.566190242767334
Epoch: 40, Steps: 3 | Train Loss: 0.145 Vali Loss: 1.035 Vali Acc: 0.675 Test Loss: 1.035 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6936182975769043
Epoch: 41, Steps: 3 | Train Loss: 0.119 Vali Loss: 1.036 Vali Acc: 0.675 Test Loss: 1.036 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6013240814208984
Epoch: 42, Steps: 3 | Train Loss: 0.117 Vali Loss: 1.042 Vali Acc: 0.675 Test Loss: 1.042 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6841330528259277
Epoch: 43, Steps: 3 | Train Loss: 0.116 Vali Loss: 1.040 Vali Acc: 0.700 Test Loss: 1.040 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 44 cost time: 0.7305128574371338
Epoch: 44, Steps: 3 | Train Loss: 0.101 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6071438789367676
Epoch: 45, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.048 Vali Acc: 0.675 Test Loss: 1.048 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6426551342010498
Epoch: 46, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.048 Vali Acc: 0.675 Test Loss: 1.048 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6133453845977783
Epoch: 47, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.049 Vali Acc: 0.675 Test Loss: 1.049 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6458325386047363
Epoch: 48, Steps: 3 | Train Loss: 0.070 Vali Loss: 1.049 Vali Acc: 0.675 Test Loss: 1.049 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6403017044067383
Epoch: 49, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.048 Vali Acc: 0.675 Test Loss: 1.048 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5746266841888428
Epoch: 50, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5688860416412354
Epoch: 51, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.046 Vali Acc: 0.700 Test Loss: 1.046 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5795750617980957
Epoch: 52, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5731546878814697
Epoch: 53, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.043 Vali Acc: 0.700 Test Loss: 1.043 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 11156
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.039881706237793
Epoch: 1, Steps: 3 | Train Loss: 1.605 Vali Loss: 1.417 Vali Acc: 0.275 Test Loss: 1.417 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5159163475036621
Epoch: 2, Steps: 3 | Train Loss: 1.595 Vali Loss: 1.394 Vali Acc: 0.300 Test Loss: 1.394 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.540147066116333
Epoch: 3, Steps: 3 | Train Loss: 1.524 Vali Loss: 1.377 Vali Acc: 0.275 Test Loss: 1.377 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.521059513092041
Epoch: 4, Steps: 3 | Train Loss: 1.537 Vali Loss: 1.362 Vali Acc: 0.275 Test Loss: 1.362 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5467979907989502
Epoch: 5, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.348 Vali Acc: 0.275 Test Loss: 1.348 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5434408187866211
Epoch: 6, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.334 Vali Acc: 0.275 Test Loss: 1.334 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5302793979644775
Epoch: 7, Steps: 3 | Train Loss: 1.512 Vali Loss: 1.319 Vali Acc: 0.325 Test Loss: 1.319 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 8 cost time: 0.5934107303619385
Epoch: 8, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.306 Vali Acc: 0.325 Test Loss: 1.306 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 9 cost time: 0.5643892288208008
Epoch: 9, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.291 Vali Acc: 0.350 Test Loss: 1.291 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 10 cost time: 0.5521025657653809
Epoch: 10, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.277 Vali Acc: 0.375 Test Loss: 1.277 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 11 cost time: 0.5364193916320801
Epoch: 11, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.4870259761810303
Epoch: 12, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.251 Vali Acc: 0.450 Test Loss: 1.251 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 13 cost time: 0.5088632106781006
Epoch: 13, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.238 Vali Acc: 0.450 Test Loss: 1.238 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 14 cost time: 0.5791866779327393
Epoch: 14, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.225 Vali Acc: 0.450 Test Loss: 1.225 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 15 cost time: 0.4791383743286133
Epoch: 15, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 0.5531365871429443
Epoch: 16, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 0.5625264644622803
Epoch: 17, Steps: 3 | Train Loss: 1.024 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 0.48685359954833984
Epoch: 18, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.176 Vali Acc: 0.550 Test Loss: 1.176 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 19 cost time: 0.5201895236968994
Epoch: 19, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.164 Vali Acc: 0.575 Test Loss: 1.164 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.5068964958190918
Epoch: 20, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.153 Vali Acc: 0.575 Test Loss: 1.153 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.6026790142059326
Epoch: 21, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.141 Vali Acc: 0.600 Test Loss: 1.141 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.529425859451294
Epoch: 22, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.131 Vali Acc: 0.625 Test Loss: 1.131 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.5226218700408936
Epoch: 23, Steps: 3 | Train Loss: 0.830 Vali Loss: 1.122 Vali Acc: 0.675 Test Loss: 1.122 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 24 cost time: 0.5789470672607422
Epoch: 24, Steps: 3 | Train Loss: 0.821 Vali Loss: 1.114 Vali Acc: 0.650 Test Loss: 1.114 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5187761783599854
Epoch: 25, Steps: 3 | Train Loss: 0.722 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.5422604084014893
Epoch: 26, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.091 Vali Acc: 0.650 Test Loss: 1.091 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5100810527801514
Epoch: 27, Steps: 3 | Train Loss: 0.728 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5494685173034668
Epoch: 28, Steps: 3 | Train Loss: 0.631 Vali Loss: 1.067 Vali Acc: 0.650 Test Loss: 1.067 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5925137996673584
Epoch: 29, Steps: 3 | Train Loss: 0.609 Vali Loss: 1.055 Vali Acc: 0.650 Test Loss: 1.055 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5591421127319336
Epoch: 30, Steps: 3 | Train Loss: 0.490 Vali Loss: 1.046 Vali Acc: 0.650 Test Loss: 1.046 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5838158130645752
Epoch: 31, Steps: 3 | Train Loss: 0.617 Vali Loss: 1.038 Vali Acc: 0.650 Test Loss: 1.038 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.48928093910217285
Epoch: 32, Steps: 3 | Train Loss: 0.481 Vali Loss: 1.033 Vali Acc: 0.675 Test Loss: 1.033 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 33 cost time: 0.48229169845581055
Epoch: 33, Steps: 3 | Train Loss: 0.511 Vali Loss: 1.028 Vali Acc: 0.700 Test Loss: 1.028 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 34 cost time: 0.5521564483642578
Epoch: 34, Steps: 3 | Train Loss: 0.499 Vali Loss: 1.022 Vali Acc: 0.700 Test Loss: 1.022 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 35 cost time: 0.624150276184082
Epoch: 35, Steps: 3 | Train Loss: 0.491 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 36 cost time: 0.6512227058410645
Epoch: 36, Steps: 3 | Train Loss: 0.454 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 37 cost time: 0.48946714401245117
Epoch: 37, Steps: 3 | Train Loss: 0.385 Vali Loss: 1.006 Vali Acc: 0.700 Test Loss: 1.006 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 38 cost time: 0.5155410766601562
Epoch: 38, Steps: 3 | Train Loss: 0.387 Vali Loss: 1.001 Vali Acc: 0.675 Test Loss: 1.001 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5625829696655273
Epoch: 39, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.995 Vali Acc: 0.675 Test Loss: 0.995 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6262192726135254
Epoch: 40, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.990 Vali Acc: 0.675 Test Loss: 0.990 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5315260887145996
Epoch: 41, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.987 Vali Acc: 0.675 Test Loss: 0.987 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6290440559387207
Epoch: 42, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.985 Vali Acc: 0.650 Test Loss: 0.985 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.46245789527893066
Epoch: 43, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5097086429595947
Epoch: 44, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.977 Vali Acc: 0.675 Test Loss: 0.977 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5602567195892334
Epoch: 45, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.976 Vali Acc: 0.675 Test Loss: 0.976 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5648069381713867
Epoch: 46, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.977 Vali Acc: 0.675 Test Loss: 0.977 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.4891929626464844
Epoch: 47, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.977 Vali Acc: 0.675 Test Loss: 0.977 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 8164
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1275744438171387
Epoch: 1, Steps: 3 | Train Loss: 1.690 Vali Loss: 1.581 Vali Acc: 0.125 Test Loss: 1.581 Test Acc: 0.125
Validation loss decreased (inf --> -0.124984).  Saving model ...
Epoch: 2 cost time: 0.5442695617675781
Epoch: 2, Steps: 3 | Train Loss: 1.615 Vali Loss: 1.557 Vali Acc: 0.150 Test Loss: 1.557 Test Acc: 0.150
Validation loss decreased (-0.124984 --> -0.149984).  Saving model ...
Epoch: 3 cost time: 0.5726296901702881
Epoch: 3, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.540 Vali Acc: 0.175 Test Loss: 1.540 Test Acc: 0.175
Validation loss decreased (-0.149984 --> -0.174985).  Saving model ...
Epoch: 4 cost time: 0.5981400012969971
Epoch: 4, Steps: 3 | Train Loss: 1.636 Vali Loss: 1.525 Vali Acc: 0.200 Test Loss: 1.525 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 5 cost time: 0.5485432147979736
Epoch: 5, Steps: 3 | Train Loss: 1.548 Vali Loss: 1.509 Vali Acc: 0.200 Test Loss: 1.509 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 6 cost time: 0.5436751842498779
Epoch: 6, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.492 Vali Acc: 0.200 Test Loss: 1.492 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 7 cost time: 0.5316112041473389
Epoch: 7, Steps: 3 | Train Loss: 1.489 Vali Loss: 1.476 Vali Acc: 0.225 Test Loss: 1.476 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 8 cost time: 0.5410826206207275
Epoch: 8, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.460 Vali Acc: 0.200 Test Loss: 1.460 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5673468112945557
Epoch: 9, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.446 Vali Acc: 0.225 Test Loss: 1.446 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224986).  Saving model ...
Epoch: 10 cost time: 0.5813484191894531
Epoch: 10, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.431 Vali Acc: 0.225 Test Loss: 1.431 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 11 cost time: 0.5495965480804443
Epoch: 11, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.416 Vali Acc: 0.275 Test Loss: 1.416 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274986).  Saving model ...
Epoch: 12 cost time: 0.5379922389984131
Epoch: 12, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.400 Vali Acc: 0.275 Test Loss: 1.400 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 13 cost time: 0.5738799571990967
Epoch: 13, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.383 Vali Acc: 0.350 Test Loss: 1.383 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 14 cost time: 0.5865166187286377
Epoch: 14, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 15 cost time: 0.549457311630249
Epoch: 15, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.355 Vali Acc: 0.400 Test Loss: 1.355 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 16 cost time: 0.5955584049224854
Epoch: 16, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.339 Vali Acc: 0.400 Test Loss: 1.339 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 17 cost time: 0.5551285743713379
Epoch: 17, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 18 cost time: 0.5503065586090088
Epoch: 18, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 19 cost time: 0.4935336112976074
Epoch: 19, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.294 Vali Acc: 0.400 Test Loss: 1.294 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 20 cost time: 0.5173153877258301
Epoch: 20, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 21 cost time: 0.5846431255340576
Epoch: 21, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 22 cost time: 0.5438237190246582
Epoch: 22, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 23 cost time: 0.5569117069244385
Epoch: 23, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 24 cost time: 0.6028938293457031
Epoch: 24, Steps: 3 | Train Loss: 0.861 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 25 cost time: 0.5327472686767578
Epoch: 25, Steps: 3 | Train Loss: 0.863 Vali Loss: 1.212 Vali Acc: 0.450 Test Loss: 1.212 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449988).  Saving model ...
Epoch: 26 cost time: 0.5171661376953125
Epoch: 26, Steps: 3 | Train Loss: 0.817 Vali Loss: 1.198 Vali Acc: 0.450 Test Loss: 1.198 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 27 cost time: 0.4807858467102051
Epoch: 27, Steps: 3 | Train Loss: 0.803 Vali Loss: 1.185 Vali Acc: 0.475 Test Loss: 1.185 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 28 cost time: 0.64870285987854
Epoch: 28, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.174 Vali Acc: 0.475 Test Loss: 1.174 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 29 cost time: 0.5807878971099854
Epoch: 29, Steps: 3 | Train Loss: 0.735 Vali Loss: 1.163 Vali Acc: 0.475 Test Loss: 1.163 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 30 cost time: 0.6699526309967041
Epoch: 30, Steps: 3 | Train Loss: 0.697 Vali Loss: 1.153 Vali Acc: 0.475 Test Loss: 1.153 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 31 cost time: 0.6179842948913574
Epoch: 31, Steps: 3 | Train Loss: 0.663 Vali Loss: 1.142 Vali Acc: 0.475 Test Loss: 1.142 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474989).  Saving model ...
Epoch: 32 cost time: 0.5648870468139648
Epoch: 32, Steps: 3 | Train Loss: 0.633 Vali Loss: 1.134 Vali Acc: 0.475 Test Loss: 1.134 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 33 cost time: 0.5319509506225586
Epoch: 33, Steps: 3 | Train Loss: 0.622 Vali Loss: 1.123 Vali Acc: 0.525 Test Loss: 1.123 Test Acc: 0.525
Validation loss decreased (-0.474989 --> -0.524989).  Saving model ...
Epoch: 34 cost time: 0.6174561977386475
Epoch: 34, Steps: 3 | Train Loss: 0.596 Vali Loss: 1.114 Vali Acc: 0.550 Test Loss: 1.114 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 35 cost time: 0.6164803504943848
Epoch: 35, Steps: 3 | Train Loss: 0.541 Vali Loss: 1.102 Vali Acc: 0.550 Test Loss: 1.102 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 36 cost time: 0.4671595096588135
Epoch: 36, Steps: 3 | Train Loss: 0.498 Vali Loss: 1.094 Vali Acc: 0.575 Test Loss: 1.094 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 37 cost time: 0.5389361381530762
Epoch: 37, Steps: 3 | Train Loss: 0.442 Vali Loss: 1.087 Vali Acc: 0.575 Test Loss: 1.087 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 38 cost time: 0.5606720447540283
Epoch: 38, Steps: 3 | Train Loss: 0.495 Vali Loss: 1.080 Vali Acc: 0.575 Test Loss: 1.080 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 39 cost time: 0.5050070285797119
Epoch: 39, Steps: 3 | Train Loss: 0.449 Vali Loss: 1.076 Vali Acc: 0.600 Test Loss: 1.076 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 40 cost time: 0.4849221706390381
Epoch: 40, Steps: 3 | Train Loss: 0.389 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 41 cost time: 0.511648416519165
Epoch: 41, Steps: 3 | Train Loss: 0.383 Vali Loss: 1.067 Vali Acc: 0.625 Test Loss: 1.067 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 42 cost time: 0.4983551502227783
Epoch: 42, Steps: 3 | Train Loss: 0.380 Vali Loss: 1.064 Vali Acc: 0.625 Test Loss: 1.064 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 43 cost time: 0.51180100440979
Epoch: 43, Steps: 3 | Train Loss: 0.363 Vali Loss: 1.060 Vali Acc: 0.650 Test Loss: 1.060 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 44 cost time: 0.4735589027404785
Epoch: 44, Steps: 3 | Train Loss: 0.359 Vali Loss: 1.056 Vali Acc: 0.650 Test Loss: 1.056 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 45 cost time: 0.5737998485565186
Epoch: 45, Steps: 3 | Train Loss: 0.360 Vali Loss: 1.051 Vali Acc: 0.650 Test Loss: 1.051 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 46 cost time: 0.5262348651885986
Epoch: 46, Steps: 3 | Train Loss: 0.289 Vali Loss: 1.048 Vali Acc: 0.650 Test Loss: 1.048 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 47 cost time: 0.6191728115081787
Epoch: 47, Steps: 3 | Train Loss: 0.320 Vali Loss: 1.045 Vali Acc: 0.650 Test Loss: 1.045 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 48 cost time: 0.47672224044799805
Epoch: 48, Steps: 3 | Train Loss: 0.259 Vali Loss: 1.041 Vali Acc: 0.675 Test Loss: 1.041 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 49 cost time: 0.5137672424316406
Epoch: 49, Steps: 3 | Train Loss: 0.273 Vali Loss: 1.039 Vali Acc: 0.675 Test Loss: 1.039 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 50 cost time: 0.5600531101226807
Epoch: 50, Steps: 3 | Train Loss: 0.252 Vali Loss: 1.037 Vali Acc: 0.675 Test Loss: 1.037 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 51 cost time: 0.5417261123657227
Epoch: 51, Steps: 3 | Train Loss: 0.257 Vali Loss: 1.036 Vali Acc: 0.675 Test Loss: 1.036 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 52 cost time: 0.6597750186920166
Epoch: 52, Steps: 3 | Train Loss: 0.247 Vali Loss: 1.032 Vali Acc: 0.700 Test Loss: 1.032 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 53 cost time: 0.5588834285736084
Epoch: 53, Steps: 3 | Train Loss: 0.219 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 54 cost time: 0.6145601272583008
Epoch: 54, Steps: 3 | Train Loss: 0.180 Vali Loss: 1.024 Vali Acc: 0.700 Test Loss: 1.024 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 55 cost time: 0.48809385299682617
Epoch: 55, Steps: 3 | Train Loss: 0.229 Vali Loss: 1.020 Vali Acc: 0.700 Test Loss: 1.020 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 56 cost time: 0.5129227638244629
Epoch: 56, Steps: 3 | Train Loss: 0.184 Vali Loss: 1.016 Vali Acc: 0.700 Test Loss: 1.016 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 57 cost time: 0.554785966873169
Epoch: 57, Steps: 3 | Train Loss: 0.161 Vali Loss: 1.015 Vali Acc: 0.725 Test Loss: 1.015 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 58 cost time: 0.5592668056488037
Epoch: 58, Steps: 3 | Train Loss: 0.174 Vali Loss: 1.013 Vali Acc: 0.725 Test Loss: 1.013 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 59 cost time: 0.5131626129150391
Epoch: 59, Steps: 3 | Train Loss: 0.179 Vali Loss: 1.013 Vali Acc: 0.725 Test Loss: 1.013 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 60 cost time: 0.5499832630157471
Epoch: 60, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.011 Vali Acc: 0.725 Test Loss: 1.011 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 61 cost time: 0.5322444438934326
Epoch: 61, Steps: 3 | Train Loss: 0.147 Vali Loss: 1.010 Vali Acc: 0.725 Test Loss: 1.010 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 62 cost time: 0.5101666450500488
Epoch: 62, Steps: 3 | Train Loss: 0.139 Vali Loss: 1.007 Vali Acc: 0.725 Test Loss: 1.007 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 63 cost time: 0.5388631820678711
Epoch: 63, Steps: 3 | Train Loss: 0.151 Vali Loss: 1.004 Vali Acc: 0.725 Test Loss: 1.004 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 64 cost time: 0.5278124809265137
Epoch: 64, Steps: 3 | Train Loss: 0.122 Vali Loss: 1.002 Vali Acc: 0.725 Test Loss: 1.002 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 65 cost time: 0.596179723739624
Epoch: 65, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.999 Vali Acc: 0.725 Test Loss: 0.999 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 66 cost time: 0.5593123435974121
Epoch: 66, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.998 Vali Acc: 0.725 Test Loss: 0.998 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 67 cost time: 0.546478271484375
Epoch: 67, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.997 Vali Acc: 0.725 Test Loss: 0.997 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 68 cost time: 0.5399432182312012
Epoch: 68, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.5503480434417725
Epoch: 69, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.995 Vali Acc: 0.700 Test Loss: 0.995 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.602893590927124
Epoch: 70, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.995 Vali Acc: 0.700 Test Loss: 0.995 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.611487627029419
Epoch: 71, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.993 Vali Acc: 0.700 Test Loss: 0.993 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.5420522689819336
Epoch: 72, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.992 Vali Acc: 0.700 Test Loss: 0.992 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.5758178234100342
Epoch: 73, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.992 Vali Acc: 0.700 Test Loss: 0.992 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.5579233169555664
Epoch: 74, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.991 Vali Acc: 0.700 Test Loss: 0.991 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.588752269744873
Epoch: 75, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.990 Vali Acc: 0.700 Test Loss: 0.990 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.49712324142456055
Epoch: 76, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.989 Vali Acc: 0.700 Test Loss: 0.989 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.55954909324646
Epoch: 77, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.988 Vali Acc: 0.725 Test Loss: 0.988 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 78 cost time: 0.5264356136322021
Epoch: 78, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.989 Vali Acc: 0.725 Test Loss: 0.989 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.5806617736816406
Epoch: 79, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.990 Vali Acc: 0.725 Test Loss: 0.990 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.5589864253997803
Epoch: 80, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.992 Vali Acc: 0.700 Test Loss: 0.992 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.5598161220550537
Epoch: 81, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.992 Vali Acc: 0.700 Test Loss: 0.992 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.5714194774627686
Epoch: 82, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.6426165103912354
Epoch: 83, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.5478036403656006
Epoch: 84, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.5868968963623047
Epoch: 85, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.5132954120635986
Epoch: 86, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.6142079830169678
Epoch: 87, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.993 Vali Acc: 0.700 Test Loss: 0.993 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 7476
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0742359161376953
Epoch: 1, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.516 Vali Acc: 0.200 Test Loss: 1.516 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.6628067493438721
Epoch: 2, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.506 Vali Acc: 0.175 Test Loss: 1.506 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5697481632232666
Epoch: 3, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.503 Vali Acc: 0.175 Test Loss: 1.503 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4995760917663574
Epoch: 4, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.502 Vali Acc: 0.225 Test Loss: 1.502 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 5 cost time: 0.5038390159606934
Epoch: 5, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.501 Vali Acc: 0.225 Test Loss: 1.501 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224985).  Saving model ...
Epoch: 6 cost time: 0.5657081604003906
Epoch: 6, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.499 Vali Acc: 0.250 Test Loss: 1.499 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249985).  Saving model ...
Epoch: 7 cost time: 0.6684079170227051
Epoch: 7, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.497 Vali Acc: 0.275 Test Loss: 1.497 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 8 cost time: 0.5768544673919678
Epoch: 8, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.493 Vali Acc: 0.300 Test Loss: 1.493 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 9 cost time: 0.6978168487548828
Epoch: 9, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.487 Vali Acc: 0.300 Test Loss: 1.487 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 10 cost time: 0.5867869853973389
Epoch: 10, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.482 Vali Acc: 0.300 Test Loss: 1.482 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 11 cost time: 0.5934450626373291
Epoch: 11, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.477 Vali Acc: 0.300 Test Loss: 1.477 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 12 cost time: 0.5616893768310547
Epoch: 12, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.470 Vali Acc: 0.325 Test Loss: 1.470 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 13 cost time: 0.5489785671234131
Epoch: 13, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.464 Vali Acc: 0.350 Test Loss: 1.464 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 14 cost time: 0.5456845760345459
Epoch: 14, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.458 Vali Acc: 0.350 Test Loss: 1.458 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 15 cost time: 0.5643188953399658
Epoch: 15, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.453 Vali Acc: 0.350 Test Loss: 1.453 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 16 cost time: 0.5600194931030273
Epoch: 16, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.446 Vali Acc: 0.350 Test Loss: 1.446 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349986).  Saving model ...
Epoch: 17 cost time: 0.506476879119873
Epoch: 17, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.440 Vali Acc: 0.375 Test Loss: 1.440 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 18 cost time: 0.5150926113128662
Epoch: 18, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.434 Vali Acc: 0.375 Test Loss: 1.434 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 19 cost time: 0.586371898651123
Epoch: 19, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.427 Vali Acc: 0.375 Test Loss: 1.427 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 20 cost time: 0.5954866409301758
Epoch: 20, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.421 Vali Acc: 0.375 Test Loss: 1.421 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 21 cost time: 0.5625548362731934
Epoch: 21, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.416 Vali Acc: 0.400 Test Loss: 1.416 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 22 cost time: 0.528433084487915
Epoch: 22, Steps: 3 | Train Loss: 0.971 Vali Loss: 1.410 Vali Acc: 0.400 Test Loss: 1.410 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 23 cost time: 0.5734665393829346
Epoch: 23, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.405 Vali Acc: 0.400 Test Loss: 1.405 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 24 cost time: 0.5290725231170654
Epoch: 24, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.399 Vali Acc: 0.400 Test Loss: 1.399 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 25 cost time: 0.5371794700622559
Epoch: 25, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.394 Vali Acc: 0.400 Test Loss: 1.394 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 26 cost time: 0.5548152923583984
Epoch: 26, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.388 Vali Acc: 0.425 Test Loss: 1.388 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 27 cost time: 0.51216721534729
Epoch: 27, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.384 Vali Acc: 0.425 Test Loss: 1.384 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 28 cost time: 0.4963076114654541
Epoch: 28, Steps: 3 | Train Loss: 0.758 Vali Loss: 1.381 Vali Acc: 0.425 Test Loss: 1.381 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 29 cost time: 0.516218900680542
Epoch: 29, Steps: 3 | Train Loss: 0.724 Vali Loss: 1.375 Vali Acc: 0.425 Test Loss: 1.375 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 30 cost time: 0.5048401355743408
Epoch: 30, Steps: 3 | Train Loss: 0.672 Vali Loss: 1.369 Vali Acc: 0.425 Test Loss: 1.369 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 31 cost time: 0.5342376232147217
Epoch: 31, Steps: 3 | Train Loss: 0.737 Vali Loss: 1.364 Vali Acc: 0.400 Test Loss: 1.364 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5105857849121094
Epoch: 32, Steps: 3 | Train Loss: 0.753 Vali Loss: 1.359 Vali Acc: 0.400 Test Loss: 1.359 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5117850303649902
Epoch: 33, Steps: 3 | Train Loss: 0.667 Vali Loss: 1.352 Vali Acc: 0.400 Test Loss: 1.352 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.4723842144012451
Epoch: 34, Steps: 3 | Train Loss: 0.637 Vali Loss: 1.346 Vali Acc: 0.400 Test Loss: 1.346 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5289831161499023
Epoch: 35, Steps: 3 | Train Loss: 0.634 Vali Loss: 1.340 Vali Acc: 0.400 Test Loss: 1.340 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7164876461029053
Epoch: 36, Steps: 3 | Train Loss: 0.673 Vali Loss: 1.336 Vali Acc: 0.450 Test Loss: 1.336 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 37 cost time: 0.5273275375366211
Epoch: 37, Steps: 3 | Train Loss: 0.574 Vali Loss: 1.333 Vali Acc: 0.450 Test Loss: 1.333 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 38 cost time: 0.5393335819244385
Epoch: 38, Steps: 3 | Train Loss: 0.509 Vali Loss: 1.330 Vali Acc: 0.450 Test Loss: 1.330 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 39 cost time: 0.6237301826477051
Epoch: 39, Steps: 3 | Train Loss: 0.563 Vali Loss: 1.325 Vali Acc: 0.450 Test Loss: 1.325 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 40 cost time: 0.5054299831390381
Epoch: 40, Steps: 3 | Train Loss: 0.544 Vali Loss: 1.322 Vali Acc: 0.450 Test Loss: 1.322 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 41 cost time: 0.5499470233917236
Epoch: 41, Steps: 3 | Train Loss: 0.528 Vali Loss: 1.318 Vali Acc: 0.475 Test Loss: 1.318 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 42 cost time: 0.5940978527069092
Epoch: 42, Steps: 3 | Train Loss: 0.513 Vali Loss: 1.314 Vali Acc: 0.475 Test Loss: 1.314 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 43 cost time: 0.5967822074890137
Epoch: 43, Steps: 3 | Train Loss: 0.466 Vali Loss: 1.311 Vali Acc: 0.475 Test Loss: 1.311 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 44 cost time: 0.5102524757385254
Epoch: 44, Steps: 3 | Train Loss: 0.570 Vali Loss: 1.311 Vali Acc: 0.475 Test Loss: 1.311 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 45 cost time: 0.5835165977478027
Epoch: 45, Steps: 3 | Train Loss: 0.449 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 46 cost time: 0.5865428447723389
Epoch: 46, Steps: 3 | Train Loss: 0.457 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 47 cost time: 0.509711742401123
Epoch: 47, Steps: 3 | Train Loss: 0.424 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 48 cost time: 0.5960896015167236
Epoch: 48, Steps: 3 | Train Loss: 0.417 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4723207950592041
Epoch: 49, Steps: 3 | Train Loss: 0.383 Vali Loss: 1.307 Vali Acc: 0.525 Test Loss: 1.307 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 50 cost time: 0.5988762378692627
Epoch: 50, Steps: 3 | Train Loss: 0.383 Vali Loss: 1.307 Vali Acc: 0.525 Test Loss: 1.307 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 51 cost time: 0.5870375633239746
Epoch: 51, Steps: 3 | Train Loss: 0.368 Vali Loss: 1.305 Vali Acc: 0.525 Test Loss: 1.305 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 52 cost time: 0.5707685947418213
Epoch: 52, Steps: 3 | Train Loss: 0.424 Vali Loss: 1.303 Vali Acc: 0.525 Test Loss: 1.303 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 53 cost time: 0.6605606079101562
Epoch: 53, Steps: 3 | Train Loss: 0.352 Vali Loss: 1.301 Vali Acc: 0.525 Test Loss: 1.301 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 54 cost time: 0.5703713893890381
Epoch: 54, Steps: 3 | Train Loss: 0.304 Vali Loss: 1.300 Vali Acc: 0.525 Test Loss: 1.300 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 55 cost time: 0.520883321762085
Epoch: 55, Steps: 3 | Train Loss: 0.296 Vali Loss: 1.299 Vali Acc: 0.525 Test Loss: 1.299 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 56 cost time: 0.6086306571960449
Epoch: 56, Steps: 3 | Train Loss: 0.300 Vali Loss: 1.298 Vali Acc: 0.525 Test Loss: 1.298 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 57 cost time: 0.604079008102417
Epoch: 57, Steps: 3 | Train Loss: 0.360 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5177528858184814
Epoch: 58, Steps: 3 | Train Loss: 0.269 Vali Loss: 1.299 Vali Acc: 0.500 Test Loss: 1.299 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5804018974304199
Epoch: 59, Steps: 3 | Train Loss: 0.285 Vali Loss: 1.298 Vali Acc: 0.525 Test Loss: 1.298 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.6063296794891357
Epoch: 60, Steps: 3 | Train Loss: 0.306 Vali Loss: 1.299 Vali Acc: 0.525 Test Loss: 1.299 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.5877351760864258
Epoch: 61, Steps: 3 | Train Loss: 0.245 Vali Loss: 1.299 Vali Acc: 0.500 Test Loss: 1.299 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.5805168151855469
Epoch: 62, Steps: 3 | Train Loss: 0.268 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.5750596523284912
Epoch: 63, Steps: 3 | Train Loss: 0.262 Vali Loss: 1.300 Vali Acc: 0.500 Test Loss: 1.300 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.7309505939483643
Epoch: 64, Steps: 3 | Train Loss: 0.222 Vali Loss: 1.299 Vali Acc: 0.500 Test Loss: 1.299 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.5552747249603271
Epoch: 65, Steps: 3 | Train Loss: 0.228 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.5527899265289307
Epoch: 66, Steps: 3 | Train Loss: 0.199 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_PatchTST_UEA_ftM_sl100_ll0_pl0_el1_dm16_nh4_df64_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.525
model parameter : 6404
model size : 0.34MB
