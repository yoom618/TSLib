Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.937345266342163
Epoch: 1, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.746 Vali Acc: 0.243 Test Loss: 1.746 Test Acc: 0.243
Validation loss decreased (inf --> -0.243329).  Saving model ...
Epoch: 2 cost time: 1.67549467086792
Epoch: 2, Steps: 17 | Train Loss: 1.626 Vali Loss: 1.567 Vali Acc: 0.240 Test Loss: 1.567 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.169034481048584
Epoch: 3, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.678 Vali Acc: 0.251 Test Loss: 1.678 Test Acc: 0.251
Validation loss decreased (-0.243329 --> -0.250934).  Saving model ...
Epoch: 4 cost time: 1.4516983032226562
Epoch: 4, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.838 Vali Acc: 0.247 Test Loss: 1.838 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8731765747070312
Epoch: 5, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.841 Vali Acc: 0.240 Test Loss: 1.841 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6660535335540771
Epoch: 6, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.680 Vali Acc: 0.270 Test Loss: 1.680 Test Acc: 0.270
Validation loss decreased (-0.250934 --> -0.269945).  Saving model ...
Epoch: 7 cost time: 1.3815765380859375
Epoch: 7, Steps: 17 | Train Loss: 1.459 Vali Loss: 2.150 Vali Acc: 0.255 Test Loss: 2.150 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1927919387817383
Epoch: 8, Steps: 17 | Train Loss: 1.428 Vali Loss: 2.545 Vali Acc: 0.251 Test Loss: 2.545 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7008802890777588
Epoch: 9, Steps: 17 | Train Loss: 1.468 Vali Loss: 2.688 Vali Acc: 0.247 Test Loss: 2.688 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.53908109664917
Epoch: 10, Steps: 17 | Train Loss: 1.378 Vali Loss: 2.161 Vali Acc: 0.232 Test Loss: 2.161 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0067331790924072
Epoch: 11, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.796 Vali Acc: 0.259 Test Loss: 1.796 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4748616218566895
Epoch: 12, Steps: 17 | Train Loss: 1.045 Vali Loss: 2.167 Vali Acc: 0.251 Test Loss: 2.167 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7278220653533936
Epoch: 13, Steps: 17 | Train Loss: 1.119 Vali Loss: 2.170 Vali Acc: 0.236 Test Loss: 2.170 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6208436489105225
Epoch: 14, Steps: 17 | Train Loss: 1.107 Vali Loss: 2.249 Vali Acc: 0.251 Test Loss: 2.249 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5270898342132568
Epoch: 15, Steps: 17 | Train Loss: 1.001 Vali Loss: 2.663 Vali Acc: 0.255 Test Loss: 2.663 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3142662048339844
Epoch: 16, Steps: 17 | Train Loss: 1.074 Vali Loss: 2.394 Vali Acc: 0.243 Test Loss: 2.394 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 524676
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.323344469070435
Epoch: 1, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.485 Vali Acc: 0.243 Test Loss: 1.485 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 1.2750051021575928
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.500 Vali Acc: 0.247 Test Loss: 1.500 Test Acc: 0.247
Validation loss decreased (-0.243331 --> -0.247133).  Saving model ...
Epoch: 3 cost time: 1.8159961700439453
Epoch: 3, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.491 Vali Acc: 0.243 Test Loss: 1.491 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.202970027923584
Epoch: 4, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.698 Vali Acc: 0.240 Test Loss: 1.698 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.711535930633545
Epoch: 5, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.864 Vali Acc: 0.224 Test Loss: 1.864 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7452404499053955
Epoch: 6, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.490 Vali Acc: 0.247 Test Loss: 1.490 Test Acc: 0.247
Validation loss decreased (-0.247133 --> -0.247133).  Saving model ...
Epoch: 7 cost time: 1.4390530586242676
Epoch: 7, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.681 Vali Acc: 0.236 Test Loss: 1.681 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.040109872817993
Epoch: 8, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.655 Vali Acc: 0.255 Test Loss: 1.655 Test Acc: 0.255
Validation loss decreased (-0.247133 --> -0.254736).  Saving model ...
Epoch: 9 cost time: 1.1855242252349854
Epoch: 9, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.871 Vali Acc: 0.266 Test Loss: 1.871 Test Acc: 0.266
Validation loss decreased (-0.254736 --> -0.266141).  Saving model ...
Epoch: 10 cost time: 2.0124473571777344
Epoch: 10, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.880 Vali Acc: 0.259 Test Loss: 1.880 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.178696870803833
Epoch: 11, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.908 Vali Acc: 0.240 Test Loss: 1.908 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.528869867324829
Epoch: 12, Steps: 17 | Train Loss: 1.182 Vali Loss: 2.218 Vali Acc: 0.274 Test Loss: 2.218 Test Acc: 0.274
Validation loss decreased (-0.266141 --> -0.273742).  Saving model ...
Epoch: 13 cost time: 2.243358850479126
Epoch: 13, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.987 Vali Acc: 0.240 Test Loss: 1.987 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0911619663238525
Epoch: 14, Steps: 17 | Train Loss: 1.127 Vali Loss: 2.117 Vali Acc: 0.274 Test Loss: 2.117 Test Acc: 0.274
Validation loss decreased (-0.273742 --> -0.273743).  Saving model ...
Epoch: 15 cost time: 1.9272401332855225
Epoch: 15, Steps: 17 | Train Loss: 0.964 Vali Loss: 2.212 Vali Acc: 0.251 Test Loss: 2.212 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4494338035583496
Epoch: 16, Steps: 17 | Train Loss: 1.010 Vali Loss: 2.582 Vali Acc: 0.224 Test Loss: 2.582 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3851220607757568
Epoch: 17, Steps: 17 | Train Loss: 0.952 Vali Loss: 3.112 Vali Acc: 0.236 Test Loss: 3.112 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.396876335144043
Epoch: 18, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.976 Vali Acc: 0.240 Test Loss: 1.976 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2708969116210938
Epoch: 19, Steps: 17 | Train Loss: 0.875 Vali Loss: 2.195 Vali Acc: 0.262 Test Loss: 2.195 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.13740873336792
Epoch: 20, Steps: 17 | Train Loss: 0.926 Vali Loss: 2.589 Vali Acc: 0.232 Test Loss: 2.589 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0700314044952393
Epoch: 21, Steps: 17 | Train Loss: 0.966 Vali Loss: 2.359 Vali Acc: 0.251 Test Loss: 2.359 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0586371421813965
Epoch: 22, Steps: 17 | Train Loss: 0.882 Vali Loss: 2.402 Vali Acc: 0.240 Test Loss: 2.402 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9513890743255615
Epoch: 23, Steps: 17 | Train Loss: 0.758 Vali Loss: 2.413 Vali Acc: 0.243 Test Loss: 2.413 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.243070363998413
Epoch: 24, Steps: 17 | Train Loss: 0.784 Vali Loss: 2.375 Vali Acc: 0.285 Test Loss: 2.375 Test Acc: 0.285
Validation loss decreased (-0.273743 --> -0.285147).  Saving model ...
Epoch: 25 cost time: 2.159425735473633
Epoch: 25, Steps: 17 | Train Loss: 0.774 Vali Loss: 4.062 Vali Acc: 0.281 Test Loss: 4.062 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.234057903289795
Epoch: 26, Steps: 17 | Train Loss: 0.769 Vali Loss: 2.837 Vali Acc: 0.251 Test Loss: 2.837 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.25295352935791
Epoch: 27, Steps: 17 | Train Loss: 0.871 Vali Loss: 2.339 Vali Acc: 0.274 Test Loss: 2.339 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.5648105144500732
Epoch: 28, Steps: 17 | Train Loss: 0.968 Vali Loss: 3.008 Vali Acc: 0.205 Test Loss: 3.008 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.0287628173828125
Epoch: 29, Steps: 17 | Train Loss: 0.725 Vali Loss: 3.347 Vali Acc: 0.278 Test Loss: 3.347 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.1608169078826904
Epoch: 30, Steps: 17 | Train Loss: 0.573 Vali Loss: 2.706 Vali Acc: 0.266 Test Loss: 2.706 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.0741519927978516
Epoch: 31, Steps: 17 | Train Loss: 0.637 Vali Loss: 3.063 Vali Acc: 0.243 Test Loss: 3.063 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9883904457092285
Epoch: 32, Steps: 17 | Train Loss: 0.639 Vali Loss: 2.736 Vali Acc: 0.232 Test Loss: 2.736 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0461094379425049
Epoch: 33, Steps: 17 | Train Loss: 0.727 Vali Loss: 3.577 Vali Acc: 0.266 Test Loss: 3.577 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0512909889221191
Epoch: 34, Steps: 17 | Train Loss: 0.677 Vali Loss: 3.647 Vali Acc: 0.232 Test Loss: 3.647 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 468868
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7067549228668213
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.451 Vali Acc: 0.236 Test Loss: 1.451 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.1392571926116943
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.448 Vali Acc: 0.243 Test Loss: 1.448 Test Acc: 0.243
Validation loss decreased (-0.235727 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 1.216944932937622
Epoch: 3, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.657 Vali Acc: 0.262 Test Loss: 1.657 Test Acc: 0.262
Validation loss decreased (-0.243332 --> -0.262341).  Saving model ...
Epoch: 4 cost time: 1.330991506576538
Epoch: 4, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.480 Vali Acc: 0.243 Test Loss: 1.480 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5578289031982422
Epoch: 5, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.621 Vali Acc: 0.255 Test Loss: 1.621 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.722168207168579
Epoch: 6, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.490 Vali Acc: 0.255 Test Loss: 1.490 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.450679063796997
Epoch: 7, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.613 Vali Acc: 0.243 Test Loss: 1.613 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4016480445861816
Epoch: 8, Steps: 17 | Train Loss: 1.221 Vali Loss: 2.043 Vali Acc: 0.262 Test Loss: 2.043 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1234283447265625
Epoch: 9, Steps: 17 | Train Loss: 1.308 Vali Loss: 2.013 Vali Acc: 0.247 Test Loss: 2.013 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4207472801208496
Epoch: 10, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.803 Vali Acc: 0.251 Test Loss: 1.803 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1850249767303467
Epoch: 11, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.959 Vali Acc: 0.247 Test Loss: 1.959 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6621060371398926
Epoch: 12, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.978 Vali Acc: 0.274 Test Loss: 1.978 Test Acc: 0.274
Validation loss decreased (-0.262341 --> -0.273744).  Saving model ...
Epoch: 13 cost time: 1.6622145175933838
Epoch: 13, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.746 Vali Acc: 0.247 Test Loss: 1.746 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2809240818023682
Epoch: 14, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.750 Vali Acc: 0.259 Test Loss: 1.750 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.117410659790039
Epoch: 15, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.929 Vali Acc: 0.255 Test Loss: 1.929 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0665111541748047
Epoch: 16, Steps: 17 | Train Loss: 0.920 Vali Loss: 2.157 Vali Acc: 0.255 Test Loss: 2.157 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.880824089050293
Epoch: 17, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.951 Vali Acc: 0.213 Test Loss: 1.951 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.53224515914917
Epoch: 18, Steps: 17 | Train Loss: 0.927 Vali Loss: 2.021 Vali Acc: 0.232 Test Loss: 2.021 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.577751636505127
Epoch: 19, Steps: 17 | Train Loss: 0.882 Vali Loss: 2.644 Vali Acc: 0.262 Test Loss: 2.644 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4349939823150635
Epoch: 20, Steps: 17 | Train Loss: 0.876 Vali Loss: 2.376 Vali Acc: 0.270 Test Loss: 2.376 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2214040756225586
Epoch: 21, Steps: 17 | Train Loss: 0.900 Vali Loss: 2.356 Vali Acc: 0.247 Test Loss: 2.356 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9187517166137695
Epoch: 22, Steps: 17 | Train Loss: 0.837 Vali Loss: 2.764 Vali Acc: 0.236 Test Loss: 2.764 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 454532
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.732846736907959
Epoch: 1, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.420 Vali Acc: 0.236 Test Loss: 1.420 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 0.8587307929992676
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.437 Vali Acc: 0.262 Test Loss: 1.437 Test Acc: 0.262
Validation loss decreased (-0.235727 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 1.041039228439331
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.483 Vali Acc: 0.285 Test Loss: 1.483 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285156).  Saving model ...
Epoch: 4 cost time: 0.9690639972686768
Epoch: 4, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.900 Vali Acc: 0.247 Test Loss: 1.900 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0522468090057373
Epoch: 5, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.547 Vali Acc: 0.270 Test Loss: 1.547 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9617087841033936
Epoch: 6, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.565 Vali Acc: 0.247 Test Loss: 1.565 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1314754486083984
Epoch: 7, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.542 Vali Acc: 0.262 Test Loss: 1.542 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0097060203552246
Epoch: 8, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.587 Vali Acc: 0.255 Test Loss: 1.587 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0833778381347656
Epoch: 9, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.589 Vali Acc: 0.247 Test Loss: 1.589 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.071197271347046
Epoch: 10, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.770 Vali Acc: 0.274 Test Loss: 1.770 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0111348628997803
Epoch: 11, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.744 Vali Acc: 0.255 Test Loss: 1.744 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9738662242889404
Epoch: 12, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.842 Vali Acc: 0.243 Test Loss: 1.842 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9349007606506348
Epoch: 13, Steps: 17 | Train Loss: 1.118 Vali Loss: 2.128 Vali Acc: 0.232 Test Loss: 2.128 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 449412
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4030208587646484
Epoch: 1, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.413 Vali Acc: 0.259 Test Loss: 1.413 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.0154829025268555
Epoch: 2, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.421 Vali Acc: 0.281 Test Loss: 1.421 Test Acc: 0.281
Validation loss decreased (-0.258541 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 0.9851992130279541
Epoch: 3, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.487 Vali Acc: 0.240 Test Loss: 1.487 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9664928913116455
Epoch: 4, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.478 Vali Acc: 0.259 Test Loss: 1.478 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0125064849853516
Epoch: 5, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.608 Vali Acc: 0.255 Test Loss: 1.608 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9347050189971924
Epoch: 6, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.457 Vali Acc: 0.255 Test Loss: 1.457 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9474978446960449
Epoch: 7, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.637 Vali Acc: 0.262 Test Loss: 1.637 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0742769241333008
Epoch: 8, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.515 Vali Acc: 0.221 Test Loss: 1.515 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9640190601348877
Epoch: 9, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.611 Vali Acc: 0.262 Test Loss: 1.611 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1080665588378906
Epoch: 10, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.732 Vali Acc: 0.243 Test Loss: 1.732 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.166637659072876
Epoch: 11, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.633 Vali Acc: 0.278 Test Loss: 1.633 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0284035205841064
Epoch: 12, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.649 Vali Acc: 0.278 Test Loss: 1.649 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 451332
model size : 4.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7417759895324707
Epoch: 1, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.394 Vali Acc: 0.289 Test Loss: 1.394 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 1.088592767715454
Epoch: 2, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.471 Vali Acc: 0.247 Test Loss: 1.471 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.023406982421875
Epoch: 3, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.417 Vali Acc: 0.251 Test Loss: 1.417 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0297889709472656
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.463 Vali Acc: 0.259 Test Loss: 1.463 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0370230674743652
Epoch: 5, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.549 Vali Acc: 0.274 Test Loss: 1.549 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9575080871582031
Epoch: 6, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.499 Vali Acc: 0.289 Test Loss: 1.499 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.961371660232544
Epoch: 7, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.505 Vali Acc: 0.270 Test Loss: 1.505 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0379445552825928
Epoch: 8, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.672 Vali Acc: 0.247 Test Loss: 1.672 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.971454381942749
Epoch: 9, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.652 Vali Acc: 0.281 Test Loss: 1.652 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9554669857025146
Epoch: 10, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.702 Vali Acc: 0.259 Test Loss: 1.702 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0112805366516113
Epoch: 11, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.892 Vali Acc: 0.270 Test Loss: 1.892 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 456452
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.6761560440063477
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.437 Vali Acc: 0.243 Test Loss: 1.437 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.0572590827941895
Epoch: 2, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.439 Vali Acc: 0.251 Test Loss: 1.439 Test Acc: 0.251
Validation loss decreased (-0.243332 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 1.0898821353912354
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.521 Vali Acc: 0.243 Test Loss: 1.521 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1089260578155518
Epoch: 4, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.499 Vali Acc: 0.243 Test Loss: 1.499 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9810512065887451
Epoch: 5, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.463 Vali Acc: 0.251 Test Loss: 1.463 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1662373542785645
Epoch: 6, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.486 Vali Acc: 0.228 Test Loss: 1.486 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0720338821411133
Epoch: 7, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.523 Vali Acc: 0.247 Test Loss: 1.523 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0584735870361328
Epoch: 8, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.581 Vali Acc: 0.243 Test Loss: 1.581 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0693070888519287
Epoch: 9, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.573 Vali Acc: 0.274 Test Loss: 1.573 Test Acc: 0.274
Validation loss decreased (-0.250936 --> -0.273749).  Saving model ...
Epoch: 10 cost time: 1.103835105895996
Epoch: 10, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.617 Vali Acc: 0.251 Test Loss: 1.617 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1056556701660156
Epoch: 11, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.595 Vali Acc: 0.251 Test Loss: 1.595 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1035244464874268
Epoch: 12, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.894 Vali Acc: 0.270 Test Loss: 1.894 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0390315055847168
Epoch: 13, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.926 Vali Acc: 0.251 Test Loss: 1.926 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0175023078918457
Epoch: 14, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.963 Vali Acc: 0.278 Test Loss: 1.963 Test Acc: 0.278
Validation loss decreased (-0.273749 --> -0.277547).  Saving model ...
Epoch: 15 cost time: 1.1097607612609863
Epoch: 15, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.885 Vali Acc: 0.274 Test Loss: 1.885 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0199143886566162
Epoch: 16, Steps: 17 | Train Loss: 1.101 Vali Loss: 2.365 Vali Acc: 0.243 Test Loss: 2.365 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.010587453842163
Epoch: 17, Steps: 17 | Train Loss: 1.059 Vali Loss: 2.331 Vali Acc: 0.255 Test Loss: 2.331 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9687042236328125
Epoch: 18, Steps: 17 | Train Loss: 1.086 Vali Loss: 2.059 Vali Acc: 0.247 Test Loss: 2.059 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0270652770996094
Epoch: 19, Steps: 17 | Train Loss: 0.919 Vali Loss: 2.067 Vali Acc: 0.251 Test Loss: 2.067 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.058542013168335
Epoch: 20, Steps: 17 | Train Loss: 0.853 Vali Loss: 2.366 Vali Acc: 0.240 Test Loss: 2.366 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9955875873565674
Epoch: 21, Steps: 17 | Train Loss: 0.872 Vali Loss: 2.886 Vali Acc: 0.266 Test Loss: 2.886 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9855742454528809
Epoch: 22, Steps: 17 | Train Loss: 0.866 Vali Loss: 2.191 Vali Acc: 0.243 Test Loss: 2.191 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.080822229385376
Epoch: 23, Steps: 17 | Train Loss: 0.873 Vali Loss: 3.259 Vali Acc: 0.255 Test Loss: 3.259 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0130462646484375
Epoch: 24, Steps: 17 | Train Loss: 0.876 Vali Loss: 2.410 Vali Acc: 0.251 Test Loss: 2.410 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df256_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 464516
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.990176200866699
Epoch: 1, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.632 Vali Acc: 0.251 Test Loss: 1.632 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 2.3687634468078613
Epoch: 2, Steps: 17 | Train Loss: 1.579 Vali Loss: 1.713 Vali Acc: 0.289 Test Loss: 1.713 Test Acc: 0.289
Validation loss decreased (-0.250934 --> -0.288956).  Saving model ...
Epoch: 3 cost time: 2.382751703262329
Epoch: 3, Steps: 17 | Train Loss: 1.613 Vali Loss: 2.024 Vali Acc: 0.259 Test Loss: 2.024 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.187556505203247
Epoch: 4, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.644 Vali Acc: 0.278 Test Loss: 1.644 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.684011220932007
Epoch: 5, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.587 Vali Acc: 0.255 Test Loss: 1.587 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7935361862182617
Epoch: 6, Steps: 17 | Train Loss: 1.517 Vali Loss: 2.165 Vali Acc: 0.251 Test Loss: 2.165 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.558863639831543
Epoch: 7, Steps: 17 | Train Loss: 1.496 Vali Loss: 2.739 Vali Acc: 0.247 Test Loss: 2.739 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.459062099456787
Epoch: 8, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.599 Vali Acc: 0.262 Test Loss: 1.599 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4679267406463623
Epoch: 9, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.624 Vali Acc: 0.224 Test Loss: 1.624 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.007331371307373
Epoch: 10, Steps: 17 | Train Loss: 1.194 Vali Loss: 2.181 Vali Acc: 0.259 Test Loss: 2.181 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.751404047012329
Epoch: 11, Steps: 17 | Train Loss: 1.164 Vali Loss: 2.267 Vali Acc: 0.262 Test Loss: 2.267 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.9714412689208984
Epoch: 12, Steps: 17 | Train Loss: 1.378 Vali Loss: 3.317 Vali Acc: 0.247 Test Loss: 3.317 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 425988
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.235158443450928
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.467 Vali Acc: 0.255 Test Loss: 1.467 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 3.300889015197754
Epoch: 2, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.529 Vali Acc: 0.259 Test Loss: 1.529 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258540).  Saving model ...
Epoch: 3 cost time: 2.7390263080596924
Epoch: 3, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.503 Vali Acc: 0.259 Test Loss: 1.503 Test Acc: 0.259
Validation loss decreased (-0.258540 --> -0.258540).  Saving model ...
Epoch: 4 cost time: 3.438965320587158
Epoch: 4, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.505 Vali Acc: 0.255 Test Loss: 1.505 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2320010662078857
Epoch: 5, Steps: 17 | Train Loss: 1.379 Vali Loss: 2.042 Vali Acc: 0.259 Test Loss: 2.042 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.488507032394409
Epoch: 6, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.706 Vali Acc: 0.270 Test Loss: 1.706 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269945).  Saving model ...
Epoch: 7 cost time: 3.137960433959961
Epoch: 7, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.576 Vali Acc: 0.251 Test Loss: 1.576 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.081904649734497
Epoch: 8, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.604 Vali Acc: 0.274 Test Loss: 1.604 Test Acc: 0.274
Validation loss decreased (-0.269945 --> -0.273748).  Saving model ...
Epoch: 9 cost time: 2.8507626056671143
Epoch: 9, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.596 Vali Acc: 0.262 Test Loss: 1.596 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3027279376983643
Epoch: 10, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.868 Vali Acc: 0.255 Test Loss: 1.868 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.656338930130005
Epoch: 11, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.661 Vali Acc: 0.262 Test Loss: 1.661 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3060054779052734
Epoch: 12, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.691 Vali Acc: 0.274 Test Loss: 1.691 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.844799757003784
Epoch: 13, Steps: 17 | Train Loss: 1.117 Vali Loss: 2.135 Vali Acc: 0.262 Test Loss: 2.135 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.684824228286743
Epoch: 14, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.976 Vali Acc: 0.251 Test Loss: 1.976 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5004937648773193
Epoch: 15, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.839 Vali Acc: 0.236 Test Loss: 1.839 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.1484692096710205
Epoch: 16, Steps: 17 | Train Loss: 0.976 Vali Loss: 2.256 Vali Acc: 0.281 Test Loss: 2.256 Test Acc: 0.281
Validation loss decreased (-0.273748 --> -0.281346).  Saving model ...
Epoch: 17 cost time: 2.85731840133667
Epoch: 17, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.968 Vali Acc: 0.243 Test Loss: 1.968 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3859877586364746
Epoch: 18, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.927 Vali Acc: 0.259 Test Loss: 1.927 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.787391185760498
Epoch: 19, Steps: 17 | Train Loss: 1.017 Vali Loss: 2.000 Vali Acc: 0.278 Test Loss: 2.000 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.970503568649292
Epoch: 20, Steps: 17 | Train Loss: 0.876 Vali Loss: 2.346 Vali Acc: 0.240 Test Loss: 2.346 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1576972007751465
Epoch: 21, Steps: 17 | Train Loss: 0.878 Vali Loss: 2.514 Vali Acc: 0.274 Test Loss: 2.514 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.817965507507324
Epoch: 22, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.463 Vali Acc: 0.304 Test Loss: 2.463 Test Acc: 0.304
Validation loss decreased (-0.281346 --> -0.304158).  Saving model ...
Epoch: 23 cost time: 2.2939507961273193
Epoch: 23, Steps: 17 | Train Loss: 0.890 Vali Loss: 2.705 Vali Acc: 0.266 Test Loss: 2.705 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.06742262840271
Epoch: 24, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.363 Vali Acc: 0.278 Test Loss: 2.363 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.252523183822632
Epoch: 25, Steps: 17 | Train Loss: 0.790 Vali Loss: 3.271 Vali Acc: 0.251 Test Loss: 3.271 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.066319704055786
Epoch: 26, Steps: 17 | Train Loss: 0.757 Vali Loss: 2.455 Vali Acc: 0.251 Test Loss: 2.455 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.9350616931915283
Epoch: 27, Steps: 17 | Train Loss: 0.775 Vali Loss: 2.888 Vali Acc: 0.297 Test Loss: 2.888 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.7138073444366455
Epoch: 28, Steps: 17 | Train Loss: 0.666 Vali Loss: 2.634 Vali Acc: 0.266 Test Loss: 2.634 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.653423309326172
Epoch: 29, Steps: 17 | Train Loss: 0.719 Vali Loss: 2.802 Vali Acc: 0.255 Test Loss: 2.802 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.6001713275909424
Epoch: 30, Steps: 17 | Train Loss: 0.663 Vali Loss: 3.316 Vali Acc: 0.228 Test Loss: 3.316 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.4126036167144775
Epoch: 31, Steps: 17 | Train Loss: 0.745 Vali Loss: 3.340 Vali Acc: 0.274 Test Loss: 3.340 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.406176805496216
Epoch: 32, Steps: 17 | Train Loss: 0.708 Vali Loss: 2.828 Vali Acc: 0.243 Test Loss: 2.828 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 370180
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.5060505867004395
Epoch: 1, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.438 Vali Acc: 0.224 Test Loss: 1.438 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 2.8784496784210205
Epoch: 2, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.498 Vali Acc: 0.243 Test Loss: 1.498 Test Acc: 0.243
Validation loss decreased (-0.224320 --> -0.243331).  Saving model ...
Epoch: 3 cost time: 2.7009568214416504
Epoch: 3, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.444 Vali Acc: 0.232 Test Loss: 1.444 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5641143321990967
Epoch: 4, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.590 Vali Acc: 0.236 Test Loss: 1.590 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3478646278381348
Epoch: 5, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.651 Vali Acc: 0.285 Test Loss: 1.651 Test Acc: 0.285
Validation loss decreased (-0.243331 --> -0.285155).  Saving model ...
Epoch: 6 cost time: 2.113790273666382
Epoch: 6, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.739 Vali Acc: 0.289 Test Loss: 1.739 Test Acc: 0.289
Validation loss decreased (-0.285155 --> -0.288956).  Saving model ...
Epoch: 7 cost time: 1.8953239917755127
Epoch: 7, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.676 Vali Acc: 0.251 Test Loss: 1.676 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8555946350097656
Epoch: 8, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.757 Vali Acc: 0.278 Test Loss: 1.757 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.049537181854248
Epoch: 9, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.606 Vali Acc: 0.240 Test Loss: 1.606 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0695059299468994
Epoch: 10, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.637 Vali Acc: 0.209 Test Loss: 1.637 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6807162761688232
Epoch: 11, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.779 Vali Acc: 0.266 Test Loss: 1.779 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.6448299884796143
Epoch: 12, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.854 Vali Acc: 0.281 Test Loss: 1.854 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.8335680961608887
Epoch: 13, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.722 Vali Acc: 0.240 Test Loss: 1.722 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.71352219581604
Epoch: 14, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.812 Vali Acc: 0.251 Test Loss: 1.812 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.532625198364258
Epoch: 15, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.966 Vali Acc: 0.240 Test Loss: 1.966 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.312742233276367
Epoch: 16, Steps: 17 | Train Loss: 0.981 Vali Loss: 2.301 Vali Acc: 0.255 Test Loss: 2.301 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 355844
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6485660076141357
Epoch: 1, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.485 Vali Acc: 0.255 Test Loss: 1.485 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 1.6055750846862793
Epoch: 2, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.427 Vali Acc: 0.259 Test Loss: 1.427 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.7760043144226074
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.489 Vali Acc: 0.240 Test Loss: 1.489 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7903246879577637
Epoch: 4, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.445 Vali Acc: 0.251 Test Loss: 1.445 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7550387382507324
Epoch: 5, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.631 Vali Acc: 0.289 Test Loss: 1.631 Test Acc: 0.289
Validation loss decreased (-0.258541 --> -0.288957).  Saving model ...
Epoch: 6 cost time: 1.8173840045928955
Epoch: 6, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.544 Vali Acc: 0.255 Test Loss: 1.544 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5368454456329346
Epoch: 7, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.813 Vali Acc: 0.255 Test Loss: 1.813 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.74637770652771
Epoch: 8, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.527 Vali Acc: 0.247 Test Loss: 1.527 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6627182960510254
Epoch: 9, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.652 Vali Acc: 0.243 Test Loss: 1.652 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.350904941558838
Epoch: 10, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.856 Vali Acc: 0.266 Test Loss: 1.856 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7429239749908447
Epoch: 11, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.611 Vali Acc: 0.259 Test Loss: 1.611 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5976452827453613
Epoch: 12, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.646 Vali Acc: 0.251 Test Loss: 1.646 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0271823406219482
Epoch: 13, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.878 Vali Acc: 0.251 Test Loss: 1.878 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9488193988800049
Epoch: 14, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.799 Vali Acc: 0.247 Test Loss: 1.799 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.117321014404297
Epoch: 15, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.785 Vali Acc: 0.262 Test Loss: 1.785 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 350724
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5708603858947754
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.411 Vali Acc: 0.255 Test Loss: 1.411 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.8996376991271973
Epoch: 2, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.451 Vali Acc: 0.255 Test Loss: 1.451 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9317162036895752
Epoch: 3, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.451 Vali Acc: 0.251 Test Loss: 1.451 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8889920711517334
Epoch: 4, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.536 Vali Acc: 0.240 Test Loss: 1.536 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.007115364074707
Epoch: 5, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.552 Vali Acc: 0.243 Test Loss: 1.552 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.061846971511841
Epoch: 6, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.571 Vali Acc: 0.243 Test Loss: 1.571 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1074304580688477
Epoch: 7, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.710 Vali Acc: 0.255 Test Loss: 1.710 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9501779079437256
Epoch: 8, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.596 Vali Acc: 0.251 Test Loss: 1.596 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.066952705383301
Epoch: 9, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.618 Vali Acc: 0.243 Test Loss: 1.618 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6976871490478516
Epoch: 10, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.628 Vali Acc: 0.262 Test Loss: 1.628 Test Acc: 0.262
Validation loss decreased (-0.254739 --> -0.262341).  Saving model ...
Epoch: 11 cost time: 2.0039188861846924
Epoch: 11, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.868 Vali Acc: 0.243 Test Loss: 1.868 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.254179000854492
Epoch: 12, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.697 Vali Acc: 0.240 Test Loss: 1.697 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9308052062988281
Epoch: 13, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.637 Vali Acc: 0.259 Test Loss: 1.637 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7208786010742188
Epoch: 14, Steps: 17 | Train Loss: 1.071 Vali Loss: 2.187 Vali Acc: 0.262 Test Loss: 2.187 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6268718242645264
Epoch: 15, Steps: 17 | Train Loss: 1.151 Vali Loss: 2.321 Vali Acc: 0.274 Test Loss: 2.321 Test Acc: 0.274
Validation loss decreased (-0.262341 --> -0.273741).  Saving model ...
Epoch: 16 cost time: 1.890385389328003
Epoch: 16, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.773 Vali Acc: 0.266 Test Loss: 1.773 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9276046752929688
Epoch: 17, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.839 Vali Acc: 0.243 Test Loss: 1.839 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.792102336883545
Epoch: 18, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.938 Vali Acc: 0.243 Test Loss: 1.938 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7523548603057861
Epoch: 19, Steps: 17 | Train Loss: 0.985 Vali Loss: 2.040 Vali Acc: 0.240 Test Loss: 2.040 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9110496044158936
Epoch: 20, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.923 Vali Acc: 0.259 Test Loss: 1.923 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9754056930541992
Epoch: 21, Steps: 17 | Train Loss: 0.959 Vali Loss: 2.126 Vali Acc: 0.255 Test Loss: 2.126 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8368918895721436
Epoch: 22, Steps: 17 | Train Loss: 1.027 Vali Loss: 2.071 Vali Acc: 0.236 Test Loss: 2.071 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0623838901519775
Epoch: 23, Steps: 17 | Train Loss: 0.932 Vali Loss: 2.034 Vali Acc: 0.236 Test Loss: 2.034 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8392362594604492
Epoch: 24, Steps: 17 | Train Loss: 0.815 Vali Loss: 2.132 Vali Acc: 0.255 Test Loss: 2.132 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.817671298980713
Epoch: 25, Steps: 17 | Train Loss: 0.780 Vali Loss: 2.369 Vali Acc: 0.289 Test Loss: 2.369 Test Acc: 0.289
Validation loss decreased (-0.273741 --> -0.288950).  Saving model ...
Epoch: 26 cost time: 1.9393582344055176
Epoch: 26, Steps: 17 | Train Loss: 0.903 Vali Loss: 2.487 Vali Acc: 0.251 Test Loss: 2.487 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.860654354095459
Epoch: 27, Steps: 17 | Train Loss: 0.797 Vali Loss: 2.273 Vali Acc: 0.255 Test Loss: 2.273 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.912696361541748
Epoch: 28, Steps: 17 | Train Loss: 0.703 Vali Loss: 3.128 Vali Acc: 0.266 Test Loss: 3.128 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7112765312194824
Epoch: 29, Steps: 17 | Train Loss: 0.719 Vali Loss: 2.440 Vali Acc: 0.266 Test Loss: 2.440 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9090993404388428
Epoch: 30, Steps: 17 | Train Loss: 0.649 Vali Loss: 3.899 Vali Acc: 0.259 Test Loss: 3.899 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8572380542755127
Epoch: 31, Steps: 17 | Train Loss: 0.635 Vali Loss: 3.004 Vali Acc: 0.289 Test Loss: 3.004 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.8682270050048828
Epoch: 32, Steps: 17 | Train Loss: 0.670 Vali Loss: 3.157 Vali Acc: 0.278 Test Loss: 3.157 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8737475872039795
Epoch: 33, Steps: 17 | Train Loss: 0.722 Vali Loss: 2.746 Vali Acc: 0.262 Test Loss: 2.746 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8287162780761719
Epoch: 34, Steps: 17 | Train Loss: 0.781 Vali Loss: 2.804 Vali Acc: 0.293 Test Loss: 2.804 Test Acc: 0.293
Validation loss decreased (-0.288950 --> -0.292748).  Saving model ...
Epoch: 35 cost time: 1.7163095474243164
Epoch: 35, Steps: 17 | Train Loss: 0.603 Vali Loss: 2.909 Vali Acc: 0.270 Test Loss: 2.909 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8088369369506836
Epoch: 36, Steps: 17 | Train Loss: 0.545 Vali Loss: 4.960 Vali Acc: 0.251 Test Loss: 4.960 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8535356521606445
Epoch: 37, Steps: 17 | Train Loss: 0.620 Vali Loss: 3.008 Vali Acc: 0.289 Test Loss: 3.008 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.727055311203003
Epoch: 38, Steps: 17 | Train Loss: 0.578 Vali Loss: 2.980 Vali Acc: 0.278 Test Loss: 2.980 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.8620450496673584
Epoch: 39, Steps: 17 | Train Loss: 0.548 Vali Loss: 3.444 Vali Acc: 0.262 Test Loss: 3.444 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.8126790523529053
Epoch: 40, Steps: 17 | Train Loss: 0.523 Vali Loss: 3.763 Vali Acc: 0.281 Test Loss: 3.763 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.7150490283966064
Epoch: 41, Steps: 17 | Train Loss: 0.557 Vali Loss: 3.633 Vali Acc: 0.236 Test Loss: 3.633 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.7647969722747803
Epoch: 42, Steps: 17 | Train Loss: 0.467 Vali Loss: 3.537 Vali Acc: 0.278 Test Loss: 3.537 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.7850544452667236
Epoch: 43, Steps: 17 | Train Loss: 0.670 Vali Loss: 3.823 Vali Acc: 0.255 Test Loss: 3.823 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.683685541152954
Epoch: 44, Steps: 17 | Train Loss: 0.643 Vali Loss: 3.573 Vali Acc: 0.243 Test Loss: 3.573 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 352644
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5039713382720947
Epoch: 1, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.430 Vali Acc: 0.251 Test Loss: 1.430 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.8983855247497559
Epoch: 2, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.462 Vali Acc: 0.247 Test Loss: 1.462 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.841665267944336
Epoch: 3, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.454 Vali Acc: 0.228 Test Loss: 1.454 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8072338104248047
Epoch: 4, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.438 Vali Acc: 0.251 Test Loss: 1.438 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7385623455047607
Epoch: 5, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.463 Vali Acc: 0.251 Test Loss: 1.463 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.826014757156372
Epoch: 6, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.491 Vali Acc: 0.274 Test Loss: 1.491 Test Acc: 0.274
Validation loss decreased (-0.250936 --> -0.273749).  Saving model ...
Epoch: 7 cost time: 1.6844077110290527
Epoch: 7, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.670 Vali Acc: 0.270 Test Loss: 1.670 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8630363941192627
Epoch: 8, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.636 Vali Acc: 0.259 Test Loss: 1.636 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7823154926300049
Epoch: 9, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.653 Vali Acc: 0.240 Test Loss: 1.653 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7867913246154785
Epoch: 10, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.719 Vali Acc: 0.270 Test Loss: 1.719 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7754309177398682
Epoch: 11, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.719 Vali Acc: 0.255 Test Loss: 1.719 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.727569580078125
Epoch: 12, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.609 Vali Acc: 0.270 Test Loss: 1.609 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8650827407836914
Epoch: 13, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.657 Vali Acc: 0.232 Test Loss: 1.657 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9328770637512207
Epoch: 14, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.763 Vali Acc: 0.251 Test Loss: 1.763 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7489981651306152
Epoch: 15, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.789 Vali Acc: 0.270 Test Loss: 1.789 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8537466526031494
Epoch: 16, Steps: 17 | Train Loss: 1.001 Vali Loss: 2.041 Vali Acc: 0.304 Test Loss: 2.041 Test Acc: 0.304
Validation loss decreased (-0.273749 --> -0.304162).  Saving model ...
Epoch: 17 cost time: 1.7503864765167236
Epoch: 17, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.808 Vali Acc: 0.270 Test Loss: 1.808 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8768491744995117
Epoch: 18, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.962 Vali Acc: 0.281 Test Loss: 1.962 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9651594161987305
Epoch: 19, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.963 Vali Acc: 0.255 Test Loss: 1.963 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0707530975341797
Epoch: 20, Steps: 17 | Train Loss: 0.876 Vali Loss: 1.939 Vali Acc: 0.243 Test Loss: 1.939 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0301570892333984
Epoch: 21, Steps: 17 | Train Loss: 0.868 Vali Loss: 2.746 Vali Acc: 0.243 Test Loss: 2.746 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9902770519256592
Epoch: 22, Steps: 17 | Train Loss: 0.933 Vali Loss: 2.610 Vali Acc: 0.274 Test Loss: 2.610 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9234442710876465
Epoch: 23, Steps: 17 | Train Loss: 0.901 Vali Loss: 2.876 Vali Acc: 0.243 Test Loss: 2.876 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9495289325714111
Epoch: 24, Steps: 17 | Train Loss: 0.819 Vali Loss: 2.822 Vali Acc: 0.259 Test Loss: 2.822 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.884143590927124
Epoch: 25, Steps: 17 | Train Loss: 0.893 Vali Loss: 2.291 Vali Acc: 0.232 Test Loss: 2.291 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.036855936050415
Epoch: 26, Steps: 17 | Train Loss: 0.774 Vali Loss: 2.125 Vali Acc: 0.213 Test Loss: 2.125 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 357764
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.812620162963867
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.542 Vali Acc: 0.259 Test Loss: 1.542 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 1.7706544399261475
Epoch: 2, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.417 Vali Acc: 0.251 Test Loss: 1.417 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6753947734832764
Epoch: 3, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.435 Vali Acc: 0.262 Test Loss: 1.435 Test Acc: 0.262
Validation loss decreased (-0.258540 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.8972537517547607
Epoch: 4, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.431 Vali Acc: 0.270 Test Loss: 1.431 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 1.9037606716156006
Epoch: 5, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.498 Vali Acc: 0.281 Test Loss: 1.498 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281354).  Saving model ...
Epoch: 6 cost time: 1.881666660308838
Epoch: 6, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.473 Vali Acc: 0.266 Test Loss: 1.473 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.831678867340088
Epoch: 7, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.470 Vali Acc: 0.270 Test Loss: 1.470 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.745121955871582
Epoch: 8, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.514 Vali Acc: 0.251 Test Loss: 1.514 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8792059421539307
Epoch: 9, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.528 Vali Acc: 0.255 Test Loss: 1.528 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9797191619873047
Epoch: 10, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.684 Vali Acc: 0.255 Test Loss: 1.684 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8954644203186035
Epoch: 11, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.630 Vali Acc: 0.266 Test Loss: 1.630 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7163643836975098
Epoch: 12, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.855 Vali Acc: 0.255 Test Loss: 1.855 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6191902160644531
Epoch: 13, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.653 Vali Acc: 0.255 Test Loss: 1.653 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8272335529327393
Epoch: 14, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.839 Vali Acc: 0.251 Test Loss: 1.839 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8850734233856201
Epoch: 15, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.821 Vali Acc: 0.255 Test Loss: 1.821 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df128_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 365828
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.0136940479278564
Epoch: 1, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.563 Vali Acc: 0.266 Test Loss: 1.563 Test Acc: 0.266
Validation loss decreased (inf --> -0.266144).  Saving model ...
Epoch: 2 cost time: 3.990713357925415
Epoch: 2, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.588 Vali Acc: 0.240 Test Loss: 1.588 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7286276817321777
Epoch: 3, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.737 Vali Acc: 0.255 Test Loss: 1.737 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.253026723861694
Epoch: 4, Steps: 17 | Train Loss: 1.443 Vali Loss: 2.026 Vali Acc: 0.247 Test Loss: 2.026 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.126377105712891
Epoch: 5, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.631 Vali Acc: 0.232 Test Loss: 1.631 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.439996242523193
Epoch: 6, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.601 Vali Acc: 0.278 Test Loss: 1.601 Test Acc: 0.278
Validation loss decreased (-0.266144 --> -0.277551).  Saving model ...
Epoch: 7 cost time: 4.150747299194336
Epoch: 7, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.690 Vali Acc: 0.266 Test Loss: 1.690 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.0906171798706055
Epoch: 8, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.648 Vali Acc: 0.262 Test Loss: 1.648 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6685876846313477
Epoch: 9, Steps: 17 | Train Loss: 1.236 Vali Loss: 2.131 Vali Acc: 0.270 Test Loss: 2.131 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8392274379730225
Epoch: 10, Steps: 17 | Train Loss: 1.218 Vali Loss: 2.043 Vali Acc: 0.285 Test Loss: 2.043 Test Acc: 0.285
Validation loss decreased (-0.277551 --> -0.285151).  Saving model ...
Epoch: 11 cost time: 4.609560489654541
Epoch: 11, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.791 Vali Acc: 0.247 Test Loss: 1.791 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.299099683761597
Epoch: 12, Steps: 17 | Train Loss: 1.283 Vali Loss: 2.055 Vali Acc: 0.251 Test Loss: 2.055 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.18753457069397
Epoch: 13, Steps: 17 | Train Loss: 1.360 Vali Loss: 2.212 Vali Acc: 0.228 Test Loss: 2.212 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.805424213409424
Epoch: 14, Steps: 17 | Train Loss: 1.201 Vali Loss: 2.507 Vali Acc: 0.255 Test Loss: 2.507 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.810907602310181
Epoch: 15, Steps: 17 | Train Loss: 1.303 Vali Loss: 2.444 Vali Acc: 0.228 Test Loss: 2.444 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.766247987747192
Epoch: 16, Steps: 17 | Train Loss: 1.037 Vali Loss: 2.638 Vali Acc: 0.240 Test Loss: 2.638 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.305104970932007
Epoch: 17, Steps: 17 | Train Loss: 1.109 Vali Loss: 2.605 Vali Acc: 0.251 Test Loss: 2.605 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.64827561378479
Epoch: 18, Steps: 17 | Train Loss: 1.024 Vali Loss: 2.317 Vali Acc: 0.247 Test Loss: 2.317 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.966413259506226
Epoch: 19, Steps: 17 | Train Loss: 0.936 Vali Loss: 3.201 Vali Acc: 0.236 Test Loss: 3.201 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.690812110900879
Epoch: 20, Steps: 17 | Train Loss: 1.103 Vali Loss: 2.587 Vali Acc: 0.243 Test Loss: 2.587 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 376644
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.82767915725708
Epoch: 1, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.388 Vali Acc: 0.281 Test Loss: 1.388 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 4.278778553009033
Epoch: 2, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.412 Vali Acc: 0.266 Test Loss: 1.412 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.222976446151733
Epoch: 3, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.406 Vali Acc: 0.266 Test Loss: 1.406 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.809690237045288
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.928 Vali Acc: 0.251 Test Loss: 1.928 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.716686248779297
Epoch: 5, Steps: 17 | Train Loss: 1.487 Vali Loss: 2.169 Vali Acc: 0.236 Test Loss: 2.169 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.725299835205078
Epoch: 6, Steps: 17 | Train Loss: 1.550 Vali Loss: 2.109 Vali Acc: 0.255 Test Loss: 2.109 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.735641717910767
Epoch: 7, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.646 Vali Acc: 0.259 Test Loss: 1.646 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.9130332469940186
Epoch: 8, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.738 Vali Acc: 0.247 Test Loss: 1.738 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.612923860549927
Epoch: 9, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.626 Vali Acc: 0.270 Test Loss: 1.626 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.000416994094849
Epoch: 10, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.737 Vali Acc: 0.247 Test Loss: 1.737 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.2861573696136475
Epoch: 11, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.842 Vali Acc: 0.247 Test Loss: 1.842 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 320836
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.7311482429504395
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.432 Vali Acc: 0.251 Test Loss: 1.432 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 4.0327911376953125
Epoch: 2, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.432 Vali Acc: 0.266 Test Loss: 1.432 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 3.5587921142578125
Epoch: 3, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.453 Vali Acc: 0.259 Test Loss: 1.453 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.470258951187134
Epoch: 4, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.826 Vali Acc: 0.259 Test Loss: 1.826 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.07883358001709
Epoch: 5, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.527 Vali Acc: 0.274 Test Loss: 1.527 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273749).  Saving model ...
Epoch: 6 cost time: 3.6180787086486816
Epoch: 6, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.530 Vali Acc: 0.285 Test Loss: 1.530 Test Acc: 0.285
Validation loss decreased (-0.273749 --> -0.285156).  Saving model ...
Epoch: 7 cost time: 3.7536518573760986
Epoch: 7, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.569 Vali Acc: 0.236 Test Loss: 1.569 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.460880756378174
Epoch: 8, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.849 Vali Acc: 0.251 Test Loss: 1.849 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.936112880706787
Epoch: 9, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.681 Vali Acc: 0.236 Test Loss: 1.681 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7244174480438232
Epoch: 10, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.857 Vali Acc: 0.251 Test Loss: 1.857 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.877932548522949
Epoch: 11, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.585 Vali Acc: 0.243 Test Loss: 1.585 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.1492531299591064
Epoch: 12, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.650 Vali Acc: 0.266 Test Loss: 1.650 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.320173978805542
Epoch: 13, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.721 Vali Acc: 0.217 Test Loss: 1.721 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.5030670166015625
Epoch: 14, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.904 Vali Acc: 0.251 Test Loss: 1.904 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.230421781539917
Epoch: 15, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.786 Vali Acc: 0.255 Test Loss: 1.786 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.5013158321380615
Epoch: 16, Steps: 17 | Train Loss: 0.943 Vali Loss: 2.353 Vali Acc: 0.262 Test Loss: 2.353 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 306500
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.66837739944458
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.409 Vali Acc: 0.270 Test Loss: 1.409 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.620586633682251
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.506 Vali Acc: 0.259 Test Loss: 1.506 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8814985752105713
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.400 Vali Acc: 0.262 Test Loss: 1.400 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.906928539276123
Epoch: 4, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.453 Vali Acc: 0.240 Test Loss: 1.453 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.774641513824463
Epoch: 5, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.455 Vali Acc: 0.289 Test Loss: 1.455 Test Acc: 0.289
Validation loss decreased (-0.269948 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 1.9746451377868652
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.657 Vali Acc: 0.236 Test Loss: 1.657 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7941703796386719
Epoch: 7, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.492 Vali Acc: 0.255 Test Loss: 1.492 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8195784091949463
Epoch: 8, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.502 Vali Acc: 0.240 Test Loss: 1.502 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9344713687896729
Epoch: 9, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.559 Vali Acc: 0.221 Test Loss: 1.559 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.970508098602295
Epoch: 10, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.621 Vali Acc: 0.213 Test Loss: 1.621 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1353280544281006
Epoch: 11, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.882 Vali Acc: 0.259 Test Loss: 1.882 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7848689556121826
Epoch: 12, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.718 Vali Acc: 0.255 Test Loss: 1.718 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.801567792892456
Epoch: 13, Steps: 17 | Train Loss: 1.191 Vali Loss: 2.020 Vali Acc: 0.255 Test Loss: 2.020 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8030219078063965
Epoch: 14, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.646 Vali Acc: 0.251 Test Loss: 1.646 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.699894666671753
Epoch: 15, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.818 Vali Acc: 0.285 Test Loss: 1.818 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 301380
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7246153354644775
Epoch: 1, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.427 Vali Acc: 0.243 Test Loss: 1.427 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.721754550933838
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.480 Vali Acc: 0.247 Test Loss: 1.480 Test Acc: 0.247
Validation loss decreased (-0.243332 --> -0.247133).  Saving model ...
Epoch: 3 cost time: 1.7814748287200928
Epoch: 3, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.430 Vali Acc: 0.266 Test Loss: 1.430 Test Acc: 0.266
Validation loss decreased (-0.247133 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 1.6929881572723389
Epoch: 4, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.413 Vali Acc: 0.285 Test Loss: 1.413 Test Acc: 0.285
Validation loss decreased (-0.266145 --> -0.285157).  Saving model ...
Epoch: 5 cost time: 1.7381150722503662
Epoch: 5, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.482 Vali Acc: 0.278 Test Loss: 1.482 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8770577907562256
Epoch: 6, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.483 Vali Acc: 0.266 Test Loss: 1.483 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9766366481781006
Epoch: 7, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.494 Vali Acc: 0.266 Test Loss: 1.494 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6495556831359863
Epoch: 8, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.611 Vali Acc: 0.262 Test Loss: 1.611 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.114079713821411
Epoch: 9, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.639 Vali Acc: 0.266 Test Loss: 1.639 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9516429901123047
Epoch: 10, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.714 Vali Acc: 0.266 Test Loss: 1.714 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8555941581726074
Epoch: 11, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.496 Vali Acc: 0.293 Test Loss: 1.496 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292761).  Saving model ...
Epoch: 12 cost time: 2.012709856033325
Epoch: 12, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.787 Vali Acc: 0.278 Test Loss: 1.787 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.938830852508545
Epoch: 13, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.814 Vali Acc: 0.255 Test Loss: 1.814 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.004901170730591
Epoch: 14, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.635 Vali Acc: 0.281 Test Loss: 1.635 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.961651086807251
Epoch: 15, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.607 Vali Acc: 0.278 Test Loss: 1.607 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9107513427734375
Epoch: 16, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.818 Vali Acc: 0.266 Test Loss: 1.818 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0027456283569336
Epoch: 17, Steps: 17 | Train Loss: 1.006 Vali Loss: 2.013 Vali Acc: 0.270 Test Loss: 2.013 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9688255786895752
Epoch: 18, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.839 Vali Acc: 0.274 Test Loss: 1.839 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.996697187423706
Epoch: 19, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.796 Vali Acc: 0.228 Test Loss: 1.796 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9990711212158203
Epoch: 20, Steps: 17 | Train Loss: 0.897 Vali Loss: 1.987 Vali Acc: 0.251 Test Loss: 1.987 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9003798961639404
Epoch: 21, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.030 Vali Acc: 0.281 Test Loss: 2.030 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 303300
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.230935573577881
Epoch: 1, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.428 Vali Acc: 0.221 Test Loss: 1.428 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 2.0879435539245605
Epoch: 2, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.437 Vali Acc: 0.236 Test Loss: 1.437 Test Acc: 0.236
Validation loss decreased (-0.220518 --> -0.235727).  Saving model ...
Epoch: 3 cost time: 1.9083921909332275
Epoch: 3, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.532 Vali Acc: 0.274 Test Loss: 1.532 Test Acc: 0.274
Validation loss decreased (-0.235727 --> -0.273749).  Saving model ...
Epoch: 4 cost time: 1.9501402378082275
Epoch: 4, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.527 Vali Acc: 0.236 Test Loss: 1.527 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2393577098846436
Epoch: 5, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.498 Vali Acc: 0.285 Test Loss: 1.498 Test Acc: 0.285
Validation loss decreased (-0.273749 --> -0.285156).  Saving model ...
Epoch: 6 cost time: 1.9684395790100098
Epoch: 6, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.479 Vali Acc: 0.251 Test Loss: 1.479 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7470488548278809
Epoch: 7, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.541 Vali Acc: 0.240 Test Loss: 1.541 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.054131269454956
Epoch: 8, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.609 Vali Acc: 0.274 Test Loss: 1.609 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5104897022247314
Epoch: 9, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.549 Vali Acc: 0.247 Test Loss: 1.549 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0822880268096924
Epoch: 10, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.711 Vali Acc: 0.259 Test Loss: 1.711 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9131121635437012
Epoch: 11, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.700 Vali Acc: 0.251 Test Loss: 1.700 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9421703815460205
Epoch: 12, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.619 Vali Acc: 0.240 Test Loss: 1.619 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0730719566345215
Epoch: 13, Steps: 17 | Train Loss: 1.094 Vali Loss: 2.035 Vali Acc: 0.247 Test Loss: 2.035 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.051589012145996
Epoch: 14, Steps: 17 | Train Loss: 1.185 Vali Loss: 2.234 Vali Acc: 0.262 Test Loss: 2.234 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2591803073883057
Epoch: 15, Steps: 17 | Train Loss: 1.083 Vali Loss: 2.163 Vali Acc: 0.243 Test Loss: 2.163 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 308420
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.3044469356536865
Epoch: 1, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.443 Vali Acc: 0.213 Test Loss: 1.443 Test Acc: 0.213
Validation loss decreased (inf --> -0.212913).  Saving model ...
Epoch: 2 cost time: 2.13389253616333
Epoch: 2, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.457 Vali Acc: 0.262 Test Loss: 1.457 Test Acc: 0.262
Validation loss decreased (-0.212913 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 1.832155704498291
Epoch: 3, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.466 Vali Acc: 0.251 Test Loss: 1.466 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.686730146408081
Epoch: 4, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.513 Vali Acc: 0.274 Test Loss: 1.513 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273749).  Saving model ...
Epoch: 5 cost time: 2.0200881958007812
Epoch: 5, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.519 Vali Acc: 0.262 Test Loss: 1.519 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.069888114929199
Epoch: 6, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.454 Vali Acc: 0.243 Test Loss: 1.454 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2934091091156006
Epoch: 7, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.488 Vali Acc: 0.247 Test Loss: 1.488 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.037332534790039
Epoch: 8, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.525 Vali Acc: 0.247 Test Loss: 1.525 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7383291721343994
Epoch: 9, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.623 Vali Acc: 0.251 Test Loss: 1.623 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.936126708984375
Epoch: 10, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.627 Vali Acc: 0.228 Test Loss: 1.627 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.690274715423584
Epoch: 11, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.774 Vali Acc: 0.266 Test Loss: 1.774 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.544780969619751
Epoch: 12, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.782 Vali Acc: 0.243 Test Loss: 1.782 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7286243438720703
Epoch: 13, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.696 Vali Acc: 0.228 Test Loss: 1.696 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.853067398071289
Epoch: 14, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.682 Vali Acc: 0.228 Test Loss: 1.682 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm128_nh16_df64_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 316484
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.242546319961548
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.427 Vali Acc: 0.270 Test Loss: 1.427 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 4.525595664978027
Epoch: 2, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.583 Vali Acc: 0.274 Test Loss: 1.583 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273748).  Saving model ...
Epoch: 3 cost time: 4.678665399551392
Epoch: 3, Steps: 17 | Train Loss: 1.550 Vali Loss: 1.433 Vali Acc: 0.266 Test Loss: 1.433 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.605885028839111
Epoch: 4, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.470 Vali Acc: 0.274 Test Loss: 1.470 Test Acc: 0.274
Validation loss decreased (-0.273748 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 4.909569978713989
Epoch: 5, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.651 Vali Acc: 0.266 Test Loss: 1.651 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.477555513381958
Epoch: 6, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.674 Vali Acc: 0.247 Test Loss: 1.674 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.5547034740448
Epoch: 7, Steps: 17 | Train Loss: 1.558 Vali Loss: 2.151 Vali Acc: 0.270 Test Loss: 2.151 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.111691951751709
Epoch: 8, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.649 Vali Acc: 0.247 Test Loss: 1.649 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.058039426803589
Epoch: 9, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.578 Vali Acc: 0.217 Test Loss: 1.578 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.2394397258758545
Epoch: 10, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.686 Vali Acc: 0.255 Test Loss: 1.686 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.530208110809326
Epoch: 11, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.702 Vali Acc: 0.255 Test Loss: 1.702 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0881519317626953
Epoch: 12, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.796 Vali Acc: 0.251 Test Loss: 1.796 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.610800266265869
Epoch: 13, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.894 Vali Acc: 0.274 Test Loss: 1.894 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.998227119445801
Epoch: 14, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.907 Vali Acc: 0.236 Test Loss: 1.907 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 213572
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9227163791656494
Epoch: 1, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.402 Vali Acc: 0.255 Test Loss: 1.402 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.984243631362915
Epoch: 2, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.565 Vali Acc: 0.232 Test Loss: 1.565 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.946169376373291
Epoch: 3, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.444 Vali Acc: 0.240 Test Loss: 1.444 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8969643115997314
Epoch: 4, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.462 Vali Acc: 0.247 Test Loss: 1.462 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7261497974395752
Epoch: 5, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.724 Vali Acc: 0.247 Test Loss: 1.724 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9775230884552002
Epoch: 6, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.586 Vali Acc: 0.270 Test Loss: 1.586 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269946).  Saving model ...
Epoch: 7 cost time: 1.8621516227722168
Epoch: 7, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.575 Vali Acc: 0.262 Test Loss: 1.575 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.680802822113037
Epoch: 8, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.536 Vali Acc: 0.213 Test Loss: 1.536 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6265292167663574
Epoch: 9, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.752 Vali Acc: 0.247 Test Loss: 1.752 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5854263305664062
Epoch: 10, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.559 Vali Acc: 0.262 Test Loss: 1.559 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7883517742156982
Epoch: 11, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.751 Vali Acc: 0.236 Test Loss: 1.751 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7489826679229736
Epoch: 12, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.651 Vali Acc: 0.278 Test Loss: 1.651 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277550).  Saving model ...
Epoch: 13 cost time: 1.7673635482788086
Epoch: 13, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.744 Vali Acc: 0.236 Test Loss: 1.744 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8431780338287354
Epoch: 14, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.769 Vali Acc: 0.232 Test Loss: 1.769 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9757814407348633
Epoch: 15, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.710 Vali Acc: 0.228 Test Loss: 1.710 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.841238021850586
Epoch: 16, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.741 Vali Acc: 0.228 Test Loss: 1.741 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.039592742919922
Epoch: 17, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.722 Vali Acc: 0.251 Test Loss: 1.722 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9407551288604736
Epoch: 18, Steps: 17 | Train Loss: 0.980 Vali Loss: 2.114 Vali Acc: 0.278 Test Loss: 2.114 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1383323669433594
Epoch: 19, Steps: 17 | Train Loss: 1.169 Vali Loss: 2.126 Vali Acc: 0.247 Test Loss: 2.126 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0169918537139893
Epoch: 20, Steps: 17 | Train Loss: 0.913 Vali Loss: 2.166 Vali Acc: 0.243 Test Loss: 2.166 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0424082279205322
Epoch: 21, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.910 Vali Acc: 0.232 Test Loss: 1.910 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.949342966079712
Epoch: 22, Steps: 17 | Train Loss: 0.935 Vali Loss: 2.055 Vali Acc: 0.259 Test Loss: 2.055 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 185668
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6618001461029053
Epoch: 1, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.426 Vali Acc: 0.232 Test Loss: 1.426 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.819262981414795
Epoch: 2, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.417 Vali Acc: 0.240 Test Loss: 1.417 Test Acc: 0.240
Validation loss decreased (-0.231925 --> -0.239530).  Saving model ...
Epoch: 3 cost time: 1.9849228858947754
Epoch: 3, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8347575664520264
Epoch: 4, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.459 Vali Acc: 0.262 Test Loss: 1.459 Test Acc: 0.262
Validation loss decreased (-0.239530 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 2.0012283325195312
Epoch: 5, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.570 Vali Acc: 0.247 Test Loss: 1.570 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8046116828918457
Epoch: 6, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.630 Vali Acc: 0.262 Test Loss: 1.630 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.904134750366211
Epoch: 7, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.491 Vali Acc: 0.255 Test Loss: 1.491 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8597028255462646
Epoch: 8, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.619 Vali Acc: 0.228 Test Loss: 1.619 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.759101390838623
Epoch: 9, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.575 Vali Acc: 0.247 Test Loss: 1.575 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.839740514755249
Epoch: 10, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.774 Vali Acc: 0.217 Test Loss: 1.774 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.732283115386963
Epoch: 11, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.756 Vali Acc: 0.243 Test Loss: 1.756 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.720585823059082
Epoch: 12, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.641 Vali Acc: 0.266 Test Loss: 1.641 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266143).  Saving model ...
Epoch: 13 cost time: 1.738633155822754
Epoch: 13, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.765 Vali Acc: 0.274 Test Loss: 1.765 Test Acc: 0.274
Validation loss decreased (-0.266143 --> -0.273747).  Saving model ...
Epoch: 14 cost time: 1.8042051792144775
Epoch: 14, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.645 Vali Acc: 0.232 Test Loss: 1.645 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7593588829040527
Epoch: 15, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.679 Vali Acc: 0.266 Test Loss: 1.679 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9598748683929443
Epoch: 16, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.752 Vali Acc: 0.259 Test Loss: 1.752 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7383880615234375
Epoch: 17, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.751 Vali Acc: 0.270 Test Loss: 1.751 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9264872074127197
Epoch: 18, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.762 Vali Acc: 0.247 Test Loss: 1.762 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0050859451293945
Epoch: 19, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.732 Vali Acc: 0.259 Test Loss: 1.732 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8654961585998535
Epoch: 20, Steps: 17 | Train Loss: 0.930 Vali Loss: 1.814 Vali Acc: 0.259 Test Loss: 1.814 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8992421627044678
Epoch: 21, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.786 Vali Acc: 0.266 Test Loss: 1.786 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8982763290405273
Epoch: 22, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.820 Vali Acc: 0.266 Test Loss: 1.820 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9800777435302734
Epoch: 23, Steps: 17 | Train Loss: 0.861 Vali Loss: 1.934 Vali Acc: 0.262 Test Loss: 1.934 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 178500
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.488985776901245
Epoch: 1, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.421 Vali Acc: 0.240 Test Loss: 1.421 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.7172203063964844
Epoch: 2, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.411 Vali Acc: 0.251 Test Loss: 1.411 Test Acc: 0.251
Validation loss decreased (-0.239530 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 1.8981776237487793
Epoch: 3, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.438 Vali Acc: 0.243 Test Loss: 1.438 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8317012786865234
Epoch: 4, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.450 Vali Acc: 0.247 Test Loss: 1.450 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8641302585601807
Epoch: 5, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.469 Vali Acc: 0.236 Test Loss: 1.469 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.708359956741333
Epoch: 6, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.534 Vali Acc: 0.232 Test Loss: 1.534 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.940479040145874
Epoch: 7, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.436 Vali Acc: 0.278 Test Loss: 1.436 Test Acc: 0.278
Validation loss decreased (-0.250936 --> -0.277552).  Saving model ...
Epoch: 8 cost time: 1.8539009094238281
Epoch: 8, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.453 Vali Acc: 0.217 Test Loss: 1.453 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7458980083465576
Epoch: 9, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.618 Vali Acc: 0.251 Test Loss: 1.618 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6491150856018066
Epoch: 10, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.494 Vali Acc: 0.228 Test Loss: 1.494 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6842737197875977
Epoch: 11, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.529 Vali Acc: 0.232 Test Loss: 1.529 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.444415807723999
Epoch: 12, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.586 Vali Acc: 0.255 Test Loss: 1.586 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6244122982025146
Epoch: 13, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.554 Vali Acc: 0.232 Test Loss: 1.554 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7653744220733643
Epoch: 14, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.616 Vali Acc: 0.224 Test Loss: 1.616 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.82291841506958
Epoch: 15, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.622 Vali Acc: 0.259 Test Loss: 1.622 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8010871410369873
Epoch: 16, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.646 Vali Acc: 0.240 Test Loss: 1.646 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.828425407409668
Epoch: 17, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.819 Vali Acc: 0.221 Test Loss: 1.819 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 175940
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5319862365722656
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.406 Vali Acc: 0.278 Test Loss: 1.406 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 1.6345458030700684
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.382 Vali Acc: 0.281 Test Loss: 1.382 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 1.7309367656707764
Epoch: 3, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.399 Vali Acc: 0.259 Test Loss: 1.399 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.795698642730713
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.437 Vali Acc: 0.289 Test Loss: 1.437 Test Acc: 0.289
Validation loss decreased (-0.281355 --> -0.288959).  Saving model ...
Epoch: 5 cost time: 1.7825236320495605
Epoch: 5, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.395 Vali Acc: 0.274 Test Loss: 1.395 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.739518404006958
Epoch: 6, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.409 Vali Acc: 0.259 Test Loss: 1.409 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6828315258026123
Epoch: 7, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.461 Vali Acc: 0.240 Test Loss: 1.461 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9063584804534912
Epoch: 8, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.540 Vali Acc: 0.274 Test Loss: 1.540 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8384149074554443
Epoch: 9, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.465 Vali Acc: 0.293 Test Loss: 1.465 Test Acc: 0.293
Validation loss decreased (-0.288959 --> -0.292761).  Saving model ...
Epoch: 10 cost time: 1.8003273010253906
Epoch: 10, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.615 Vali Acc: 0.262 Test Loss: 1.615 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.802398681640625
Epoch: 11, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.679 Vali Acc: 0.251 Test Loss: 1.679 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7568144798278809
Epoch: 12, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.543 Vali Acc: 0.240 Test Loss: 1.543 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6777215003967285
Epoch: 13, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.605 Vali Acc: 0.240 Test Loss: 1.605 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.650848150253296
Epoch: 14, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.534 Vali Acc: 0.240 Test Loss: 1.534 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6985831260681152
Epoch: 15, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.674 Vali Acc: 0.262 Test Loss: 1.674 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9182345867156982
Epoch: 16, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.825 Vali Acc: 0.251 Test Loss: 1.825 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7458360195159912
Epoch: 17, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.698 Vali Acc: 0.232 Test Loss: 1.698 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0823709964752197
Epoch: 18, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.671 Vali Acc: 0.262 Test Loss: 1.671 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8124327659606934
Epoch: 19, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.732 Vali Acc: 0.251 Test Loss: 1.732 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 176900
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.654041051864624
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.411 Vali Acc: 0.262 Test Loss: 1.411 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.8075363636016846
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.402 Vali Acc: 0.278 Test Loss: 1.402 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277553).  Saving model ...
Epoch: 3 cost time: 2.044149398803711
Epoch: 3, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.409 Vali Acc: 0.266 Test Loss: 1.409 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0665383338928223
Epoch: 4, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.406 Vali Acc: 0.266 Test Loss: 1.406 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9246652126312256
Epoch: 5, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.414 Vali Acc: 0.278 Test Loss: 1.414 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9825308322906494
Epoch: 6, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.549 Vali Acc: 0.243 Test Loss: 1.549 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8267385959625244
Epoch: 7, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.522 Vali Acc: 0.259 Test Loss: 1.522 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.021616220474243
Epoch: 8, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.475 Vali Acc: 0.297 Test Loss: 1.475 Test Acc: 0.297
Validation loss decreased (-0.277553 --> -0.296563).  Saving model ...
Epoch: 9 cost time: 2.101344347000122
Epoch: 9, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.523 Vali Acc: 0.236 Test Loss: 1.523 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1007800102233887
Epoch: 10, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.722 Vali Acc: 0.281 Test Loss: 1.722 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4133293628692627
Epoch: 11, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.535 Vali Acc: 0.255 Test Loss: 1.535 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.446168899536133
Epoch: 12, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.582 Vali Acc: 0.243 Test Loss: 1.582 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2772974967956543
Epoch: 13, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.611 Vali Acc: 0.224 Test Loss: 1.611 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3153460025787354
Epoch: 14, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.683 Vali Acc: 0.255 Test Loss: 1.683 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3279199600219727
Epoch: 15, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.712 Vali Acc: 0.251 Test Loss: 1.712 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.362337112426758
Epoch: 16, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.676 Vali Acc: 0.217 Test Loss: 1.676 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0675809383392334
Epoch: 17, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.772 Vali Acc: 0.224 Test Loss: 1.772 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.037677049636841
Epoch: 18, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.718 Vali Acc: 0.236 Test Loss: 1.718 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 179460
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7904725074768066
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.408 Vali Acc: 0.243 Test Loss: 1.408 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 2.026751756668091
Epoch: 2, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.407 Vali Acc: 0.232 Test Loss: 1.407 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0004332065582275
Epoch: 3, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.399 Vali Acc: 0.243 Test Loss: 1.399 Test Acc: 0.243
Validation loss decreased (-0.243332 --> -0.243332).  Saving model ...
Epoch: 4 cost time: 1.9269840717315674
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.467 Vali Acc: 0.259 Test Loss: 1.467 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258540).  Saving model ...
Epoch: 5 cost time: 2.0659220218658447
Epoch: 5, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.460 Vali Acc: 0.278 Test Loss: 1.460 Test Acc: 0.278
Validation loss decreased (-0.258540 --> -0.277552).  Saving model ...
Epoch: 6 cost time: 2.058444023132324
Epoch: 6, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.469 Vali Acc: 0.262 Test Loss: 1.469 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0077803134918213
Epoch: 7, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.427 Vali Acc: 0.270 Test Loss: 1.427 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.053379774093628
Epoch: 8, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.596 Vali Acc: 0.259 Test Loss: 1.596 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.186145544052124
Epoch: 9, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.465 Vali Acc: 0.259 Test Loss: 1.465 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.185770273208618
Epoch: 10, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.512 Vali Acc: 0.236 Test Loss: 1.512 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.251713752746582
Epoch: 11, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.530 Vali Acc: 0.274 Test Loss: 1.530 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2976326942443848
Epoch: 12, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.561 Vali Acc: 0.243 Test Loss: 1.561 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0587170124053955
Epoch: 13, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.574 Vali Acc: 0.236 Test Loss: 1.574 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2518811225891113
Epoch: 14, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.826 Vali Acc: 0.278 Test Loss: 1.826 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9485068321228027
Epoch: 15, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.572 Vali Acc: 0.228 Test Loss: 1.572 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df256_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 183492
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.6627984046936035
Epoch: 1, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.443 Vali Acc: 0.251 Test Loss: 1.443 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 3.61344313621521
Epoch: 2, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.500 Vali Acc: 0.251 Test Loss: 1.500 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.095035076141357
Epoch: 3, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.445 Vali Acc: 0.270 Test Loss: 1.445 Test Acc: 0.270
Validation loss decreased (-0.250936 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 4.0741822719573975
Epoch: 4, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.635 Vali Acc: 0.247 Test Loss: 1.635 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.548356056213379
Epoch: 5, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.506 Vali Acc: 0.243 Test Loss: 1.506 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.156228303909302
Epoch: 6, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.570 Vali Acc: 0.266 Test Loss: 1.570 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.448734760284424
Epoch: 7, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.740 Vali Acc: 0.236 Test Loss: 1.740 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.567802906036377
Epoch: 8, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.563 Vali Acc: 0.221 Test Loss: 1.563 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.476015090942383
Epoch: 9, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.922 Vali Acc: 0.240 Test Loss: 1.922 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.728855609893799
Epoch: 10, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.814 Vali Acc: 0.232 Test Loss: 1.814 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.694465160369873
Epoch: 11, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.903 Vali Acc: 0.240 Test Loss: 1.903 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.617347478866577
Epoch: 12, Steps: 17 | Train Loss: 1.312 Vali Loss: 2.507 Vali Acc: 0.247 Test Loss: 2.507 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.6177496910095215
Epoch: 13, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.850 Vali Acc: 0.247 Test Loss: 1.850 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 164036
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.579153060913086
Epoch: 1, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.428 Vali Acc: 0.251 Test Loss: 1.428 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.9083895683288574
Epoch: 2, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.415 Vali Acc: 0.251 Test Loss: 1.415 Test Acc: 0.251
Validation loss decreased (-0.250936 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 1.8653087615966797
Epoch: 3, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.496 Vali Acc: 0.262 Test Loss: 1.496 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262342).  Saving model ...
Epoch: 4 cost time: 1.9949665069580078
Epoch: 4, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.490 Vali Acc: 0.247 Test Loss: 1.490 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6980786323547363
Epoch: 5, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.631 Vali Acc: 0.247 Test Loss: 1.631 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6830837726593018
Epoch: 6, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.687 Vali Acc: 0.255 Test Loss: 1.687 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8766162395477295
Epoch: 7, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.515 Vali Acc: 0.270 Test Loss: 1.515 Test Acc: 0.270
Validation loss decreased (-0.262342 --> -0.269947).  Saving model ...
Epoch: 8 cost time: 1.7422881126403809
Epoch: 8, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.547 Vali Acc: 0.293 Test Loss: 1.547 Test Acc: 0.293
Validation loss decreased (-0.269947 --> -0.292760).  Saving model ...
Epoch: 9 cost time: 2.1590750217437744
Epoch: 9, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.484 Vali Acc: 0.240 Test Loss: 1.484 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0390849113464355
Epoch: 10, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.656 Vali Acc: 0.259 Test Loss: 1.656 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8542606830596924
Epoch: 11, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.689 Vali Acc: 0.274 Test Loss: 1.689 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.122920036315918
Epoch: 12, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.683 Vali Acc: 0.255 Test Loss: 1.683 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.108414649963379
Epoch: 13, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.543 Vali Acc: 0.243 Test Loss: 1.543 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.014857530593872
Epoch: 14, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.556 Vali Acc: 0.262 Test Loss: 1.556 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.066411256790161
Epoch: 15, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.699 Vali Acc: 0.262 Test Loss: 1.699 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9469358921051025
Epoch: 16, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.870 Vali Acc: 0.247 Test Loss: 1.870 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1549487113952637
Epoch: 17, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.738 Vali Acc: 0.251 Test Loss: 1.738 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.235018014907837
Epoch: 18, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.871 Vali Acc: 0.266 Test Loss: 1.871 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 136132
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.906200647354126
Epoch: 1, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.424 Vali Acc: 0.262 Test Loss: 1.424 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.9158005714416504
Epoch: 2, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.424 Vali Acc: 0.251 Test Loss: 1.424 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1976845264434814
Epoch: 3, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.466 Vali Acc: 0.304 Test Loss: 1.466 Test Acc: 0.304
Validation loss decreased (-0.262343 --> -0.304168).  Saving model ...
Epoch: 4 cost time: 1.9121251106262207
Epoch: 4, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.395 Vali Acc: 0.281 Test Loss: 1.395 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.097285032272339
Epoch: 5, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.439 Vali Acc: 0.247 Test Loss: 1.439 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0201783180236816
Epoch: 6, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.408 Vali Acc: 0.278 Test Loss: 1.408 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0189032554626465
Epoch: 7, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.494 Vali Acc: 0.240 Test Loss: 1.494 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.206423282623291
Epoch: 8, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.590 Vali Acc: 0.270 Test Loss: 1.590 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8384544849395752
Epoch: 9, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.608 Vali Acc: 0.259 Test Loss: 1.608 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8313062191009521
Epoch: 10, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.485 Vali Acc: 0.281 Test Loss: 1.485 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6964125633239746
Epoch: 11, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.549 Vali Acc: 0.262 Test Loss: 1.549 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.836238145828247
Epoch: 12, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.555 Vali Acc: 0.236 Test Loss: 1.555 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7675213813781738
Epoch: 13, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.599 Vali Acc: 0.255 Test Loss: 1.599 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 128964
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.775162935256958
Epoch: 1, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.424 Vali Acc: 0.243 Test Loss: 1.424 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.9120700359344482
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.463 Vali Acc: 0.255 Test Loss: 1.463 Test Acc: 0.255
Validation loss decreased (-0.243332 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 1.9941399097442627
Epoch: 3, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.405 Vali Acc: 0.274 Test Loss: 1.405 Test Acc: 0.274
Validation loss decreased (-0.254738 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 2.1155917644500732
Epoch: 4, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.510 Vali Acc: 0.259 Test Loss: 1.510 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0712778568267822
Epoch: 5, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.482 Vali Acc: 0.259 Test Loss: 1.482 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9476640224456787
Epoch: 6, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.503 Vali Acc: 0.274 Test Loss: 1.503 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.020233631134033
Epoch: 7, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.503 Vali Acc: 0.259 Test Loss: 1.503 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9211838245391846
Epoch: 8, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.586 Vali Acc: 0.270 Test Loss: 1.586 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9631812572479248
Epoch: 9, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.462 Vali Acc: 0.300 Test Loss: 1.462 Test Acc: 0.300
Validation loss decreased (-0.273750 --> -0.300366).  Saving model ...
Epoch: 10 cost time: 1.9495658874511719
Epoch: 10, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.657 Vali Acc: 0.251 Test Loss: 1.657 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.036597728729248
Epoch: 11, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.555 Vali Acc: 0.247 Test Loss: 1.555 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.785202980041504
Epoch: 12, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.550 Vali Acc: 0.240 Test Loss: 1.550 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7704658508300781
Epoch: 13, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.622 Vali Acc: 0.255 Test Loss: 1.622 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0533933639526367
Epoch: 14, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.574 Vali Acc: 0.255 Test Loss: 1.574 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.816943645477295
Epoch: 15, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.591 Vali Acc: 0.255 Test Loss: 1.591 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8155410289764404
Epoch: 16, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.659 Vali Acc: 0.255 Test Loss: 1.659 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7127776145935059
Epoch: 17, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.779 Vali Acc: 0.243 Test Loss: 1.779 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.518453598022461
Epoch: 18, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.645 Vali Acc: 0.213 Test Loss: 1.645 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6142897605895996
Epoch: 19, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.762 Vali Acc: 0.255 Test Loss: 1.762 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 126404
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.611346960067749
Epoch: 1, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.406 Vali Acc: 0.247 Test Loss: 1.406 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.8202259540557861
Epoch: 2, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.400 Vali Acc: 0.266 Test Loss: 1.400 Test Acc: 0.266
Validation loss decreased (-0.247134 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 1.8392274379730225
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.392 Vali Acc: 0.278 Test Loss: 1.392 Test Acc: 0.278
Validation loss decreased (-0.266146 --> -0.277553).  Saving model ...
Epoch: 4 cost time: 1.894007682800293
Epoch: 4, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.477 Vali Acc: 0.262 Test Loss: 1.477 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8119549751281738
Epoch: 5, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.401 Vali Acc: 0.308 Test Loss: 1.401 Test Acc: 0.308
Validation loss decreased (-0.277553 --> -0.307971).  Saving model ...
Epoch: 6 cost time: 1.8100886344909668
Epoch: 6, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.487 Vali Acc: 0.236 Test Loss: 1.487 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7524299621582031
Epoch: 7, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.441 Vali Acc: 0.281 Test Loss: 1.441 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8440372943878174
Epoch: 8, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.466 Vali Acc: 0.243 Test Loss: 1.466 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8675310611724854
Epoch: 9, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.454 Vali Acc: 0.251 Test Loss: 1.454 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8118431568145752
Epoch: 10, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.589 Vali Acc: 0.247 Test Loss: 1.589 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8809256553649902
Epoch: 11, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.570 Vali Acc: 0.262 Test Loss: 1.570 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6683452129364014
Epoch: 12, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.672 Vali Acc: 0.274 Test Loss: 1.672 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8181273937225342
Epoch: 13, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.560 Vali Acc: 0.281 Test Loss: 1.560 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8677616119384766
Epoch: 14, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.489 Vali Acc: 0.278 Test Loss: 1.489 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8068573474884033
Epoch: 15, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.611 Vali Acc: 0.266 Test Loss: 1.611 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 127364
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7089459896087646
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.423 Vali Acc: 0.247 Test Loss: 1.423 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.454254150390625
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.399 Vali Acc: 0.247 Test Loss: 1.399 Test Acc: 0.247
Validation loss decreased (-0.247134 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.8556687831878662
Epoch: 3, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.406 Vali Acc: 0.240 Test Loss: 1.406 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7708513736724854
Epoch: 4, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.402 Vali Acc: 0.285 Test Loss: 1.402 Test Acc: 0.285
Validation loss decreased (-0.247134 --> -0.285157).  Saving model ...
Epoch: 5 cost time: 1.8593175411224365
Epoch: 5, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.411 Vali Acc: 0.285 Test Loss: 1.411 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8911232948303223
Epoch: 6, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.409 Vali Acc: 0.274 Test Loss: 1.409 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.996018886566162
Epoch: 7, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.480 Vali Acc: 0.266 Test Loss: 1.480 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8675203323364258
Epoch: 8, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.452 Vali Acc: 0.285 Test Loss: 1.452 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.880401372909546
Epoch: 9, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.558 Vali Acc: 0.285 Test Loss: 1.558 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.849975347518921
Epoch: 10, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.471 Vali Acc: 0.255 Test Loss: 1.471 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8858418464660645
Epoch: 11, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.559 Vali Acc: 0.266 Test Loss: 1.559 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8677172660827637
Epoch: 12, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.504 Vali Acc: 0.262 Test Loss: 1.504 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0163729190826416
Epoch: 13, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.544 Vali Acc: 0.262 Test Loss: 1.544 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7377357482910156
Epoch: 14, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.629 Vali Acc: 0.278 Test Loss: 1.629 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 129924
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.436673164367676
Epoch: 1, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.417 Vali Acc: 0.285 Test Loss: 1.417 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 1.762511968612671
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.440 Vali Acc: 0.255 Test Loss: 1.440 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8811390399932861
Epoch: 3, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.419 Vali Acc: 0.262 Test Loss: 1.419 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8439738750457764
Epoch: 4, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.409 Vali Acc: 0.236 Test Loss: 1.409 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9500627517700195
Epoch: 5, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.455 Vali Acc: 0.259 Test Loss: 1.455 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.802954912185669
Epoch: 6, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.449 Vali Acc: 0.247 Test Loss: 1.449 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.947077989578247
Epoch: 7, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.495 Vali Acc: 0.281 Test Loss: 1.495 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.025272846221924
Epoch: 8, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.542 Vali Acc: 0.270 Test Loss: 1.542 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.961911916732788
Epoch: 9, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.458 Vali Acc: 0.278 Test Loss: 1.458 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.98818039894104
Epoch: 10, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.523 Vali Acc: 0.274 Test Loss: 1.523 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8576829433441162
Epoch: 11, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.530 Vali Acc: 0.228 Test Loss: 1.530 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df128_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 133956
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.457941293716431
Epoch: 1, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.437 Vali Acc: 0.259 Test Loss: 1.437 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 4.390367031097412
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.411 Vali Acc: 0.259 Test Loss: 1.411 Test Acc: 0.259
Validation loss decreased (-0.258541 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 4.0860514640808105
Epoch: 3, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.679 Vali Acc: 0.251 Test Loss: 1.679 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.047583103179932
Epoch: 4, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.679 Vali Acc: 0.259 Test Loss: 1.679 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9783546924591064
Epoch: 5, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.713 Vali Acc: 0.270 Test Loss: 1.713 Test Acc: 0.270
Validation loss decreased (-0.258541 --> -0.269945).  Saving model ...
Epoch: 6 cost time: 4.177462816238403
Epoch: 6, Steps: 17 | Train Loss: 1.713 Vali Loss: 1.733 Vali Acc: 0.262 Test Loss: 1.733 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.1605284214019775
Epoch: 7, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.855 Vali Acc: 0.255 Test Loss: 1.855 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.006288051605225
Epoch: 8, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.962 Vali Acc: 0.281 Test Loss: 1.962 Test Acc: 0.281
Validation loss decreased (-0.269945 --> -0.281349).  Saving model ...
Epoch: 9 cost time: 4.3478522300720215
Epoch: 9, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.760 Vali Acc: 0.259 Test Loss: 1.760 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.400568962097168
Epoch: 10, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.853 Vali Acc: 0.262 Test Loss: 1.853 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.208885431289673
Epoch: 11, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.637 Vali Acc: 0.262 Test Loss: 1.637 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.1087493896484375
Epoch: 12, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.907 Vali Acc: 0.262 Test Loss: 1.907 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.2269415855407715
Epoch: 13, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.767 Vali Acc: 0.319 Test Loss: 1.767 Test Acc: 0.319
Validation loss decreased (-0.281349 --> -0.319374).  Saving model ...
Epoch: 14 cost time: 4.478158950805664
Epoch: 14, Steps: 17 | Train Loss: 1.059 Vali Loss: 2.000 Vali Acc: 0.255 Test Loss: 2.000 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.438074350357056
Epoch: 15, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.661 Vali Acc: 0.278 Test Loss: 1.661 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.139055252075195
Epoch: 16, Steps: 17 | Train Loss: 1.056 Vali Loss: 2.048 Vali Acc: 0.278 Test Loss: 2.048 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.856985330581665
Epoch: 17, Steps: 17 | Train Loss: 1.122 Vali Loss: 2.156 Vali Acc: 0.251 Test Loss: 2.156 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.967329502105713
Epoch: 18, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.860 Vali Acc: 0.240 Test Loss: 1.860 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.8039932250976562
Epoch: 19, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.865 Vali Acc: 0.247 Test Loss: 1.865 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.6252853870391846
Epoch: 20, Steps: 17 | Train Loss: 1.192 Vali Loss: 2.567 Vali Acc: 0.259 Test Loss: 2.567 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.8745291233062744
Epoch: 21, Steps: 17 | Train Loss: 0.941 Vali Loss: 2.076 Vali Acc: 0.266 Test Loss: 2.076 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.814802169799805
Epoch: 22, Steps: 17 | Train Loss: 0.915 Vali Loss: 2.704 Vali Acc: 0.240 Test Loss: 2.704 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.265639066696167
Epoch: 23, Steps: 17 | Train Loss: 0.949 Vali Loss: 2.549 Vali Acc: 0.255 Test Loss: 2.549 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 139268
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4450066089630127
Epoch: 1, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.421 Vali Acc: 0.247 Test Loss: 1.421 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.4964570999145508
Epoch: 2, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.407 Vali Acc: 0.278 Test Loss: 1.407 Test Acc: 0.278
Validation loss decreased (-0.247134 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 1.7637035846710205
Epoch: 3, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.424 Vali Acc: 0.274 Test Loss: 1.424 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.547715663909912
Epoch: 4, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.454 Vali Acc: 0.255 Test Loss: 1.454 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8425781726837158
Epoch: 5, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.583 Vali Acc: 0.270 Test Loss: 1.583 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.901090383529663
Epoch: 6, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.459 Vali Acc: 0.255 Test Loss: 1.459 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9988343715667725
Epoch: 7, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.438 Vali Acc: 0.281 Test Loss: 1.438 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281354).  Saving model ...
Epoch: 8 cost time: 1.7426633834838867
Epoch: 8, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.603 Vali Acc: 0.278 Test Loss: 1.603 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.017843723297119
Epoch: 9, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.512 Vali Acc: 0.285 Test Loss: 1.512 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285156).  Saving model ...
Epoch: 10 cost time: 1.7981009483337402
Epoch: 10, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.524 Vali Acc: 0.251 Test Loss: 1.524 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9185857772827148
Epoch: 11, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.516 Vali Acc: 0.247 Test Loss: 1.516 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7787017822265625
Epoch: 12, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.515 Vali Acc: 0.270 Test Loss: 1.515 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8927850723266602
Epoch: 13, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.702 Vali Acc: 0.243 Test Loss: 1.702 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5995221138000488
Epoch: 14, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.580 Vali Acc: 0.240 Test Loss: 1.580 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.060756206512451
Epoch: 15, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.621 Vali Acc: 0.236 Test Loss: 1.621 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.816436529159546
Epoch: 16, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.929 Vali Acc: 0.232 Test Loss: 1.929 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9698243141174316
Epoch: 17, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.873 Vali Acc: 0.243 Test Loss: 1.873 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8196911811828613
Epoch: 18, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.994 Vali Acc: 0.274 Test Loss: 1.994 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9442040920257568
Epoch: 19, Steps: 17 | Train Loss: 1.008 Vali Loss: 2.641 Vali Acc: 0.266 Test Loss: 2.641 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 111364
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.629516124725342
Epoch: 1, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.437 Vali Acc: 0.262 Test Loss: 1.437 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.6487040519714355
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.490 Vali Acc: 0.243 Test Loss: 1.490 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.516700029373169
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.444 Vali Acc: 0.247 Test Loss: 1.444 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.389772891998291
Epoch: 4, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.511 Vali Acc: 0.274 Test Loss: 1.511 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273749).  Saving model ...
Epoch: 5 cost time: 1.5002281665802002
Epoch: 5, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.480 Vali Acc: 0.247 Test Loss: 1.480 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4444327354431152
Epoch: 6, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.525 Vali Acc: 0.247 Test Loss: 1.525 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6237256526947021
Epoch: 7, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.459 Vali Acc: 0.270 Test Loss: 1.459 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7973136901855469
Epoch: 8, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.488 Vali Acc: 0.240 Test Loss: 1.488 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8927366733551025
Epoch: 9, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.515 Vali Acc: 0.293 Test Loss: 1.515 Test Acc: 0.293
Validation loss decreased (-0.273749 --> -0.292761).  Saving model ...
Epoch: 10 cost time: 1.7786602973937988
Epoch: 10, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.523 Vali Acc: 0.259 Test Loss: 1.523 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7963109016418457
Epoch: 11, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.543 Vali Acc: 0.262 Test Loss: 1.543 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8614850044250488
Epoch: 12, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.537 Vali Acc: 0.293 Test Loss: 1.537 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.798252820968628
Epoch: 13, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.634 Vali Acc: 0.259 Test Loss: 1.634 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.772273302078247
Epoch: 14, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.693 Vali Acc: 0.281 Test Loss: 1.693 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8928797245025635
Epoch: 15, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.683 Vali Acc: 0.262 Test Loss: 1.683 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.855027437210083
Epoch: 16, Steps: 17 | Train Loss: 1.091 Vali Loss: 2.066 Vali Acc: 0.255 Test Loss: 2.066 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6918551921844482
Epoch: 17, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.900 Vali Acc: 0.251 Test Loss: 1.900 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.680849313735962
Epoch: 18, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.695 Vali Acc: 0.270 Test Loss: 1.695 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8208189010620117
Epoch: 19, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.807 Vali Acc: 0.266 Test Loss: 1.807 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 104196
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.722229480743408
Epoch: 1, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.411 Vali Acc: 0.247 Test Loss: 1.411 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.7076163291931152
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.412 Vali Acc: 0.228 Test Loss: 1.412 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6672992706298828
Epoch: 3, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.438 Vali Acc: 0.240 Test Loss: 1.438 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.684774398803711
Epoch: 4, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.433 Vali Acc: 0.232 Test Loss: 1.433 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7590255737304688
Epoch: 5, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.487 Vali Acc: 0.221 Test Loss: 1.487 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.87253737449646
Epoch: 6, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.429 Vali Acc: 0.240 Test Loss: 1.429 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9236924648284912
Epoch: 7, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.566 Vali Acc: 0.259 Test Loss: 1.566 Test Acc: 0.259
Validation loss decreased (-0.247134 --> -0.258539).  Saving model ...
Epoch: 8 cost time: 2.048978805541992
Epoch: 8, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.454 Vali Acc: 0.221 Test Loss: 1.454 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.08060622215271
Epoch: 9, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.474 Vali Acc: 0.289 Test Loss: 1.474 Test Acc: 0.289
Validation loss decreased (-0.258539 --> -0.288959).  Saving model ...
Epoch: 10 cost time: 1.790947675704956
Epoch: 10, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.452 Vali Acc: 0.255 Test Loss: 1.452 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.974735975265503
Epoch: 11, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.502 Vali Acc: 0.232 Test Loss: 1.502 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8942458629608154
Epoch: 12, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.523 Vali Acc: 0.259 Test Loss: 1.523 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8878607749938965
Epoch: 13, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.521 Vali Acc: 0.213 Test Loss: 1.521 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.734344482421875
Epoch: 14, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.856 Vali Acc: 0.262 Test Loss: 1.856 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6349172592163086
Epoch: 15, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.706 Vali Acc: 0.262 Test Loss: 1.706 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7888250350952148
Epoch: 16, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.593 Vali Acc: 0.266 Test Loss: 1.593 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8041152954101562
Epoch: 17, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.608 Vali Acc: 0.217 Test Loss: 1.608 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.021026372909546
Epoch: 18, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.578 Vali Acc: 0.224 Test Loss: 1.578 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.72576904296875
Epoch: 19, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.658 Vali Acc: 0.228 Test Loss: 1.658 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 101636
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4546139240264893
Epoch: 1, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.428 Vali Acc: 0.236 Test Loss: 1.428 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.702131748199463
Epoch: 2, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.422 Vali Acc: 0.217 Test Loss: 1.422 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6358942985534668
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.419 Vali Acc: 0.240 Test Loss: 1.419 Test Acc: 0.240
Validation loss decreased (-0.235727 --> -0.239530).  Saving model ...
Epoch: 4 cost time: 1.618798017501831
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.446 Vali Acc: 0.262 Test Loss: 1.446 Test Acc: 0.262
Validation loss decreased (-0.239530 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 1.7674124240875244
Epoch: 5, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.427 Vali Acc: 0.274 Test Loss: 1.427 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 6 cost time: 1.4727106094360352
Epoch: 6, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.452 Vali Acc: 0.259 Test Loss: 1.452 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4725849628448486
Epoch: 7, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.544 Vali Acc: 0.270 Test Loss: 1.544 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.868821382522583
Epoch: 8, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.515 Vali Acc: 0.240 Test Loss: 1.515 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6019601821899414
Epoch: 9, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.448 Vali Acc: 0.278 Test Loss: 1.448 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 10 cost time: 1.7308123111724854
Epoch: 10, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.472 Vali Acc: 0.266 Test Loss: 1.472 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8159656524658203
Epoch: 11, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.635 Vali Acc: 0.255 Test Loss: 1.635 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.749544382095337
Epoch: 12, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.583 Vali Acc: 0.240 Test Loss: 1.583 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7620232105255127
Epoch: 13, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.592 Vali Acc: 0.247 Test Loss: 1.592 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8914568424224854
Epoch: 14, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.561 Vali Acc: 0.243 Test Loss: 1.561 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6733314990997314
Epoch: 15, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.581 Vali Acc: 0.266 Test Loss: 1.581 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8253321647644043
Epoch: 16, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.681 Vali Acc: 0.259 Test Loss: 1.681 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7532362937927246
Epoch: 17, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.572 Vali Acc: 0.255 Test Loss: 1.572 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.753638505935669
Epoch: 18, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.698 Vali Acc: 0.247 Test Loss: 1.698 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7645411491394043
Epoch: 19, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.617 Vali Acc: 0.259 Test Loss: 1.617 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 102596
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3961284160614014
Epoch: 1, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.424 Vali Acc: 0.232 Test Loss: 1.424 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.8135113716125488
Epoch: 2, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.421 Vali Acc: 0.243 Test Loss: 1.421 Test Acc: 0.243
Validation loss decreased (-0.231925 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 1.4275104999542236
Epoch: 3, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.418 Vali Acc: 0.262 Test Loss: 1.418 Test Acc: 0.262
Validation loss decreased (-0.243332 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.444715976715088
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.452 Vali Acc: 0.232 Test Loss: 1.452 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7437248229980469
Epoch: 5, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.423 Vali Acc: 0.266 Test Loss: 1.423 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 6 cost time: 1.4300243854522705
Epoch: 6, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.443 Vali Acc: 0.270 Test Loss: 1.443 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269948).  Saving model ...
Epoch: 7 cost time: 1.6036736965179443
Epoch: 7, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.537 Vali Acc: 0.217 Test Loss: 1.537 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.641366720199585
Epoch: 8, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.440 Vali Acc: 0.259 Test Loss: 1.440 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7487430572509766
Epoch: 9, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.507 Vali Acc: 0.259 Test Loss: 1.507 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7396817207336426
Epoch: 10, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.503 Vali Acc: 0.266 Test Loss: 1.503 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7401540279388428
Epoch: 11, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.532 Vali Acc: 0.266 Test Loss: 1.532 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7356858253479004
Epoch: 12, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.552 Vali Acc: 0.259 Test Loss: 1.552 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.837538719177246
Epoch: 13, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.584 Vali Acc: 0.247 Test Loss: 1.584 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8312149047851562
Epoch: 14, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.561 Vali Acc: 0.270 Test Loss: 1.561 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6287031173706055
Epoch: 15, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.609 Vali Acc: 0.228 Test Loss: 1.609 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8447773456573486
Epoch: 16, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.631 Vali Acc: 0.209 Test Loss: 1.631 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 105156
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.288250207901001
Epoch: 1, Steps: 17 | Train Loss: 1.579 Vali Loss: 1.412 Vali Acc: 0.236 Test Loss: 1.412 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.7181153297424316
Epoch: 2, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.409 Vali Acc: 0.247 Test Loss: 1.409 Test Acc: 0.247
Validation loss decreased (-0.235727 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.7559881210327148
Epoch: 3, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.410 Vali Acc: 0.247 Test Loss: 1.410 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5829758644104004
Epoch: 4, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.416 Vali Acc: 0.281 Test Loss: 1.416 Test Acc: 0.281
Validation loss decreased (-0.247134 --> -0.281355).  Saving model ...
Epoch: 5 cost time: 1.7644383907318115
Epoch: 5, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.426 Vali Acc: 0.278 Test Loss: 1.426 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7327957153320312
Epoch: 6, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.444 Vali Acc: 0.243 Test Loss: 1.444 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3145554065704346
Epoch: 7, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.482 Vali Acc: 0.255 Test Loss: 1.482 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4291529655456543
Epoch: 8, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.450 Vali Acc: 0.278 Test Loss: 1.450 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4910800457000732
Epoch: 9, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.484 Vali Acc: 0.247 Test Loss: 1.484 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.682647943496704
Epoch: 10, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.565 Vali Acc: 0.262 Test Loss: 1.565 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6001098155975342
Epoch: 11, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.491 Vali Acc: 0.209 Test Loss: 1.491 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3809611797332764
Epoch: 12, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.537 Vali Acc: 0.255 Test Loss: 1.537 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8594005107879639
Epoch: 13, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.703 Vali Acc: 0.266 Test Loss: 1.703 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8611173629760742
Epoch: 14, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.508 Vali Acc: 0.243 Test Loss: 1.508 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm64_nh16_df64_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 109188
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7110023498535156
Epoch: 1, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.512 Vali Acc: 0.262 Test Loss: 1.512 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 1.964965581893921
Epoch: 2, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.396 Vali Acc: 0.278 Test Loss: 1.396 Test Acc: 0.278
Validation loss decreased (-0.262342 --> -0.277553).  Saving model ...
Epoch: 3 cost time: 1.6096105575561523
Epoch: 3, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.435 Vali Acc: 0.243 Test Loss: 1.435 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.552377700805664
Epoch: 4, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.453 Vali Acc: 0.255 Test Loss: 1.453 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6204779148101807
Epoch: 5, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.435 Vali Acc: 0.274 Test Loss: 1.435 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7250916957855225
Epoch: 6, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.488 Vali Acc: 0.251 Test Loss: 1.488 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6465656757354736
Epoch: 7, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.586 Vali Acc: 0.243 Test Loss: 1.586 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6323797702789307
Epoch: 8, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.597 Vali Acc: 0.251 Test Loss: 1.597 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8411858081817627
Epoch: 9, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.728 Vali Acc: 0.243 Test Loss: 1.728 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6872341632843018
Epoch: 10, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.528 Vali Acc: 0.232 Test Loss: 1.528 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8750736713409424
Epoch: 11, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.604 Vali Acc: 0.274 Test Loss: 1.604 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8096983432769775
Epoch: 12, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.917 Vali Acc: 0.255 Test Loss: 1.917 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 94884
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.814357280731201
Epoch: 1, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.422 Vali Acc: 0.251 Test Loss: 1.422 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.6916182041168213
Epoch: 2, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.390 Vali Acc: 0.251 Test Loss: 1.390 Test Acc: 0.251
Validation loss decreased (-0.250936 --> -0.250937).  Saving model ...
Epoch: 3 cost time: 1.5408275127410889
Epoch: 3, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.401 Vali Acc: 0.270 Test Loss: 1.401 Test Acc: 0.270
Validation loss decreased (-0.250937 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 1.5547683238983154
Epoch: 4, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.480 Vali Acc: 0.278 Test Loss: 1.480 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 1.5921893119812012
Epoch: 5, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.428 Vali Acc: 0.262 Test Loss: 1.428 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6016690731048584
Epoch: 6, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.397 Vali Acc: 0.274 Test Loss: 1.397 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5035650730133057
Epoch: 7, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.447 Vali Acc: 0.255 Test Loss: 1.447 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6224427223205566
Epoch: 8, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.464 Vali Acc: 0.281 Test Loss: 1.464 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281354).  Saving model ...
Epoch: 9 cost time: 1.6601228713989258
Epoch: 9, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.453 Vali Acc: 0.259 Test Loss: 1.453 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.631577491760254
Epoch: 10, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.480 Vali Acc: 0.270 Test Loss: 1.480 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.580162763595581
Epoch: 11, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.451 Vali Acc: 0.259 Test Loss: 1.451 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5195691585540771
Epoch: 12, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.523 Vali Acc: 0.259 Test Loss: 1.523 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5346360206604004
Epoch: 13, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.594 Vali Acc: 0.255 Test Loss: 1.594 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4513537883758545
Epoch: 14, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.651 Vali Acc: 0.255 Test Loss: 1.651 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.555880069732666
Epoch: 15, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.569 Vali Acc: 0.262 Test Loss: 1.569 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.430711030960083
Epoch: 16, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.558 Vali Acc: 0.243 Test Loss: 1.558 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5540680885314941
Epoch: 17, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.554 Vali Acc: 0.266 Test Loss: 1.554 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7180283069610596
Epoch: 18, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.714 Vali Acc: 0.240 Test Loss: 1.714 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 80932
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.186662197113037
Epoch: 1, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.388 Vali Acc: 0.251 Test Loss: 1.388 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.620600700378418
Epoch: 2, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.399 Vali Acc: 0.274 Test Loss: 1.399 Test Acc: 0.274
Validation loss decreased (-0.250937 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 1.533705711364746
Epoch: 3, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.420 Vali Acc: 0.270 Test Loss: 1.420 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6903326511383057
Epoch: 4, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.394 Vali Acc: 0.297 Test Loss: 1.394 Test Acc: 0.297
Validation loss decreased (-0.273750 --> -0.296564).  Saving model ...
Epoch: 5 cost time: 1.6312987804412842
Epoch: 5, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.399 Vali Acc: 0.300 Test Loss: 1.399 Test Acc: 0.300
Validation loss decreased (-0.296564 --> -0.300366).  Saving model ...
Epoch: 6 cost time: 1.6501386165618896
Epoch: 6, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.418 Vali Acc: 0.319 Test Loss: 1.418 Test Acc: 0.319
Validation loss decreased (-0.300366 --> -0.319377).  Saving model ...
Epoch: 7 cost time: 1.5448927879333496
Epoch: 7, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.445 Vali Acc: 0.289 Test Loss: 1.445 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7285871505737305
Epoch: 8, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.437 Vali Acc: 0.259 Test Loss: 1.437 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.539156436920166
Epoch: 9, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.548 Vali Acc: 0.251 Test Loss: 1.548 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5546329021453857
Epoch: 10, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.544 Vali Acc: 0.266 Test Loss: 1.544 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6310698986053467
Epoch: 11, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.478 Vali Acc: 0.255 Test Loss: 1.478 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6187245845794678
Epoch: 12, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.478 Vali Acc: 0.240 Test Loss: 1.478 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5067923069000244
Epoch: 13, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.513 Vali Acc: 0.251 Test Loss: 1.513 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.46976900100708
Epoch: 14, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.595 Vali Acc: 0.243 Test Loss: 1.595 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4813685417175293
Epoch: 15, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.570 Vali Acc: 0.251 Test Loss: 1.570 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.690629482269287
Epoch: 16, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.566 Vali Acc: 0.236 Test Loss: 1.566 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 77348
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3079748153686523
Epoch: 1, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.421 Vali Acc: 0.236 Test Loss: 1.421 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.4284038543701172
Epoch: 2, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.427 Vali Acc: 0.259 Test Loss: 1.427 Test Acc: 0.259
Validation loss decreased (-0.235727 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.3760786056518555
Epoch: 3, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.416 Vali Acc: 0.251 Test Loss: 1.416 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4650380611419678
Epoch: 4, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.450 Vali Acc: 0.243 Test Loss: 1.450 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.458514928817749
Epoch: 5, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.424 Vali Acc: 0.224 Test Loss: 1.424 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3867464065551758
Epoch: 6, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.414 Vali Acc: 0.262 Test Loss: 1.414 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 7 cost time: 1.4963901042938232
Epoch: 7, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.470 Vali Acc: 0.240 Test Loss: 1.470 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4782757759094238
Epoch: 8, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.437 Vali Acc: 0.251 Test Loss: 1.437 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4913742542266846
Epoch: 9, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.450 Vali Acc: 0.259 Test Loss: 1.450 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4981729984283447
Epoch: 10, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.492 Vali Acc: 0.255 Test Loss: 1.492 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5614697933197021
Epoch: 11, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.461 Vali Acc: 0.255 Test Loss: 1.461 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6018900871276855
Epoch: 12, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.483 Vali Acc: 0.255 Test Loss: 1.483 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5646629333496094
Epoch: 13, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.584 Vali Acc: 0.221 Test Loss: 1.584 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6739256381988525
Epoch: 14, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.562 Vali Acc: 0.278 Test Loss: 1.562 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277551).  Saving model ...
Epoch: 15 cost time: 1.504612922668457
Epoch: 15, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.561 Vali Acc: 0.251 Test Loss: 1.561 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.566103219985962
Epoch: 16, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.597 Vali Acc: 0.262 Test Loss: 1.597 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5621161460876465
Epoch: 17, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.575 Vali Acc: 0.247 Test Loss: 1.575 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5959768295288086
Epoch: 18, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.589 Vali Acc: 0.255 Test Loss: 1.589 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5865955352783203
Epoch: 19, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.651 Vali Acc: 0.236 Test Loss: 1.651 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6528997421264648
Epoch: 20, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.743 Vali Acc: 0.247 Test Loss: 1.743 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5818665027618408
Epoch: 21, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.598 Vali Acc: 0.224 Test Loss: 1.598 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5846316814422607
Epoch: 22, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.626 Vali Acc: 0.228 Test Loss: 1.626 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5848119258880615
Epoch: 23, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.638 Vali Acc: 0.247 Test Loss: 1.638 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7003118991851807
Epoch: 24, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.668 Vali Acc: 0.240 Test Loss: 1.668 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 76068
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3540713787078857
Epoch: 1, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.409 Vali Acc: 0.259 Test Loss: 1.409 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.5412757396697998
Epoch: 2, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.398 Vali Acc: 0.259 Test Loss: 1.398 Test Acc: 0.259
Validation loss decreased (-0.258541 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.4249649047851562
Epoch: 3, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.401 Vali Acc: 0.262 Test Loss: 1.401 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.6186280250549316
Epoch: 4, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.412 Vali Acc: 0.274 Test Loss: 1.412 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 1.55714750289917
Epoch: 5, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.405 Vali Acc: 0.262 Test Loss: 1.405 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5098774433135986
Epoch: 6, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.413 Vali Acc: 0.266 Test Loss: 1.413 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5288403034210205
Epoch: 7, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.419 Vali Acc: 0.259 Test Loss: 1.419 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5817420482635498
Epoch: 8, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.417 Vali Acc: 0.266 Test Loss: 1.417 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6841232776641846
Epoch: 9, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.465 Vali Acc: 0.278 Test Loss: 1.465 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 10 cost time: 1.6661319732666016
Epoch: 10, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.430 Vali Acc: 0.251 Test Loss: 1.430 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.511289119720459
Epoch: 11, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.474 Vali Acc: 0.285 Test Loss: 1.474 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285156).  Saving model ...
Epoch: 12 cost time: 1.55743408203125
Epoch: 12, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.543 Vali Acc: 0.247 Test Loss: 1.543 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6263797283172607
Epoch: 13, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.479 Vali Acc: 0.285 Test Loss: 1.479 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.520986795425415
Epoch: 14, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.468 Vali Acc: 0.259 Test Loss: 1.468 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6489050388336182
Epoch: 15, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.576 Vali Acc: 0.262 Test Loss: 1.576 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5253310203552246
Epoch: 16, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.561 Vali Acc: 0.232 Test Loss: 1.561 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4171249866485596
Epoch: 17, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.538 Vali Acc: 0.278 Test Loss: 1.538 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5966606140136719
Epoch: 18, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.623 Vali Acc: 0.251 Test Loss: 1.623 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6318776607513428
Epoch: 19, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.710 Vali Acc: 0.243 Test Loss: 1.710 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7808244228363037
Epoch: 20, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.636 Vali Acc: 0.270 Test Loss: 1.636 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.565080165863037
Epoch: 21, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.648 Vali Acc: 0.266 Test Loss: 1.648 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 76548
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6820290088653564
Epoch: 1, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.398 Vali Acc: 0.228 Test Loss: 1.398 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 1.6625847816467285
Epoch: 2, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.405 Vali Acc: 0.251 Test Loss: 1.405 Test Acc: 0.251
Validation loss decreased (-0.228123 --> -0.250937).  Saving model ...
Epoch: 3 cost time: 1.6984705924987793
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.399 Vali Acc: 0.243 Test Loss: 1.399 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6496477127075195
Epoch: 4, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.421 Vali Acc: 0.297 Test Loss: 1.421 Test Acc: 0.297
Validation loss decreased (-0.250937 --> -0.296564).  Saving model ...
Epoch: 5 cost time: 1.5201389789581299
Epoch: 5, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.400 Vali Acc: 0.217 Test Loss: 1.400 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.589200735092163
Epoch: 6, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.418 Vali Acc: 0.259 Test Loss: 1.418 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5680923461914062
Epoch: 7, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.415 Vali Acc: 0.262 Test Loss: 1.415 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5424530506134033
Epoch: 8, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.425 Vali Acc: 0.278 Test Loss: 1.425 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6180403232574463
Epoch: 9, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.468 Vali Acc: 0.259 Test Loss: 1.468 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4527838230133057
Epoch: 10, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.428 Vali Acc: 0.274 Test Loss: 1.428 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5710785388946533
Epoch: 11, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.476 Vali Acc: 0.266 Test Loss: 1.476 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7617878913879395
Epoch: 12, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.469 Vali Acc: 0.274 Test Loss: 1.469 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5329382419586182
Epoch: 13, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.515 Vali Acc: 0.262 Test Loss: 1.515 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3115184307098389
Epoch: 14, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.485 Vali Acc: 0.243 Test Loss: 1.485 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 77828
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.388054609298706
Epoch: 1, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.403 Vali Acc: 0.270 Test Loss: 1.403 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.555009365081787
Epoch: 2, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.407 Vali Acc: 0.255 Test Loss: 1.407 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7855908870697021
Epoch: 3, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.410 Vali Acc: 0.270 Test Loss: 1.410 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8172388076782227
Epoch: 4, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.403 Vali Acc: 0.293 Test Loss: 1.403 Test Acc: 0.293
Validation loss decreased (-0.269948 --> -0.292762).  Saving model ...
Epoch: 5 cost time: 1.663233757019043
Epoch: 5, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.410 Vali Acc: 0.274 Test Loss: 1.410 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6717407703399658
Epoch: 6, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.430 Vali Acc: 0.274 Test Loss: 1.430 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6556086540222168
Epoch: 7, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.409 Vali Acc: 0.262 Test Loss: 1.409 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8134043216705322
Epoch: 8, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.422 Vali Acc: 0.281 Test Loss: 1.422 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7231590747833252
Epoch: 9, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.443 Vali Acc: 0.274 Test Loss: 1.443 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.583008050918579
Epoch: 10, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.428 Vali Acc: 0.247 Test Loss: 1.428 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6942095756530762
Epoch: 11, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.492 Vali Acc: 0.224 Test Loss: 1.492 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6860847473144531
Epoch: 12, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.529 Vali Acc: 0.297 Test Loss: 1.529 Test Acc: 0.297
Validation loss decreased (-0.292762 --> -0.296563).  Saving model ...
Epoch: 13 cost time: 1.7054495811462402
Epoch: 13, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.486 Vali Acc: 0.251 Test Loss: 1.486 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4623336791992188
Epoch: 14, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.623 Vali Acc: 0.255 Test Loss: 1.623 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6347098350524902
Epoch: 15, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.536 Vali Acc: 0.240 Test Loss: 1.536 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.565702199935913
Epoch: 16, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.534 Vali Acc: 0.266 Test Loss: 1.534 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.797168493270874
Epoch: 17, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.590 Vali Acc: 0.255 Test Loss: 1.590 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8614704608917236
Epoch: 18, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.615 Vali Acc: 0.259 Test Loss: 1.615 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8505058288574219
Epoch: 19, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.636 Vali Acc: 0.259 Test Loss: 1.636 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.764585256576538
Epoch: 20, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.743 Vali Acc: 0.243 Test Loss: 1.743 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6464989185333252
Epoch: 21, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.716 Vali Acc: 0.278 Test Loss: 1.716 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7225613594055176
Epoch: 22, Steps: 17 | Train Loss: 1.022 Vali Loss: 1.817 Vali Acc: 0.240 Test Loss: 1.817 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df256_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 79844
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7811787128448486
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.409 Vali Acc: 0.262 Test Loss: 1.409 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.8982317447662354
Epoch: 2, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.389 Vali Acc: 0.262 Test Loss: 1.389 Test Acc: 0.262
Validation loss decreased (-0.262343 --> -0.262344).  Saving model ...
Epoch: 3 cost time: 1.7985916137695312
Epoch: 3, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.415 Vali Acc: 0.266 Test Loss: 1.415 Test Acc: 0.266
Validation loss decreased (-0.262344 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.6686921119689941
Epoch: 4, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.564 Vali Acc: 0.255 Test Loss: 1.564 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7105870246887207
Epoch: 5, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.462 Vali Acc: 0.266 Test Loss: 1.462 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7660472393035889
Epoch: 6, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.491 Vali Acc: 0.251 Test Loss: 1.491 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.58109450340271
Epoch: 7, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.465 Vali Acc: 0.247 Test Loss: 1.465 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.791649580001831
Epoch: 8, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.510 Vali Acc: 0.236 Test Loss: 1.510 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7975714206695557
Epoch: 9, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.658 Vali Acc: 0.224 Test Loss: 1.658 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.827887773513794
Epoch: 10, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.564 Vali Acc: 0.262 Test Loss: 1.564 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7768850326538086
Epoch: 11, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.757 Vali Acc: 0.281 Test Loss: 1.757 Test Acc: 0.281
Validation loss decreased (-0.266146 --> -0.281351).  Saving model ...
Epoch: 12 cost time: 1.81272554397583
Epoch: 12, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.519 Vali Acc: 0.259 Test Loss: 1.519 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8634073734283447
Epoch: 13, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.617 Vali Acc: 0.251 Test Loss: 1.617 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8280742168426514
Epoch: 14, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.677 Vali Acc: 0.259 Test Loss: 1.677 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.797576904296875
Epoch: 15, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.635 Vali Acc: 0.278 Test Loss: 1.635 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.879950761795044
Epoch: 16, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.595 Vali Acc: 0.255 Test Loss: 1.595 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6616075038909912
Epoch: 17, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.760 Vali Acc: 0.240 Test Loss: 1.760 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7053136825561523
Epoch: 18, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.713 Vali Acc: 0.247 Test Loss: 1.713 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6951196193695068
Epoch: 19, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.725 Vali Acc: 0.259 Test Loss: 1.725 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6727025508880615
Epoch: 20, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.884 Vali Acc: 0.240 Test Loss: 1.884 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7415778636932373
Epoch: 21, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.771 Vali Acc: 0.240 Test Loss: 1.771 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 69924
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5478429794311523
Epoch: 1, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.392 Vali Acc: 0.270 Test Loss: 1.392 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.7156095504760742
Epoch: 2, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.408 Vali Acc: 0.255 Test Loss: 1.408 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5993566513061523
Epoch: 3, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.410 Vali Acc: 0.285 Test Loss: 1.410 Test Acc: 0.285
Validation loss decreased (-0.269948 --> -0.285157).  Saving model ...
Epoch: 4 cost time: 1.5808672904968262
Epoch: 4, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.420 Vali Acc: 0.278 Test Loss: 1.420 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6673738956451416
Epoch: 5, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.425 Vali Acc: 0.293 Test Loss: 1.425 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292761).  Saving model ...
Epoch: 6 cost time: 1.6337502002716064
Epoch: 6, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.421 Vali Acc: 0.262 Test Loss: 1.421 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6982707977294922
Epoch: 7, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.513 Vali Acc: 0.255 Test Loss: 1.513 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6511225700378418
Epoch: 8, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.487 Vali Acc: 0.262 Test Loss: 1.487 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8583946228027344
Epoch: 9, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.543 Vali Acc: 0.251 Test Loss: 1.543 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.695000410079956
Epoch: 10, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.559 Vali Acc: 0.247 Test Loss: 1.559 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7646689414978027
Epoch: 11, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.469 Vali Acc: 0.243 Test Loss: 1.469 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7261817455291748
Epoch: 12, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.492 Vali Acc: 0.270 Test Loss: 1.492 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7413151264190674
Epoch: 13, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.551 Vali Acc: 0.262 Test Loss: 1.551 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6460185050964355
Epoch: 14, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.503 Vali Acc: 0.281 Test Loss: 1.503 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6285040378570557
Epoch: 15, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.502 Vali Acc: 0.236 Test Loss: 1.502 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 55972
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.380777359008789
Epoch: 1, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.401 Vali Acc: 0.255 Test Loss: 1.401 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.4593431949615479
Epoch: 2, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.412 Vali Acc: 0.270 Test Loss: 1.412 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 1.5817220211029053
Epoch: 3, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.403 Vali Acc: 0.240 Test Loss: 1.403 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5507988929748535
Epoch: 4, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.402 Vali Acc: 0.243 Test Loss: 1.402 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5534391403198242
Epoch: 5, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.429 Vali Acc: 0.247 Test Loss: 1.429 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6455678939819336
Epoch: 6, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.527 Vali Acc: 0.285 Test Loss: 1.527 Test Acc: 0.285
Validation loss decreased (-0.269948 --> -0.285156).  Saving model ...
Epoch: 7 cost time: 1.6072580814361572
Epoch: 7, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.458 Vali Acc: 0.266 Test Loss: 1.458 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7729809284210205
Epoch: 8, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.506 Vali Acc: 0.262 Test Loss: 1.506 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.50748872756958
Epoch: 9, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.455 Vali Acc: 0.236 Test Loss: 1.455 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7214832305908203
Epoch: 10, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.481 Vali Acc: 0.251 Test Loss: 1.481 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7660729885101318
Epoch: 11, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.488 Vali Acc: 0.274 Test Loss: 1.488 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6420087814331055
Epoch: 12, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.519 Vali Acc: 0.270 Test Loss: 1.519 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.645761251449585
Epoch: 13, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.561 Vali Acc: 0.243 Test Loss: 1.561 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.769106388092041
Epoch: 14, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.524 Vali Acc: 0.243 Test Loss: 1.524 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.711653470993042
Epoch: 15, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.682 Vali Acc: 0.228 Test Loss: 1.682 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6226918697357178
Epoch: 16, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.556 Vali Acc: 0.255 Test Loss: 1.556 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 52388
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.826789140701294
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.401 Vali Acc: 0.266 Test Loss: 1.401 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 1.496448040008545
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.404 Vali Acc: 0.281 Test Loss: 1.404 Test Acc: 0.281
Validation loss decreased (-0.266146 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 1.5477807521820068
Epoch: 3, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.407 Vali Acc: 0.270 Test Loss: 1.407 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4834351539611816
Epoch: 4, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.424 Vali Acc: 0.259 Test Loss: 1.424 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7066481113433838
Epoch: 5, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.421 Vali Acc: 0.228 Test Loss: 1.421 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5880627632141113
Epoch: 6, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.447 Vali Acc: 0.259 Test Loss: 1.447 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5931038856506348
Epoch: 7, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.446 Vali Acc: 0.243 Test Loss: 1.446 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5993645191192627
Epoch: 8, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.435 Vali Acc: 0.243 Test Loss: 1.435 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5786843299865723
Epoch: 9, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.536 Vali Acc: 0.243 Test Loss: 1.536 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.551250696182251
Epoch: 10, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.477 Vali Acc: 0.251 Test Loss: 1.477 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6321327686309814
Epoch: 11, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.485 Vali Acc: 0.243 Test Loss: 1.485 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6981699466705322
Epoch: 12, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.499 Vali Acc: 0.232 Test Loss: 1.499 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 51108
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5174317359924316
Epoch: 1, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.416 Vali Acc: 0.236 Test Loss: 1.416 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.6814632415771484
Epoch: 2, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.408 Vali Acc: 0.251 Test Loss: 1.408 Test Acc: 0.251
Validation loss decreased (-0.235727 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 1.5408308506011963
Epoch: 3, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.399 Vali Acc: 0.259 Test Loss: 1.399 Test Acc: 0.259
Validation loss decreased (-0.250936 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 1.6359832286834717
Epoch: 4, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.403 Vali Acc: 0.240 Test Loss: 1.403 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4830129146575928
Epoch: 5, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.400 Vali Acc: 0.251 Test Loss: 1.400 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5263116359710693
Epoch: 6, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.401 Vali Acc: 0.232 Test Loss: 1.401 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.606208324432373
Epoch: 7, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.435 Vali Acc: 0.259 Test Loss: 1.435 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5579853057861328
Epoch: 8, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.430 Vali Acc: 0.224 Test Loss: 1.430 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5412626266479492
Epoch: 9, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.419 Vali Acc: 0.251 Test Loss: 1.419 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4848260879516602
Epoch: 10, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.454 Vali Acc: 0.278 Test Loss: 1.454 Test Acc: 0.278
Validation loss decreased (-0.258541 --> -0.277552).  Saving model ...
Epoch: 11 cost time: 1.482280969619751
Epoch: 11, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.452 Vali Acc: 0.274 Test Loss: 1.452 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5079362392425537
Epoch: 12, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.501 Vali Acc: 0.262 Test Loss: 1.501 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4408493041992188
Epoch: 13, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.704 Vali Acc: 0.255 Test Loss: 1.704 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5603017807006836
Epoch: 14, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.494 Vali Acc: 0.240 Test Loss: 1.494 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6670422554016113
Epoch: 15, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.559 Vali Acc: 0.259 Test Loss: 1.559 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.631258249282837
Epoch: 16, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.552 Vali Acc: 0.247 Test Loss: 1.552 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6197988986968994
Epoch: 17, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.541 Vali Acc: 0.270 Test Loss: 1.541 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5409612655639648
Epoch: 18, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.588 Vali Acc: 0.236 Test Loss: 1.588 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6350717544555664
Epoch: 19, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.575 Vali Acc: 0.217 Test Loss: 1.575 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5125095844268799
Epoch: 20, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.679 Vali Acc: 0.240 Test Loss: 1.679 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 51588
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4662578105926514
Epoch: 1, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.419 Vali Acc: 0.259 Test Loss: 1.419 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.5014946460723877
Epoch: 2, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5852069854736328
Epoch: 3, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.422 Vali Acc: 0.228 Test Loss: 1.422 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6286273002624512
Epoch: 4, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.408 Vali Acc: 0.243 Test Loss: 1.408 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5305633544921875
Epoch: 5, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.411 Vali Acc: 0.228 Test Loss: 1.411 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5897455215454102
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.405 Vali Acc: 0.236 Test Loss: 1.405 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3136732578277588
Epoch: 7, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.410 Vali Acc: 0.243 Test Loss: 1.410 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4977214336395264
Epoch: 8, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.428 Vali Acc: 0.221 Test Loss: 1.428 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.384451150894165
Epoch: 9, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.427 Vali Acc: 0.262 Test Loss: 1.427 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 10 cost time: 1.4761412143707275
Epoch: 10, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.442 Vali Acc: 0.224 Test Loss: 1.442 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5607566833496094
Epoch: 11, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.446 Vali Acc: 0.236 Test Loss: 1.446 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5337169170379639
Epoch: 12, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.479 Vali Acc: 0.228 Test Loss: 1.479 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5998165607452393
Epoch: 13, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.451 Vali Acc: 0.255 Test Loss: 1.451 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5152552127838135
Epoch: 14, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.497 Vali Acc: 0.262 Test Loss: 1.497 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6399188041687012
Epoch: 15, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.628 Vali Acc: 0.259 Test Loss: 1.628 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5649240016937256
Epoch: 16, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.507 Vali Acc: 0.285 Test Loss: 1.507 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285156).  Saving model ...
Epoch: 17 cost time: 1.619154453277588
Epoch: 17, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.530 Vali Acc: 0.224 Test Loss: 1.530 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.606868028640747
Epoch: 18, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.616 Vali Acc: 0.232 Test Loss: 1.616 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6256153583526611
Epoch: 19, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.691 Vali Acc: 0.274 Test Loss: 1.691 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5738630294799805
Epoch: 20, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.657 Vali Acc: 0.266 Test Loss: 1.657 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5699217319488525
Epoch: 21, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.540 Vali Acc: 0.251 Test Loss: 1.540 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5870957374572754
Epoch: 22, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.584 Vali Acc: 0.259 Test Loss: 1.584 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6393475532531738
Epoch: 23, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.592 Vali Acc: 0.262 Test Loss: 1.592 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6401746273040771
Epoch: 24, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.802 Vali Acc: 0.255 Test Loss: 1.802 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.61659574508667
Epoch: 25, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.671 Vali Acc: 0.278 Test Loss: 1.671 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6653823852539062
Epoch: 26, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.889 Vali Acc: 0.274 Test Loss: 1.889 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 52868
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0531005859375
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.430 Vali Acc: 0.251 Test Loss: 1.430 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.6026721000671387
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.412 Vali Acc: 0.236 Test Loss: 1.412 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.485015869140625
Epoch: 3, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5054278373718262
Epoch: 4, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.416 Vali Acc: 0.251 Test Loss: 1.416 Test Acc: 0.251
Validation loss decreased (-0.250936 --> -0.250936).  Saving model ...
Epoch: 5 cost time: 1.4928817749023438
Epoch: 5, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.409 Vali Acc: 0.243 Test Loss: 1.409 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5756592750549316
Epoch: 6, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.408 Vali Acc: 0.240 Test Loss: 1.408 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5158674716949463
Epoch: 7, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.449 Vali Acc: 0.255 Test Loss: 1.449 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254738).  Saving model ...
Epoch: 8 cost time: 1.4933767318725586
Epoch: 8, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.423 Vali Acc: 0.255 Test Loss: 1.423 Test Acc: 0.255
Validation loss decreased (-0.254738 --> -0.254739).  Saving model ...
Epoch: 9 cost time: 1.5312130451202393
Epoch: 9, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.424 Vali Acc: 0.259 Test Loss: 1.424 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 10 cost time: 1.6209173202514648
Epoch: 10, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.455 Vali Acc: 0.285 Test Loss: 1.455 Test Acc: 0.285
Validation loss decreased (-0.258541 --> -0.285157).  Saving model ...
Epoch: 11 cost time: 1.5725996494293213
Epoch: 11, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.438 Vali Acc: 0.251 Test Loss: 1.438 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5832180976867676
Epoch: 12, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.482 Vali Acc: 0.240 Test Loss: 1.482 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8109235763549805
Epoch: 13, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.491 Vali Acc: 0.251 Test Loss: 1.491 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6010549068450928
Epoch: 14, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.505 Vali Acc: 0.255 Test Loss: 1.505 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6738557815551758
Epoch: 15, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.497 Vali Acc: 0.255 Test Loss: 1.497 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7107419967651367
Epoch: 16, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.556 Vali Acc: 0.247 Test Loss: 1.556 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7324659824371338
Epoch: 17, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.520 Vali Acc: 0.266 Test Loss: 1.520 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7197222709655762
Epoch: 18, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.501 Vali Acc: 0.262 Test Loss: 1.501 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7122223377227783
Epoch: 19, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.576 Vali Acc: 0.289 Test Loss: 1.576 Test Acc: 0.289
Validation loss decreased (-0.285157 --> -0.288958).  Saving model ...
Epoch: 20 cost time: 1.6628303527832031
Epoch: 20, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.590 Vali Acc: 0.270 Test Loss: 1.590 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6639480590820312
Epoch: 21, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.711 Vali Acc: 0.274 Test Loss: 1.711 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.796044111251831
Epoch: 22, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.551 Vali Acc: 0.262 Test Loss: 1.551 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6004765033721924
Epoch: 23, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.580 Vali Acc: 0.274 Test Loss: 1.580 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.662581443786621
Epoch: 24, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.708 Vali Acc: 0.236 Test Loss: 1.708 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6641838550567627
Epoch: 25, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.689 Vali Acc: 0.270 Test Loss: 1.689 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6898863315582275
Epoch: 26, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.738 Vali Acc: 0.251 Test Loss: 1.738 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.628330945968628
Epoch: 27, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.653 Vali Acc: 0.278 Test Loss: 1.653 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6129491329193115
Epoch: 28, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.757 Vali Acc: 0.293 Test Loss: 1.757 Test Acc: 0.293
Validation loss decreased (-0.288958 --> -0.292758).  Saving model ...
Epoch: 29 cost time: 1.5907599925994873
Epoch: 29, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.785 Vali Acc: 0.266 Test Loss: 1.785 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4908618927001953
Epoch: 30, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.904 Vali Acc: 0.247 Test Loss: 1.904 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5237207412719727
Epoch: 31, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.722 Vali Acc: 0.266 Test Loss: 1.722 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.62571120262146
Epoch: 32, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.983 Vali Acc: 0.259 Test Loss: 1.983 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5301096439361572
Epoch: 33, Steps: 17 | Train Loss: 0.944 Vali Loss: 1.712 Vali Acc: 0.251 Test Loss: 1.712 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.585378885269165
Epoch: 34, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.974 Vali Acc: 0.289 Test Loss: 1.974 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.5412466526031494
Epoch: 35, Steps: 17 | Train Loss: 0.832 Vali Loss: 1.927 Vali Acc: 0.297 Test Loss: 1.927 Test Acc: 0.297
Validation loss decreased (-0.292758 --> -0.296559).  Saving model ...
Epoch: 36 cost time: 1.6048386096954346
Epoch: 36, Steps: 17 | Train Loss: 0.828 Vali Loss: 1.968 Vali Acc: 0.262 Test Loss: 1.968 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7320318222045898
Epoch: 37, Steps: 17 | Train Loss: 0.815 Vali Loss: 2.067 Vali Acc: 0.243 Test Loss: 2.067 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5666759014129639
Epoch: 38, Steps: 17 | Train Loss: 0.768 Vali Loss: 2.155 Vali Acc: 0.251 Test Loss: 2.155 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5827155113220215
Epoch: 39, Steps: 17 | Train Loss: 0.724 Vali Loss: 2.088 Vali Acc: 0.259 Test Loss: 2.088 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.46232271194458
Epoch: 40, Steps: 17 | Train Loss: 0.745 Vali Loss: 2.132 Vali Acc: 0.289 Test Loss: 2.132 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.468688726425171
Epoch: 41, Steps: 17 | Train Loss: 0.725 Vali Loss: 2.150 Vali Acc: 0.278 Test Loss: 2.150 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.5477728843688965
Epoch: 42, Steps: 17 | Train Loss: 0.710 Vali Loss: 2.270 Vali Acc: 0.281 Test Loss: 2.270 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.4830477237701416
Epoch: 43, Steps: 17 | Train Loss: 0.656 Vali Loss: 2.280 Vali Acc: 0.262 Test Loss: 2.280 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.6055705547332764
Epoch: 44, Steps: 17 | Train Loss: 0.724 Vali Loss: 2.322 Vali Acc: 0.274 Test Loss: 2.322 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.6281940937042236
Epoch: 45, Steps: 17 | Train Loss: 0.748 Vali Loss: 2.270 Vali Acc: 0.274 Test Loss: 2.270 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df128_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 54884
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.270372152328491
Epoch: 1, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.467 Vali Acc: 0.251 Test Loss: 1.467 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.598701000213623
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.468 Vali Acc: 0.232 Test Loss: 1.468 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.348205804824829
Epoch: 3, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.569 Vali Acc: 0.251 Test Loss: 1.569 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6628601551055908
Epoch: 4, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.493 Vali Acc: 0.278 Test Loss: 1.493 Test Acc: 0.278
Validation loss decreased (-0.250936 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 1.5705952644348145
Epoch: 5, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.416 Vali Acc: 0.278 Test Loss: 1.416 Test Acc: 0.278
Validation loss decreased (-0.277552 --> -0.277552).  Saving model ...
Epoch: 6 cost time: 1.4913277626037598
Epoch: 6, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.597 Vali Acc: 0.247 Test Loss: 1.597 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.593390941619873
Epoch: 7, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.490 Vali Acc: 0.274 Test Loss: 1.490 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6773862838745117
Epoch: 8, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.446 Vali Acc: 0.262 Test Loss: 1.446 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4059836864471436
Epoch: 9, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.462 Vali Acc: 0.270 Test Loss: 1.462 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4197494983673096
Epoch: 10, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.515 Vali Acc: 0.240 Test Loss: 1.515 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.520047903060913
Epoch: 11, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.766 Vali Acc: 0.251 Test Loss: 1.766 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3948614597320557
Epoch: 12, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.562 Vali Acc: 0.251 Test Loss: 1.562 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6022396087646484
Epoch: 13, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.500 Vali Acc: 0.259 Test Loss: 1.500 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4422099590301514
Epoch: 14, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.575 Vali Acc: 0.262 Test Loss: 1.575 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4829540252685547
Epoch: 15, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.628 Vali Acc: 0.255 Test Loss: 1.628 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 57444
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.371814489364624
Epoch: 1, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.405 Vali Acc: 0.251 Test Loss: 1.405 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.485119104385376
Epoch: 2, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.402 Vali Acc: 0.255 Test Loss: 1.402 Test Acc: 0.255
Validation loss decreased (-0.250937 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.3606147766113281
Epoch: 3, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.401 Vali Acc: 0.289 Test Loss: 1.401 Test Acc: 0.289
Validation loss decreased (-0.254739 --> -0.288959).  Saving model ...
Epoch: 4 cost time: 1.4509100914001465
Epoch: 4, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.413 Vali Acc: 0.228 Test Loss: 1.413 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4278779029846191
Epoch: 5, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.423 Vali Acc: 0.285 Test Loss: 1.423 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2613413333892822
Epoch: 6, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.411 Vali Acc: 0.228 Test Loss: 1.411 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.702531337738037
Epoch: 7, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.455 Vali Acc: 0.259 Test Loss: 1.455 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5658867359161377
Epoch: 8, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.484 Vali Acc: 0.270 Test Loss: 1.484 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4688293933868408
Epoch: 9, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.482 Vali Acc: 0.247 Test Loss: 1.482 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6942815780639648
Epoch: 10, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.427 Vali Acc: 0.240 Test Loss: 1.427 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6906530857086182
Epoch: 11, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.505 Vali Acc: 0.270 Test Loss: 1.505 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5932257175445557
Epoch: 12, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.516 Vali Acc: 0.247 Test Loss: 1.516 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.584883451461792
Epoch: 13, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.488 Vali Acc: 0.236 Test Loss: 1.488 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 43492
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4452342987060547
Epoch: 1, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.390 Vali Acc: 0.274 Test Loss: 1.390 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.5152943134307861
Epoch: 2, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.401 Vali Acc: 0.251 Test Loss: 1.401 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.72957444190979
Epoch: 3, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.396 Vali Acc: 0.285 Test Loss: 1.396 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285157).  Saving model ...
Epoch: 4 cost time: 1.5748651027679443
Epoch: 4, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.412 Vali Acc: 0.274 Test Loss: 1.412 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5144929885864258
Epoch: 5, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.428 Vali Acc: 0.266 Test Loss: 1.428 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4178926944732666
Epoch: 6, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.478 Vali Acc: 0.281 Test Loss: 1.478 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7009174823760986
Epoch: 7, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.433 Vali Acc: 0.262 Test Loss: 1.433 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6389367580413818
Epoch: 8, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.419 Vali Acc: 0.285 Test Loss: 1.419 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6115531921386719
Epoch: 9, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.468 Vali Acc: 0.293 Test Loss: 1.468 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292761).  Saving model ...
Epoch: 10 cost time: 1.4717888832092285
Epoch: 10, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.578 Vali Acc: 0.274 Test Loss: 1.578 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7081010341644287
Epoch: 11, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.466 Vali Acc: 0.251 Test Loss: 1.466 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.589557409286499
Epoch: 12, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.534 Vali Acc: 0.281 Test Loss: 1.534 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3612189292907715
Epoch: 13, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.497 Vali Acc: 0.274 Test Loss: 1.497 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5135033130645752
Epoch: 14, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.510 Vali Acc: 0.255 Test Loss: 1.510 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3052215576171875
Epoch: 15, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.565 Vali Acc: 0.247 Test Loss: 1.565 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3856496810913086
Epoch: 16, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.607 Vali Acc: 0.281 Test Loss: 1.607 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4041833877563477
Epoch: 17, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.561 Vali Acc: 0.240 Test Loss: 1.561 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3577401638031006
Epoch: 18, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.646 Vali Acc: 0.255 Test Loss: 1.646 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.520684003829956
Epoch: 19, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.593 Vali Acc: 0.224 Test Loss: 1.593 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 39908
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.306023597717285
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.390 Vali Acc: 0.293 Test Loss: 1.390 Test Acc: 0.293
Validation loss decreased (inf --> -0.292762).  Saving model ...
Epoch: 2 cost time: 1.3918044567108154
Epoch: 2, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4072985649108887
Epoch: 3, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.391 Vali Acc: 0.281 Test Loss: 1.391 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5501012802124023
Epoch: 4, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.401 Vali Acc: 0.255 Test Loss: 1.401 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6726160049438477
Epoch: 5, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.409 Vali Acc: 0.262 Test Loss: 1.409 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5820214748382568
Epoch: 6, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.394 Vali Acc: 0.281 Test Loss: 1.394 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.368861436843872
Epoch: 7, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.415 Vali Acc: 0.274 Test Loss: 1.415 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.590529441833496
Epoch: 8, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.434 Vali Acc: 0.281 Test Loss: 1.434 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5720717906951904
Epoch: 9, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3216426372528076
Epoch: 10, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.484 Vali Acc: 0.270 Test Loss: 1.484 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5041801929473877
Epoch: 11, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.457 Vali Acc: 0.281 Test Loss: 1.457 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 38628
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4238436222076416
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.415 Vali Acc: 0.236 Test Loss: 1.415 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.6248955726623535
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.416 Vali Acc: 0.205 Test Loss: 1.416 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5088980197906494
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.420 Vali Acc: 0.221 Test Loss: 1.420 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5541822910308838
Epoch: 4, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.416 Vali Acc: 0.221 Test Loss: 1.416 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5284607410430908
Epoch: 5, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.422 Vali Acc: 0.217 Test Loss: 1.422 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6121249198913574
Epoch: 6, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.423 Vali Acc: 0.224 Test Loss: 1.423 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7431116104125977
Epoch: 7, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.427 Vali Acc: 0.247 Test Loss: 1.427 Test Acc: 0.247
Validation loss decreased (-0.235727 --> -0.247134).  Saving model ...
Epoch: 8 cost time: 1.6472563743591309
Epoch: 8, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.467 Vali Acc: 0.251 Test Loss: 1.467 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250936).  Saving model ...
Epoch: 9 cost time: 1.5263452529907227
Epoch: 9, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.474 Vali Acc: 0.232 Test Loss: 1.474 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.470120906829834
Epoch: 10, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.463 Vali Acc: 0.236 Test Loss: 1.463 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5198893547058105
Epoch: 11, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.444 Vali Acc: 0.281 Test Loss: 1.444 Test Acc: 0.281
Validation loss decreased (-0.250936 --> -0.281354).  Saving model ...
Epoch: 12 cost time: 1.4472641944885254
Epoch: 12, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.449 Vali Acc: 0.209 Test Loss: 1.449 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3342270851135254
Epoch: 13, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.511 Vali Acc: 0.240 Test Loss: 1.511 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4923887252807617
Epoch: 14, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.494 Vali Acc: 0.259 Test Loss: 1.494 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4590635299682617
Epoch: 15, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.476 Vali Acc: 0.255 Test Loss: 1.476 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6584622859954834
Epoch: 16, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.553 Vali Acc: 0.255 Test Loss: 1.553 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6129605770111084
Epoch: 17, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.521 Vali Acc: 0.262 Test Loss: 1.521 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6332151889801025
Epoch: 18, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.551 Vali Acc: 0.217 Test Loss: 1.551 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4545772075653076
Epoch: 19, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.542 Vali Acc: 0.243 Test Loss: 1.542 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.396956443786621
Epoch: 20, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.560 Vali Acc: 0.251 Test Loss: 1.560 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.434338092803955
Epoch: 21, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.670 Vali Acc: 0.255 Test Loss: 1.670 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 39108
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.965883493423462
Epoch: 1, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.395 Vali Acc: 0.259 Test Loss: 1.395 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.4364640712738037
Epoch: 2, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.388 Vali Acc: 0.251 Test Loss: 1.388 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4613754749298096
Epoch: 3, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.382 Vali Acc: 0.285 Test Loss: 1.382 Test Acc: 0.285
Validation loss decreased (-0.258541 --> -0.285157).  Saving model ...
Epoch: 4 cost time: 1.4227783679962158
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.387 Vali Acc: 0.255 Test Loss: 1.387 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.38779878616333
Epoch: 5, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.382 Vali Acc: 0.304 Test Loss: 1.382 Test Acc: 0.304
Validation loss decreased (-0.285157 --> -0.304169).  Saving model ...
Epoch: 6 cost time: 1.2969896793365479
Epoch: 6, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.388 Vali Acc: 0.285 Test Loss: 1.388 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4185864925384521
Epoch: 7, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.395 Vali Acc: 0.289 Test Loss: 1.395 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4140074253082275
Epoch: 8, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.405 Vali Acc: 0.281 Test Loss: 1.405 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3747353553771973
Epoch: 9, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.411 Vali Acc: 0.266 Test Loss: 1.411 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4300305843353271
Epoch: 10, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.412 Vali Acc: 0.236 Test Loss: 1.412 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5241398811340332
Epoch: 11, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.480 Vali Acc: 0.266 Test Loss: 1.480 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4232046604156494
Epoch: 12, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.434 Vali Acc: 0.255 Test Loss: 1.434 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.543621301651001
Epoch: 13, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.476 Vali Acc: 0.232 Test Loss: 1.476 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5364258289337158
Epoch: 14, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.506 Vali Acc: 0.281 Test Loss: 1.506 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4299583435058594
Epoch: 15, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.518 Vali Acc: 0.240 Test Loss: 1.518 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 40388
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.071016311645508
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.410 Vali Acc: 0.243 Test Loss: 1.410 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.300431251525879
Epoch: 2, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.416 Vali Acc: 0.247 Test Loss: 1.416 Test Acc: 0.247
Validation loss decreased (-0.243332 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.2068729400634766
Epoch: 3, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.405 Vali Acc: 0.266 Test Loss: 1.405 Test Acc: 0.266
Validation loss decreased (-0.247134 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.5140833854675293
Epoch: 4, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5941290855407715
Epoch: 5, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.416 Vali Acc: 0.251 Test Loss: 1.416 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5317602157592773
Epoch: 6, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.412 Vali Acc: 0.270 Test Loss: 1.412 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269948).  Saving model ...
Epoch: 7 cost time: 1.4584760665893555
Epoch: 7, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.422 Vali Acc: 0.259 Test Loss: 1.422 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.469172716140747
Epoch: 8, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.417 Vali Acc: 0.247 Test Loss: 1.417 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4704298973083496
Epoch: 9, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.455 Vali Acc: 0.270 Test Loss: 1.455 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5036728382110596
Epoch: 10, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.429 Vali Acc: 0.297 Test Loss: 1.429 Test Acc: 0.297
Validation loss decreased (-0.269948 --> -0.296564).  Saving model ...
Epoch: 11 cost time: 1.5146007537841797
Epoch: 11, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.458 Vali Acc: 0.243 Test Loss: 1.458 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.388580083847046
Epoch: 12, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.479 Vali Acc: 0.278 Test Loss: 1.479 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.267204999923706
Epoch: 13, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.459 Vali Acc: 0.243 Test Loss: 1.459 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3884496688842773
Epoch: 14, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.474 Vali Acc: 0.243 Test Loss: 1.474 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4138963222503662
Epoch: 15, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.579 Vali Acc: 0.278 Test Loss: 1.579 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4432485103607178
Epoch: 16, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.510 Vali Acc: 0.251 Test Loss: 1.510 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4431629180908203
Epoch: 17, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.571 Vali Acc: 0.262 Test Loss: 1.571 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.560265064239502
Epoch: 18, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.505 Vali Acc: 0.274 Test Loss: 1.505 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3624229431152344
Epoch: 19, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.614 Vali Acc: 0.270 Test Loss: 1.614 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3440203666687012
Epoch: 20, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.609 Vali Acc: 0.278 Test Loss: 1.609 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm32_nh4_df64_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 42404
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2693729400634766
Epoch: 1, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.391 Vali Acc: 0.243 Test Loss: 1.391 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.5725054740905762
Epoch: 2, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.384 Vali Acc: 0.243 Test Loss: 1.384 Test Acc: 0.243
Validation loss decreased (-0.243332 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 1.574211597442627
Epoch: 3, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.380 Vali Acc: 0.293 Test Loss: 1.380 Test Acc: 0.293
Validation loss decreased (-0.243332 --> -0.292762).  Saving model ...
Epoch: 4 cost time: 1.5749619007110596
Epoch: 4, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.390 Vali Acc: 0.285 Test Loss: 1.390 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5581083297729492
Epoch: 5, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.442 Vali Acc: 0.270 Test Loss: 1.442 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5451579093933105
Epoch: 6, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.453 Vali Acc: 0.240 Test Loss: 1.453 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.526031255722046
Epoch: 7, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.547 Vali Acc: 0.240 Test Loss: 1.547 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5683245658874512
Epoch: 8, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.484 Vali Acc: 0.251 Test Loss: 1.484 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5750336647033691
Epoch: 9, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.497 Vali Acc: 0.232 Test Loss: 1.497 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6163954734802246
Epoch: 10, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.776 Vali Acc: 0.262 Test Loss: 1.776 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4211359024047852
Epoch: 11, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.633 Vali Acc: 0.232 Test Loss: 1.633 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4983751773834229
Epoch: 12, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.512 Vali Acc: 0.232 Test Loss: 1.512 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.366529941558838
Epoch: 13, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.527 Vali Acc: 0.274 Test Loss: 1.527 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 44756
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4179046154022217
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.399 Vali Acc: 0.232 Test Loss: 1.399 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.3836312294006348
Epoch: 2, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.394 Vali Acc: 0.243 Test Loss: 1.394 Test Acc: 0.243
Validation loss decreased (-0.231925 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 1.4423718452453613
Epoch: 3, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.393 Vali Acc: 0.240 Test Loss: 1.393 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5706567764282227
Epoch: 4, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.412 Vali Acc: 0.232 Test Loss: 1.412 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5312893390655518
Epoch: 5, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.411 Vali Acc: 0.243 Test Loss: 1.411 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4679386615753174
Epoch: 6, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.414 Vali Acc: 0.285 Test Loss: 1.414 Test Acc: 0.285
Validation loss decreased (-0.243332 --> -0.285157).  Saving model ...
Epoch: 7 cost time: 1.4414722919464111
Epoch: 7, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.407 Vali Acc: 0.247 Test Loss: 1.407 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.347919225692749
Epoch: 8, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.418 Vali Acc: 0.255 Test Loss: 1.418 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.519113540649414
Epoch: 9, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.404 Vali Acc: 0.255 Test Loss: 1.404 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3993051052093506
Epoch: 10, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.412 Vali Acc: 0.224 Test Loss: 1.412 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.497063159942627
Epoch: 11, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.435 Vali Acc: 0.274 Test Loss: 1.435 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5504534244537354
Epoch: 12, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.459 Vali Acc: 0.259 Test Loss: 1.459 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.514664649963379
Epoch: 13, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.429 Vali Acc: 0.293 Test Loss: 1.429 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292761).  Saving model ...
Epoch: 14 cost time: 1.6034142971038818
Epoch: 14, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.438 Vali Acc: 0.266 Test Loss: 1.438 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6046605110168457
Epoch: 15, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.454 Vali Acc: 0.281 Test Loss: 1.454 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6293601989746094
Epoch: 16, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.443 Vali Acc: 0.281 Test Loss: 1.443 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4047086238861084
Epoch: 17, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.505 Vali Acc: 0.251 Test Loss: 1.505 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7063345909118652
Epoch: 18, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.472 Vali Acc: 0.255 Test Loss: 1.472 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.741980791091919
Epoch: 19, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.520 Vali Acc: 0.255 Test Loss: 1.520 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.601562738418579
Epoch: 20, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.462 Vali Acc: 0.262 Test Loss: 1.462 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5876483917236328
Epoch: 21, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.521 Vali Acc: 0.278 Test Loss: 1.521 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6233384609222412
Epoch: 22, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.542 Vali Acc: 0.285 Test Loss: 1.542 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5379159450531006
Epoch: 23, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.566 Vali Acc: 0.278 Test Loss: 1.566 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 37780
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.451024055480957
Epoch: 1, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.415 Vali Acc: 0.240 Test Loss: 1.415 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.4081330299377441
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.405 Vali Acc: 0.262 Test Loss: 1.405 Test Acc: 0.262
Validation loss decreased (-0.239530 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 1.5087826251983643
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.405 Vali Acc: 0.259 Test Loss: 1.405 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5069670677185059
Epoch: 4, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.400 Vali Acc: 0.224 Test Loss: 1.400 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5885076522827148
Epoch: 5, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.407 Vali Acc: 0.255 Test Loss: 1.407 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.590721845626831
Epoch: 6, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.398 Vali Acc: 0.278 Test Loss: 1.398 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277553).  Saving model ...
Epoch: 7 cost time: 1.3688762187957764
Epoch: 7, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.420 Vali Acc: 0.251 Test Loss: 1.420 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4981696605682373
Epoch: 8, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.415 Vali Acc: 0.270 Test Loss: 1.415 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4726471900939941
Epoch: 9, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.435 Vali Acc: 0.243 Test Loss: 1.435 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.605208158493042
Epoch: 10, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.458 Vali Acc: 0.259 Test Loss: 1.458 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5977494716644287
Epoch: 11, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.488 Vali Acc: 0.247 Test Loss: 1.488 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6216480731964111
Epoch: 12, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.511 Vali Acc: 0.262 Test Loss: 1.511 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4926669597625732
Epoch: 13, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.488 Vali Acc: 0.266 Test Loss: 1.488 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.612755537033081
Epoch: 14, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.459 Vali Acc: 0.232 Test Loss: 1.459 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5299842357635498
Epoch: 15, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.490 Vali Acc: 0.270 Test Loss: 1.490 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5764274597167969
Epoch: 16, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.521 Vali Acc: 0.262 Test Loss: 1.521 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 35988
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.230325698852539
Epoch: 1, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.407 Vali Acc: 0.243 Test Loss: 1.407 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.4375488758087158
Epoch: 2, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.397 Vali Acc: 0.240 Test Loss: 1.397 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3982748985290527
Epoch: 3, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.389 Vali Acc: 0.228 Test Loss: 1.389 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6409144401550293
Epoch: 4, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.402 Vali Acc: 0.266 Test Loss: 1.402 Test Acc: 0.266
Validation loss decreased (-0.243332 --> -0.266146).  Saving model ...
Epoch: 5 cost time: 1.3836793899536133
Epoch: 5, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.392 Vali Acc: 0.270 Test Loss: 1.392 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269948).  Saving model ...
Epoch: 6 cost time: 1.4378974437713623
Epoch: 6, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.396 Vali Acc: 0.255 Test Loss: 1.396 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.535121202468872
Epoch: 7, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.392 Vali Acc: 0.266 Test Loss: 1.392 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4283418655395508
Epoch: 8, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.401 Vali Acc: 0.270 Test Loss: 1.401 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4330835342407227
Epoch: 9, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.401 Vali Acc: 0.255 Test Loss: 1.401 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5579819679260254
Epoch: 10, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.413 Vali Acc: 0.259 Test Loss: 1.413 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4808464050292969
Epoch: 11, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.418 Vali Acc: 0.266 Test Loss: 1.418 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5134217739105225
Epoch: 12, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.419 Vali Acc: 0.255 Test Loss: 1.419 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4948956966400146
Epoch: 13, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.423 Vali Acc: 0.247 Test Loss: 1.423 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5630617141723633
Epoch: 14, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.435 Vali Acc: 0.262 Test Loss: 1.435 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5205800533294678
Epoch: 15, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.470 Vali Acc: 0.240 Test Loss: 1.470 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 35348
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4588749408721924
Epoch: 1, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.394 Vali Acc: 0.293 Test Loss: 1.394 Test Acc: 0.293
Validation loss decreased (inf --> -0.292762).  Saving model ...
Epoch: 2 cost time: 1.6926829814910889
Epoch: 2, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.402 Vali Acc: 0.278 Test Loss: 1.402 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6189484596252441
Epoch: 3, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.395 Vali Acc: 0.274 Test Loss: 1.395 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7508883476257324
Epoch: 4, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.395 Vali Acc: 0.266 Test Loss: 1.395 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3726820945739746
Epoch: 5, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.409 Vali Acc: 0.274 Test Loss: 1.409 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4912035465240479
Epoch: 6, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.403 Vali Acc: 0.278 Test Loss: 1.403 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.579697847366333
Epoch: 7, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.406 Vali Acc: 0.247 Test Loss: 1.406 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4794929027557373
Epoch: 8, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.405 Vali Acc: 0.247 Test Loss: 1.405 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5744681358337402
Epoch: 9, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.427 Vali Acc: 0.251 Test Loss: 1.427 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4399948120117188
Epoch: 10, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.424 Vali Acc: 0.247 Test Loss: 1.424 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.553739070892334
Epoch: 11, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.440 Vali Acc: 0.232 Test Loss: 1.440 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 35588
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4696619510650635
Epoch: 1, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.425 Vali Acc: 0.259 Test Loss: 1.425 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.389641284942627
Epoch: 2, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.410 Vali Acc: 0.259 Test Loss: 1.410 Test Acc: 0.259
Validation loss decreased (-0.258541 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.484726905822754
Epoch: 3, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.414 Vali Acc: 0.247 Test Loss: 1.414 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4939212799072266
Epoch: 4, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.416 Vali Acc: 0.262 Test Loss: 1.416 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 1.397836446762085
Epoch: 5, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.415 Vali Acc: 0.266 Test Loss: 1.415 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266146).  Saving model ...
Epoch: 6 cost time: 1.3273217678070068
Epoch: 6, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.411 Vali Acc: 0.255 Test Loss: 1.411 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.390690803527832
Epoch: 7, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.410 Vali Acc: 0.255 Test Loss: 1.410 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4695870876312256
Epoch: 8, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.411 Vali Acc: 0.243 Test Loss: 1.411 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4477109909057617
Epoch: 9, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.422 Vali Acc: 0.262 Test Loss: 1.422 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5296976566314697
Epoch: 10, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.421 Vali Acc: 0.247 Test Loss: 1.421 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.650336742401123
Epoch: 11, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.430 Vali Acc: 0.262 Test Loss: 1.430 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.53489351272583
Epoch: 12, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.433 Vali Acc: 0.247 Test Loss: 1.433 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6466765403747559
Epoch: 13, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.457 Vali Acc: 0.255 Test Loss: 1.457 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5946331024169922
Epoch: 14, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.461 Vali Acc: 0.247 Test Loss: 1.461 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.502563238143921
Epoch: 15, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.482 Vali Acc: 0.247 Test Loss: 1.482 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 36228
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4334769248962402
Epoch: 1, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.427 Vali Acc: 0.232 Test Loss: 1.427 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.551025629043579
Epoch: 2, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.427 Vali Acc: 0.232 Test Loss: 1.427 Test Acc: 0.232
Validation loss decreased (-0.231925 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 1.50606107711792
Epoch: 3, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.423 Vali Acc: 0.190 Test Loss: 1.423 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4976987838745117
Epoch: 4, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.418 Vali Acc: 0.232 Test Loss: 1.418 Test Acc: 0.232
Validation loss decreased (-0.231925 --> -0.231925).  Saving model ...
Epoch: 5 cost time: 1.592581033706665
Epoch: 5, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
Validation loss decreased (-0.231925 --> -0.235727).  Saving model ...
Epoch: 6 cost time: 1.453763723373413
Epoch: 6, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.410 Vali Acc: 0.232 Test Loss: 1.410 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7086079120635986
Epoch: 7, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.421 Vali Acc: 0.270 Test Loss: 1.421 Test Acc: 0.270
Validation loss decreased (-0.235727 --> -0.269948).  Saving model ...
Epoch: 8 cost time: 1.3853132724761963
Epoch: 8, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.416 Vali Acc: 0.217 Test Loss: 1.416 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6272470951080322
Epoch: 9, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.425 Vali Acc: 0.285 Test Loss: 1.425 Test Acc: 0.285
Validation loss decreased (-0.269948 --> -0.285157).  Saving model ...
Epoch: 10 cost time: 1.6180484294891357
Epoch: 10, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.437 Vali Acc: 0.221 Test Loss: 1.437 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.560546636581421
Epoch: 11, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.429 Vali Acc: 0.270 Test Loss: 1.429 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3674492835998535
Epoch: 12, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.441 Vali Acc: 0.270 Test Loss: 1.441 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4661834239959717
Epoch: 13, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.445 Vali Acc: 0.240 Test Loss: 1.445 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7387139797210693
Epoch: 14, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.459 Vali Acc: 0.247 Test Loss: 1.459 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5064682960510254
Epoch: 15, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.463 Vali Acc: 0.251 Test Loss: 1.463 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5798680782318115
Epoch: 16, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.471 Vali Acc: 0.232 Test Loss: 1.471 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4273128509521484
Epoch: 17, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.497 Vali Acc: 0.240 Test Loss: 1.497 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.571786880493164
Epoch: 18, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.608 Vali Acc: 0.274 Test Loss: 1.608 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6600630283355713
Epoch: 19, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.485 Vali Acc: 0.262 Test Loss: 1.485 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df256_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 37236
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9134786128997803
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.412 Vali Acc: 0.247 Test Loss: 1.412 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.654764175415039
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.403 Vali Acc: 0.240 Test Loss: 1.403 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.932096242904663
Epoch: 3, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.412 Vali Acc: 0.270 Test Loss: 1.412 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 1.6694056987762451
Epoch: 4, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.436 Vali Acc: 0.274 Test Loss: 1.436 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 1.800513505935669
Epoch: 5, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.400 Vali Acc: 0.297 Test Loss: 1.400 Test Acc: 0.297
Validation loss decreased (-0.273750 --> -0.296564).  Saving model ...
Epoch: 6 cost time: 1.9366378784179688
Epoch: 6, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.399 Vali Acc: 0.281 Test Loss: 1.399 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.798959493637085
Epoch: 7, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.448 Vali Acc: 0.278 Test Loss: 1.448 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5710954666137695
Epoch: 8, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.598 Vali Acc: 0.247 Test Loss: 1.598 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6371548175811768
Epoch: 9, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.546 Vali Acc: 0.251 Test Loss: 1.546 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8686349391937256
Epoch: 10, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.458 Vali Acc: 0.270 Test Loss: 1.458 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6101741790771484
Epoch: 11, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.462 Vali Acc: 0.228 Test Loss: 1.462 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7190046310424805
Epoch: 12, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.454 Vali Acc: 0.262 Test Loss: 1.454 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.511122703552246
Epoch: 13, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.477 Vali Acc: 0.274 Test Loss: 1.477 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6452341079711914
Epoch: 14, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.489 Vali Acc: 0.259 Test Loss: 1.489 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5967674255371094
Epoch: 15, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.447 Vali Acc: 0.251 Test Loss: 1.447 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 32084
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.389554023742676
Epoch: 1, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.413 Vali Acc: 0.270 Test Loss: 1.413 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.5274882316589355
Epoch: 2, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.400 Vali Acc: 0.255 Test Loss: 1.400 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7171573638916016
Epoch: 3, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.403 Vali Acc: 0.270 Test Loss: 1.403 Test Acc: 0.270
Validation loss decreased (-0.269948 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 1.5894572734832764
Epoch: 4, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.393 Vali Acc: 0.262 Test Loss: 1.393 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.666602611541748
Epoch: 5, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.398 Vali Acc: 0.243 Test Loss: 1.398 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5894145965576172
Epoch: 6, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.394 Vali Acc: 0.262 Test Loss: 1.394 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.683516263961792
Epoch: 7, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4331724643707275
Epoch: 8, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.440 Vali Acc: 0.262 Test Loss: 1.440 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7498538494110107
Epoch: 9, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.407 Vali Acc: 0.270 Test Loss: 1.407 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5220286846160889
Epoch: 10, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.400 Vali Acc: 0.259 Test Loss: 1.400 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7359910011291504
Epoch: 11, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.448 Vali Acc: 0.274 Test Loss: 1.448 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273750).  Saving model ...
Epoch: 12 cost time: 1.552910566329956
Epoch: 12, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.423 Vali Acc: 0.243 Test Loss: 1.423 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5481960773468018
Epoch: 13, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.410 Vali Acc: 0.270 Test Loss: 1.410 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5263848304748535
Epoch: 14, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.435 Vali Acc: 0.251 Test Loss: 1.435 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6583828926086426
Epoch: 15, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.440 Vali Acc: 0.255 Test Loss: 1.440 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6661572456359863
Epoch: 16, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.477 Vali Acc: 0.262 Test Loss: 1.477 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5794427394866943
Epoch: 17, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.436 Vali Acc: 0.262 Test Loss: 1.436 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7870759963989258
Epoch: 18, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.509 Vali Acc: 0.270 Test Loss: 1.509 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4516630172729492
Epoch: 19, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.484 Vali Acc: 0.270 Test Loss: 1.484 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6928517818450928
Epoch: 20, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.467 Vali Acc: 0.247 Test Loss: 1.467 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.524597406387329
Epoch: 21, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.489 Vali Acc: 0.255 Test Loss: 1.489 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 25108
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2761216163635254
Epoch: 1, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.449 Vali Acc: 0.236 Test Loss: 1.449 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.3992090225219727
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.428 Vali Acc: 0.228 Test Loss: 1.428 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6406676769256592
Epoch: 3, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.443 Vali Acc: 0.232 Test Loss: 1.443 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4158706665039062
Epoch: 4, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.431 Vali Acc: 0.228 Test Loss: 1.431 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7429208755493164
Epoch: 5, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.423 Vali Acc: 0.232 Test Loss: 1.423 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5909507274627686
Epoch: 6, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.423 Vali Acc: 0.236 Test Loss: 1.423 Test Acc: 0.236
Validation loss decreased (-0.235727 --> -0.235727).  Saving model ...
Epoch: 7 cost time: 1.6571009159088135
Epoch: 7, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.431 Vali Acc: 0.243 Test Loss: 1.431 Test Acc: 0.243
Validation loss decreased (-0.235727 --> -0.243332).  Saving model ...
Epoch: 8 cost time: 1.6196060180664062
Epoch: 8, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.421 Vali Acc: 0.259 Test Loss: 1.421 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258541).  Saving model ...
Epoch: 9 cost time: 1.484802484512329
Epoch: 9, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.438 Vali Acc: 0.255 Test Loss: 1.438 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5456182956695557
Epoch: 10, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.427 Vali Acc: 0.255 Test Loss: 1.427 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6354811191558838
Epoch: 11, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.469 Vali Acc: 0.240 Test Loss: 1.469 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7458667755126953
Epoch: 12, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.446 Vali Acc: 0.278 Test Loss: 1.446 Test Acc: 0.278
Validation loss decreased (-0.258541 --> -0.277552).  Saving model ...
Epoch: 13 cost time: 1.6401517391204834
Epoch: 13, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.467 Vali Acc: 0.255 Test Loss: 1.467 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.955949306488037
Epoch: 14, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.462 Vali Acc: 0.266 Test Loss: 1.462 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7472925186157227
Epoch: 15, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.472 Vali Acc: 0.255 Test Loss: 1.472 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7947537899017334
Epoch: 16, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.476 Vali Acc: 0.255 Test Loss: 1.476 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9396438598632812
Epoch: 17, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.506 Vali Acc: 0.262 Test Loss: 1.506 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7875263690948486
Epoch: 18, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.510 Vali Acc: 0.278 Test Loss: 1.510 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8700554370880127
Epoch: 19, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.543 Vali Acc: 0.259 Test Loss: 1.543 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7630071640014648
Epoch: 20, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.576 Vali Acc: 0.262 Test Loss: 1.576 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6825993061065674
Epoch: 21, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.587 Vali Acc: 0.262 Test Loss: 1.587 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.872847080230713
Epoch: 22, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.534 Vali Acc: 0.251 Test Loss: 1.534 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 23316
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.263883590698242
Epoch: 1, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.408 Vali Acc: 0.251 Test Loss: 1.408 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.4274249076843262
Epoch: 2, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.409 Vali Acc: 0.236 Test Loss: 1.409 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5178661346435547
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.410 Vali Acc: 0.243 Test Loss: 1.410 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.497065782546997
Epoch: 4, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.414 Vali Acc: 0.232 Test Loss: 1.414 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6431283950805664
Epoch: 5, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.409 Vali Acc: 0.259 Test Loss: 1.409 Test Acc: 0.259
Validation loss decreased (-0.250936 --> -0.258541).  Saving model ...
Epoch: 6 cost time: 1.4978322982788086
Epoch: 6, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.405 Vali Acc: 0.266 Test Loss: 1.405 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 7 cost time: 1.684779167175293
Epoch: 7, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.410 Vali Acc: 0.259 Test Loss: 1.410 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5389599800109863
Epoch: 8, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.418 Vali Acc: 0.255 Test Loss: 1.418 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7084388732910156
Epoch: 9, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.420 Vali Acc: 0.278 Test Loss: 1.420 Test Acc: 0.278
Validation loss decreased (-0.266146 --> -0.277552).  Saving model ...
Epoch: 10 cost time: 1.7020769119262695
Epoch: 10, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.420 Vali Acc: 0.281 Test Loss: 1.420 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281355).  Saving model ...
Epoch: 11 cost time: 1.6752614974975586
Epoch: 11, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.415 Vali Acc: 0.259 Test Loss: 1.415 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.756610631942749
Epoch: 12, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.467 Vali Acc: 0.228 Test Loss: 1.467 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.398406982421875
Epoch: 13, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.441 Vali Acc: 0.217 Test Loss: 1.441 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5612919330596924
Epoch: 14, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.457 Vali Acc: 0.259 Test Loss: 1.457 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5107922554016113
Epoch: 15, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.470 Vali Acc: 0.228 Test Loss: 1.470 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6742331981658936
Epoch: 16, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.473 Vali Acc: 0.270 Test Loss: 1.473 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7102549076080322
Epoch: 17, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.483 Vali Acc: 0.240 Test Loss: 1.483 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.570056438446045
Epoch: 18, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.514 Vali Acc: 0.255 Test Loss: 1.514 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.675590991973877
Epoch: 19, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.510 Vali Acc: 0.259 Test Loss: 1.510 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6136081218719482
Epoch: 20, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.533 Vali Acc: 0.224 Test Loss: 1.533 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 22676
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7096502780914307
Epoch: 1, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.416 Vali Acc: 0.236 Test Loss: 1.416 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.7277371883392334
Epoch: 2, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.427 Vali Acc: 0.255 Test Loss: 1.427 Test Acc: 0.255
Validation loss decreased (-0.235727 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.666856050491333
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.409 Vali Acc: 0.266 Test Loss: 1.409 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.7693052291870117
Epoch: 4, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.409 Vali Acc: 0.240 Test Loss: 1.409 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.547015905380249
Epoch: 5, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.412 Vali Acc: 0.255 Test Loss: 1.412 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6417877674102783
Epoch: 6, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.405 Vali Acc: 0.243 Test Loss: 1.405 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8187673091888428
Epoch: 7, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.408 Vali Acc: 0.247 Test Loss: 1.408 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.528602123260498
Epoch: 8, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.419 Vali Acc: 0.243 Test Loss: 1.419 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5398025512695312
Epoch: 9, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.408 Vali Acc: 0.251 Test Loss: 1.408 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6440916061401367
Epoch: 10, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.413 Vali Acc: 0.262 Test Loss: 1.413 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5910484790802002
Epoch: 11, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.414 Vali Acc: 0.232 Test Loss: 1.414 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6839749813079834
Epoch: 12, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.433 Vali Acc: 0.251 Test Loss: 1.433 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6272096633911133
Epoch: 13, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.419 Vali Acc: 0.240 Test Loss: 1.419 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 22916
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3873207569122314
Epoch: 1, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.428 Vali Acc: 0.228 Test Loss: 1.428 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 1.6558051109313965
Epoch: 2, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.407 Vali Acc: 0.270 Test Loss: 1.407 Test Acc: 0.270
Validation loss decreased (-0.228123 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 1.4212279319763184
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.408 Vali Acc: 0.221 Test Loss: 1.408 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7238080501556396
Epoch: 4, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.410 Vali Acc: 0.232 Test Loss: 1.410 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.566765308380127
Epoch: 5, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.407 Vali Acc: 0.247 Test Loss: 1.407 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8438856601715088
Epoch: 6, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.404 Vali Acc: 0.240 Test Loss: 1.404 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.807988166809082
Epoch: 7, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.408 Vali Acc: 0.262 Test Loss: 1.408 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.697859525680542
Epoch: 8, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.420 Vali Acc: 0.228 Test Loss: 1.420 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6759397983551025
Epoch: 9, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.415 Vali Acc: 0.259 Test Loss: 1.415 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.534965991973877
Epoch: 10, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.416 Vali Acc: 0.228 Test Loss: 1.416 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6120734214782715
Epoch: 11, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.422 Vali Acc: 0.266 Test Loss: 1.422 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5583629608154297
Epoch: 12, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.447 Vali Acc: 0.247 Test Loss: 1.447 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 23556
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1677958965301514
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.394 Vali Acc: 0.278 Test Loss: 1.394 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 1.448070764541626
Epoch: 2, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.388 Vali Acc: 0.259 Test Loss: 1.388 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5906033515930176
Epoch: 3, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.377 Vali Acc: 0.281 Test Loss: 1.377 Test Acc: 0.281
Validation loss decreased (-0.277553 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 1.6046924591064453
Epoch: 4, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.378 Vali Acc: 0.312 Test Loss: 1.378 Test Acc: 0.312
Validation loss decreased (-0.281355 --> -0.311773).  Saving model ...
Epoch: 5 cost time: 1.5790643692016602
Epoch: 5, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.380 Vali Acc: 0.293 Test Loss: 1.380 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5379281044006348
Epoch: 6, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5799827575683594
Epoch: 7, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.385 Vali Acc: 0.247 Test Loss: 1.385 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.643104076385498
Epoch: 8, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.399 Vali Acc: 0.259 Test Loss: 1.399 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.320655107498169
Epoch: 9, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.392 Vali Acc: 0.274 Test Loss: 1.392 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.626746416091919
Epoch: 10, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.403 Vali Acc: 0.262 Test Loss: 1.403 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.561619758605957
Epoch: 11, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.413 Vali Acc: 0.266 Test Loss: 1.413 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5803868770599365
Epoch: 12, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.429 Vali Acc: 0.270 Test Loss: 1.429 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4100570678710938
Epoch: 13, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.411 Vali Acc: 0.247 Test Loss: 1.411 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5305204391479492
Epoch: 14, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.435 Vali Acc: 0.232 Test Loss: 1.435 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df128_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 24564
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3347008228302
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.410 Vali Acc: 0.247 Test Loss: 1.410 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.3641350269317627
Epoch: 2, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.388 Vali Acc: 0.232 Test Loss: 1.388 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3992934226989746
Epoch: 3, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.402 Vali Acc: 0.281 Test Loss: 1.402 Test Acc: 0.281
Validation loss decreased (-0.247134 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 1.4869937896728516
Epoch: 4, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.482 Vali Acc: 0.259 Test Loss: 1.482 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4023804664611816
Epoch: 5, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.486 Vali Acc: 0.259 Test Loss: 1.486 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.516242265701294
Epoch: 6, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.503 Vali Acc: 0.274 Test Loss: 1.503 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5841832160949707
Epoch: 7, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.433 Vali Acc: 0.262 Test Loss: 1.433 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5984928607940674
Epoch: 8, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.434 Vali Acc: 0.240 Test Loss: 1.434 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.626967191696167
Epoch: 9, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.454 Vali Acc: 0.262 Test Loss: 1.454 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4488866329193115
Epoch: 10, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.495 Vali Acc: 0.255 Test Loss: 1.495 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4439544677734375
Epoch: 11, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.524 Vali Acc: 0.274 Test Loss: 1.524 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5118153095245361
Epoch: 12, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.534 Vali Acc: 0.262 Test Loss: 1.534 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5296802520751953
Epoch: 13, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.444 Vali Acc: 0.221 Test Loss: 1.444 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 25748
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.411062002182007
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.408 Vali Acc: 0.236 Test Loss: 1.408 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.3914034366607666
Epoch: 2, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.427 Vali Acc: 0.251 Test Loss: 1.427 Test Acc: 0.251
Validation loss decreased (-0.235727 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 1.4560058116912842
Epoch: 3, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.412 Vali Acc: 0.262 Test Loss: 1.412 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.3351209163665771
Epoch: 4, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.424 Vali Acc: 0.224 Test Loss: 1.424 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4727952480316162
Epoch: 5, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.408 Vali Acc: 0.255 Test Loss: 1.408 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3261175155639648
Epoch: 6, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.430 Vali Acc: 0.236 Test Loss: 1.430 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3937044143676758
Epoch: 7, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.418 Vali Acc: 0.236 Test Loss: 1.418 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.33133864402771
Epoch: 8, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.433 Vali Acc: 0.278 Test Loss: 1.433 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277552).  Saving model ...
Epoch: 9 cost time: 1.3280799388885498
Epoch: 9, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.451 Vali Acc: 0.243 Test Loss: 1.451 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3945412635803223
Epoch: 10, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.436 Vali Acc: 0.274 Test Loss: 1.436 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4142343997955322
Epoch: 11, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.466 Vali Acc: 0.255 Test Loss: 1.466 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2679977416992188
Epoch: 12, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.456 Vali Acc: 0.232 Test Loss: 1.456 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2949531078338623
Epoch: 13, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.443 Vali Acc: 0.243 Test Loss: 1.443 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3436570167541504
Epoch: 14, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.535 Vali Acc: 0.262 Test Loss: 1.535 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.287431001663208
Epoch: 15, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.475 Vali Acc: 0.266 Test Loss: 1.475 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4414751529693604
Epoch: 16, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.558 Vali Acc: 0.247 Test Loss: 1.558 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2591185569763184
Epoch: 17, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.476 Vali Acc: 0.224 Test Loss: 1.476 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4982376098632812
Epoch: 18, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.530 Vali Acc: 0.266 Test Loss: 1.530 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 18772
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.233977794647217
Epoch: 1, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.398 Vali Acc: 0.255 Test Loss: 1.398 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.4794707298278809
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.401 Vali Acc: 0.285 Test Loss: 1.401 Test Acc: 0.285
Validation loss decreased (-0.254739 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 1.4161758422851562
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.392 Vali Acc: 0.308 Test Loss: 1.392 Test Acc: 0.308
Validation loss decreased (-0.285157 --> -0.307971).  Saving model ...
Epoch: 4 cost time: 1.483276605606079
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.398 Vali Acc: 0.259 Test Loss: 1.398 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5040814876556396
Epoch: 5, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.396 Vali Acc: 0.251 Test Loss: 1.396 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3730974197387695
Epoch: 6, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.398 Vali Acc: 0.274 Test Loss: 1.398 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4317126274108887
Epoch: 7, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.401 Vali Acc: 0.289 Test Loss: 1.401 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5111947059631348
Epoch: 8, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.402 Vali Acc: 0.251 Test Loss: 1.402 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3949508666992188
Epoch: 9, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.409 Vali Acc: 0.243 Test Loss: 1.409 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.442793846130371
Epoch: 10, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.415 Vali Acc: 0.285 Test Loss: 1.415 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5271975994110107
Epoch: 11, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.433 Vali Acc: 0.281 Test Loss: 1.433 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4732859134674072
Epoch: 12, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.455 Vali Acc: 0.251 Test Loss: 1.455 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4031267166137695
Epoch: 13, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.441 Vali Acc: 0.274 Test Loss: 1.441 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 16980
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.52256441116333
Epoch: 1, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.395 Vali Acc: 0.255 Test Loss: 1.395 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.2396714687347412
Epoch: 2, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.400 Vali Acc: 0.247 Test Loss: 1.400 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2558841705322266
Epoch: 3, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.393 Vali Acc: 0.224 Test Loss: 1.393 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5002968311309814
Epoch: 4, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.384 Vali Acc: 0.308 Test Loss: 1.384 Test Acc: 0.308
Validation loss decreased (-0.254739 --> -0.307971).  Saving model ...
Epoch: 5 cost time: 1.5053985118865967
Epoch: 5, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.388 Vali Acc: 0.262 Test Loss: 1.388 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.542365312576294
Epoch: 6, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.385 Vali Acc: 0.281 Test Loss: 1.385 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5544052124023438
Epoch: 7, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.386 Vali Acc: 0.289 Test Loss: 1.386 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3618602752685547
Epoch: 8, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.391 Vali Acc: 0.285 Test Loss: 1.391 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3672904968261719
Epoch: 9, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.391 Vali Acc: 0.274 Test Loss: 1.391 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.410818099975586
Epoch: 10, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.388 Vali Acc: 0.274 Test Loss: 1.388 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.423036813735962
Epoch: 11, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.405 Vali Acc: 0.262 Test Loss: 1.405 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3131167888641357
Epoch: 12, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.410 Vali Acc: 0.270 Test Loss: 1.410 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3661813735961914
Epoch: 13, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.423 Vali Acc: 0.289 Test Loss: 1.423 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4979286193847656
Epoch: 14, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.404 Vali Acc: 0.262 Test Loss: 1.404 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 16340
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3001651763916016
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.4257445335388184
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.423 Vali Acc: 0.266 Test Loss: 1.423 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 1.575312614440918
Epoch: 3, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.411 Vali Acc: 0.259 Test Loss: 1.411 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3365585803985596
Epoch: 4, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.416 Vali Acc: 0.259 Test Loss: 1.416 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.521122932434082
Epoch: 5, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.426 Vali Acc: 0.240 Test Loss: 1.426 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4185764789581299
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.426 Vali Acc: 0.243 Test Loss: 1.426 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5017695426940918
Epoch: 7, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.410 Vali Acc: 0.259 Test Loss: 1.410 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4306724071502686
Epoch: 8, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.413 Vali Acc: 0.240 Test Loss: 1.413 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4728729724884033
Epoch: 9, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.422 Vali Acc: 0.228 Test Loss: 1.422 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4887020587921143
Epoch: 10, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.416 Vali Acc: 0.232 Test Loss: 1.416 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5533506870269775
Epoch: 11, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.425 Vali Acc: 0.236 Test Loss: 1.425 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.426866054534912
Epoch: 12, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.429 Vali Acc: 0.243 Test Loss: 1.429 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 16580
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3388121128082275
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.412 Vali Acc: 0.247 Test Loss: 1.412 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.5323562622070312
Epoch: 2, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.413 Vali Acc: 0.232 Test Loss: 1.413 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1488502025604248
Epoch: 3, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.410 Vali Acc: 0.281 Test Loss: 1.410 Test Acc: 0.281
Validation loss decreased (-0.247134 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 1.3330461978912354
Epoch: 4, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.407 Vali Acc: 0.232 Test Loss: 1.407 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4100170135498047
Epoch: 5, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.417 Vali Acc: 0.281 Test Loss: 1.417 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3508269786834717
Epoch: 6, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.417 Vali Acc: 0.243 Test Loss: 1.417 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3827266693115234
Epoch: 7, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.406 Vali Acc: 0.240 Test Loss: 1.406 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4519484043121338
Epoch: 8, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.443 Vali Acc: 0.266 Test Loss: 1.443 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4777982234954834
Epoch: 9, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.415 Vali Acc: 0.217 Test Loss: 1.415 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5712800025939941
Epoch: 10, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.413 Vali Acc: 0.228 Test Loss: 1.413 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6158759593963623
Epoch: 11, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.432 Vali Acc: 0.236 Test Loss: 1.432 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6362278461456299
Epoch: 12, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.442 Vali Acc: 0.247 Test Loss: 1.442 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5179600715637207
Epoch: 13, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.446 Vali Acc: 0.202 Test Loss: 1.446 Test Acc: 0.202
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 17220
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3892083168029785
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.438 Vali Acc: 0.221 Test Loss: 1.438 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 1.5872101783752441
Epoch: 2, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.430 Vali Acc: 0.232 Test Loss: 1.430 Test Acc: 0.232
Validation loss decreased (-0.220518 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 1.5694231986999512
Epoch: 3, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.423 Vali Acc: 0.251 Test Loss: 1.423 Test Acc: 0.251
Validation loss decreased (-0.231925 --> -0.250936).  Saving model ...
Epoch: 4 cost time: 1.5974655151367188
Epoch: 4, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.430 Vali Acc: 0.243 Test Loss: 1.430 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5307648181915283
Epoch: 5, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.414 Vali Acc: 0.232 Test Loss: 1.414 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.394775629043579
Epoch: 6, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.422 Vali Acc: 0.194 Test Loss: 1.422 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3535590171813965
Epoch: 7, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.417 Vali Acc: 0.221 Test Loss: 1.417 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.619551658630371
Epoch: 8, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.415 Vali Acc: 0.224 Test Loss: 1.415 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3526501655578613
Epoch: 9, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.424 Vali Acc: 0.236 Test Loss: 1.424 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3813626766204834
Epoch: 10, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.421 Vali Acc: 0.259 Test Loss: 1.421 Test Acc: 0.259
Validation loss decreased (-0.250936 --> -0.258541).  Saving model ...
Epoch: 11 cost time: 1.4269154071807861
Epoch: 11, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.438 Vali Acc: 0.255 Test Loss: 1.438 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4222660064697266
Epoch: 12, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.425 Vali Acc: 0.236 Test Loss: 1.425 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3485565185546875
Epoch: 13, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.457 Vali Acc: 0.255 Test Loss: 1.457 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4922316074371338
Epoch: 14, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.439 Vali Acc: 0.247 Test Loss: 1.439 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4944186210632324
Epoch: 15, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.465 Vali Acc: 0.285 Test Loss: 1.465 Test Acc: 0.285
Validation loss decreased (-0.258541 --> -0.285156).  Saving model ...
Epoch: 16 cost time: 1.3978984355926514
Epoch: 16, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.441 Vali Acc: 0.247 Test Loss: 1.441 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5862987041473389
Epoch: 17, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.447 Vali Acc: 0.247 Test Loss: 1.447 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.40828275680542
Epoch: 18, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.462 Vali Acc: 0.240 Test Loss: 1.462 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4654154777526855
Epoch: 19, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.484 Vali Acc: 0.270 Test Loss: 1.484 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.452279806137085
Epoch: 20, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.475 Vali Acc: 0.281 Test Loss: 1.475 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4884145259857178
Epoch: 21, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.546 Vali Acc: 0.240 Test Loss: 1.546 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.476630687713623
Epoch: 22, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.480 Vali Acc: 0.293 Test Loss: 1.480 Test Acc: 0.293
Validation loss decreased (-0.285156 --> -0.292761).  Saving model ...
Epoch: 23 cost time: 1.47666597366333
Epoch: 23, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.570 Vali Acc: 0.270 Test Loss: 1.570 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.410653829574585
Epoch: 24, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.526 Vali Acc: 0.228 Test Loss: 1.526 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.516880989074707
Epoch: 25, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.512 Vali Acc: 0.240 Test Loss: 1.512 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4469611644744873
Epoch: 26, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.509 Vali Acc: 0.262 Test Loss: 1.509 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2572760581970215
Epoch: 27, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.557 Vali Acc: 0.289 Test Loss: 1.557 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1917486190795898
Epoch: 28, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.564 Vali Acc: 0.247 Test Loss: 1.564 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.482074499130249
Epoch: 29, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.647 Vali Acc: 0.251 Test Loss: 1.647 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4730448722839355
Epoch: 30, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.622 Vali Acc: 0.278 Test Loss: 1.622 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6736371517181396
Epoch: 31, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.546 Vali Acc: 0.255 Test Loss: 1.546 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.5834956169128418
Epoch: 32, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.697 Vali Acc: 0.247 Test Loss: 1.697 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el3_dm16_nh4_df64_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 18228
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8901431560516357
Epoch: 1, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.593 Vali Acc: 0.251 Test Loss: 1.593 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 1.8663721084594727
Epoch: 2, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.680 Vali Acc: 0.285 Test Loss: 1.680 Test Acc: 0.285
Validation loss decreased (-0.250935 --> -0.285154).  Saving model ...
Epoch: 3 cost time: 1.8510427474975586
Epoch: 3, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.743 Vali Acc: 0.228 Test Loss: 1.743 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.97359299659729
Epoch: 4, Steps: 17 | Train Loss: 1.439 Vali Loss: 2.336 Vali Acc: 0.251 Test Loss: 2.336 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9520480632781982
Epoch: 5, Steps: 17 | Train Loss: 1.726 Vali Loss: 2.095 Vali Acc: 0.255 Test Loss: 2.095 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.841059684753418
Epoch: 6, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.669 Vali Acc: 0.281 Test Loss: 1.669 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8656249046325684
Epoch: 7, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.905 Vali Acc: 0.262 Test Loss: 1.905 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.793607234954834
Epoch: 8, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.978 Vali Acc: 0.224 Test Loss: 1.978 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8522062301635742
Epoch: 9, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.707 Vali Acc: 0.224 Test Loss: 1.707 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9129538536071777
Epoch: 10, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.882 Vali Acc: 0.224 Test Loss: 1.882 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9038012027740479
Epoch: 11, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.974 Vali Acc: 0.270 Test Loss: 1.974 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9458703994750977
Epoch: 12, Steps: 17 | Train Loss: 1.291 Vali Loss: 2.850 Vali Acc: 0.259 Test Loss: 2.850 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 392196
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5943996906280518
Epoch: 1, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.423 Vali Acc: 0.251 Test Loss: 1.423 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.6893422603607178
Epoch: 2, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.460 Vali Acc: 0.236 Test Loss: 1.460 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8487648963928223
Epoch: 3, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.539 Vali Acc: 0.243 Test Loss: 1.539 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9021873474121094
Epoch: 4, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.454 Vali Acc: 0.247 Test Loss: 1.454 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7008280754089355
Epoch: 5, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.698 Vali Acc: 0.243 Test Loss: 1.698 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7642970085144043
Epoch: 6, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.624 Vali Acc: 0.251 Test Loss: 1.624 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8546907901763916
Epoch: 7, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.753 Vali Acc: 0.232 Test Loss: 1.753 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.3043909072875977
Epoch: 8, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.612 Vali Acc: 0.228 Test Loss: 1.612 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7819788455963135
Epoch: 9, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.652 Vali Acc: 0.224 Test Loss: 1.652 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9103617668151855
Epoch: 10, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.748 Vali Acc: 0.255 Test Loss: 1.748 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254735).  Saving model ...
Epoch: 11 cost time: 1.7091786861419678
Epoch: 11, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.902 Vali Acc: 0.255 Test Loss: 1.902 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9596121311187744
Epoch: 12, Steps: 17 | Train Loss: 1.001 Vali Loss: 2.014 Vali Acc: 0.270 Test Loss: 2.014 Test Acc: 0.270
Validation loss decreased (-0.254735 --> -0.269942).  Saving model ...
Epoch: 13 cost time: 2.0495781898498535
Epoch: 13, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.747 Vali Acc: 0.266 Test Loss: 1.747 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9883897304534912
Epoch: 14, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.947 Vali Acc: 0.236 Test Loss: 1.947 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.041459560394287
Epoch: 15, Steps: 17 | Train Loss: 1.071 Vali Loss: 2.424 Vali Acc: 0.262 Test Loss: 2.424 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0477988719940186
Epoch: 16, Steps: 17 | Train Loss: 0.935 Vali Loss: 2.288 Vali Acc: 0.251 Test Loss: 2.288 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1422133445739746
Epoch: 17, Steps: 17 | Train Loss: 1.087 Vali Loss: 2.408 Vali Acc: 0.247 Test Loss: 2.408 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9359056949615479
Epoch: 18, Steps: 17 | Train Loss: 0.958 Vali Loss: 2.529 Vali Acc: 0.243 Test Loss: 2.529 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8205485343933105
Epoch: 19, Steps: 17 | Train Loss: 0.958 Vali Loss: 2.591 Vali Acc: 0.266 Test Loss: 2.591 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8872933387756348
Epoch: 20, Steps: 17 | Train Loss: 0.949 Vali Loss: 2.383 Vali Acc: 0.236 Test Loss: 2.383 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8420286178588867
Epoch: 21, Steps: 17 | Train Loss: 0.842 Vali Loss: 2.302 Vali Acc: 0.243 Test Loss: 2.302 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7089738845825195
Epoch: 22, Steps: 17 | Train Loss: 0.856 Vali Loss: 2.487 Vali Acc: 0.232 Test Loss: 2.487 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 336388
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3698205947875977
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.429 Vali Acc: 0.251 Test Loss: 1.429 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.7766711711883545
Epoch: 2, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.500 Vali Acc: 0.240 Test Loss: 1.500 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.785536766052246
Epoch: 3, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.491 Vali Acc: 0.255 Test Loss: 1.491 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254738).  Saving model ...
Epoch: 4 cost time: 1.7540252208709717
Epoch: 4, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.473 Vali Acc: 0.251 Test Loss: 1.473 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7601866722106934
Epoch: 5, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.541 Vali Acc: 0.221 Test Loss: 1.541 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6867170333862305
Epoch: 6, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.623 Vali Acc: 0.259 Test Loss: 1.623 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258539).  Saving model ...
Epoch: 7 cost time: 1.7181682586669922
Epoch: 7, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.504 Vali Acc: 0.243 Test Loss: 1.504 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9472718238830566
Epoch: 8, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.545 Vali Acc: 0.247 Test Loss: 1.545 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7747893333435059
Epoch: 9, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.674 Vali Acc: 0.266 Test Loss: 1.674 Test Acc: 0.266
Validation loss decreased (-0.258539 --> -0.266143).  Saving model ...
Epoch: 10 cost time: 1.8790030479431152
Epoch: 10, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.616 Vali Acc: 0.224 Test Loss: 1.616 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7418904304504395
Epoch: 11, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.750 Vali Acc: 0.259 Test Loss: 1.750 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6082572937011719
Epoch: 12, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.711 Vali Acc: 0.281 Test Loss: 1.711 Test Acc: 0.281
Validation loss decreased (-0.266143 --> -0.281352).  Saving model ...
Epoch: 13 cost time: 1.6810355186462402
Epoch: 13, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.779 Vali Acc: 0.262 Test Loss: 1.779 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6846883296966553
Epoch: 14, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.896 Vali Acc: 0.236 Test Loss: 1.896 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7778310775756836
Epoch: 15, Steps: 17 | Train Loss: 1.026 Vali Loss: 2.056 Vali Acc: 0.243 Test Loss: 2.056 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8682591915130615
Epoch: 16, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.971 Vali Acc: 0.247 Test Loss: 1.971 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7489697933197021
Epoch: 17, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.979 Vali Acc: 0.224 Test Loss: 1.979 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6674988269805908
Epoch: 18, Steps: 17 | Train Loss: 0.890 Vali Loss: 1.986 Vali Acc: 0.247 Test Loss: 1.986 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8176169395446777
Epoch: 19, Steps: 17 | Train Loss: 0.874 Vali Loss: 2.057 Vali Acc: 0.274 Test Loss: 2.057 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7370963096618652
Epoch: 20, Steps: 17 | Train Loss: 0.920 Vali Loss: 2.322 Vali Acc: 0.270 Test Loss: 2.322 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7561976909637451
Epoch: 21, Steps: 17 | Train Loss: 0.938 Vali Loss: 2.299 Vali Acc: 0.274 Test Loss: 2.299 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6317834854125977
Epoch: 22, Steps: 17 | Train Loss: 0.878 Vali Loss: 2.179 Vali Acc: 0.240 Test Loss: 2.179 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 322052
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.026423215866089
Epoch: 1, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.460 Vali Acc: 0.240 Test Loss: 1.460 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 1.1092467308044434
Epoch: 2, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.470 Vali Acc: 0.270 Test Loss: 1.470 Test Acc: 0.270
Validation loss decreased (-0.239529 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 1.1663718223571777
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.438 Vali Acc: 0.243 Test Loss: 1.438 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.033355474472046
Epoch: 4, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.960 Vali Acc: 0.243 Test Loss: 1.960 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9103837013244629
Epoch: 5, Steps: 17 | Train Loss: 1.553 Vali Loss: 1.468 Vali Acc: 0.274 Test Loss: 1.468 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273750).  Saving model ...
Epoch: 6 cost time: 0.9338936805725098
Epoch: 6, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.539 Vali Acc: 0.281 Test Loss: 1.539 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281353).  Saving model ...
Epoch: 7 cost time: 0.9473333358764648
Epoch: 7, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.499 Vali Acc: 0.255 Test Loss: 1.499 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9940600395202637
Epoch: 8, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.546 Vali Acc: 0.251 Test Loss: 1.546 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0390069484710693
Epoch: 9, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.612 Vali Acc: 0.270 Test Loss: 1.612 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0117950439453125
Epoch: 10, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.650 Vali Acc: 0.274 Test Loss: 1.650 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.016284465789795
Epoch: 11, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.739 Vali Acc: 0.236 Test Loss: 1.739 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0682363510131836
Epoch: 12, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.599 Vali Acc: 0.224 Test Loss: 1.599 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0907464027404785
Epoch: 13, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.939 Vali Acc: 0.247 Test Loss: 1.939 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0173704624176025
Epoch: 14, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.759 Vali Acc: 0.262 Test Loss: 1.759 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0631413459777832
Epoch: 15, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.846 Vali Acc: 0.251 Test Loss: 1.846 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.071469783782959
Epoch: 16, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.790 Vali Acc: 0.255 Test Loss: 1.790 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 316932
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.247163772583008
Epoch: 1, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.429 Vali Acc: 0.240 Test Loss: 1.429 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 1.2247097492218018
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.439 Vali Acc: 0.259 Test Loss: 1.439 Test Acc: 0.259
Validation loss decreased (-0.239529 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.0625908374786377
Epoch: 3, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.424 Vali Acc: 0.278 Test Loss: 1.424 Test Acc: 0.278
Validation loss decreased (-0.258541 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 1.0350492000579834
Epoch: 4, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.648 Vali Acc: 0.243 Test Loss: 1.648 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1533939838409424
Epoch: 5, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.839 Vali Acc: 0.247 Test Loss: 1.839 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1245808601379395
Epoch: 6, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.554 Vali Acc: 0.240 Test Loss: 1.554 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0496575832366943
Epoch: 7, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.487 Vali Acc: 0.251 Test Loss: 1.487 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1379563808441162
Epoch: 8, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.507 Vali Acc: 0.236 Test Loss: 1.507 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0457024574279785
Epoch: 9, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.594 Vali Acc: 0.270 Test Loss: 1.594 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1416077613830566
Epoch: 10, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.653 Vali Acc: 0.285 Test Loss: 1.653 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285155).  Saving model ...
Epoch: 11 cost time: 1.0408215522766113
Epoch: 11, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.798 Vali Acc: 0.259 Test Loss: 1.798 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1773598194122314
Epoch: 12, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.924 Vali Acc: 0.262 Test Loss: 1.924 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2897026538848877
Epoch: 13, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.789 Vali Acc: 0.259 Test Loss: 1.789 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0944995880126953
Epoch: 14, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.836 Vali Acc: 0.289 Test Loss: 1.836 Test Acc: 0.289
Validation loss decreased (-0.285155 --> -0.288955).  Saving model ...
Epoch: 15 cost time: 1.1932215690612793
Epoch: 15, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.757 Vali Acc: 0.243 Test Loss: 1.757 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1341931819915771
Epoch: 16, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.696 Vali Acc: 0.274 Test Loss: 1.696 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0925161838531494
Epoch: 17, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.906 Vali Acc: 0.270 Test Loss: 1.906 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.113673210144043
Epoch: 18, Steps: 17 | Train Loss: 1.022 Vali Loss: 1.818 Vali Acc: 0.270 Test Loss: 1.818 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1575076580047607
Epoch: 19, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.020 Vali Acc: 0.247 Test Loss: 2.020 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2072949409484863
Epoch: 20, Steps: 17 | Train Loss: 0.840 Vali Loss: 1.862 Vali Acc: 0.274 Test Loss: 1.862 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.164790153503418
Epoch: 21, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.922 Vali Acc: 0.259 Test Loss: 1.922 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0124597549438477
Epoch: 22, Steps: 17 | Train Loss: 0.790 Vali Loss: 2.270 Vali Acc: 0.270 Test Loss: 2.270 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0560836791992188
Epoch: 23, Steps: 17 | Train Loss: 0.890 Vali Loss: 2.053 Vali Acc: 0.278 Test Loss: 2.053 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.084019422531128
Epoch: 24, Steps: 17 | Train Loss: 0.986 Vali Loss: 2.480 Vali Acc: 0.255 Test Loss: 2.480 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 318852
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7171921730041504
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.416 Vali Acc: 0.259 Test Loss: 1.416 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.0843565464019775
Epoch: 2, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.460 Vali Acc: 0.247 Test Loss: 1.460 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9580783843994141
Epoch: 3, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.446 Vali Acc: 0.274 Test Loss: 1.446 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 0.9032073020935059
Epoch: 4, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.557 Vali Acc: 0.247 Test Loss: 1.557 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9297456741333008
Epoch: 5, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.480 Vali Acc: 0.285 Test Loss: 1.480 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 6 cost time: 1.069246768951416
Epoch: 6, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.578 Vali Acc: 0.266 Test Loss: 1.578 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9352433681488037
Epoch: 7, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.499 Vali Acc: 0.281 Test Loss: 1.499 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9240477085113525
Epoch: 8, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.562 Vali Acc: 0.281 Test Loss: 1.562 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0816919803619385
Epoch: 9, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.514 Vali Acc: 0.281 Test Loss: 1.514 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9224369525909424
Epoch: 10, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.515 Vali Acc: 0.240 Test Loss: 1.515 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0734269618988037
Epoch: 11, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.563 Vali Acc: 0.259 Test Loss: 1.563 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.002288579940796
Epoch: 12, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.597 Vali Acc: 0.217 Test Loss: 1.597 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0395433902740479
Epoch: 13, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.675 Vali Acc: 0.255 Test Loss: 1.675 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9729528427124023
Epoch: 14, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.715 Vali Acc: 0.259 Test Loss: 1.715 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9690406322479248
Epoch: 15, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.820 Vali Acc: 0.251 Test Loss: 1.820 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 323972
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.928992986679077
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.491 Vali Acc: 0.243 Test Loss: 1.491 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 1.0484490394592285
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.417 Vali Acc: 0.262 Test Loss: 1.417 Test Acc: 0.262
Validation loss decreased (-0.243331 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 0.9311642646789551
Epoch: 3, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.435 Vali Acc: 0.240 Test Loss: 1.435 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9897797107696533
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.465 Vali Acc: 0.270 Test Loss: 1.465 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269947).  Saving model ...
Epoch: 5 cost time: 1.0001952648162842
Epoch: 5, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.498 Vali Acc: 0.259 Test Loss: 1.498 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0061120986938477
Epoch: 6, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.474 Vali Acc: 0.274 Test Loss: 1.474 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273750).  Saving model ...
Epoch: 7 cost time: 0.9488098621368408
Epoch: 7, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.651 Vali Acc: 0.266 Test Loss: 1.651 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1452667713165283
Epoch: 8, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.616 Vali Acc: 0.274 Test Loss: 1.616 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0938479900360107
Epoch: 9, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.548 Vali Acc: 0.270 Test Loss: 1.548 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0655384063720703
Epoch: 10, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.966 Vali Acc: 0.259 Test Loss: 1.966 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0939381122589111
Epoch: 11, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.619 Vali Acc: 0.274 Test Loss: 1.619 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0066077709197998
Epoch: 12, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.867 Vali Acc: 0.285 Test Loss: 1.867 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285152).  Saving model ...
Epoch: 13 cost time: 0.9925322532653809
Epoch: 13, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.760 Vali Acc: 0.266 Test Loss: 1.760 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9130613803863525
Epoch: 14, Steps: 17 | Train Loss: 1.026 Vali Loss: 2.112 Vali Acc: 0.243 Test Loss: 2.112 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9447245597839355
Epoch: 15, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.868 Vali Acc: 0.236 Test Loss: 1.868 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9959907531738281
Epoch: 16, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.870 Vali Acc: 0.278 Test Loss: 1.870 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9900805950164795
Epoch: 17, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.942 Vali Acc: 0.270 Test Loss: 1.942 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0601856708526611
Epoch: 18, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.999 Vali Acc: 0.259 Test Loss: 1.999 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9319617748260498
Epoch: 19, Steps: 17 | Train Loss: 1.067 Vali Loss: 2.275 Vali Acc: 0.251 Test Loss: 2.275 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9312751293182373
Epoch: 20, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.970 Vali Acc: 0.251 Test Loss: 1.970 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.014815330505371
Epoch: 21, Steps: 17 | Train Loss: 0.832 Vali Loss: 2.684 Vali Acc: 0.259 Test Loss: 2.684 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9261195659637451
Epoch: 22, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.106 Vali Acc: 0.281 Test Loss: 2.106 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df256_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 332036
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.946242570877075
Epoch: 1, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.566 Vali Acc: 0.247 Test Loss: 1.566 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 2.099510669708252
Epoch: 2, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.797 Vali Acc: 0.243 Test Loss: 1.797 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0479512214660645
Epoch: 3, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.563 Vali Acc: 0.270 Test Loss: 1.563 Test Acc: 0.270
Validation loss decreased (-0.247133 --> -0.269946).  Saving model ...
Epoch: 4 cost time: 2.5767855644226074
Epoch: 4, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.730 Vali Acc: 0.255 Test Loss: 1.730 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1943867206573486
Epoch: 5, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.881 Vali Acc: 0.240 Test Loss: 1.881 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4153244495391846
Epoch: 6, Steps: 17 | Train Loss: 1.430 Vali Loss: 2.151 Vali Acc: 0.255 Test Loss: 2.151 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1348633766174316
Epoch: 7, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.696 Vali Acc: 0.259 Test Loss: 1.696 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.097839832305908
Epoch: 8, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.719 Vali Acc: 0.270 Test Loss: 1.719 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.515758991241455
Epoch: 9, Steps: 17 | Train Loss: 1.273 Vali Loss: 2.086 Vali Acc: 0.274 Test Loss: 2.086 Test Acc: 0.274
Validation loss decreased (-0.269946 --> -0.273743).  Saving model ...
Epoch: 10 cost time: 2.1358509063720703
Epoch: 10, Steps: 17 | Train Loss: 1.342 Vali Loss: 2.727 Vali Acc: 0.243 Test Loss: 2.727 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1368181705474854
Epoch: 11, Steps: 17 | Train Loss: 1.326 Vali Loss: 2.862 Vali Acc: 0.243 Test Loss: 2.862 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2199747562408447
Epoch: 12, Steps: 17 | Train Loss: 1.533 Vali Loss: 2.453 Vali Acc: 0.259 Test Loss: 2.453 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9255998134613037
Epoch: 13, Steps: 17 | Train Loss: 1.595 Vali Loss: 2.313 Vali Acc: 0.285 Test Loss: 2.313 Test Acc: 0.285
Validation loss decreased (-0.273743 --> -0.285148).  Saving model ...
Epoch: 14 cost time: 2.1539509296417236
Epoch: 14, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.955 Vali Acc: 0.255 Test Loss: 1.955 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8107714653015137
Epoch: 15, Steps: 17 | Train Loss: 1.139 Vali Loss: 2.635 Vali Acc: 0.243 Test Loss: 2.635 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8814060688018799
Epoch: 16, Steps: 17 | Train Loss: 1.055 Vali Loss: 2.363 Vali Acc: 0.259 Test Loss: 2.363 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.040351629257202
Epoch: 17, Steps: 17 | Train Loss: 1.026 Vali Loss: 2.231 Vali Acc: 0.236 Test Loss: 2.231 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0038414001464844
Epoch: 18, Steps: 17 | Train Loss: 0.952 Vali Loss: 2.781 Vali Acc: 0.240 Test Loss: 2.781 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9801783561706543
Epoch: 19, Steps: 17 | Train Loss: 0.817 Vali Loss: 4.125 Vali Acc: 0.266 Test Loss: 4.125 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1077656745910645
Epoch: 20, Steps: 17 | Train Loss: 1.285 Vali Loss: 2.765 Vali Acc: 0.262 Test Loss: 2.765 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7562634944915771
Epoch: 21, Steps: 17 | Train Loss: 0.884 Vali Loss: 3.307 Vali Acc: 0.251 Test Loss: 3.307 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.3397626876831055
Epoch: 22, Steps: 17 | Train Loss: 0.847 Vali Loss: 2.948 Vali Acc: 0.205 Test Loss: 2.948 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.3013741970062256
Epoch: 23, Steps: 17 | Train Loss: 0.862 Vali Loss: 2.941 Vali Acc: 0.224 Test Loss: 2.941 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 326404
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.581350803375244
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.434 Vali Acc: 0.251 Test Loss: 1.434 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.9855239391326904
Epoch: 2, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.488 Vali Acc: 0.232 Test Loss: 1.488 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7582640647888184
Epoch: 3, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.441 Vali Acc: 0.274 Test Loss: 1.441 Test Acc: 0.274
Validation loss decreased (-0.250936 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 2.0458574295043945
Epoch: 4, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.527 Vali Acc: 0.251 Test Loss: 1.527 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2332816123962402
Epoch: 5, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.660 Vali Acc: 0.259 Test Loss: 1.660 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9752817153930664
Epoch: 6, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.512 Vali Acc: 0.228 Test Loss: 1.512 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7278964519500732
Epoch: 7, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.729 Vali Acc: 0.270 Test Loss: 1.729 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0464346408843994
Epoch: 8, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.889 Vali Acc: 0.278 Test Loss: 1.889 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277548).  Saving model ...
Epoch: 9 cost time: 1.959747076034546
Epoch: 9, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.793 Vali Acc: 0.243 Test Loss: 1.793 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7358582019805908
Epoch: 10, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.942 Vali Acc: 0.243 Test Loss: 1.942 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2167694568634033
Epoch: 11, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.999 Vali Acc: 0.259 Test Loss: 1.999 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.822047233581543
Epoch: 12, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.760 Vali Acc: 0.259 Test Loss: 1.760 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.072349786758423
Epoch: 13, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.885 Vali Acc: 0.270 Test Loss: 1.885 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2055861949920654
Epoch: 14, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.986 Vali Acc: 0.251 Test Loss: 1.986 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.032327651977539
Epoch: 15, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.940 Vali Acc: 0.259 Test Loss: 1.940 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.923046588897705
Epoch: 16, Steps: 17 | Train Loss: 0.960 Vali Loss: 2.255 Vali Acc: 0.259 Test Loss: 2.255 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.742232322692871
Epoch: 17, Steps: 17 | Train Loss: 0.917 Vali Loss: 2.691 Vali Acc: 0.289 Test Loss: 2.691 Test Acc: 0.289
Validation loss decreased (-0.277548 --> -0.288946).  Saving model ...
Epoch: 18 cost time: 1.81001615524292
Epoch: 18, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.451 Vali Acc: 0.255 Test Loss: 2.451 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2104969024658203
Epoch: 19, Steps: 17 | Train Loss: 0.969 Vali Loss: 2.041 Vali Acc: 0.236 Test Loss: 2.041 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8477697372436523
Epoch: 20, Steps: 17 | Train Loss: 0.828 Vali Loss: 2.081 Vali Acc: 0.247 Test Loss: 2.081 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8940091133117676
Epoch: 21, Steps: 17 | Train Loss: 0.810 Vali Loss: 2.279 Vali Acc: 0.278 Test Loss: 2.279 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6516237258911133
Epoch: 22, Steps: 17 | Train Loss: 0.881 Vali Loss: 2.293 Vali Acc: 0.274 Test Loss: 2.293 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9554343223571777
Epoch: 23, Steps: 17 | Train Loss: 0.738 Vali Loss: 2.395 Vali Acc: 0.255 Test Loss: 2.395 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.030989646911621
Epoch: 24, Steps: 17 | Train Loss: 0.777 Vali Loss: 2.546 Vali Acc: 0.262 Test Loss: 2.546 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6654295921325684
Epoch: 25, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.858 Vali Acc: 0.293 Test Loss: 2.858 Test Acc: 0.293
Validation loss decreased (-0.288946 --> -0.292747).  Saving model ...
Epoch: 26 cost time: 1.7796483039855957
Epoch: 26, Steps: 17 | Train Loss: 0.851 Vali Loss: 2.831 Vali Acc: 0.278 Test Loss: 2.831 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9997820854187012
Epoch: 27, Steps: 17 | Train Loss: 0.836 Vali Loss: 3.339 Vali Acc: 0.255 Test Loss: 3.339 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8782939910888672
Epoch: 28, Steps: 17 | Train Loss: 0.786 Vali Loss: 2.828 Vali Acc: 0.232 Test Loss: 2.828 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.713794469833374
Epoch: 29, Steps: 17 | Train Loss: 0.757 Vali Loss: 2.858 Vali Acc: 0.251 Test Loss: 2.858 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.821946620941162
Epoch: 30, Steps: 17 | Train Loss: 0.673 Vali Loss: 3.583 Vali Acc: 0.266 Test Loss: 3.583 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7976255416870117
Epoch: 31, Steps: 17 | Train Loss: 0.898 Vali Loss: 2.947 Vali Acc: 0.221 Test Loss: 2.947 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.049666166305542
Epoch: 32, Steps: 17 | Train Loss: 0.750 Vali Loss: 3.721 Vali Acc: 0.270 Test Loss: 3.721 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8228771686553955
Epoch: 33, Steps: 17 | Train Loss: 0.757 Vali Loss: 3.246 Vali Acc: 0.281 Test Loss: 3.246 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.7118475437164307
Epoch: 34, Steps: 17 | Train Loss: 0.595 Vali Loss: 4.070 Vali Acc: 0.289 Test Loss: 4.070 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.925499439239502
Epoch: 35, Steps: 17 | Train Loss: 0.662 Vali Loss: 3.496 Vali Acc: 0.251 Test Loss: 3.496 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 270596
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.01784873008728
Epoch: 1, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.413 Vali Acc: 0.251 Test Loss: 1.413 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.8110840320587158
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.426 Vali Acc: 0.262 Test Loss: 1.426 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 1.7456834316253662
Epoch: 3, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.419 Vali Acc: 0.297 Test Loss: 1.419 Test Acc: 0.297
Validation loss decreased (-0.262343 --> -0.296564).  Saving model ...
Epoch: 4 cost time: 1.9449779987335205
Epoch: 4, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.511 Vali Acc: 0.274 Test Loss: 1.511 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5976781845092773
Epoch: 5, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.587 Vali Acc: 0.262 Test Loss: 1.587 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7989585399627686
Epoch: 6, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.594 Vali Acc: 0.259 Test Loss: 1.594 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8152458667755127
Epoch: 7, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.792 Vali Acc: 0.300 Test Loss: 1.792 Test Acc: 0.300
Validation loss decreased (-0.296564 --> -0.300362).  Saving model ...
Epoch: 8 cost time: 1.8353943824768066
Epoch: 8, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.913 Vali Acc: 0.274 Test Loss: 1.913 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7015697956085205
Epoch: 9, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.850 Vali Acc: 0.270 Test Loss: 1.850 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1254570484161377
Epoch: 10, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.634 Vali Acc: 0.278 Test Loss: 1.634 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8501403331756592
Epoch: 11, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.636 Vali Acc: 0.251 Test Loss: 1.636 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7529306411743164
Epoch: 12, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.734 Vali Acc: 0.262 Test Loss: 1.734 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8718414306640625
Epoch: 13, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.841 Vali Acc: 0.266 Test Loss: 1.841 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5790448188781738
Epoch: 14, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.713 Vali Acc: 0.262 Test Loss: 1.713 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4823188781738281
Epoch: 15, Steps: 17 | Train Loss: 1.133 Vali Loss: 2.053 Vali Acc: 0.243 Test Loss: 2.053 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3518407344818115
Epoch: 16, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.810 Vali Acc: 0.243 Test Loss: 1.810 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7384727001190186
Epoch: 17, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.940 Vali Acc: 0.247 Test Loss: 1.940 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 256260
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1001315116882324
Epoch: 1, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.394 Vali Acc: 0.240 Test Loss: 1.394 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.2084414958953857
Epoch: 2, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.599 Vali Acc: 0.247 Test Loss: 1.599 Test Acc: 0.247
Validation loss decreased (-0.239530 --> -0.247132).  Saving model ...
Epoch: 3 cost time: 1.121143102645874
Epoch: 3, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.506 Vali Acc: 0.259 Test Loss: 1.506 Test Acc: 0.259
Validation loss decreased (-0.247132 --> -0.258540).  Saving model ...
Epoch: 4 cost time: 1.0667686462402344
Epoch: 4, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.480 Vali Acc: 0.224 Test Loss: 1.480 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2270147800445557
Epoch: 5, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.500 Vali Acc: 0.255 Test Loss: 1.500 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.130173921585083
Epoch: 6, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.568 Vali Acc: 0.224 Test Loss: 1.568 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2416033744812012
Epoch: 7, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.740 Vali Acc: 0.228 Test Loss: 1.740 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2527685165405273
Epoch: 8, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.689 Vali Acc: 0.255 Test Loss: 1.689 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2468082904815674
Epoch: 9, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.653 Vali Acc: 0.270 Test Loss: 1.653 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269945).  Saving model ...
Epoch: 10 cost time: 1.2933242321014404
Epoch: 10, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.581 Vali Acc: 0.281 Test Loss: 1.581 Test Acc: 0.281
Validation loss decreased (-0.269945 --> -0.281353).  Saving model ...
Epoch: 11 cost time: 1.135721206665039
Epoch: 11, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.879 Vali Acc: 0.262 Test Loss: 1.879 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.316763162612915
Epoch: 12, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.733 Vali Acc: 0.266 Test Loss: 1.733 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3021140098571777
Epoch: 13, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.675 Vali Acc: 0.255 Test Loss: 1.675 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2077293395996094
Epoch: 14, Steps: 17 | Train Loss: 1.133 Vali Loss: 2.053 Vali Acc: 0.262 Test Loss: 2.053 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2131106853485107
Epoch: 15, Steps: 17 | Train Loss: 1.180 Vali Loss: 2.000 Vali Acc: 0.240 Test Loss: 2.000 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1753711700439453
Epoch: 16, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.779 Vali Acc: 0.232 Test Loss: 1.779 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3219540119171143
Epoch: 17, Steps: 17 | Train Loss: 1.026 Vali Loss: 2.151 Vali Acc: 0.224 Test Loss: 2.151 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4798624515533447
Epoch: 18, Steps: 17 | Train Loss: 0.998 Vali Loss: 2.286 Vali Acc: 0.236 Test Loss: 2.286 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.322951316833496
Epoch: 19, Steps: 17 | Train Loss: 0.964 Vali Loss: 2.121 Vali Acc: 0.278 Test Loss: 2.121 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3696601390838623
Epoch: 20, Steps: 17 | Train Loss: 0.831 Vali Loss: 1.965 Vali Acc: 0.236 Test Loss: 1.965 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 251140
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8770389556884766
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.513 Vali Acc: 0.259 Test Loss: 1.513 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 1.1411817073822021
Epoch: 2, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.428 Vali Acc: 0.232 Test Loss: 1.428 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2772364616394043
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.446 Vali Acc: 0.266 Test Loss: 1.446 Test Acc: 0.266
Validation loss decreased (-0.258540 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 1.173166275024414
Epoch: 4, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.511 Vali Acc: 0.236 Test Loss: 1.511 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1829895973205566
Epoch: 5, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.524 Vali Acc: 0.255 Test Loss: 1.524 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1738550662994385
Epoch: 6, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.581 Vali Acc: 0.274 Test Loss: 1.581 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273748).  Saving model ...
Epoch: 7 cost time: 1.222034215927124
Epoch: 7, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.484 Vali Acc: 0.243 Test Loss: 1.484 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1276075839996338
Epoch: 8, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.487 Vali Acc: 0.247 Test Loss: 1.487 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.25166654586792
Epoch: 9, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.566 Vali Acc: 0.259 Test Loss: 1.566 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1999895572662354
Epoch: 10, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.615 Vali Acc: 0.247 Test Loss: 1.615 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0935611724853516
Epoch: 11, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.651 Vali Acc: 0.251 Test Loss: 1.651 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2009203433990479
Epoch: 12, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.800 Vali Acc: 0.243 Test Loss: 1.800 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0629019737243652
Epoch: 13, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.681 Vali Acc: 0.251 Test Loss: 1.681 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.159440279006958
Epoch: 14, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.631 Vali Acc: 0.255 Test Loss: 1.631 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.036484718322754
Epoch: 15, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.677 Vali Acc: 0.289 Test Loss: 1.677 Test Acc: 0.289
Validation loss decreased (-0.273748 --> -0.288957).  Saving model ...
Epoch: 16 cost time: 1.0699570178985596
Epoch: 16, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.846 Vali Acc: 0.274 Test Loss: 1.846 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1560356616973877
Epoch: 17, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.840 Vali Acc: 0.243 Test Loss: 1.840 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1070032119750977
Epoch: 18, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.722 Vali Acc: 0.270 Test Loss: 1.722 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.102116584777832
Epoch: 19, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.022 Vali Acc: 0.274 Test Loss: 2.022 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.088402271270752
Epoch: 20, Steps: 17 | Train Loss: 0.955 Vali Loss: 2.067 Vali Acc: 0.259 Test Loss: 2.067 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.12310791015625
Epoch: 21, Steps: 17 | Train Loss: 0.888 Vali Loss: 1.919 Vali Acc: 0.278 Test Loss: 1.919 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2732326984405518
Epoch: 22, Steps: 17 | Train Loss: 0.775 Vali Loss: 2.339 Vali Acc: 0.255 Test Loss: 2.339 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2499589920043945
Epoch: 23, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.998 Vali Acc: 0.281 Test Loss: 1.998 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1453032493591309
Epoch: 24, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.985 Vali Acc: 0.251 Test Loss: 1.985 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1148059368133545
Epoch: 25, Steps: 17 | Train Loss: 0.776 Vali Loss: 2.625 Vali Acc: 0.247 Test Loss: 2.625 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 253060
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.169388771057129
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.431 Vali Acc: 0.240 Test Loss: 1.431 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 1.182875633239746
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.418 Vali Acc: 0.240 Test Loss: 1.418 Test Acc: 0.240
Validation loss decreased (-0.239529 --> -0.239530).  Saving model ...
Epoch: 3 cost time: 1.3083136081695557
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.450 Vali Acc: 0.266 Test Loss: 1.450 Test Acc: 0.266
Validation loss decreased (-0.239530 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 1.3570964336395264
Epoch: 4, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.593 Vali Acc: 0.251 Test Loss: 1.593 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4658992290496826
Epoch: 5, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.462 Vali Acc: 0.255 Test Loss: 1.462 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3451077938079834
Epoch: 6, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.507 Vali Acc: 0.247 Test Loss: 1.507 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.303661823272705
Epoch: 7, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.618 Vali Acc: 0.262 Test Loss: 1.618 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2821378707885742
Epoch: 8, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.501 Vali Acc: 0.270 Test Loss: 1.501 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269947).  Saving model ...
Epoch: 9 cost time: 1.1744766235351562
Epoch: 9, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.713 Vali Acc: 0.247 Test Loss: 1.713 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2021839618682861
Epoch: 10, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.555 Vali Acc: 0.247 Test Loss: 1.555 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3846263885498047
Epoch: 11, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.585 Vali Acc: 0.259 Test Loss: 1.585 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3858184814453125
Epoch: 12, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.585 Vali Acc: 0.240 Test Loss: 1.585 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3785581588745117
Epoch: 13, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.743 Vali Acc: 0.259 Test Loss: 1.743 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3336901664733887
Epoch: 14, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.974 Vali Acc: 0.255 Test Loss: 1.974 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4043290615081787
Epoch: 15, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.841 Vali Acc: 0.243 Test Loss: 1.841 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2336885929107666
Epoch: 16, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.695 Vali Acc: 0.251 Test Loss: 1.695 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2076094150543213
Epoch: 17, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.803 Vali Acc: 0.266 Test Loss: 1.803 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2455577850341797
Epoch: 18, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.751 Vali Acc: 0.259 Test Loss: 1.751 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 258180
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.153998374938965
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.416 Vali Acc: 0.236 Test Loss: 1.416 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.1391534805297852
Epoch: 2, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.462 Vali Acc: 0.251 Test Loss: 1.462 Test Acc: 0.251
Validation loss decreased (-0.235727 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 1.2274198532104492
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.423 Vali Acc: 0.266 Test Loss: 1.423 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 1.274731159210205
Epoch: 4, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.430 Vali Acc: 0.266 Test Loss: 1.430 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2453117370605469
Epoch: 5, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.521 Vali Acc: 0.266 Test Loss: 1.521 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.200793743133545
Epoch: 6, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.184375286102295
Epoch: 7, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.484 Vali Acc: 0.259 Test Loss: 1.484 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2126591205596924
Epoch: 8, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.620 Vali Acc: 0.236 Test Loss: 1.620 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2950639724731445
Epoch: 9, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.609 Vali Acc: 0.278 Test Loss: 1.609 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277550).  Saving model ...
Epoch: 10 cost time: 1.179762601852417
Epoch: 10, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.622 Vali Acc: 0.278 Test Loss: 1.622 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1920485496520996
Epoch: 11, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.577 Vali Acc: 0.232 Test Loss: 1.577 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2659335136413574
Epoch: 12, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.735 Vali Acc: 0.255 Test Loss: 1.735 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2306625843048096
Epoch: 13, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.685 Vali Acc: 0.270 Test Loss: 1.685 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1932008266448975
Epoch: 14, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.899 Vali Acc: 0.281 Test Loss: 1.899 Test Acc: 0.281
Validation loss decreased (-0.277550 --> -0.281350).  Saving model ...
Epoch: 15 cost time: 1.162013292312622
Epoch: 15, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.705 Vali Acc: 0.221 Test Loss: 1.705 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.537980079650879
Epoch: 16, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.931 Vali Acc: 0.243 Test Loss: 1.931 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2178030014038086
Epoch: 17, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.830 Vali Acc: 0.266 Test Loss: 1.830 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3020312786102295
Epoch: 18, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.876 Vali Acc: 0.217 Test Loss: 1.876 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2309648990631104
Epoch: 19, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.962 Vali Acc: 0.217 Test Loss: 1.962 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1855547428131104
Epoch: 20, Steps: 17 | Train Loss: 0.906 Vali Loss: 2.355 Vali Acc: 0.262 Test Loss: 2.355 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2573542594909668
Epoch: 21, Steps: 17 | Train Loss: 0.898 Vali Loss: 2.251 Vali Acc: 0.240 Test Loss: 2.251 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2040624618530273
Epoch: 22, Steps: 17 | Train Loss: 0.811 Vali Loss: 2.509 Vali Acc: 0.266 Test Loss: 2.509 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.193077564239502
Epoch: 23, Steps: 17 | Train Loss: 0.878 Vali Loss: 2.505 Vali Acc: 0.278 Test Loss: 2.505 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0465245246887207
Epoch: 24, Steps: 17 | Train Loss: 0.808 Vali Loss: 2.630 Vali Acc: 0.243 Test Loss: 2.630 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df128_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 266244
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.017890453338623
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.627 Vali Acc: 0.247 Test Loss: 1.627 Test Acc: 0.247
Validation loss decreased (inf --> -0.247132).  Saving model ...
Epoch: 2 cost time: 2.2346065044403076
Epoch: 2, Steps: 17 | Train Loss: 1.608 Vali Loss: 1.524 Vali Acc: 0.262 Test Loss: 1.524 Test Acc: 0.262
Validation loss decreased (-0.247132 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 2.2711341381073
Epoch: 3, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.503 Vali Acc: 0.255 Test Loss: 1.503 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2284250259399414
Epoch: 4, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.880 Vali Acc: 0.262 Test Loss: 1.880 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.220588445663452
Epoch: 5, Steps: 17 | Train Loss: 1.511 Vali Loss: 2.198 Vali Acc: 0.255 Test Loss: 2.198 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1941349506378174
Epoch: 6, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.577 Vali Acc: 0.255 Test Loss: 1.577 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.585702896118164
Epoch: 7, Steps: 17 | Train Loss: 1.606 Vali Loss: 2.471 Vali Acc: 0.247 Test Loss: 2.471 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.168792486190796
Epoch: 8, Steps: 17 | Train Loss: 1.504 Vali Loss: 2.481 Vali Acc: 0.266 Test Loss: 2.481 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266135).  Saving model ...
Epoch: 9 cost time: 2.062128782272339
Epoch: 9, Steps: 17 | Train Loss: 1.661 Vali Loss: 2.637 Vali Acc: 0.255 Test Loss: 2.637 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.241586923599243
Epoch: 10, Steps: 17 | Train Loss: 1.459 Vali Loss: 3.025 Vali Acc: 0.251 Test Loss: 3.025 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.425013303756714
Epoch: 11, Steps: 17 | Train Loss: 1.473 Vali Loss: 2.046 Vali Acc: 0.240 Test Loss: 2.046 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.312861204147339
Epoch: 12, Steps: 17 | Train Loss: 1.262 Vali Loss: 2.218 Vali Acc: 0.251 Test Loss: 2.218 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.229304552078247
Epoch: 13, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.859 Vali Acc: 0.270 Test Loss: 1.859 Test Acc: 0.270
Validation loss decreased (-0.266135 --> -0.269943).  Saving model ...
Epoch: 14 cost time: 2.2607266902923584
Epoch: 14, Steps: 17 | Train Loss: 0.978 Vali Loss: 2.613 Vali Acc: 0.266 Test Loss: 2.613 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.898545742034912
Epoch: 15, Steps: 17 | Train Loss: 1.150 Vali Loss: 2.300 Vali Acc: 0.240 Test Loss: 2.300 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.039180278778076
Epoch: 16, Steps: 17 | Train Loss: 1.007 Vali Loss: 2.477 Vali Acc: 0.251 Test Loss: 2.477 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9903523921966553
Epoch: 17, Steps: 17 | Train Loss: 1.141 Vali Loss: 2.491 Vali Acc: 0.240 Test Loss: 2.491 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8153622150421143
Epoch: 18, Steps: 17 | Train Loss: 1.065 Vali Loss: 2.241 Vali Acc: 0.240 Test Loss: 2.241 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2944235801696777
Epoch: 19, Steps: 17 | Train Loss: 0.811 Vali Loss: 2.693 Vali Acc: 0.274 Test Loss: 2.693 Test Acc: 0.274
Validation loss decreased (-0.269943 --> -0.273737).  Saving model ...
Epoch: 20 cost time: 1.9953720569610596
Epoch: 20, Steps: 17 | Train Loss: 1.004 Vali Loss: 2.374 Vali Acc: 0.243 Test Loss: 2.374 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9488251209259033
Epoch: 21, Steps: 17 | Train Loss: 0.989 Vali Loss: 2.564 Vali Acc: 0.247 Test Loss: 2.564 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.149825096130371
Epoch: 22, Steps: 17 | Train Loss: 0.915 Vali Loss: 2.786 Vali Acc: 0.232 Test Loss: 2.786 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.998793601989746
Epoch: 23, Steps: 17 | Train Loss: 0.995 Vali Loss: 2.970 Vali Acc: 0.243 Test Loss: 2.970 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.923717975616455
Epoch: 24, Steps: 17 | Train Loss: 0.752 Vali Loss: 3.718 Vali Acc: 0.247 Test Loss: 3.718 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.0732710361480713
Epoch: 25, Steps: 17 | Train Loss: 0.876 Vali Loss: 3.387 Vali Acc: 0.236 Test Loss: 3.387 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.037043571472168
Epoch: 26, Steps: 17 | Train Loss: 0.941 Vali Loss: 3.750 Vali Acc: 0.251 Test Loss: 3.750 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8471829891204834
Epoch: 27, Steps: 17 | Train Loss: 0.824 Vali Loss: 3.182 Vali Acc: 0.247 Test Loss: 3.182 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.948089838027954
Epoch: 28, Steps: 17 | Train Loss: 0.750 Vali Loss: 3.860 Vali Acc: 0.247 Test Loss: 3.860 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9984111785888672
Epoch: 29, Steps: 17 | Train Loss: 0.757 Vali Loss: 3.800 Vali Acc: 0.240 Test Loss: 3.800 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 293508
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6453001499176025
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.522 Vali Acc: 0.243 Test Loss: 1.522 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 1.8285818099975586
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.519 Vali Acc: 0.274 Test Loss: 1.519 Test Acc: 0.274
Validation loss decreased (-0.243331 --> -0.273749).  Saving model ...
Epoch: 3 cost time: 2.4983177185058594
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.486 Vali Acc: 0.240 Test Loss: 1.486 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.014404296875
Epoch: 4, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.609 Vali Acc: 0.247 Test Loss: 1.609 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2543139457702637
Epoch: 5, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.511 Vali Acc: 0.270 Test Loss: 1.511 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4032485485076904
Epoch: 6, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.558 Vali Acc: 0.251 Test Loss: 1.558 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8899791240692139
Epoch: 7, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.581 Vali Acc: 0.274 Test Loss: 1.581 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.311520576477051
Epoch: 8, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.614 Vali Acc: 0.262 Test Loss: 1.614 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.326993227005005
Epoch: 9, Steps: 17 | Train Loss: 1.185 Vali Loss: 2.172 Vali Acc: 0.259 Test Loss: 2.172 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8450806140899658
Epoch: 10, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.611 Vali Acc: 0.224 Test Loss: 1.611 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1426737308502197
Epoch: 11, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.655 Vali Acc: 0.285 Test Loss: 1.655 Test Acc: 0.285
Validation loss decreased (-0.273749 --> -0.285155).  Saving model ...
Epoch: 12 cost time: 2.373711109161377
Epoch: 12, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.682 Vali Acc: 0.247 Test Loss: 1.682 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.80855131149292
Epoch: 13, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.813 Vali Acc: 0.278 Test Loss: 1.813 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8597588539123535
Epoch: 14, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.951 Vali Acc: 0.274 Test Loss: 1.951 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.268066883087158
Epoch: 15, Steps: 17 | Train Loss: 0.998 Vali Loss: 2.250 Vali Acc: 0.278 Test Loss: 2.250 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9577336311340332
Epoch: 16, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.938 Vali Acc: 0.259 Test Loss: 1.938 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9884912967681885
Epoch: 17, Steps: 17 | Train Loss: 0.913 Vali Loss: 2.095 Vali Acc: 0.285 Test Loss: 2.095 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.286400079727173
Epoch: 18, Steps: 17 | Train Loss: 0.924 Vali Loss: 2.691 Vali Acc: 0.259 Test Loss: 2.691 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.122202157974243
Epoch: 19, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.214 Vali Acc: 0.262 Test Loss: 2.214 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0406174659729004
Epoch: 20, Steps: 17 | Train Loss: 0.934 Vali Loss: 3.233 Vali Acc: 0.243 Test Loss: 3.233 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.3506386280059814
Epoch: 21, Steps: 17 | Train Loss: 0.923 Vali Loss: 2.225 Vali Acc: 0.259 Test Loss: 2.225 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 237700
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.775533437728882
Epoch: 1, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.596 Vali Acc: 0.251 Test Loss: 1.596 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 1.890451192855835
Epoch: 2, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.438 Vali Acc: 0.266 Test Loss: 1.438 Test Acc: 0.266
Validation loss decreased (-0.250935 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 1.836256742477417
Epoch: 3, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.498 Vali Acc: 0.270 Test Loss: 1.498 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 2.1796889305114746
Epoch: 4, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.494 Vali Acc: 0.270 Test Loss: 1.494 Test Acc: 0.270
Validation loss decreased (-0.269947 --> -0.269947).  Saving model ...
Epoch: 5 cost time: 2.0514283180236816
Epoch: 5, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.640 Vali Acc: 0.243 Test Loss: 1.640 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8166043758392334
Epoch: 6, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.525 Vali Acc: 0.281 Test Loss: 1.525 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281354).  Saving model ...
Epoch: 7 cost time: 1.9829590320587158
Epoch: 7, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.786 Vali Acc: 0.247 Test Loss: 1.786 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5034255981445312
Epoch: 8, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.664 Vali Acc: 0.243 Test Loss: 1.664 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5308330059051514
Epoch: 9, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.643 Vali Acc: 0.240 Test Loss: 1.643 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.519474506378174
Epoch: 10, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.654 Vali Acc: 0.293 Test Loss: 1.654 Test Acc: 0.293
Validation loss decreased (-0.281354 --> -0.292759).  Saving model ...
Epoch: 11 cost time: 2.517597198486328
Epoch: 11, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.662 Vali Acc: 0.255 Test Loss: 1.662 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.985109567642212
Epoch: 12, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.806 Vali Acc: 0.251 Test Loss: 1.806 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.063218832015991
Epoch: 13, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.203 Vali Acc: 0.240 Test Loss: 2.203 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.382512092590332
Epoch: 14, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.813 Vali Acc: 0.247 Test Loss: 1.813 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.573941707611084
Epoch: 15, Steps: 17 | Train Loss: 0.914 Vali Loss: 2.218 Vali Acc: 0.243 Test Loss: 2.218 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4045302867889404
Epoch: 16, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.991 Vali Acc: 0.259 Test Loss: 1.991 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.5601212978363037
Epoch: 17, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.954 Vali Acc: 0.243 Test Loss: 1.954 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.29801082611084
Epoch: 18, Steps: 17 | Train Loss: 0.825 Vali Loss: 2.247 Vali Acc: 0.232 Test Loss: 2.247 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7755343914031982
Epoch: 19, Steps: 17 | Train Loss: 0.990 Vali Loss: 2.380 Vali Acc: 0.262 Test Loss: 2.380 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8130805492401123
Epoch: 20, Steps: 17 | Train Loss: 0.919 Vali Loss: 2.124 Vali Acc: 0.259 Test Loss: 2.124 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 223364
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0363929271698
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.441 Vali Acc: 0.255 Test Loss: 1.441 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 1.2349631786346436
Epoch: 2, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.495 Vali Acc: 0.232 Test Loss: 1.495 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2394537925720215
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.414 Vali Acc: 0.243 Test Loss: 1.414 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2892060279846191
Epoch: 4, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.593 Vali Acc: 0.247 Test Loss: 1.593 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3150553703308105
Epoch: 5, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.510 Vali Acc: 0.281 Test Loss: 1.510 Test Acc: 0.281
Validation loss decreased (-0.254738 --> -0.281354).  Saving model ...
Epoch: 6 cost time: 1.3048858642578125
Epoch: 6, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.690 Vali Acc: 0.259 Test Loss: 1.690 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2618482112884521
Epoch: 7, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.752 Vali Acc: 0.262 Test Loss: 1.752 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3190271854400635
Epoch: 8, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.528 Vali Acc: 0.240 Test Loss: 1.528 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3933916091918945
Epoch: 9, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.674 Vali Acc: 0.232 Test Loss: 1.674 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1738135814666748
Epoch: 10, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.791 Vali Acc: 0.259 Test Loss: 1.791 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.217156171798706
Epoch: 11, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.747 Vali Acc: 0.262 Test Loss: 1.747 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4212646484375
Epoch: 12, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.724 Vali Acc: 0.281 Test Loss: 1.724 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5189540386199951
Epoch: 13, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.740 Vali Acc: 0.243 Test Loss: 1.740 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.208329200744629
Epoch: 14, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.884 Vali Acc: 0.251 Test Loss: 1.884 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.451958179473877
Epoch: 15, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.742 Vali Acc: 0.259 Test Loss: 1.742 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 218244
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.990004301071167
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.485 Vali Acc: 0.247 Test Loss: 1.485 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 1.2319653034210205
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.410 Vali Acc: 0.255 Test Loss: 1.410 Test Acc: 0.255
Validation loss decreased (-0.247133 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.1847951412200928
Epoch: 3, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.412 Vali Acc: 0.281 Test Loss: 1.412 Test Acc: 0.281
Validation loss decreased (-0.254739 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 1.2328989505767822
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.472 Vali Acc: 0.285 Test Loss: 1.472 Test Acc: 0.285
Validation loss decreased (-0.281355 --> -0.285156).  Saving model ...
Epoch: 5 cost time: 1.1888844966888428
Epoch: 5, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.445 Vali Acc: 0.274 Test Loss: 1.445 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2924730777740479
Epoch: 6, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.498 Vali Acc: 0.278 Test Loss: 1.498 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1914207935333252
Epoch: 7, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.585 Vali Acc: 0.247 Test Loss: 1.585 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1683108806610107
Epoch: 8, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.493 Vali Acc: 0.224 Test Loss: 1.493 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3638200759887695
Epoch: 9, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.560 Vali Acc: 0.247 Test Loss: 1.560 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3206770420074463
Epoch: 10, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.610 Vali Acc: 0.247 Test Loss: 1.610 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3946869373321533
Epoch: 11, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.635 Vali Acc: 0.262 Test Loss: 1.635 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.365983247756958
Epoch: 12, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.726 Vali Acc: 0.274 Test Loss: 1.726 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.369424819946289
Epoch: 13, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.711 Vali Acc: 0.262 Test Loss: 1.711 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2598326206207275
Epoch: 14, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.879 Vali Acc: 0.262 Test Loss: 1.879 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 220164
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.089073419570923
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.422 Vali Acc: 0.270 Test Loss: 1.422 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.1843392848968506
Epoch: 2, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.428 Vali Acc: 0.278 Test Loss: 1.428 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 1.2095158100128174
Epoch: 3, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.462 Vali Acc: 0.251 Test Loss: 1.462 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.333507776260376
Epoch: 4, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.440 Vali Acc: 0.255 Test Loss: 1.440 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2281851768493652
Epoch: 5, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.567 Vali Acc: 0.259 Test Loss: 1.567 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2401816844940186
Epoch: 6, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.507 Vali Acc: 0.274 Test Loss: 1.507 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1580784320831299
Epoch: 7, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.548 Vali Acc: 0.259 Test Loss: 1.548 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1539802551269531
Epoch: 8, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.506 Vali Acc: 0.270 Test Loss: 1.506 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2192187309265137
Epoch: 9, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.611 Vali Acc: 0.240 Test Loss: 1.611 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2755365371704102
Epoch: 10, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.711 Vali Acc: 0.232 Test Loss: 1.711 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1607508659362793
Epoch: 11, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.734 Vali Acc: 0.255 Test Loss: 1.734 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.191737413406372
Epoch: 12, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.716 Vali Acc: 0.251 Test Loss: 1.716 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 225284
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2581088542938232
Epoch: 1, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.394 Vali Acc: 0.285 Test Loss: 1.394 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 1.1707532405853271
Epoch: 2, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.396 Vali Acc: 0.262 Test Loss: 1.396 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2660558223724365
Epoch: 3, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.429 Vali Acc: 0.278 Test Loss: 1.429 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1424827575683594
Epoch: 4, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.482 Vali Acc: 0.266 Test Loss: 1.482 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.235466718673706
Epoch: 5, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.550 Vali Acc: 0.251 Test Loss: 1.550 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2047362327575684
Epoch: 6, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.471 Vali Acc: 0.259 Test Loss: 1.471 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.369187831878662
Epoch: 7, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.505 Vali Acc: 0.266 Test Loss: 1.505 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1753602027893066
Epoch: 8, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.493 Vali Acc: 0.278 Test Loss: 1.493 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.173135757446289
Epoch: 9, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.515 Vali Acc: 0.281 Test Loss: 1.515 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2241506576538086
Epoch: 10, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.639 Vali Acc: 0.236 Test Loss: 1.639 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3440990447998047
Epoch: 11, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.636 Vali Acc: 0.236 Test Loss: 1.636 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm128_nh16_df64_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 233348
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.04274845123291
Epoch: 1, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.472 Vali Acc: 0.251 Test Loss: 1.472 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.9619629383087158
Epoch: 2, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.583 Vali Acc: 0.251 Test Loss: 1.583 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.108332872390747
Epoch: 3, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.458 Vali Acc: 0.240 Test Loss: 1.458 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1909708976745605
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.734 Vali Acc: 0.232 Test Loss: 1.734 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1089322566986084
Epoch: 5, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.681 Vali Acc: 0.232 Test Loss: 1.681 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9312381744384766
Epoch: 6, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.649 Vali Acc: 0.262 Test Loss: 1.649 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262341).  Saving model ...
Epoch: 7 cost time: 2.15083646774292
Epoch: 7, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.539 Vali Acc: 0.251 Test Loss: 1.539 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9851112365722656
Epoch: 8, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.669 Vali Acc: 0.266 Test Loss: 1.669 Test Acc: 0.266
Validation loss decreased (-0.262341 --> -0.266143).  Saving model ...
Epoch: 9 cost time: 1.9366486072540283
Epoch: 9, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.810 Vali Acc: 0.266 Test Loss: 1.810 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.030867576599121
Epoch: 10, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.694 Vali Acc: 0.270 Test Loss: 1.694 Test Acc: 0.270
Validation loss decreased (-0.266143 --> -0.269945).  Saving model ...
Epoch: 11 cost time: 1.8027870655059814
Epoch: 11, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.599 Vali Acc: 0.228 Test Loss: 1.599 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.722416639328003
Epoch: 12, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.879 Vali Acc: 0.236 Test Loss: 1.879 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8084423542022705
Epoch: 13, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.735 Vali Acc: 0.247 Test Loss: 1.735 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8989417552947998
Epoch: 14, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.896 Vali Acc: 0.251 Test Loss: 1.896 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7503023147583008
Epoch: 15, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.774 Vali Acc: 0.221 Test Loss: 1.774 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.851259708404541
Epoch: 16, Steps: 17 | Train Loss: 1.062 Vali Loss: 2.027 Vali Acc: 0.224 Test Loss: 2.027 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9166429042816162
Epoch: 17, Steps: 17 | Train Loss: 1.099 Vali Loss: 2.165 Vali Acc: 0.251 Test Loss: 2.165 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0360703468322754
Epoch: 18, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.947 Vali Acc: 0.228 Test Loss: 1.947 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.041260242462158
Epoch: 19, Steps: 17 | Train Loss: 0.877 Vali Loss: 2.024 Vali Acc: 0.266 Test Loss: 2.024 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8893520832061768
Epoch: 20, Steps: 17 | Train Loss: 0.864 Vali Loss: 2.455 Vali Acc: 0.270 Test Loss: 2.455 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 163588
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0168886184692383
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.437 Vali Acc: 0.243 Test Loss: 1.437 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.1687707901000977
Epoch: 2, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.422 Vali Acc: 0.255 Test Loss: 1.422 Test Acc: 0.255
Validation loss decreased (-0.243332 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.2327020168304443
Epoch: 3, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.530 Vali Acc: 0.247 Test Loss: 1.530 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3524410724639893
Epoch: 4, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.600 Vali Acc: 0.251 Test Loss: 1.600 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.416429042816162
Epoch: 5, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.820 Vali Acc: 0.251 Test Loss: 1.820 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2933669090270996
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.709 Vali Acc: 0.266 Test Loss: 1.709 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266143).  Saving model ...
Epoch: 7 cost time: 1.1355047225952148
Epoch: 7, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.550 Vali Acc: 0.270 Test Loss: 1.550 Test Acc: 0.270
Validation loss decreased (-0.266143 --> -0.269946).  Saving model ...
Epoch: 8 cost time: 1.4061682224273682
Epoch: 8, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.528 Vali Acc: 0.285 Test Loss: 1.528 Test Acc: 0.285
Validation loss decreased (-0.269946 --> -0.285156).  Saving model ...
Epoch: 9 cost time: 1.3292350769042969
Epoch: 9, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.486 Vali Acc: 0.243 Test Loss: 1.486 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0991456508636475
Epoch: 10, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.533 Vali Acc: 0.262 Test Loss: 1.533 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5551152229309082
Epoch: 11, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.542 Vali Acc: 0.259 Test Loss: 1.542 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.272907018661499
Epoch: 12, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.601 Vali Acc: 0.266 Test Loss: 1.601 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4160327911376953
Epoch: 13, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.562 Vali Acc: 0.217 Test Loss: 1.562 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3748950958251953
Epoch: 14, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.755 Vali Acc: 0.262 Test Loss: 1.755 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2626538276672363
Epoch: 15, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.777 Vali Acc: 0.236 Test Loss: 1.777 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.33837890625
Epoch: 16, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.640 Vali Acc: 0.224 Test Loss: 1.640 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2657170295715332
Epoch: 17, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.975 Vali Acc: 0.240 Test Loss: 1.975 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.468766450881958
Epoch: 18, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.786 Vali Acc: 0.243 Test Loss: 1.786 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 135684
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9573099613189697
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.439 Vali Acc: 0.240 Test Loss: 1.439 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 1.1978976726531982
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.425 Vali Acc: 0.247 Test Loss: 1.425 Test Acc: 0.247
Validation loss decreased (-0.239529 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.313704252243042
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.502 Vali Acc: 0.251 Test Loss: 1.502 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250936).  Saving model ...
Epoch: 4 cost time: 1.0995872020721436
Epoch: 4, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.467 Vali Acc: 0.224 Test Loss: 1.467 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4146156311035156
Epoch: 5, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.460 Vali Acc: 0.270 Test Loss: 1.460 Test Acc: 0.270
Validation loss decreased (-0.250936 --> -0.269947).  Saving model ...
Epoch: 6 cost time: 1.3756723403930664
Epoch: 6, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.445 Vali Acc: 0.262 Test Loss: 1.445 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.165536880493164
Epoch: 7, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.492 Vali Acc: 0.274 Test Loss: 1.492 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273749).  Saving model ...
Epoch: 8 cost time: 1.3407371044158936
Epoch: 8, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.497 Vali Acc: 0.247 Test Loss: 1.497 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3244452476501465
Epoch: 9, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.607 Vali Acc: 0.266 Test Loss: 1.607 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2307636737823486
Epoch: 10, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.518 Vali Acc: 0.247 Test Loss: 1.518 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2691478729248047
Epoch: 11, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.588 Vali Acc: 0.236 Test Loss: 1.588 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2678658962249756
Epoch: 12, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.664 Vali Acc: 0.243 Test Loss: 1.664 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4286484718322754
Epoch: 13, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.574 Vali Acc: 0.202 Test Loss: 1.574 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3179237842559814
Epoch: 14, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.619 Vali Acc: 0.251 Test Loss: 1.619 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1856482028961182
Epoch: 15, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.665 Vali Acc: 0.266 Test Loss: 1.665 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3745958805084229
Epoch: 16, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.630 Vali Acc: 0.243 Test Loss: 1.630 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3267779350280762
Epoch: 17, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.832 Vali Acc: 0.240 Test Loss: 1.832 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 128516
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.150620698928833
Epoch: 1, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.438 Vali Acc: 0.247 Test Loss: 1.438 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.296083688735962
Epoch: 2, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.437 Vali Acc: 0.247 Test Loss: 1.437 Test Acc: 0.247
Validation loss decreased (-0.247134 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.232208251953125
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.448 Vali Acc: 0.240 Test Loss: 1.448 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2468531131744385
Epoch: 4, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.471 Vali Acc: 0.262 Test Loss: 1.471 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 1.0907652378082275
Epoch: 5, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.608 Vali Acc: 0.247 Test Loss: 1.608 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2424070835113525
Epoch: 6, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.570 Vali Acc: 0.240 Test Loss: 1.570 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3421635627746582
Epoch: 7, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.479 Vali Acc: 0.236 Test Loss: 1.479 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2419345378875732
Epoch: 8, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.509 Vali Acc: 0.240 Test Loss: 1.509 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1082274913787842
Epoch: 9, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.500 Vali Acc: 0.270 Test Loss: 1.500 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269947).  Saving model ...
Epoch: 10 cost time: 0.9292252063751221
Epoch: 10, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.478 Vali Acc: 0.247 Test Loss: 1.478 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.346588373184204
Epoch: 11, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.497 Vali Acc: 0.243 Test Loss: 1.497 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2026381492614746
Epoch: 12, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.746 Vali Acc: 0.251 Test Loss: 1.746 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1081950664520264
Epoch: 13, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.575 Vali Acc: 0.247 Test Loss: 1.575 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2824764251708984
Epoch: 14, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.578 Vali Acc: 0.240 Test Loss: 1.578 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1560533046722412
Epoch: 15, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.799 Vali Acc: 0.232 Test Loss: 1.799 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2480931282043457
Epoch: 16, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.670 Vali Acc: 0.240 Test Loss: 1.670 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.108248233795166
Epoch: 17, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0522196292877197
Epoch: 18, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.664 Vali Acc: 0.255 Test Loss: 1.664 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1439788341522217
Epoch: 19, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.719 Vali Acc: 0.255 Test Loss: 1.719 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 125956
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3229715824127197
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.405 Vali Acc: 0.247 Test Loss: 1.405 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.1977708339691162
Epoch: 2, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.405 Vali Acc: 0.232 Test Loss: 1.405 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.237428903579712
Epoch: 3, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.410 Vali Acc: 0.243 Test Loss: 1.410 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3948540687561035
Epoch: 4, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.470 Vali Acc: 0.262 Test Loss: 1.470 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 1.3221001625061035
Epoch: 5, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.432 Vali Acc: 0.274 Test Loss: 1.432 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 6 cost time: 1.2226462364196777
Epoch: 6, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.518 Vali Acc: 0.232 Test Loss: 1.518 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3006019592285156
Epoch: 7, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.461 Vali Acc: 0.259 Test Loss: 1.461 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3137564659118652
Epoch: 8, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.489 Vali Acc: 0.247 Test Loss: 1.489 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1684677600860596
Epoch: 9, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.472 Vali Acc: 0.266 Test Loss: 1.472 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1902995109558105
Epoch: 10, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.518 Vali Acc: 0.266 Test Loss: 1.518 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2291686534881592
Epoch: 11, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.498 Vali Acc: 0.281 Test Loss: 1.498 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281354).  Saving model ...
Epoch: 12 cost time: 1.2232441902160645
Epoch: 12, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.555 Vali Acc: 0.240 Test Loss: 1.555 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2522966861724854
Epoch: 13, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.511 Vali Acc: 0.278 Test Loss: 1.511 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2092256546020508
Epoch: 14, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.553 Vali Acc: 0.274 Test Loss: 1.553 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0784580707550049
Epoch: 15, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.630 Vali Acc: 0.278 Test Loss: 1.630 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3904390335083008
Epoch: 16, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.567 Vali Acc: 0.262 Test Loss: 1.567 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2950537204742432
Epoch: 17, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.852 Vali Acc: 0.255 Test Loss: 1.852 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1141977310180664
Epoch: 18, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.603 Vali Acc: 0.278 Test Loss: 1.603 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.205923080444336
Epoch: 19, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.712 Vali Acc: 0.243 Test Loss: 1.712 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.364783763885498
Epoch: 20, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.692 Vali Acc: 0.243 Test Loss: 1.692 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.342054843902588
Epoch: 21, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.887 Vali Acc: 0.251 Test Loss: 1.887 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 126916
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.103719472885132
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.411 Vali Acc: 0.259 Test Loss: 1.411 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.302309274673462
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.420 Vali Acc: 0.251 Test Loss: 1.420 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1870970726013184
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.386 Vali Acc: 0.266 Test Loss: 1.386 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.1546318531036377
Epoch: 4, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.439 Vali Acc: 0.259 Test Loss: 1.439 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2120418548583984
Epoch: 5, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.497 Vali Acc: 0.266 Test Loss: 1.497 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1574397087097168
Epoch: 6, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.498 Vali Acc: 0.259 Test Loss: 1.498 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.094174861907959
Epoch: 7, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.421 Vali Acc: 0.236 Test Loss: 1.421 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2376737594604492
Epoch: 8, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.432 Vali Acc: 0.266 Test Loss: 1.432 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.286123514175415
Epoch: 9, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.534 Vali Acc: 0.251 Test Loss: 1.534 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2370171546936035
Epoch: 10, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.524 Vali Acc: 0.251 Test Loss: 1.524 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2409512996673584
Epoch: 11, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.494 Vali Acc: 0.251 Test Loss: 1.494 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1408476829528809
Epoch: 12, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.587 Vali Acc: 0.236 Test Loss: 1.587 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1456475257873535
Epoch: 13, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.563 Vali Acc: 0.266 Test Loss: 1.563 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 129476
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8163042068481445
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.387 Vali Acc: 0.312 Test Loss: 1.387 Test Acc: 0.312
Validation loss decreased (inf --> -0.311773).  Saving model ...
Epoch: 2 cost time: 1.3401992321014404
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.414 Vali Acc: 0.297 Test Loss: 1.414 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1854991912841797
Epoch: 3, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.398 Vali Acc: 0.304 Test Loss: 1.398 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.255018711090088
Epoch: 4, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.389 Vali Acc: 0.327 Test Loss: 1.389 Test Acc: 0.327
Validation loss decreased (-0.311773 --> -0.326982).  Saving model ...
Epoch: 5 cost time: 1.329747200012207
Epoch: 5, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.452 Vali Acc: 0.278 Test Loss: 1.452 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2955412864685059
Epoch: 6, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.473 Vali Acc: 0.262 Test Loss: 1.473 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2428710460662842
Epoch: 7, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.490 Vali Acc: 0.270 Test Loss: 1.490 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3832511901855469
Epoch: 8, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.448 Vali Acc: 0.304 Test Loss: 1.448 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2782201766967773
Epoch: 9, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.435 Vali Acc: 0.281 Test Loss: 1.435 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3307971954345703
Epoch: 10, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.494 Vali Acc: 0.259 Test Loss: 1.494 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2090888023376465
Epoch: 11, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.520 Vali Acc: 0.293 Test Loss: 1.520 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.325700283050537
Epoch: 12, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.495 Vali Acc: 0.259 Test Loss: 1.495 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3477246761322021
Epoch: 13, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.491 Vali Acc: 0.221 Test Loss: 1.491 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2102642059326172
Epoch: 14, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.577 Vali Acc: 0.251 Test Loss: 1.577 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df256_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3269961977186312
model parameter : 133508
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.542811393737793
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.520 Vali Acc: 0.240 Test Loss: 1.520 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 2.7073569297790527
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.407 Vali Acc: 0.278 Test Loss: 1.407 Test Acc: 0.278
Validation loss decreased (-0.239529 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 2.5581705570220947
Epoch: 3, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.506 Vali Acc: 0.274 Test Loss: 1.506 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.579632520675659
Epoch: 4, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.631 Vali Acc: 0.247 Test Loss: 1.631 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.460966110229492
Epoch: 5, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.610 Vali Acc: 0.224 Test Loss: 1.610 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.407606840133667
Epoch: 6, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.690 Vali Acc: 0.240 Test Loss: 1.690 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4480066299438477
Epoch: 7, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.554 Vali Acc: 0.266 Test Loss: 1.554 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3729827404022217
Epoch: 8, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.520 Vali Acc: 0.274 Test Loss: 1.520 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.520272731781006
Epoch: 9, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.639 Vali Acc: 0.236 Test Loss: 1.639 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.2188432216644287
Epoch: 10, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.661 Vali Acc: 0.274 Test Loss: 1.661 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9781787395477295
Epoch: 11, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.790 Vali Acc: 0.278 Test Loss: 1.790 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0760598182678223
Epoch: 12, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.925 Vali Acc: 0.251 Test Loss: 1.925 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 130564
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4429731369018555
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.420 Vali Acc: 0.262 Test Loss: 1.420 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.3839364051818848
Epoch: 2, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.421 Vali Acc: 0.243 Test Loss: 1.421 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3155052661895752
Epoch: 3, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.485 Vali Acc: 0.236 Test Loss: 1.485 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3897206783294678
Epoch: 4, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.553 Vali Acc: 0.243 Test Loss: 1.553 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.342679738998413
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.488 Vali Acc: 0.243 Test Loss: 1.488 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.425283432006836
Epoch: 6, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.559 Vali Acc: 0.240 Test Loss: 1.559 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3714137077331543
Epoch: 7, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.475 Vali Acc: 0.240 Test Loss: 1.475 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4384868144989014
Epoch: 8, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.553 Vali Acc: 0.274 Test Loss: 1.553 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273749).  Saving model ...
Epoch: 9 cost time: 1.3419342041015625
Epoch: 9, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.615 Vali Acc: 0.266 Test Loss: 1.615 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3438482284545898
Epoch: 10, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.569 Vali Acc: 0.240 Test Loss: 1.569 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2352521419525146
Epoch: 11, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.579 Vali Acc: 0.270 Test Loss: 1.579 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3599250316619873
Epoch: 12, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.654 Vali Acc: 0.274 Test Loss: 1.654 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2552762031555176
Epoch: 13, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.628 Vali Acc: 0.262 Test Loss: 1.628 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2001700401306152
Epoch: 14, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.779 Vali Acc: 0.259 Test Loss: 1.779 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1355478763580322
Epoch: 15, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.663 Vali Acc: 0.262 Test Loss: 1.663 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2481913566589355
Epoch: 16, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.633 Vali Acc: 0.278 Test Loss: 1.633 Test Acc: 0.278
Validation loss decreased (-0.273749 --> -0.277550).  Saving model ...
Epoch: 17 cost time: 1.3261737823486328
Epoch: 17, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.705 Vali Acc: 0.232 Test Loss: 1.705 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3693256378173828
Epoch: 18, Steps: 17 | Train Loss: 1.015 Vali Loss: 2.017 Vali Acc: 0.255 Test Loss: 2.017 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3092389106750488
Epoch: 19, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.940 Vali Acc: 0.247 Test Loss: 1.940 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.495046854019165
Epoch: 20, Steps: 17 | Train Loss: 0.963 Vali Loss: 1.763 Vali Acc: 0.247 Test Loss: 1.763 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4338397979736328
Epoch: 21, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.897 Vali Acc: 0.270 Test Loss: 1.897 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.368643045425415
Epoch: 22, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.997 Vali Acc: 0.300 Test Loss: 1.997 Test Acc: 0.300
Validation loss decreased (-0.277550 --> -0.300360).  Saving model ...
Epoch: 23 cost time: 1.2888305187225342
Epoch: 23, Steps: 17 | Train Loss: 0.884 Vali Loss: 2.022 Vali Acc: 0.240 Test Loss: 2.022 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3357994556427002
Epoch: 24, Steps: 17 | Train Loss: 0.769 Vali Loss: 1.941 Vali Acc: 0.240 Test Loss: 1.941 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4140231609344482
Epoch: 25, Steps: 17 | Train Loss: 0.810 Vali Loss: 2.183 Vali Acc: 0.266 Test Loss: 2.183 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3967339992523193
Epoch: 26, Steps: 17 | Train Loss: 0.778 Vali Loss: 2.078 Vali Acc: 0.255 Test Loss: 2.078 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3255913257598877
Epoch: 27, Steps: 17 | Train Loss: 0.881 Vali Loss: 2.118 Vali Acc: 0.262 Test Loss: 2.118 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.302675485610962
Epoch: 28, Steps: 17 | Train Loss: 0.815 Vali Loss: 2.103 Vali Acc: 0.240 Test Loss: 2.103 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4225189685821533
Epoch: 29, Steps: 17 | Train Loss: 0.776 Vali Loss: 2.402 Vali Acc: 0.259 Test Loss: 2.402 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4452846050262451
Epoch: 30, Steps: 17 | Train Loss: 0.750 Vali Loss: 2.339 Vali Acc: 0.259 Test Loss: 2.339 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.418203353881836
Epoch: 31, Steps: 17 | Train Loss: 0.773 Vali Loss: 2.340 Vali Acc: 0.270 Test Loss: 2.340 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2481591701507568
Epoch: 32, Steps: 17 | Train Loss: 0.701 Vali Loss: 3.028 Vali Acc: 0.300 Test Loss: 3.028 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 102660
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.318026542663574
Epoch: 1, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.434 Vali Acc: 0.266 Test Loss: 1.434 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 1.3209826946258545
Epoch: 2, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.423 Vali Acc: 0.278 Test Loss: 1.423 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 1.4393744468688965
Epoch: 3, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.462 Vali Acc: 0.243 Test Loss: 1.462 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.243612289428711
Epoch: 4, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.433 Vali Acc: 0.274 Test Loss: 1.433 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3768844604492188
Epoch: 5, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.462 Vali Acc: 0.259 Test Loss: 1.462 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3716511726379395
Epoch: 6, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.492 Vali Acc: 0.255 Test Loss: 1.492 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3699729442596436
Epoch: 7, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.519 Vali Acc: 0.278 Test Loss: 1.519 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2944588661193848
Epoch: 8, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.614 Vali Acc: 0.243 Test Loss: 1.614 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3586010932922363
Epoch: 9, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.515 Vali Acc: 0.228 Test Loss: 1.515 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3354430198669434
Epoch: 10, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.586 Vali Acc: 0.262 Test Loss: 1.586 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4279818534851074
Epoch: 11, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.657 Vali Acc: 0.251 Test Loss: 1.657 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3137154579162598
Epoch: 12, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.776 Vali Acc: 0.274 Test Loss: 1.776 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 95492
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4167306423187256
Epoch: 1, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.459 Vali Acc: 0.255 Test Loss: 1.459 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 1.3899242877960205
Epoch: 2, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 1.3849647045135498
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.430 Vali Acc: 0.251 Test Loss: 1.430 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3736484050750732
Epoch: 4, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.439 Vali Acc: 0.255 Test Loss: 1.439 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.412001132965088
Epoch: 5, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.465 Vali Acc: 0.270 Test Loss: 1.465 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3443901538848877
Epoch: 6, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.476 Vali Acc: 0.251 Test Loss: 1.476 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3811533451080322
Epoch: 7, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.530 Vali Acc: 0.266 Test Loss: 1.530 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.373520851135254
Epoch: 8, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.544 Vali Acc: 0.262 Test Loss: 1.544 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4728333950042725
Epoch: 9, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.469 Vali Acc: 0.243 Test Loss: 1.469 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.409576177597046
Epoch: 10, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.485 Vali Acc: 0.224 Test Loss: 1.485 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.435840368270874
Epoch: 11, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.537 Vali Acc: 0.251 Test Loss: 1.537 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2691292762756348
Epoch: 12, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.537 Vali Acc: 0.255 Test Loss: 1.537 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 92932
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0870320796966553
Epoch: 1, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.406 Vali Acc: 0.247 Test Loss: 1.406 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.2643966674804688
Epoch: 2, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.426 Vali Acc: 0.289 Test Loss: 1.426 Test Acc: 0.289
Validation loss decreased (-0.247134 --> -0.288959).  Saving model ...
Epoch: 3 cost time: 1.1673517227172852
Epoch: 3, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.407 Vali Acc: 0.247 Test Loss: 1.407 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3031492233276367
Epoch: 4, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.429 Vali Acc: 0.262 Test Loss: 1.429 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.412243127822876
Epoch: 5, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.552 Vali Acc: 0.274 Test Loss: 1.552 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3449392318725586
Epoch: 6, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.465 Vali Acc: 0.240 Test Loss: 1.465 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.268874168395996
Epoch: 7, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.469 Vali Acc: 0.255 Test Loss: 1.469 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3164801597595215
Epoch: 8, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.527 Vali Acc: 0.281 Test Loss: 1.527 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3435919284820557
Epoch: 9, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.465 Vali Acc: 0.251 Test Loss: 1.465 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2158598899841309
Epoch: 10, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.502 Vali Acc: 0.232 Test Loss: 1.502 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2970664501190186
Epoch: 11, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.497 Vali Acc: 0.251 Test Loss: 1.497 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3899016380310059
Epoch: 12, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.563 Vali Acc: 0.262 Test Loss: 1.563 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 93892
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.412454128265381
Epoch: 1, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.443 Vali Acc: 0.293 Test Loss: 1.443 Test Acc: 0.293
Validation loss decreased (inf --> -0.292761).  Saving model ...
Epoch: 2 cost time: 1.3299610614776611
Epoch: 2, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.424 Vali Acc: 0.259 Test Loss: 1.424 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3479042053222656
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.424 Vali Acc: 0.274 Test Loss: 1.424 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2185866832733154
Epoch: 4, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.427 Vali Acc: 0.270 Test Loss: 1.427 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3396952152252197
Epoch: 5, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.475 Vali Acc: 0.255 Test Loss: 1.475 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3126506805419922
Epoch: 6, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.440 Vali Acc: 0.266 Test Loss: 1.440 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3508963584899902
Epoch: 7, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.457 Vali Acc: 0.281 Test Loss: 1.457 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2887341976165771
Epoch: 8, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.467 Vali Acc: 0.240 Test Loss: 1.467 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.327819585800171
Epoch: 9, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.475 Vali Acc: 0.281 Test Loss: 1.475 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.289862871170044
Epoch: 10, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.623 Vali Acc: 0.262 Test Loss: 1.623 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2305710315704346
Epoch: 11, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.564 Vali Acc: 0.255 Test Loss: 1.564 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 96452
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3635177612304688
Epoch: 1, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.406 Vali Acc: 0.217 Test Loss: 1.406 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 1.3185784816741943
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.408 Vali Acc: 0.255 Test Loss: 1.408 Test Acc: 0.255
Validation loss decreased (-0.216716 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.4380452632904053
Epoch: 3, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.416 Vali Acc: 0.247 Test Loss: 1.416 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4290416240692139
Epoch: 4, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.409 Vali Acc: 0.247 Test Loss: 1.409 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5207796096801758
Epoch: 5, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.440 Vali Acc: 0.266 Test Loss: 1.440 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266145).  Saving model ...
Epoch: 6 cost time: 1.387260913848877
Epoch: 6, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.446 Vali Acc: 0.266 Test Loss: 1.446 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5207202434539795
Epoch: 7, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.466 Vali Acc: 0.243 Test Loss: 1.466 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.158599615097046
Epoch: 8, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.455 Vali Acc: 0.270 Test Loss: 1.455 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269947).  Saving model ...
Epoch: 9 cost time: 1.4470796585083008
Epoch: 9, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.463 Vali Acc: 0.255 Test Loss: 1.463 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4795641899108887
Epoch: 10, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.488 Vali Acc: 0.247 Test Loss: 1.488 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3974294662475586
Epoch: 11, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.535 Vali Acc: 0.278 Test Loss: 1.535 Test Acc: 0.278
Validation loss decreased (-0.269947 --> -0.277551).  Saving model ...
Epoch: 12 cost time: 1.4631857872009277
Epoch: 12, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.509 Vali Acc: 0.289 Test Loss: 1.509 Test Acc: 0.289
Validation loss decreased (-0.277551 --> -0.288958).  Saving model ...
Epoch: 13 cost time: 1.4316959381103516
Epoch: 13, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.603 Vali Acc: 0.221 Test Loss: 1.603 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4802279472351074
Epoch: 14, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.595 Vali Acc: 0.259 Test Loss: 1.595 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2986342906951904
Epoch: 15, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.605 Vali Acc: 0.243 Test Loss: 1.605 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4151909351348877
Epoch: 16, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.624 Vali Acc: 0.224 Test Loss: 1.624 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4300272464752197
Epoch: 17, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.803 Vali Acc: 0.281 Test Loss: 1.803 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.392063856124878
Epoch: 18, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.644 Vali Acc: 0.266 Test Loss: 1.644 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4923770427703857
Epoch: 19, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.786 Vali Acc: 0.247 Test Loss: 1.786 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4478144645690918
Epoch: 20, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.652 Vali Acc: 0.251 Test Loss: 1.652 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4347457885742188
Epoch: 21, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.661 Vali Acc: 0.236 Test Loss: 1.661 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4328410625457764
Epoch: 22, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.690 Vali Acc: 0.274 Test Loss: 1.690 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df128_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 100484
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.925795793533325
Epoch: 1, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 2.0512208938598633
Epoch: 2, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.536 Vali Acc: 0.255 Test Loss: 1.536 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.141885757446289
Epoch: 3, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.837 Vali Acc: 0.255 Test Loss: 1.837 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2983834743499756
Epoch: 4, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.520 Vali Acc: 0.243 Test Loss: 1.520 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3314168453216553
Epoch: 5, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.485 Vali Acc: 0.251 Test Loss: 1.485 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.44596266746521
Epoch: 6, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.911 Vali Acc: 0.266 Test Loss: 1.911 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266141).  Saving model ...
Epoch: 7 cost time: 2.3704302310943604
Epoch: 7, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.618 Vali Acc: 0.259 Test Loss: 1.618 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3705697059631348
Epoch: 8, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.717 Vali Acc: 0.270 Test Loss: 1.717 Test Acc: 0.270
Validation loss decreased (-0.266141 --> -0.269945).  Saving model ...
Epoch: 9 cost time: 2.5171401500701904
Epoch: 9, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.533 Vali Acc: 0.217 Test Loss: 1.533 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.438666343688965
Epoch: 10, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.685 Vali Acc: 0.259 Test Loss: 1.685 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.335261106491089
Epoch: 11, Steps: 17 | Train Loss: 1.175 Vali Loss: 2.214 Vali Acc: 0.251 Test Loss: 2.214 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4643585681915283
Epoch: 12, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.731 Vali Acc: 0.251 Test Loss: 1.731 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5512630939483643
Epoch: 13, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.871 Vali Acc: 0.251 Test Loss: 1.871 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.171597480773926
Epoch: 14, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.695 Vali Acc: 0.240 Test Loss: 1.695 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2049121856689453
Epoch: 15, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.861 Vali Acc: 0.247 Test Loss: 1.861 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9056236743927002
Epoch: 16, Steps: 17 | Train Loss: 1.105 Vali Loss: 2.399 Vali Acc: 0.221 Test Loss: 2.399 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.03255558013916
Epoch: 17, Steps: 17 | Train Loss: 0.944 Vali Loss: 1.894 Vali Acc: 0.262 Test Loss: 1.894 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1620733737945557
Epoch: 18, Steps: 17 | Train Loss: 1.014 Vali Loss: 2.112 Vali Acc: 0.262 Test Loss: 2.112 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 114052
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8767623901367188
Epoch: 1, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.419 Vali Acc: 0.251 Test Loss: 1.419 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.3447504043579102
Epoch: 2, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.422 Vali Acc: 0.240 Test Loss: 1.422 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5214316844940186
Epoch: 3, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.637 Vali Acc: 0.255 Test Loss: 1.637 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254736).  Saving model ...
Epoch: 4 cost time: 1.4620239734649658
Epoch: 4, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.515 Vali Acc: 0.255 Test Loss: 1.515 Test Acc: 0.255
Validation loss decreased (-0.254736 --> -0.254738).  Saving model ...
Epoch: 5 cost time: 1.446648359298706
Epoch: 5, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.512 Vali Acc: 0.259 Test Loss: 1.512 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258540).  Saving model ...
Epoch: 6 cost time: 1.3439419269561768
Epoch: 6, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.519 Vali Acc: 0.297 Test Loss: 1.519 Test Acc: 0.297
Validation loss decreased (-0.258540 --> -0.296563).  Saving model ...
Epoch: 7 cost time: 1.482654333114624
Epoch: 7, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.550 Vali Acc: 0.259 Test Loss: 1.550 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.538867712020874
Epoch: 8, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.505 Vali Acc: 0.278 Test Loss: 1.505 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.396416187286377
Epoch: 9, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.620 Vali Acc: 0.243 Test Loss: 1.620 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3203554153442383
Epoch: 10, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.608 Vali Acc: 0.266 Test Loss: 1.608 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3507764339447021
Epoch: 11, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.703 Vali Acc: 0.228 Test Loss: 1.703 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4723424911499023
Epoch: 12, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.861 Vali Acc: 0.270 Test Loss: 1.861 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.298576831817627
Epoch: 13, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.610 Vali Acc: 0.278 Test Loss: 1.610 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3065059185028076
Epoch: 14, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.745 Vali Acc: 0.285 Test Loss: 1.745 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2454643249511719
Epoch: 15, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.588 Vali Acc: 0.228 Test Loss: 1.588 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.332451343536377
Epoch: 16, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.673 Vali Acc: 0.266 Test Loss: 1.673 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 86148
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.014857769012451
Epoch: 1, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.400 Vali Acc: 0.270 Test Loss: 1.400 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.292773962020874
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.438 Vali Acc: 0.259 Test Loss: 1.438 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.33652663230896
Epoch: 3, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.504 Vali Acc: 0.247 Test Loss: 1.504 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.474445104598999
Epoch: 4, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.433 Vali Acc: 0.266 Test Loss: 1.433 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4316275119781494
Epoch: 5, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.471 Vali Acc: 0.323 Test Loss: 1.471 Test Acc: 0.323
Validation loss decreased (-0.269948 --> -0.323179).  Saving model ...
Epoch: 6 cost time: 1.2747957706451416
Epoch: 6, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.492 Vali Acc: 0.251 Test Loss: 1.492 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.326646089553833
Epoch: 7, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.457 Vali Acc: 0.243 Test Loss: 1.457 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3432128429412842
Epoch: 8, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.702 Vali Acc: 0.247 Test Loss: 1.702 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2971258163452148
Epoch: 9, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.586 Vali Acc: 0.259 Test Loss: 1.586 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3589575290679932
Epoch: 10, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.554 Vali Acc: 0.266 Test Loss: 1.554 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.467268705368042
Epoch: 11, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.610 Vali Acc: 0.262 Test Loss: 1.610 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.286954402923584
Epoch: 12, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.576 Vali Acc: 0.243 Test Loss: 1.576 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.306624412536621
Epoch: 13, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.801 Vali Acc: 0.224 Test Loss: 1.801 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3933379650115967
Epoch: 14, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.560 Vali Acc: 0.224 Test Loss: 1.560 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2962455749511719
Epoch: 15, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.610 Vali Acc: 0.232 Test Loss: 1.610 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3231939163498099
model parameter : 78980
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0627341270446777
Epoch: 1, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.411 Vali Acc: 0.228 Test Loss: 1.411 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 1.324256420135498
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.427 Vali Acc: 0.247 Test Loss: 1.427 Test Acc: 0.247
Validation loss decreased (-0.228123 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.3190629482269287
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.439 Vali Acc: 0.243 Test Loss: 1.439 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.258415937423706
Epoch: 4, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.415 Vali Acc: 0.270 Test Loss: 1.415 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 1.20159912109375
Epoch: 5, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.525 Vali Acc: 0.232 Test Loss: 1.525 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3120219707489014
Epoch: 6, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.423 Vali Acc: 0.259 Test Loss: 1.423 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1994493007659912
Epoch: 7, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.633 Vali Acc: 0.259 Test Loss: 1.633 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1046271324157715
Epoch: 8, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.492 Vali Acc: 0.251 Test Loss: 1.492 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.159271240234375
Epoch: 9, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.534 Vali Acc: 0.232 Test Loss: 1.534 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2402732372283936
Epoch: 10, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.496 Vali Acc: 0.224 Test Loss: 1.496 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1577200889587402
Epoch: 11, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.677 Vali Acc: 0.255 Test Loss: 1.677 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2830145359039307
Epoch: 12, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.571 Vali Acc: 0.236 Test Loss: 1.571 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.208146095275879
Epoch: 13, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.606 Vali Acc: 0.236 Test Loss: 1.606 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.249068021774292
Epoch: 14, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.691 Vali Acc: 0.221 Test Loss: 1.691 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 76420
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1765871047973633
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.405 Vali Acc: 0.262 Test Loss: 1.405 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.3718791007995605
Epoch: 2, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.408 Vali Acc: 0.259 Test Loss: 1.408 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3486347198486328
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.397 Vali Acc: 0.232 Test Loss: 1.397 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2956411838531494
Epoch: 4, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.433 Vali Acc: 0.266 Test Loss: 1.433 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 1.2901296615600586
Epoch: 5, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.467 Vali Acc: 0.243 Test Loss: 1.467 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3260962963104248
Epoch: 6, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.453 Vali Acc: 0.251 Test Loss: 1.453 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2913782596588135
Epoch: 7, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.456 Vali Acc: 0.266 Test Loss: 1.456 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5016016960144043
Epoch: 8, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.500 Vali Acc: 0.270 Test Loss: 1.500 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269947).  Saving model ...
Epoch: 9 cost time: 1.2635138034820557
Epoch: 9, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.446 Vali Acc: 0.266 Test Loss: 1.446 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5345487594604492
Epoch: 10, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.533 Vali Acc: 0.240 Test Loss: 1.533 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3662776947021484
Epoch: 11, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.512 Vali Acc: 0.255 Test Loss: 1.512 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4581475257873535
Epoch: 12, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.540 Vali Acc: 0.243 Test Loss: 1.540 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1641247272491455
Epoch: 13, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.514 Vali Acc: 0.209 Test Loss: 1.514 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4110126495361328
Epoch: 14, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.524 Vali Acc: 0.247 Test Loss: 1.524 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3366668224334717
Epoch: 15, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.519 Vali Acc: 0.270 Test Loss: 1.519 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4718291759490967
Epoch: 16, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.570 Vali Acc: 0.266 Test Loss: 1.570 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3898723125457764
Epoch: 17, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.612 Vali Acc: 0.278 Test Loss: 1.612 Test Acc: 0.278
Validation loss decreased (-0.269947 --> -0.277550).  Saving model ...
Epoch: 18 cost time: 1.3067009449005127
Epoch: 18, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.661 Vali Acc: 0.270 Test Loss: 1.661 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3804652690887451
Epoch: 19, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.675 Vali Acc: 0.255 Test Loss: 1.675 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3741538524627686
Epoch: 20, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.700 Vali Acc: 0.297 Test Loss: 1.700 Test Acc: 0.297
Validation loss decreased (-0.277550 --> -0.296561).  Saving model ...
Epoch: 21 cost time: 1.3135924339294434
Epoch: 21, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.614 Vali Acc: 0.255 Test Loss: 1.614 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5026705265045166
Epoch: 22, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.753 Vali Acc: 0.236 Test Loss: 1.753 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2787973880767822
Epoch: 23, Steps: 17 | Train Loss: 0.965 Vali Loss: 2.048 Vali Acc: 0.270 Test Loss: 2.048 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3461110591888428
Epoch: 24, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.786 Vali Acc: 0.266 Test Loss: 1.786 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2483363151550293
Epoch: 25, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.779 Vali Acc: 0.259 Test Loss: 1.779 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3595306873321533
Epoch: 26, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.790 Vali Acc: 0.251 Test Loss: 1.790 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.155090093612671
Epoch: 27, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.778 Vali Acc: 0.278 Test Loss: 1.778 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3348402976989746
Epoch: 28, Steps: 17 | Train Loss: 0.881 Vali Loss: 2.015 Vali Acc: 0.285 Test Loss: 2.015 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.178875207901001
Epoch: 29, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.859 Vali Acc: 0.270 Test Loss: 1.859 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3581311702728271
Epoch: 30, Steps: 17 | Train Loss: 0.844 Vali Loss: 2.121 Vali Acc: 0.281 Test Loss: 2.121 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 77380
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9820384979248047
Epoch: 1, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.405 Vali Acc: 0.240 Test Loss: 1.405 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.2814061641693115
Epoch: 2, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.409 Vali Acc: 0.270 Test Loss: 1.409 Test Acc: 0.270
Validation loss decreased (-0.239530 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 1.262096881866455
Epoch: 3, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.411 Vali Acc: 0.262 Test Loss: 1.411 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3395299911499023
Epoch: 4, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.414 Vali Acc: 0.221 Test Loss: 1.414 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.242314338684082
Epoch: 5, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.433 Vali Acc: 0.236 Test Loss: 1.433 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3781335353851318
Epoch: 6, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.441 Vali Acc: 0.228 Test Loss: 1.441 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3307788372039795
Epoch: 7, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.435 Vali Acc: 0.240 Test Loss: 1.435 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2294039726257324
Epoch: 8, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.469 Vali Acc: 0.270 Test Loss: 1.469 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3578627109527588
Epoch: 9, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.495 Vali Acc: 0.247 Test Loss: 1.495 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1632118225097656
Epoch: 10, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.545 Vali Acc: 0.209 Test Loss: 1.545 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1322526931762695
Epoch: 11, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.489 Vali Acc: 0.228 Test Loss: 1.489 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2426998615264893
Epoch: 12, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.554 Vali Acc: 0.243 Test Loss: 1.554 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 79940
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7424893379211426
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.413 Vali Acc: 0.274 Test Loss: 1.413 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.5012907981872559
Epoch: 2, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.417 Vali Acc: 0.278 Test Loss: 1.417 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 1.2841665744781494
Epoch: 3, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.408 Vali Acc: 0.278 Test Loss: 1.408 Test Acc: 0.278
Validation loss decreased (-0.277552 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 1.2385530471801758
Epoch: 4, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.436 Vali Acc: 0.266 Test Loss: 1.436 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.300175666809082
Epoch: 5, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.553 Vali Acc: 0.243 Test Loss: 1.553 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1833055019378662
Epoch: 6, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.427 Vali Acc: 0.274 Test Loss: 1.427 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.388073444366455
Epoch: 7, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.445 Vali Acc: 0.232 Test Loss: 1.445 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2677364349365234
Epoch: 8, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.489 Vali Acc: 0.274 Test Loss: 1.489 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2988152503967285
Epoch: 9, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.451 Vali Acc: 0.266 Test Loss: 1.451 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3616054058074951
Epoch: 10, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.448 Vali Acc: 0.270 Test Loss: 1.448 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3119676113128662
Epoch: 11, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.458 Vali Acc: 0.255 Test Loss: 1.458 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4732873439788818
Epoch: 12, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.499 Vali Acc: 0.297 Test Loss: 1.499 Test Acc: 0.297
Validation loss decreased (-0.277552 --> -0.296563).  Saving model ...
Epoch: 13 cost time: 1.316981315612793
Epoch: 13, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.482 Vali Acc: 0.228 Test Loss: 1.482 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1272087097167969
Epoch: 14, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.482 Vali Acc: 0.278 Test Loss: 1.482 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.303360939025879
Epoch: 15, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.728 Vali Acc: 0.262 Test Loss: 1.728 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1197807788848877
Epoch: 16, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.515 Vali Acc: 0.259 Test Loss: 1.515 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4581997394561768
Epoch: 17, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.590 Vali Acc: 0.270 Test Loss: 1.590 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2091515064239502
Epoch: 18, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.574 Vali Acc: 0.266 Test Loss: 1.574 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3190300464630127
Epoch: 19, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.660 Vali Acc: 0.293 Test Loss: 1.660 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3544857501983643
Epoch: 20, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.789 Vali Acc: 0.251 Test Loss: 1.789 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2341604232788086
Epoch: 21, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.690 Vali Acc: 0.255 Test Loss: 1.690 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2579987049102783
Epoch: 22, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.888 Vali Acc: 0.289 Test Loss: 1.888 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm64_nh16_df64_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 83972
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2564828395843506
Epoch: 1, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.439 Vali Acc: 0.262 Test Loss: 1.439 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.3480710983276367
Epoch: 2, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.450 Vali Acc: 0.274 Test Loss: 1.450 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 1.517439603805542
Epoch: 3, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.386 Vali Acc: 0.289 Test Loss: 1.386 Test Acc: 0.289
Validation loss decreased (-0.273750 --> -0.288960).  Saving model ...
Epoch: 4 cost time: 1.2221200466156006
Epoch: 4, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.529 Vali Acc: 0.259 Test Loss: 1.529 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3593108654022217
Epoch: 5, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.537 Vali Acc: 0.262 Test Loss: 1.537 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.213301420211792
Epoch: 6, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.489 Vali Acc: 0.274 Test Loss: 1.489 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1893997192382812
Epoch: 7, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.488 Vali Acc: 0.251 Test Loss: 1.488 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4309895038604736
Epoch: 8, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.567 Vali Acc: 0.270 Test Loss: 1.567 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1069915294647217
Epoch: 9, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.578 Vali Acc: 0.228 Test Loss: 1.578 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5069785118103027
Epoch: 10, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.548 Vali Acc: 0.232 Test Loss: 1.548 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.328352689743042
Epoch: 11, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.716 Vali Acc: 0.224 Test Loss: 1.716 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2132322788238525
Epoch: 12, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.626 Vali Acc: 0.278 Test Loss: 1.626 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5194461345672607
Epoch: 13, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.609 Vali Acc: 0.266 Test Loss: 1.609 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 73860
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.034001588821411
Epoch: 1, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.445 Vali Acc: 0.259 Test Loss: 1.445 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.1835768222808838
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.397 Vali Acc: 0.240 Test Loss: 1.397 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.177934169769287
Epoch: 3, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.435 Vali Acc: 0.281 Test Loss: 1.435 Test Acc: 0.281
Validation loss decreased (-0.258541 --> -0.281354).  Saving model ...
Epoch: 4 cost time: 1.100733757019043
Epoch: 4, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.439 Vali Acc: 0.262 Test Loss: 1.439 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2546100616455078
Epoch: 5, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.449 Vali Acc: 0.262 Test Loss: 1.449 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.080979347229004
Epoch: 6, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.437 Vali Acc: 0.259 Test Loss: 1.437 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3312592506408691
Epoch: 7, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.515 Vali Acc: 0.251 Test Loss: 1.515 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2361183166503906
Epoch: 8, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.448 Vali Acc: 0.236 Test Loss: 1.448 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0120067596435547
Epoch: 9, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.563 Vali Acc: 0.259 Test Loss: 1.563 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1815211772918701
Epoch: 10, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.562 Vali Acc: 0.266 Test Loss: 1.562 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1439380645751953
Epoch: 11, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.563 Vali Acc: 0.247 Test Loss: 1.563 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.28277587890625
Epoch: 12, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.549 Vali Acc: 0.259 Test Loss: 1.549 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.203160285949707
Epoch: 13, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.716 Vali Acc: 0.251 Test Loss: 1.716 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 59908
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0320920944213867
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.389 Vali Acc: 0.278 Test Loss: 1.389 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 1.080568790435791
Epoch: 2, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.387 Vali Acc: 0.266 Test Loss: 1.387 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1575610637664795
Epoch: 3, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.382 Vali Acc: 0.297 Test Loss: 1.382 Test Acc: 0.297
Validation loss decreased (-0.277553 --> -0.296564).  Saving model ...
Epoch: 4 cost time: 1.2485535144805908
Epoch: 4, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.415 Vali Acc: 0.243 Test Loss: 1.415 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2709789276123047
Epoch: 5, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.429 Vali Acc: 0.266 Test Loss: 1.429 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1778278350830078
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.406 Vali Acc: 0.243 Test Loss: 1.406 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2417819499969482
Epoch: 7, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.419 Vali Acc: 0.266 Test Loss: 1.419 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1839606761932373
Epoch: 8, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.477 Vali Acc: 0.255 Test Loss: 1.477 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0459730625152588
Epoch: 9, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.450 Vali Acc: 0.262 Test Loss: 1.450 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9988255500793457
Epoch: 10, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.525 Vali Acc: 0.262 Test Loss: 1.525 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.153550148010254
Epoch: 11, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.461 Vali Acc: 0.236 Test Loss: 1.461 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4355580806732178
Epoch: 12, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.486 Vali Acc: 0.281 Test Loss: 1.486 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1075589656829834
Epoch: 13, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.483 Vali Acc: 0.274 Test Loss: 1.483 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 56324
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.945972204208374
Epoch: 1, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.405 Vali Acc: 0.285 Test Loss: 1.405 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 1.2025985717773438
Epoch: 2, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.407 Vali Acc: 0.255 Test Loss: 1.407 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.104917287826538
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.402 Vali Acc: 0.262 Test Loss: 1.402 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3878202438354492
Epoch: 4, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.395 Vali Acc: 0.278 Test Loss: 1.395 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2491278648376465
Epoch: 5, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.419 Vali Acc: 0.278 Test Loss: 1.419 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.212301254272461
Epoch: 6, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.403 Vali Acc: 0.300 Test Loss: 1.403 Test Acc: 0.300
Validation loss decreased (-0.285157 --> -0.300366).  Saving model ...
Epoch: 7 cost time: 1.1372904777526855
Epoch: 7, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.433 Vali Acc: 0.259 Test Loss: 1.433 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1495542526245117
Epoch: 8, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.412 Vali Acc: 0.247 Test Loss: 1.412 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3233344554901123
Epoch: 9, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.457 Vali Acc: 0.285 Test Loss: 1.457 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0402660369873047
Epoch: 10, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.444 Vali Acc: 0.224 Test Loss: 1.444 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9844982624053955
Epoch: 11, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.597 Vali Acc: 0.270 Test Loss: 1.597 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2056686878204346
Epoch: 12, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.479 Vali Acc: 0.240 Test Loss: 1.479 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0175013542175293
Epoch: 13, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.464 Vali Acc: 0.232 Test Loss: 1.464 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0437579154968262
Epoch: 14, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.517 Vali Acc: 0.232 Test Loss: 1.517 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.131087064743042
Epoch: 15, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.568 Vali Acc: 0.243 Test Loss: 1.568 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1997103691101074
Epoch: 16, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.568 Vali Acc: 0.236 Test Loss: 1.568 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 55044
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0002152919769287
Epoch: 1, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.402 Vali Acc: 0.289 Test Loss: 1.402 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 1.2267653942108154
Epoch: 2, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.397 Vali Acc: 0.236 Test Loss: 1.397 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2694218158721924
Epoch: 3, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2780570983886719
Epoch: 4, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.387 Vali Acc: 0.255 Test Loss: 1.387 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4571242332458496
Epoch: 5, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.404 Vali Acc: 0.266 Test Loss: 1.404 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.419313907623291
Epoch: 6, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.397 Vali Acc: 0.251 Test Loss: 1.397 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5226247310638428
Epoch: 7, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.397 Vali Acc: 0.243 Test Loss: 1.397 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.305833339691162
Epoch: 8, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.404 Vali Acc: 0.270 Test Loss: 1.404 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4007859230041504
Epoch: 9, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.433 Vali Acc: 0.266 Test Loss: 1.433 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4067339897155762
Epoch: 10, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.445 Vali Acc: 0.251 Test Loss: 1.445 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4302539825439453
Epoch: 11, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.439 Vali Acc: 0.236 Test Loss: 1.439 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 55524
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.076882839202881
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.393 Vali Acc: 0.281 Test Loss: 1.393 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 1.143570899963379
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.400 Vali Acc: 0.255 Test Loss: 1.400 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3100612163543701
Epoch: 3, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.394 Vali Acc: 0.251 Test Loss: 1.394 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2279069423675537
Epoch: 4, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.419 Vali Acc: 0.281 Test Loss: 1.419 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.359438419342041
Epoch: 5, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.398 Vali Acc: 0.270 Test Loss: 1.398 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3847630023956299
Epoch: 6, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.404 Vali Acc: 0.278 Test Loss: 1.404 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3621387481689453
Epoch: 7, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.429 Vali Acc: 0.251 Test Loss: 1.429 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.520688533782959
Epoch: 8, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.442 Vali Acc: 0.247 Test Loss: 1.442 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3575348854064941
Epoch: 9, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.461 Vali Acc: 0.247 Test Loss: 1.461 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.32969069480896
Epoch: 10, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.457 Vali Acc: 0.262 Test Loss: 1.457 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2995517253875732
Epoch: 11, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.499 Vali Acc: 0.274 Test Loss: 1.499 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 56804
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3627452850341797
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.399 Vali Acc: 0.259 Test Loss: 1.399 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.3050920963287354
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.418 Vali Acc: 0.259 Test Loss: 1.418 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3026244640350342
Epoch: 3, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.395 Vali Acc: 0.243 Test Loss: 1.395 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3596339225769043
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.400 Vali Acc: 0.293 Test Loss: 1.400 Test Acc: 0.293
Validation loss decreased (-0.258541 --> -0.292762).  Saving model ...
Epoch: 5 cost time: 1.4928250312805176
Epoch: 5, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.393 Vali Acc: 0.270 Test Loss: 1.393 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3636729717254639
Epoch: 6, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.425 Vali Acc: 0.232 Test Loss: 1.425 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3445765972137451
Epoch: 7, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.432 Vali Acc: 0.293 Test Loss: 1.432 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2609498500823975
Epoch: 8, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.424 Vali Acc: 0.259 Test Loss: 1.424 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3286347389221191
Epoch: 9, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.429 Vali Acc: 0.259 Test Loss: 1.429 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2838201522827148
Epoch: 10, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.487 Vali Acc: 0.293 Test Loss: 1.487 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2646522521972656
Epoch: 11, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.455 Vali Acc: 0.251 Test Loss: 1.455 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.316732406616211
Epoch: 12, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.480 Vali Acc: 0.255 Test Loss: 1.480 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2989537715911865
Epoch: 13, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.489 Vali Acc: 0.270 Test Loss: 1.489 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3582568168640137
Epoch: 14, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.533 Vali Acc: 0.247 Test Loss: 1.533 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df256_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 58820
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5149478912353516
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.421 Vali Acc: 0.240 Test Loss: 1.421 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.3511335849761963
Epoch: 2, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.427 Vali Acc: 0.243 Test Loss: 1.427 Test Acc: 0.243
Validation loss decreased (-0.239530 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 1.1027188301086426
Epoch: 3, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.441 Vali Acc: 0.243 Test Loss: 1.441 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3761248588562012
Epoch: 4, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.683 Vali Acc: 0.243 Test Loss: 1.683 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3181965351104736
Epoch: 5, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.454 Vali Acc: 0.240 Test Loss: 1.454 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.444131851196289
Epoch: 6, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.497 Vali Acc: 0.251 Test Loss: 1.497 Test Acc: 0.251
Validation loss decreased (-0.243332 --> -0.250936).  Saving model ...
Epoch: 7 cost time: 1.5751302242279053
Epoch: 7, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.549 Vali Acc: 0.255 Test Loss: 1.549 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254737).  Saving model ...
Epoch: 8 cost time: 1.4634382724761963
Epoch: 8, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.457 Vali Acc: 0.232 Test Loss: 1.457 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4272375106811523
Epoch: 9, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.694 Vali Acc: 0.221 Test Loss: 1.694 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4507036209106445
Epoch: 10, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.528 Vali Acc: 0.251 Test Loss: 1.528 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3632287979125977
Epoch: 11, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.613 Vali Acc: 0.228 Test Loss: 1.613 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.284947156906128
Epoch: 12, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.657 Vali Acc: 0.266 Test Loss: 1.657 Test Acc: 0.266
Validation loss decreased (-0.254737 --> -0.266143).  Saving model ...
Epoch: 13 cost time: 1.3919587135314941
Epoch: 13, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.628 Vali Acc: 0.247 Test Loss: 1.628 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3495502471923828
Epoch: 14, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.904 Vali Acc: 0.236 Test Loss: 1.904 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3248679637908936
Epoch: 15, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.650 Vali Acc: 0.221 Test Loss: 1.650 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3878850936889648
Epoch: 16, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.662 Vali Acc: 0.255 Test Loss: 1.662 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3517749309539795
Epoch: 17, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.635 Vali Acc: 0.247 Test Loss: 1.635 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4136719703674316
Epoch: 18, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.678 Vali Acc: 0.251 Test Loss: 1.678 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3631608486175537
Epoch: 19, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.783 Vali Acc: 0.251 Test Loss: 1.783 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.350006341934204
Epoch: 20, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.751 Vali Acc: 0.266 Test Loss: 1.751 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3847236633300781
Epoch: 21, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.716 Vali Acc: 0.232 Test Loss: 1.716 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3661322593688965
Epoch: 22, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.772 Vali Acc: 0.251 Test Loss: 1.772 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 57220
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.396615982055664
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.395 Vali Acc: 0.259 Test Loss: 1.395 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.4172403812408447
Epoch: 2, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.404 Vali Acc: 0.247 Test Loss: 1.404 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.49348783493042
Epoch: 3, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.427 Vali Acc: 0.247 Test Loss: 1.427 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3774678707122803
Epoch: 4, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.412 Vali Acc: 0.270 Test Loss: 1.412 Test Acc: 0.270
Validation loss decreased (-0.258541 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 1.4498894214630127
Epoch: 5, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.421 Vali Acc: 0.266 Test Loss: 1.421 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4309773445129395
Epoch: 6, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.563 Vali Acc: 0.251 Test Loss: 1.563 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4243924617767334
Epoch: 7, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.531 Vali Acc: 0.240 Test Loss: 1.531 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.569070816040039
Epoch: 8, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.520 Vali Acc: 0.255 Test Loss: 1.520 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.523273229598999
Epoch: 9, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.472 Vali Acc: 0.240 Test Loss: 1.472 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4812138080596924
Epoch: 10, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.502 Vali Acc: 0.270 Test Loss: 1.502 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4542462825775146
Epoch: 11, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.477 Vali Acc: 0.255 Test Loss: 1.477 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4151475429534912
Epoch: 12, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.657 Vali Acc: 0.251 Test Loss: 1.657 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.543076515197754
Epoch: 13, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.525 Vali Acc: 0.232 Test Loss: 1.525 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5033128261566162
Epoch: 14, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.636 Vali Acc: 0.262 Test Loss: 1.636 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 43268
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9418301582336426
Epoch: 1, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.390 Vali Acc: 0.281 Test Loss: 1.390 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 1.1949055194854736
Epoch: 2, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.399 Vali Acc: 0.270 Test Loss: 1.399 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.151582956314087
Epoch: 3, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.397 Vali Acc: 0.270 Test Loss: 1.397 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2044224739074707
Epoch: 4, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.399 Vali Acc: 0.278 Test Loss: 1.399 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3003854751586914
Epoch: 5, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.430 Vali Acc: 0.240 Test Loss: 1.430 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.304089069366455
Epoch: 6, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.419 Vali Acc: 0.262 Test Loss: 1.419 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5439908504486084
Epoch: 7, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.487 Vali Acc: 0.270 Test Loss: 1.487 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.334388256072998
Epoch: 8, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.521 Vali Acc: 0.274 Test Loss: 1.521 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4995472431182861
Epoch: 9, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.448 Vali Acc: 0.266 Test Loss: 1.448 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5090785026550293
Epoch: 10, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.547 Vali Acc: 0.262 Test Loss: 1.547 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4395203590393066
Epoch: 11, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.511 Vali Acc: 0.266 Test Loss: 1.511 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 39684
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2087175846099854
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.384 Vali Acc: 0.262 Test Loss: 1.384 Test Acc: 0.262
Validation loss decreased (inf --> -0.262344).  Saving model ...
Epoch: 2 cost time: 1.5191090106964111
Epoch: 2, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.393 Vali Acc: 0.270 Test Loss: 1.393 Test Acc: 0.270
Validation loss decreased (-0.262344 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 1.3087236881256104
Epoch: 3, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.386 Vali Acc: 0.243 Test Loss: 1.386 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.437157154083252
Epoch: 4, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.417 Vali Acc: 0.274 Test Loss: 1.417 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 1.4861960411071777
Epoch: 5, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.405 Vali Acc: 0.251 Test Loss: 1.405 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2943332195281982
Epoch: 6, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.426 Vali Acc: 0.270 Test Loss: 1.426 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5230154991149902
Epoch: 7, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.408 Vali Acc: 0.243 Test Loss: 1.408 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.343935489654541
Epoch: 8, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.507 Vali Acc: 0.266 Test Loss: 1.507 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.445131540298462
Epoch: 9, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.456 Vali Acc: 0.240 Test Loss: 1.456 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5567448139190674
Epoch: 10, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.436 Vali Acc: 0.228 Test Loss: 1.436 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4222040176391602
Epoch: 11, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.476 Vali Acc: 0.266 Test Loss: 1.476 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3497555255889893
Epoch: 12, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.512 Vali Acc: 0.285 Test Loss: 1.512 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 13 cost time: 1.5321881771087646
Epoch: 13, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.525 Vali Acc: 0.240 Test Loss: 1.525 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3813204765319824
Epoch: 14, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.480 Vali Acc: 0.217 Test Loss: 1.480 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5329444408416748
Epoch: 15, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.522 Vali Acc: 0.278 Test Loss: 1.522 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4881153106689453
Epoch: 16, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.675 Vali Acc: 0.255 Test Loss: 1.675 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5657312870025635
Epoch: 17, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.541 Vali Acc: 0.236 Test Loss: 1.541 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6200764179229736
Epoch: 18, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.569 Vali Acc: 0.240 Test Loss: 1.569 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4871125221252441
Epoch: 19, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.604 Vali Acc: 0.247 Test Loss: 1.604 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6440389156341553
Epoch: 20, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.559 Vali Acc: 0.228 Test Loss: 1.559 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4705431461334229
Epoch: 21, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.719 Vali Acc: 0.240 Test Loss: 1.719 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5925869941711426
Epoch: 22, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.692 Vali Acc: 0.247 Test Loss: 1.692 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 38404
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.236117362976074
Epoch: 1, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.403 Vali Acc: 0.297 Test Loss: 1.403 Test Acc: 0.297
Validation loss decreased (inf --> -0.296564).  Saving model ...
Epoch: 2 cost time: 1.5590558052062988
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.398 Vali Acc: 0.270 Test Loss: 1.398 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.531017541885376
Epoch: 3, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.399 Vali Acc: 0.293 Test Loss: 1.399 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2732114791870117
Epoch: 4, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.401 Vali Acc: 0.304 Test Loss: 1.401 Test Acc: 0.304
Validation loss decreased (-0.296564 --> -0.304168).  Saving model ...
Epoch: 5 cost time: 1.3099534511566162
Epoch: 5, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.418 Vali Acc: 0.270 Test Loss: 1.418 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4695780277252197
Epoch: 6, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.404 Vali Acc: 0.266 Test Loss: 1.404 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.220764398574829
Epoch: 7, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.421 Vali Acc: 0.308 Test Loss: 1.421 Test Acc: 0.308
Validation loss decreased (-0.304168 --> -0.307971).  Saving model ...
Epoch: 8 cost time: 1.3963048458099365
Epoch: 8, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.453 Vali Acc: 0.266 Test Loss: 1.453 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4013864994049072
Epoch: 9, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.452 Vali Acc: 0.289 Test Loss: 1.452 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3605477809906006
Epoch: 10, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.462 Vali Acc: 0.259 Test Loss: 1.462 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3709354400634766
Epoch: 11, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.452 Vali Acc: 0.266 Test Loss: 1.452 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4054782390594482
Epoch: 12, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.474 Vali Acc: 0.259 Test Loss: 1.474 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3100950717926025
Epoch: 13, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.560 Vali Acc: 0.240 Test Loss: 1.560 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4111988544464111
Epoch: 14, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.529 Vali Acc: 0.251 Test Loss: 1.529 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3592729568481445
Epoch: 15, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.497 Vali Acc: 0.278 Test Loss: 1.497 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.34926438331604
Epoch: 16, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.519 Vali Acc: 0.259 Test Loss: 1.519 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.513780117034912
Epoch: 17, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.587 Vali Acc: 0.262 Test Loss: 1.587 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 38884
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1667046546936035
Epoch: 1, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.429 Vali Acc: 0.217 Test Loss: 1.429 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 1.290640115737915
Epoch: 2, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.435 Vali Acc: 0.232 Test Loss: 1.435 Test Acc: 0.232
Validation loss decreased (-0.216716 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 1.4177398681640625
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.421 Vali Acc: 0.209 Test Loss: 1.421 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.256788969039917
Epoch: 4, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.424 Vali Acc: 0.251 Test Loss: 1.424 Test Acc: 0.251
Validation loss decreased (-0.231925 --> -0.250936).  Saving model ...
Epoch: 5 cost time: 1.2147126197814941
Epoch: 5, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.422 Vali Acc: 0.217 Test Loss: 1.422 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.376192569732666
Epoch: 6, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.419 Vali Acc: 0.217 Test Loss: 1.419 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3876538276672363
Epoch: 7, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.439 Vali Acc: 0.224 Test Loss: 1.439 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.341918706893921
Epoch: 8, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.434 Vali Acc: 0.262 Test Loss: 1.434 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 9 cost time: 1.2032885551452637
Epoch: 9, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.436 Vali Acc: 0.270 Test Loss: 1.436 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 10 cost time: 1.4557807445526123
Epoch: 10, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.446 Vali Acc: 0.247 Test Loss: 1.446 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3268201351165771
Epoch: 11, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.431 Vali Acc: 0.247 Test Loss: 1.431 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4705753326416016
Epoch: 12, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.450 Vali Acc: 0.266 Test Loss: 1.450 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3794665336608887
Epoch: 13, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.503 Vali Acc: 0.266 Test Loss: 1.503 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3641910552978516
Epoch: 14, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.463 Vali Acc: 0.240 Test Loss: 1.463 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4481899738311768
Epoch: 15, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.496 Vali Acc: 0.251 Test Loss: 1.496 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3966729640960693
Epoch: 16, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.566 Vali Acc: 0.243 Test Loss: 1.566 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3496720790863037
Epoch: 17, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.506 Vali Acc: 0.266 Test Loss: 1.506 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4711949825286865
Epoch: 18, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.508 Vali Acc: 0.274 Test Loss: 1.508 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273749).  Saving model ...
Epoch: 19 cost time: 1.4355857372283936
Epoch: 19, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.592 Vali Acc: 0.251 Test Loss: 1.592 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3355414867401123
Epoch: 20, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.587 Vali Acc: 0.247 Test Loss: 1.587 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2613160610198975
Epoch: 21, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.609 Vali Acc: 0.243 Test Loss: 1.609 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4201939105987549
Epoch: 22, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.543 Vali Acc: 0.293 Test Loss: 1.543 Test Acc: 0.293
Validation loss decreased (-0.273749 --> -0.292760).  Saving model ...
Epoch: 23 cost time: 1.4190170764923096
Epoch: 23, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.644 Vali Acc: 0.262 Test Loss: 1.644 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3088772296905518
Epoch: 24, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.644 Vali Acc: 0.262 Test Loss: 1.644 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3056988716125488
Epoch: 25, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.741 Vali Acc: 0.270 Test Loss: 1.741 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3373515605926514
Epoch: 26, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.666 Vali Acc: 0.255 Test Loss: 1.666 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3817317485809326
Epoch: 27, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.689 Vali Acc: 0.243 Test Loss: 1.689 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6477508544921875
Epoch: 28, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.638 Vali Acc: 0.259 Test Loss: 1.638 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4043972492218018
Epoch: 29, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.871 Vali Acc: 0.259 Test Loss: 1.871 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4498577117919922
Epoch: 30, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.765 Vali Acc: 0.270 Test Loss: 1.765 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2418015003204346
Epoch: 31, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.750 Vali Acc: 0.274 Test Loss: 1.750 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3668293952941895
Epoch: 32, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.897 Vali Acc: 0.243 Test Loss: 1.897 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 40164
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.314793586730957
Epoch: 1, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.438 Vali Acc: 0.236 Test Loss: 1.438 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.4797396659851074
Epoch: 2, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.434 Vali Acc: 0.213 Test Loss: 1.434 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2882122993469238
Epoch: 3, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.436 Vali Acc: 0.247 Test Loss: 1.436 Test Acc: 0.247
Validation loss decreased (-0.235727 --> -0.247134).  Saving model ...
Epoch: 4 cost time: 1.3276915550231934
Epoch: 4, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3052451610565186
Epoch: 5, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.436 Vali Acc: 0.266 Test Loss: 1.436 Test Acc: 0.266
Validation loss decreased (-0.247134 --> -0.266145).  Saving model ...
Epoch: 6 cost time: 1.4379138946533203
Epoch: 6, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4600498676300049
Epoch: 7, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.441 Vali Acc: 0.228 Test Loss: 1.441 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3451192378997803
Epoch: 8, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.452 Vali Acc: 0.243 Test Loss: 1.452 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2415320873260498
Epoch: 9, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.455 Vali Acc: 0.243 Test Loss: 1.455 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.414541482925415
Epoch: 10, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.490 Vali Acc: 0.243 Test Loss: 1.490 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3532147407531738
Epoch: 11, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.575 Vali Acc: 0.247 Test Loss: 1.575 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2902543544769287
Epoch: 12, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.487 Vali Acc: 0.266 Test Loss: 1.487 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2851684093475342
Epoch: 13, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.679 Vali Acc: 0.259 Test Loss: 1.679 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1589891910552979
Epoch: 14, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.525 Vali Acc: 0.255 Test Loss: 1.525 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.356168270111084
Epoch: 15, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.584 Vali Acc: 0.262 Test Loss: 1.584 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df128_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 42180
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.490649938583374
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.406 Vali Acc: 0.259 Test Loss: 1.406 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.5939173698425293
Epoch: 2, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.477 Vali Acc: 0.247 Test Loss: 1.477 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4300918579101562
Epoch: 3, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.450 Vali Acc: 0.251 Test Loss: 1.450 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4941458702087402
Epoch: 4, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
Validation loss decreased (-0.258541 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 1.514305830001831
Epoch: 5, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.468 Vali Acc: 0.240 Test Loss: 1.468 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4263174533843994
Epoch: 6, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.456 Vali Acc: 0.297 Test Loss: 1.456 Test Acc: 0.297
Validation loss decreased (-0.269948 --> -0.296563).  Saving model ...
Epoch: 7 cost time: 1.3838860988616943
Epoch: 7, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.533 Vali Acc: 0.236 Test Loss: 1.533 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4834060668945312
Epoch: 8, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.614 Vali Acc: 0.270 Test Loss: 1.614 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.509061574935913
Epoch: 9, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.595 Vali Acc: 0.251 Test Loss: 1.595 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.420562505722046
Epoch: 10, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.490 Vali Acc: 0.221 Test Loss: 1.490 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3729267120361328
Epoch: 11, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.507 Vali Acc: 0.274 Test Loss: 1.507 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4346051216125488
Epoch: 12, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.694 Vali Acc: 0.259 Test Loss: 1.694 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2608246803283691
Epoch: 13, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.567 Vali Acc: 0.251 Test Loss: 1.567 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5680279731750488
Epoch: 14, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.584 Vali Acc: 0.262 Test Loss: 1.584 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2035460472106934
Epoch: 15, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.609 Vali Acc: 0.243 Test Loss: 1.609 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4582743644714355
Epoch: 16, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.842 Vali Acc: 0.255 Test Loss: 1.842 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 48900
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.104579448699951
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.397 Vali Acc: 0.224 Test Loss: 1.397 Test Acc: 0.224
Validation loss decreased (inf --> -0.224321).  Saving model ...
Epoch: 2 cost time: 1.405233383178711
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.419 Vali Acc: 0.300 Test Loss: 1.419 Test Acc: 0.300
Validation loss decreased (-0.224321 --> -0.300366).  Saving model ...
Epoch: 3 cost time: 1.3312726020812988
Epoch: 3, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.411 Vali Acc: 0.316 Test Loss: 1.411 Test Acc: 0.316
Validation loss decreased (-0.300366 --> -0.315575).  Saving model ...
Epoch: 4 cost time: 1.4540152549743652
Epoch: 4, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.418 Vali Acc: 0.259 Test Loss: 1.418 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3102476596832275
Epoch: 5, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.415 Vali Acc: 0.251 Test Loss: 1.415 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.313910961151123
Epoch: 6, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.577 Vali Acc: 0.259 Test Loss: 1.577 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3353557586669922
Epoch: 7, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.440 Vali Acc: 0.259 Test Loss: 1.440 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3383846282958984
Epoch: 8, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.462 Vali Acc: 0.259 Test Loss: 1.462 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3243489265441895
Epoch: 9, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.545 Vali Acc: 0.274 Test Loss: 1.545 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2940587997436523
Epoch: 10, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.512 Vali Acc: 0.270 Test Loss: 1.512 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.459360122680664
Epoch: 11, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.494 Vali Acc: 0.285 Test Loss: 1.494 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4151506423950195
Epoch: 12, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.549 Vali Acc: 0.232 Test Loss: 1.549 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.346543550491333
Epoch: 13, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.547 Vali Acc: 0.240 Test Loss: 1.547 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 34948
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9887845516204834
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.424 Vali Acc: 0.240 Test Loss: 1.424 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 1.3651342391967773
Epoch: 2, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.428 Vali Acc: 0.217 Test Loss: 1.428 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2970960140228271
Epoch: 3, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.424 Vali Acc: 0.202 Test Loss: 1.424 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2925052642822266
Epoch: 4, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.422 Vali Acc: 0.221 Test Loss: 1.422 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2809631824493408
Epoch: 5, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.466 Vali Acc: 0.274 Test Loss: 1.466 Test Acc: 0.274
Validation loss decreased (-0.239529 --> -0.273750).  Saving model ...
Epoch: 6 cost time: 1.2761330604553223
Epoch: 6, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.475 Vali Acc: 0.236 Test Loss: 1.475 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3961491584777832
Epoch: 7, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.468 Vali Acc: 0.259 Test Loss: 1.468 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.414111614227295
Epoch: 8, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.439 Vali Acc: 0.232 Test Loss: 1.439 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.277062177658081
Epoch: 9, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.471 Vali Acc: 0.240 Test Loss: 1.471 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2389554977416992
Epoch: 10, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.481 Vali Acc: 0.281 Test Loss: 1.481 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281354).  Saving model ...
Epoch: 11 cost time: 1.3836019039154053
Epoch: 11, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.473 Vali Acc: 0.255 Test Loss: 1.473 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.384347677230835
Epoch: 12, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.535 Vali Acc: 0.247 Test Loss: 1.535 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3284282684326172
Epoch: 13, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.516 Vali Acc: 0.255 Test Loss: 1.516 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3916435241699219
Epoch: 14, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.515 Vali Acc: 0.259 Test Loss: 1.515 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3396742343902588
Epoch: 15, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.578 Vali Acc: 0.285 Test Loss: 1.578 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285155).  Saving model ...
Epoch: 16 cost time: 1.3719830513000488
Epoch: 16, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.518 Vali Acc: 0.251 Test Loss: 1.518 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3418464660644531
Epoch: 17, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.594 Vali Acc: 0.251 Test Loss: 1.594 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.273874282836914
Epoch: 18, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.563 Vali Acc: 0.259 Test Loss: 1.563 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3809258937835693
Epoch: 19, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.660 Vali Acc: 0.266 Test Loss: 1.660 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.352952003479004
Epoch: 20, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.662 Vali Acc: 0.266 Test Loss: 1.662 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3366286754608154
Epoch: 21, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.614 Vali Acc: 0.247 Test Loss: 1.614 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.420044183731079
Epoch: 22, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.619 Vali Acc: 0.247 Test Loss: 1.619 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3668856620788574
Epoch: 23, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.691 Vali Acc: 0.251 Test Loss: 1.691 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4049923419952393
Epoch: 24, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.862 Vali Acc: 0.262 Test Loss: 1.862 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5472781658172607
Epoch: 25, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.809 Vali Acc: 0.251 Test Loss: 1.809 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 31364
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2165679931640625
Epoch: 1, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.393 Vali Acc: 0.259 Test Loss: 1.393 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.2202701568603516
Epoch: 2, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.390 Vali Acc: 0.266 Test Loss: 1.390 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 1.200873851776123
Epoch: 3, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.391 Vali Acc: 0.247 Test Loss: 1.391 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2072796821594238
Epoch: 4, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.394 Vali Acc: 0.262 Test Loss: 1.394 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3175177574157715
Epoch: 5, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269948).  Saving model ...
Epoch: 6 cost time: 1.2396318912506104
Epoch: 6, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.399 Vali Acc: 0.266 Test Loss: 1.399 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2971291542053223
Epoch: 7, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.419 Vali Acc: 0.285 Test Loss: 1.419 Test Acc: 0.285
Validation loss decreased (-0.269948 --> -0.285157).  Saving model ...
Epoch: 8 cost time: 1.3134782314300537
Epoch: 8, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.457 Vali Acc: 0.243 Test Loss: 1.457 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.281015157699585
Epoch: 9, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.413 Vali Acc: 0.251 Test Loss: 1.413 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4462487697601318
Epoch: 10, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.467 Vali Acc: 0.259 Test Loss: 1.467 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.341935396194458
Epoch: 11, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.445 Vali Acc: 0.224 Test Loss: 1.445 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3152623176574707
Epoch: 12, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.445 Vali Acc: 0.243 Test Loss: 1.445 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3717877864837646
Epoch: 13, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.448 Vali Acc: 0.236 Test Loss: 1.448 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3759558200836182
Epoch: 14, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.557 Vali Acc: 0.243 Test Loss: 1.557 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4292871952056885
Epoch: 15, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.556 Vali Acc: 0.228 Test Loss: 1.556 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4507527351379395
Epoch: 16, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.502 Vali Acc: 0.236 Test Loss: 1.502 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.568669319152832
Epoch: 17, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.486 Vali Acc: 0.213 Test Loss: 1.486 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 30084
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2074685096740723
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.435 Vali Acc: 0.213 Test Loss: 1.435 Test Acc: 0.213
Validation loss decreased (inf --> -0.212913).  Saving model ...
Epoch: 2 cost time: 1.4480528831481934
Epoch: 2, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.432 Vali Acc: 0.251 Test Loss: 1.432 Test Acc: 0.251
Validation loss decreased (-0.212913 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 1.1201648712158203
Epoch: 3, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.436 Vali Acc: 0.213 Test Loss: 1.436 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3583731651306152
Epoch: 4, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.430 Vali Acc: 0.228 Test Loss: 1.430 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2617254257202148
Epoch: 5, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.419 Vali Acc: 0.228 Test Loss: 1.419 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.307018756866455
Epoch: 6, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.442 Vali Acc: 0.247 Test Loss: 1.442 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3955512046813965
Epoch: 7, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.433 Vali Acc: 0.259 Test Loss: 1.433 Test Acc: 0.259
Validation loss decreased (-0.250936 --> -0.258541).  Saving model ...
Epoch: 8 cost time: 1.4187052249908447
Epoch: 8, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.423 Vali Acc: 0.240 Test Loss: 1.423 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3601524829864502
Epoch: 9, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.432 Vali Acc: 0.274 Test Loss: 1.432 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 10 cost time: 1.3027801513671875
Epoch: 10, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.555 Vali Acc: 0.247 Test Loss: 1.555 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4531710147857666
Epoch: 11, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.441 Vali Acc: 0.247 Test Loss: 1.441 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2500817775726318
Epoch: 12, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.472 Vali Acc: 0.270 Test Loss: 1.472 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3819096088409424
Epoch: 13, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.443 Vali Acc: 0.266 Test Loss: 1.443 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3422350883483887
Epoch: 14, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.465 Vali Acc: 0.270 Test Loss: 1.465 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4461188316345215
Epoch: 15, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.490 Vali Acc: 0.251 Test Loss: 1.490 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2754089832305908
Epoch: 16, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.515 Vali Acc: 0.262 Test Loss: 1.515 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4478998184204102
Epoch: 17, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.502 Vali Acc: 0.228 Test Loss: 1.502 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3524580001831055
Epoch: 18, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.510 Vali Acc: 0.251 Test Loss: 1.510 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3261070251464844
Epoch: 19, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.563 Vali Acc: 0.262 Test Loss: 1.563 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 30564
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0483627319335938
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.419 Vali Acc: 0.228 Test Loss: 1.419 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 1.4706358909606934
Epoch: 2, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.421 Vali Acc: 0.232 Test Loss: 1.421 Test Acc: 0.232
Validation loss decreased (-0.228123 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 1.3432762622833252
Epoch: 3, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.407 Vali Acc: 0.243 Test Loss: 1.407 Test Acc: 0.243
Validation loss decreased (-0.231925 --> -0.243332).  Saving model ...
Epoch: 4 cost time: 1.2295894622802734
Epoch: 4, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.401 Vali Acc: 0.262 Test Loss: 1.401 Test Acc: 0.262
Validation loss decreased (-0.243332 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 1.2643322944641113
Epoch: 5, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.416 Vali Acc: 0.236 Test Loss: 1.416 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3747897148132324
Epoch: 6, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.407 Vali Acc: 0.247 Test Loss: 1.407 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3057544231414795
Epoch: 7, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.420 Vali Acc: 0.251 Test Loss: 1.420 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2387056350708008
Epoch: 8, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.449 Vali Acc: 0.247 Test Loss: 1.449 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2518415451049805
Epoch: 9, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.435 Vali Acc: 0.262 Test Loss: 1.435 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.291557788848877
Epoch: 10, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.447 Vali Acc: 0.236 Test Loss: 1.447 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3535025119781494
Epoch: 11, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.486 Vali Acc: 0.255 Test Loss: 1.486 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2295925617218018
Epoch: 12, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.452 Vali Acc: 0.232 Test Loss: 1.452 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.285374402999878
Epoch: 13, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.475 Vali Acc: 0.232 Test Loss: 1.475 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3949084281921387
Epoch: 14, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.591 Vali Acc: 0.255 Test Loss: 1.591 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 31844
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4312989711761475
Epoch: 1, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.412 Vali Acc: 0.240 Test Loss: 1.412 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.4727637767791748
Epoch: 2, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.399 Vali Acc: 0.228 Test Loss: 1.399 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3142027854919434
Epoch: 3, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.410 Vali Acc: 0.251 Test Loss: 1.410 Test Acc: 0.251
Validation loss decreased (-0.239530 --> -0.250936).  Saving model ...
Epoch: 4 cost time: 1.4841454029083252
Epoch: 4, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.398 Vali Acc: 0.228 Test Loss: 1.398 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4702091217041016
Epoch: 5, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.397 Vali Acc: 0.232 Test Loss: 1.397 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4083740711212158
Epoch: 6, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.419 Vali Acc: 0.255 Test Loss: 1.419 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254739).  Saving model ...
Epoch: 7 cost time: 1.3889460563659668
Epoch: 7, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.402 Vali Acc: 0.259 Test Loss: 1.402 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 8 cost time: 1.6316008567810059
Epoch: 8, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.410 Vali Acc: 0.259 Test Loss: 1.410 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4506421089172363
Epoch: 9, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.430 Vali Acc: 0.243 Test Loss: 1.430 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5986888408660889
Epoch: 10, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.420 Vali Acc: 0.266 Test Loss: 1.420 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266145).  Saving model ...
Epoch: 11 cost time: 1.538666009902954
Epoch: 11, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.428 Vali Acc: 0.262 Test Loss: 1.428 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4101028442382812
Epoch: 12, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.438 Vali Acc: 0.236 Test Loss: 1.438 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4227094650268555
Epoch: 13, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.458 Vali Acc: 0.247 Test Loss: 1.458 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.369368314743042
Epoch: 14, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.470 Vali Acc: 0.243 Test Loss: 1.470 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.454862356185913
Epoch: 15, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.505 Vali Acc: 0.281 Test Loss: 1.505 Test Acc: 0.281
Validation loss decreased (-0.266145 --> -0.281354).  Saving model ...
Epoch: 16 cost time: 1.5159189701080322
Epoch: 16, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.470 Vali Acc: 0.213 Test Loss: 1.470 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6400904655456543
Epoch: 17, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.478 Vali Acc: 0.243 Test Loss: 1.478 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3359174728393555
Epoch: 18, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.553 Vali Acc: 0.251 Test Loss: 1.553 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4513187408447266
Epoch: 19, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.510 Vali Acc: 0.236 Test Loss: 1.510 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.419886827468872
Epoch: 20, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.566 Vali Acc: 0.240 Test Loss: 1.566 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5444800853729248
Epoch: 21, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.587 Vali Acc: 0.270 Test Loss: 1.587 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.342787504196167
Epoch: 22, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.555 Vali Acc: 0.259 Test Loss: 1.555 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5475521087646484
Epoch: 23, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.585 Vali Acc: 0.232 Test Loss: 1.585 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5339548587799072
Epoch: 24, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.717 Vali Acc: 0.285 Test Loss: 1.717 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285154).  Saving model ...
Epoch: 25 cost time: 1.511742115020752
Epoch: 25, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.660 Vali Acc: 0.274 Test Loss: 1.660 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4832508563995361
Epoch: 26, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.634 Vali Acc: 0.289 Test Loss: 1.634 Test Acc: 0.289
Validation loss decreased (-0.285154 --> -0.288957).  Saving model ...
Epoch: 27 cost time: 1.5352089405059814
Epoch: 27, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.593 Vali Acc: 0.289 Test Loss: 1.593 Test Acc: 0.289
Validation loss decreased (-0.288957 --> -0.288957).  Saving model ...
Epoch: 28 cost time: 1.5766515731811523
Epoch: 28, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.629 Vali Acc: 0.274 Test Loss: 1.629 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7076075077056885
Epoch: 29, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.718 Vali Acc: 0.281 Test Loss: 1.718 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5221521854400635
Epoch: 30, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.815 Vali Acc: 0.274 Test Loss: 1.815 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4529407024383545
Epoch: 31, Steps: 17 | Train Loss: 0.944 Vali Loss: 1.795 Vali Acc: 0.285 Test Loss: 1.795 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4496970176696777
Epoch: 32, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.814 Vali Acc: 0.274 Test Loss: 1.814 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5249788761138916
Epoch: 33, Steps: 17 | Train Loss: 0.887 Vali Loss: 1.836 Vali Acc: 0.259 Test Loss: 1.836 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4544909000396729
Epoch: 34, Steps: 17 | Train Loss: 0.855 Vali Loss: 1.901 Vali Acc: 0.270 Test Loss: 1.901 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.503051996231079
Epoch: 35, Steps: 17 | Train Loss: 0.866 Vali Loss: 1.935 Vali Acc: 0.278 Test Loss: 1.935 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.5812618732452393
Epoch: 36, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.887 Vali Acc: 0.262 Test Loss: 1.887 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.5593595504760742
Epoch: 37, Steps: 17 | Train Loss: 0.768 Vali Loss: 1.809 Vali Acc: 0.262 Test Loss: 1.809 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm32_nh4_df64_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 33860
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1938867568969727
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.404 Vali Acc: 0.251 Test Loss: 1.404 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.3633227348327637
Epoch: 2, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.436 Vali Acc: 0.270 Test Loss: 1.436 Test Acc: 0.270
Validation loss decreased (-0.250937 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 1.4036788940429688
Epoch: 3, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.429 Vali Acc: 0.259 Test Loss: 1.429 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3948209285736084
Epoch: 4, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.412 Vali Acc: 0.278 Test Loss: 1.412 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 1.4449710845947266
Epoch: 5, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.510 Vali Acc: 0.255 Test Loss: 1.510 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3018968105316162
Epoch: 6, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.460 Vali Acc: 0.289 Test Loss: 1.460 Test Acc: 0.289
Validation loss decreased (-0.277552 --> -0.288959).  Saving model ...
Epoch: 7 cost time: 1.536792278289795
Epoch: 7, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.427 Vali Acc: 0.270 Test Loss: 1.427 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2981040477752686
Epoch: 8, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.485 Vali Acc: 0.255 Test Loss: 1.485 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.482301950454712
Epoch: 9, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.463 Vali Acc: 0.247 Test Loss: 1.463 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3578197956085205
Epoch: 10, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.467 Vali Acc: 0.270 Test Loss: 1.467 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2848842144012451
Epoch: 11, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.535 Vali Acc: 0.285 Test Loss: 1.535 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4583570957183838
Epoch: 12, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.552 Vali Acc: 0.270 Test Loss: 1.552 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.254213571548462
Epoch: 13, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.494 Vali Acc: 0.289 Test Loss: 1.494 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3241488933563232
Epoch: 14, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.487 Vali Acc: 0.247 Test Loss: 1.487 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3784563541412354
Epoch: 15, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.586 Vali Acc: 0.259 Test Loss: 1.586 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.35593843460083
Epoch: 16, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.713 Vali Acc: 0.243 Test Loss: 1.713 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 35140
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2967257499694824
Epoch: 1, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.435 Vali Acc: 0.243 Test Loss: 1.435 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.380397081375122
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.420 Vali Acc: 0.259 Test Loss: 1.420 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.4074840545654297
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.417 Vali Acc: 0.224 Test Loss: 1.417 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3678195476531982
Epoch: 4, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.424 Vali Acc: 0.202 Test Loss: 1.424 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3128933906555176
Epoch: 5, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.413 Vali Acc: 0.247 Test Loss: 1.413 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.417179822921753
Epoch: 6, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.429 Vali Acc: 0.259 Test Loss: 1.429 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1971735954284668
Epoch: 7, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.458 Vali Acc: 0.266 Test Loss: 1.458 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266145).  Saving model ...
Epoch: 8 cost time: 1.197106122970581
Epoch: 8, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.431 Vali Acc: 0.251 Test Loss: 1.431 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.252941370010376
Epoch: 9, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.420 Vali Acc: 0.259 Test Loss: 1.420 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3058326244354248
Epoch: 10, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.482 Vali Acc: 0.251 Test Loss: 1.482 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2473993301391602
Epoch: 11, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.442 Vali Acc: 0.259 Test Loss: 1.442 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.215961217880249
Epoch: 12, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.448 Vali Acc: 0.262 Test Loss: 1.448 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.244206190109253
Epoch: 13, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.449 Vali Acc: 0.228 Test Loss: 1.449 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3290774822235107
Epoch: 14, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.496 Vali Acc: 0.262 Test Loss: 1.496 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2453911304473877
Epoch: 15, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.519 Vali Acc: 0.262 Test Loss: 1.519 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.201747179031372
Epoch: 16, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.518 Vali Acc: 0.217 Test Loss: 1.518 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2503559589385986
Epoch: 17, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.493 Vali Acc: 0.236 Test Loss: 1.493 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 28164
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.059931516647339
Epoch: 1, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.392 Vali Acc: 0.278 Test Loss: 1.392 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 1.1856863498687744
Epoch: 2, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.387 Vali Acc: 0.293 Test Loss: 1.387 Test Acc: 0.293
Validation loss decreased (-0.277553 --> -0.292762).  Saving model ...
Epoch: 3 cost time: 1.2066764831542969
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.391 Vali Acc: 0.224 Test Loss: 1.391 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2473716735839844
Epoch: 4, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.384 Vali Acc: 0.270 Test Loss: 1.384 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2244760990142822
Epoch: 5, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.388 Vali Acc: 0.289 Test Loss: 1.388 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2158780097961426
Epoch: 6, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.395 Vali Acc: 0.270 Test Loss: 1.395 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1440424919128418
Epoch: 7, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.416 Vali Acc: 0.259 Test Loss: 1.416 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1896748542785645
Epoch: 8, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.395 Vali Acc: 0.319 Test Loss: 1.395 Test Acc: 0.319
Validation loss decreased (-0.292762 --> -0.319378).  Saving model ...
Epoch: 9 cost time: 1.2375075817108154
Epoch: 9, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.402 Vali Acc: 0.259 Test Loss: 1.402 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.267913579940796
Epoch: 10, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.421 Vali Acc: 0.274 Test Loss: 1.421 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0900728702545166
Epoch: 11, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.463 Vali Acc: 0.228 Test Loss: 1.463 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3144261837005615
Epoch: 12, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.445 Vali Acc: 0.285 Test Loss: 1.445 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2233726978302002
Epoch: 13, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3966963291168213
Epoch: 14, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.455 Vali Acc: 0.278 Test Loss: 1.455 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.169062852859497
Epoch: 15, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.463 Vali Acc: 0.266 Test Loss: 1.463 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2924814224243164
Epoch: 16, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.570 Vali Acc: 0.274 Test Loss: 1.570 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3278961181640625
Epoch: 17, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.452 Vali Acc: 0.285 Test Loss: 1.452 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.335111379623413
Epoch: 18, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.480 Vali Acc: 0.270 Test Loss: 1.480 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 26372
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.001211404800415
Epoch: 1, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.436 Vali Acc: 0.247 Test Loss: 1.436 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.3321073055267334
Epoch: 2, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.420 Vali Acc: 0.259 Test Loss: 1.420 Test Acc: 0.259
Validation loss decreased (-0.247134 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.2583281993865967
Epoch: 3, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.422 Vali Acc: 0.232 Test Loss: 1.422 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.312856912612915
Epoch: 4, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.410 Vali Acc: 0.228 Test Loss: 1.410 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2431261539459229
Epoch: 5, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.402 Vali Acc: 0.266 Test Loss: 1.402 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 6 cost time: 1.318329095840454
Epoch: 6, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.401 Vali Acc: 0.266 Test Loss: 1.401 Test Acc: 0.266
Validation loss decreased (-0.266146 --> -0.266146).  Saving model ...
Epoch: 7 cost time: 1.221350908279419
Epoch: 7, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.401 Vali Acc: 0.259 Test Loss: 1.401 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4519658088684082
Epoch: 8, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.409 Vali Acc: 0.236 Test Loss: 1.409 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1592216491699219
Epoch: 9, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.407 Vali Acc: 0.274 Test Loss: 1.407 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273750).  Saving model ...
Epoch: 10 cost time: 1.2362055778503418
Epoch: 10, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.407 Vali Acc: 0.274 Test Loss: 1.407 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.245187759399414
Epoch: 11, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.450 Vali Acc: 0.228 Test Loss: 1.450 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3053441047668457
Epoch: 12, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.433 Vali Acc: 0.293 Test Loss: 1.433 Test Acc: 0.293
Validation loss decreased (-0.273750 --> -0.292761).  Saving model ...
Epoch: 13 cost time: 1.3189101219177246
Epoch: 13, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.447 Vali Acc: 0.232 Test Loss: 1.447 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4068567752838135
Epoch: 14, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.451 Vali Acc: 0.259 Test Loss: 1.451 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3669686317443848
Epoch: 15, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.451 Vali Acc: 0.251 Test Loss: 1.451 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3970730304718018
Epoch: 16, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.459 Vali Acc: 0.255 Test Loss: 1.459 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3087522983551025
Epoch: 17, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.504 Vali Acc: 0.259 Test Loss: 1.504 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3487508296966553
Epoch: 18, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.487 Vali Acc: 0.262 Test Loss: 1.487 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2813620567321777
Epoch: 19, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.516 Vali Acc: 0.224 Test Loss: 1.516 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3826193809509277
Epoch: 20, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.502 Vali Acc: 0.240 Test Loss: 1.502 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4059326648712158
Epoch: 21, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.511 Vali Acc: 0.221 Test Loss: 1.511 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2690587043762207
Epoch: 22, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.510 Vali Acc: 0.251 Test Loss: 1.510 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 25732
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.998830795288086
Epoch: 1, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.403 Vali Acc: 0.266 Test Loss: 1.403 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 1.3313243389129639
Epoch: 2, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.402 Vali Acc: 0.247 Test Loss: 1.402 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3792979717254639
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.392 Vali Acc: 0.266 Test Loss: 1.392 Test Acc: 0.266
Validation loss decreased (-0.266146 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.2214910984039307
Epoch: 4, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.394 Vali Acc: 0.289 Test Loss: 1.394 Test Acc: 0.289
Validation loss decreased (-0.266146 --> -0.288959).  Saving model ...
Epoch: 5 cost time: 1.2635908126831055
Epoch: 5, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.398 Vali Acc: 0.240 Test Loss: 1.398 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.252098560333252
Epoch: 6, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.407 Vali Acc: 0.259 Test Loss: 1.407 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3161628246307373
Epoch: 7, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.390 Vali Acc: 0.236 Test Loss: 1.390 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3650014400482178
Epoch: 8, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.426 Vali Acc: 0.255 Test Loss: 1.426 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3268465995788574
Epoch: 9, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.397 Vali Acc: 0.259 Test Loss: 1.397 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4147043228149414
Epoch: 10, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.398 Vali Acc: 0.236 Test Loss: 1.398 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1899826526641846
Epoch: 11, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.409 Vali Acc: 0.266 Test Loss: 1.409 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.402566909790039
Epoch: 12, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.405 Vali Acc: 0.221 Test Loss: 1.405 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9782488346099854
Epoch: 13, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.425 Vali Acc: 0.266 Test Loss: 1.425 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.320798635482788
Epoch: 14, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.443 Vali Acc: 0.232 Test Loss: 1.443 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 25972
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.159078359603882
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.398 Vali Acc: 0.304 Test Loss: 1.398 Test Acc: 0.304
Validation loss decreased (inf --> -0.304169).  Saving model ...
Epoch: 2 cost time: 1.3328709602355957
Epoch: 2, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.394 Vali Acc: 0.236 Test Loss: 1.394 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.27079439163208
Epoch: 3, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.402 Vali Acc: 0.243 Test Loss: 1.402 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2400157451629639
Epoch: 4, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.400 Vali Acc: 0.270 Test Loss: 1.400 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.176421880722046
Epoch: 5, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.403 Vali Acc: 0.259 Test Loss: 1.403 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.200674295425415
Epoch: 6, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.400 Vali Acc: 0.255 Test Loss: 1.400 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.177504062652588
Epoch: 7, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.408 Vali Acc: 0.259 Test Loss: 1.408 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4634079933166504
Epoch: 8, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.417 Vali Acc: 0.255 Test Loss: 1.417 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4365313053131104
Epoch: 9, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.409 Vali Acc: 0.243 Test Loss: 1.409 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4872539043426514
Epoch: 10, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.415 Vali Acc: 0.240 Test Loss: 1.415 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3205325603485107
Epoch: 11, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.422 Vali Acc: 0.270 Test Loss: 1.422 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 26612
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.302016496658325
Epoch: 1, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.454 Vali Acc: 0.255 Test Loss: 1.454 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 1.3793153762817383
Epoch: 2, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.410 Vali Acc: 0.247 Test Loss: 1.410 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4110629558563232
Epoch: 3, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.413 Vali Acc: 0.251 Test Loss: 1.413 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4354846477508545
Epoch: 4, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.401 Vali Acc: 0.247 Test Loss: 1.401 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.445469856262207
Epoch: 5, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.417 Vali Acc: 0.285 Test Loss: 1.417 Test Acc: 0.285
Validation loss decreased (-0.254738 --> -0.285157).  Saving model ...
Epoch: 6 cost time: 1.2883758544921875
Epoch: 6, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.402 Vali Acc: 0.255 Test Loss: 1.402 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3062255382537842
Epoch: 7, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.405 Vali Acc: 0.274 Test Loss: 1.405 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2009592056274414
Epoch: 8, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.399 Vali Acc: 0.266 Test Loss: 1.399 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2872822284698486
Epoch: 9, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.430 Vali Acc: 0.274 Test Loss: 1.430 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2793056964874268
Epoch: 10, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3377737998962402
Epoch: 11, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.410 Vali Acc: 0.243 Test Loss: 1.410 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2894399166107178
Epoch: 12, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.450 Vali Acc: 0.289 Test Loss: 1.450 Test Acc: 0.289
Validation loss decreased (-0.285157 --> -0.288959).  Saving model ...
Epoch: 13 cost time: 1.3236281871795654
Epoch: 13, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.434 Vali Acc: 0.232 Test Loss: 1.434 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2785170078277588
Epoch: 14, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.479 Vali Acc: 0.300 Test Loss: 1.479 Test Acc: 0.300
Validation loss decreased (-0.288959 --> -0.300365).  Saving model ...
Epoch: 15 cost time: 1.3939003944396973
Epoch: 15, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.448 Vali Acc: 0.243 Test Loss: 1.448 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2997405529022217
Epoch: 16, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.545 Vali Acc: 0.247 Test Loss: 1.545 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3208911418914795
Epoch: 17, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.477 Vali Acc: 0.236 Test Loss: 1.477 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4317138195037842
Epoch: 18, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.500 Vali Acc: 0.236 Test Loss: 1.500 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4050133228302002
Epoch: 19, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.481 Vali Acc: 0.247 Test Loss: 1.481 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.456153392791748
Epoch: 20, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.500 Vali Acc: 0.243 Test Loss: 1.500 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2111518383026123
Epoch: 21, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.506 Vali Acc: 0.240 Test Loss: 1.506 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3340351581573486
Epoch: 22, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.553 Vali Acc: 0.221 Test Loss: 1.553 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3127427101135254
Epoch: 23, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.524 Vali Acc: 0.266 Test Loss: 1.524 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2571780681610107
Epoch: 24, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.578 Vali Acc: 0.224 Test Loss: 1.578 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df256_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 27620
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.6721012592315674
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.432 Vali Acc: 0.274 Test Loss: 1.432 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.034991979598999
Epoch: 2, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.391 Vali Acc: 0.243 Test Loss: 1.391 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1838569641113281
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.404 Vali Acc: 0.255 Test Loss: 1.404 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2325997352600098
Epoch: 4, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.444 Vali Acc: 0.243 Test Loss: 1.444 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2489464282989502
Epoch: 5, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.439 Vali Acc: 0.278 Test Loss: 1.439 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 6 cost time: 1.4266266822814941
Epoch: 6, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.416 Vali Acc: 0.266 Test Loss: 1.416 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.435119867324829
Epoch: 7, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.445 Vali Acc: 0.274 Test Loss: 1.445 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4112911224365234
Epoch: 8, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.430 Vali Acc: 0.251 Test Loss: 1.430 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3886070251464844
Epoch: 9, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.626 Vali Acc: 0.262 Test Loss: 1.626 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4648146629333496
Epoch: 10, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.443 Vali Acc: 0.281 Test Loss: 1.443 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281354).  Saving model ...
Epoch: 11 cost time: 1.4330265522003174
Epoch: 11, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.528 Vali Acc: 0.266 Test Loss: 1.528 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3935120105743408
Epoch: 12, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.628 Vali Acc: 0.259 Test Loss: 1.628 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3502154350280762
Epoch: 13, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.541 Vali Acc: 0.255 Test Loss: 1.541 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.214430570602417
Epoch: 14, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.449 Vali Acc: 0.259 Test Loss: 1.449 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2712571620941162
Epoch: 15, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.483 Vali Acc: 0.281 Test Loss: 1.483 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3450231552124023
Epoch: 16, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.536 Vali Acc: 0.262 Test Loss: 1.536 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.467607021331787
Epoch: 17, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.588 Vali Acc: 0.278 Test Loss: 1.588 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.358806848526001
Epoch: 18, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.509 Vali Acc: 0.232 Test Loss: 1.509 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2670979499816895
Epoch: 19, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.590 Vali Acc: 0.247 Test Loss: 1.590 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4633030891418457
Epoch: 20, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.568 Vali Acc: 0.262 Test Loss: 1.568 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 26692
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0944299697875977
Epoch: 1, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.399 Vali Acc: 0.270 Test Loss: 1.399 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.3569691181182861
Epoch: 2, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.401 Vali Acc: 0.266 Test Loss: 1.401 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1833364963531494
Epoch: 3, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.390 Vali Acc: 0.243 Test Loss: 1.390 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2184574604034424
Epoch: 4, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.402 Vali Acc: 0.293 Test Loss: 1.402 Test Acc: 0.293
Validation loss decreased (-0.269948 --> -0.292762).  Saving model ...
Epoch: 5 cost time: 1.3785710334777832
Epoch: 5, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.266 Test Loss: 1.398 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3682711124420166
Epoch: 6, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.404 Vali Acc: 0.240 Test Loss: 1.404 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.353525161743164
Epoch: 7, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.422 Vali Acc: 0.251 Test Loss: 1.422 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3185772895812988
Epoch: 8, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.444 Vali Acc: 0.251 Test Loss: 1.444 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3427555561065674
Epoch: 9, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.404 Vali Acc: 0.243 Test Loss: 1.404 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.286109209060669
Epoch: 10, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.440 Vali Acc: 0.251 Test Loss: 1.440 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.344480276107788
Epoch: 11, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.421 Vali Acc: 0.259 Test Loss: 1.421 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2816047668457031
Epoch: 12, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.413 Vali Acc: 0.259 Test Loss: 1.413 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2219936847686768
Epoch: 13, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.423 Vali Acc: 0.274 Test Loss: 1.423 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2084906101226807
Epoch: 14, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.442 Vali Acc: 0.251 Test Loss: 1.442 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 19716
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.875061511993408
Epoch: 1, Steps: 17 | Train Loss: 1.609 Vali Loss: 1.435 Vali Acc: 0.243 Test Loss: 1.435 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.4080495834350586
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.410 Vali Acc: 0.247 Test Loss: 1.410 Test Acc: 0.247
Validation loss decreased (-0.243332 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.197901725769043
Epoch: 3, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.404 Vali Acc: 0.259 Test Loss: 1.404 Test Acc: 0.259
Validation loss decreased (-0.247134 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 1.2468323707580566
Epoch: 4, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.394 Vali Acc: 0.274 Test Loss: 1.394 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 1.2783801555633545
Epoch: 5, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3007609844207764
Epoch: 6, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.404 Vali Acc: 0.262 Test Loss: 1.404 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2989308834075928
Epoch: 7, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.396 Vali Acc: 0.259 Test Loss: 1.396 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.211972713470459
Epoch: 8, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.424 Vali Acc: 0.285 Test Loss: 1.424 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285157).  Saving model ...
Epoch: 9 cost time: 1.3987329006195068
Epoch: 9, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.412 Vali Acc: 0.281 Test Loss: 1.412 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3369555473327637
Epoch: 10, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.409 Vali Acc: 0.274 Test Loss: 1.409 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3041393756866455
Epoch: 11, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.420 Vali Acc: 0.262 Test Loss: 1.420 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3385746479034424
Epoch: 12, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.421 Vali Acc: 0.243 Test Loss: 1.421 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4959352016448975
Epoch: 13, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.421 Vali Acc: 0.259 Test Loss: 1.421 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3324408531188965
Epoch: 14, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.478 Vali Acc: 0.281 Test Loss: 1.478 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3120474815368652
Epoch: 15, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.466 Vali Acc: 0.274 Test Loss: 1.466 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3038387298583984
Epoch: 16, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.462 Vali Acc: 0.266 Test Loss: 1.462 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4807980060577393
Epoch: 17, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.496 Vali Acc: 0.285 Test Loss: 1.496 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3322265148162842
Epoch: 18, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.460 Vali Acc: 0.255 Test Loss: 1.460 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 17924
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9442083835601807
Epoch: 1, Steps: 17 | Train Loss: 1.592 Vali Loss: 1.449 Vali Acc: 0.217 Test Loss: 1.449 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 1.1173174381256104
Epoch: 2, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.400 Vali Acc: 0.217 Test Loss: 1.400 Test Acc: 0.217
Validation loss decreased (-0.216716 --> -0.216716).  Saving model ...
Epoch: 3 cost time: 1.1869235038757324
Epoch: 3, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.406 Vali Acc: 0.266 Test Loss: 1.406 Test Acc: 0.266
Validation loss decreased (-0.216716 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.1040332317352295
Epoch: 4, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.404 Vali Acc: 0.243 Test Loss: 1.404 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2486708164215088
Epoch: 5, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.401 Vali Acc: 0.255 Test Loss: 1.401 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3200888633728027
Epoch: 6, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.397 Vali Acc: 0.217 Test Loss: 1.397 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2318801879882812
Epoch: 7, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.404 Vali Acc: 0.262 Test Loss: 1.404 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2406649589538574
Epoch: 8, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.405 Vali Acc: 0.270 Test Loss: 1.405 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269948).  Saving model ...
Epoch: 9 cost time: 1.3186607360839844
Epoch: 9, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.418 Vali Acc: 0.266 Test Loss: 1.418 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3629732131958008
Epoch: 10, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.414 Vali Acc: 0.236 Test Loss: 1.414 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2133796215057373
Epoch: 11, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.421 Vali Acc: 0.270 Test Loss: 1.421 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1583826541900635
Epoch: 12, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.437 Vali Acc: 0.213 Test Loss: 1.437 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3010573387145996
Epoch: 13, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.468 Vali Acc: 0.247 Test Loss: 1.468 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3521451950073242
Epoch: 14, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.452 Vali Acc: 0.240 Test Loss: 1.452 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1880393028259277
Epoch: 15, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.457 Vali Acc: 0.243 Test Loss: 1.457 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3539774417877197
Epoch: 16, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.467 Vali Acc: 0.251 Test Loss: 1.467 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3725166320800781
Epoch: 17, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.476 Vali Acc: 0.224 Test Loss: 1.476 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2524678707122803
Epoch: 18, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.489 Vali Acc: 0.209 Test Loss: 1.489 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 17284
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9656856060028076
Epoch: 1, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.406 Vali Acc: 0.251 Test Loss: 1.406 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.1626684665679932
Epoch: 2, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.416 Vali Acc: 0.255 Test Loss: 1.416 Test Acc: 0.255
Validation loss decreased (-0.250937 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.2090368270874023
Epoch: 3, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.410 Vali Acc: 0.266 Test Loss: 1.410 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.3038358688354492
Epoch: 4, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.417 Vali Acc: 0.281 Test Loss: 1.417 Test Acc: 0.281
Validation loss decreased (-0.266146 --> -0.281355).  Saving model ...
Epoch: 5 cost time: 1.1955807209014893
Epoch: 5, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.414 Vali Acc: 0.247 Test Loss: 1.414 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2566328048706055
Epoch: 6, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.403 Vali Acc: 0.312 Test Loss: 1.403 Test Acc: 0.312
Validation loss decreased (-0.281355 --> -0.311773).  Saving model ...
Epoch: 7 cost time: 1.3096778392791748
Epoch: 7, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.412 Vali Acc: 0.259 Test Loss: 1.412 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.211007833480835
Epoch: 8, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.398 Vali Acc: 0.281 Test Loss: 1.398 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2351572513580322
Epoch: 9, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.410 Vali Acc: 0.266 Test Loss: 1.410 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2180051803588867
Epoch: 10, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.400 Vali Acc: 0.308 Test Loss: 1.400 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2188918590545654
Epoch: 11, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.425 Vali Acc: 0.247 Test Loss: 1.425 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.202017068862915
Epoch: 12, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.407 Vali Acc: 0.274 Test Loss: 1.407 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2340242862701416
Epoch: 13, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.414 Vali Acc: 0.281 Test Loss: 1.414 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2676146030426025
Epoch: 14, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.421 Vali Acc: 0.259 Test Loss: 1.421 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2164533138275146
Epoch: 15, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.442 Vali Acc: 0.262 Test Loss: 1.442 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3535375595092773
Epoch: 16, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.489 Vali Acc: 0.221 Test Loss: 1.489 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 17524
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.46698260307312
Epoch: 1, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.389 Vali Acc: 0.255 Test Loss: 1.389 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.1967732906341553
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.386 Vali Acc: 0.221 Test Loss: 1.386 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1639139652252197
Epoch: 3, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.384 Vali Acc: 0.270 Test Loss: 1.384 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 1.2938063144683838
Epoch: 4, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.387 Vali Acc: 0.285 Test Loss: 1.387 Test Acc: 0.285
Validation loss decreased (-0.269948 --> -0.285157).  Saving model ...
Epoch: 5 cost time: 1.293311595916748
Epoch: 5, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.385 Vali Acc: 0.297 Test Loss: 1.385 Test Acc: 0.297
Validation loss decreased (-0.285157 --> -0.296564).  Saving model ...
Epoch: 6 cost time: 1.2170536518096924
Epoch: 6, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.396 Vali Acc: 0.255 Test Loss: 1.396 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2161171436309814
Epoch: 7, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.389 Vali Acc: 0.297 Test Loss: 1.389 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2378883361816406
Epoch: 8, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.402 Vali Acc: 0.270 Test Loss: 1.402 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0890512466430664
Epoch: 9, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.398 Vali Acc: 0.278 Test Loss: 1.398 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2848193645477295
Epoch: 10, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.395 Vali Acc: 0.274 Test Loss: 1.395 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2434756755828857
Epoch: 11, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.406 Vali Acc: 0.285 Test Loss: 1.406 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.347876787185669
Epoch: 12, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.406 Vali Acc: 0.304 Test Loss: 1.406 Test Acc: 0.304
Validation loss decreased (-0.296564 --> -0.304168).  Saving model ...
Epoch: 13 cost time: 1.5755658149719238
Epoch: 13, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.415 Vali Acc: 0.293 Test Loss: 1.415 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4441461563110352
Epoch: 14, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.424 Vali Acc: 0.236 Test Loss: 1.424 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.372847318649292
Epoch: 15, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.446 Vali Acc: 0.274 Test Loss: 1.446 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3629984855651855
Epoch: 16, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.483 Vali Acc: 0.281 Test Loss: 1.483 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.422743797302246
Epoch: 17, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.436 Vali Acc: 0.266 Test Loss: 1.436 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2721171379089355
Epoch: 18, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.460 Vali Acc: 0.213 Test Loss: 1.460 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3075342178344727
Epoch: 19, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.465 Vali Acc: 0.259 Test Loss: 1.465 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3069238662719727
Epoch: 20, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.478 Vali Acc: 0.278 Test Loss: 1.478 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3505597114562988
Epoch: 21, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.501 Vali Acc: 0.259 Test Loss: 1.501 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3369662761688232
Epoch: 22, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.500 Vali Acc: 0.274 Test Loss: 1.500 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 18164
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9361026287078857
Epoch: 1, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.391 Vali Acc: 0.289 Test Loss: 1.391 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 1.1463637351989746
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.394 Vali Acc: 0.285 Test Loss: 1.394 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2567880153656006
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.392 Vali Acc: 0.285 Test Loss: 1.392 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.176466464996338
Epoch: 4, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.395 Vali Acc: 0.270 Test Loss: 1.395 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2018120288848877
Epoch: 5, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.390 Vali Acc: 0.316 Test Loss: 1.390 Test Acc: 0.316
Validation loss decreased (-0.288959 --> -0.315575).  Saving model ...
Epoch: 6 cost time: 1.2970874309539795
Epoch: 6, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.401 Vali Acc: 0.266 Test Loss: 1.401 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2390618324279785
Epoch: 7, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.396 Vali Acc: 0.259 Test Loss: 1.396 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3106231689453125
Epoch: 8, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.394 Vali Acc: 0.259 Test Loss: 1.394 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1418421268463135
Epoch: 9, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.411 Vali Acc: 0.278 Test Loss: 1.411 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2107887268066406
Epoch: 10, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.429 Vali Acc: 0.293 Test Loss: 1.429 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.232191562652588
Epoch: 11, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.419 Vali Acc: 0.304 Test Loss: 1.419 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3177008628845215
Epoch: 12, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.420 Vali Acc: 0.270 Test Loss: 1.420 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2879254817962646
Epoch: 13, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.436 Vali Acc: 0.281 Test Loss: 1.436 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.297762155532837
Epoch: 14, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.438 Vali Acc: 0.262 Test Loss: 1.438 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3441855907440186
Epoch: 15, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.450 Vali Acc: 0.266 Test Loss: 1.450 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df128_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 19172
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.215756416320801
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.412 Vali Acc: 0.259 Test Loss: 1.412 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.2408204078674316
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.399 Vali Acc: 0.232 Test Loss: 1.399 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.161741018295288
Epoch: 3, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.414 Vali Acc: 0.255 Test Loss: 1.414 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.183393955230713
Epoch: 4, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.406 Vali Acc: 0.255 Test Loss: 1.406 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2847847938537598
Epoch: 5, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.530 Vali Acc: 0.255 Test Loss: 1.530 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2936491966247559
Epoch: 6, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.501 Vali Acc: 0.251 Test Loss: 1.501 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2460124492645264
Epoch: 7, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.526 Vali Acc: 0.232 Test Loss: 1.526 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2920293807983398
Epoch: 8, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.459 Vali Acc: 0.240 Test Loss: 1.459 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2516398429870605
Epoch: 9, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.443 Vali Acc: 0.232 Test Loss: 1.443 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2151572704315186
Epoch: 10, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.425 Vali Acc: 0.232 Test Loss: 1.425 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1687400341033936
Epoch: 11, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.451 Vali Acc: 0.247 Test Loss: 1.451 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 22468
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.073490619659424
Epoch: 1, Steps: 17 | Train Loss: 1.586 Vali Loss: 1.413 Vali Acc: 0.262 Test Loss: 1.413 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.1702682971954346
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.430 Vali Acc: 0.251 Test Loss: 1.430 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1575162410736084
Epoch: 3, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.1503875255584717
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.405 Vali Acc: 0.281 Test Loss: 1.405 Test Acc: 0.281
Validation loss decreased (-0.266146 --> -0.281355).  Saving model ...
Epoch: 5 cost time: 1.1910719871520996
Epoch: 5, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.392 Vali Acc: 0.266 Test Loss: 1.392 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2276802062988281
Epoch: 6, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.399 Vali Acc: 0.270 Test Loss: 1.399 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2082934379577637
Epoch: 7, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.414 Vali Acc: 0.266 Test Loss: 1.414 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2252540588378906
Epoch: 8, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.418 Vali Acc: 0.285 Test Loss: 1.418 Test Acc: 0.285
Validation loss decreased (-0.281355 --> -0.285157).  Saving model ...
Epoch: 9 cost time: 1.2598159313201904
Epoch: 9, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.450 Vali Acc: 0.259 Test Loss: 1.450 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1892328262329102
Epoch: 10, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.431 Vali Acc: 0.285 Test Loss: 1.431 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1503894329071045
Epoch: 11, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.421 Vali Acc: 0.240 Test Loss: 1.421 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1988675594329834
Epoch: 12, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.465 Vali Acc: 0.259 Test Loss: 1.465 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0779545307159424
Epoch: 13, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.480 Vali Acc: 0.259 Test Loss: 1.480 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1087684631347656
Epoch: 14, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.157832145690918
Epoch: 15, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.420 Vali Acc: 0.228 Test Loss: 1.420 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3109583854675293
Epoch: 16, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.436 Vali Acc: 0.255 Test Loss: 1.436 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0787920951843262
Epoch: 17, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.472 Vali Acc: 0.262 Test Loss: 1.472 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1326632499694824
Epoch: 18, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.456 Vali Acc: 0.278 Test Loss: 1.456 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 15492
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1758158206939697
Epoch: 1, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.400 Vali Acc: 0.240 Test Loss: 1.400 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.276125192642212
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.400 Vali Acc: 0.240 Test Loss: 1.400 Test Acc: 0.240
Validation loss decreased (-0.239530 --> -0.239530).  Saving model ...
Epoch: 3 cost time: 1.1439504623413086
Epoch: 3, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.394 Vali Acc: 0.255 Test Loss: 1.394 Test Acc: 0.255
Validation loss decreased (-0.239530 --> -0.254739).  Saving model ...
Epoch: 4 cost time: 1.147820234298706
Epoch: 4, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 1.1517481803894043
Epoch: 5, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.394 Vali Acc: 0.262 Test Loss: 1.394 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3114995956420898
Epoch: 6, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.394 Vali Acc: 0.255 Test Loss: 1.394 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2724823951721191
Epoch: 7, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.401 Vali Acc: 0.297 Test Loss: 1.401 Test Acc: 0.297
Validation loss decreased (-0.269948 --> -0.296564).  Saving model ...
Epoch: 8 cost time: 1.2404837608337402
Epoch: 8, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.399 Vali Acc: 0.266 Test Loss: 1.399 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.170163869857788
Epoch: 9, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.409 Vali Acc: 0.270 Test Loss: 1.409 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1047675609588623
Epoch: 10, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.408 Vali Acc: 0.281 Test Loss: 1.408 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2314362525939941
Epoch: 11, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.417 Vali Acc: 0.281 Test Loss: 1.417 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1326947212219238
Epoch: 12, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.438 Vali Acc: 0.251 Test Loss: 1.438 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.268247365951538
Epoch: 13, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.491 Vali Acc: 0.278 Test Loss: 1.491 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1292598247528076
Epoch: 14, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.458 Vali Acc: 0.262 Test Loss: 1.458 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3726844787597656
Epoch: 15, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.438 Vali Acc: 0.304 Test Loss: 1.438 Test Acc: 0.304
Validation loss decreased (-0.296564 --> -0.304168).  Saving model ...
Epoch: 16 cost time: 1.220594882965088
Epoch: 16, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.519 Vali Acc: 0.266 Test Loss: 1.519 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3211283683776855
Epoch: 17, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.513 Vali Acc: 0.274 Test Loss: 1.513 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1961534023284912
Epoch: 18, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.533 Vali Acc: 0.266 Test Loss: 1.533 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1804535388946533
Epoch: 19, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.494 Vali Acc: 0.293 Test Loss: 1.494 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.159839391708374
Epoch: 20, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.517 Vali Acc: 0.266 Test Loss: 1.517 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2479557991027832
Epoch: 21, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.515 Vali Acc: 0.285 Test Loss: 1.515 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1419012546539307
Epoch: 22, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.541 Vali Acc: 0.259 Test Loss: 1.541 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2195494174957275
Epoch: 23, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.556 Vali Acc: 0.259 Test Loss: 1.556 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2215473651885986
Epoch: 24, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.580 Vali Acc: 0.266 Test Loss: 1.580 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.170086145401001
Epoch: 25, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.558 Vali Acc: 0.247 Test Loss: 1.558 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 13700
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9327688217163086
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.407 Vali Acc: 0.251 Test Loss: 1.407 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.1322243213653564
Epoch: 2, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.413 Vali Acc: 0.247 Test Loss: 1.413 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1680409908294678
Epoch: 3, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.419 Vali Acc: 0.259 Test Loss: 1.419 Test Acc: 0.259
Validation loss decreased (-0.250937 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 1.1169238090515137
Epoch: 4, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.421 Vali Acc: 0.247 Test Loss: 1.421 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.297926664352417
Epoch: 5, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.414 Vali Acc: 0.281 Test Loss: 1.414 Test Acc: 0.281
Validation loss decreased (-0.258541 --> -0.281355).  Saving model ...
Epoch: 6 cost time: 1.2459893226623535
Epoch: 6, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.418 Vali Acc: 0.266 Test Loss: 1.418 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1386680603027344
Epoch: 7, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.416 Vali Acc: 0.262 Test Loss: 1.416 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1952157020568848
Epoch: 8, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.415 Vali Acc: 0.247 Test Loss: 1.415 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2900850772857666
Epoch: 9, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.449 Vali Acc: 0.266 Test Loss: 1.449 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0556268692016602
Epoch: 10, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.440 Vali Acc: 0.270 Test Loss: 1.440 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.050032138824463
Epoch: 11, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.441 Vali Acc: 0.247 Test Loss: 1.441 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.03718900680542
Epoch: 12, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.446 Vali Acc: 0.247 Test Loss: 1.446 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1858279705047607
Epoch: 13, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.460 Vali Acc: 0.243 Test Loss: 1.460 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1172277927398682
Epoch: 14, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.448 Vali Acc: 0.255 Test Loss: 1.448 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1928963661193848
Epoch: 15, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 13060
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8861522674560547
Epoch: 1, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.399 Vali Acc: 0.274 Test Loss: 1.399 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.2544059753417969
Epoch: 2, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.380 Vali Acc: 0.281 Test Loss: 1.380 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 1.1822772026062012
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.376 Vali Acc: 0.278 Test Loss: 1.376 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0691769123077393
Epoch: 4, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.375 Vali Acc: 0.281 Test Loss: 1.375 Test Acc: 0.281
Validation loss decreased (-0.281355 --> -0.281355).  Saving model ...
Epoch: 5 cost time: 1.1205096244812012
Epoch: 5, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.378 Vali Acc: 0.266 Test Loss: 1.378 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2943346500396729
Epoch: 6, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.378 Vali Acc: 0.281 Test Loss: 1.378 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.188920021057129
Epoch: 7, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.374 Vali Acc: 0.278 Test Loss: 1.374 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1070985794067383
Epoch: 8, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.392 Vali Acc: 0.281 Test Loss: 1.392 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1267311573028564
Epoch: 9, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.384 Vali Acc: 0.232 Test Loss: 1.384 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2440638542175293
Epoch: 10, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.388 Vali Acc: 0.255 Test Loss: 1.388 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.228196620941162
Epoch: 11, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.394 Vali Acc: 0.247 Test Loss: 1.394 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2833261489868164
Epoch: 12, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.392 Vali Acc: 0.259 Test Loss: 1.392 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.213747501373291
Epoch: 13, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.411 Vali Acc: 0.289 Test Loss: 1.411 Test Acc: 0.289
Validation loss decreased (-0.281355 --> -0.288959).  Saving model ...
Epoch: 14 cost time: 1.11488938331604
Epoch: 14, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.411 Vali Acc: 0.262 Test Loss: 1.411 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1036372184753418
Epoch: 15, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.411 Vali Acc: 0.270 Test Loss: 1.411 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2065417766571045
Epoch: 16, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.423 Vali Acc: 0.278 Test Loss: 1.423 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.141923427581787
Epoch: 17, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.442 Vali Acc: 0.274 Test Loss: 1.442 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0709314346313477
Epoch: 18, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.448 Vali Acc: 0.289 Test Loss: 1.448 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2230498790740967
Epoch: 19, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.513 Vali Acc: 0.281 Test Loss: 1.513 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2621495723724365
Epoch: 20, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.460 Vali Acc: 0.278 Test Loss: 1.460 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1606342792510986
Epoch: 21, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.457 Vali Acc: 0.281 Test Loss: 1.457 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1753218173980713
Epoch: 22, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.472 Vali Acc: 0.304 Test Loss: 1.472 Test Acc: 0.304
Validation loss decreased (-0.288959 --> -0.304168).  Saving model ...
Epoch: 23 cost time: 1.2039663791656494
Epoch: 23, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.476 Vali Acc: 0.304 Test Loss: 1.476 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.203169822692871
Epoch: 24, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.482 Vali Acc: 0.251 Test Loss: 1.482 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2246315479278564
Epoch: 25, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.501 Vali Acc: 0.285 Test Loss: 1.501 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1965339183807373
Epoch: 26, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.517 Vali Acc: 0.300 Test Loss: 1.517 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.212285041809082
Epoch: 27, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.554 Vali Acc: 0.266 Test Loss: 1.554 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1845858097076416
Epoch: 28, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.503 Vali Acc: 0.266 Test Loss: 1.503 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1669237613677979
Epoch: 29, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.554 Vali Acc: 0.251 Test Loss: 1.554 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1029729843139648
Epoch: 30, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.659 Vali Acc: 0.270 Test Loss: 1.659 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1332981586456299
Epoch: 31, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.573 Vali Acc: 0.270 Test Loss: 1.573 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1394133567810059
Epoch: 32, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.709 Vali Acc: 0.278 Test Loss: 1.709 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 13300
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2383952140808105
Epoch: 1, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.397 Vali Acc: 0.236 Test Loss: 1.397 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.15574049949646
Epoch: 2, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.398 Vali Acc: 0.262 Test Loss: 1.398 Test Acc: 0.262
Validation loss decreased (-0.235727 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 1.1813573837280273
Epoch: 3, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.400 Vali Acc: 0.270 Test Loss: 1.400 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 1.206373929977417
Epoch: 4, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.398 Vali Acc: 0.247 Test Loss: 1.398 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.07804536819458
Epoch: 5, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.401 Vali Acc: 0.240 Test Loss: 1.401 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1241140365600586
Epoch: 6, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.398 Vali Acc: 0.262 Test Loss: 1.398 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0885183811187744
Epoch: 7, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.409 Vali Acc: 0.240 Test Loss: 1.409 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2064051628112793
Epoch: 8, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.399 Vali Acc: 0.243 Test Loss: 1.399 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.040609359741211
Epoch: 9, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.401 Vali Acc: 0.251 Test Loss: 1.401 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1542775630950928
Epoch: 10, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.413 Vali Acc: 0.228 Test Loss: 1.413 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1246261596679688
Epoch: 11, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.415 Vali Acc: 0.262 Test Loss: 1.415 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0814435482025146
Epoch: 12, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.421 Vali Acc: 0.213 Test Loss: 1.421 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1122350692749023
Epoch: 13, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.422 Vali Acc: 0.243 Test Loss: 1.422 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 13940
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0516257286071777
Epoch: 1, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.402 Vali Acc: 0.217 Test Loss: 1.402 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 1.1591856479644775
Epoch: 2, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.398 Vali Acc: 0.221 Test Loss: 1.398 Test Acc: 0.221
Validation loss decreased (-0.216716 --> -0.220518).  Saving model ...
Epoch: 3 cost time: 1.0542817115783691
Epoch: 3, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.398 Vali Acc: 0.236 Test Loss: 1.398 Test Acc: 0.236
Validation loss decreased (-0.220518 --> -0.235727).  Saving model ...
Epoch: 4 cost time: 1.207467794418335
Epoch: 4, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.395 Vali Acc: 0.221 Test Loss: 1.395 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2033624649047852
Epoch: 5, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.395 Vali Acc: 0.247 Test Loss: 1.395 Test Acc: 0.247
Validation loss decreased (-0.235727 --> -0.247134).  Saving model ...
Epoch: 6 cost time: 1.1948809623718262
Epoch: 6, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.395 Vali Acc: 0.236 Test Loss: 1.395 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1737651824951172
Epoch: 7, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.389 Vali Acc: 0.247 Test Loss: 1.389 Test Acc: 0.247
Validation loss decreased (-0.247134 --> -0.247134).  Saving model ...
Epoch: 8 cost time: 1.173762559890747
Epoch: 8, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.402 Vali Acc: 0.243 Test Loss: 1.402 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1616361141204834
Epoch: 9, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.401 Vali Acc: 0.270 Test Loss: 1.401 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269948).  Saving model ...
Epoch: 10 cost time: 1.20196533203125
Epoch: 10, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.408 Vali Acc: 0.259 Test Loss: 1.408 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2438428401947021
Epoch: 11, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.410 Vali Acc: 0.270 Test Loss: 1.410 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0823006629943848
Epoch: 12, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.423 Vali Acc: 0.247 Test Loss: 1.423 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1971073150634766
Epoch: 13, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.420 Vali Acc: 0.266 Test Loss: 1.420 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1207942962646484
Epoch: 14, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.435 Vali Acc: 0.232 Test Loss: 1.435 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.070497751235962
Epoch: 15, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.438 Vali Acc: 0.255 Test Loss: 1.438 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1046619415283203
Epoch: 16, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.437 Vali Acc: 0.243 Test Loss: 1.437 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.050325870513916
Epoch: 17, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.444 Vali Acc: 0.247 Test Loss: 1.444 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1099152565002441
Epoch: 18, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.481 Vali Acc: 0.251 Test Loss: 1.481 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2462706565856934
Epoch: 19, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.474 Vali Acc: 0.240 Test Loss: 1.474 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el2_dm16_nh4_df64_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 14948
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0628280639648438
Epoch: 1, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.521 Vali Acc: 0.251 Test Loss: 1.521 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 1.116898775100708
Epoch: 2, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.509 Vali Acc: 0.224 Test Loss: 1.509 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3188447952270508
Epoch: 3, Steps: 17 | Train Loss: 1.463 Vali Loss: 2.174 Vali Acc: 0.251 Test Loss: 2.174 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2522847652435303
Epoch: 4, Steps: 17 | Train Loss: 1.826 Vali Loss: 1.805 Vali Acc: 0.236 Test Loss: 1.805 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2280056476593018
Epoch: 5, Steps: 17 | Train Loss: 1.770 Vali Loss: 2.618 Vali Acc: 0.247 Test Loss: 2.618 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3098349571228027
Epoch: 6, Steps: 17 | Train Loss: 1.761 Vali Loss: 1.800 Vali Acc: 0.274 Test Loss: 1.800 Test Acc: 0.274
Validation loss decreased (-0.250935 --> -0.273746).  Saving model ...
Epoch: 7 cost time: 1.2861855030059814
Epoch: 7, Steps: 17 | Train Loss: 1.394 Vali Loss: 2.829 Vali Acc: 0.251 Test Loss: 2.829 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2132964134216309
Epoch: 8, Steps: 17 | Train Loss: 1.562 Vali Loss: 2.290 Vali Acc: 0.243 Test Loss: 2.290 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.236421823501587
Epoch: 9, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.724 Vali Acc: 0.262 Test Loss: 1.724 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3237731456756592
Epoch: 10, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.734 Vali Acc: 0.217 Test Loss: 1.734 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.190943956375122
Epoch: 11, Steps: 17 | Train Loss: 1.166 Vali Loss: 2.030 Vali Acc: 0.255 Test Loss: 2.030 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2670106887817383
Epoch: 12, Steps: 17 | Train Loss: 1.329 Vali Loss: 2.234 Vali Acc: 0.266 Test Loss: 2.234 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1387102603912354
Epoch: 13, Steps: 17 | Train Loss: 1.101 Vali Loss: 2.537 Vali Acc: 0.278 Test Loss: 2.537 Test Acc: 0.278
Validation loss decreased (-0.273746 --> -0.277541).  Saving model ...
Epoch: 14 cost time: 1.0914533138275146
Epoch: 14, Steps: 17 | Train Loss: 1.028 Vali Loss: 2.593 Vali Acc: 0.247 Test Loss: 2.593 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.144444227218628
Epoch: 15, Steps: 17 | Train Loss: 1.187 Vali Loss: 2.372 Vali Acc: 0.243 Test Loss: 2.372 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0709433555603027
Epoch: 16, Steps: 17 | Train Loss: 0.973 Vali Loss: 3.383 Vali Acc: 0.259 Test Loss: 3.383 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1604595184326172
Epoch: 17, Steps: 17 | Train Loss: 1.017 Vali Loss: 3.246 Vali Acc: 0.255 Test Loss: 3.246 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2685072422027588
Epoch: 18, Steps: 17 | Train Loss: 1.042 Vali Loss: 3.359 Vali Acc: 0.259 Test Loss: 3.359 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2721893787384033
Epoch: 19, Steps: 17 | Train Loss: 1.099 Vali Loss: 2.757 Vali Acc: 0.243 Test Loss: 2.757 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2066595554351807
Epoch: 20, Steps: 17 | Train Loss: 0.837 Vali Loss: 2.622 Vali Acc: 0.240 Test Loss: 2.622 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2234959602355957
Epoch: 21, Steps: 17 | Train Loss: 0.906 Vali Loss: 2.706 Vali Acc: 0.259 Test Loss: 2.706 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3805396556854248
Epoch: 22, Steps: 17 | Train Loss: 0.741 Vali Loss: 3.711 Vali Acc: 0.278 Test Loss: 3.711 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3516802787780762
Epoch: 23, Steps: 17 | Train Loss: 0.977 Vali Loss: 3.153 Vali Acc: 0.259 Test Loss: 3.153 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 259716
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.146880626678467
Epoch: 1, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.474 Vali Acc: 0.251 Test Loss: 1.474 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.2090914249420166
Epoch: 2, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.441 Vali Acc: 0.259 Test Loss: 1.441 Test Acc: 0.259
Validation loss decreased (-0.250936 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.3252606391906738
Epoch: 3, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.465 Vali Acc: 0.262 Test Loss: 1.465 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.3052003383636475
Epoch: 4, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.535 Vali Acc: 0.262 Test Loss: 1.535 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.343167781829834
Epoch: 5, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.644 Vali Acc: 0.281 Test Loss: 1.644 Test Acc: 0.281
Validation loss decreased (-0.262343 --> -0.281352).  Saving model ...
Epoch: 6 cost time: 1.2767884731292725
Epoch: 6, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.516 Vali Acc: 0.255 Test Loss: 1.516 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3008930683135986
Epoch: 7, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.663 Vali Acc: 0.259 Test Loss: 1.663 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3771083354949951
Epoch: 8, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.726 Vali Acc: 0.262 Test Loss: 1.726 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.14971923828125
Epoch: 9, Steps: 17 | Train Loss: 1.167 Vali Loss: 2.021 Vali Acc: 0.243 Test Loss: 2.021 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3953239917755127
Epoch: 10, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.885 Vali Acc: 0.262 Test Loss: 1.885 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3303859233856201
Epoch: 11, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.762 Vali Acc: 0.240 Test Loss: 1.762 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.408721923828125
Epoch: 12, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.963 Vali Acc: 0.259 Test Loss: 1.963 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2640762329101562
Epoch: 13, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.749 Vali Acc: 0.240 Test Loss: 1.749 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3250043392181396
Epoch: 14, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.843 Vali Acc: 0.270 Test Loss: 1.843 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3091230392456055
Epoch: 15, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.976 Vali Acc: 0.228 Test Loss: 1.976 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 203908
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.701460838317871
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.404 Vali Acc: 0.247 Test Loss: 1.404 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.4102897644042969
Epoch: 2, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.528 Vali Acc: 0.247 Test Loss: 1.528 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.393143892288208
Epoch: 3, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.447 Vali Acc: 0.262 Test Loss: 1.447 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.3946690559387207
Epoch: 4, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.564 Vali Acc: 0.247 Test Loss: 1.564 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4600610733032227
Epoch: 5, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.652 Vali Acc: 0.270 Test Loss: 1.652 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269945).  Saving model ...
Epoch: 6 cost time: 1.3287372589111328
Epoch: 6, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.536 Vali Acc: 0.278 Test Loss: 1.536 Test Acc: 0.278
Validation loss decreased (-0.269945 --> -0.277551).  Saving model ...
Epoch: 7 cost time: 1.4638659954071045
Epoch: 7, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.549 Vali Acc: 0.300 Test Loss: 1.549 Test Acc: 0.300
Validation loss decreased (-0.277551 --> -0.300365).  Saving model ...
Epoch: 8 cost time: 1.410158395767212
Epoch: 8, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.641 Vali Acc: 0.243 Test Loss: 1.641 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2766523361206055
Epoch: 9, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.857 Vali Acc: 0.259 Test Loss: 1.857 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5404493808746338
Epoch: 10, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.727 Vali Acc: 0.266 Test Loss: 1.727 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2784695625305176
Epoch: 11, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.683 Vali Acc: 0.270 Test Loss: 1.683 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2897670269012451
Epoch: 12, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.895 Vali Acc: 0.274 Test Loss: 1.895 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2392377853393555
Epoch: 13, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.791 Vali Acc: 0.270 Test Loss: 1.791 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2945795059204102
Epoch: 14, Steps: 17 | Train Loss: 1.010 Vali Loss: 2.446 Vali Acc: 0.251 Test Loss: 2.446 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4544568061828613
Epoch: 15, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.807 Vali Acc: 0.236 Test Loss: 1.807 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4013862609863281
Epoch: 16, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.943 Vali Acc: 0.251 Test Loss: 1.943 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4030506610870361
Epoch: 17, Steps: 17 | Train Loss: 0.925 Vali Loss: 2.021 Vali Acc: 0.278 Test Loss: 2.021 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 189572
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.235215663909912
Epoch: 1, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.401 Vali Acc: 0.278 Test Loss: 1.401 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 0.9858813285827637
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.412 Vali Acc: 0.236 Test Loss: 1.412 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0352518558502197
Epoch: 3, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.504 Vali Acc: 0.259 Test Loss: 1.504 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0654475688934326
Epoch: 4, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.533 Vali Acc: 0.259 Test Loss: 1.533 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1408441066741943
Epoch: 5, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.490 Vali Acc: 0.240 Test Loss: 1.490 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0679302215576172
Epoch: 6, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.466 Vali Acc: 0.232 Test Loss: 1.466 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.010962963104248
Epoch: 7, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.869 Vali Acc: 0.247 Test Loss: 1.869 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0378413200378418
Epoch: 8, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.487 Vali Acc: 0.247 Test Loss: 1.487 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0328636169433594
Epoch: 9, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.630 Vali Acc: 0.255 Test Loss: 1.630 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0555729866027832
Epoch: 10, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.560 Vali Acc: 0.228 Test Loss: 1.560 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0560314655303955
Epoch: 11, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.630 Vali Acc: 0.255 Test Loss: 1.630 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 184452
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.6967356204986572
Epoch: 1, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.425 Vali Acc: 0.266 Test Loss: 1.425 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 0.9164657592773438
Epoch: 2, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.476 Vali Acc: 0.251 Test Loss: 1.476 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.984158992767334
Epoch: 3, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.417 Vali Acc: 0.266 Test Loss: 1.417 Test Acc: 0.266
Validation loss decreased (-0.266145 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.008124589920044
Epoch: 4, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.458 Vali Acc: 0.247 Test Loss: 1.458 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1202285289764404
Epoch: 5, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.500 Vali Acc: 0.255 Test Loss: 1.500 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9942505359649658
Epoch: 6, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.507 Vali Acc: 0.266 Test Loss: 1.507 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0838172435760498
Epoch: 7, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.590 Vali Acc: 0.270 Test Loss: 1.590 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269946).  Saving model ...
Epoch: 8 cost time: 1.025604248046875
Epoch: 8, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.791 Vali Acc: 0.255 Test Loss: 1.791 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0732696056365967
Epoch: 9, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.636 Vali Acc: 0.255 Test Loss: 1.636 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2524445056915283
Epoch: 10, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.570 Vali Acc: 0.259 Test Loss: 1.570 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0362179279327393
Epoch: 11, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.697 Vali Acc: 0.262 Test Loss: 1.697 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.035834550857544
Epoch: 12, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.705 Vali Acc: 0.259 Test Loss: 1.705 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9301612377166748
Epoch: 13, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.725 Vali Acc: 0.285 Test Loss: 1.725 Test Acc: 0.285
Validation loss decreased (-0.269946 --> -0.285154).  Saving model ...
Epoch: 14 cost time: 1.0678086280822754
Epoch: 14, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.797 Vali Acc: 0.266 Test Loss: 1.797 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0407438278198242
Epoch: 15, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.878 Vali Acc: 0.232 Test Loss: 1.878 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0844428539276123
Epoch: 16, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.685 Vali Acc: 0.281 Test Loss: 1.685 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0501508712768555
Epoch: 17, Steps: 17 | Train Loss: 0.977 Vali Loss: 2.138 Vali Acc: 0.270 Test Loss: 2.138 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.030139684677124
Epoch: 18, Steps: 17 | Train Loss: 0.966 Vali Loss: 2.020 Vali Acc: 0.266 Test Loss: 2.020 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.034132957458496
Epoch: 19, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.824 Vali Acc: 0.259 Test Loss: 1.824 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.004016637802124
Epoch: 20, Steps: 17 | Train Loss: 0.873 Vali Loss: 2.005 Vali Acc: 0.278 Test Loss: 2.005 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.137244462966919
Epoch: 21, Steps: 17 | Train Loss: 0.941 Vali Loss: 2.099 Vali Acc: 0.274 Test Loss: 2.099 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0685310363769531
Epoch: 22, Steps: 17 | Train Loss: 1.016 Vali Loss: 2.250 Vali Acc: 0.266 Test Loss: 2.250 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9986498355865479
Epoch: 23, Steps: 17 | Train Loss: 0.876 Vali Loss: 1.889 Vali Acc: 0.247 Test Loss: 1.889 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 186372
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.771275520324707
Epoch: 1, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.386 Vali Acc: 0.285 Test Loss: 1.386 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 1.0077221393585205
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.386 Vali Acc: 0.285 Test Loss: 1.386 Test Acc: 0.285
Validation loss decreased (-0.285157 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 0.9833991527557373
Epoch: 3, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.421 Vali Acc: 0.262 Test Loss: 1.421 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1279597282409668
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.502 Vali Acc: 0.274 Test Loss: 1.502 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.130082607269287
Epoch: 5, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.469 Vali Acc: 0.259 Test Loss: 1.469 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1014790534973145
Epoch: 6, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.481 Vali Acc: 0.274 Test Loss: 1.481 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1334235668182373
Epoch: 7, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.644 Vali Acc: 0.243 Test Loss: 1.644 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.35722017288208
Epoch: 8, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.535 Vali Acc: 0.243 Test Loss: 1.535 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.100635051727295
Epoch: 9, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.659 Vali Acc: 0.255 Test Loss: 1.659 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.164113998413086
Epoch: 10, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.604 Vali Acc: 0.251 Test Loss: 1.604 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0566761493682861
Epoch: 11, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.665 Vali Acc: 0.255 Test Loss: 1.665 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1793100833892822
Epoch: 12, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.689 Vali Acc: 0.240 Test Loss: 1.689 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 191492
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3689253330230713
Epoch: 1, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.450 Vali Acc: 0.209 Test Loss: 1.450 Test Acc: 0.209
Validation loss decreased (inf --> -0.209111).  Saving model ...
Epoch: 2 cost time: 0.7436027526855469
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.420 Vali Acc: 0.236 Test Loss: 1.420 Test Acc: 0.236
Validation loss decreased (-0.209111 --> -0.235727).  Saving model ...
Epoch: 3 cost time: 0.7858209609985352
Epoch: 3, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.437 Vali Acc: 0.247 Test Loss: 1.437 Test Acc: 0.247
Validation loss decreased (-0.235727 --> -0.247134).  Saving model ...
Epoch: 4 cost time: 0.8271517753601074
Epoch: 4, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.436 Vali Acc: 0.236 Test Loss: 1.436 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8382749557495117
Epoch: 5, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.569 Vali Acc: 0.232 Test Loss: 1.569 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8655619621276855
Epoch: 6, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.507 Vali Acc: 0.247 Test Loss: 1.507 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8315560817718506
Epoch: 7, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.498 Vali Acc: 0.243 Test Loss: 1.498 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8341703414916992
Epoch: 8, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.551 Vali Acc: 0.247 Test Loss: 1.551 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.90317702293396
Epoch: 9, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.645 Vali Acc: 0.270 Test Loss: 1.645 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269946).  Saving model ...
Epoch: 10 cost time: 0.8251967430114746
Epoch: 10, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.543 Vali Acc: 0.224 Test Loss: 1.543 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8106234073638916
Epoch: 11, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.570 Vali Acc: 0.255 Test Loss: 1.570 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7678139209747314
Epoch: 12, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.748 Vali Acc: 0.240 Test Loss: 1.748 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7702417373657227
Epoch: 13, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.648 Vali Acc: 0.247 Test Loss: 1.648 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8527445793151855
Epoch: 14, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.727 Vali Acc: 0.266 Test Loss: 1.727 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8186979293823242
Epoch: 15, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.948 Vali Acc: 0.255 Test Loss: 1.948 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8169012069702148
Epoch: 16, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.740 Vali Acc: 0.262 Test Loss: 1.740 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.769366979598999
Epoch: 17, Steps: 17 | Train Loss: 1.142 Vali Loss: 2.026 Vali Acc: 0.262 Test Loss: 2.026 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9122359752655029
Epoch: 18, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.960 Vali Acc: 0.255 Test Loss: 1.960 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8069553375244141
Epoch: 19, Steps: 17 | Train Loss: 0.985 Vali Loss: 2.303 Vali Acc: 0.270 Test Loss: 2.303 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df256_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 199556
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.896878480911255
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.865 Vali Acc: 0.251 Test Loss: 1.865 Test Acc: 0.251
Validation loss decreased (inf --> -0.250932).  Saving model ...
Epoch: 2 cost time: 1.5021662712097168
Epoch: 2, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.982 Vali Acc: 0.259 Test Loss: 1.982 Test Acc: 0.259
Validation loss decreased (-0.250932 --> -0.258535).  Saving model ...
Epoch: 3 cost time: 1.5720982551574707
Epoch: 3, Steps: 17 | Train Loss: 1.839 Vali Loss: 1.737 Vali Acc: 0.255 Test Loss: 1.737 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.376563310623169
Epoch: 4, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.632 Vali Acc: 0.262 Test Loss: 1.632 Test Acc: 0.262
Validation loss decreased (-0.258535 --> -0.262341).  Saving model ...
Epoch: 5 cost time: 1.440199851989746
Epoch: 5, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.735 Vali Acc: 0.259 Test Loss: 1.735 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5186448097229004
Epoch: 6, Steps: 17 | Train Loss: 1.428 Vali Loss: 2.138 Vali Acc: 0.255 Test Loss: 2.138 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.236098289489746
Epoch: 7, Steps: 17 | Train Loss: 1.365 Vali Loss: 2.008 Vali Acc: 0.232 Test Loss: 2.008 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5616555213928223
Epoch: 8, Steps: 17 | Train Loss: 1.535 Vali Loss: 2.230 Vali Acc: 0.259 Test Loss: 2.230 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2500760555267334
Epoch: 9, Steps: 17 | Train Loss: 1.663 Vali Loss: 2.392 Vali Acc: 0.281 Test Loss: 2.392 Test Acc: 0.281
Validation loss decreased (-0.262341 --> -0.281345).  Saving model ...
Epoch: 10 cost time: 1.2124488353729248
Epoch: 10, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.866 Vali Acc: 0.247 Test Loss: 1.866 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4628798961639404
Epoch: 11, Steps: 17 | Train Loss: 1.234 Vali Loss: 2.180 Vali Acc: 0.251 Test Loss: 2.180 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3210344314575195
Epoch: 12, Steps: 17 | Train Loss: 1.262 Vali Loss: 2.123 Vali Acc: 0.262 Test Loss: 2.123 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2411866188049316
Epoch: 13, Steps: 17 | Train Loss: 1.105 Vali Loss: 2.885 Vali Acc: 0.259 Test Loss: 2.885 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5953295230865479
Epoch: 14, Steps: 17 | Train Loss: 1.076 Vali Loss: 2.100 Vali Acc: 0.209 Test Loss: 2.100 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3845150470733643
Epoch: 15, Steps: 17 | Train Loss: 1.090 Vali Loss: 2.388 Vali Acc: 0.270 Test Loss: 2.388 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5990254878997803
Epoch: 16, Steps: 17 | Train Loss: 1.009 Vali Loss: 2.426 Vali Acc: 0.217 Test Loss: 2.426 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5393455028533936
Epoch: 17, Steps: 17 | Train Loss: 1.008 Vali Loss: 3.042 Vali Acc: 0.251 Test Loss: 3.042 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2072038650512695
Epoch: 18, Steps: 17 | Train Loss: 1.012 Vali Loss: 2.551 Vali Acc: 0.262 Test Loss: 2.551 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5837645530700684
Epoch: 19, Steps: 17 | Train Loss: 0.935 Vali Loss: 2.384 Vali Acc: 0.228 Test Loss: 2.384 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 226820
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8449482917785645
Epoch: 1, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.549 Vali Acc: 0.247 Test Loss: 1.549 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 1.4449312686920166
Epoch: 2, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.514 Vali Acc: 0.247 Test Loss: 1.514 Test Acc: 0.247
Validation loss decreased (-0.247133 --> -0.247133).  Saving model ...
Epoch: 3 cost time: 1.5869441032409668
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.600 Vali Acc: 0.255 Test Loss: 1.600 Test Acc: 0.255
Validation loss decreased (-0.247133 --> -0.254737).  Saving model ...
Epoch: 4 cost time: 1.728137493133545
Epoch: 4, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.640 Vali Acc: 0.255 Test Loss: 1.640 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6066040992736816
Epoch: 5, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.557 Vali Acc: 0.259 Test Loss: 1.557 Test Acc: 0.259
Validation loss decreased (-0.254737 --> -0.258540).  Saving model ...
Epoch: 6 cost time: 1.6744141578674316
Epoch: 6, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.604 Vali Acc: 0.274 Test Loss: 1.604 Test Acc: 0.274
Validation loss decreased (-0.258540 --> -0.273748).  Saving model ...
Epoch: 7 cost time: 1.690359115600586
Epoch: 7, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.566 Vali Acc: 0.274 Test Loss: 1.566 Test Acc: 0.274
Validation loss decreased (-0.273748 --> -0.273749).  Saving model ...
Epoch: 8 cost time: 1.483001470565796
Epoch: 8, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.603 Vali Acc: 0.262 Test Loss: 1.603 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7788727283477783
Epoch: 9, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.623 Vali Acc: 0.209 Test Loss: 1.623 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.799673080444336
Epoch: 10, Steps: 17 | Train Loss: 1.243 Vali Loss: 2.019 Vali Acc: 0.236 Test Loss: 2.019 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8944265842437744
Epoch: 11, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.966 Vali Acc: 0.236 Test Loss: 1.966 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8262362480163574
Epoch: 12, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.919 Vali Acc: 0.266 Test Loss: 1.919 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.679410696029663
Epoch: 13, Steps: 17 | Train Loss: 1.006 Vali Loss: 2.040 Vali Acc: 0.259 Test Loss: 2.040 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7844455242156982
Epoch: 14, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.894 Vali Acc: 0.281 Test Loss: 1.894 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281350).  Saving model ...
Epoch: 15 cost time: 1.7077345848083496
Epoch: 15, Steps: 17 | Train Loss: 0.944 Vali Loss: 1.921 Vali Acc: 0.262 Test Loss: 1.921 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7520568370819092
Epoch: 16, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.358 Vali Acc: 0.266 Test Loss: 2.358 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4920289516448975
Epoch: 17, Steps: 17 | Train Loss: 0.960 Vali Loss: 2.543 Vali Acc: 0.251 Test Loss: 2.543 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8458378314971924
Epoch: 18, Steps: 17 | Train Loss: 1.276 Vali Loss: 2.885 Vali Acc: 0.262 Test Loss: 2.885 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9484562873840332
Epoch: 19, Steps: 17 | Train Loss: 1.017 Vali Loss: 2.332 Vali Acc: 0.278 Test Loss: 2.332 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7637569904327393
Epoch: 20, Steps: 17 | Train Loss: 0.870 Vali Loss: 2.212 Vali Acc: 0.251 Test Loss: 2.212 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0254287719726562
Epoch: 21, Steps: 17 | Train Loss: 0.785 Vali Loss: 2.315 Vali Acc: 0.221 Test Loss: 2.315 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9745235443115234
Epoch: 22, Steps: 17 | Train Loss: 0.728 Vali Loss: 2.526 Vali Acc: 0.255 Test Loss: 2.526 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6066842079162598
Epoch: 23, Steps: 17 | Train Loss: 0.870 Vali Loss: 2.734 Vali Acc: 0.232 Test Loss: 2.734 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7618389129638672
Epoch: 24, Steps: 17 | Train Loss: 0.857 Vali Loss: 2.918 Vali Acc: 0.247 Test Loss: 2.918 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 171012
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8647897243499756
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.455 Vali Acc: 0.270 Test Loss: 1.455 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 1.523052453994751
Epoch: 2, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.491 Vali Acc: 0.255 Test Loss: 1.491 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9380335807800293
Epoch: 3, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.441 Vali Acc: 0.297 Test Loss: 1.441 Test Acc: 0.297
Validation loss decreased (-0.269947 --> -0.296564).  Saving model ...
Epoch: 4 cost time: 1.6822619438171387
Epoch: 4, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.544 Vali Acc: 0.278 Test Loss: 1.544 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7897038459777832
Epoch: 5, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.484 Vali Acc: 0.270 Test Loss: 1.484 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9025886058807373
Epoch: 6, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.551 Vali Acc: 0.289 Test Loss: 1.551 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.060346841812134
Epoch: 7, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.637 Vali Acc: 0.262 Test Loss: 1.637 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6144273281097412
Epoch: 8, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.495 Vali Acc: 0.266 Test Loss: 1.495 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7774937152862549
Epoch: 9, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.621 Vali Acc: 0.232 Test Loss: 1.621 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7496023178100586
Epoch: 10, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.979 Vali Acc: 0.236 Test Loss: 1.979 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.539808750152588
Epoch: 11, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.849 Vali Acc: 0.266 Test Loss: 1.849 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9488658905029297
Epoch: 12, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.822 Vali Acc: 0.240 Test Loss: 1.822 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.827390432357788
Epoch: 13, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.661 Vali Acc: 0.255 Test Loss: 1.661 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 156676
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0716378688812256
Epoch: 1, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.445 Vali Acc: 0.228 Test Loss: 1.445 Test Acc: 0.228
Validation loss decreased (inf --> -0.228122).  Saving model ...
Epoch: 2 cost time: 1.098029613494873
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.468 Vali Acc: 0.274 Test Loss: 1.468 Test Acc: 0.274
Validation loss decreased (-0.228122 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 1.284708023071289
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.426 Vali Acc: 0.255 Test Loss: 1.426 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2457342147827148
Epoch: 4, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.539 Vali Acc: 0.236 Test Loss: 1.539 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2062766551971436
Epoch: 5, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.486 Vali Acc: 0.255 Test Loss: 1.486 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2052948474884033
Epoch: 6, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.570 Vali Acc: 0.255 Test Loss: 1.570 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.343139886856079
Epoch: 7, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.665 Vali Acc: 0.255 Test Loss: 1.665 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2574129104614258
Epoch: 8, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.576 Vali Acc: 0.289 Test Loss: 1.576 Test Acc: 0.289
Validation loss decreased (-0.273750 --> -0.288958).  Saving model ...
Epoch: 9 cost time: 1.2620420455932617
Epoch: 9, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.855 Vali Acc: 0.270 Test Loss: 1.855 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2838490009307861
Epoch: 10, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.731 Vali Acc: 0.274 Test Loss: 1.731 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1951828002929688
Epoch: 11, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.644 Vali Acc: 0.259 Test Loss: 1.644 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.102179765701294
Epoch: 12, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.762 Vali Acc: 0.228 Test Loss: 1.762 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.211270809173584
Epoch: 13, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.802 Vali Acc: 0.228 Test Loss: 1.802 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1915931701660156
Epoch: 14, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.806 Vali Acc: 0.224 Test Loss: 1.806 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3010120391845703
Epoch: 15, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.898 Vali Acc: 0.251 Test Loss: 1.898 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2898907661437988
Epoch: 16, Steps: 17 | Train Loss: 1.044 Vali Loss: 2.203 Vali Acc: 0.262 Test Loss: 2.203 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1209676265716553
Epoch: 17, Steps: 17 | Train Loss: 1.047 Vali Loss: 2.013 Vali Acc: 0.228 Test Loss: 2.013 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.017214059829712
Epoch: 18, Steps: 17 | Train Loss: 0.898 Vali Loss: 2.033 Vali Acc: 0.262 Test Loss: 2.033 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 151556
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.365351915359497
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.410 Vali Acc: 0.236 Test Loss: 1.410 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.2259211540222168
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.432 Vali Acc: 0.221 Test Loss: 1.432 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2882752418518066
Epoch: 3, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.422 Vali Acc: 0.259 Test Loss: 1.422 Test Acc: 0.259
Validation loss decreased (-0.235727 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 1.3163020610809326
Epoch: 4, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.648 Vali Acc: 0.262 Test Loss: 1.648 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262341).  Saving model ...
Epoch: 5 cost time: 1.3938233852386475
Epoch: 5, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.477 Vali Acc: 0.289 Test Loss: 1.477 Test Acc: 0.289
Validation loss decreased (-0.262341 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 1.15610671043396
Epoch: 6, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.561 Vali Acc: 0.251 Test Loss: 1.561 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2892475128173828
Epoch: 7, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.507 Vali Acc: 0.270 Test Loss: 1.507 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.271907091140747
Epoch: 8, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.477 Vali Acc: 0.274 Test Loss: 1.477 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4341762065887451
Epoch: 9, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.512 Vali Acc: 0.240 Test Loss: 1.512 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3113658428192139
Epoch: 10, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.725 Vali Acc: 0.251 Test Loss: 1.725 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1541571617126465
Epoch: 11, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.722 Vali Acc: 0.270 Test Loss: 1.722 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2978839874267578
Epoch: 12, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.812 Vali Acc: 0.259 Test Loss: 1.812 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.240828275680542
Epoch: 13, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.771 Vali Acc: 0.240 Test Loss: 1.771 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1809089183807373
Epoch: 14, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.783 Vali Acc: 0.251 Test Loss: 1.783 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3234755992889404
Epoch: 15, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.985 Vali Acc: 0.259 Test Loss: 1.985 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 153476
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9629437923431396
Epoch: 1, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.415 Vali Acc: 0.240 Test Loss: 1.415 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.105539083480835
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.450 Vali Acc: 0.251 Test Loss: 1.450 Test Acc: 0.251
Validation loss decreased (-0.239530 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 1.0811774730682373
Epoch: 3, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.511 Vali Acc: 0.285 Test Loss: 1.511 Test Acc: 0.285
Validation loss decreased (-0.250936 --> -0.285156).  Saving model ...
Epoch: 4 cost time: 1.1877045631408691
Epoch: 4, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.466 Vali Acc: 0.243 Test Loss: 1.466 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2309973239898682
Epoch: 5, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.553 Vali Acc: 0.262 Test Loss: 1.553 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2062978744506836
Epoch: 6, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.541 Vali Acc: 0.217 Test Loss: 1.541 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.98819899559021
Epoch: 7, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.521 Vali Acc: 0.228 Test Loss: 1.521 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1362245082855225
Epoch: 8, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.526 Vali Acc: 0.247 Test Loss: 1.526 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2045118808746338
Epoch: 9, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.559 Vali Acc: 0.243 Test Loss: 1.559 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2415528297424316
Epoch: 10, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.666 Vali Acc: 0.266 Test Loss: 1.666 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0846619606018066
Epoch: 11, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.660 Vali Acc: 0.251 Test Loss: 1.660 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1627206802368164
Epoch: 12, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.653 Vali Acc: 0.266 Test Loss: 1.653 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1938607692718506
Epoch: 13, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.664 Vali Acc: 0.251 Test Loss: 1.664 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 158596
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.772585391998291
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.398 Vali Acc: 0.274 Test Loss: 1.398 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.1325247287750244
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.410 Vali Acc: 0.255 Test Loss: 1.410 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9823160171508789
Epoch: 3, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.468 Vali Acc: 0.285 Test Loss: 1.468 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 4 cost time: 0.9613204002380371
Epoch: 4, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.438 Vali Acc: 0.243 Test Loss: 1.438 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1594972610473633
Epoch: 5, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.529 Vali Acc: 0.262 Test Loss: 1.529 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.292306661605835
Epoch: 6, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.490 Vali Acc: 0.255 Test Loss: 1.490 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2357914447784424
Epoch: 7, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.464 Vali Acc: 0.255 Test Loss: 1.464 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1913542747497559
Epoch: 8, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.494 Vali Acc: 0.232 Test Loss: 1.494 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3283567428588867
Epoch: 9, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.729 Vali Acc: 0.240 Test Loss: 1.729 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.279395341873169
Epoch: 10, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.592 Vali Acc: 0.228 Test Loss: 1.592 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2493431568145752
Epoch: 11, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.603 Vali Acc: 0.224 Test Loss: 1.603 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.253654956817627
Epoch: 12, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.621 Vali Acc: 0.243 Test Loss: 1.621 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1217389106750488
Epoch: 13, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.860 Vali Acc: 0.243 Test Loss: 1.860 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df128_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 166660
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4829800128936768
Epoch: 1, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.969 Vali Acc: 0.251 Test Loss: 1.969 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 1.7772150039672852
Epoch: 2, Steps: 17 | Train Loss: 1.586 Vali Loss: 1.922 Vali Acc: 0.259 Test Loss: 1.922 Test Acc: 0.259
Validation loss decreased (-0.250931 --> -0.258536).  Saving model ...
Epoch: 3 cost time: 1.7484657764434814
Epoch: 3, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.991 Vali Acc: 0.262 Test Loss: 1.991 Test Acc: 0.262
Validation loss decreased (-0.258536 --> -0.262338).  Saving model ...
Epoch: 4 cost time: 1.9173517227172852
Epoch: 4, Steps: 17 | Train Loss: 1.872 Vali Loss: 2.322 Vali Acc: 0.228 Test Loss: 2.322 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.663818597793579
Epoch: 5, Steps: 17 | Train Loss: 2.119 Vali Loss: 1.899 Vali Acc: 0.236 Test Loss: 1.899 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4791591167449951
Epoch: 6, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.592 Vali Acc: 0.297 Test Loss: 1.592 Test Acc: 0.297
Validation loss decreased (-0.262338 --> -0.296562).  Saving model ...
Epoch: 7 cost time: 1.7196311950683594
Epoch: 7, Steps: 17 | Train Loss: 1.457 Vali Loss: 2.251 Vali Acc: 0.255 Test Loss: 2.251 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7393503189086914
Epoch: 8, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.830 Vali Acc: 0.247 Test Loss: 1.830 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6550745964050293
Epoch: 9, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.850 Vali Acc: 0.266 Test Loss: 1.850 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7553775310516357
Epoch: 10, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.780 Vali Acc: 0.278 Test Loss: 1.780 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6134462356567383
Epoch: 11, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.844 Vali Acc: 0.247 Test Loss: 1.844 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5211966037750244
Epoch: 12, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.853 Vali Acc: 0.213 Test Loss: 1.853 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7330799102783203
Epoch: 13, Steps: 17 | Train Loss: 1.251 Vali Loss: 2.616 Vali Acc: 0.240 Test Loss: 2.616 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6898283958435059
Epoch: 14, Steps: 17 | Train Loss: 1.197 Vali Loss: 2.992 Vali Acc: 0.270 Test Loss: 2.992 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5698513984680176
Epoch: 15, Steps: 17 | Train Loss: 1.233 Vali Loss: 2.648 Vali Acc: 0.281 Test Loss: 2.648 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6629176139831543
Epoch: 16, Steps: 17 | Train Loss: 0.994 Vali Loss: 2.255 Vali Acc: 0.262 Test Loss: 2.255 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 210372
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.614104747772217
Epoch: 1, Steps: 17 | Train Loss: 1.621 Vali Loss: 1.433 Vali Acc: 0.255 Test Loss: 1.433 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.8029680252075195
Epoch: 2, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.393 Vali Acc: 0.262 Test Loss: 1.393 Test Acc: 0.262
Validation loss decreased (-0.254739 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 1.5215086936950684
Epoch: 3, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.425 Vali Acc: 0.289 Test Loss: 1.425 Test Acc: 0.289
Validation loss decreased (-0.262343 --> -0.288959).  Saving model ...
Epoch: 4 cost time: 1.6701571941375732
Epoch: 4, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.514 Vali Acc: 0.278 Test Loss: 1.514 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6311841011047363
Epoch: 5, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.614 Vali Acc: 0.270 Test Loss: 1.614 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.696800947189331
Epoch: 6, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.549 Vali Acc: 0.251 Test Loss: 1.549 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8222315311431885
Epoch: 7, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.876 Vali Acc: 0.247 Test Loss: 1.876 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7785639762878418
Epoch: 8, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.831 Vali Acc: 0.281 Test Loss: 1.831 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4987425804138184
Epoch: 9, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.838 Vali Acc: 0.274 Test Loss: 1.838 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4069387912750244
Epoch: 10, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.853 Vali Acc: 0.247 Test Loss: 1.853 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.353447437286377
Epoch: 11, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.703 Vali Acc: 0.259 Test Loss: 1.703 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3878591060638428
Epoch: 12, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.701 Vali Acc: 0.255 Test Loss: 1.701 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.398832082748413
Epoch: 13, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.760 Vali Acc: 0.259 Test Loss: 1.760 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 154564
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.459038496017456
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.461 Vali Acc: 0.266 Test Loss: 1.461 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 1.5863194465637207
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.455 Vali Acc: 0.243 Test Loss: 1.455 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.53291916847229
Epoch: 3, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.441 Vali Acc: 0.262 Test Loss: 1.441 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5707573890686035
Epoch: 4, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.450 Vali Acc: 0.281 Test Loss: 1.450 Test Acc: 0.281
Validation loss decreased (-0.266145 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 1.8897666931152344
Epoch: 5, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.499 Vali Acc: 0.243 Test Loss: 1.499 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5418150424957275
Epoch: 6, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.575 Vali Acc: 0.251 Test Loss: 1.575 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6775171756744385
Epoch: 7, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.643 Vali Acc: 0.251 Test Loss: 1.643 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5194106101989746
Epoch: 8, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.912 Vali Acc: 0.255 Test Loss: 1.912 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.889497995376587
Epoch: 9, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.861 Vali Acc: 0.262 Test Loss: 1.861 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5790674686431885
Epoch: 10, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.756 Vali Acc: 0.270 Test Loss: 1.756 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.568471908569336
Epoch: 11, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.882 Vali Acc: 0.228 Test Loss: 1.882 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4566013813018799
Epoch: 12, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.724 Vali Acc: 0.259 Test Loss: 1.724 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4221680164337158
Epoch: 13, Steps: 17 | Train Loss: 1.060 Vali Loss: 2.138 Vali Acc: 0.247 Test Loss: 2.138 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3935620784759521
Epoch: 14, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.908 Vali Acc: 0.236 Test Loss: 1.908 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 140228
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.667243719100952
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.435 Vali Acc: 0.259 Test Loss: 1.435 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.1728816032409668
Epoch: 2, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.548 Vali Acc: 0.274 Test Loss: 1.548 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273749).  Saving model ...
Epoch: 3 cost time: 1.0102968215942383
Epoch: 3, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.441 Vali Acc: 0.262 Test Loss: 1.441 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0827395915985107
Epoch: 4, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.713 Vali Acc: 0.278 Test Loss: 1.713 Test Acc: 0.278
Validation loss decreased (-0.273749 --> -0.277549).  Saving model ...
Epoch: 5 cost time: 1.1425247192382812
Epoch: 5, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.519 Vali Acc: 0.247 Test Loss: 1.519 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1544945240020752
Epoch: 6, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.593 Vali Acc: 0.247 Test Loss: 1.593 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.173133373260498
Epoch: 7, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.587 Vali Acc: 0.270 Test Loss: 1.587 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1237995624542236
Epoch: 8, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.596 Vali Acc: 0.285 Test Loss: 1.596 Test Acc: 0.285
Validation loss decreased (-0.277549 --> -0.285155).  Saving model ...
Epoch: 9 cost time: 1.0305302143096924
Epoch: 9, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.569 Vali Acc: 0.293 Test Loss: 1.569 Test Acc: 0.293
Validation loss decreased (-0.285155 --> -0.292760).  Saving model ...
Epoch: 10 cost time: 1.101191759109497
Epoch: 10, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.632 Vali Acc: 0.262 Test Loss: 1.632 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1159038543701172
Epoch: 11, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.614 Vali Acc: 0.262 Test Loss: 1.614 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.146005630493164
Epoch: 12, Steps: 17 | Train Loss: 1.124 Vali Loss: 2.077 Vali Acc: 0.262 Test Loss: 2.077 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0772931575775146
Epoch: 13, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.897 Vali Acc: 0.259 Test Loss: 1.897 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.046083688735962
Epoch: 14, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.677 Vali Acc: 0.232 Test Loss: 1.677 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9968531131744385
Epoch: 15, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.666 Vali Acc: 0.232 Test Loss: 1.666 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0913670063018799
Epoch: 16, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.711 Vali Acc: 0.228 Test Loss: 1.711 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.048515796661377
Epoch: 17, Steps: 17 | Train Loss: 0.891 Vali Loss: 1.900 Vali Acc: 0.262 Test Loss: 1.900 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9061927795410156
Epoch: 18, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.913 Vali Acc: 0.274 Test Loss: 1.913 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.012345314025879
Epoch: 19, Steps: 17 | Train Loss: 0.906 Vali Loss: 2.089 Vali Acc: 0.266 Test Loss: 2.089 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 135108
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0772809982299805
Epoch: 1, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.396 Vali Acc: 0.232 Test Loss: 1.396 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.1349587440490723
Epoch: 2, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.438 Vali Acc: 0.236 Test Loss: 1.438 Test Acc: 0.236
Validation loss decreased (-0.231925 --> -0.235727).  Saving model ...
Epoch: 3 cost time: 1.063488483428955
Epoch: 3, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.411 Vali Acc: 0.266 Test Loss: 1.411 Test Acc: 0.266
Validation loss decreased (-0.235727 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.046509027481079
Epoch: 4, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.467 Vali Acc: 0.240 Test Loss: 1.467 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1713893413543701
Epoch: 5, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.493 Vali Acc: 0.259 Test Loss: 1.493 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2481894493103027
Epoch: 6, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.483 Vali Acc: 0.251 Test Loss: 1.483 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1816129684448242
Epoch: 7, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.480 Vali Acc: 0.243 Test Loss: 1.480 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.165712594985962
Epoch: 8, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.496 Vali Acc: 0.251 Test Loss: 1.496 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0990774631500244
Epoch: 9, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.521 Vali Acc: 0.243 Test Loss: 1.521 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2168951034545898
Epoch: 10, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.522 Vali Acc: 0.247 Test Loss: 1.522 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.095435380935669
Epoch: 11, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.864 Vali Acc: 0.232 Test Loss: 1.864 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1907498836517334
Epoch: 12, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.696 Vali Acc: 0.262 Test Loss: 1.696 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2266998291015625
Epoch: 13, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.679 Vali Acc: 0.262 Test Loss: 1.679 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 137028
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0329532623291016
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.424 Vali Acc: 0.251 Test Loss: 1.424 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.2680723667144775
Epoch: 2, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.439 Vali Acc: 0.262 Test Loss: 1.439 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 1.0911500453948975
Epoch: 3, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.441 Vali Acc: 0.232 Test Loss: 1.441 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.162827491760254
Epoch: 4, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.563 Vali Acc: 0.251 Test Loss: 1.563 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1683108806610107
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.491 Vali Acc: 0.217 Test Loss: 1.491 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2669968605041504
Epoch: 6, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.641 Vali Acc: 0.262 Test Loss: 1.641 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2088291645050049
Epoch: 7, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.598 Vali Acc: 0.266 Test Loss: 1.598 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266144).  Saving model ...
Epoch: 8 cost time: 1.2207987308502197
Epoch: 8, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.603 Vali Acc: 0.232 Test Loss: 1.603 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.059250831604004
Epoch: 9, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.693 Vali Acc: 0.224 Test Loss: 1.693 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.060655117034912
Epoch: 10, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.533 Vali Acc: 0.274 Test Loss: 1.533 Test Acc: 0.274
Validation loss decreased (-0.266144 --> -0.273749).  Saving model ...
Epoch: 11 cost time: 1.2703030109405518
Epoch: 11, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.587 Vali Acc: 0.259 Test Loss: 1.587 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1522016525268555
Epoch: 12, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.811 Vali Acc: 0.251 Test Loss: 1.811 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0628082752227783
Epoch: 13, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.767 Vali Acc: 0.270 Test Loss: 1.767 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0383589267730713
Epoch: 14, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.668 Vali Acc: 0.243 Test Loss: 1.668 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0903921127319336
Epoch: 15, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.828 Vali Acc: 0.285 Test Loss: 1.828 Test Acc: 0.285
Validation loss decreased (-0.273749 --> -0.285153).  Saving model ...
Epoch: 16 cost time: 1.2325255870819092
Epoch: 16, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.698 Vali Acc: 0.255 Test Loss: 1.698 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1798768043518066
Epoch: 17, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.726 Vali Acc: 0.232 Test Loss: 1.726 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3527648448944092
Epoch: 18, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.771 Vali Acc: 0.240 Test Loss: 1.771 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1804790496826172
Epoch: 19, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.740 Vali Acc: 0.270 Test Loss: 1.740 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.169701099395752
Epoch: 20, Steps: 17 | Train Loss: 0.861 Vali Loss: 1.972 Vali Acc: 0.278 Test Loss: 1.972 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1170604228973389
Epoch: 21, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.938 Vali Acc: 0.262 Test Loss: 1.938 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0672125816345215
Epoch: 22, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.911 Vali Acc: 0.274 Test Loss: 1.911 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1524121761322021
Epoch: 23, Steps: 17 | Train Loss: 0.851 Vali Loss: 1.966 Vali Acc: 0.270 Test Loss: 1.966 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0524132251739502
Epoch: 24, Steps: 17 | Train Loss: 0.841 Vali Loss: 2.060 Vali Acc: 0.251 Test Loss: 2.060 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0977039337158203
Epoch: 25, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.097 Vali Acc: 0.274 Test Loss: 2.097 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 142148
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.042468786239624
Epoch: 1, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.409 Vali Acc: 0.274 Test Loss: 1.409 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.0916972160339355
Epoch: 2, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.405 Vali Acc: 0.262 Test Loss: 1.405 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.005779504776001
Epoch: 3, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.436 Vali Acc: 0.278 Test Loss: 1.436 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 1.1427271366119385
Epoch: 4, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.498 Vali Acc: 0.243 Test Loss: 1.498 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.155604600906372
Epoch: 5, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.532 Vali Acc: 0.266 Test Loss: 1.532 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.132215976715088
Epoch: 6, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.549 Vali Acc: 0.259 Test Loss: 1.549 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1152844429016113
Epoch: 7, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.459 Vali Acc: 0.240 Test Loss: 1.459 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1397264003753662
Epoch: 8, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.464 Vali Acc: 0.240 Test Loss: 1.464 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0947000980377197
Epoch: 9, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.507 Vali Acc: 0.270 Test Loss: 1.507 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1382384300231934
Epoch: 10, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.526 Vali Acc: 0.262 Test Loss: 1.526 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1035704612731934
Epoch: 11, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.580 Vali Acc: 0.255 Test Loss: 1.580 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0767271518707275
Epoch: 12, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.550 Vali Acc: 0.247 Test Loss: 1.550 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.138023853302002
Epoch: 13, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.605 Vali Acc: 0.247 Test Loss: 1.605 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm128_nh16_df64_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 150212
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9306108951568604
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.446 Vali Acc: 0.251 Test Loss: 1.446 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.2465317249298096
Epoch: 2, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.414 Vali Acc: 0.278 Test Loss: 1.414 Test Acc: 0.278
Validation loss decreased (-0.250936 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 1.6532318592071533
Epoch: 3, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.737 Vali Acc: 0.266 Test Loss: 1.737 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9252521991729736
Epoch: 4, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.532 Vali Acc: 0.259 Test Loss: 1.532 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8002233505249023
Epoch: 5, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.620 Vali Acc: 0.240 Test Loss: 1.620 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.752847671508789
Epoch: 6, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.632 Vali Acc: 0.247 Test Loss: 1.632 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7757337093353271
Epoch: 7, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.643 Vali Acc: 0.251 Test Loss: 1.643 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4301221370697021
Epoch: 8, Steps: 17 | Train Loss: 1.464 Vali Loss: 2.018 Vali Acc: 0.232 Test Loss: 2.018 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8285903930664062
Epoch: 9, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.946 Vali Acc: 0.262 Test Loss: 1.946 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7439885139465332
Epoch: 10, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.855 Vali Acc: 0.262 Test Loss: 1.855 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9034883975982666
Epoch: 11, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.641 Vali Acc: 0.228 Test Loss: 1.641 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.522324800491333
Epoch: 12, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.704 Vali Acc: 0.262 Test Loss: 1.704 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 113604
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.868027687072754
Epoch: 1, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.407 Vali Acc: 0.285 Test Loss: 1.407 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 1.2233967781066895
Epoch: 2, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.427 Vali Acc: 0.281 Test Loss: 1.427 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.025287389755249
Epoch: 3, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.441 Vali Acc: 0.228 Test Loss: 1.441 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1061625480651855
Epoch: 4, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.501 Vali Acc: 0.243 Test Loss: 1.501 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1415104866027832
Epoch: 5, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.587 Vali Acc: 0.251 Test Loss: 1.587 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0503251552581787
Epoch: 6, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.473 Vali Acc: 0.259 Test Loss: 1.473 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0961651802062988
Epoch: 7, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.511 Vali Acc: 0.243 Test Loss: 1.511 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3204293251037598
Epoch: 8, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.504 Vali Acc: 0.293 Test Loss: 1.504 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292761).  Saving model ...
Epoch: 9 cost time: 1.2252380847930908
Epoch: 9, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.676 Vali Acc: 0.228 Test Loss: 1.676 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.121431827545166
Epoch: 10, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.612 Vali Acc: 0.266 Test Loss: 1.612 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2183644771575928
Epoch: 11, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.863 Vali Acc: 0.243 Test Loss: 1.863 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2414228916168213
Epoch: 12, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.872 Vali Acc: 0.255 Test Loss: 1.872 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.03916597366333
Epoch: 13, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.735 Vali Acc: 0.278 Test Loss: 1.735 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.215092658996582
Epoch: 14, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.598 Vali Acc: 0.270 Test Loss: 1.598 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2053272724151611
Epoch: 15, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.701 Vali Acc: 0.255 Test Loss: 1.701 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.209425687789917
Epoch: 16, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.830 Vali Acc: 0.236 Test Loss: 1.830 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9769434928894043
Epoch: 17, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.661 Vali Acc: 0.262 Test Loss: 1.661 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9854557514190674
Epoch: 18, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.781 Vali Acc: 0.281 Test Loss: 1.781 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 85700
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8141682147979736
Epoch: 1, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.416 Vali Acc: 0.228 Test Loss: 1.416 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 1.0663304328918457
Epoch: 2, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.447 Vali Acc: 0.232 Test Loss: 1.447 Test Acc: 0.232
Validation loss decreased (-0.228123 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 1.1708159446716309
Epoch: 3, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.436 Vali Acc: 0.259 Test Loss: 1.436 Test Acc: 0.259
Validation loss decreased (-0.231925 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 1.2292063236236572
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.453 Vali Acc: 0.266 Test Loss: 1.453 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 1.1068427562713623
Epoch: 5, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.485 Vali Acc: 0.236 Test Loss: 1.485 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2064287662506104
Epoch: 6, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.469 Vali Acc: 0.278 Test Loss: 1.469 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277552).  Saving model ...
Epoch: 7 cost time: 1.0420176982879639
Epoch: 7, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.513 Vali Acc: 0.251 Test Loss: 1.513 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2021055221557617
Epoch: 8, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.473 Vali Acc: 0.251 Test Loss: 1.473 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1369092464447021
Epoch: 9, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.534 Vali Acc: 0.251 Test Loss: 1.534 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9674885272979736
Epoch: 10, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.513 Vali Acc: 0.274 Test Loss: 1.513 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2727022171020508
Epoch: 11, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.552 Vali Acc: 0.266 Test Loss: 1.552 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1300573348999023
Epoch: 12, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.613 Vali Acc: 0.278 Test Loss: 1.613 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1158628463745117
Epoch: 13, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.635 Vali Acc: 0.247 Test Loss: 1.635 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0455734729766846
Epoch: 14, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.962 Vali Acc: 0.285 Test Loss: 1.962 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285151).  Saving model ...
Epoch: 15 cost time: 1.1836414337158203
Epoch: 15, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.583 Vali Acc: 0.262 Test Loss: 1.583 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.158121109008789
Epoch: 16, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.638 Vali Acc: 0.262 Test Loss: 1.638 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.317633867263794
Epoch: 17, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.746 Vali Acc: 0.266 Test Loss: 1.746 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1135268211364746
Epoch: 18, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.748 Vali Acc: 0.262 Test Loss: 1.748 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0405211448669434
Epoch: 19, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.800 Vali Acc: 0.255 Test Loss: 1.800 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1674342155456543
Epoch: 20, Steps: 17 | Train Loss: 0.931 Vali Loss: 1.784 Vali Acc: 0.270 Test Loss: 1.784 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1478958129882812
Epoch: 21, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.900 Vali Acc: 0.266 Test Loss: 1.900 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2501370906829834
Epoch: 22, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.856 Vali Acc: 0.243 Test Loss: 1.856 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0433988571166992
Epoch: 23, Steps: 17 | Train Loss: 0.851 Vali Loss: 2.099 Vali Acc: 0.262 Test Loss: 2.099 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0896592140197754
Epoch: 24, Steps: 17 | Train Loss: 0.926 Vali Loss: 2.076 Vali Acc: 0.262 Test Loss: 2.076 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 78532
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.6565768718719482
Epoch: 1, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.448 Vali Acc: 0.228 Test Loss: 1.448 Test Acc: 0.228
Validation loss decreased (inf --> -0.228122).  Saving model ...
Epoch: 2 cost time: 1.1390304565429688
Epoch: 2, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.424 Vali Acc: 0.243 Test Loss: 1.424 Test Acc: 0.243
Validation loss decreased (-0.228122 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 1.2005565166473389
Epoch: 3, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.425 Vali Acc: 0.224 Test Loss: 1.425 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1170341968536377
Epoch: 4, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.489 Vali Acc: 0.255 Test Loss: 1.489 Test Acc: 0.255
Validation loss decreased (-0.243332 --> -0.254738).  Saving model ...
Epoch: 5 cost time: 1.1563637256622314
Epoch: 5, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.453 Vali Acc: 0.289 Test Loss: 1.453 Test Acc: 0.289
Validation loss decreased (-0.254738 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 1.0804896354675293
Epoch: 6, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.461 Vali Acc: 0.243 Test Loss: 1.461 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.189763069152832
Epoch: 7, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.547 Vali Acc: 0.278 Test Loss: 1.547 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0783119201660156
Epoch: 8, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.548 Vali Acc: 0.232 Test Loss: 1.548 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.082632064819336
Epoch: 9, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.500 Vali Acc: 0.251 Test Loss: 1.500 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.042285680770874
Epoch: 10, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.614 Vali Acc: 0.259 Test Loss: 1.614 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0180201530456543
Epoch: 11, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.531 Vali Acc: 0.259 Test Loss: 1.531 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1208150386810303
Epoch: 12, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.708 Vali Acc: 0.232 Test Loss: 1.708 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0566465854644775
Epoch: 13, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.658 Vali Acc: 0.266 Test Loss: 1.658 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0306026935577393
Epoch: 14, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.588 Vali Acc: 0.251 Test Loss: 1.588 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1124122142791748
Epoch: 15, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.595 Vali Acc: 0.262 Test Loss: 1.595 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 75972
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.986835479736328
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.436 Vali Acc: 0.247 Test Loss: 1.436 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.105306625366211
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.411 Vali Acc: 0.221 Test Loss: 1.411 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1993038654327393
Epoch: 3, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.416 Vali Acc: 0.247 Test Loss: 1.416 Test Acc: 0.247
Validation loss decreased (-0.247134 --> -0.247134).  Saving model ...
Epoch: 4 cost time: 1.052856683731079
Epoch: 4, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.419 Vali Acc: 0.247 Test Loss: 1.419 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.133000135421753
Epoch: 5, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.428 Vali Acc: 0.259 Test Loss: 1.428 Test Acc: 0.259
Validation loss decreased (-0.247134 --> -0.258541).  Saving model ...
Epoch: 6 cost time: 0.9496822357177734
Epoch: 6, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.495 Vali Acc: 0.236 Test Loss: 1.495 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.040492057800293
Epoch: 7, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.486 Vali Acc: 0.262 Test Loss: 1.486 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 8 cost time: 1.023319959640503
Epoch: 8, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.535 Vali Acc: 0.259 Test Loss: 1.535 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0692360401153564
Epoch: 9, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.482 Vali Acc: 0.255 Test Loss: 1.482 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.208050012588501
Epoch: 10, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.534 Vali Acc: 0.266 Test Loss: 1.534 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266144).  Saving model ...
Epoch: 11 cost time: 1.142780065536499
Epoch: 11, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.526 Vali Acc: 0.232 Test Loss: 1.526 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.319291114807129
Epoch: 12, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.524 Vali Acc: 0.304 Test Loss: 1.524 Test Acc: 0.304
Validation loss decreased (-0.266144 --> -0.304167).  Saving model ...
Epoch: 13 cost time: 1.30194091796875
Epoch: 13, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.509 Vali Acc: 0.213 Test Loss: 1.509 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1861157417297363
Epoch: 14, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.602 Vali Acc: 0.240 Test Loss: 1.602 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2278645038604736
Epoch: 15, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.612 Vali Acc: 0.266 Test Loss: 1.612 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.101073980331421
Epoch: 16, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.572 Vali Acc: 0.274 Test Loss: 1.572 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9482133388519287
Epoch: 17, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.603 Vali Acc: 0.270 Test Loss: 1.603 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1552343368530273
Epoch: 18, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.601 Vali Acc: 0.289 Test Loss: 1.601 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.012598991394043
Epoch: 19, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.681 Vali Acc: 0.274 Test Loss: 1.681 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9881374835968018
Epoch: 20, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.706 Vali Acc: 0.266 Test Loss: 1.706 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0621075630187988
Epoch: 21, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.775 Vali Acc: 0.266 Test Loss: 1.775 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9932141304016113
Epoch: 22, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.756 Vali Acc: 0.259 Test Loss: 1.756 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 76932
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.864454507827759
Epoch: 1, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.436 Vali Acc: 0.240 Test Loss: 1.436 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 0.9739551544189453
Epoch: 2, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.407 Vali Acc: 0.255 Test Loss: 1.407 Test Acc: 0.255
Validation loss decreased (-0.239529 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.0941541194915771
Epoch: 3, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.412 Vali Acc: 0.232 Test Loss: 1.412 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9709548950195312
Epoch: 4, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.451 Vali Acc: 0.236 Test Loss: 1.451 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0363399982452393
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.485 Vali Acc: 0.259 Test Loss: 1.485 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258540).  Saving model ...
Epoch: 6 cost time: 1.0241317749023438
Epoch: 6, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.478 Vali Acc: 0.247 Test Loss: 1.478 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1035645008087158
Epoch: 7, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.496 Vali Acc: 0.217 Test Loss: 1.496 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0214107036590576
Epoch: 8, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.449 Vali Acc: 0.228 Test Loss: 1.449 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0257093906402588
Epoch: 9, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.460 Vali Acc: 0.213 Test Loss: 1.460 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9452321529388428
Epoch: 10, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.529 Vali Acc: 0.243 Test Loss: 1.529 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.02132248878479
Epoch: 11, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.498 Vali Acc: 0.232 Test Loss: 1.498 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9446165561676025
Epoch: 12, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.683 Vali Acc: 0.213 Test Loss: 1.683 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1117870807647705
Epoch: 13, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.555 Vali Acc: 0.213 Test Loss: 1.555 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9807939529418945
Epoch: 14, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.657 Vali Acc: 0.274 Test Loss: 1.657 Test Acc: 0.274
Validation loss decreased (-0.258540 --> -0.273748).  Saving model ...
Epoch: 15 cost time: 1.0792884826660156
Epoch: 15, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.585 Vali Acc: 0.217 Test Loss: 1.585 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.144371509552002
Epoch: 16, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.584 Vali Acc: 0.232 Test Loss: 1.584 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.027710199356079
Epoch: 17, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.687 Vali Acc: 0.236 Test Loss: 1.687 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9787578582763672
Epoch: 18, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.698 Vali Acc: 0.232 Test Loss: 1.698 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1193592548370361
Epoch: 19, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.640 Vali Acc: 0.209 Test Loss: 1.640 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0598325729370117
Epoch: 20, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.690 Vali Acc: 0.205 Test Loss: 1.690 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9778287410736084
Epoch: 21, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.772 Vali Acc: 0.209 Test Loss: 1.772 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1219220161437988
Epoch: 22, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.868 Vali Acc: 0.255 Test Loss: 1.868 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1396234035491943
Epoch: 23, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.736 Vali Acc: 0.243 Test Loss: 1.736 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0306520462036133
Epoch: 24, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.899 Vali Acc: 0.251 Test Loss: 1.899 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 79492
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0342259407043457
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.410 Vali Acc: 0.251 Test Loss: 1.410 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.1122844219207764
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.408 Vali Acc: 0.255 Test Loss: 1.408 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.0145330429077148
Epoch: 3, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.407 Vali Acc: 0.259 Test Loss: 1.407 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 1.07859468460083
Epoch: 4, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.446 Vali Acc: 0.255 Test Loss: 1.446 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.233537197113037
Epoch: 5, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.416 Vali Acc: 0.266 Test Loss: 1.416 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 6 cost time: 1.0095202922821045
Epoch: 6, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.425 Vali Acc: 0.251 Test Loss: 1.425 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9658677577972412
Epoch: 7, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.479 Vali Acc: 0.270 Test Loss: 1.479 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269947).  Saving model ...
Epoch: 8 cost time: 0.9281325340270996
Epoch: 8, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.444 Vali Acc: 0.285 Test Loss: 1.444 Test Acc: 0.285
Validation loss decreased (-0.269947 --> -0.285157).  Saving model ...
Epoch: 9 cost time: 1.0321364402770996
Epoch: 9, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.448 Vali Acc: 0.274 Test Loss: 1.448 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0177686214447021
Epoch: 10, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.501 Vali Acc: 0.293 Test Loss: 1.501 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292761).  Saving model ...
Epoch: 11 cost time: 1.0557770729064941
Epoch: 11, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.481 Vali Acc: 0.247 Test Loss: 1.481 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1139202117919922
Epoch: 12, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.537 Vali Acc: 0.278 Test Loss: 1.537 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1234521865844727
Epoch: 13, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.498 Vali Acc: 0.240 Test Loss: 1.498 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1886241436004639
Epoch: 14, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.576 Vali Acc: 0.270 Test Loss: 1.576 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2274768352508545
Epoch: 15, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.533 Vali Acc: 0.251 Test Loss: 1.533 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.116020917892456
Epoch: 16, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.640 Vali Acc: 0.262 Test Loss: 1.640 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.043407678604126
Epoch: 17, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.583 Vali Acc: 0.266 Test Loss: 1.583 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1488792896270752
Epoch: 18, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.652 Vali Acc: 0.259 Test Loss: 1.652 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2415227890014648
Epoch: 19, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.745 Vali Acc: 0.251 Test Loss: 1.745 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1723299026489258
Epoch: 20, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.734 Vali Acc: 0.289 Test Loss: 1.734 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df256_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 83524
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2812623977661133
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.534 Vali Acc: 0.251 Test Loss: 1.534 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 1.6230826377868652
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.597 Vali Acc: 0.259 Test Loss: 1.597 Test Acc: 0.259
Validation loss decreased (-0.250935 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 1.4693396091461182
Epoch: 3, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.605 Vali Acc: 0.255 Test Loss: 1.605 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.407038927078247
Epoch: 4, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.535 Vali Acc: 0.278 Test Loss: 1.535 Test Acc: 0.278
Validation loss decreased (-0.258539 --> -0.277551).  Saving model ...
Epoch: 5 cost time: 1.4050657749176025
Epoch: 5, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.662 Vali Acc: 0.270 Test Loss: 1.662 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4123308658599854
Epoch: 6, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.553 Vali Acc: 0.251 Test Loss: 1.553 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3501145839691162
Epoch: 7, Steps: 17 | Train Loss: 1.323 Vali Loss: 2.000 Vali Acc: 0.255 Test Loss: 2.000 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4374933242797852
Epoch: 8, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.548 Vali Acc: 0.259 Test Loss: 1.548 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6079001426696777
Epoch: 9, Steps: 17 | Train Loss: 1.221 Vali Loss: 2.069 Vali Acc: 0.262 Test Loss: 2.069 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.115523099899292
Epoch: 10, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.549 Vali Acc: 0.255 Test Loss: 1.549 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.769545555114746
Epoch: 11, Steps: 17 | Train Loss: 1.366 Vali Loss: 2.525 Vali Acc: 0.251 Test Loss: 2.525 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.042093276977539
Epoch: 12, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.842 Vali Acc: 0.236 Test Loss: 1.842 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8627738952636719
Epoch: 13, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.846 Vali Acc: 0.285 Test Loss: 1.846 Test Acc: 0.285
Validation loss decreased (-0.277551 --> -0.285153).  Saving model ...
Epoch: 14 cost time: 1.8775830268859863
Epoch: 14, Steps: 17 | Train Loss: 1.039 Vali Loss: 2.016 Vali Acc: 0.247 Test Loss: 2.016 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.07192063331604
Epoch: 15, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.933 Vali Acc: 0.243 Test Loss: 1.933 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0415782928466797
Epoch: 16, Steps: 17 | Train Loss: 1.087 Vali Loss: 2.120 Vali Acc: 0.217 Test Loss: 2.120 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8904149532318115
Epoch: 17, Steps: 17 | Train Loss: 1.295 Vali Loss: 2.902 Vali Acc: 0.243 Test Loss: 2.902 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.565326452255249
Epoch: 18, Steps: 17 | Train Loss: 1.140 Vali Loss: 2.514 Vali Acc: 0.232 Test Loss: 2.514 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0546045303344727
Epoch: 19, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.957 Vali Acc: 0.240 Test Loss: 1.957 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.051609516143799
Epoch: 20, Steps: 17 | Train Loss: 1.003 Vali Loss: 2.045 Vali Acc: 0.228 Test Loss: 2.045 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7687888145446777
Epoch: 21, Steps: 17 | Train Loss: 0.930 Vali Loss: 2.101 Vali Acc: 0.262 Test Loss: 2.101 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7053725719451904
Epoch: 22, Steps: 17 | Train Loss: 0.974 Vali Loss: 2.265 Vali Acc: 0.213 Test Loss: 2.265 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8321244716644287
Epoch: 23, Steps: 17 | Train Loss: 0.892 Vali Loss: 2.817 Vali Acc: 0.251 Test Loss: 2.817 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 97092
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.218313217163086
Epoch: 1, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.403 Vali Acc: 0.232 Test Loss: 1.403 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.1832530498504639
Epoch: 2, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.430 Vali Acc: 0.251 Test Loss: 1.430 Test Acc: 0.251
Validation loss decreased (-0.231925 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 1.2947311401367188
Epoch: 3, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.577 Vali Acc: 0.247 Test Loss: 1.577 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0956289768218994
Epoch: 4, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.543 Vali Acc: 0.236 Test Loss: 1.543 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1886320114135742
Epoch: 5, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.488 Vali Acc: 0.262 Test Loss: 1.488 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 6 cost time: 1.2068688869476318
Epoch: 6, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.693 Vali Acc: 0.262 Test Loss: 1.693 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1056578159332275
Epoch: 7, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.747 Vali Acc: 0.240 Test Loss: 1.747 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1492817401885986
Epoch: 8, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.529 Vali Acc: 0.251 Test Loss: 1.529 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1430702209472656
Epoch: 9, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.623 Vali Acc: 0.247 Test Loss: 1.623 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2789256572723389
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.566 Vali Acc: 0.262 Test Loss: 1.566 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8942759037017822
Epoch: 11, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.790 Vali Acc: 0.266 Test Loss: 1.790 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266142).  Saving model ...
Epoch: 12 cost time: 1.3034007549285889
Epoch: 12, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.593 Vali Acc: 0.262 Test Loss: 1.593 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3495738506317139
Epoch: 13, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.945 Vali Acc: 0.243 Test Loss: 1.945 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2735576629638672
Epoch: 14, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.891 Vali Acc: 0.270 Test Loss: 1.891 Test Acc: 0.270
Validation loss decreased (-0.266142 --> -0.269943).  Saving model ...
Epoch: 15 cost time: 1.2925214767456055
Epoch: 15, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.719 Vali Acc: 0.266 Test Loss: 1.719 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.156688928604126
Epoch: 16, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.628 Vali Acc: 0.243 Test Loss: 1.628 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3957903385162354
Epoch: 17, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.719 Vali Acc: 0.259 Test Loss: 1.719 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3478403091430664
Epoch: 18, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.720 Vali Acc: 0.247 Test Loss: 1.720 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1039402484893799
Epoch: 19, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.996 Vali Acc: 0.259 Test Loss: 1.996 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2162790298461914
Epoch: 20, Steps: 17 | Train Loss: 1.063 Vali Loss: 2.126 Vali Acc: 0.262 Test Loss: 2.126 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4555144309997559
Epoch: 21, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.836 Vali Acc: 0.247 Test Loss: 1.836 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3130805492401123
Epoch: 22, Steps: 17 | Train Loss: 0.908 Vali Loss: 1.926 Vali Acc: 0.251 Test Loss: 1.926 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2325060367584229
Epoch: 23, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.994 Vali Acc: 0.251 Test Loss: 1.994 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2208740711212158
Epoch: 24, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.947 Vali Acc: 0.213 Test Loss: 1.947 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 69188
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1530470848083496
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.415 Vali Acc: 0.236 Test Loss: 1.415 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.2372303009033203
Epoch: 2, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.439 Vali Acc: 0.259 Test Loss: 1.439 Test Acc: 0.259
Validation loss decreased (-0.235727 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.2094039916992188
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
Validation loss decreased (-0.258541 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 1.2886741161346436
Epoch: 4, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.445 Vali Acc: 0.259 Test Loss: 1.445 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2772574424743652
Epoch: 5, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.454 Vali Acc: 0.278 Test Loss: 1.454 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277552).  Saving model ...
Epoch: 6 cost time: 1.3084900379180908
Epoch: 6, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.477 Vali Acc: 0.262 Test Loss: 1.477 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2509446144104004
Epoch: 7, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.601 Vali Acc: 0.255 Test Loss: 1.601 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2173352241516113
Epoch: 8, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.532 Vali Acc: 0.285 Test Loss: 1.532 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285156).  Saving model ...
Epoch: 9 cost time: 1.2401552200317383
Epoch: 9, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.763 Vali Acc: 0.259 Test Loss: 1.763 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3047215938568115
Epoch: 10, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.598 Vali Acc: 0.255 Test Loss: 1.598 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4072465896606445
Epoch: 11, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.634 Vali Acc: 0.259 Test Loss: 1.634 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2984364032745361
Epoch: 12, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.630 Vali Acc: 0.266 Test Loss: 1.630 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2645955085754395
Epoch: 13, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.704 Vali Acc: 0.251 Test Loss: 1.704 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0983140468597412
Epoch: 14, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.663 Vali Acc: 0.255 Test Loss: 1.663 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2899219989776611
Epoch: 15, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.678 Vali Acc: 0.262 Test Loss: 1.678 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4447920322418213
Epoch: 16, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.682 Vali Acc: 0.278 Test Loss: 1.682 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2164733409881592
Epoch: 17, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.695 Vali Acc: 0.285 Test Loss: 1.695 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2903642654418945
Epoch: 18, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.783 Vali Acc: 0.285 Test Loss: 1.783 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 62020
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0058789253234863
Epoch: 1, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.395 Vali Acc: 0.247 Test Loss: 1.395 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.1533973217010498
Epoch: 2, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.405 Vali Acc: 0.240 Test Loss: 1.405 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1906626224517822
Epoch: 3, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.427 Vali Acc: 0.281 Test Loss: 1.427 Test Acc: 0.281
Validation loss decreased (-0.247134 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 1.2247984409332275
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.482 Vali Acc: 0.262 Test Loss: 1.482 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2308025360107422
Epoch: 5, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.460 Vali Acc: 0.240 Test Loss: 1.460 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.193631649017334
Epoch: 6, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.460 Vali Acc: 0.232 Test Loss: 1.460 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1489393711090088
Epoch: 7, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.448 Vali Acc: 0.259 Test Loss: 1.448 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0368902683258057
Epoch: 8, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.158233404159546
Epoch: 9, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.469 Vali Acc: 0.255 Test Loss: 1.469 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1814091205596924
Epoch: 10, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.523 Vali Acc: 0.259 Test Loss: 1.523 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2605948448181152
Epoch: 11, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.590 Vali Acc: 0.259 Test Loss: 1.590 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1364564895629883
Epoch: 12, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.534 Vali Acc: 0.228 Test Loss: 1.534 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.329871416091919
Epoch: 13, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.631 Vali Acc: 0.236 Test Loss: 1.631 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 59460
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.792182683944702
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.403 Vali Acc: 0.262 Test Loss: 1.403 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.095808744430542
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.419 Vali Acc: 0.262 Test Loss: 1.419 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2530312538146973
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.394 Vali Acc: 0.281 Test Loss: 1.394 Test Acc: 0.281
Validation loss decreased (-0.262343 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 1.206894874572754
Epoch: 4, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.393 Vali Acc: 0.281 Test Loss: 1.393 Test Acc: 0.281
Validation loss decreased (-0.281355 --> -0.281355).  Saving model ...
Epoch: 5 cost time: 1.194892406463623
Epoch: 5, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.419 Vali Acc: 0.293 Test Loss: 1.419 Test Acc: 0.293
Validation loss decreased (-0.281355 --> -0.292761).  Saving model ...
Epoch: 6 cost time: 1.2987277507781982
Epoch: 6, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.493 Vali Acc: 0.240 Test Loss: 1.493 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.224501609802246
Epoch: 7, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.467 Vali Acc: 0.259 Test Loss: 1.467 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1871609687805176
Epoch: 8, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3140990734100342
Epoch: 9, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.652 Vali Acc: 0.232 Test Loss: 1.652 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2265682220458984
Epoch: 10, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.448 Vali Acc: 0.262 Test Loss: 1.448 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.275050401687622
Epoch: 11, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.528 Vali Acc: 0.240 Test Loss: 1.528 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.346996784210205
Epoch: 12, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.537 Vali Acc: 0.266 Test Loss: 1.537 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1104485988616943
Epoch: 13, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.670 Vali Acc: 0.243 Test Loss: 1.670 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2342987060546875
Epoch: 14, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.513 Vali Acc: 0.262 Test Loss: 1.513 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1954426765441895
Epoch: 15, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.537 Vali Acc: 0.266 Test Loss: 1.537 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 60420
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.870119094848633
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.412 Vali Acc: 0.262 Test Loss: 1.412 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.3077266216278076
Epoch: 2, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.416 Vali Acc: 0.251 Test Loss: 1.416 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1436078548431396
Epoch: 3, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.413 Vali Acc: 0.255 Test Loss: 1.413 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2557766437530518
Epoch: 4, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.410 Vali Acc: 0.259 Test Loss: 1.410 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2411437034606934
Epoch: 5, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.438 Vali Acc: 0.266 Test Loss: 1.438 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 6 cost time: 1.2486069202423096
Epoch: 6, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.430 Vali Acc: 0.243 Test Loss: 1.430 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.153930902481079
Epoch: 7, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.471 Vali Acc: 0.247 Test Loss: 1.471 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.087198257446289
Epoch: 8, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.564 Vali Acc: 0.262 Test Loss: 1.564 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1591739654541016
Epoch: 9, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.585 Vali Acc: 0.247 Test Loss: 1.585 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.278876781463623
Epoch: 10, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.485 Vali Acc: 0.221 Test Loss: 1.485 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9813711643218994
Epoch: 11, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.523 Vali Acc: 0.259 Test Loss: 1.523 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2597947120666504
Epoch: 12, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.538 Vali Acc: 0.270 Test Loss: 1.538 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269947).  Saving model ...
Epoch: 13 cost time: 1.334167718887329
Epoch: 13, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.548 Vali Acc: 0.251 Test Loss: 1.548 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.177682876586914
Epoch: 14, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.540 Vali Acc: 0.224 Test Loss: 1.540 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1469500064849854
Epoch: 15, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.609 Vali Acc: 0.251 Test Loss: 1.609 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3061277866363525
Epoch: 16, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.556 Vali Acc: 0.224 Test Loss: 1.556 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.169487714767456
Epoch: 17, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.788 Vali Acc: 0.228 Test Loss: 1.788 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1329052448272705
Epoch: 18, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.637 Vali Acc: 0.243 Test Loss: 1.637 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.241074562072754
Epoch: 19, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.790 Vali Acc: 0.247 Test Loss: 1.790 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2368674278259277
Epoch: 20, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.952 Vali Acc: 0.232 Test Loss: 1.952 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2300035953521729
Epoch: 21, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.640 Vali Acc: 0.255 Test Loss: 1.640 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3118982315063477
Epoch: 22, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.985 Vali Acc: 0.247 Test Loss: 1.985 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 62980
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0545501708984375
Epoch: 1, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.398 Vali Acc: 0.232 Test Loss: 1.398 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.011152744293213
Epoch: 2, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.397 Vali Acc: 0.221 Test Loss: 1.397 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3035671710968018
Epoch: 3, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.429 Vali Acc: 0.247 Test Loss: 1.429 Test Acc: 0.247
Validation loss decreased (-0.231925 --> -0.247134).  Saving model ...
Epoch: 4 cost time: 1.0694594383239746
Epoch: 4, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.410 Vali Acc: 0.251 Test Loss: 1.410 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250936).  Saving model ...
Epoch: 5 cost time: 1.0218982696533203
Epoch: 5, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.407 Vali Acc: 0.262 Test Loss: 1.407 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 6 cost time: 1.224315881729126
Epoch: 6, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.430 Vali Acc: 0.285 Test Loss: 1.430 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285157).  Saving model ...
Epoch: 7 cost time: 1.264925479888916
Epoch: 7, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.499 Vali Acc: 0.251 Test Loss: 1.499 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2003576755523682
Epoch: 8, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.455 Vali Acc: 0.297 Test Loss: 1.455 Test Acc: 0.297
Validation loss decreased (-0.285157 --> -0.296563).  Saving model ...
Epoch: 9 cost time: 1.153202772140503
Epoch: 9, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.439 Vali Acc: 0.259 Test Loss: 1.439 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2172496318817139
Epoch: 10, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.542 Vali Acc: 0.270 Test Loss: 1.542 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9812824726104736
Epoch: 11, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.470 Vali Acc: 0.289 Test Loss: 1.470 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.144932746887207
Epoch: 12, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.503 Vali Acc: 0.262 Test Loss: 1.503 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1651978492736816
Epoch: 13, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.550 Vali Acc: 0.243 Test Loss: 1.550 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1738510131835938
Epoch: 14, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.509 Vali Acc: 0.232 Test Loss: 1.509 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2111730575561523
Epoch: 15, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.603 Vali Acc: 0.281 Test Loss: 1.603 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1659002304077148
Epoch: 16, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.684 Vali Acc: 0.278 Test Loss: 1.684 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1463873386383057
Epoch: 17, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.689 Vali Acc: 0.281 Test Loss: 1.689 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.131664752960205
Epoch: 18, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.700 Vali Acc: 0.255 Test Loss: 1.700 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df128_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 67012
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.658217668533325
Epoch: 1, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.450 Vali Acc: 0.236 Test Loss: 1.450 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.8102374076843262
Epoch: 2, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.456 Vali Acc: 0.259 Test Loss: 1.456 Test Acc: 0.259
Validation loss decreased (-0.235727 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.7358732223510742
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.494 Vali Acc: 0.255 Test Loss: 1.494 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.833794116973877
Epoch: 4, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.640 Vali Acc: 0.247 Test Loss: 1.640 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5633611679077148
Epoch: 5, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.817 Vali Acc: 0.247 Test Loss: 1.817 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7864234447479248
Epoch: 6, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.639 Vali Acc: 0.243 Test Loss: 1.639 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.657371997833252
Epoch: 7, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.583 Vali Acc: 0.247 Test Loss: 1.583 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7606849670410156
Epoch: 8, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.523 Vali Acc: 0.240 Test Loss: 1.523 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6210393905639648
Epoch: 9, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.769 Vali Acc: 0.259 Test Loss: 1.769 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7058908939361572
Epoch: 10, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.850 Vali Acc: 0.221 Test Loss: 1.850 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5068719387054443
Epoch: 11, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.691 Vali Acc: 0.205 Test Loss: 1.691 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2156667709350586
Epoch: 12, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.723 Vali Acc: 0.228 Test Loss: 1.723 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 88836
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.163120985031128
Epoch: 1, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.427 Vali Acc: 0.255 Test Loss: 1.427 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.0558812618255615
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.393 Vali Acc: 0.255 Test Loss: 1.393 Test Acc: 0.255
Validation loss decreased (-0.254739 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.0521602630615234
Epoch: 3, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.408 Vali Acc: 0.255 Test Loss: 1.408 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1356322765350342
Epoch: 4, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.415 Vali Acc: 0.274 Test Loss: 1.415 Test Acc: 0.274
Validation loss decreased (-0.254739 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 1.1076703071594238
Epoch: 5, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.510 Vali Acc: 0.247 Test Loss: 1.510 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0378246307373047
Epoch: 6, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.630 Vali Acc: 0.240 Test Loss: 1.630 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0599918365478516
Epoch: 7, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.918 Vali Acc: 0.251 Test Loss: 1.918 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0359587669372559
Epoch: 8, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.719 Vali Acc: 0.259 Test Loss: 1.719 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0929803848266602
Epoch: 9, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.532 Vali Acc: 0.243 Test Loss: 1.532 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9402666091918945
Epoch: 10, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.677 Vali Acc: 0.247 Test Loss: 1.677 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2155392169952393
Epoch: 11, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.544 Vali Acc: 0.274 Test Loss: 1.544 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2649199962615967
Epoch: 12, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.683 Vali Acc: 0.278 Test Loss: 1.683 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277550).  Saving model ...
Epoch: 13 cost time: 1.09818696975708
Epoch: 13, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.596 Vali Acc: 0.247 Test Loss: 1.596 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.152163028717041
Epoch: 14, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.728 Vali Acc: 0.236 Test Loss: 1.728 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.114046335220337
Epoch: 15, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.691 Vali Acc: 0.262 Test Loss: 1.691 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1718144416809082
Epoch: 16, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.768 Vali Acc: 0.224 Test Loss: 1.768 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0758461952209473
Epoch: 17, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.888 Vali Acc: 0.262 Test Loss: 1.888 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1024699211120605
Epoch: 18, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.702 Vali Acc: 0.259 Test Loss: 1.702 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9958162307739258
Epoch: 19, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.778 Vali Acc: 0.224 Test Loss: 1.778 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.043311357498169
Epoch: 20, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.733 Vali Acc: 0.274 Test Loss: 1.733 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0291473865509033
Epoch: 21, Steps: 17 | Train Loss: 0.992 Vali Loss: 1.774 Vali Acc: 0.236 Test Loss: 1.774 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1899254322052002
Epoch: 22, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.864 Vali Acc: 0.259 Test Loss: 1.864 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 60932
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9168601036071777
Epoch: 1, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.426 Vali Acc: 0.262 Test Loss: 1.426 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.0057709217071533
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.461 Vali Acc: 0.285 Test Loss: 1.461 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285156).  Saving model ...
Epoch: 3 cost time: 1.2407987117767334
Epoch: 3, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.438 Vali Acc: 0.274 Test Loss: 1.438 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0608773231506348
Epoch: 4, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.487 Vali Acc: 0.228 Test Loss: 1.487 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0260462760925293
Epoch: 5, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.447 Vali Acc: 0.228 Test Loss: 1.447 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0776863098144531
Epoch: 6, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.502 Vali Acc: 0.278 Test Loss: 1.502 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0273399353027344
Epoch: 7, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.468 Vali Acc: 0.243 Test Loss: 1.468 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.142211675643921
Epoch: 8, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.773 Vali Acc: 0.278 Test Loss: 1.773 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.02736496925354
Epoch: 9, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.569 Vali Acc: 0.255 Test Loss: 1.569 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0179383754730225
Epoch: 10, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.597 Vali Acc: 0.274 Test Loss: 1.597 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0313775539398193
Epoch: 11, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.591 Vali Acc: 0.278 Test Loss: 1.591 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0382907390594482
Epoch: 12, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.616 Vali Acc: 0.259 Test Loss: 1.616 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 53764
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8544538021087646
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.421 Vali Acc: 0.251 Test Loss: 1.421 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.0426578521728516
Epoch: 2, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.428 Vali Acc: 0.221 Test Loss: 1.428 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1034111976623535
Epoch: 3, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.405 Vali Acc: 0.259 Test Loss: 1.405 Test Acc: 0.259
Validation loss decreased (-0.250936 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 1.0431461334228516
Epoch: 4, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.411 Vali Acc: 0.262 Test Loss: 1.411 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 1.0111689567565918
Epoch: 5, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.449 Vali Acc: 0.243 Test Loss: 1.449 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.080751657485962
Epoch: 6, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.511 Vali Acc: 0.240 Test Loss: 1.511 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.008678913116455
Epoch: 7, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.471 Vali Acc: 0.251 Test Loss: 1.471 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0701816082000732
Epoch: 8, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.540 Vali Acc: 0.266 Test Loss: 1.540 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266144).  Saving model ...
Epoch: 9 cost time: 1.244328498840332
Epoch: 9, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.475 Vali Acc: 0.240 Test Loss: 1.475 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1955342292785645
Epoch: 10, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.528 Vali Acc: 0.240 Test Loss: 1.528 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.223684549331665
Epoch: 11, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.534 Vali Acc: 0.224 Test Loss: 1.534 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0846977233886719
Epoch: 12, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.549 Vali Acc: 0.247 Test Loss: 1.549 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.173166036605835
Epoch: 13, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.516 Vali Acc: 0.255 Test Loss: 1.516 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2931060791015625
Epoch: 14, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.679 Vali Acc: 0.247 Test Loss: 1.679 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1019864082336426
Epoch: 15, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.819 Vali Acc: 0.243 Test Loss: 1.819 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0593695640563965
Epoch: 16, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.584 Vali Acc: 0.247 Test Loss: 1.584 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0566372871398926
Epoch: 17, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.633 Vali Acc: 0.243 Test Loss: 1.633 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0994007587432861
Epoch: 18, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.767 Vali Acc: 0.262 Test Loss: 1.767 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 51204
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8114192485809326
Epoch: 1, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.391 Vali Acc: 0.281 Test Loss: 1.391 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 0.9227585792541504
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.389 Vali Acc: 0.281 Test Loss: 1.389 Test Acc: 0.281
Validation loss decreased (-0.281355 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 0.8244137763977051
Epoch: 3, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.391 Vali Acc: 0.274 Test Loss: 1.391 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0460052490234375
Epoch: 4, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.406 Vali Acc: 0.289 Test Loss: 1.406 Test Acc: 0.289
Validation loss decreased (-0.281355 --> -0.288959).  Saving model ...
Epoch: 5 cost time: 0.815406322479248
Epoch: 5, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.420 Vali Acc: 0.285 Test Loss: 1.420 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9821932315826416
Epoch: 6, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.535 Vali Acc: 0.278 Test Loss: 1.535 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0104308128356934
Epoch: 7, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.438 Vali Acc: 0.243 Test Loss: 1.438 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1515614986419678
Epoch: 8, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.453 Vali Acc: 0.247 Test Loss: 1.453 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1555697917938232
Epoch: 9, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.482 Vali Acc: 0.255 Test Loss: 1.482 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9958963394165039
Epoch: 10, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.673 Vali Acc: 0.274 Test Loss: 1.673 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2516112327575684
Epoch: 11, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.491 Vali Acc: 0.240 Test Loss: 1.491 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9074666500091553
Epoch: 12, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.547 Vali Acc: 0.270 Test Loss: 1.547 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1018431186676025
Epoch: 13, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.566 Vali Acc: 0.262 Test Loss: 1.566 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0643150806427002
Epoch: 14, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.602 Vali Acc: 0.270 Test Loss: 1.602 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 52164
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.721374988555908
Epoch: 1, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.432 Vali Acc: 0.236 Test Loss: 1.432 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 0.8829441070556641
Epoch: 2, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.420 Vali Acc: 0.259 Test Loss: 1.420 Test Acc: 0.259
Validation loss decreased (-0.235727 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.1032917499542236
Epoch: 3, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.417 Vali Acc: 0.228 Test Loss: 1.417 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0337495803833008
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.444 Vali Acc: 0.202 Test Loss: 1.444 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0959227085113525
Epoch: 5, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.420 Vali Acc: 0.236 Test Loss: 1.420 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9204719066619873
Epoch: 6, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.444 Vali Acc: 0.259 Test Loss: 1.444 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1048874855041504
Epoch: 7, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.461 Vali Acc: 0.255 Test Loss: 1.461 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1929235458374023
Epoch: 8, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.630 Vali Acc: 0.247 Test Loss: 1.630 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0626423358917236
Epoch: 9, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.470 Vali Acc: 0.240 Test Loss: 1.470 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9511246681213379
Epoch: 10, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.593 Vali Acc: 0.236 Test Loss: 1.593 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9246182441711426
Epoch: 11, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.500 Vali Acc: 0.251 Test Loss: 1.500 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8971924781799316
Epoch: 12, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.589 Vali Acc: 0.243 Test Loss: 1.589 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 54724
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.585181951522827
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.426 Vali Acc: 0.232 Test Loss: 1.426 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 0.9375126361846924
Epoch: 2, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.427 Vali Acc: 0.236 Test Loss: 1.427 Test Acc: 0.236
Validation loss decreased (-0.231925 --> -0.235727).  Saving model ...
Epoch: 3 cost time: 1.0099735260009766
Epoch: 3, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.449 Vali Acc: 0.224 Test Loss: 1.449 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.083402156829834
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.438 Vali Acc: 0.232 Test Loss: 1.438 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9723954200744629
Epoch: 5, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.443 Vali Acc: 0.236 Test Loss: 1.443 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0318758487701416
Epoch: 6, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.480 Vali Acc: 0.221 Test Loss: 1.480 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2133452892303467
Epoch: 7, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.457 Vali Acc: 0.240 Test Loss: 1.457 Test Acc: 0.240
Validation loss decreased (-0.235727 --> -0.239529).  Saving model ...
Epoch: 8 cost time: 1.0882930755615234
Epoch: 8, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.485 Vali Acc: 0.240 Test Loss: 1.485 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1051549911499023
Epoch: 9, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.458 Vali Acc: 0.243 Test Loss: 1.458 Test Acc: 0.243
Validation loss decreased (-0.239529 --> -0.243331).  Saving model ...
Epoch: 10 cost time: 1.1773324012756348
Epoch: 10, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.494 Vali Acc: 0.240 Test Loss: 1.494 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9799389839172363
Epoch: 11, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.496 Vali Acc: 0.217 Test Loss: 1.496 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.986513614654541
Epoch: 12, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.543 Vali Acc: 0.224 Test Loss: 1.543 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0283880233764648
Epoch: 13, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.540 Vali Acc: 0.232 Test Loss: 1.540 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.053654670715332
Epoch: 14, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.635 Vali Acc: 0.217 Test Loss: 1.635 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9463443756103516
Epoch: 15, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.548 Vali Acc: 0.247 Test Loss: 1.548 Test Acc: 0.247
Validation loss decreased (-0.243331 --> -0.247133).  Saving model ...
Epoch: 16 cost time: 0.98122239112854
Epoch: 16, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.665 Vali Acc: 0.240 Test Loss: 1.665 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.210172176361084
Epoch: 17, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.763 Vali Acc: 0.270 Test Loss: 1.763 Test Acc: 0.270
Validation loss decreased (-0.247133 --> -0.269944).  Saving model ...
Epoch: 18 cost time: 1.0526254177093506
Epoch: 18, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.667 Vali Acc: 0.270 Test Loss: 1.667 Test Acc: 0.270
Validation loss decreased (-0.269944 --> -0.269945).  Saving model ...
Epoch: 19 cost time: 1.0246851444244385
Epoch: 19, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.627 Vali Acc: 0.236 Test Loss: 1.627 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0037074089050293
Epoch: 20, Steps: 17 | Train Loss: 1.062 Vali Loss: 2.071 Vali Acc: 0.251 Test Loss: 2.071 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.106032133102417
Epoch: 21, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.644 Vali Acc: 0.224 Test Loss: 1.644 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.055809497833252
Epoch: 22, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.659 Vali Acc: 0.240 Test Loss: 1.659 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0392847061157227
Epoch: 23, Steps: 17 | Train Loss: 1.007 Vali Loss: 1.820 Vali Acc: 0.262 Test Loss: 1.820 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9825325012207031
Epoch: 24, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.773 Vali Acc: 0.262 Test Loss: 1.773 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9634156227111816
Epoch: 25, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.758 Vali Acc: 0.262 Test Loss: 1.758 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0514249801635742
Epoch: 26, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.748 Vali Acc: 0.251 Test Loss: 1.748 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1002554893493652
Epoch: 27, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.816 Vali Acc: 0.278 Test Loss: 1.816 Test Acc: 0.278
Validation loss decreased (-0.269945 --> -0.277548).  Saving model ...
Epoch: 28 cost time: 0.9994525909423828
Epoch: 28, Steps: 17 | Train Loss: 0.931 Vali Loss: 1.823 Vali Acc: 0.262 Test Loss: 1.823 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1550910472869873
Epoch: 29, Steps: 17 | Train Loss: 0.934 Vali Loss: 2.181 Vali Acc: 0.247 Test Loss: 2.181 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2207424640655518
Epoch: 30, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.888 Vali Acc: 0.255 Test Loss: 1.888 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1338701248168945
Epoch: 31, Steps: 17 | Train Loss: 0.882 Vali Loss: 1.843 Vali Acc: 0.255 Test Loss: 1.843 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1229031085968018
Epoch: 32, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.991 Vali Acc: 0.274 Test Loss: 1.991 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2343688011169434
Epoch: 33, Steps: 17 | Train Loss: 0.782 Vali Loss: 2.031 Vali Acc: 0.285 Test Loss: 2.031 Test Acc: 0.285
Validation loss decreased (-0.277548 --> -0.285151).  Saving model ...
Epoch: 34 cost time: 1.0523877143859863
Epoch: 34, Steps: 17 | Train Loss: 0.803 Vali Loss: 2.044 Vali Acc: 0.236 Test Loss: 2.044 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1503195762634277
Epoch: 35, Steps: 17 | Train Loss: 0.845 Vali Loss: 1.932 Vali Acc: 0.247 Test Loss: 1.932 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1114659309387207
Epoch: 36, Steps: 17 | Train Loss: 0.738 Vali Loss: 2.081 Vali Acc: 0.247 Test Loss: 2.081 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.065631628036499
Epoch: 37, Steps: 17 | Train Loss: 0.718 Vali Loss: 2.038 Vali Acc: 0.262 Test Loss: 2.038 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0427024364471436
Epoch: 38, Steps: 17 | Train Loss: 0.727 Vali Loss: 2.510 Vali Acc: 0.247 Test Loss: 2.510 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4359023571014404
Epoch: 39, Steps: 17 | Train Loss: 0.745 Vali Loss: 2.105 Vali Acc: 0.221 Test Loss: 2.105 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.212022304534912
Epoch: 40, Steps: 17 | Train Loss: 0.659 Vali Loss: 2.524 Vali Acc: 0.285 Test Loss: 2.524 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.121788501739502
Epoch: 41, Steps: 17 | Train Loss: 0.672 Vali Loss: 2.172 Vali Acc: 0.240 Test Loss: 2.172 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1720728874206543
Epoch: 42, Steps: 17 | Train Loss: 0.641 Vali Loss: 2.461 Vali Acc: 0.236 Test Loss: 2.461 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.250014305114746
Epoch: 43, Steps: 17 | Train Loss: 0.752 Vali Loss: 2.595 Vali Acc: 0.259 Test Loss: 2.595 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm64_nh16_df64_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 58756
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.856391191482544
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.459 Vali Acc: 0.259 Test Loss: 1.459 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.1236350536346436
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.505 Vali Acc: 0.262 Test Loss: 1.505 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 1.1624066829681396
Epoch: 3, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.446 Vali Acc: 0.232 Test Loss: 1.446 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1720991134643555
Epoch: 4, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.550 Vali Acc: 0.251 Test Loss: 1.550 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2505958080291748
Epoch: 5, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.463 Vali Acc: 0.266 Test Loss: 1.463 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266145).  Saving model ...
Epoch: 6 cost time: 1.2119848728179932
Epoch: 6, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.456 Vali Acc: 0.217 Test Loss: 1.456 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1717419624328613
Epoch: 7, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.634 Vali Acc: 0.247 Test Loss: 1.634 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2816593647003174
Epoch: 8, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.674 Vali Acc: 0.232 Test Loss: 1.674 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2678415775299072
Epoch: 9, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.563 Vali Acc: 0.232 Test Loss: 1.563 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1961262226104736
Epoch: 10, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.583 Vali Acc: 0.259 Test Loss: 1.583 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1079726219177246
Epoch: 11, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.677 Vali Acc: 0.247 Test Loss: 1.677 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0245211124420166
Epoch: 12, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.584 Vali Acc: 0.232 Test Loss: 1.584 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0214207172393799
Epoch: 13, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.546 Vali Acc: 0.251 Test Loss: 1.546 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1505725383758545
Epoch: 14, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.558 Vali Acc: 0.251 Test Loss: 1.558 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1357483863830566
Epoch: 15, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.581 Vali Acc: 0.274 Test Loss: 1.581 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273748).  Saving model ...
Epoch: 16 cost time: 1.1396541595458984
Epoch: 16, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.750 Vali Acc: 0.259 Test Loss: 1.750 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2488658428192139
Epoch: 17, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.640 Vali Acc: 0.262 Test Loss: 1.640 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.139780044555664
Epoch: 18, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.624 Vali Acc: 0.240 Test Loss: 1.624 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1034486293792725
Epoch: 19, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.745 Vali Acc: 0.251 Test Loss: 1.745 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2007195949554443
Epoch: 20, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.805 Vali Acc: 0.255 Test Loss: 1.805 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.167158603668213
Epoch: 21, Steps: 17 | Train Loss: 0.831 Vali Loss: 1.860 Vali Acc: 0.247 Test Loss: 1.860 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1410801410675049
Epoch: 22, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.925 Vali Acc: 0.240 Test Loss: 1.925 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.156632423400879
Epoch: 23, Steps: 17 | Train Loss: 0.854 Vali Loss: 1.953 Vali Acc: 0.270 Test Loss: 1.953 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1981327533721924
Epoch: 24, Steps: 17 | Train Loss: 0.839 Vali Loss: 2.339 Vali Acc: 0.236 Test Loss: 2.339 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2215301990509033
Epoch: 25, Steps: 17 | Train Loss: 0.814 Vali Loss: 2.334 Vali Acc: 0.228 Test Loss: 2.334 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 52836
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.011129856109619
Epoch: 1, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.401 Vali Acc: 0.251 Test Loss: 1.401 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.0970559120178223
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.415 Vali Acc: 0.304 Test Loss: 1.415 Test Acc: 0.304
Validation loss decreased (-0.250937 --> -0.304168).  Saving model ...
Epoch: 3 cost time: 1.1529474258422852
Epoch: 3, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.401 Vali Acc: 0.259 Test Loss: 1.401 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1703498363494873
Epoch: 4, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.480 Vali Acc: 0.243 Test Loss: 1.480 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9595310688018799
Epoch: 5, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.513 Vali Acc: 0.255 Test Loss: 1.513 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9962863922119141
Epoch: 6, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.465 Vali Acc: 0.259 Test Loss: 1.465 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0342984199523926
Epoch: 7, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.435 Vali Acc: 0.221 Test Loss: 1.435 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.119178295135498
Epoch: 8, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.515 Vali Acc: 0.262 Test Loss: 1.515 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9483227729797363
Epoch: 9, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.538 Vali Acc: 0.262 Test Loss: 1.538 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8859615325927734
Epoch: 10, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.468 Vali Acc: 0.228 Test Loss: 1.468 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9030754566192627
Epoch: 11, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.586 Vali Acc: 0.228 Test Loss: 1.586 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9917418956756592
Epoch: 12, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.586 Vali Acc: 0.262 Test Loss: 1.586 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 38884
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.858368158340454
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.393 Vali Acc: 0.255 Test Loss: 1.393 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.9946105480194092
Epoch: 2, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.402 Vali Acc: 0.266 Test Loss: 1.402 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 1.0443027019500732
Epoch: 3, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.417 Vali Acc: 0.274 Test Loss: 1.417 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 1.119476318359375
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.397 Vali Acc: 0.270 Test Loss: 1.397 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1317811012268066
Epoch: 5, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.437 Vali Acc: 0.259 Test Loss: 1.437 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1334927082061768
Epoch: 6, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.439 Vali Acc: 0.278 Test Loss: 1.439 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 7 cost time: 1.0567207336425781
Epoch: 7, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.485 Vali Acc: 0.312 Test Loss: 1.485 Test Acc: 0.312
Validation loss decreased (-0.277552 --> -0.311772).  Saving model ...
Epoch: 8 cost time: 1.082493543624878
Epoch: 8, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.478 Vali Acc: 0.255 Test Loss: 1.478 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1586010456085205
Epoch: 9, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.483 Vali Acc: 0.266 Test Loss: 1.483 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9694523811340332
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.549 Vali Acc: 0.259 Test Loss: 1.549 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2726061344146729
Epoch: 11, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.485 Vali Acc: 0.240 Test Loss: 1.485 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1252200603485107
Epoch: 12, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.491 Vali Acc: 0.266 Test Loss: 1.491 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.283742904663086
Epoch: 13, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.524 Vali Acc: 0.259 Test Loss: 1.524 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2821736335754395
Epoch: 14, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.505 Vali Acc: 0.221 Test Loss: 1.505 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0222997665405273
Epoch: 15, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.519 Vali Acc: 0.262 Test Loss: 1.519 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2024269104003906
Epoch: 16, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.528 Vali Acc: 0.247 Test Loss: 1.528 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0647392272949219
Epoch: 17, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.698 Vali Acc: 0.251 Test Loss: 1.698 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 35300
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9699018001556396
Epoch: 1, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.415 Vali Acc: 0.240 Test Loss: 1.415 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.0974934101104736
Epoch: 2, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.415 Vali Acc: 0.247 Test Loss: 1.415 Test Acc: 0.247
Validation loss decreased (-0.239530 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.207780361175537
Epoch: 3, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.408 Vali Acc: 0.232 Test Loss: 1.408 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.350041151046753
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.411 Vali Acc: 0.240 Test Loss: 1.411 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1343414783477783
Epoch: 5, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.421 Vali Acc: 0.285 Test Loss: 1.421 Test Acc: 0.285
Validation loss decreased (-0.247134 --> -0.285157).  Saving model ...
Epoch: 6 cost time: 1.1781516075134277
Epoch: 6, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.420 Vali Acc: 0.240 Test Loss: 1.420 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0876672267913818
Epoch: 7, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.449 Vali Acc: 0.255 Test Loss: 1.449 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0845937728881836
Epoch: 8, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.483 Vali Acc: 0.251 Test Loss: 1.483 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.174027442932129
Epoch: 9, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.460 Vali Acc: 0.255 Test Loss: 1.460 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2347569465637207
Epoch: 10, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.471 Vali Acc: 0.240 Test Loss: 1.471 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1562747955322266
Epoch: 11, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.533 Vali Acc: 0.266 Test Loss: 1.533 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1601192951202393
Epoch: 12, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.485 Vali Acc: 0.255 Test Loss: 1.485 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1508166790008545
Epoch: 13, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.561 Vali Acc: 0.251 Test Loss: 1.561 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.941964864730835
Epoch: 14, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.506 Vali Acc: 0.247 Test Loss: 1.506 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9801168441772461
Epoch: 15, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.523 Vali Acc: 0.232 Test Loss: 1.523 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 34020
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9302597045898438
Epoch: 1, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.411 Vali Acc: 0.247 Test Loss: 1.411 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.0283596515655518
Epoch: 2, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.410 Vali Acc: 0.251 Test Loss: 1.410 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 1.123473882675171
Epoch: 3, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.405 Vali Acc: 0.270 Test Loss: 1.405 Test Acc: 0.270
Validation loss decreased (-0.250936 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 0.9271707534790039
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.409 Vali Acc: 0.274 Test Loss: 1.409 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 1.0411531925201416
Epoch: 5, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.417 Vali Acc: 0.278 Test Loss: 1.417 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 6 cost time: 1.1520493030548096
Epoch: 6, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.435 Vali Acc: 0.247 Test Loss: 1.435 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2023563385009766
Epoch: 7, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.434 Vali Acc: 0.262 Test Loss: 1.434 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9999895095825195
Epoch: 8, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.411 Vali Acc: 0.278 Test Loss: 1.411 Test Acc: 0.278
Validation loss decreased (-0.277552 --> -0.277552).  Saving model ...
Epoch: 9 cost time: 1.0362193584442139
Epoch: 9, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.428 Vali Acc: 0.236 Test Loss: 1.428 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1390552520751953
Epoch: 10, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.447 Vali Acc: 0.262 Test Loss: 1.447 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.071547269821167
Epoch: 11, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.487 Vali Acc: 0.281 Test Loss: 1.487 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281354).  Saving model ...
Epoch: 12 cost time: 1.1830635070800781
Epoch: 12, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.504 Vali Acc: 0.285 Test Loss: 1.504 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285156).  Saving model ...
Epoch: 13 cost time: 1.013378381729126
Epoch: 13, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.467 Vali Acc: 0.228 Test Loss: 1.467 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1991825103759766
Epoch: 14, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.519 Vali Acc: 0.247 Test Loss: 1.519 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3854806423187256
Epoch: 15, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.516 Vali Acc: 0.270 Test Loss: 1.516 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9224226474761963
Epoch: 16, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.506 Vali Acc: 0.236 Test Loss: 1.506 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1576251983642578
Epoch: 17, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.530 Vali Acc: 0.259 Test Loss: 1.530 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1623859405517578
Epoch: 18, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.622 Vali Acc: 0.236 Test Loss: 1.622 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2967689037322998
Epoch: 19, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.639 Vali Acc: 0.247 Test Loss: 1.639 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1324405670166016
Epoch: 20, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.619 Vali Acc: 0.259 Test Loss: 1.619 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2178404331207275
Epoch: 21, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.572 Vali Acc: 0.232 Test Loss: 1.572 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0728604793548584
Epoch: 22, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.683 Vali Acc: 0.228 Test Loss: 1.683 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 34500
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8589980602264404
Epoch: 1, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.402 Vali Acc: 0.255 Test Loss: 1.402 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.9900543689727783
Epoch: 2, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.401 Vali Acc: 0.259 Test Loss: 1.401 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.0801599025726318
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.391 Vali Acc: 0.236 Test Loss: 1.391 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.043471336364746
Epoch: 4, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.396 Vali Acc: 0.262 Test Loss: 1.396 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 1.134871482849121
Epoch: 5, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.393 Vali Acc: 0.259 Test Loss: 1.393 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0022616386413574
Epoch: 6, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.399 Vali Acc: 0.270 Test Loss: 1.399 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 7 cost time: 1.0433285236358643
Epoch: 7, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.394 Vali Acc: 0.243 Test Loss: 1.394 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9805941581726074
Epoch: 8, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.132986068725586
Epoch: 9, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.423 Vali Acc: 0.243 Test Loss: 1.423 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2240428924560547
Epoch: 10, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.471 Vali Acc: 0.259 Test Loss: 1.471 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0469210147857666
Epoch: 11, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.435 Vali Acc: 0.285 Test Loss: 1.435 Test Acc: 0.285
Validation loss decreased (-0.269948 --> -0.285157).  Saving model ...
Epoch: 12 cost time: 1.0542018413543701
Epoch: 12, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.435 Vali Acc: 0.251 Test Loss: 1.435 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9890153408050537
Epoch: 13, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.465 Vali Acc: 0.221 Test Loss: 1.465 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1578402519226074
Epoch: 14, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.463 Vali Acc: 0.247 Test Loss: 1.463 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.315929651260376
Epoch: 15, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.486 Vali Acc: 0.243 Test Loss: 1.486 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.042374610900879
Epoch: 16, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.520 Vali Acc: 0.236 Test Loss: 1.520 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1706113815307617
Epoch: 17, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.514 Vali Acc: 0.232 Test Loss: 1.514 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1356987953186035
Epoch: 18, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.559 Vali Acc: 0.259 Test Loss: 1.559 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1795976161956787
Epoch: 19, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.570 Vali Acc: 0.255 Test Loss: 1.570 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2288627624511719
Epoch: 20, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.546 Vali Acc: 0.247 Test Loss: 1.546 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1779959201812744
Epoch: 21, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.644 Vali Acc: 0.270 Test Loss: 1.644 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 35780
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.122898578643799
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.440 Vali Acc: 0.247 Test Loss: 1.440 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.1497437953948975
Epoch: 2, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.425 Vali Acc: 0.259 Test Loss: 1.425 Test Acc: 0.259
Validation loss decreased (-0.247134 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.0711255073547363
Epoch: 3, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.430 Vali Acc: 0.209 Test Loss: 1.430 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0665125846862793
Epoch: 4, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.423 Vali Acc: 0.232 Test Loss: 1.423 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.112546682357788
Epoch: 5, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.437 Vali Acc: 0.217 Test Loss: 1.437 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9769892692565918
Epoch: 6, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.434 Vali Acc: 0.232 Test Loss: 1.434 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0750041007995605
Epoch: 7, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.449 Vali Acc: 0.274 Test Loss: 1.449 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 8 cost time: 0.9795544147491455
Epoch: 8, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.438 Vali Acc: 0.251 Test Loss: 1.438 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0070958137512207
Epoch: 9, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.434 Vali Acc: 0.274 Test Loss: 1.434 Test Acc: 0.274
Validation loss decreased (-0.273750 --> -0.273750).  Saving model ...
Epoch: 10 cost time: 1.071758508682251
Epoch: 10, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.465 Vali Acc: 0.285 Test Loss: 1.465 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 11 cost time: 1.2067832946777344
Epoch: 11, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.505 Vali Acc: 0.251 Test Loss: 1.505 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2860653400421143
Epoch: 12, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.467 Vali Acc: 0.251 Test Loss: 1.467 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1841659545898438
Epoch: 13, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.515 Vali Acc: 0.281 Test Loss: 1.515 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2436401844024658
Epoch: 14, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.470 Vali Acc: 0.262 Test Loss: 1.470 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1133809089660645
Epoch: 15, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.543 Vali Acc: 0.270 Test Loss: 1.543 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1814525127410889
Epoch: 16, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.512 Vali Acc: 0.247 Test Loss: 1.512 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0141563415527344
Epoch: 17, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.547 Vali Acc: 0.274 Test Loss: 1.547 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.05592942237854
Epoch: 18, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.615 Vali Acc: 0.262 Test Loss: 1.615 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0993835926055908
Epoch: 19, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.538 Vali Acc: 0.240 Test Loss: 1.538 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0945217609405518
Epoch: 20, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.603 Vali Acc: 0.259 Test Loss: 1.603 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df256_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 37796
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.885133981704712
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.439 Vali Acc: 0.251 Test Loss: 1.439 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.0905098915100098
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.421 Vali Acc: 0.274 Test Loss: 1.421 Test Acc: 0.274
Validation loss decreased (-0.250936 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 1.1240601539611816
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.469 Vali Acc: 0.259 Test Loss: 1.469 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1215665340423584
Epoch: 4, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.465 Vali Acc: 0.251 Test Loss: 1.465 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0113842487335205
Epoch: 5, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.598 Vali Acc: 0.240 Test Loss: 1.598 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0543577671051025
Epoch: 6, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.565 Vali Acc: 0.255 Test Loss: 1.565 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9370450973510742
Epoch: 7, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.495 Vali Acc: 0.255 Test Loss: 1.495 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1127560138702393
Epoch: 8, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.587 Vali Acc: 0.255 Test Loss: 1.587 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0583808422088623
Epoch: 9, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.499 Vali Acc: 0.262 Test Loss: 1.499 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1665008068084717
Epoch: 10, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.483 Vali Acc: 0.247 Test Loss: 1.483 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0317811965942383
Epoch: 11, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.614 Vali Acc: 0.251 Test Loss: 1.614 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0794475078582764
Epoch: 12, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.573 Vali Acc: 0.281 Test Loss: 1.573 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281353).  Saving model ...
Epoch: 13 cost time: 1.1434526443481445
Epoch: 13, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.588 Vali Acc: 0.274 Test Loss: 1.588 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1589117050170898
Epoch: 14, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.709 Vali Acc: 0.251 Test Loss: 1.709 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1058506965637207
Epoch: 15, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.657 Vali Acc: 0.270 Test Loss: 1.657 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9921319484710693
Epoch: 16, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.597 Vali Acc: 0.255 Test Loss: 1.597 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1457793712615967
Epoch: 17, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.722 Vali Acc: 0.281 Test Loss: 1.722 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0314478874206543
Epoch: 18, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.707 Vali Acc: 0.221 Test Loss: 1.707 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9564471244812012
Epoch: 19, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.729 Vali Acc: 0.232 Test Loss: 1.729 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.964282751083374
Epoch: 20, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.785 Vali Acc: 0.232 Test Loss: 1.785 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0424764156341553
Epoch: 21, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.713 Vali Acc: 0.255 Test Loss: 1.713 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.102992296218872
Epoch: 22, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.862 Vali Acc: 0.217 Test Loss: 1.862 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44516
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.6360936164855957
Epoch: 1, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.383 Vali Acc: 0.293 Test Loss: 1.383 Test Acc: 0.293
Validation loss decreased (inf --> -0.292762).  Saving model ...
Epoch: 2 cost time: 1.2392354011535645
Epoch: 2, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.411 Vali Acc: 0.232 Test Loss: 1.411 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0887470245361328
Epoch: 3, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.416 Vali Acc: 0.266 Test Loss: 1.416 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9882128238677979
Epoch: 4, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.442 Vali Acc: 0.278 Test Loss: 1.442 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1339592933654785
Epoch: 5, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.415 Vali Acc: 0.266 Test Loss: 1.415 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.947744607925415
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.398 Vali Acc: 0.262 Test Loss: 1.398 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9648463726043701
Epoch: 7, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.571 Vali Acc: 0.278 Test Loss: 1.571 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1287834644317627
Epoch: 8, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.468 Vali Acc: 0.266 Test Loss: 1.468 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.148164987564087
Epoch: 9, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.487 Vali Acc: 0.266 Test Loss: 1.487 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1732430458068848
Epoch: 10, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.489 Vali Acc: 0.274 Test Loss: 1.489 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9582109451293945
Epoch: 11, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.509 Vali Acc: 0.285 Test Loss: 1.509 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 30564
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.856274366378784
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.393 Vali Acc: 0.262 Test Loss: 1.393 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.0620746612548828
Epoch: 2, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.399 Vali Acc: 0.278 Test Loss: 1.399 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277553).  Saving model ...
Epoch: 3 cost time: 1.14888334274292
Epoch: 3, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.396 Vali Acc: 0.259 Test Loss: 1.396 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1124627590179443
Epoch: 4, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.420 Vali Acc: 0.274 Test Loss: 1.420 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.022998332977295
Epoch: 5, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.430 Vali Acc: 0.236 Test Loss: 1.430 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1062817573547363
Epoch: 6, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.499 Vali Acc: 0.251 Test Loss: 1.499 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0402040481567383
Epoch: 7, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.446 Vali Acc: 0.247 Test Loss: 1.446 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9108314514160156
Epoch: 8, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.457 Vali Acc: 0.266 Test Loss: 1.457 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.058783769607544
Epoch: 9, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.474 Vali Acc: 0.297 Test Loss: 1.474 Test Acc: 0.297
Validation loss decreased (-0.277553 --> -0.296563).  Saving model ...
Epoch: 10 cost time: 1.0635004043579102
Epoch: 10, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.552 Vali Acc: 0.251 Test Loss: 1.552 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.18119478225708
Epoch: 11, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.471 Vali Acc: 0.262 Test Loss: 1.471 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0175671577453613
Epoch: 12, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.489 Vali Acc: 0.266 Test Loss: 1.489 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0972130298614502
Epoch: 13, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.468 Vali Acc: 0.262 Test Loss: 1.468 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2965006828308105
Epoch: 14, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.478 Vali Acc: 0.243 Test Loss: 1.478 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0282201766967773
Epoch: 15, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.620 Vali Acc: 0.262 Test Loss: 1.620 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0839362144470215
Epoch: 16, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.515 Vali Acc: 0.243 Test Loss: 1.515 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1854639053344727
Epoch: 17, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.622 Vali Acc: 0.274 Test Loss: 1.622 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1423473358154297
Epoch: 18, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.645 Vali Acc: 0.255 Test Loss: 1.645 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9839212894439697
Epoch: 19, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.585 Vali Acc: 0.221 Test Loss: 1.585 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 26980
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.6669397354125977
Epoch: 1, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.397 Vali Acc: 0.243 Test Loss: 1.397 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.1852736473083496
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.397 Vali Acc: 0.240 Test Loss: 1.397 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.049973964691162
Epoch: 3, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.405 Vali Acc: 0.255 Test Loss: 1.405 Test Acc: 0.255
Validation loss decreased (-0.243332 --> -0.254739).  Saving model ...
Epoch: 4 cost time: 1.240020751953125
Epoch: 4, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.392 Vali Acc: 0.270 Test Loss: 1.392 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 1.2464377880096436
Epoch: 5, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.395 Vali Acc: 0.297 Test Loss: 1.395 Test Acc: 0.297
Validation loss decreased (-0.269948 --> -0.296564).  Saving model ...
Epoch: 6 cost time: 1.201207160949707
Epoch: 6, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.425 Vali Acc: 0.266 Test Loss: 1.425 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1454763412475586
Epoch: 7, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.435 Vali Acc: 0.289 Test Loss: 1.435 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2130036354064941
Epoch: 8, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.500 Vali Acc: 0.240 Test Loss: 1.500 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1779322624206543
Epoch: 9, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.439 Vali Acc: 0.255 Test Loss: 1.439 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.206606388092041
Epoch: 10, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.454 Vali Acc: 0.289 Test Loss: 1.454 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.241245985031128
Epoch: 11, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.476 Vali Acc: 0.243 Test Loss: 1.476 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3028717041015625
Epoch: 12, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.504 Vali Acc: 0.255 Test Loss: 1.504 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3798627853393555
Epoch: 13, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.520 Vali Acc: 0.259 Test Loss: 1.520 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.161071538925171
Epoch: 14, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.495 Vali Acc: 0.243 Test Loss: 1.495 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.04693603515625
Epoch: 15, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.490 Vali Acc: 0.251 Test Loss: 1.490 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 25700
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.149904727935791
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.404 Vali Acc: 0.236 Test Loss: 1.404 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.1752042770385742
Epoch: 2, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.401 Vali Acc: 0.243 Test Loss: 1.401 Test Acc: 0.243
Validation loss decreased (-0.235727 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 1.2815520763397217
Epoch: 3, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.401 Vali Acc: 0.224 Test Loss: 1.401 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1904082298278809
Epoch: 4, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.404 Vali Acc: 0.262 Test Loss: 1.404 Test Acc: 0.262
Validation loss decreased (-0.243332 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 1.0667624473571777
Epoch: 5, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.416 Vali Acc: 0.224 Test Loss: 1.416 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1208245754241943
Epoch: 6, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.407 Vali Acc: 0.255 Test Loss: 1.407 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1514570713043213
Epoch: 7, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.424 Vali Acc: 0.262 Test Loss: 1.424 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0789093971252441
Epoch: 8, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.416 Vali Acc: 0.224 Test Loss: 1.416 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1992614269256592
Epoch: 9, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.450 Vali Acc: 0.285 Test Loss: 1.450 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285157).  Saving model ...
Epoch: 10 cost time: 1.2306344509124756
Epoch: 10, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.436 Vali Acc: 0.262 Test Loss: 1.436 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1376287937164307
Epoch: 11, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.446 Vali Acc: 0.259 Test Loss: 1.446 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2039189338684082
Epoch: 12, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.462 Vali Acc: 0.262 Test Loss: 1.462 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.085167407989502
Epoch: 13, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.477 Vali Acc: 0.293 Test Loss: 1.477 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292761).  Saving model ...
Epoch: 14 cost time: 1.1246795654296875
Epoch: 14, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.470 Vali Acc: 0.247 Test Loss: 1.470 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1534247398376465
Epoch: 15, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.509 Vali Acc: 0.251 Test Loss: 1.509 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.131502628326416
Epoch: 16, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.490 Vali Acc: 0.247 Test Loss: 1.490 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0871021747589111
Epoch: 17, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.557 Vali Acc: 0.255 Test Loss: 1.557 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1066701412200928
Epoch: 18, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.579 Vali Acc: 0.281 Test Loss: 1.579 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1466143131256104
Epoch: 19, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.552 Vali Acc: 0.270 Test Loss: 1.552 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2134077548980713
Epoch: 20, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.536 Vali Acc: 0.270 Test Loss: 1.536 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.190891981124878
Epoch: 21, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.585 Vali Acc: 0.262 Test Loss: 1.585 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1843914985656738
Epoch: 22, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.629 Vali Acc: 0.262 Test Loss: 1.629 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1113061904907227
Epoch: 23, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.659 Vali Acc: 0.281 Test Loss: 1.659 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 26180
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.082426071166992
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.439 Vali Acc: 0.247 Test Loss: 1.439 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.0563664436340332
Epoch: 2, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.414 Vali Acc: 0.243 Test Loss: 1.414 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.074462652206421
Epoch: 3, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.412 Vali Acc: 0.259 Test Loss: 1.412 Test Acc: 0.259
Validation loss decreased (-0.247134 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 1.091160774230957
Epoch: 4, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.437 Vali Acc: 0.251 Test Loss: 1.437 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.113671064376831
Epoch: 5, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.410 Vali Acc: 0.240 Test Loss: 1.410 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0899653434753418
Epoch: 6, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.429 Vali Acc: 0.270 Test Loss: 1.429 Test Acc: 0.270
Validation loss decreased (-0.258541 --> -0.269948).  Saving model ...
Epoch: 7 cost time: 1.0385491847991943
Epoch: 7, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.422 Vali Acc: 0.262 Test Loss: 1.422 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2351021766662598
Epoch: 8, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.423 Vali Acc: 0.236 Test Loss: 1.423 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2543513774871826
Epoch: 9, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.436 Vali Acc: 0.259 Test Loss: 1.436 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2011220455169678
Epoch: 10, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.445 Vali Acc: 0.293 Test Loss: 1.445 Test Acc: 0.293
Validation loss decreased (-0.269948 --> -0.292761).  Saving model ...
Epoch: 11 cost time: 1.2027313709259033
Epoch: 11, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.520 Vali Acc: 0.247 Test Loss: 1.520 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1833059787750244
Epoch: 12, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.560 Vali Acc: 0.285 Test Loss: 1.560 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2448630332946777
Epoch: 13, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.470 Vali Acc: 0.247 Test Loss: 1.470 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1807961463928223
Epoch: 14, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.461 Vali Acc: 0.251 Test Loss: 1.461 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2248408794403076
Epoch: 15, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.541 Vali Acc: 0.262 Test Loss: 1.541 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1875355243682861
Epoch: 16, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.562 Vali Acc: 0.217 Test Loss: 1.562 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1562848091125488
Epoch: 17, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.546 Vali Acc: 0.236 Test Loss: 1.546 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1238930225372314
Epoch: 18, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.667 Vali Acc: 0.236 Test Loss: 1.667 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.010310173034668
Epoch: 19, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.548 Vali Acc: 0.243 Test Loss: 1.548 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0236570835113525
Epoch: 20, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.619 Vali Acc: 0.240 Test Loss: 1.619 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 27460
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9045519828796387
Epoch: 1, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.438 Vali Acc: 0.217 Test Loss: 1.438 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 0.995753288269043
Epoch: 2, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.442 Vali Acc: 0.202 Test Loss: 1.442 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0280356407165527
Epoch: 3, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.431 Vali Acc: 0.205 Test Loss: 1.431 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1420106887817383
Epoch: 4, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.423 Vali Acc: 0.213 Test Loss: 1.423 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9950549602508545
Epoch: 5, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.427 Vali Acc: 0.243 Test Loss: 1.427 Test Acc: 0.243
Validation loss decreased (-0.216716 --> -0.243332).  Saving model ...
Epoch: 6 cost time: 1.0780484676361084
Epoch: 6, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.452 Vali Acc: 0.259 Test Loss: 1.452 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258541).  Saving model ...
Epoch: 7 cost time: 1.1577720642089844
Epoch: 7, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.439 Vali Acc: 0.259 Test Loss: 1.439 Test Acc: 0.259
Validation loss decreased (-0.258541 --> -0.258541).  Saving model ...
Epoch: 8 cost time: 1.1204862594604492
Epoch: 8, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.468 Vali Acc: 0.266 Test Loss: 1.468 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266145).  Saving model ...
Epoch: 9 cost time: 1.124288558959961
Epoch: 9, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.436 Vali Acc: 0.243 Test Loss: 1.436 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1527857780456543
Epoch: 10, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.436 Vali Acc: 0.240 Test Loss: 1.436 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.020965337753296
Epoch: 11, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.466 Vali Acc: 0.236 Test Loss: 1.466 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1208624839782715
Epoch: 12, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.456 Vali Acc: 0.232 Test Loss: 1.456 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1005773544311523
Epoch: 13, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.532 Vali Acc: 0.270 Test Loss: 1.532 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269947).  Saving model ...
Epoch: 14 cost time: 1.0773673057556152
Epoch: 14, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.510 Vali Acc: 0.232 Test Loss: 1.510 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1203019618988037
Epoch: 15, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.532 Vali Acc: 0.236 Test Loss: 1.532 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0875022411346436
Epoch: 16, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.539 Vali Acc: 0.278 Test Loss: 1.539 Test Acc: 0.278
Validation loss decreased (-0.269947 --> -0.277551).  Saving model ...
Epoch: 17 cost time: 0.9488742351531982
Epoch: 17, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.541 Vali Acc: 0.236 Test Loss: 1.541 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1330821514129639
Epoch: 18, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.527 Vali Acc: 0.251 Test Loss: 1.527 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.076730489730835
Epoch: 19, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.519 Vali Acc: 0.205 Test Loss: 1.519 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.016538381576538
Epoch: 20, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.550 Vali Acc: 0.221 Test Loss: 1.550 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0842437744140625
Epoch: 21, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.615 Vali Acc: 0.247 Test Loss: 1.615 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9632337093353271
Epoch: 22, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.665 Vali Acc: 0.255 Test Loss: 1.665 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0969486236572266
Epoch: 23, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.617 Vali Acc: 0.255 Test Loss: 1.617 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1763181686401367
Epoch: 24, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.729 Vali Acc: 0.251 Test Loss: 1.729 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9385263919830322
Epoch: 25, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.700 Vali Acc: 0.278 Test Loss: 1.700 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.237243413925171
Epoch: 26, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.710 Vali Acc: 0.251 Test Loss: 1.710 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df128_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 29476
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7344131469726562
Epoch: 1, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.416 Vali Acc: 0.213 Test Loss: 1.416 Test Acc: 0.213
Validation loss decreased (inf --> -0.212914).  Saving model ...
Epoch: 2 cost time: 0.9013581275939941
Epoch: 2, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.406 Vali Acc: 0.259 Test Loss: 1.406 Test Acc: 0.259
Validation loss decreased (-0.212914 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 0.9352161884307861
Epoch: 3, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.448 Vali Acc: 0.266 Test Loss: 1.448 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 1.0256154537200928
Epoch: 4, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.518 Vali Acc: 0.240 Test Loss: 1.518 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.073141098022461
Epoch: 5, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.527 Vali Acc: 0.243 Test Loss: 1.527 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1062016487121582
Epoch: 6, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.545 Vali Acc: 0.243 Test Loss: 1.545 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9733245372772217
Epoch: 7, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.446 Vali Acc: 0.259 Test Loss: 1.446 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1431889533996582
Epoch: 8, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.572 Vali Acc: 0.274 Test Loss: 1.572 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273749).  Saving model ...
Epoch: 9 cost time: 0.9428226947784424
Epoch: 9, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.741 Vali Acc: 0.251 Test Loss: 1.741 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0876688957214355
Epoch: 10, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.482 Vali Acc: 0.270 Test Loss: 1.482 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0147745609283447
Epoch: 11, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.564 Vali Acc: 0.278 Test Loss: 1.564 Test Acc: 0.278
Validation loss decreased (-0.273749 --> -0.277551).  Saving model ...
Epoch: 12 cost time: 1.072131872177124
Epoch: 12, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.819 Vali Acc: 0.259 Test Loss: 1.819 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.008514404296875
Epoch: 13, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.555 Vali Acc: 0.243 Test Loss: 1.555 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8521442413330078
Epoch: 14, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.698 Vali Acc: 0.251 Test Loss: 1.698 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1489059925079346
Epoch: 15, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.726 Vali Acc: 0.266 Test Loss: 1.726 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.039719581604004
Epoch: 16, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.695 Vali Acc: 0.278 Test Loss: 1.695 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0216257572174072
Epoch: 17, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.601 Vali Acc: 0.247 Test Loss: 1.601 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0398054122924805
Epoch: 18, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.757 Vali Acc: 0.259 Test Loss: 1.757 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1785969734191895
Epoch: 19, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.732 Vali Acc: 0.262 Test Loss: 1.732 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.072087287902832
Epoch: 20, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.740 Vali Acc: 0.251 Test Loss: 1.740 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.049455165863037
Epoch: 21, Steps: 17 | Train Loss: 0.928 Vali Loss: 2.028 Vali Acc: 0.262 Test Loss: 2.028 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 40356
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.784186840057373
Epoch: 1, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.423 Vali Acc: 0.278 Test Loss: 1.423 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 1.0480461120605469
Epoch: 2, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.411 Vali Acc: 0.247 Test Loss: 1.411 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9254086017608643
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.451 Vali Acc: 0.262 Test Loss: 1.451 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9071574211120605
Epoch: 4, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.436 Vali Acc: 0.262 Test Loss: 1.436 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.959313154220581
Epoch: 5, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.443 Vali Acc: 0.270 Test Loss: 1.443 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9662001132965088
Epoch: 6, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.422 Vali Acc: 0.255 Test Loss: 1.422 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9423720836639404
Epoch: 7, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.481 Vali Acc: 0.232 Test Loss: 1.481 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0935797691345215
Epoch: 8, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.445 Vali Acc: 0.251 Test Loss: 1.445 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.977388858795166
Epoch: 9, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.536 Vali Acc: 0.262 Test Loss: 1.536 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9390339851379395
Epoch: 10, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.455 Vali Acc: 0.232 Test Loss: 1.455 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9955477714538574
Epoch: 11, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.563 Vali Acc: 0.243 Test Loss: 1.563 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 26404
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.234940767288208
Epoch: 1, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.402 Vali Acc: 0.259 Test Loss: 1.402 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.109412431716919
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.405 Vali Acc: 0.285 Test Loss: 1.405 Test Acc: 0.285
Validation loss decreased (-0.258541 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 0.9747781753540039
Epoch: 3, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.412 Vali Acc: 0.251 Test Loss: 1.412 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0747530460357666
Epoch: 4, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.413 Vali Acc: 0.259 Test Loss: 1.413 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9796018600463867
Epoch: 5, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.414 Vali Acc: 0.285 Test Loss: 1.414 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9112517833709717
Epoch: 6, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.440 Vali Acc: 0.266 Test Loss: 1.440 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0007545948028564
Epoch: 7, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.475 Vali Acc: 0.281 Test Loss: 1.475 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.088425636291504
Epoch: 8, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.518 Vali Acc: 0.274 Test Loss: 1.518 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.167111873626709
Epoch: 9, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.478 Vali Acc: 0.243 Test Loss: 1.478 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0163426399230957
Epoch: 10, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.454 Vali Acc: 0.274 Test Loss: 1.454 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0543935298919678
Epoch: 11, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.487 Vali Acc: 0.285 Test Loss: 1.487 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9958391189575195
Epoch: 12, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.543 Vali Acc: 0.262 Test Loss: 1.543 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 22820
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9046950340270996
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.409 Vali Acc: 0.240 Test Loss: 1.409 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.0682945251464844
Epoch: 2, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.419 Vali Acc: 0.285 Test Loss: 1.419 Test Acc: 0.285
Validation loss decreased (-0.239530 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 0.9116675853729248
Epoch: 3, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.417 Vali Acc: 0.236 Test Loss: 1.417 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.008500099182129
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.419 Vali Acc: 0.243 Test Loss: 1.419 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.102647304534912
Epoch: 5, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.411 Vali Acc: 0.262 Test Loss: 1.411 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0591273307800293
Epoch: 6, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.422 Vali Acc: 0.255 Test Loss: 1.422 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0414040088653564
Epoch: 7, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.429 Vali Acc: 0.255 Test Loss: 1.429 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9779167175292969
Epoch: 8, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.436 Vali Acc: 0.243 Test Loss: 1.436 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0299561023712158
Epoch: 9, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.437 Vali Acc: 0.270 Test Loss: 1.437 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0264050960540771
Epoch: 10, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.487 Vali Acc: 0.247 Test Loss: 1.487 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0755207538604736
Epoch: 11, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.469 Vali Acc: 0.266 Test Loss: 1.469 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0439722537994385
Epoch: 12, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.488 Vali Acc: 0.259 Test Loss: 1.488 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 21540
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7185003757476807
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.404 Vali Acc: 0.251 Test Loss: 1.404 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.0336461067199707
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.402 Vali Acc: 0.297 Test Loss: 1.402 Test Acc: 0.297
Validation loss decreased (-0.250937 --> -0.296564).  Saving model ...
Epoch: 3 cost time: 0.9285576343536377
Epoch: 3, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.393 Vali Acc: 0.274 Test Loss: 1.393 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.019301176071167
Epoch: 4, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.406 Vali Acc: 0.262 Test Loss: 1.406 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.029111623764038
Epoch: 5, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.401 Vali Acc: 0.274 Test Loss: 1.401 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2590413093566895
Epoch: 6, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.417 Vali Acc: 0.278 Test Loss: 1.417 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1421685218811035
Epoch: 7, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.421 Vali Acc: 0.297 Test Loss: 1.421 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1859815120697021
Epoch: 8, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.465 Vali Acc: 0.255 Test Loss: 1.465 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0728816986083984
Epoch: 9, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.425 Vali Acc: 0.274 Test Loss: 1.425 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2227914333343506
Epoch: 10, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.444 Vali Acc: 0.274 Test Loss: 1.444 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.056678056716919
Epoch: 11, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.431 Vali Acc: 0.266 Test Loss: 1.431 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0547373294830322
Epoch: 12, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.467 Vali Acc: 0.266 Test Loss: 1.467 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 22020
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.913870334625244
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.400 Vali Acc: 0.266 Test Loss: 1.400 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 1.0854523181915283
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.413 Vali Acc: 0.243 Test Loss: 1.413 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.000580072402954
Epoch: 3, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.395 Vali Acc: 0.243 Test Loss: 1.395 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1229546070098877
Epoch: 4, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.395 Vali Acc: 0.247 Test Loss: 1.395 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9655404090881348
Epoch: 5, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.402 Vali Acc: 0.232 Test Loss: 1.402 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0458619594573975
Epoch: 6, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.409 Vali Acc: 0.243 Test Loss: 1.409 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9653968811035156
Epoch: 7, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.406 Vali Acc: 0.251 Test Loss: 1.406 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9580886363983154
Epoch: 8, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.397 Vali Acc: 0.262 Test Loss: 1.397 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9747645854949951
Epoch: 9, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.435 Vali Acc: 0.274 Test Loss: 1.435 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273750).  Saving model ...
Epoch: 10 cost time: 1.0733692646026611
Epoch: 10, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.415 Vali Acc: 0.274 Test Loss: 1.415 Test Acc: 0.274
Validation loss decreased (-0.273750 --> -0.273750).  Saving model ...
Epoch: 11 cost time: 1.0080657005310059
Epoch: 11, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.424 Vali Acc: 0.255 Test Loss: 1.424 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9211034774780273
Epoch: 12, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.420 Vali Acc: 0.262 Test Loss: 1.420 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.890143871307373
Epoch: 13, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.441 Vali Acc: 0.281 Test Loss: 1.441 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281354).  Saving model ...
Epoch: 14 cost time: 1.0033209323883057
Epoch: 14, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.437 Vali Acc: 0.274 Test Loss: 1.437 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0314171314239502
Epoch: 15, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.438 Vali Acc: 0.255 Test Loss: 1.438 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0913310050964355
Epoch: 16, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.474 Vali Acc: 0.266 Test Loss: 1.474 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0386357307434082
Epoch: 17, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.539 Vali Acc: 0.278 Test Loss: 1.539 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1373343467712402
Epoch: 18, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.475 Vali Acc: 0.278 Test Loss: 1.475 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1356120109558105
Epoch: 19, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.556 Vali Acc: 0.278 Test Loss: 1.556 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2083520889282227
Epoch: 20, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.491 Vali Acc: 0.262 Test Loss: 1.491 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1624839305877686
Epoch: 21, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.520 Vali Acc: 0.289 Test Loss: 1.520 Test Acc: 0.289
Validation loss decreased (-0.281354 --> -0.288958).  Saving model ...
Epoch: 22 cost time: 1.0724620819091797
Epoch: 22, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.529 Vali Acc: 0.297 Test Loss: 1.529 Test Acc: 0.297
Validation loss decreased (-0.288958 --> -0.296563).  Saving model ...
Epoch: 23 cost time: 1.0386731624603271
Epoch: 23, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.591 Vali Acc: 0.262 Test Loss: 1.591 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9631190299987793
Epoch: 24, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.565 Vali Acc: 0.262 Test Loss: 1.565 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0086443424224854
Epoch: 25, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.612 Vali Acc: 0.289 Test Loss: 1.612 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0153343677520752
Epoch: 26, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.581 Vali Acc: 0.278 Test Loss: 1.581 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1554250717163086
Epoch: 27, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.583 Vali Acc: 0.232 Test Loss: 1.583 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0891039371490479
Epoch: 28, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.690 Vali Acc: 0.274 Test Loss: 1.690 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2662780284881592
Epoch: 29, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.648 Vali Acc: 0.274 Test Loss: 1.648 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.156116247177124
Epoch: 30, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.672 Vali Acc: 0.274 Test Loss: 1.672 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1159276962280273
Epoch: 31, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.746 Vali Acc: 0.274 Test Loss: 1.746 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0897908210754395
Epoch: 32, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.697 Vali Acc: 0.217 Test Loss: 1.697 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 23300
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.059133529663086
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.435 Vali Acc: 0.228 Test Loss: 1.435 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 0.9697952270507812
Epoch: 2, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.434 Vali Acc: 0.202 Test Loss: 1.434 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0501558780670166
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.419 Vali Acc: 0.228 Test Loss: 1.419 Test Acc: 0.228
Validation loss decreased (-0.228123 --> -0.228123).  Saving model ...
Epoch: 4 cost time: 0.9999175071716309
Epoch: 4, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.414 Vali Acc: 0.240 Test Loss: 1.414 Test Acc: 0.240
Validation loss decreased (-0.228123 --> -0.239530).  Saving model ...
Epoch: 5 cost time: 1.0353896617889404
Epoch: 5, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.407 Vali Acc: 0.262 Test Loss: 1.407 Test Acc: 0.262
Validation loss decreased (-0.239530 --> -0.262343).  Saving model ...
Epoch: 6 cost time: 1.1871919631958008
Epoch: 6, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.409 Vali Acc: 0.259 Test Loss: 1.409 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0173702239990234
Epoch: 7, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.423 Vali Acc: 0.247 Test Loss: 1.423 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0251221656799316
Epoch: 8, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 9 cost time: 1.0046863555908203
Epoch: 9, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.417 Vali Acc: 0.262 Test Loss: 1.417 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1071147918701172
Epoch: 10, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.432 Vali Acc: 0.255 Test Loss: 1.432 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0759186744689941
Epoch: 11, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.427 Vali Acc: 0.266 Test Loss: 1.427 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.046241283416748
Epoch: 12, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.455 Vali Acc: 0.251 Test Loss: 1.455 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1264936923980713
Epoch: 13, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.476 Vali Acc: 0.300 Test Loss: 1.476 Test Acc: 0.300
Validation loss decreased (-0.269948 --> -0.300365).  Saving model ...
Epoch: 14 cost time: 1.1014654636383057
Epoch: 14, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.474 Vali Acc: 0.251 Test Loss: 1.474 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.041630506515503
Epoch: 15, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.485 Vali Acc: 0.221 Test Loss: 1.485 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1358840465545654
Epoch: 16, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.471 Vali Acc: 0.251 Test Loss: 1.471 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.018415927886963
Epoch: 17, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.501 Vali Acc: 0.278 Test Loss: 1.501 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1315243244171143
Epoch: 18, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.567 Vali Acc: 0.293 Test Loss: 1.567 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1751630306243896
Epoch: 19, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.528 Vali Acc: 0.262 Test Loss: 1.528 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1702065467834473
Epoch: 20, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.606 Vali Acc: 0.251 Test Loss: 1.606 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.158855676651001
Epoch: 21, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.552 Vali Acc: 0.270 Test Loss: 1.552 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2298715114593506
Epoch: 22, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.616 Vali Acc: 0.274 Test Loss: 1.616 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.126908540725708
Epoch: 23, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.623 Vali Acc: 0.259 Test Loss: 1.623 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm32_nh4_df64_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 25316
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7238495349884033
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.396 Vali Acc: 0.262 Test Loss: 1.396 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.127629041671753
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.387 Vali Acc: 0.251 Test Loss: 1.387 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0726051330566406
Epoch: 3, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.397 Vali Acc: 0.293 Test Loss: 1.397 Test Acc: 0.293
Validation loss decreased (-0.262343 --> -0.292762).  Saving model ...
Epoch: 4 cost time: 1.0366404056549072
Epoch: 4, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.490 Vali Acc: 0.266 Test Loss: 1.490 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.119969129562378
Epoch: 5, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.509 Vali Acc: 0.240 Test Loss: 1.509 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.07584547996521
Epoch: 6, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.476 Vali Acc: 0.240 Test Loss: 1.476 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1070706844329834
Epoch: 7, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.427 Vali Acc: 0.270 Test Loss: 1.427 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1147048473358154
Epoch: 8, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.419 Vali Acc: 0.243 Test Loss: 1.419 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1368370056152344
Epoch: 9, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.433 Vali Acc: 0.274 Test Loss: 1.433 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2017903327941895
Epoch: 10, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.550 Vali Acc: 0.281 Test Loss: 1.550 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1867592334747314
Epoch: 11, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.517 Vali Acc: 0.243 Test Loss: 1.517 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1961991786956787
Epoch: 12, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.481 Vali Acc: 0.259 Test Loss: 1.481 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1373980045318604
Epoch: 13, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.496 Vali Acc: 0.251 Test Loss: 1.496 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 25524
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7223305702209473
Epoch: 1, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.406 Vali Acc: 0.221 Test Loss: 1.406 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 1.0615580081939697
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.410 Vali Acc: 0.255 Test Loss: 1.410 Test Acc: 0.255
Validation loss decreased (-0.220518 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.1117973327636719
Epoch: 3, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.400 Vali Acc: 0.198 Test Loss: 1.400 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.115983247756958
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.412 Vali Acc: 0.236 Test Loss: 1.412 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2203609943389893
Epoch: 5, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.399 Vali Acc: 0.255 Test Loss: 1.399 Test Acc: 0.255
Validation loss decreased (-0.254739 --> -0.254739).  Saving model ...
Epoch: 6 cost time: 1.0979812145233154
Epoch: 6, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.402 Vali Acc: 0.240 Test Loss: 1.402 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2776226997375488
Epoch: 7, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.406 Vali Acc: 0.243 Test Loss: 1.406 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2722089290618896
Epoch: 8, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.404 Vali Acc: 0.262 Test Loss: 1.404 Test Acc: 0.262
Validation loss decreased (-0.254739 --> -0.262343).  Saving model ...
Epoch: 9 cost time: 1.1668837070465088
Epoch: 9, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.424 Vali Acc: 0.285 Test Loss: 1.424 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285157).  Saving model ...
Epoch: 10 cost time: 1.1863369941711426
Epoch: 10, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.414 Vali Acc: 0.278 Test Loss: 1.414 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9521253108978271
Epoch: 11, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.417 Vali Acc: 0.240 Test Loss: 1.417 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9203393459320068
Epoch: 12, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.456 Vali Acc: 0.247 Test Loss: 1.456 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9970109462738037
Epoch: 13, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.437 Vali Acc: 0.236 Test Loss: 1.437 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9518074989318848
Epoch: 14, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.459 Vali Acc: 0.262 Test Loss: 1.459 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0291213989257812
Epoch: 15, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.436 Vali Acc: 0.243 Test Loss: 1.436 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0406203269958496
Epoch: 16, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0381693840026855
Epoch: 17, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.535 Vali Acc: 0.266 Test Loss: 1.535 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2832064628601074
Epoch: 18, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.474 Vali Acc: 0.281 Test Loss: 1.474 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.032287359237671
Epoch: 19, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.464 Vali Acc: 0.243 Test Loss: 1.464 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 18548
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.821239948272705
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.398 Vali Acc: 0.255 Test Loss: 1.398 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.2218236923217773
Epoch: 2, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.405 Vali Acc: 0.255 Test Loss: 1.405 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0503695011138916
Epoch: 3, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.400 Vali Acc: 0.274 Test Loss: 1.400 Test Acc: 0.274
Validation loss decreased (-0.254739 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 0.9960877895355225
Epoch: 4, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.404 Vali Acc: 0.270 Test Loss: 1.404 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0329947471618652
Epoch: 5, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.402 Vali Acc: 0.289 Test Loss: 1.402 Test Acc: 0.289
Validation loss decreased (-0.273750 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 1.1288652420043945
Epoch: 6, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.416 Vali Acc: 0.251 Test Loss: 1.416 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.118501901626587
Epoch: 7, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.402 Vali Acc: 0.266 Test Loss: 1.402 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1050796508789062
Epoch: 8, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.416 Vali Acc: 0.247 Test Loss: 1.416 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0575988292694092
Epoch: 9, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.420 Vali Acc: 0.266 Test Loss: 1.420 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1008224487304688
Epoch: 10, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.416 Vali Acc: 0.266 Test Loss: 1.416 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1858384609222412
Epoch: 11, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.418 Vali Acc: 0.262 Test Loss: 1.418 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0980823040008545
Epoch: 12, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.461 Vali Acc: 0.236 Test Loss: 1.461 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0515179634094238
Epoch: 13, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.439 Vali Acc: 0.278 Test Loss: 1.439 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0587387084960938
Epoch: 14, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.451 Vali Acc: 0.243 Test Loss: 1.451 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1962599754333496
Epoch: 15, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.454 Vali Acc: 0.274 Test Loss: 1.454 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 16756
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.745420455932617
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.423 Vali Acc: 0.236 Test Loss: 1.423 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 0.9618053436279297
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.420 Vali Acc: 0.232 Test Loss: 1.420 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0015130043029785
Epoch: 3, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.417 Vali Acc: 0.236 Test Loss: 1.417 Test Acc: 0.236
Validation loss decreased (-0.235727 --> -0.235727).  Saving model ...
Epoch: 4 cost time: 1.040900468826294
Epoch: 4, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.414 Vali Acc: 0.247 Test Loss: 1.414 Test Acc: 0.247
Validation loss decreased (-0.235727 --> -0.247134).  Saving model ...
Epoch: 5 cost time: 0.8729193210601807
Epoch: 5, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.413 Vali Acc: 0.240 Test Loss: 1.413 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1131772994995117
Epoch: 6, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.412 Vali Acc: 0.243 Test Loss: 1.412 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2691233158111572
Epoch: 7, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.411 Vali Acc: 0.262 Test Loss: 1.411 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262343).  Saving model ...
Epoch: 8 cost time: 0.9405965805053711
Epoch: 8, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.413 Vali Acc: 0.228 Test Loss: 1.413 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1248981952667236
Epoch: 9, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.417 Vali Acc: 0.247 Test Loss: 1.417 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1285858154296875
Epoch: 10, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.414 Vali Acc: 0.259 Test Loss: 1.414 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0501627922058105
Epoch: 11, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.424 Vali Acc: 0.259 Test Loss: 1.424 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0715668201446533
Epoch: 12, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.431 Vali Acc: 0.228 Test Loss: 1.431 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0116736888885498
Epoch: 13, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.478 Vali Acc: 0.274 Test Loss: 1.478 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273749).  Saving model ...
Epoch: 14 cost time: 1.0840213298797607
Epoch: 14, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.440 Vali Acc: 0.240 Test Loss: 1.440 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9842417240142822
Epoch: 15, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.464 Vali Acc: 0.255 Test Loss: 1.464 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0049080848693848
Epoch: 16, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.521 Vali Acc: 0.217 Test Loss: 1.521 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0806643962860107
Epoch: 17, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.515 Vali Acc: 0.236 Test Loss: 1.515 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2709362506866455
Epoch: 18, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.510 Vali Acc: 0.251 Test Loss: 1.510 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2507953643798828
Epoch: 19, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.510 Vali Acc: 0.243 Test Loss: 1.510 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1455411911010742
Epoch: 20, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.530 Vali Acc: 0.243 Test Loss: 1.530 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1197364330291748
Epoch: 21, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.519 Vali Acc: 0.232 Test Loss: 1.519 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1490614414215088
Epoch: 22, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.565 Vali Acc: 0.247 Test Loss: 1.565 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0510785579681396
Epoch: 23, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.549 Vali Acc: 0.259 Test Loss: 1.549 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 16116
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.944934606552124
Epoch: 1, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.406 Vali Acc: 0.251 Test Loss: 1.406 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.120469093322754
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.408 Vali Acc: 0.251 Test Loss: 1.408 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1027882099151611
Epoch: 3, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.405 Vali Acc: 0.274 Test Loss: 1.405 Test Acc: 0.274
Validation loss decreased (-0.250937 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 1.114910364151001
Epoch: 4, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.405 Vali Acc: 0.278 Test Loss: 1.405 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 0.9970762729644775
Epoch: 5, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.407 Vali Acc: 0.281 Test Loss: 1.407 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281355).  Saving model ...
Epoch: 6 cost time: 0.9963839054107666
Epoch: 6, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.403 Vali Acc: 0.289 Test Loss: 1.403 Test Acc: 0.289
Validation loss decreased (-0.281355 --> -0.288959).  Saving model ...
Epoch: 7 cost time: 1.122230052947998
Epoch: 7, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.414 Vali Acc: 0.274 Test Loss: 1.414 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9962999820709229
Epoch: 8, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.414 Vali Acc: 0.285 Test Loss: 1.414 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.014554500579834
Epoch: 9, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.412 Vali Acc: 0.274 Test Loss: 1.412 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1081175804138184
Epoch: 10, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.427 Vali Acc: 0.281 Test Loss: 1.427 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0466101169586182
Epoch: 11, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.455 Vali Acc: 0.274 Test Loss: 1.455 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9730520248413086
Epoch: 12, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.422 Vali Acc: 0.289 Test Loss: 1.422 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1358635425567627
Epoch: 13, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.433 Vali Acc: 0.270 Test Loss: 1.433 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1105573177337646
Epoch: 14, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.431 Vali Acc: 0.259 Test Loss: 1.431 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0688819885253906
Epoch: 15, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.448 Vali Acc: 0.274 Test Loss: 1.448 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.051605463027954
Epoch: 16, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.456 Vali Acc: 0.243 Test Loss: 1.456 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 16356
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.824127435684204
Epoch: 1, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.398 Vali Acc: 0.262 Test Loss: 1.398 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.1775686740875244
Epoch: 2, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.382 Vali Acc: 0.270 Test Loss: 1.382 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 1.027031660079956
Epoch: 3, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.393 Vali Acc: 0.281 Test Loss: 1.393 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 1.0378894805908203
Epoch: 4, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.390 Vali Acc: 0.243 Test Loss: 1.390 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.085777997970581
Epoch: 5, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.251 Test Loss: 1.387 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.040165662765503
Epoch: 6, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.384 Vali Acc: 0.228 Test Loss: 1.384 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.128889560699463
Epoch: 7, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.232 Test Loss: 1.386 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.011075735092163
Epoch: 8, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.399 Vali Acc: 0.243 Test Loss: 1.399 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9058358669281006
Epoch: 9, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.394 Vali Acc: 0.304 Test Loss: 1.394 Test Acc: 0.304
Validation loss decreased (-0.281355 --> -0.304169).  Saving model ...
Epoch: 10 cost time: 0.977388858795166
Epoch: 10, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.405 Vali Acc: 0.224 Test Loss: 1.405 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.922839879989624
Epoch: 11, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.417 Vali Acc: 0.255 Test Loss: 1.417 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9481775760650635
Epoch: 12, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.422 Vali Acc: 0.262 Test Loss: 1.422 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9795186519622803
Epoch: 13, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.426 Vali Acc: 0.240 Test Loss: 1.426 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1051783561706543
Epoch: 14, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.426 Vali Acc: 0.221 Test Loss: 1.426 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2555525302886963
Epoch: 15, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.447 Vali Acc: 0.247 Test Loss: 1.447 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0694429874420166
Epoch: 16, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.447 Vali Acc: 0.243 Test Loss: 1.447 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.028883457183838
Epoch: 17, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.501 Vali Acc: 0.270 Test Loss: 1.501 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0266318321228027
Epoch: 18, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.459 Vali Acc: 0.255 Test Loss: 1.459 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1456663608551025
Epoch: 19, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.485 Vali Acc: 0.278 Test Loss: 1.485 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 16996
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.89619517326355
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.404 Vali Acc: 0.247 Test Loss: 1.404 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.9991300106048584
Epoch: 2, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.421 Vali Acc: 0.228 Test Loss: 1.421 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1157779693603516
Epoch: 3, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.411 Vali Acc: 0.228 Test Loss: 1.411 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.107534646987915
Epoch: 4, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.418 Vali Acc: 0.228 Test Loss: 1.418 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2614946365356445
Epoch: 5, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.406 Vali Acc: 0.251 Test Loss: 1.406 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250937).  Saving model ...
Epoch: 6 cost time: 1.1360445022583008
Epoch: 6, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.421 Vali Acc: 0.240 Test Loss: 1.421 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1074726581573486
Epoch: 7, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.424 Vali Acc: 0.217 Test Loss: 1.424 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.946906328201294
Epoch: 8, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.429 Vali Acc: 0.236 Test Loss: 1.429 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9424126148223877
Epoch: 9, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.444 Vali Acc: 0.247 Test Loss: 1.444 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1066501140594482
Epoch: 10, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.430 Vali Acc: 0.228 Test Loss: 1.430 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0826821327209473
Epoch: 11, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.459 Vali Acc: 0.232 Test Loss: 1.459 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0553386211395264
Epoch: 12, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.467 Vali Acc: 0.224 Test Loss: 1.467 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.141423225402832
Epoch: 13, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.496 Vali Acc: 0.232 Test Loss: 1.496 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1259279251098633
Epoch: 14, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.502 Vali Acc: 0.228 Test Loss: 1.502 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0556941032409668
Epoch: 15, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.501 Vali Acc: 0.228 Test Loss: 1.501 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df256_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2509505703422053
model parameter : 18004
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.94801926612854
Epoch: 1, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.399 Vali Acc: 0.243 Test Loss: 1.399 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.1190268993377686
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.399 Vali Acc: 0.270 Test Loss: 1.399 Test Acc: 0.270
Validation loss decreased (-0.243332 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 1.0616254806518555
Epoch: 3, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.423 Vali Acc: 0.274 Test Loss: 1.423 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 0.9824283123016357
Epoch: 4, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.410 Vali Acc: 0.251 Test Loss: 1.410 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9540045261383057
Epoch: 5, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.411 Vali Acc: 0.262 Test Loss: 1.411 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9951016902923584
Epoch: 6, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.697 Vali Acc: 0.251 Test Loss: 1.697 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.07541823387146
Epoch: 7, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.405 Vali Acc: 0.266 Test Loss: 1.405 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.978804349899292
Epoch: 8, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.531 Vali Acc: 0.274 Test Loss: 1.531 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0255217552185059
Epoch: 9, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.502 Vali Acc: 0.251 Test Loss: 1.502 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.118985652923584
Epoch: 10, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.469 Vali Acc: 0.274 Test Loss: 1.469 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.089289903640747
Epoch: 11, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.593 Vali Acc: 0.224 Test Loss: 1.593 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1231026649475098
Epoch: 12, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.517 Vali Acc: 0.255 Test Loss: 1.517 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0737698078155518
Epoch: 13, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.465 Vali Acc: 0.259 Test Loss: 1.465 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 21300
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7055485248565674
Epoch: 1, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.389 Vali Acc: 0.278 Test Loss: 1.389 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 0.9459936618804932
Epoch: 2, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.394 Vali Acc: 0.255 Test Loss: 1.394 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0044989585876465
Epoch: 3, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0698373317718506
Epoch: 4, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.405 Vali Acc: 0.304 Test Loss: 1.405 Test Acc: 0.304
Validation loss decreased (-0.277553 --> -0.304168).  Saving model ...
Epoch: 5 cost time: 1.0452687740325928
Epoch: 5, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.385 Vali Acc: 0.259 Test Loss: 1.385 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0631818771362305
Epoch: 6, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.078110933303833
Epoch: 7, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.401 Vali Acc: 0.270 Test Loss: 1.401 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.247312068939209
Epoch: 8, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.417 Vali Acc: 0.259 Test Loss: 1.417 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0840754508972168
Epoch: 9, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.000636339187622
Epoch: 10, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.455 Vali Acc: 0.262 Test Loss: 1.455 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0395450592041016
Epoch: 11, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.414 Vali Acc: 0.270 Test Loss: 1.414 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0447900295257568
Epoch: 12, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.469 Vali Acc: 0.262 Test Loss: 1.469 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9811403751373291
Epoch: 13, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.432 Vali Acc: 0.236 Test Loss: 1.432 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0002636909484863
Epoch: 14, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.486 Vali Acc: 0.251 Test Loss: 1.486 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 14324
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.222356081008911
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.400 Vali Acc: 0.266 Test Loss: 1.400 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 1.0588388442993164
Epoch: 2, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.408 Vali Acc: 0.285 Test Loss: 1.408 Test Acc: 0.285
Validation loss decreased (-0.266146 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 0.9104034900665283
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8826065063476562
Epoch: 4, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.407 Vali Acc: 0.274 Test Loss: 1.407 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8988103866577148
Epoch: 5, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.399 Vali Acc: 0.278 Test Loss: 1.399 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9422159194946289
Epoch: 6, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9558391571044922
Epoch: 7, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.400 Vali Acc: 0.262 Test Loss: 1.400 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9732937812805176
Epoch: 8, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.419 Vali Acc: 0.247 Test Loss: 1.419 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9361121654510498
Epoch: 9, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.411 Vali Acc: 0.270 Test Loss: 1.411 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0793280601501465
Epoch: 10, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.438 Vali Acc: 0.278 Test Loss: 1.438 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0313019752502441
Epoch: 11, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.433 Vali Acc: 0.259 Test Loss: 1.433 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1211583614349365
Epoch: 12, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.441 Vali Acc: 0.251 Test Loss: 1.441 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 12532
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9458882808685303
Epoch: 1, Steps: 17 | Train Loss: 1.611 Vali Loss: 1.420 Vali Acc: 0.262 Test Loss: 1.420 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.0101299285888672
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.411 Vali Acc: 0.221 Test Loss: 1.411 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0029680728912354
Epoch: 3, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.404 Vali Acc: 0.247 Test Loss: 1.404 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9370338916778564
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.400 Vali Acc: 0.251 Test Loss: 1.400 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9385755062103271
Epoch: 5, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.410 Vali Acc: 0.251 Test Loss: 1.410 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9514811038970947
Epoch: 6, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.400 Vali Acc: 0.217 Test Loss: 1.400 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0473721027374268
Epoch: 7, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.400 Vali Acc: 0.232 Test Loss: 1.400 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.021486520767212
Epoch: 8, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.415 Vali Acc: 0.247 Test Loss: 1.415 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0294666290283203
Epoch: 9, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.402 Vali Acc: 0.278 Test Loss: 1.402 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277553).  Saving model ...
Epoch: 10 cost time: 1.1042823791503906
Epoch: 10, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.412 Vali Acc: 0.259 Test Loss: 1.412 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0437710285186768
Epoch: 11, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.422 Vali Acc: 0.262 Test Loss: 1.422 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9357743263244629
Epoch: 12, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.415 Vali Acc: 0.255 Test Loss: 1.415 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1212780475616455
Epoch: 13, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.420 Vali Acc: 0.270 Test Loss: 1.420 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.962627649307251
Epoch: 14, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.430 Vali Acc: 0.247 Test Loss: 1.430 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9587771892547607
Epoch: 15, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.437 Vali Acc: 0.247 Test Loss: 1.437 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9819080829620361
Epoch: 16, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.439 Vali Acc: 0.228 Test Loss: 1.439 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.094428300857544
Epoch: 17, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.448 Vali Acc: 0.247 Test Loss: 1.448 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.11395263671875
Epoch: 18, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.507 Vali Acc: 0.270 Test Loss: 1.507 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0705327987670898
Epoch: 19, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.468 Vali Acc: 0.259 Test Loss: 1.468 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 11892
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1372244358062744
Epoch: 1, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.1305575370788574
Epoch: 2, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.394 Vali Acc: 0.255 Test Loss: 1.394 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1102802753448486
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.404 Vali Acc: 0.259 Test Loss: 1.404 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0492568016052246
Epoch: 4, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.401 Vali Acc: 0.300 Test Loss: 1.401 Test Acc: 0.300
Validation loss decreased (-0.269948 --> -0.300366).  Saving model ...
Epoch: 5 cost time: 0.8743641376495361
Epoch: 5, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.393 Vali Acc: 0.251 Test Loss: 1.393 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1125972270965576
Epoch: 6, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.402 Vali Acc: 0.240 Test Loss: 1.402 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9326603412628174
Epoch: 7, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.404 Vali Acc: 0.285 Test Loss: 1.404 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0675408840179443
Epoch: 8, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.405 Vali Acc: 0.255 Test Loss: 1.405 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.91133713722229
Epoch: 9, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.408 Vali Acc: 0.285 Test Loss: 1.408 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0698091983795166
Epoch: 10, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.416 Vali Acc: 0.270 Test Loss: 1.416 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.009826421737671
Epoch: 11, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.412 Vali Acc: 0.251 Test Loss: 1.412 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8981192111968994
Epoch: 12, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.421 Vali Acc: 0.304 Test Loss: 1.421 Test Acc: 0.304
Validation loss decreased (-0.300366 --> -0.304168).  Saving model ...
Epoch: 13 cost time: 1.0509941577911377
Epoch: 13, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.439 Vali Acc: 0.281 Test Loss: 1.439 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0576980113983154
Epoch: 14, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.438 Vali Acc: 0.266 Test Loss: 1.438 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.017974853515625
Epoch: 15, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.454 Vali Acc: 0.270 Test Loss: 1.454 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0010967254638672
Epoch: 16, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.463 Vali Acc: 0.247 Test Loss: 1.463 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0593440532684326
Epoch: 17, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.491 Vali Acc: 0.262 Test Loss: 1.491 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0582892894744873
Epoch: 18, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.473 Vali Acc: 0.247 Test Loss: 1.473 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2605476379394531
Epoch: 19, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.491 Vali Acc: 0.278 Test Loss: 1.491 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.106262445449829
Epoch: 20, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.500 Vali Acc: 0.262 Test Loss: 1.500 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.254265308380127
Epoch: 21, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.502 Vali Acc: 0.255 Test Loss: 1.502 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1764187812805176
Epoch: 22, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.549 Vali Acc: 0.255 Test Loss: 1.549 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 12132
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9560670852661133
Epoch: 1, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.418 Vali Acc: 0.228 Test Loss: 1.418 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 1.2022783756256104
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.412 Vali Acc: 0.224 Test Loss: 1.412 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.188662052154541
Epoch: 3, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.404 Vali Acc: 0.236 Test Loss: 1.404 Test Acc: 0.236
Validation loss decreased (-0.228123 --> -0.235727).  Saving model ...
Epoch: 4 cost time: 1.0606410503387451
Epoch: 4, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.402 Vali Acc: 0.259 Test Loss: 1.402 Test Acc: 0.259
Validation loss decreased (-0.235727 --> -0.258541).  Saving model ...
Epoch: 5 cost time: 1.0727171897888184
Epoch: 5, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.403 Vali Acc: 0.255 Test Loss: 1.403 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0197691917419434
Epoch: 6, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.409 Vali Acc: 0.262 Test Loss: 1.409 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 7 cost time: 1.0330665111541748
Epoch: 7, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.403 Vali Acc: 0.251 Test Loss: 1.403 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9114360809326172
Epoch: 8, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.408 Vali Acc: 0.236 Test Loss: 1.408 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0416648387908936
Epoch: 9, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.405 Vali Acc: 0.247 Test Loss: 1.405 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0592164993286133
Epoch: 10, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.416 Vali Acc: 0.293 Test Loss: 1.416 Test Acc: 0.293
Validation loss decreased (-0.262343 --> -0.292762).  Saving model ...
Epoch: 11 cost time: 1.1693451404571533
Epoch: 11, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.404 Vali Acc: 0.247 Test Loss: 1.404 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1011841297149658
Epoch: 12, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.410 Vali Acc: 0.278 Test Loss: 1.410 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0040597915649414
Epoch: 13, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.424 Vali Acc: 0.236 Test Loss: 1.424 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1486139297485352
Epoch: 14, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.428 Vali Acc: 0.270 Test Loss: 1.428 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9997744560241699
Epoch: 15, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.414 Vali Acc: 0.259 Test Loss: 1.414 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0505809783935547
Epoch: 16, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.429 Vali Acc: 0.262 Test Loss: 1.429 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.137847661972046
Epoch: 17, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.432 Vali Acc: 0.259 Test Loss: 1.432 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0819311141967773
Epoch: 18, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.422 Vali Acc: 0.270 Test Loss: 1.422 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0818965435028076
Epoch: 19, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.424 Vali Acc: 0.270 Test Loss: 1.424 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1167685985565186
Epoch: 20, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.441 Vali Acc: 0.255 Test Loss: 1.441 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 12772
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.931342363357544
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.412 Vali Acc: 0.262 Test Loss: 1.412 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 0.9535276889801025
Epoch: 2, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.401 Vali Acc: 0.274 Test Loss: 1.401 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 1.105510950088501
Epoch: 3, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.392 Vali Acc: 0.274 Test Loss: 1.392 Test Acc: 0.274
Validation loss decreased (-0.273750 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 1.0173659324645996
Epoch: 4, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.395 Vali Acc: 0.278 Test Loss: 1.395 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277553).  Saving model ...
Epoch: 5 cost time: 1.2303454875946045
Epoch: 5, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.403 Vali Acc: 0.247 Test Loss: 1.403 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.208956003189087
Epoch: 6, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.404 Vali Acc: 0.308 Test Loss: 1.404 Test Acc: 0.308
Validation loss decreased (-0.277553 --> -0.307971).  Saving model ...
Epoch: 7 cost time: 1.071702241897583
Epoch: 7, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.400 Vali Acc: 0.251 Test Loss: 1.400 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1768109798431396
Epoch: 8, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.408 Vali Acc: 0.259 Test Loss: 1.408 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1131203174591064
Epoch: 9, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.409 Vali Acc: 0.274 Test Loss: 1.409 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1910178661346436
Epoch: 10, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.437 Vali Acc: 0.278 Test Loss: 1.437 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.112419605255127
Epoch: 11, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.422 Vali Acc: 0.255 Test Loss: 1.422 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0569195747375488
Epoch: 12, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.424 Vali Acc: 0.255 Test Loss: 1.424 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0929718017578125
Epoch: 13, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.448 Vali Acc: 0.236 Test Loss: 1.448 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1469480991363525
Epoch: 14, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.431 Vali Acc: 0.243 Test Loss: 1.431 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.088317632675171
Epoch: 15, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.430 Vali Acc: 0.243 Test Loss: 1.430 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.129265546798706
Epoch: 16, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.434 Vali Acc: 0.251 Test Loss: 1.434 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df128_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 13780
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps44_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.988436460494995
Epoch: 1, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.415 Vali Acc: 0.259 Test Loss: 1.415 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.091912031173706
Epoch: 2, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.418 Vali Acc: 0.255 Test Loss: 1.418 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.077324390411377
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.440 Vali Acc: 0.274 Test Loss: 1.440 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 1.0778350830078125
Epoch: 4, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.400 Vali Acc: 0.293 Test Loss: 1.400 Test Acc: 0.293
Validation loss decreased (-0.273750 --> -0.292762).  Saving model ...
Epoch: 5 cost time: 1.103168249130249
Epoch: 5, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.446 Vali Acc: 0.247 Test Loss: 1.446 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2362935543060303
Epoch: 6, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.398 Vali Acc: 0.281 Test Loss: 1.398 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1368637084960938
Epoch: 7, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.478 Vali Acc: 0.251 Test Loss: 1.478 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0513536930084229
Epoch: 8, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.402 Vali Acc: 0.297 Test Loss: 1.402 Test Acc: 0.297
Validation loss decreased (-0.292762 --> -0.296564).  Saving model ...
Epoch: 9 cost time: 1.0888538360595703
Epoch: 9, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.450 Vali Acc: 0.293 Test Loss: 1.450 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1932692527770996
Epoch: 10, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.474 Vali Acc: 0.259 Test Loss: 1.474 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.205289602279663
Epoch: 11, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.449 Vali Acc: 0.262 Test Loss: 1.449 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1184184551239014
Epoch: 12, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.493 Vali Acc: 0.285 Test Loss: 1.493 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0428698062896729
Epoch: 13, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.485 Vali Acc: 0.285 Test Loss: 1.485 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2489030361175537
Epoch: 14, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.476 Vali Acc: 0.285 Test Loss: 1.476 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2009153366088867
Epoch: 15, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.675 Vali Acc: 0.255 Test Loss: 1.675 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0738253593444824
Epoch: 16, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.567 Vali Acc: 0.270 Test Loss: 1.567 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1133196353912354
Epoch: 17, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.540 Vali Acc: 0.270 Test Loss: 1.540 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.962038516998291
Epoch: 18, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.492 Vali Acc: 0.278 Test Loss: 1.492 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps44_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 19188
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9849514961242676
Epoch: 1, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.407 Vali Acc: 0.243 Test Loss: 1.407 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.2782442569732666
Epoch: 2, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.398 Vali Acc: 0.217 Test Loss: 1.398 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1252820491790771
Epoch: 3, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.408 Vali Acc: 0.228 Test Loss: 1.408 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.252181053161621
Epoch: 4, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.398 Vali Acc: 0.217 Test Loss: 1.398 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1376094818115234
Epoch: 5, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.411 Vali Acc: 0.236 Test Loss: 1.411 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2472033500671387
Epoch: 6, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.393 Vali Acc: 0.198 Test Loss: 1.393 Test Acc: 0.198
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1880340576171875
Epoch: 7, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.420 Vali Acc: 0.251 Test Loss: 1.420 Test Acc: 0.251
Validation loss decreased (-0.243332 --> -0.250936).  Saving model ...
Epoch: 8 cost time: 1.1969168186187744
Epoch: 8, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.412 Vali Acc: 0.221 Test Loss: 1.412 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2175145149230957
Epoch: 9, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.437 Vali Acc: 0.247 Test Loss: 1.437 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0014009475708008
Epoch: 10, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.419 Vali Acc: 0.274 Test Loss: 1.419 Test Acc: 0.274
Validation loss decreased (-0.250936 --> -0.273750).  Saving model ...
Epoch: 11 cost time: 1.180088758468628
Epoch: 11, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.416 Vali Acc: 0.266 Test Loss: 1.416 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.241011619567871
Epoch: 12, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.458 Vali Acc: 0.285 Test Loss: 1.458 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285157).  Saving model ...
Epoch: 13 cost time: 1.1683673858642578
Epoch: 13, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.424 Vali Acc: 0.247 Test Loss: 1.424 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2060134410858154
Epoch: 14, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.427 Vali Acc: 0.255 Test Loss: 1.427 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.108123779296875
Epoch: 15, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.461 Vali Acc: 0.240 Test Loss: 1.461 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0638415813446045
Epoch: 16, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.492 Vali Acc: 0.262 Test Loss: 1.492 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3425085544586182
Epoch: 17, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.490 Vali Acc: 0.293 Test Loss: 1.490 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292761).  Saving model ...
Epoch: 18 cost time: 1.0976665019989014
Epoch: 18, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.542 Vali Acc: 0.243 Test Loss: 1.542 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.091968297958374
Epoch: 19, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.522 Vali Acc: 0.266 Test Loss: 1.522 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0555098056793213
Epoch: 20, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.460 Vali Acc: 0.259 Test Loss: 1.460 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.218923807144165
Epoch: 21, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.630 Vali Acc: 0.270 Test Loss: 1.630 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.186220645904541
Epoch: 22, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.505 Vali Acc: 0.243 Test Loss: 1.505 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1189920902252197
Epoch: 23, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.485 Vali Acc: 0.270 Test Loss: 1.485 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1843769550323486
Epoch: 24, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.654 Vali Acc: 0.243 Test Loss: 1.654 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.136002779006958
Epoch: 25, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.516 Vali Acc: 0.236 Test Loss: 1.516 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.025360345840454
Epoch: 26, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.521 Vali Acc: 0.240 Test Loss: 1.521 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0817198753356934
Epoch: 27, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.535 Vali Acc: 0.243 Test Loss: 1.535 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 12212
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7201390266418457
Epoch: 1, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.433 Vali Acc: 0.243 Test Loss: 1.433 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 0.9311871528625488
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.414 Vali Acc: 0.224 Test Loss: 1.414 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.057116985321045
Epoch: 3, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.420 Vali Acc: 0.224 Test Loss: 1.420 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0764310359954834
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.410 Vali Acc: 0.243 Test Loss: 1.410 Test Acc: 0.243
Validation loss decreased (-0.243332 --> -0.243332).  Saving model ...
Epoch: 5 cost time: 1.1102526187896729
Epoch: 5, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.414 Vali Acc: 0.243 Test Loss: 1.414 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0153110027313232
Epoch: 6, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.417 Vali Acc: 0.236 Test Loss: 1.417 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2274587154388428
Epoch: 7, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.409 Vali Acc: 0.259 Test Loss: 1.409 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258541).  Saving model ...
Epoch: 8 cost time: 1.1604290008544922
Epoch: 8, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.416 Vali Acc: 0.274 Test Loss: 1.416 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 9 cost time: 0.9905173778533936
Epoch: 9, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.425 Vali Acc: 0.213 Test Loss: 1.425 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9956870079040527
Epoch: 10, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.440 Vali Acc: 0.232 Test Loss: 1.440 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.065863847732544
Epoch: 11, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.452 Vali Acc: 0.243 Test Loss: 1.452 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0447561740875244
Epoch: 12, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.442 Vali Acc: 0.270 Test Loss: 1.442 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1144013404846191
Epoch: 13, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.482 Vali Acc: 0.240 Test Loss: 1.482 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1089739799499512
Epoch: 14, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.477 Vali Acc: 0.243 Test Loss: 1.477 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1390490531921387
Epoch: 15, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.470 Vali Acc: 0.236 Test Loss: 1.470 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1323599815368652
Epoch: 16, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.510 Vali Acc: 0.251 Test Loss: 1.510 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2209999561309814
Epoch: 17, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.486 Vali Acc: 0.243 Test Loss: 1.486 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2062506675720215
Epoch: 18, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.494 Vali Acc: 0.259 Test Loss: 1.494 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 10420
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7359111309051514
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.407 Vali Acc: 0.251 Test Loss: 1.407 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.216271162033081
Epoch: 2, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.399 Vali Acc: 0.243 Test Loss: 1.399 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0393564701080322
Epoch: 3, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.399 Vali Acc: 0.255 Test Loss: 1.399 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254739).  Saving model ...
Epoch: 4 cost time: 1.0366618633270264
Epoch: 4, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.406 Vali Acc: 0.247 Test Loss: 1.406 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9739794731140137
Epoch: 5, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.399 Vali Acc: 0.293 Test Loss: 1.399 Test Acc: 0.293
Validation loss decreased (-0.254739 --> -0.292762).  Saving model ...
Epoch: 6 cost time: 1.0667691230773926
Epoch: 6, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.401 Vali Acc: 0.270 Test Loss: 1.401 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.14113450050354
Epoch: 7, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.422 Vali Acc: 0.228 Test Loss: 1.422 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.124072551727295
Epoch: 8, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.406 Vali Acc: 0.270 Test Loss: 1.406 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2218120098114014
Epoch: 9, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.410 Vali Acc: 0.247 Test Loss: 1.410 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0525789260864258
Epoch: 10, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0721914768218994
Epoch: 11, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.425 Vali Acc: 0.293 Test Loss: 1.425 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2076468467712402
Epoch: 12, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.420 Vali Acc: 0.259 Test Loss: 1.420 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1399948596954346
Epoch: 13, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.446 Vali Acc: 0.270 Test Loss: 1.446 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.220412015914917
Epoch: 14, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.428 Vali Acc: 0.213 Test Loss: 1.428 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2040867805480957
Epoch: 15, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.449 Vali Acc: 0.270 Test Loss: 1.449 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 9780
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps263_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.997943639755249
Epoch: 1, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.420 Vali Acc: 0.278 Test Loss: 1.420 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 1.074761152267456
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.401 Vali Acc: 0.255 Test Loss: 1.401 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0393247604370117
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1250834465026855
Epoch: 4, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.401 Vali Acc: 0.255 Test Loss: 1.401 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1214828491210938
Epoch: 5, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.392 Vali Acc: 0.243 Test Loss: 1.392 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1164884567260742
Epoch: 6, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.401 Vali Acc: 0.262 Test Loss: 1.401 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0488886833190918
Epoch: 7, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.394 Vali Acc: 0.278 Test Loss: 1.394 Test Acc: 0.278
Validation loss decreased (-0.277552 --> -0.277553).  Saving model ...
Epoch: 8 cost time: 1.0773100852966309
Epoch: 8, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.399 Vali Acc: 0.270 Test Loss: 1.399 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2068898677825928
Epoch: 9, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.394 Vali Acc: 0.228 Test Loss: 1.394 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1502799987792969
Epoch: 10, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.408 Vali Acc: 0.221 Test Loss: 1.408 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1797926425933838
Epoch: 11, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.396 Vali Acc: 0.262 Test Loss: 1.396 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0356881618499756
Epoch: 12, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.399 Vali Acc: 0.243 Test Loss: 1.399 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.043431043624878
Epoch: 13, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.415 Vali Acc: 0.221 Test Loss: 1.415 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0186994075775146
Epoch: 14, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.408 Vali Acc: 0.228 Test Loss: 1.408 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0214004516601562
Epoch: 15, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.425 Vali Acc: 0.281 Test Loss: 1.425 Test Acc: 0.281
Validation loss decreased (-0.277553 --> -0.281355).  Saving model ...
Epoch: 16 cost time: 1.1048572063446045
Epoch: 16, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.425 Vali Acc: 0.251 Test Loss: 1.425 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0194740295410156
Epoch: 17, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.429 Vali Acc: 0.221 Test Loss: 1.429 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0575201511383057
Epoch: 18, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.440 Vali Acc: 0.228 Test Loss: 1.440 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1788570880889893
Epoch: 19, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.465 Vali Acc: 0.259 Test Loss: 1.465 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0193395614624023
Epoch: 20, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.482 Vali Acc: 0.240 Test Loss: 1.482 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2196218967437744
Epoch: 21, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.489 Vali Acc: 0.259 Test Loss: 1.489 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0977702140808105
Epoch: 22, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.493 Vali Acc: 0.247 Test Loss: 1.493 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1808404922485352
Epoch: 23, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.472 Vali Acc: 0.240 Test Loss: 1.472 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1390902996063232
Epoch: 24, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.502 Vali Acc: 0.270 Test Loss: 1.502 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2002589702606201
Epoch: 25, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.479 Vali Acc: 0.262 Test Loss: 1.479 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps263_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 10020
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.93178653717041
Epoch: 1, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.416 Vali Acc: 0.240 Test Loss: 1.416 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.1260521411895752
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.407 Vali Acc: 0.209 Test Loss: 1.407 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3391942977905273
Epoch: 3, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.418 Vali Acc: 0.221 Test Loss: 1.418 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0595214366912842
Epoch: 4, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.410 Vali Acc: 0.228 Test Loss: 1.410 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2545721530914307
Epoch: 5, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.407 Vali Acc: 0.243 Test Loss: 1.407 Test Acc: 0.243
Validation loss decreased (-0.239530 --> -0.243332).  Saving model ...
Epoch: 6 cost time: 1.252357006072998
Epoch: 6, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.409 Vali Acc: 0.224 Test Loss: 1.409 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.102449655532837
Epoch: 7, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.402 Vali Acc: 0.236 Test Loss: 1.402 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0922925472259521
Epoch: 8, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.402 Vali Acc: 0.213 Test Loss: 1.402 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1293401718139648
Epoch: 9, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.404 Vali Acc: 0.240 Test Loss: 1.404 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0925750732421875
Epoch: 10, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.409 Vali Acc: 0.240 Test Loss: 1.409 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0515706539154053
Epoch: 11, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.427 Vali Acc: 0.251 Test Loss: 1.427 Test Acc: 0.251
Validation loss decreased (-0.243332 --> -0.250936).  Saving model ...
Epoch: 12 cost time: 1.082050085067749
Epoch: 12, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.434 Vali Acc: 0.209 Test Loss: 1.434 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0587351322174072
Epoch: 13, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.431 Vali Acc: 0.236 Test Loss: 1.431 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1425700187683105
Epoch: 14, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.441 Vali Acc: 0.247 Test Loss: 1.441 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1563942432403564
Epoch: 15, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.441 Vali Acc: 0.228 Test Loss: 1.441 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.060464859008789
Epoch: 16, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.460 Vali Acc: 0.247 Test Loss: 1.460 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1854658126831055
Epoch: 17, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.499 Vali Acc: 0.224 Test Loss: 1.499 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1686797142028809
Epoch: 18, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.477 Vali Acc: 0.240 Test Loss: 1.477 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3107995986938477
Epoch: 19, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.493 Vali Acc: 0.217 Test Loss: 1.493 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1016135215759277
Epoch: 20, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.491 Vali Acc: 0.213 Test Loss: 1.491 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1650218963623047
Epoch: 21, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.508 Vali Acc: 0.236 Test Loss: 1.508 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2509505703422053
model parameter : 10660
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps438_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9114370346069336
Epoch: 1, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.403 Vali Acc: 0.243 Test Loss: 1.403 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.0333104133605957
Epoch: 2, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.385 Vali Acc: 0.297 Test Loss: 1.385 Test Acc: 0.297
Validation loss decreased (-0.243332 --> -0.296564).  Saving model ...
Epoch: 3 cost time: 1.0874099731445312
Epoch: 3, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.384 Vali Acc: 0.285 Test Loss: 1.384 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0831494331359863
Epoch: 4, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.388 Vali Acc: 0.232 Test Loss: 1.388 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0785133838653564
Epoch: 5, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.388 Vali Acc: 0.270 Test Loss: 1.388 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9989795684814453
Epoch: 6, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.379 Vali Acc: 0.281 Test Loss: 1.379 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.012317180633545
Epoch: 7, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.377 Vali Acc: 0.278 Test Loss: 1.377 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2024617195129395
Epoch: 8, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.381 Vali Acc: 0.281 Test Loss: 1.381 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0962550640106201
Epoch: 9, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.387 Vali Acc: 0.270 Test Loss: 1.387 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1206927299499512
Epoch: 10, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.390 Vali Acc: 0.270 Test Loss: 1.390 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1068732738494873
Epoch: 11, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.400 Vali Acc: 0.266 Test Loss: 1.400 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0966036319732666
Epoch: 12, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.397 Vali Acc: 0.278 Test Loss: 1.397 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_PatchTST_UEA_ftM_sl1751_ll0_pl0_el1_dm16_nh4_df64_ps438_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 11668
model size : 0.36MB
