Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.3731536865234375
Epoch: 1, Steps: 12 | Train Loss: 1.699 Vali Loss: 0.951 Vali Acc: 0.600 Test Loss: 0.951 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 4.030749797821045
Epoch: 2, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.709 Vali Acc: 0.728 Test Loss: 0.709 Test Acc: 0.728
Validation loss decreased (-0.599990 --> -0.727771).  Saving model ...
Epoch: 3 cost time: 3.6800737380981445
Epoch: 3, Steps: 12 | Train Loss: 0.606 Vali Loss: 1.601 Vali Acc: 0.678 Test Loss: 1.601 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.654341220855713
Epoch: 4, Steps: 12 | Train Loss: 0.504 Vali Loss: 1.221 Vali Acc: 0.744 Test Loss: 1.221 Test Acc: 0.744
Validation loss decreased (-0.727771 --> -0.744432).  Saving model ...
Epoch: 5 cost time: 3.612330198287964
Epoch: 5, Steps: 12 | Train Loss: 0.270 Vali Loss: 1.076 Vali Acc: 0.744 Test Loss: 1.076 Test Acc: 0.744
Validation loss decreased (-0.744432 --> -0.744434).  Saving model ...
Epoch: 6 cost time: 3.5178985595703125
Epoch: 6, Steps: 12 | Train Loss: 0.370 Vali Loss: 1.511 Vali Acc: 0.739 Test Loss: 1.511 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0926268100738525
Epoch: 7, Steps: 12 | Train Loss: 0.261 Vali Loss: 2.382 Vali Acc: 0.728 Test Loss: 2.382 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.006401538848877
Epoch: 8, Steps: 12 | Train Loss: 0.253 Vali Loss: 2.008 Vali Acc: 0.711 Test Loss: 2.008 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.5923664569854736
Epoch: 9, Steps: 12 | Train Loss: 0.286 Vali Loss: 2.732 Vali Acc: 0.761 Test Loss: 2.732 Test Acc: 0.761
Validation loss decreased (-0.744434 --> -0.761084).  Saving model ...
Epoch: 10 cost time: 3.2249252796173096
Epoch: 10, Steps: 12 | Train Loss: 0.198 Vali Loss: 3.141 Vali Acc: 0.683 Test Loss: 3.141 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5296385288238525
Epoch: 11, Steps: 12 | Train Loss: 0.308 Vali Loss: 3.162 Vali Acc: 0.750 Test Loss: 3.162 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5029280185699463
Epoch: 12, Steps: 12 | Train Loss: 0.370 Vali Loss: 2.537 Vali Acc: 0.717 Test Loss: 2.537 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4739739894866943
Epoch: 13, Steps: 12 | Train Loss: 0.900 Vali Loss: 5.403 Vali Acc: 0.639 Test Loss: 5.403 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.394327163696289
Epoch: 14, Steps: 12 | Train Loss: 0.146 Vali Loss: 2.276 Vali Acc: 0.800 Test Loss: 2.276 Test Acc: 0.800
Validation loss decreased (-0.761084 --> -0.799977).  Saving model ...
Epoch: 15 cost time: 3.8328089714050293
Epoch: 15, Steps: 12 | Train Loss: 0.124 Vali Loss: 2.936 Vali Acc: 0.789 Test Loss: 2.936 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.438453197479248
Epoch: 16, Steps: 12 | Train Loss: 0.213 Vali Loss: 3.131 Vali Acc: 0.767 Test Loss: 3.131 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3634116649627686
Epoch: 17, Steps: 12 | Train Loss: 0.098 Vali Loss: 5.497 Vali Acc: 0.728 Test Loss: 5.497 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.620086431503296
Epoch: 18, Steps: 12 | Train Loss: 0.364 Vali Loss: 4.494 Vali Acc: 0.756 Test Loss: 4.494 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.3388636112213135
Epoch: 19, Steps: 12 | Train Loss: 0.059 Vali Loss: 3.934 Vali Acc: 0.778 Test Loss: 3.934 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.194827079772949
Epoch: 20, Steps: 12 | Train Loss: 0.262 Vali Loss: 4.343 Vali Acc: 0.733 Test Loss: 4.343 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.4110512733459473
Epoch: 21, Steps: 12 | Train Loss: 0.073 Vali Loss: 5.362 Vali Acc: 0.739 Test Loss: 5.362 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.30137038230896
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 4.963 Vali Acc: 0.756 Test Loss: 4.963 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9441311359405518
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 3.689 Vali Acc: 0.772 Test Loss: 3.689 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.0515453815460205
Epoch: 24, Steps: 12 | Train Loss: 0.169 Vali Loss: 3.815 Vali Acc: 0.772 Test Loss: 3.815 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 1337990
model size : 7.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.336073398590088
Epoch: 1, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.025 Vali Acc: 0.589 Test Loss: 1.025 Test Acc: 0.589
Validation loss decreased (inf --> -0.588879).  Saving model ...
Epoch: 2 cost time: 2.484240770339966
Epoch: 2, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.898 Vali Acc: 0.667 Test Loss: 0.898 Test Acc: 0.667
Validation loss decreased (-0.588879 --> -0.666658).  Saving model ...
Epoch: 3 cost time: 2.539792537689209
Epoch: 3, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.842 Vali Acc: 0.722 Test Loss: 0.842 Test Acc: 0.722
Validation loss decreased (-0.666658 --> -0.722214).  Saving model ...
Epoch: 4 cost time: 2.527158737182617
Epoch: 4, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.953 Vali Acc: 0.722 Test Loss: 0.953 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5410845279693604
Epoch: 5, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.720 Vali Acc: 0.778 Test Loss: 0.720 Test Acc: 0.778
Validation loss decreased (-0.722214 --> -0.777771).  Saving model ...
Epoch: 6 cost time: 2.35843825340271
Epoch: 6, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.999 Vali Acc: 0.744 Test Loss: 0.999 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4189822673797607
Epoch: 7, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.049 Vali Acc: 0.750 Test Loss: 1.049 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3152873516082764
Epoch: 8, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.450 Vali Acc: 0.750 Test Loss: 1.450 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.307199001312256
Epoch: 9, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.314 Vali Acc: 0.750 Test Loss: 1.314 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0578842163085938
Epoch: 10, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.530 Vali Acc: 0.750 Test Loss: 1.530 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.270693778991699
Epoch: 11, Steps: 12 | Train Loss: 0.107 Vali Loss: 2.519 Vali Acc: 0.733 Test Loss: 2.519 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3015148639678955
Epoch: 12, Steps: 12 | Train Loss: 0.181 Vali Loss: 2.163 Vali Acc: 0.728 Test Loss: 2.163 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.384204626083374
Epoch: 13, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.749 Vali Acc: 0.761 Test Loss: 1.749 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4169106483459473
Epoch: 14, Steps: 12 | Train Loss: 0.074 Vali Loss: 2.739 Vali Acc: 0.717 Test Loss: 2.739 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4901089668273926
Epoch: 15, Steps: 12 | Train Loss: 0.406 Vali Loss: 2.436 Vali Acc: 0.739 Test Loss: 2.436 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 877318
model size : 5.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.421010732650757
Epoch: 1, Steps: 12 | Train Loss: 1.704 Vali Loss: 0.987 Vali Acc: 0.583 Test Loss: 0.987 Test Acc: 0.583
Validation loss decreased (inf --> -0.583323).  Saving model ...
Epoch: 2 cost time: 2.5559096336364746
Epoch: 2, Steps: 12 | Train Loss: 0.914 Vali Loss: 0.773 Vali Acc: 0.683 Test Loss: 0.773 Test Acc: 0.683
Validation loss decreased (-0.583323 --> -0.683326).  Saving model ...
Epoch: 3 cost time: 2.358327865600586
Epoch: 3, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.984 Vali Acc: 0.689 Test Loss: 0.984 Test Acc: 0.689
Validation loss decreased (-0.683326 --> -0.688879).  Saving model ...
Epoch: 4 cost time: 2.3811135292053223
Epoch: 4, Steps: 12 | Train Loss: 0.308 Vali Loss: 1.228 Vali Acc: 0.711 Test Loss: 1.228 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711099).  Saving model ...
Epoch: 5 cost time: 2.47749662399292
Epoch: 5, Steps: 12 | Train Loss: 0.234 Vali Loss: 1.368 Vali Acc: 0.711 Test Loss: 1.368 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.460402011871338
Epoch: 6, Steps: 12 | Train Loss: 0.165 Vali Loss: 1.178 Vali Acc: 0.733 Test Loss: 1.178 Test Acc: 0.733
Validation loss decreased (-0.711099 --> -0.733322).  Saving model ...
Epoch: 7 cost time: 2.3735222816467285
Epoch: 7, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.311 Vali Acc: 0.744 Test Loss: 1.311 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744431).  Saving model ...
Epoch: 8 cost time: 2.4976799488067627
Epoch: 8, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.098 Vali Acc: 0.783 Test Loss: 1.098 Test Acc: 0.783
Validation loss decreased (-0.744431 --> -0.783322).  Saving model ...
Epoch: 9 cost time: 2.3677978515625
Epoch: 9, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.527 Vali Acc: 0.739 Test Loss: 1.527 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5632925033569336
Epoch: 10, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.965 Vali Acc: 0.700 Test Loss: 1.965 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.546412229537964
Epoch: 11, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.673 Vali Acc: 0.750 Test Loss: 1.673 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2498767375946045
Epoch: 12, Steps: 12 | Train Loss: 0.068 Vali Loss: 2.161 Vali Acc: 0.733 Test Loss: 2.161 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.106580972671509
Epoch: 13, Steps: 12 | Train Loss: 0.054 Vali Loss: 2.151 Vali Acc: 0.711 Test Loss: 2.151 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0897209644317627
Epoch: 14, Steps: 12 | Train Loss: 0.076 Vali Loss: 2.026 Vali Acc: 0.739 Test Loss: 2.026 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0611586570739746
Epoch: 15, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.960 Vali Acc: 0.728 Test Loss: 1.960 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.258967399597168
Epoch: 16, Steps: 12 | Train Loss: 0.011 Vali Loss: 2.518 Vali Acc: 0.744 Test Loss: 2.518 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0134363174438477
Epoch: 17, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.909 Vali Acc: 0.772 Test Loss: 1.909 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1329751014709473
Epoch: 18, Steps: 12 | Train Loss: 0.022 Vali Loss: 2.045 Vali Acc: 0.761 Test Loss: 2.045 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 859014
model size : 5.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5654091835021973
Epoch: 1, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.004 Vali Acc: 0.633 Test Loss: 1.004 Test Acc: 0.633
Validation loss decreased (inf --> -0.633323).  Saving model ...
Epoch: 2 cost time: 1.8272433280944824
Epoch: 2, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.809 Vali Acc: 0.656 Test Loss: 0.809 Test Acc: 0.656
Validation loss decreased (-0.633323 --> -0.655547).  Saving model ...
Epoch: 3 cost time: 1.3570334911346436
Epoch: 3, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.629 Vali Acc: 0.744 Test Loss: 0.629 Test Acc: 0.744
Validation loss decreased (-0.655547 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 1.3726232051849365
Epoch: 4, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.715 Vali Acc: 0.756 Test Loss: 0.715 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755548).  Saving model ...
Epoch: 5 cost time: 1.4818718433380127
Epoch: 5, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.756 Vali Acc: 0.750 Test Loss: 0.756 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.719425916671753
Epoch: 6, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.659 Vali Acc: 0.800 Test Loss: 0.659 Test Acc: 0.800
Validation loss decreased (-0.755548 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 1.6381821632385254
Epoch: 7, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.540 Vali Acc: 0.711 Test Loss: 1.540 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.663125991821289
Epoch: 8, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.997 Vali Acc: 0.728 Test Loss: 0.997 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7394435405731201
Epoch: 9, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.051 Vali Acc: 0.767 Test Loss: 1.051 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7122864723205566
Epoch: 10, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.304 Vali Acc: 0.750 Test Loss: 1.304 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.782081127166748
Epoch: 11, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.174 Vali Acc: 0.744 Test Loss: 1.174 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8073017597198486
Epoch: 12, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.733 Vali Acc: 0.756 Test Loss: 1.733 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8006768226623535
Epoch: 13, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.436 Vali Acc: 0.739 Test Loss: 1.436 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.817375659942627
Epoch: 14, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.391 Vali Acc: 0.739 Test Loss: 1.391 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8985307216644287
Epoch: 15, Steps: 12 | Train Loss: 0.059 Vali Loss: 2.058 Vali Acc: 0.683 Test Loss: 2.058 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6130578517913818
Epoch: 16, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.363 Vali Acc: 0.739 Test Loss: 1.363 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 711814
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.246866464614868
Epoch: 1, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.106 Vali Acc: 0.561 Test Loss: 1.106 Test Acc: 0.561
Validation loss decreased (inf --> -0.561100).  Saving model ...
Epoch: 2 cost time: 1.7707388401031494
Epoch: 2, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.855 Vali Acc: 0.661 Test Loss: 0.855 Test Acc: 0.661
Validation loss decreased (-0.561100 --> -0.661103).  Saving model ...
Epoch: 3 cost time: 1.0769073963165283
Epoch: 3, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.684 Vali Acc: 0.733 Test Loss: 0.684 Test Acc: 0.733
Validation loss decreased (-0.661103 --> -0.733326).  Saving model ...
Epoch: 4 cost time: 1.6847331523895264
Epoch: 4, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.727 Vali Acc: 0.739 Test Loss: 0.727 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 1.773022174835205
Epoch: 5, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.784 Vali Acc: 0.722 Test Loss: 0.784 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7917780876159668
Epoch: 6, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.829 Vali Acc: 0.739 Test Loss: 0.829 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7270503044128418
Epoch: 7, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 1.577685832977295
Epoch: 8, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.073 Vali Acc: 0.739 Test Loss: 1.073 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4636948108673096
Epoch: 9, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.987 Vali Acc: 0.728 Test Loss: 0.987 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.852161169052124
Epoch: 10, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.113 Vali Acc: 0.717 Test Loss: 1.113 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6546680927276611
Epoch: 11, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.123 Vali Acc: 0.750 Test Loss: 1.123 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5341622829437256
Epoch: 12, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.183 Vali Acc: 0.711 Test Loss: 1.183 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.541938066482544
Epoch: 13, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.000 Vali Acc: 0.744 Test Loss: 1.000 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.819657564163208
Epoch: 14, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.097 Vali Acc: 0.778 Test Loss: 1.097 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777767).  Saving model ...
Epoch: 15 cost time: 1.7549066543579102
Epoch: 15, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.163 Vali Acc: 0.756 Test Loss: 1.163 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6802475452423096
Epoch: 16, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.148 Vali Acc: 0.783 Test Loss: 1.148 Test Acc: 0.783
Validation loss decreased (-0.777767 --> -0.783322).  Saving model ...
Epoch: 17 cost time: 1.5972723960876465
Epoch: 17, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.057 Vali Acc: 0.750 Test Loss: 1.057 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6201121807098389
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.131 Vali Acc: 0.767 Test Loss: 1.131 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5914053916931152
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.283 Vali Acc: 0.767 Test Loss: 1.283 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4297585487365723
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.198 Vali Acc: 0.767 Test Loss: 1.198 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5230696201324463
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.219 Vali Acc: 0.750 Test Loss: 1.219 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.512808084487915
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.761 Test Loss: 1.226 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6223094463348389
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.761 Test Loss: 1.232 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.692007303237915
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.756 Test Loss: 1.237 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6584773063659668
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.767 Test Loss: 1.236 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7098734378814697
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.761 Test Loss: 1.229 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 619910
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2570607662200928
Epoch: 1, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.226 Vali Acc: 0.556 Test Loss: 1.226 Test Acc: 0.556
Validation loss decreased (inf --> -0.555543).  Saving model ...
Epoch: 2 cost time: 1.5341565608978271
Epoch: 2, Steps: 12 | Train Loss: 0.991 Vali Loss: 0.858 Vali Acc: 0.611 Test Loss: 0.858 Test Acc: 0.611
Validation loss decreased (-0.555543 --> -0.611103).  Saving model ...
Epoch: 3 cost time: 1.380798101425171
Epoch: 3, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.680 Vali Acc: 0.744 Test Loss: 0.680 Test Acc: 0.744
Validation loss decreased (-0.611103 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 1.4540495872497559
Epoch: 4, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.733 Vali Acc: 0.711 Test Loss: 0.733 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3893191814422607
Epoch: 5, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.729 Vali Acc: 0.739 Test Loss: 0.729 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.479294776916504
Epoch: 6, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.713 Vali Acc: 0.739 Test Loss: 0.713 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3334975242614746
Epoch: 7, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.750 Vali Acc: 0.744 Test Loss: 0.750 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3646824359893799
Epoch: 8, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.905 Vali Acc: 0.739 Test Loss: 0.905 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3839588165283203
Epoch: 9, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.867 Vali Acc: 0.756 Test Loss: 0.867 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 1.4975361824035645
Epoch: 10, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.799 Vali Acc: 0.733 Test Loss: 0.799 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4532346725463867
Epoch: 11, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.843 Vali Acc: 0.778 Test Loss: 0.843 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777769).  Saving model ...
Epoch: 12 cost time: 1.0473659038543701
Epoch: 12, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.102 Vali Acc: 0.733 Test Loss: 1.102 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5432605743408203
Epoch: 13, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.937 Vali Acc: 0.767 Test Loss: 0.937 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.504577398300171
Epoch: 14, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.137 Vali Acc: 0.728 Test Loss: 1.137 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5305840969085693
Epoch: 15, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.198 Vali Acc: 0.739 Test Loss: 1.198 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.549208402633667
Epoch: 16, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.045 Vali Acc: 0.733 Test Loss: 1.045 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7009522914886475
Epoch: 17, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7034087181091309
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.016 Vali Acc: 0.744 Test Loss: 1.016 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6290268898010254
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.011 Vali Acc: 0.744 Test Loss: 1.011 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8856372833251953
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.016 Vali Acc: 0.744 Test Loss: 1.016 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.621063232421875
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.052 Vali Acc: 0.750 Test Loss: 1.052 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 546566
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.415653705596924
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.316 Vali Acc: 0.578 Test Loss: 1.316 Test Acc: 0.578
Validation loss decreased (inf --> -0.577765).  Saving model ...
Epoch: 2 cost time: 1.575037956237793
Epoch: 2, Steps: 12 | Train Loss: 1.018 Vali Loss: 0.856 Vali Acc: 0.633 Test Loss: 0.856 Test Acc: 0.633
Validation loss decreased (-0.577765 --> -0.633325).  Saving model ...
Epoch: 3 cost time: 1.623518943786621
Epoch: 3, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.728 Vali Acc: 0.744 Test Loss: 0.728 Test Acc: 0.744
Validation loss decreased (-0.633325 --> -0.744437).  Saving model ...
Epoch: 4 cost time: 1.537996768951416
Epoch: 4, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.670 Vali Acc: 0.744 Test Loss: 0.670 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744438).  Saving model ...
Epoch: 5 cost time: 1.7066006660461426
Epoch: 5, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.754 Vali Acc: 0.728 Test Loss: 0.754 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.69718599319458
Epoch: 6, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.624 Vali Acc: 0.778 Test Loss: 0.624 Test Acc: 0.778
Validation loss decreased (-0.744438 --> -0.777772).  Saving model ...
Epoch: 7 cost time: 1.7583444118499756
Epoch: 7, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.706 Vali Acc: 0.733 Test Loss: 0.706 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6405668258666992
Epoch: 8, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.787 Vali Acc: 0.756 Test Loss: 0.787 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6536865234375
Epoch: 9, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.800 Vali Acc: 0.761 Test Loss: 0.800 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4864857196807861
Epoch: 10, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.922 Vali Acc: 0.744 Test Loss: 0.922 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5647950172424316
Epoch: 11, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.784 Vali Acc: 0.739 Test Loss: 0.784 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.600435495376587
Epoch: 12, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.797 Vali Acc: 0.772 Test Loss: 0.797 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6789660453796387
Epoch: 13, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.896 Vali Acc: 0.761 Test Loss: 0.896 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8079524040222168
Epoch: 14, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.792 Vali Acc: 0.783 Test Loss: 0.792 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783325).  Saving model ...
Epoch: 15 cost time: 1.5888028144836426
Epoch: 15, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.000 Vali Acc: 0.767 Test Loss: 1.000 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6266672611236572
Epoch: 16, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.960 Vali Acc: 0.756 Test Loss: 0.960 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5991301536560059
Epoch: 17, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.957 Vali Acc: 0.744 Test Loss: 0.957 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4820199012756348
Epoch: 18, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.974 Vali Acc: 0.744 Test Loss: 0.974 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5150277614593506
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.024 Vali Acc: 0.733 Test Loss: 1.024 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.58253812789917
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.965 Vali Acc: 0.756 Test Loss: 0.965 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.722438097000122
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.753829002380371
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.966 Vali Acc: 0.756 Test Loss: 0.966 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7624449729919434
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.973 Vali Acc: 0.761 Test Loss: 0.973 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5637516975402832
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.973 Vali Acc: 0.767 Test Loss: 0.973 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 528390
model size : 4.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.558744192123413
Epoch: 1, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.053 Vali Acc: 0.594 Test Loss: 1.053 Test Acc: 0.594
Validation loss decreased (inf --> -0.594434).  Saving model ...
Epoch: 2 cost time: 3.108206272125244
Epoch: 2, Steps: 12 | Train Loss: 0.776 Vali Loss: 1.271 Vali Acc: 0.644 Test Loss: 1.271 Test Acc: 0.644
Validation loss decreased (-0.594434 --> -0.644432).  Saving model ...
Epoch: 3 cost time: 2.7589972019195557
Epoch: 3, Steps: 12 | Train Loss: 0.645 Vali Loss: 2.385 Vali Acc: 0.694 Test Loss: 2.385 Test Acc: 0.694
Validation loss decreased (-0.644432 --> -0.694421).  Saving model ...
Epoch: 4 cost time: 2.894962787628174
Epoch: 4, Steps: 12 | Train Loss: 1.304 Vali Loss: 2.513 Vali Acc: 0.667 Test Loss: 2.513 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7045254707336426
Epoch: 5, Steps: 12 | Train Loss: 0.932 Vali Loss: 2.228 Vali Acc: 0.700 Test Loss: 2.228 Test Acc: 0.700
Validation loss decreased (-0.694421 --> -0.699978).  Saving model ...
Epoch: 6 cost time: 3.0287299156188965
Epoch: 6, Steps: 12 | Train Loss: 0.916 Vali Loss: 2.211 Vali Acc: 0.661 Test Loss: 2.211 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9918527603149414
Epoch: 7, Steps: 12 | Train Loss: 0.252 Vali Loss: 2.507 Vali Acc: 0.711 Test Loss: 2.507 Test Acc: 0.711
Validation loss decreased (-0.699978 --> -0.711086).  Saving model ...
Epoch: 8 cost time: 2.9623799324035645
Epoch: 8, Steps: 12 | Train Loss: 0.239 Vali Loss: 2.534 Vali Acc: 0.722 Test Loss: 2.534 Test Acc: 0.722
Validation loss decreased (-0.711086 --> -0.722197).  Saving model ...
Epoch: 9 cost time: 3.0501115322113037
Epoch: 9, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.754 Vali Acc: 0.767 Test Loss: 1.754 Test Acc: 0.767
Validation loss decreased (-0.722197 --> -0.766649).  Saving model ...
Epoch: 10 cost time: 2.7393720149993896
Epoch: 10, Steps: 12 | Train Loss: 0.356 Vali Loss: 3.928 Vali Acc: 0.667 Test Loss: 3.928 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.95072865486145
Epoch: 11, Steps: 12 | Train Loss: 0.639 Vali Loss: 3.355 Vali Acc: 0.750 Test Loss: 3.355 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.876469373703003
Epoch: 12, Steps: 12 | Train Loss: 0.234 Vali Loss: 3.862 Vali Acc: 0.761 Test Loss: 3.862 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.936891794204712
Epoch: 13, Steps: 12 | Train Loss: 0.038 Vali Loss: 3.085 Vali Acc: 0.733 Test Loss: 3.085 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.959144353866577
Epoch: 14, Steps: 12 | Train Loss: 0.011 Vali Loss: 4.078 Vali Acc: 0.733 Test Loss: 4.078 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.853555202484131
Epoch: 15, Steps: 12 | Train Loss: 0.013 Vali Loss: 4.790 Vali Acc: 0.683 Test Loss: 4.790 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.935973882675171
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 3.370 Vali Acc: 0.744 Test Loss: 3.370 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.0243074893951416
Epoch: 17, Steps: 12 | Train Loss: 0.065 Vali Loss: 4.193 Vali Acc: 0.678 Test Loss: 4.193 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.973828077316284
Epoch: 18, Steps: 12 | Train Loss: 0.141 Vali Loss: 5.875 Vali Acc: 0.744 Test Loss: 5.875 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.9699862003326416
Epoch: 19, Steps: 12 | Train Loss: 0.006 Vali Loss: 4.095 Vali Acc: 0.761 Test Loss: 4.095 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 1239302
model size : 7.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7029025554656982
Epoch: 1, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.013 Vali Acc: 0.578 Test Loss: 1.013 Test Acc: 0.578
Validation loss decreased (inf --> -0.577768).  Saving model ...
Epoch: 2 cost time: 2.2848329544067383
Epoch: 2, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.798 Vali Acc: 0.683 Test Loss: 0.798 Test Acc: 0.683
Validation loss decreased (-0.577768 --> -0.683325).  Saving model ...
Epoch: 3 cost time: 2.027405023574829
Epoch: 3, Steps: 12 | Train Loss: 0.680 Vali Loss: 1.389 Vali Acc: 0.661 Test Loss: 1.389 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.984100103378296
Epoch: 4, Steps: 12 | Train Loss: 0.338 Vali Loss: 1.442 Vali Acc: 0.706 Test Loss: 1.442 Test Acc: 0.706
Validation loss decreased (-0.683325 --> -0.705541).  Saving model ...
Epoch: 5 cost time: 2.020968198776245
Epoch: 5, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.876 Vali Acc: 0.756 Test Loss: 0.876 Test Acc: 0.756
Validation loss decreased (-0.705541 --> -0.755547).  Saving model ...
Epoch: 6 cost time: 2.0127415657043457
Epoch: 6, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.093 Vali Acc: 0.733 Test Loss: 1.093 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.060741901397705
Epoch: 7, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.037 Vali Acc: 0.756 Test Loss: 1.037 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.123112201690674
Epoch: 8, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.145 Vali Acc: 0.761 Test Loss: 1.145 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761100).  Saving model ...
Epoch: 9 cost time: 2.0459611415863037
Epoch: 9, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.550 Vali Acc: 0.739 Test Loss: 1.550 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0463759899139404
Epoch: 10, Steps: 12 | Train Loss: 0.166 Vali Loss: 1.584 Vali Acc: 0.739 Test Loss: 1.584 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9205853939056396
Epoch: 11, Steps: 12 | Train Loss: 0.184 Vali Loss: 1.335 Vali Acc: 0.767 Test Loss: 1.335 Test Acc: 0.767
Validation loss decreased (-0.761100 --> -0.766653).  Saving model ...
Epoch: 12 cost time: 2.004539966583252
Epoch: 12, Steps: 12 | Train Loss: 0.187 Vali Loss: 2.248 Vali Acc: 0.733 Test Loss: 2.248 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9994235038757324
Epoch: 13, Steps: 12 | Train Loss: 0.027 Vali Loss: 2.154 Vali Acc: 0.761 Test Loss: 2.154 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.088697910308838
Epoch: 14, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.468 Vali Acc: 0.789 Test Loss: 1.468 Test Acc: 0.789
Validation loss decreased (-0.766653 --> -0.788874).  Saving model ...
Epoch: 15 cost time: 2.008514881134033
Epoch: 15, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.929 Vali Acc: 0.717 Test Loss: 1.929 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.059420585632324
Epoch: 16, Steps: 12 | Train Loss: 0.018 Vali Loss: 2.997 Vali Acc: 0.700 Test Loss: 2.997 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9579179286956787
Epoch: 17, Steps: 12 | Train Loss: 0.306 Vali Loss: 2.652 Vali Acc: 0.694 Test Loss: 2.652 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0165226459503174
Epoch: 18, Steps: 12 | Train Loss: 0.168 Vali Loss: 2.672 Vali Acc: 0.728 Test Loss: 2.672 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8999266624450684
Epoch: 19, Steps: 12 | Train Loss: 0.046 Vali Loss: 2.878 Vali Acc: 0.756 Test Loss: 2.878 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0034422874450684
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 2.431 Vali Acc: 0.733 Test Loss: 2.431 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9318537712097168
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.626 Vali Acc: 0.750 Test Loss: 2.626 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2880947589874268
Epoch: 22, Steps: 12 | Train Loss: 0.005 Vali Loss: 2.660 Vali Acc: 0.739 Test Loss: 2.660 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.554013967514038
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.688 Vali Acc: 0.744 Test Loss: 2.688 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.4101462364196777
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 2.728 Vali Acc: 0.744 Test Loss: 2.728 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 778630
model size : 5.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.222979784011841
Epoch: 1, Steps: 12 | Train Loss: 1.464 Vali Loss: 0.958 Vali Acc: 0.628 Test Loss: 0.958 Test Acc: 0.628
Validation loss decreased (inf --> -0.627768).  Saving model ...
Epoch: 2 cost time: 2.434504747390747
Epoch: 2, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.911 Vali Acc: 0.656 Test Loss: 0.911 Test Acc: 0.656
Validation loss decreased (-0.627768 --> -0.655546).  Saving model ...
Epoch: 3 cost time: 2.327639102935791
Epoch: 3, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.713 Vali Acc: 0.717 Test Loss: 0.713 Test Acc: 0.717
Validation loss decreased (-0.655546 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 2.184006929397583
Epoch: 4, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.884 Vali Acc: 0.700 Test Loss: 0.884 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2795331478118896
Epoch: 5, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.806 Vali Acc: 0.750 Test Loss: 0.806 Test Acc: 0.750
Validation loss decreased (-0.716660 --> -0.749992).  Saving model ...
Epoch: 6 cost time: 2.67842173576355
Epoch: 6, Steps: 12 | Train Loss: 0.177 Vali Loss: 1.174 Vali Acc: 0.744 Test Loss: 1.174 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.992037296295166
Epoch: 7, Steps: 12 | Train Loss: 0.259 Vali Loss: 1.859 Vali Acc: 0.711 Test Loss: 1.859 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.996809482574463
Epoch: 8, Steps: 12 | Train Loss: 0.349 Vali Loss: 1.655 Vali Acc: 0.706 Test Loss: 1.655 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9451589584350586
Epoch: 9, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.639 Vali Acc: 0.722 Test Loss: 1.639 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.00173020362854
Epoch: 10, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.532 Vali Acc: 0.728 Test Loss: 1.532 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.632190227508545
Epoch: 11, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.570 Vali Acc: 0.744 Test Loss: 1.570 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.293586492538452
Epoch: 12, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.878 Vali Acc: 0.711 Test Loss: 1.878 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.409475803375244
Epoch: 13, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.601 Vali Acc: 0.744 Test Loss: 1.601 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4350826740264893
Epoch: 14, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.772 Vali Acc: 0.728 Test Loss: 1.772 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.6192586421966553
Epoch: 15, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.859 Vali Acc: 0.728 Test Loss: 1.859 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.75
model parameter : 760326
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.476119756698608
Epoch: 1, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.038 Vali Acc: 0.578 Test Loss: 1.038 Test Acc: 0.578
Validation loss decreased (inf --> -0.577767).  Saving model ...
Epoch: 2 cost time: 2.117150068283081
Epoch: 2, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.079 Vali Acc: 0.622 Test Loss: 1.079 Test Acc: 0.622
Validation loss decreased (-0.577767 --> -0.622211).  Saving model ...
Epoch: 3 cost time: 2.140230655670166
Epoch: 3, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.793 Vali Acc: 0.689 Test Loss: 0.793 Test Acc: 0.689
Validation loss decreased (-0.622211 --> -0.688881).  Saving model ...
Epoch: 4 cost time: 2.3439252376556396
Epoch: 4, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.661 Vali Acc: 0.728 Test Loss: 0.661 Test Acc: 0.728
Validation loss decreased (-0.688881 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 2.3692641258239746
Epoch: 5, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.650 Vali Acc: 0.761 Test Loss: 0.650 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 2.4438107013702393
Epoch: 6, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.882 Vali Acc: 0.733 Test Loss: 0.882 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4642879962921143
Epoch: 7, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.828 Vali Acc: 0.756 Test Loss: 0.828 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.614442825317383
Epoch: 8, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.957 Vali Acc: 0.750 Test Loss: 0.957 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.587985038757324
Epoch: 9, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.878 Vali Acc: 0.778 Test Loss: 0.878 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777769).  Saving model ...
Epoch: 10 cost time: 2.5648229122161865
Epoch: 10, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.103 Vali Acc: 0.750 Test Loss: 1.103 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3386871814727783
Epoch: 11, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.106 Vali Acc: 0.750 Test Loss: 1.106 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0775303840637207
Epoch: 12, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.814 Vali Acc: 0.711 Test Loss: 1.814 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0303311347961426
Epoch: 13, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.249 Vali Acc: 0.778 Test Loss: 1.249 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.9767532348632812
Epoch: 14, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.006 Vali Acc: 0.767 Test Loss: 1.006 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.0478157997131348
Epoch: 15, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.221 Vali Acc: 0.778 Test Loss: 1.221 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.4079415798187256
Epoch: 16, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.309 Vali Acc: 0.783 Test Loss: 1.309 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783320).  Saving model ...
Epoch: 17 cost time: 2.3905651569366455
Epoch: 17, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.229 Vali Acc: 0.756 Test Loss: 1.229 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6449244022369385
Epoch: 18, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.132 Vali Acc: 0.783 Test Loss: 1.132 Test Acc: 0.783
Validation loss decreased (-0.783320 --> -0.783322).  Saving model ...
Epoch: 19 cost time: 2.5065834522247314
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.167 Vali Acc: 0.778 Test Loss: 1.167 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5712904930114746
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.222 Vali Acc: 0.756 Test Loss: 1.222 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0127835273742676
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.783 Test Loss: 1.218 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.100238561630249
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.778 Test Loss: 1.209 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.9488296508789062
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.772 Test Loss: 1.203 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.9020559787750244
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.772 Test Loss: 1.202 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.8962316513061523
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.772 Test Loss: 1.204 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.674654722213745
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.772 Test Loss: 1.210 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.0868892669677734
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.772 Test Loss: 1.214 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8526341915130615
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.772 Test Loss: 1.217 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 613126
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.158712863922119
Epoch: 1, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.151 Vali Acc: 0.556 Test Loss: 1.151 Test Acc: 0.556
Validation loss decreased (inf --> -0.555544).  Saving model ...
Epoch: 2 cost time: 2.5278351306915283
Epoch: 2, Steps: 12 | Train Loss: 0.902 Vali Loss: 0.888 Vali Acc: 0.617 Test Loss: 0.888 Test Acc: 0.617
Validation loss decreased (-0.555544 --> -0.616658).  Saving model ...
Epoch: 3 cost time: 2.455763578414917
Epoch: 3, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.721 Vali Acc: 0.728 Test Loss: 0.721 Test Acc: 0.728
Validation loss decreased (-0.616658 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 2.2494046688079834
Epoch: 4, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.787 Vali Acc: 0.739 Test Loss: 0.787 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738881).  Saving model ...
Epoch: 5 cost time: 2.345078945159912
Epoch: 5, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.754 Vali Acc: 0.722 Test Loss: 0.754 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4182562828063965
Epoch: 6, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.763 Vali Acc: 0.744 Test Loss: 0.763 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 2.2776105403900146
Epoch: 7, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.911 Vali Acc: 0.744 Test Loss: 0.911 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3879480361938477
Epoch: 8, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.908 Vali Acc: 0.761 Test Loss: 0.908 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761102).  Saving model ...
Epoch: 9 cost time: 1.6429693698883057
Epoch: 9, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.953 Vali Acc: 0.772 Test Loss: 0.953 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772213).  Saving model ...
Epoch: 10 cost time: 1.5926563739776611
Epoch: 10, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.047 Vali Acc: 0.722 Test Loss: 1.047 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6037817001342773
Epoch: 11, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.973 Vali Acc: 0.756 Test Loss: 0.973 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8594622611999512
Epoch: 12, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.397 Vali Acc: 0.761 Test Loss: 1.397 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1831860542297363
Epoch: 13, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.198 Vali Acc: 0.750 Test Loss: 1.198 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2466704845428467
Epoch: 14, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.123 Vali Acc: 0.739 Test Loss: 1.123 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.313499689102173
Epoch: 15, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.182 Vali Acc: 0.744 Test Loss: 1.182 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.18861985206604
Epoch: 16, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.076 Vali Acc: 0.767 Test Loss: 1.076 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.229938507080078
Epoch: 17, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.110 Vali Acc: 0.767 Test Loss: 1.110 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3476874828338623
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.167 Vali Acc: 0.761 Test Loss: 1.167 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.110700845718384
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.199 Vali Acc: 0.750 Test Loss: 1.199 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 521222
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.381681203842163
Epoch: 1, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.307 Vali Acc: 0.489 Test Loss: 1.307 Test Acc: 0.489
Validation loss decreased (inf --> -0.488876).  Saving model ...
Epoch: 2 cost time: 1.6084551811218262
Epoch: 2, Steps: 12 | Train Loss: 1.120 Vali Loss: 0.928 Vali Acc: 0.600 Test Loss: 0.928 Test Acc: 0.600
Validation loss decreased (-0.488876 --> -0.599991).  Saving model ...
Epoch: 3 cost time: 1.9259400367736816
Epoch: 3, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.715 Vali Acc: 0.683 Test Loss: 0.715 Test Acc: 0.683
Validation loss decreased (-0.599991 --> -0.683326).  Saving model ...
Epoch: 4 cost time: 1.9198896884918213
Epoch: 4, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.780 Vali Acc: 0.689 Test Loss: 0.780 Test Acc: 0.689
Validation loss decreased (-0.683326 --> -0.688881).  Saving model ...
Epoch: 5 cost time: 1.8540565967559814
Epoch: 5, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.721 Vali Acc: 0.733 Test Loss: 0.721 Test Acc: 0.733
Validation loss decreased (-0.688881 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 1.8026998043060303
Epoch: 6, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.741 Vali Acc: 0.717 Test Loss: 0.741 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.915440559387207
Epoch: 7, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.738 Vali Acc: 0.739 Test Loss: 0.738 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 8 cost time: 1.9893288612365723
Epoch: 8, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.776 Vali Acc: 0.756 Test Loss: 0.776 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755548).  Saving model ...
Epoch: 9 cost time: 1.902935266494751
Epoch: 9, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.745 Vali Acc: 0.744 Test Loss: 0.745 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2966203689575195
Epoch: 10, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.826 Vali Acc: 0.767 Test Loss: 0.826 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766658).  Saving model ...
Epoch: 11 cost time: 2.0749926567077637
Epoch: 11, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.902 Vali Acc: 0.733 Test Loss: 0.902 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2249104976654053
Epoch: 12, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.886 Vali Acc: 0.733 Test Loss: 0.886 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6976597309112549
Epoch: 13, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.853 Vali Acc: 0.761 Test Loss: 0.853 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.777829647064209
Epoch: 14, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.223 Vali Acc: 0.722 Test Loss: 1.223 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9251487255096436
Epoch: 15, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.897 Vali Acc: 0.772 Test Loss: 0.897 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772213).  Saving model ...
Epoch: 16 cost time: 2.3218207359313965
Epoch: 16, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.014 Vali Acc: 0.739 Test Loss: 1.014 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3025577068328857
Epoch: 17, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.072 Vali Acc: 0.761 Test Loss: 1.072 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1934192180633545
Epoch: 18, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.230 Vali Acc: 0.750 Test Loss: 1.230 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.286769151687622
Epoch: 19, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.095 Vali Acc: 0.756 Test Loss: 1.095 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1984341144561768
Epoch: 20, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.068 Vali Acc: 0.772 Test Loss: 1.068 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.5815155506134033
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.021 Vali Acc: 0.761 Test Loss: 1.021 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5624241828918457
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.039 Vali Acc: 0.756 Test Loss: 1.039 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7812047004699707
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.064 Vali Acc: 0.756 Test Loss: 1.064 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.5285377502441406
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.051 Vali Acc: 0.756 Test Loss: 1.051 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.4516146183013916
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.041 Vali Acc: 0.761 Test Loss: 1.041 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 447878
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.707062244415283
Epoch: 1, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.329 Vali Acc: 0.494 Test Loss: 1.329 Test Acc: 0.494
Validation loss decreased (inf --> -0.494431).  Saving model ...
Epoch: 2 cost time: 2.386542558670044
Epoch: 2, Steps: 12 | Train Loss: 1.030 Vali Loss: 0.919 Vali Acc: 0.606 Test Loss: 0.919 Test Acc: 0.606
Validation loss decreased (-0.494431 --> -0.605546).  Saving model ...
Epoch: 3 cost time: 2.6122634410858154
Epoch: 3, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.774 Vali Acc: 0.706 Test Loss: 0.774 Test Acc: 0.706
Validation loss decreased (-0.605546 --> -0.705548).  Saving model ...
Epoch: 4 cost time: 2.6117324829101562
Epoch: 4, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.620 Vali Acc: 0.750 Test Loss: 0.620 Test Acc: 0.750
Validation loss decreased (-0.705548 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 2.287508726119995
Epoch: 5, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.679 Vali Acc: 0.739 Test Loss: 0.679 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.382646322250366
Epoch: 6, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.678 Vali Acc: 0.739 Test Loss: 0.678 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6250152587890625
Epoch: 7, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.631 Vali Acc: 0.739 Test Loss: 0.631 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5351200103759766
Epoch: 8, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.705 Vali Acc: 0.744 Test Loss: 0.705 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3093793392181396
Epoch: 9, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.819 Vali Acc: 0.750 Test Loss: 0.819 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.336723566055298
Epoch: 10, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.836 Vali Acc: 0.733 Test Loss: 0.836 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.303273916244507
Epoch: 11, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.893 Vali Acc: 0.756 Test Loss: 0.893 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755547).  Saving model ...
Epoch: 12 cost time: 2.0914251804351807
Epoch: 12, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.919 Vali Acc: 0.767 Test Loss: 0.919 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766657).  Saving model ...
Epoch: 13 cost time: 2.136042833328247
Epoch: 13, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.825 Vali Acc: 0.744 Test Loss: 0.825 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.933903694152832
Epoch: 14, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.917 Vali Acc: 0.778 Test Loss: 0.917 Test Acc: 0.778
Validation loss decreased (-0.766657 --> -0.777769).  Saving model ...
Epoch: 15 cost time: 1.6806249618530273
Epoch: 15, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.004 Vali Acc: 0.744 Test Loss: 1.004 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9596426486968994
Epoch: 16, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.996 Vali Acc: 0.756 Test Loss: 0.996 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.043835401535034
Epoch: 17, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.955 Vali Acc: 0.756 Test Loss: 0.955 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.431623697280884
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.015 Vali Acc: 0.750 Test Loss: 1.015 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.304302453994751
Epoch: 19, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.003 Vali Acc: 0.750 Test Loss: 1.003 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.2694361209869385
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.061 Vali Acc: 0.739 Test Loss: 1.061 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3522045612335205
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.002 Vali Acc: 0.756 Test Loss: 1.002 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2983791828155518
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.761 Test Loss: 0.992 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1902806758880615
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.981 Vali Acc: 0.761 Test Loss: 0.981 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.105583667755127
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.986 Vali Acc: 0.756 Test Loss: 0.986 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 429702
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.695131063461304
Epoch: 1, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.012 Vali Acc: 0.572 Test Loss: 1.012 Test Acc: 0.572
Validation loss decreased (inf --> -0.572212).  Saving model ...
Epoch: 2 cost time: 2.664590358734131
Epoch: 2, Steps: 12 | Train Loss: 0.724 Vali Loss: 1.038 Vali Acc: 0.633 Test Loss: 1.038 Test Acc: 0.633
Validation loss decreased (-0.572212 --> -0.633323).  Saving model ...
Epoch: 3 cost time: 3.0052967071533203
Epoch: 3, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.915 Vali Acc: 0.733 Test Loss: 0.915 Test Acc: 0.733
Validation loss decreased (-0.633323 --> -0.733324).  Saving model ...
Epoch: 4 cost time: 3.351435899734497
Epoch: 4, Steps: 12 | Train Loss: 0.284 Vali Loss: 1.368 Vali Acc: 0.644 Test Loss: 1.368 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2262790203094482
Epoch: 5, Steps: 12 | Train Loss: 0.281 Vali Loss: 2.122 Vali Acc: 0.667 Test Loss: 2.122 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2807674407958984
Epoch: 6, Steps: 12 | Train Loss: 0.547 Vali Loss: 1.656 Vali Acc: 0.722 Test Loss: 1.656 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.440380811691284
Epoch: 7, Steps: 12 | Train Loss: 0.266 Vali Loss: 2.092 Vali Acc: 0.728 Test Loss: 2.092 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5045251846313477
Epoch: 8, Steps: 12 | Train Loss: 0.441 Vali Loss: 2.398 Vali Acc: 0.739 Test Loss: 2.398 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738865).  Saving model ...
Epoch: 9 cost time: 3.326955556869507
Epoch: 9, Steps: 12 | Train Loss: 0.458 Vali Loss: 2.687 Vali Acc: 0.761 Test Loss: 2.687 Test Acc: 0.761
Validation loss decreased (-0.738865 --> -0.761084).  Saving model ...
Epoch: 10 cost time: 3.272639036178589
Epoch: 10, Steps: 12 | Train Loss: 0.439 Vali Loss: 2.389 Vali Acc: 0.739 Test Loss: 2.389 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1818459033966064
Epoch: 11, Steps: 12 | Train Loss: 0.382 Vali Loss: 4.178 Vali Acc: 0.689 Test Loss: 4.178 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.088278293609619
Epoch: 12, Steps: 12 | Train Loss: 0.319 Vali Loss: 3.195 Vali Acc: 0.728 Test Loss: 3.195 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1685492992401123
Epoch: 13, Steps: 12 | Train Loss: 0.389 Vali Loss: 4.821 Vali Acc: 0.672 Test Loss: 4.821 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.020885467529297
Epoch: 14, Steps: 12 | Train Loss: 0.147 Vali Loss: 3.878 Vali Acc: 0.728 Test Loss: 3.878 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3230135440826416
Epoch: 15, Steps: 12 | Train Loss: 0.058 Vali Loss: 2.505 Vali Acc: 0.778 Test Loss: 2.505 Test Acc: 0.778
Validation loss decreased (-0.761084 --> -0.777753).  Saving model ...
Epoch: 16 cost time: 3.389071226119995
Epoch: 16, Steps: 12 | Train Loss: 0.042 Vali Loss: 4.161 Vali Acc: 0.722 Test Loss: 4.161 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3102900981903076
Epoch: 17, Steps: 12 | Train Loss: 0.199 Vali Loss: 5.431 Vali Acc: 0.683 Test Loss: 5.431 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1781225204467773
Epoch: 18, Steps: 12 | Train Loss: 0.127 Vali Loss: 6.310 Vali Acc: 0.722 Test Loss: 6.310 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.14078950881958
Epoch: 19, Steps: 12 | Train Loss: 0.197 Vali Loss: 4.805 Vali Acc: 0.767 Test Loss: 4.805 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.0559604167938232
Epoch: 20, Steps: 12 | Train Loss: 0.399 Vali Loss: 3.149 Vali Acc: 0.744 Test Loss: 3.149 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.549862861633301
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 3.745 Vali Acc: 0.761 Test Loss: 3.745 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.328554153442383
Epoch: 22, Steps: 12 | Train Loss: 0.154 Vali Loss: 3.974 Vali Acc: 0.778 Test Loss: 3.974 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.3212733268737793
Epoch: 23, Steps: 12 | Train Loss: 0.082 Vali Loss: 3.836 Vali Acc: 0.772 Test Loss: 3.836 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.2111549377441406
Epoch: 24, Steps: 12 | Train Loss: 0.190 Vali Loss: 4.785 Vali Acc: 0.778 Test Loss: 4.785 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.0315134525299072
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 6.424 Vali Acc: 0.750 Test Loss: 6.424 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 1189958
model size : 7.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9063093662261963
Epoch: 1, Steps: 12 | Train Loss: 1.532 Vali Loss: 0.928 Vali Acc: 0.617 Test Loss: 0.928 Test Acc: 0.617
Validation loss decreased (inf --> -0.616657).  Saving model ...
Epoch: 2 cost time: 2.164296865463257
Epoch: 2, Steps: 12 | Train Loss: 0.820 Vali Loss: 0.690 Vali Acc: 0.711 Test Loss: 0.690 Test Acc: 0.711
Validation loss decreased (-0.616657 --> -0.711104).  Saving model ...
Epoch: 3 cost time: 2.2933833599090576
Epoch: 3, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.855 Vali Acc: 0.700 Test Loss: 0.855 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3112452030181885
Epoch: 4, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.967 Vali Acc: 0.711 Test Loss: 0.967 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2666711807250977
Epoch: 5, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.959 Vali Acc: 0.733 Test Loss: 0.959 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733324).  Saving model ...
Epoch: 6 cost time: 2.2459280490875244
Epoch: 6, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.311 Vali Acc: 0.700 Test Loss: 1.311 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.073162317276001
Epoch: 7, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.004 Vali Acc: 0.761 Test Loss: 1.004 Test Acc: 0.761
Validation loss decreased (-0.733324 --> -0.761101).  Saving model ...
Epoch: 8 cost time: 1.9270188808441162
Epoch: 8, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.345 Vali Acc: 0.767 Test Loss: 1.345 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766653).  Saving model ...
Epoch: 9 cost time: 2.186978816986084
Epoch: 9, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.408 Vali Acc: 0.761 Test Loss: 1.408 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.011869192123413
Epoch: 10, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.309 Vali Acc: 0.778 Test Loss: 1.309 Test Acc: 0.778
Validation loss decreased (-0.766653 --> -0.777765).  Saving model ...
Epoch: 11 cost time: 2.034010171890259
Epoch: 11, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.487 Vali Acc: 0.761 Test Loss: 1.487 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.131577968597412
Epoch: 12, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.737 Vali Acc: 0.733 Test Loss: 1.737 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.110961675643921
Epoch: 13, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.661 Vali Acc: 0.756 Test Loss: 1.661 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.295318365097046
Epoch: 14, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.805 Vali Acc: 0.761 Test Loss: 1.805 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.198446273803711
Epoch: 15, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.961 Vali Acc: 0.772 Test Loss: 1.961 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.227931022644043
Epoch: 16, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.405 Vali Acc: 0.794 Test Loss: 1.405 Test Acc: 0.794
Validation loss decreased (-0.777765 --> -0.794430).  Saving model ...
Epoch: 17 cost time: 2.1779561042785645
Epoch: 17, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.506 Vali Acc: 0.800 Test Loss: 1.506 Test Acc: 0.800
Validation loss decreased (-0.794430 --> -0.799985).  Saving model ...
Epoch: 18 cost time: 2.26658034324646
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.693 Vali Acc: 0.783 Test Loss: 1.693 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3354592323303223
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 2.146 Vali Acc: 0.761 Test Loss: 2.146 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2398953437805176
Epoch: 20, Steps: 12 | Train Loss: 0.006 Vali Loss: 2.363 Vali Acc: 0.772 Test Loss: 2.363 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.184866189956665
Epoch: 21, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.949 Vali Acc: 0.789 Test Loss: 1.949 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.312880039215088
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 2.134 Vali Acc: 0.783 Test Loss: 2.134 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.1129510402679443
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 2.208 Vali Acc: 0.778 Test Loss: 2.208 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.194147825241089
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 2.236 Vali Acc: 0.761 Test Loss: 2.236 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.089691638946533
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 2.188 Vali Acc: 0.772 Test Loss: 2.188 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8344142436981201
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 2.155 Vali Acc: 0.778 Test Loss: 2.155 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.5701258182525635
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 2.155 Vali Acc: 0.778 Test Loss: 2.155 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 729286
model size : 5.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.253208160400391
Epoch: 1, Steps: 12 | Train Loss: 1.563 Vali Loss: 0.965 Vali Acc: 0.544 Test Loss: 0.965 Test Acc: 0.544
Validation loss decreased (inf --> -0.544435).  Saving model ...
Epoch: 2 cost time: 2.4881742000579834
Epoch: 2, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.762 Vali Acc: 0.689 Test Loss: 0.762 Test Acc: 0.689
Validation loss decreased (-0.544435 --> -0.688881).  Saving model ...
Epoch: 3 cost time: 2.2703301906585693
Epoch: 3, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.755 Vali Acc: 0.722 Test Loss: 0.755 Test Acc: 0.722
Validation loss decreased (-0.688881 --> -0.722215).  Saving model ...
Epoch: 4 cost time: 2.321145534515381
Epoch: 4, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.882 Vali Acc: 0.683 Test Loss: 0.882 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.422372817993164
Epoch: 5, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.008 Vali Acc: 0.744 Test Loss: 1.008 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744434).  Saving model ...
Epoch: 6 cost time: 2.286878824234009
Epoch: 6, Steps: 12 | Train Loss: 0.310 Vali Loss: 1.049 Vali Acc: 0.739 Test Loss: 1.049 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.251052141189575
Epoch: 7, Steps: 12 | Train Loss: 0.233 Vali Loss: 1.365 Vali Acc: 0.728 Test Loss: 1.365 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0578975677490234
Epoch: 8, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.451 Vali Acc: 0.717 Test Loss: 1.451 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.16853404045105
Epoch: 9, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.419 Vali Acc: 0.739 Test Loss: 1.419 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1400845050811768
Epoch: 10, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.538 Vali Acc: 0.756 Test Loss: 1.538 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755540).  Saving model ...
Epoch: 11 cost time: 2.532890796661377
Epoch: 11, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.179 Vali Acc: 0.783 Test Loss: 1.179 Test Acc: 0.783
Validation loss decreased (-0.755540 --> -0.783322).  Saving model ...
Epoch: 12 cost time: 2.393505334854126
Epoch: 12, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.537 Vali Acc: 0.733 Test Loss: 1.537 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.073906421661377
Epoch: 13, Steps: 12 | Train Loss: 0.210 Vali Loss: 2.234 Vali Acc: 0.728 Test Loss: 2.234 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0400490760803223
Epoch: 14, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.921 Vali Acc: 0.717 Test Loss: 1.921 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9012908935546875
Epoch: 15, Steps: 12 | Train Loss: 0.107 Vali Loss: 3.076 Vali Acc: 0.711 Test Loss: 3.076 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.064419984817505
Epoch: 16, Steps: 12 | Train Loss: 0.098 Vali Loss: 2.044 Vali Acc: 0.733 Test Loss: 2.044 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1048967838287354
Epoch: 17, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.881 Vali Acc: 0.767 Test Loss: 1.881 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.141956329345703
Epoch: 18, Steps: 12 | Train Loss: 0.156 Vali Loss: 2.639 Vali Acc: 0.750 Test Loss: 2.639 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1673994064331055
Epoch: 19, Steps: 12 | Train Loss: 0.018 Vali Loss: 2.442 Vali Acc: 0.744 Test Loss: 2.442 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2280120849609375
Epoch: 20, Steps: 12 | Train Loss: 0.074 Vali Loss: 2.054 Vali Acc: 0.739 Test Loss: 2.054 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9408924579620361
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 2.376 Vali Acc: 0.750 Test Loss: 2.376 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 710982
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.22168755531311
Epoch: 1, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.209 Vali Acc: 0.461 Test Loss: 1.209 Test Acc: 0.461
Validation loss decreased (inf --> -0.461099).  Saving model ...
Epoch: 2 cost time: 2.4097530841827393
Epoch: 2, Steps: 12 | Train Loss: 0.858 Vali Loss: 0.854 Vali Acc: 0.678 Test Loss: 0.854 Test Acc: 0.678
Validation loss decreased (-0.461099 --> -0.677769).  Saving model ...
Epoch: 3 cost time: 2.3347768783569336
Epoch: 3, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.648 Vali Acc: 0.728 Test Loss: 0.648 Test Acc: 0.728
Validation loss decreased (-0.677769 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 2.5945334434509277
Epoch: 4, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.786 Vali Acc: 0.717 Test Loss: 0.786 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5395631790161133
Epoch: 5, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.830 Vali Acc: 0.728 Test Loss: 0.830 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4430766105651855
Epoch: 6, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.953 Vali Acc: 0.722 Test Loss: 0.953 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5547280311584473
Epoch: 7, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.743 Vali Acc: 0.772 Test Loss: 0.743 Test Acc: 0.772
Validation loss decreased (-0.727771 --> -0.772215).  Saving model ...
Epoch: 8 cost time: 2.5484557151794434
Epoch: 8, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.912 Vali Acc: 0.750 Test Loss: 0.912 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0124073028564453
Epoch: 9, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.035 Vali Acc: 0.772 Test Loss: 1.035 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9654405117034912
Epoch: 10, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.874 Vali Acc: 0.778 Test Loss: 0.874 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 1.946065902709961
Epoch: 11, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.298 Vali Acc: 0.733 Test Loss: 1.298 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.953521490097046
Epoch: 12, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.607 Vali Acc: 0.733 Test Loss: 1.607 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.617204189300537
Epoch: 13, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.470 Vali Acc: 0.744 Test Loss: 1.470 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8069305419921875
Epoch: 14, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.550 Vali Acc: 0.728 Test Loss: 1.550 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.466564893722534
Epoch: 15, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.682 Vali Acc: 0.733 Test Loss: 1.682 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9911177158355713
Epoch: 16, Steps: 12 | Train Loss: 0.049 Vali Loss: 2.572 Vali Acc: 0.717 Test Loss: 2.572 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2241523265838623
Epoch: 17, Steps: 12 | Train Loss: 0.213 Vali Loss: 1.765 Vali Acc: 0.722 Test Loss: 1.765 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.6208019256591797
Epoch: 18, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.856 Vali Acc: 0.722 Test Loss: 1.856 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4861953258514404
Epoch: 19, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.798 Vali Acc: 0.711 Test Loss: 1.798 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.5166616439819336
Epoch: 20, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.715 Vali Acc: 0.728 Test Loss: 1.715 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 563782
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.335080146789551
Epoch: 1, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.134 Vali Acc: 0.578 Test Loss: 1.134 Test Acc: 0.578
Validation loss decreased (inf --> -0.577766).  Saving model ...
Epoch: 2 cost time: 2.2146999835968018
Epoch: 2, Steps: 12 | Train Loss: 0.931 Vali Loss: 0.849 Vali Acc: 0.628 Test Loss: 0.849 Test Acc: 0.628
Validation loss decreased (-0.577766 --> -0.627769).  Saving model ...
Epoch: 3 cost time: 2.2809793949127197
Epoch: 3, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.652 Vali Acc: 0.733 Test Loss: 0.652 Test Acc: 0.733
Validation loss decreased (-0.627769 --> -0.733327).  Saving model ...
Epoch: 4 cost time: 2.418518543243408
Epoch: 4, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.744 Vali Acc: 0.728 Test Loss: 0.744 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2831616401672363
Epoch: 5, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.811 Vali Acc: 0.744 Test Loss: 0.811 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744436).  Saving model ...
Epoch: 6 cost time: 2.2342593669891357
Epoch: 6, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.764 Vali Acc: 0.744 Test Loss: 0.764 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 2.287778854370117
Epoch: 7, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 2.429429531097412
Epoch: 8, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.968 Vali Acc: 0.733 Test Loss: 0.968 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.18412709236145
Epoch: 9, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.881 Vali Acc: 0.756 Test Loss: 0.881 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 2.1028144359588623
Epoch: 10, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.272 Vali Acc: 0.739 Test Loss: 1.272 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.199347972869873
Epoch: 11, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.923 Vali Acc: 0.761 Test Loss: 0.923 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761102).  Saving model ...
Epoch: 12 cost time: 1.5014469623565674
Epoch: 12, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.123 Vali Acc: 0.728 Test Loss: 1.123 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6583223342895508
Epoch: 13, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.175 Vali Acc: 0.756 Test Loss: 1.175 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7767529487609863
Epoch: 14, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.416 Vali Acc: 0.728 Test Loss: 1.416 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4998877048492432
Epoch: 15, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.195 Vali Acc: 0.750 Test Loss: 1.195 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0668065547943115
Epoch: 16, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.355 Vali Acc: 0.733 Test Loss: 1.355 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0644376277923584
Epoch: 17, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.274 Vali Acc: 0.722 Test Loss: 1.274 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.2270419597625732
Epoch: 18, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.124 Vali Acc: 0.750 Test Loss: 1.124 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.006920099258423
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.366 Vali Acc: 0.756 Test Loss: 1.366 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.960249423980713
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.191 Vali Acc: 0.750 Test Loss: 1.191 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1192798614501953
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.233 Vali Acc: 0.756 Test Loss: 1.233 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 471878
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.326349973678589
Epoch: 1, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.350 Vali Acc: 0.550 Test Loss: 1.350 Test Acc: 0.550
Validation loss decreased (inf --> -0.549986).  Saving model ...
Epoch: 2 cost time: 1.4639017581939697
Epoch: 2, Steps: 12 | Train Loss: 1.105 Vali Loss: 0.892 Vali Acc: 0.628 Test Loss: 0.892 Test Acc: 0.628
Validation loss decreased (-0.549986 --> -0.627769).  Saving model ...
Epoch: 3 cost time: 1.8727076053619385
Epoch: 3, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.677 Vali Acc: 0.722 Test Loss: 0.677 Test Acc: 0.722
Validation loss decreased (-0.627769 --> -0.722215).  Saving model ...
Epoch: 4 cost time: 1.5629611015319824
Epoch: 4, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.647 Vali Acc: 0.733 Test Loss: 0.647 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733327).  Saving model ...
Epoch: 5 cost time: 2.0176734924316406
Epoch: 5, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.662 Vali Acc: 0.750 Test Loss: 0.662 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 2.0891435146331787
Epoch: 6, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.651 Vali Acc: 0.717 Test Loss: 0.651 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9781744480133057
Epoch: 7, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.736 Vali Acc: 0.733 Test Loss: 0.736 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.025291919708252
Epoch: 8, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.714 Vali Acc: 0.772 Test Loss: 0.714 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772215).  Saving model ...
Epoch: 9 cost time: 1.8198378086090088
Epoch: 9, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.770 Vali Acc: 0.728 Test Loss: 0.770 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7289760112762451
Epoch: 10, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.827 Vali Acc: 0.767 Test Loss: 0.827 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7663073539733887
Epoch: 11, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7992782592773438
Epoch: 12, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.805 Vali Acc: 0.767 Test Loss: 0.805 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3297054767608643
Epoch: 13, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.959 Vali Acc: 0.761 Test Loss: 0.959 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3169336318969727
Epoch: 14, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.934 Vali Acc: 0.739 Test Loss: 0.934 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3228850364685059
Epoch: 15, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.981 Vali Acc: 0.733 Test Loss: 0.981 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3273708820343018
Epoch: 16, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.958 Vali Acc: 0.739 Test Loss: 0.958 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8301358222961426
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.925 Vali Acc: 0.761 Test Loss: 0.925 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2236461639404297
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 398534
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.335963487625122
Epoch: 1, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.319 Vali Acc: 0.500 Test Loss: 1.319 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 2.767219305038452
Epoch: 2, Steps: 12 | Train Loss: 1.098 Vali Loss: 0.922 Vali Acc: 0.611 Test Loss: 0.922 Test Acc: 0.611
Validation loss decreased (-0.499987 --> -0.611102).  Saving model ...
Epoch: 3 cost time: 2.1893012523651123
Epoch: 3, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.822 Vali Acc: 0.678 Test Loss: 0.822 Test Acc: 0.678
Validation loss decreased (-0.611102 --> -0.677770).  Saving model ...
Epoch: 4 cost time: 2.1215620040893555
Epoch: 4, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.672 Vali Acc: 0.722 Test Loss: 0.672 Test Acc: 0.722
Validation loss decreased (-0.677770 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 2.505054235458374
Epoch: 5, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.712 Vali Acc: 0.700 Test Loss: 0.712 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2908430099487305
Epoch: 6, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.826 Vali Acc: 0.733 Test Loss: 0.826 Test Acc: 0.733
Validation loss decreased (-0.722216 --> -0.733325).  Saving model ...
Epoch: 7 cost time: 2.2476110458374023
Epoch: 7, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.780 Vali Acc: 0.739 Test Loss: 0.780 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 8 cost time: 1.8355019092559814
Epoch: 8, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.660 Vali Acc: 0.767 Test Loss: 0.660 Test Acc: 0.767
Validation loss decreased (-0.738881 --> -0.766660).  Saving model ...
Epoch: 9 cost time: 2.9701602458953857
Epoch: 9, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.931 Vali Acc: 0.744 Test Loss: 0.931 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.189725875854492
Epoch: 10, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.726 Vali Acc: 0.744 Test Loss: 0.726 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.73063063621521
Epoch: 11, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.878 Vali Acc: 0.744 Test Loss: 0.878 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.626335382461548
Epoch: 12, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.905 Vali Acc: 0.733 Test Loss: 0.905 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.925389289855957
Epoch: 13, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.832 Vali Acc: 0.761 Test Loss: 0.832 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.449676275253296
Epoch: 14, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.962 Vali Acc: 0.744 Test Loss: 0.962 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.669196128845215
Epoch: 15, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.012 Vali Acc: 0.739 Test Loss: 1.012 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.0852677822113037
Epoch: 16, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.961 Vali Acc: 0.744 Test Loss: 0.961 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.9700820446014404
Epoch: 17, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.955 Vali Acc: 0.756 Test Loss: 0.955 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.535525321960449
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.986 Vali Acc: 0.744 Test Loss: 0.986 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm128_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 380358
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.830102443695068
Epoch: 1, Steps: 12 | Train Loss: 1.608 Vali Loss: 0.930 Vali Acc: 0.633 Test Loss: 0.930 Test Acc: 0.633
Validation loss decreased (inf --> -0.633324).  Saving model ...
Epoch: 2 cost time: 3.597543954849243
Epoch: 2, Steps: 12 | Train Loss: 0.911 Vali Loss: 0.723 Vali Acc: 0.700 Test Loss: 0.723 Test Acc: 0.700
Validation loss decreased (-0.633324 --> -0.699993).  Saving model ...
Epoch: 3 cost time: 3.6458044052124023
Epoch: 3, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.813 Vali Acc: 0.739 Test Loss: 0.813 Test Acc: 0.739
Validation loss decreased (-0.699993 --> -0.738881).  Saving model ...
Epoch: 4 cost time: 2.9997098445892334
Epoch: 4, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.758 Vali Acc: 0.756 Test Loss: 0.758 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755548).  Saving model ...
Epoch: 5 cost time: 3.5083627700805664
Epoch: 5, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9428610801696777
Epoch: 6, Steps: 12 | Train Loss: 0.420 Vali Loss: 1.406 Vali Acc: 0.728 Test Loss: 1.406 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9975955486297607
Epoch: 7, Steps: 12 | Train Loss: 0.179 Vali Loss: 1.046 Vali Acc: 0.767 Test Loss: 1.046 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766656).  Saving model ...
Epoch: 8 cost time: 3.8939287662506104
Epoch: 8, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.974 Vali Acc: 0.772 Test Loss: 0.974 Test Acc: 0.772
Validation loss decreased (-0.766656 --> -0.772212).  Saving model ...
Epoch: 9 cost time: 4.03183126449585
Epoch: 9, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.245 Vali Acc: 0.761 Test Loss: 1.245 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6677017211914062
Epoch: 10, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.423 Vali Acc: 0.739 Test Loss: 1.423 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1615982055664062
Epoch: 11, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.781 Vali Acc: 0.733 Test Loss: 1.781 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4421756267547607
Epoch: 12, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.696 Vali Acc: 0.706 Test Loss: 1.696 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.805826663970947
Epoch: 13, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.535 Vali Acc: 0.761 Test Loss: 1.535 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.241545677185059
Epoch: 14, Steps: 12 | Train Loss: 0.095 Vali Loss: 2.267 Vali Acc: 0.700 Test Loss: 2.267 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.162629127502441
Epoch: 15, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.755 Vali Acc: 0.767 Test Loss: 1.755 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.257287979125977
Epoch: 16, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.780 Vali Acc: 0.744 Test Loss: 1.780 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.32527232170105
Epoch: 17, Steps: 12 | Train Loss: 0.044 Vali Loss: 2.413 Vali Acc: 0.744 Test Loss: 2.413 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.1886186599731445
Epoch: 18, Steps: 12 | Train Loss: 0.126 Vali Loss: 2.041 Vali Acc: 0.739 Test Loss: 2.041 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 620230
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.542832374572754
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.234 Vali Acc: 0.522 Test Loss: 1.234 Test Acc: 0.522
Validation loss decreased (inf --> -0.522210).  Saving model ...
Epoch: 2 cost time: 2.7611918449401855
Epoch: 2, Steps: 12 | Train Loss: 0.892 Vali Loss: 0.782 Vali Acc: 0.689 Test Loss: 0.782 Test Acc: 0.689
Validation loss decreased (-0.522210 --> -0.688881).  Saving model ...
Epoch: 3 cost time: 2.8648946285247803
Epoch: 3, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.715 Vali Acc: 0.739 Test Loss: 0.715 Test Acc: 0.739
Validation loss decreased (-0.688881 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 2.8308794498443604
Epoch: 4, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.656 Vali Acc: 0.767 Test Loss: 0.656 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766660).  Saving model ...
Epoch: 5 cost time: 2.4679336547851562
Epoch: 5, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.630 Vali Acc: 0.750 Test Loss: 0.630 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.496127128601074
Epoch: 6, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.739 Vali Acc: 0.739 Test Loss: 0.739 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7761950492858887
Epoch: 7, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.758 Vali Acc: 0.778 Test Loss: 0.758 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777770).  Saving model ...
Epoch: 8 cost time: 3.0781266689300537
Epoch: 8, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.742 Vali Acc: 0.767 Test Loss: 0.742 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.032874345779419
Epoch: 9, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.387 Vali Acc: 0.722 Test Loss: 1.387 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8452529907226562
Epoch: 10, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.034 Vali Acc: 0.772 Test Loss: 1.034 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.877805471420288
Epoch: 11, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.125 Vali Acc: 0.761 Test Loss: 1.125 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8984248638153076
Epoch: 12, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.133 Vali Acc: 0.756 Test Loss: 1.133 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9989867210388184
Epoch: 13, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.955 Vali Acc: 0.789 Test Loss: 0.955 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788879).  Saving model ...
Epoch: 14 cost time: 2.914262294769287
Epoch: 14, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.815 Vali Acc: 0.794 Test Loss: 0.815 Test Acc: 0.794
Validation loss decreased (-0.788879 --> -0.794436).  Saving model ...
Epoch: 15 cost time: 2.7354586124420166
Epoch: 15, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.789 Test Loss: 0.835 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.82851505279541
Epoch: 16, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.847 Vali Acc: 0.794 Test Loss: 0.847 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1068716049194336
Epoch: 17, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.884 Vali Acc: 0.789 Test Loss: 0.884 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8749728202819824
Epoch: 18, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.800 Test Loss: 0.906 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 2.860755681991577
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.794 Test Loss: 0.915 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.823364019393921
Epoch: 20, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.914 Vali Acc: 0.789 Test Loss: 0.914 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.621933937072754
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.914 Vali Acc: 0.789 Test Loss: 0.914 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7539916038513184
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.789 Test Loss: 0.921 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6016621589660645
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.789 Test Loss: 0.924 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.6371281147003174
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.933 Vali Acc: 0.794 Test Loss: 0.933 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.8287675380706787
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.800 Test Loss: 0.940 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.660419225692749
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.794 Test Loss: 0.942 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.8264613151550293
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.950 Vali Acc: 0.794 Test Loss: 0.950 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.5173139572143555
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.800 Test Loss: 0.960 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 389894
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.596078157424927
Epoch: 1, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.153 Vali Acc: 0.600 Test Loss: 1.153 Test Acc: 0.600
Validation loss decreased (inf --> -0.599988).  Saving model ...
Epoch: 2 cost time: 2.696295738220215
Epoch: 2, Steps: 12 | Train Loss: 1.039 Vali Loss: 0.780 Vali Acc: 0.683 Test Loss: 0.780 Test Acc: 0.683
Validation loss decreased (-0.599988 --> -0.683326).  Saving model ...
Epoch: 3 cost time: 2.7057106494903564
Epoch: 3, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.631 Vali Acc: 0.733 Test Loss: 0.631 Test Acc: 0.733
Validation loss decreased (-0.683326 --> -0.733327).  Saving model ...
Epoch: 4 cost time: 2.817265272140503
Epoch: 4, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.680 Vali Acc: 0.733 Test Loss: 0.680 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.857372760772705
Epoch: 5, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.681 Vali Acc: 0.722 Test Loss: 0.681 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4759793281555176
Epoch: 6, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.959 Vali Acc: 0.722 Test Loss: 0.959 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.464716911315918
Epoch: 7, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.887 Vali Acc: 0.750 Test Loss: 0.887 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 2.554368495941162
Epoch: 8, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.724 Vali Acc: 0.772 Test Loss: 0.724 Test Acc: 0.772
Validation loss decreased (-0.749991 --> -0.772215).  Saving model ...
Epoch: 9 cost time: 3.0741958618164062
Epoch: 9, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.136 Vali Acc: 0.722 Test Loss: 1.136 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7739100456237793
Epoch: 10, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.091 Vali Acc: 0.744 Test Loss: 1.091 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.595160722732544
Epoch: 11, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.133 Vali Acc: 0.733 Test Loss: 1.133 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.620229482650757
Epoch: 12, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.149 Vali Acc: 0.750 Test Loss: 1.149 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.683485746383667
Epoch: 13, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.340 Vali Acc: 0.756 Test Loss: 1.340 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.781784772872925
Epoch: 14, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.563 Vali Acc: 0.728 Test Loss: 1.563 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.572568893432617
Epoch: 15, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.371 Vali Acc: 0.750 Test Loss: 1.371 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7971785068511963
Epoch: 16, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.434 Vali Acc: 0.772 Test Loss: 1.434 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.772914171218872
Epoch: 17, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.333 Vali Acc: 0.761 Test Loss: 1.333 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.803435802459717
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.654 Vali Acc: 0.722 Test Loss: 1.654 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 380742
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.26954984664917
Epoch: 1, Steps: 12 | Train Loss: 1.805 Vali Loss: 1.364 Vali Acc: 0.450 Test Loss: 1.364 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 3.32665753364563
Epoch: 2, Steps: 12 | Train Loss: 0.991 Vali Loss: 0.912 Vali Acc: 0.633 Test Loss: 0.912 Test Acc: 0.633
Validation loss decreased (-0.449986 --> -0.633324).  Saving model ...
Epoch: 3 cost time: 3.303860664367676
Epoch: 3, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.722 Vali Acc: 0.689 Test Loss: 0.722 Test Acc: 0.689
Validation loss decreased (-0.633324 --> -0.688882).  Saving model ...
Epoch: 4 cost time: 3.611262559890747
Epoch: 4, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.630 Vali Acc: 0.728 Test Loss: 0.630 Test Acc: 0.728
Validation loss decreased (-0.688882 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 3.338939905166626
Epoch: 5, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.716 Vali Acc: 0.739 Test Loss: 0.716 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 3.2561914920806885
Epoch: 6, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.596 Vali Acc: 0.756 Test Loss: 0.596 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 3.1271705627441406
Epoch: 7, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.669 Vali Acc: 0.772 Test Loss: 0.669 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772216).  Saving model ...
Epoch: 8 cost time: 2.857487678527832
Epoch: 8, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.836 Vali Acc: 0.744 Test Loss: 0.836 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1992568969726562
Epoch: 9, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.776 Vali Acc: 0.733 Test Loss: 0.776 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0350422859191895
Epoch: 10, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.844 Vali Acc: 0.756 Test Loss: 0.844 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3390185832977295
Epoch: 11, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.716 Vali Acc: 0.794 Test Loss: 0.716 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794437).  Saving model ...
Epoch: 12 cost time: 3.2596638202667236
Epoch: 12, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.858 Vali Acc: 0.761 Test Loss: 0.858 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.333195209503174
Epoch: 13, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.048353433609009
Epoch: 14, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.884 Vali Acc: 0.756 Test Loss: 0.884 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.5890681743621826
Epoch: 15, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.868 Vali Acc: 0.778 Test Loss: 0.868 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.476933717727661
Epoch: 16, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.875 Vali Acc: 0.783 Test Loss: 0.875 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.5070440769195557
Epoch: 17, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.856 Vali Acc: 0.767 Test Loss: 0.856 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.565958261489868
Epoch: 18, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.894 Vali Acc: 0.761 Test Loss: 0.894 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.1195106506347656
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.891 Vali Acc: 0.756 Test Loss: 0.891 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.0418388843536377
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.883 Vali Acc: 0.767 Test Loss: 0.883 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.9046013355255127
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.886 Vali Acc: 0.783 Test Loss: 0.886 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 307142
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.989957094192505
Epoch: 1, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.371 Vali Acc: 0.561 Test Loss: 1.371 Test Acc: 0.561
Validation loss decreased (inf --> -0.561097).  Saving model ...
Epoch: 2 cost time: 3.1079282760620117
Epoch: 2, Steps: 12 | Train Loss: 1.055 Vali Loss: 0.942 Vali Acc: 0.600 Test Loss: 0.942 Test Acc: 0.600
Validation loss decreased (-0.561097 --> -0.599991).  Saving model ...
Epoch: 3 cost time: 3.121281862258911
Epoch: 3, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.779 Vali Acc: 0.656 Test Loss: 0.779 Test Acc: 0.656
Validation loss decreased (-0.599991 --> -0.655548).  Saving model ...
Epoch: 4 cost time: 3.072655200958252
Epoch: 4, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.694 Vali Acc: 0.733 Test Loss: 0.694 Test Acc: 0.733
Validation loss decreased (-0.655548 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 3.1158297061920166
Epoch: 5, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.680 Vali Acc: 0.739 Test Loss: 0.680 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 3.2118349075317383
Epoch: 6, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.596 Vali Acc: 0.767 Test Loss: 0.596 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 3.395286798477173
Epoch: 7, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.772 Vali Acc: 0.744 Test Loss: 0.772 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.069467067718506
Epoch: 8, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.801 Vali Acc: 0.717 Test Loss: 0.801 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.355736017227173
Epoch: 9, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.770 Vali Acc: 0.750 Test Loss: 0.770 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2187318801879883
Epoch: 10, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.712 Vali Acc: 0.772 Test Loss: 0.712 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772215).  Saving model ...
Epoch: 11 cost time: 3.4380428791046143
Epoch: 11, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.741 Vali Acc: 0.761 Test Loss: 0.741 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2407028675079346
Epoch: 12, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.872 Vali Acc: 0.733 Test Loss: 0.872 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1778533458709717
Epoch: 13, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.810 Vali Acc: 0.756 Test Loss: 0.810 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0098037719726562
Epoch: 14, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.893 Vali Acc: 0.778 Test Loss: 0.893 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777769).  Saving model ...
Epoch: 15 cost time: 3.2656736373901367
Epoch: 15, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.992 Vali Acc: 0.756 Test Loss: 0.992 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5798561573028564
Epoch: 16, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.859 Vali Acc: 0.778 Test Loss: 0.859 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777769).  Saving model ...
Epoch: 17 cost time: 3.169623851776123
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5664756298065186
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.863 Vali Acc: 0.772 Test Loss: 0.863 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5725619792938232
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.852 Vali Acc: 0.772 Test Loss: 0.852 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4099645614624023
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.864 Vali Acc: 0.767 Test Loss: 0.864 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4181976318359375
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.900 Vali Acc: 0.767 Test Loss: 0.900 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.4615824222564697
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.896 Vali Acc: 0.761 Test Loss: 0.896 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.489178419113159
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.912 Vali Acc: 0.761 Test Loss: 0.912 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4344241619110107
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.767 Test Loss: 0.903 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.2872908115386963
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.761 Test Loss: 0.903 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.6042962074279785
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.920 Vali Acc: 0.772 Test Loss: 0.920 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 261190
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.417913913726807
Epoch: 1, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.474 Vali Acc: 0.483 Test Loss: 1.474 Test Acc: 0.483
Validation loss decreased (inf --> -0.483319).  Saving model ...
Epoch: 2 cost time: 2.6790223121643066
Epoch: 2, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.066 Vali Acc: 0.594 Test Loss: 1.066 Test Acc: 0.594
Validation loss decreased (-0.483319 --> -0.594434).  Saving model ...
Epoch: 3 cost time: 2.521949052810669
Epoch: 3, Steps: 12 | Train Loss: 0.939 Vali Loss: 0.885 Vali Acc: 0.611 Test Loss: 0.885 Test Acc: 0.611
Validation loss decreased (-0.594434 --> -0.611102).  Saving model ...
Epoch: 4 cost time: 2.568984031677246
Epoch: 4, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.735 Vali Acc: 0.689 Test Loss: 0.735 Test Acc: 0.689
Validation loss decreased (-0.611102 --> -0.688882).  Saving model ...
Epoch: 5 cost time: 2.2144341468811035
Epoch: 5, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.697 Vali Acc: 0.717 Test Loss: 0.697 Test Acc: 0.717
Validation loss decreased (-0.688882 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 2.2687251567840576
Epoch: 6, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.676 Vali Acc: 0.700 Test Loss: 0.676 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6874005794525146
Epoch: 7, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.678 Vali Acc: 0.722 Test Loss: 0.678 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 2.5497865676879883
Epoch: 8, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.678 Vali Acc: 0.744 Test Loss: 0.678 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 2.4337849617004395
Epoch: 9, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.726 Vali Acc: 0.733 Test Loss: 0.726 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5641262531280518
Epoch: 10, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.748 Vali Acc: 0.711 Test Loss: 0.748 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.568251609802246
Epoch: 11, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.735 Vali Acc: 0.744 Test Loss: 0.735 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2448558807373047
Epoch: 12, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.773 Vali Acc: 0.744 Test Loss: 0.773 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.036611318588257
Epoch: 13, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.963 Vali Acc: 0.722 Test Loss: 0.963 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1345207691192627
Epoch: 14, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.839 Vali Acc: 0.739 Test Loss: 0.839 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3498003482818604
Epoch: 15, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.880 Vali Acc: 0.717 Test Loss: 0.880 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.371967077255249
Epoch: 16, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.910 Vali Acc: 0.733 Test Loss: 0.910 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4262871742248535
Epoch: 17, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.884 Vali Acc: 0.728 Test Loss: 0.884 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3245744705200195
Epoch: 18, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.857 Vali Acc: 0.728 Test Loss: 0.857 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 224518
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.430546998977661
Epoch: 1, Steps: 12 | Train Loss: 1.883 Vali Loss: 1.481 Vali Acc: 0.489 Test Loss: 1.481 Test Acc: 0.489
Validation loss decreased (inf --> -0.488874).  Saving model ...
Epoch: 2 cost time: 2.321985960006714
Epoch: 2, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.095 Vali Acc: 0.583 Test Loss: 1.095 Test Acc: 0.583
Validation loss decreased (-0.488874 --> -0.583322).  Saving model ...
Epoch: 3 cost time: 2.483508825302124
Epoch: 3, Steps: 12 | Train Loss: 0.929 Vali Loss: 0.861 Vali Acc: 0.639 Test Loss: 0.861 Test Acc: 0.639
Validation loss decreased (-0.583322 --> -0.638880).  Saving model ...
Epoch: 4 cost time: 2.5494210720062256
Epoch: 4, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.750 Vali Acc: 0.694 Test Loss: 0.750 Test Acc: 0.694
Validation loss decreased (-0.638880 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 2.4749934673309326
Epoch: 5, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.671 Vali Acc: 0.717 Test Loss: 0.671 Test Acc: 0.717
Validation loss decreased (-0.694437 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 2.520869016647339
Epoch: 6, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.654 Vali Acc: 0.739 Test Loss: 0.654 Test Acc: 0.739
Validation loss decreased (-0.716660 --> -0.738882).  Saving model ...
Epoch: 7 cost time: 2.5848841667175293
Epoch: 7, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.628 Vali Acc: 0.767 Test Loss: 0.628 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766660).  Saving model ...
Epoch: 8 cost time: 2.5434882640838623
Epoch: 8, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.638 Vali Acc: 0.750 Test Loss: 0.638 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.599588394165039
Epoch: 9, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.627 Vali Acc: 0.767 Test Loss: 0.627 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 10 cost time: 2.597865343093872
Epoch: 10, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.625 Vali Acc: 0.756 Test Loss: 0.625 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7167694568634033
Epoch: 11, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.655 Vali Acc: 0.756 Test Loss: 0.655 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4801557064056396
Epoch: 12, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.733 Vali Acc: 0.761 Test Loss: 0.733 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4884097576141357
Epoch: 13, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.687 Vali Acc: 0.778 Test Loss: 0.687 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 14 cost time: 2.582221269607544
Epoch: 14, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.760 Vali Acc: 0.756 Test Loss: 0.760 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6653380393981934
Epoch: 15, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.769 Vali Acc: 0.761 Test Loss: 0.769 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4727559089660645
Epoch: 16, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.734 Vali Acc: 0.756 Test Loss: 0.734 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2909739017486572
Epoch: 17, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.755 Vali Acc: 0.750 Test Loss: 0.755 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3411977291107178
Epoch: 18, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.3571617603302
Epoch: 19, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.798 Vali Acc: 0.761 Test Loss: 0.798 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2938568592071533
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.800 Vali Acc: 0.761 Test Loss: 0.800 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.278508424758911
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.743 Vali Acc: 0.778 Test Loss: 0.743 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4188716411590576
Epoch: 22, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.831 Vali Acc: 0.767 Test Loss: 0.831 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.606010675430298
Epoch: 23, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.831 Vali Acc: 0.772 Test Loss: 0.831 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 215430
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.769967555999756
Epoch: 1, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.004 Vali Acc: 0.556 Test Loss: 1.004 Test Acc: 0.556
Validation loss decreased (inf --> -0.555546).  Saving model ...
Epoch: 2 cost time: 3.0120935440063477
Epoch: 2, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.731 Vali Acc: 0.689 Test Loss: 0.731 Test Acc: 0.689
Validation loss decreased (-0.555546 --> -0.688882).  Saving model ...
Epoch: 3 cost time: 3.0831220149993896
Epoch: 3, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.796 Vali Acc: 0.689 Test Loss: 0.796 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0278961658477783
Epoch: 4, Steps: 12 | Train Loss: 0.559 Vali Loss: 1.376 Vali Acc: 0.628 Test Loss: 1.376 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9605982303619385
Epoch: 5, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.822 Vali Acc: 0.778 Test Loss: 0.822 Test Acc: 0.778
Validation loss decreased (-0.688882 --> -0.777770).  Saving model ...
Epoch: 6 cost time: 3.056175947189331
Epoch: 6, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.989 Vali Acc: 0.739 Test Loss: 0.989 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.131272077560425
Epoch: 7, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.062 Vali Acc: 0.750 Test Loss: 1.062 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.127964735031128
Epoch: 8, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.387 Vali Acc: 0.739 Test Loss: 1.387 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0605311393737793
Epoch: 9, Steps: 12 | Train Loss: 0.165 Vali Loss: 1.129 Vali Acc: 0.772 Test Loss: 1.129 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.1902379989624023
Epoch: 10, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.284 Vali Acc: 0.756 Test Loss: 1.284 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0814757347106934
Epoch: 11, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.325 Vali Acc: 0.761 Test Loss: 1.325 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.89766263961792
Epoch: 12, Steps: 12 | Train Loss: 0.057 Vali Loss: 2.063 Vali Acc: 0.744 Test Loss: 2.063 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.9555306434631348
Epoch: 13, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.603 Vali Acc: 0.767 Test Loss: 1.603 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.0578534603118896
Epoch: 14, Steps: 12 | Train Loss: 0.041 Vali Loss: 2.337 Vali Acc: 0.717 Test Loss: 2.337 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8964738845825195
Epoch: 15, Steps: 12 | Train Loss: 0.148 Vali Loss: 2.287 Vali Acc: 0.733 Test Loss: 2.287 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 570694
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.074988842010498
Epoch: 1, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 2.418576955795288
Epoch: 2, Steps: 12 | Train Loss: 0.995 Vali Loss: 0.908 Vali Acc: 0.617 Test Loss: 0.908 Test Acc: 0.617
Validation loss decreased (-0.499988 --> -0.616658).  Saving model ...
Epoch: 3 cost time: 2.378469467163086
Epoch: 3, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.829 Vali Acc: 0.667 Test Loss: 0.829 Test Acc: 0.667
Validation loss decreased (-0.616658 --> -0.666658).  Saving model ...
Epoch: 4 cost time: 2.3812530040740967
Epoch: 4, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.555 Vali Acc: 0.750 Test Loss: 0.555 Test Acc: 0.750
Validation loss decreased (-0.666658 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 2.225877523422241
Epoch: 5, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.651 Vali Acc: 0.767 Test Loss: 0.651 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766660).  Saving model ...
Epoch: 6 cost time: 2.2125062942504883
Epoch: 6, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.680 Vali Acc: 0.756 Test Loss: 0.680 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.200883150100708
Epoch: 7, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.806 Vali Acc: 0.744 Test Loss: 0.806 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.305677890777588
Epoch: 8, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.914 Vali Acc: 0.733 Test Loss: 0.914 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3999557495117188
Epoch: 9, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.850 Vali Acc: 0.767 Test Loss: 0.850 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2349143028259277
Epoch: 10, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.073 Vali Acc: 0.756 Test Loss: 1.073 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.935441017150879
Epoch: 11, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.044 Vali Acc: 0.767 Test Loss: 1.044 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8848421573638916
Epoch: 12, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.994 Vali Acc: 0.744 Test Loss: 0.994 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2311034202575684
Epoch: 13, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.200 Vali Acc: 0.767 Test Loss: 1.200 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1780078411102295
Epoch: 14, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.900 Vali Acc: 0.800 Test Loss: 0.900 Test Acc: 0.800
Validation loss decreased (-0.766660 --> -0.799991).  Saving model ...
Epoch: 15 cost time: 2.244385242462158
Epoch: 15, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.394 Vali Acc: 0.756 Test Loss: 1.394 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.258943557739258
Epoch: 16, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.319 Vali Acc: 0.761 Test Loss: 1.319 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.369563341140747
Epoch: 17, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.217 Vali Acc: 0.750 Test Loss: 1.217 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0157570838928223
Epoch: 18, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.400 Vali Acc: 0.761 Test Loss: 1.400 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1547234058380127
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.187 Vali Acc: 0.772 Test Loss: 1.187 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.1388907432556152
Epoch: 20, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.778 Test Loss: 1.172 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1164791584014893
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.772 Test Loss: 1.177 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.431100845336914
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.170 Vali Acc: 0.778 Test Loss: 1.170 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.4377970695495605
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.168 Vali Acc: 0.778 Test Loss: 1.168 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3788199424743652
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.162 Vali Acc: 0.783 Test Loss: 1.162 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 340358
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.750767946243286
Epoch: 1, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.186 Vali Acc: 0.511 Test Loss: 1.186 Test Acc: 0.511
Validation loss decreased (inf --> -0.511099).  Saving model ...
Epoch: 2 cost time: 2.160656213760376
Epoch: 2, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.040 Vali Acc: 0.572 Test Loss: 1.040 Test Acc: 0.572
Validation loss decreased (-0.511099 --> -0.572212).  Saving model ...
Epoch: 3 cost time: 2.007327079772949
Epoch: 3, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.693 Vali Acc: 0.711 Test Loss: 0.693 Test Acc: 0.711
Validation loss decreased (-0.572212 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 2.128580093383789
Epoch: 4, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.797 Vali Acc: 0.700 Test Loss: 0.797 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0391387939453125
Epoch: 5, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.616 Vali Acc: 0.744 Test Loss: 0.616 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 2.1181530952453613
Epoch: 6, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.784 Vali Acc: 0.739 Test Loss: 0.784 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2992422580718994
Epoch: 7, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.675 Vali Acc: 0.761 Test Loss: 0.675 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761104).  Saving model ...
Epoch: 8 cost time: 2.329637050628662
Epoch: 8, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.929 Vali Acc: 0.750 Test Loss: 0.929 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.326524019241333
Epoch: 9, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.141 Vali Acc: 0.733 Test Loss: 1.141 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3182878494262695
Epoch: 10, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.139 Vali Acc: 0.750 Test Loss: 1.139 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1540591716766357
Epoch: 11, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.096 Vali Acc: 0.767 Test Loss: 1.096 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766656).  Saving model ...
Epoch: 12 cost time: 2.4265472888946533
Epoch: 12, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.826 Vali Acc: 0.783 Test Loss: 0.826 Test Acc: 0.783
Validation loss decreased (-0.766656 --> -0.783325).  Saving model ...
Epoch: 13 cost time: 2.1593410968780518
Epoch: 13, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.881 Vali Acc: 0.794 Test Loss: 0.881 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794436).  Saving model ...
Epoch: 14 cost time: 2.182359218597412
Epoch: 14, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.954 Vali Acc: 0.778 Test Loss: 0.954 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.126046895980835
Epoch: 15, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.000 Vali Acc: 0.767 Test Loss: 1.000 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2426540851593018
Epoch: 16, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.971 Vali Acc: 0.761 Test Loss: 0.971 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2452733516693115
Epoch: 17, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.967 Vali Acc: 0.761 Test Loss: 0.967 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1952195167541504
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.783 Test Loss: 0.991 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.099093198776245
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.778 Test Loss: 0.995 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.007840633392334
Epoch: 20, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.981 Vali Acc: 0.783 Test Loss: 0.981 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8549306392669678
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.794 Test Loss: 0.969 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0344393253326416
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.789 Test Loss: 0.974 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0984768867492676
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.783 Test Loss: 0.974 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 331206
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.205129861831665
Epoch: 1, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.308 Vali Acc: 0.522 Test Loss: 1.308 Test Acc: 0.522
Validation loss decreased (inf --> -0.522209).  Saving model ...
Epoch: 2 cost time: 3.0682289600372314
Epoch: 2, Steps: 12 | Train Loss: 1.032 Vali Loss: 0.909 Vali Acc: 0.628 Test Loss: 0.909 Test Acc: 0.628
Validation loss decreased (-0.522209 --> -0.627769).  Saving model ...
Epoch: 3 cost time: 3.263756036758423
Epoch: 3, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.775 Vali Acc: 0.672 Test Loss: 0.775 Test Acc: 0.672
Validation loss decreased (-0.627769 --> -0.672214).  Saving model ...
Epoch: 4 cost time: 3.131815195083618
Epoch: 4, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.609 Vali Acc: 0.739 Test Loss: 0.609 Test Acc: 0.739
Validation loss decreased (-0.672214 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 2.868291139602661
Epoch: 5, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.664 Vali Acc: 0.722 Test Loss: 0.664 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2972629070281982
Epoch: 6, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.952 Vali Acc: 0.706 Test Loss: 0.952 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0123023986816406
Epoch: 7, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.664 Vali Acc: 0.756 Test Loss: 0.664 Test Acc: 0.756
Validation loss decreased (-0.738883 --> -0.755549).  Saving model ...
Epoch: 8 cost time: 3.151468276977539
Epoch: 8, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.869 Vali Acc: 0.739 Test Loss: 0.869 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3640012741088867
Epoch: 9, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.675 Vali Acc: 0.761 Test Loss: 0.675 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 10 cost time: 3.0515124797821045
Epoch: 10, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.748 Vali Acc: 0.728 Test Loss: 0.748 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.333967685699463
Epoch: 11, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.779 Vali Acc: 0.761 Test Loss: 0.779 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.248743772506714
Epoch: 12, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.895 Vali Acc: 0.767 Test Loss: 0.895 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766658).  Saving model ...
Epoch: 13 cost time: 3.273030996322632
Epoch: 13, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.892 Vali Acc: 0.733 Test Loss: 0.892 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.47029447555542
Epoch: 14, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.952 Vali Acc: 0.767 Test Loss: 0.952 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.214615821838379
Epoch: 15, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.156 Vali Acc: 0.744 Test Loss: 1.156 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.4948177337646484
Epoch: 16, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.936 Vali Acc: 0.767 Test Loss: 0.936 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2645702362060547
Epoch: 17, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.033 Vali Acc: 0.728 Test Loss: 1.033 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.219637393951416
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.034 Vali Acc: 0.767 Test Loss: 1.034 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.937875747680664
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.022 Vali Acc: 0.761 Test Loss: 1.022 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.638498544692993
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.009 Vali Acc: 0.744 Test Loss: 1.009 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.5037686824798584
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.965 Vali Acc: 0.756 Test Loss: 0.965 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6149022579193115
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.961 Vali Acc: 0.778 Test Loss: 0.961 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777768).  Saving model ...
Epoch: 23 cost time: 3.0258021354675293
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.952 Vali Acc: 0.772 Test Loss: 0.952 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2187955379486084
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.956 Vali Acc: 0.767 Test Loss: 0.956 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.449909210205078
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.966 Vali Acc: 0.767 Test Loss: 0.966 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.367661714553833
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.982 Vali Acc: 0.778 Test Loss: 0.982 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.3303003311157227
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.977 Vali Acc: 0.778 Test Loss: 0.977 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.370941400527954
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.976 Vali Acc: 0.783 Test Loss: 0.976 Test Acc: 0.783
Validation loss decreased (-0.777768 --> -0.783324).  Saving model ...
Epoch: 29 cost time: 3.289793014526367
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.984 Vali Acc: 0.767 Test Loss: 0.984 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.2245230674743652
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.983 Vali Acc: 0.783 Test Loss: 0.983 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.313276529312134
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.778 Test Loss: 0.987 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.3597335815429688
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.783 Test Loss: 0.988 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.9858639240264893
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.783 Test Loss: 0.974 Test Acc: 0.783
Validation loss decreased (-0.783324 --> -0.783324).  Saving model ...
Epoch: 34 cost time: 2.908905029296875
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.978 Vali Acc: 0.783 Test Loss: 0.978 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.594249963760376
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.783 Test Loss: 0.988 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.3009896278381348
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.783 Test Loss: 0.992 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.626767635345459
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.778 Test Loss: 0.994 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.969672679901123
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.778 Test Loss: 0.995 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.884800672531128
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.778 Test Loss: 1.007 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.0457286834716797
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.778 Test Loss: 1.010 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.140815496444702
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.783 Test Loss: 0.993 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.8122172355651855
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.778 Test Loss: 0.998 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.9674642086029053
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.778 Test Loss: 1.002 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 257606
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.24772572517395
Epoch: 1, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.323 Vali Acc: 0.572 Test Loss: 1.323 Test Acc: 0.572
Validation loss decreased (inf --> -0.572209).  Saving model ...
Epoch: 2 cost time: 2.726578712463379
Epoch: 2, Steps: 12 | Train Loss: 1.093 Vali Loss: 0.891 Vali Acc: 0.622 Test Loss: 0.891 Test Acc: 0.622
Validation loss decreased (-0.572209 --> -0.622213).  Saving model ...
Epoch: 3 cost time: 2.5886878967285156
Epoch: 3, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.729 Vali Acc: 0.700 Test Loss: 0.729 Test Acc: 0.700
Validation loss decreased (-0.622213 --> -0.699993).  Saving model ...
Epoch: 4 cost time: 2.419559955596924
Epoch: 4, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.748 Vali Acc: 0.694 Test Loss: 0.748 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.548729658126831
Epoch: 5, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.680 Vali Acc: 0.722 Test Loss: 0.680 Test Acc: 0.722
Validation loss decreased (-0.699993 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 2.499979257583618
Epoch: 6, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.622 Vali Acc: 0.744 Test Loss: 0.622 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 7 cost time: 2.54421067237854
Epoch: 7, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.682 Vali Acc: 0.744 Test Loss: 0.682 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4278039932250977
Epoch: 8, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.825 Vali Acc: 0.756 Test Loss: 0.825 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755547).  Saving model ...
Epoch: 9 cost time: 2.6930322647094727
Epoch: 9, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.667 Vali Acc: 0.767 Test Loss: 0.667 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766660).  Saving model ...
Epoch: 10 cost time: 2.6406123638153076
Epoch: 10, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.803 Vali Acc: 0.756 Test Loss: 0.803 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.525319814682007
Epoch: 11, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.817 Vali Acc: 0.756 Test Loss: 0.817 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7330234050750732
Epoch: 12, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.734 Vali Acc: 0.767 Test Loss: 0.734 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.55657696723938
Epoch: 13, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.712 Vali Acc: 0.761 Test Loss: 0.712 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.258476495742798
Epoch: 14, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.846 Vali Acc: 0.772 Test Loss: 0.846 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772214).  Saving model ...
Epoch: 15 cost time: 2.3391122817993164
Epoch: 15, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.741 Vali Acc: 0.767 Test Loss: 0.741 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4544241428375244
Epoch: 16, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.802 Vali Acc: 0.783 Test Loss: 0.802 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 2.159280300140381
Epoch: 17, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.862 Vali Acc: 0.767 Test Loss: 0.862 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4595906734466553
Epoch: 18, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.871 Vali Acc: 0.778 Test Loss: 0.871 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5367462635040283
Epoch: 19, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.818 Vali Acc: 0.772 Test Loss: 0.818 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.431596040725708
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.874 Vali Acc: 0.767 Test Loss: 0.874 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2827420234680176
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.896 Vali Acc: 0.767 Test Loss: 0.896 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.3885903358459473
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.897 Vali Acc: 0.767 Test Loss: 0.897 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4060146808624268
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.889 Vali Acc: 0.767 Test Loss: 0.889 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4171206951141357
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.892 Vali Acc: 0.767 Test Loss: 0.892 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.6557202339172363
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.916 Vali Acc: 0.761 Test Loss: 0.916 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.60494065284729
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.917 Vali Acc: 0.767 Test Loss: 0.917 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 211654
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.172907829284668
Epoch: 1, Steps: 12 | Train Loss: 1.920 Vali Loss: 1.543 Vali Acc: 0.461 Test Loss: 1.543 Test Acc: 0.461
Validation loss decreased (inf --> -0.461096).  Saving model ...
Epoch: 2 cost time: 2.470750331878662
Epoch: 2, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.049 Vali Acc: 0.622 Test Loss: 1.049 Test Acc: 0.622
Validation loss decreased (-0.461096 --> -0.622212).  Saving model ...
Epoch: 3 cost time: 2.2321906089782715
Epoch: 3, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.866 Vali Acc: 0.683 Test Loss: 0.866 Test Acc: 0.683
Validation loss decreased (-0.622212 --> -0.683325).  Saving model ...
Epoch: 4 cost time: 2.5812230110168457
Epoch: 4, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.743 Vali Acc: 0.728 Test Loss: 0.743 Test Acc: 0.728
Validation loss decreased (-0.683325 --> -0.727770).  Saving model ...
Epoch: 5 cost time: 2.4269204139709473
Epoch: 5, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.712 Vali Acc: 0.706 Test Loss: 0.712 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.255312919616699
Epoch: 6, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.768 Vali Acc: 0.711 Test Loss: 0.768 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.169417142868042
Epoch: 7, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 2.1532630920410156
Epoch: 8, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.663 Vali Acc: 0.750 Test Loss: 0.663 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0548455715179443
Epoch: 9, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.655 Vali Acc: 0.744 Test Loss: 0.655 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8808228969573975
Epoch: 10, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.694 Vali Acc: 0.733 Test Loss: 0.694 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4690093994140625
Epoch: 11, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4276034832000732
Epoch: 12, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.729 Vali Acc: 0.761 Test Loss: 0.729 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761104).  Saving model ...
Epoch: 13 cost time: 2.405879497528076
Epoch: 13, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.829 Vali Acc: 0.744 Test Loss: 0.829 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3796699047088623
Epoch: 14, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.738 Vali Acc: 0.767 Test Loss: 0.738 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 2.433164119720459
Epoch: 15, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.849 Vali Acc: 0.744 Test Loss: 0.849 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3724238872528076
Epoch: 16, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.748 Vali Acc: 0.772 Test Loss: 0.748 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 17 cost time: 2.4026968479156494
Epoch: 17, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.699 Vali Acc: 0.772 Test Loss: 0.699 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 18 cost time: 2.5526881217956543
Epoch: 18, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.797 Vali Acc: 0.756 Test Loss: 0.797 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.24088978767395
Epoch: 19, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1472280025482178
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.781 Vali Acc: 0.756 Test Loss: 0.781 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9889421463012695
Epoch: 21, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.796 Vali Acc: 0.761 Test Loss: 0.796 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8760428428649902
Epoch: 22, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.822 Vali Acc: 0.761 Test Loss: 0.822 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8137750625610352
Epoch: 23, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1549072265625
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.858 Vali Acc: 0.750 Test Loss: 0.858 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.326612710952759
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.839 Vali Acc: 0.761 Test Loss: 0.839 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.5841870307922363
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.834 Vali Acc: 0.767 Test Loss: 0.834 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.4362056255340576
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.843 Vali Acc: 0.756 Test Loss: 0.843 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 174982
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.239161729812622
Epoch: 1, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.529 Vali Acc: 0.417 Test Loss: 1.529 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 2.6774401664733887
Epoch: 2, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.050 Vali Acc: 0.594 Test Loss: 1.050 Test Acc: 0.594
Validation loss decreased (-0.416651 --> -0.594434).  Saving model ...
Epoch: 3 cost time: 2.6256039142608643
Epoch: 3, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.865 Vali Acc: 0.633 Test Loss: 0.865 Test Acc: 0.633
Validation loss decreased (-0.594434 --> -0.633325).  Saving model ...
Epoch: 4 cost time: 2.136012077331543
Epoch: 4, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.751 Vali Acc: 0.706 Test Loss: 0.751 Test Acc: 0.706
Validation loss decreased (-0.633325 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 2.4864983558654785
Epoch: 5, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.650 Vali Acc: 0.733 Test Loss: 0.650 Test Acc: 0.733
Validation loss decreased (-0.705548 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 2.3694841861724854
Epoch: 6, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.588 Vali Acc: 0.767 Test Loss: 0.588 Test Acc: 0.767
Validation loss decreased (-0.733327 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 1.9439458847045898
Epoch: 7, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.623 Vali Acc: 0.772 Test Loss: 0.623 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 8 cost time: 2.332371234893799
Epoch: 8, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.594 Vali Acc: 0.778 Test Loss: 0.594 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 9 cost time: 2.698435068130493
Epoch: 9, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.570 Vali Acc: 0.772 Test Loss: 0.570 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.331082582473755
Epoch: 10, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783327).  Saving model ...
Epoch: 11 cost time: 2.089768409729004
Epoch: 11, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.679 Vali Acc: 0.767 Test Loss: 0.679 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5625743865966797
Epoch: 12, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.591 Vali Acc: 0.778 Test Loss: 0.591 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.637255907058716
Epoch: 13, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.685 Vali Acc: 0.767 Test Loss: 0.685 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4739108085632324
Epoch: 14, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.720 Vali Acc: 0.767 Test Loss: 0.720 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5861058235168457
Epoch: 15, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.673 Vali Acc: 0.772 Test Loss: 0.673 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9843499660491943
Epoch: 16, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.701 Vali Acc: 0.783 Test Loss: 0.701 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3894498348236084
Epoch: 17, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.741 Vali Acc: 0.789 Test Loss: 0.741 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788881).  Saving model ...
Epoch: 18 cost time: 2.3094825744628906
Epoch: 18, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.748 Vali Acc: 0.767 Test Loss: 0.748 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.557919979095459
Epoch: 19, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 2.167933464050293
Epoch: 20, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.722 Vali Acc: 0.778 Test Loss: 0.722 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.019467353820801
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.724 Vali Acc: 0.789 Test Loss: 0.724 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.0465118885040283
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.962773323059082
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.760 Vali Acc: 0.783 Test Loss: 0.760 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.8808414936065674
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.758 Vali Acc: 0.783 Test Loss: 0.758 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.130634069442749
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.781 Vali Acc: 0.783 Test Loss: 0.781 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.1296982765197754
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.781 Vali Acc: 0.789 Test Loss: 0.781 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.115946054458618
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.761 Vali Acc: 0.783 Test Loss: 0.761 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.03977632522583
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.774 Vali Acc: 0.783 Test Loss: 0.774 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.3730931282043457
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.756 Vali Acc: 0.783 Test Loss: 0.756 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 165894
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.055955171585083
Epoch: 1, Steps: 12 | Train Loss: 1.705 Vali Loss: 0.990 Vali Acc: 0.594 Test Loss: 0.990 Test Acc: 0.594
Validation loss decreased (inf --> -0.594435).  Saving model ...
Epoch: 2 cost time: 4.580876350402832
Epoch: 2, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.766 Vali Acc: 0.694 Test Loss: 0.766 Test Acc: 0.694
Validation loss decreased (-0.594435 --> -0.694437).  Saving model ...
Epoch: 3 cost time: 4.702448129653931
Epoch: 3, Steps: 12 | Train Loss: 0.591 Vali Loss: 1.291 Vali Acc: 0.656 Test Loss: 1.291 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.278124570846558
Epoch: 4, Steps: 12 | Train Loss: 0.445 Vali Loss: 1.473 Vali Acc: 0.617 Test Loss: 1.473 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.5092809200286865
Epoch: 5, Steps: 12 | Train Loss: 0.382 Vali Loss: 1.039 Vali Acc: 0.711 Test Loss: 1.039 Test Acc: 0.711
Validation loss decreased (-0.694437 --> -0.711101).  Saving model ...
Epoch: 6 cost time: 4.282306432723999
Epoch: 6, Steps: 12 | Train Loss: 0.377 Vali Loss: 1.885 Vali Acc: 0.683 Test Loss: 1.885 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.435694932937622
Epoch: 7, Steps: 12 | Train Loss: 0.414 Vali Loss: 1.209 Vali Acc: 0.744 Test Loss: 1.209 Test Acc: 0.744
Validation loss decreased (-0.711101 --> -0.744432).  Saving model ...
Epoch: 8 cost time: 4.391472101211548
Epoch: 8, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.274 Vali Acc: 0.717 Test Loss: 1.274 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.576306581497192
Epoch: 9, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.796 Vali Acc: 0.717 Test Loss: 1.796 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.673185110092163
Epoch: 10, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.705 Vali Acc: 0.689 Test Loss: 1.705 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.396449565887451
Epoch: 11, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.390 Vali Acc: 0.739 Test Loss: 1.390 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.807692050933838
Epoch: 12, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.600 Vali Acc: 0.750 Test Loss: 1.600 Test Acc: 0.750
Validation loss decreased (-0.744432 --> -0.749984).  Saving model ...
Epoch: 13 cost time: 4.064401626586914
Epoch: 13, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.943 Vali Acc: 0.744 Test Loss: 1.943 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.314409971237183
Epoch: 14, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.544 Vali Acc: 0.756 Test Loss: 1.544 Test Acc: 0.756
Validation loss decreased (-0.749984 --> -0.755540).  Saving model ...
Epoch: 15 cost time: 3.6384053230285645
Epoch: 15, Steps: 12 | Train Loss: 0.092 Vali Loss: 2.685 Vali Acc: 0.633 Test Loss: 2.685 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9296650886535645
Epoch: 16, Steps: 12 | Train Loss: 0.077 Vali Loss: 2.239 Vali Acc: 0.756 Test Loss: 2.239 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0434389114379883
Epoch: 17, Steps: 12 | Train Loss: 0.043 Vali Loss: 2.203 Vali Acc: 0.711 Test Loss: 2.203 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.7650794982910156
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 2.509 Vali Acc: 0.722 Test Loss: 2.509 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.9238109588623047
Epoch: 19, Steps: 12 | Train Loss: 0.031 Vali Loss: 2.936 Vali Acc: 0.706 Test Loss: 2.936 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.8709475994110107
Epoch: 20, Steps: 12 | Train Loss: 0.335 Vali Loss: 2.861 Vali Acc: 0.683 Test Loss: 2.861 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.7622034549713135
Epoch: 21, Steps: 12 | Train Loss: 0.148 Vali Loss: 2.762 Vali Acc: 0.689 Test Loss: 2.762 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.7904655933380127
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 3.013 Vali Acc: 0.711 Test Loss: 3.013 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.1243040561676025
Epoch: 23, Steps: 12 | Train Loss: 0.096 Vali Loss: 2.948 Vali Acc: 0.778 Test Loss: 2.948 Test Acc: 0.778
Validation loss decreased (-0.755540 --> -0.777748).  Saving model ...
Epoch: 24 cost time: 4.055001735687256
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 2.912 Vali Acc: 0.728 Test Loss: 2.912 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.9907901287078857
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 4.271 Vali Acc: 0.717 Test Loss: 4.271 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8404531478881836
Epoch: 26, Steps: 12 | Train Loss: 0.206 Vali Loss: 3.656 Vali Acc: 0.722 Test Loss: 3.656 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.405506134033203
Epoch: 27, Steps: 12 | Train Loss: 0.098 Vali Loss: 3.237 Vali Acc: 0.717 Test Loss: 3.237 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.059849977493286
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 3.255 Vali Acc: 0.728 Test Loss: 3.255 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.852083921432495
Epoch: 29, Steps: 12 | Train Loss: 0.197 Vali Loss: 4.000 Vali Acc: 0.733 Test Loss: 4.000 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.052323341369629
Epoch: 30, Steps: 12 | Train Loss: 0.095 Vali Loss: 4.156 Vali Acc: 0.722 Test Loss: 4.156 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.6270594596862793
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 4.209 Vali Acc: 0.756 Test Loss: 4.209 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.4452064037323
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 4.075 Vali Acc: 0.711 Test Loss: 4.075 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.692330837249756
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 4.543 Vali Acc: 0.733 Test Loss: 4.543 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 545926
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.783041954040527
Epoch: 1, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.170 Vali Acc: 0.583 Test Loss: 1.170 Test Acc: 0.583
Validation loss decreased (inf --> -0.583322).  Saving model ...
Epoch: 2 cost time: 3.193819522857666
Epoch: 2, Steps: 12 | Train Loss: 0.970 Vali Loss: 0.908 Vali Acc: 0.617 Test Loss: 0.908 Test Acc: 0.617
Validation loss decreased (-0.583322 --> -0.616658).  Saving model ...
Epoch: 3 cost time: 2.279339551925659
Epoch: 3, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.620 Vali Acc: 0.744 Test Loss: 0.620 Test Acc: 0.744
Validation loss decreased (-0.616658 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 2.8347363471984863
Epoch: 4, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.973 Vali Acc: 0.661 Test Loss: 0.973 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8089630603790283
Epoch: 5, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.807 Vali Acc: 0.700 Test Loss: 0.807 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8877413272857666
Epoch: 6, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.855 Vali Acc: 0.722 Test Loss: 0.855 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0781376361846924
Epoch: 7, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.993 Vali Acc: 0.722 Test Loss: 0.993 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.123539924621582
Epoch: 8, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.837 Vali Acc: 0.744 Test Loss: 0.837 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.247608184814453
Epoch: 9, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.941 Vali Acc: 0.750 Test Loss: 0.941 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 3.3944475650787354
Epoch: 10, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.826 Vali Acc: 0.739 Test Loss: 0.826 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9273221492767334
Epoch: 11, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.748 Vali Acc: 0.789 Test Loss: 0.748 Test Acc: 0.789
Validation loss decreased (-0.749991 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 2.409943103790283
Epoch: 12, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.810 Vali Acc: 0.789 Test Loss: 0.810 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4217357635498047
Epoch: 13, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.842 Vali Acc: 0.783 Test Loss: 0.842 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.324260950088501
Epoch: 14, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.858 Vali Acc: 0.783 Test Loss: 0.858 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6432788372039795
Epoch: 15, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.860 Vali Acc: 0.794 Test Loss: 0.860 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794436).  Saving model ...
Epoch: 16 cost time: 2.8191628456115723
Epoch: 16, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.863 Vali Acc: 0.789 Test Loss: 0.863 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5333385467529297
Epoch: 17, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.783 Test Loss: 0.854 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.546034097671509
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.885 Vali Acc: 0.783 Test Loss: 0.885 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.7324979305267334
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.806 Test Loss: 0.865 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805547).  Saving model ...
Epoch: 20 cost time: 2.9660532474517822
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.874 Vali Acc: 0.789 Test Loss: 0.874 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8399744033813477
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.864 Vali Acc: 0.789 Test Loss: 0.864 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.8493576049804688
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.873 Vali Acc: 0.794 Test Loss: 0.873 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.8380367755889893
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.800 Test Loss: 0.881 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.681556463241577
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.794 Test Loss: 0.893 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.0644474029541016
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.914 Vali Acc: 0.794 Test Loss: 0.914 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.7832107543945312
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.783 Test Loss: 0.920 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.7347729206085205
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.789 Test Loss: 0.915 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.7431585788726807
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.789 Test Loss: 0.906 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.6021885871887207
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.800 Test Loss: 0.904 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 315590
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.638669013977051
Epoch: 1, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.143 Vali Acc: 0.567 Test Loss: 1.143 Test Acc: 0.567
Validation loss decreased (inf --> -0.566655).  Saving model ...
Epoch: 2 cost time: 2.8585915565490723
Epoch: 2, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.802 Vali Acc: 0.667 Test Loss: 0.802 Test Acc: 0.667
Validation loss decreased (-0.566655 --> -0.666659).  Saving model ...
Epoch: 3 cost time: 2.6860671043395996
Epoch: 3, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.714 Vali Acc: 0.706 Test Loss: 0.714 Test Acc: 0.706
Validation loss decreased (-0.666659 --> -0.705548).  Saving model ...
Epoch: 4 cost time: 2.6845521926879883
Epoch: 4, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.876 Vali Acc: 0.717 Test Loss: 0.876 Test Acc: 0.717
Validation loss decreased (-0.705548 --> -0.716658).  Saving model ...
Epoch: 5 cost time: 2.582705020904541
Epoch: 5, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.671 Vali Acc: 0.756 Test Loss: 0.671 Test Acc: 0.756
Validation loss decreased (-0.716658 --> -0.755549).  Saving model ...
Epoch: 6 cost time: 2.616781711578369
Epoch: 6, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.676 Vali Acc: 0.756 Test Loss: 0.676 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.52776837348938
Epoch: 7, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.823 Vali Acc: 0.761 Test Loss: 0.823 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761103).  Saving model ...
Epoch: 8 cost time: 2.653005599975586
Epoch: 8, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.730 Vali Acc: 0.789 Test Loss: 0.730 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788882).  Saving model ...
Epoch: 9 cost time: 2.688184976577759
Epoch: 9, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.948 Vali Acc: 0.767 Test Loss: 0.948 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.796905040740967
Epoch: 10, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.864391326904297
Epoch: 11, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.899 Vali Acc: 0.761 Test Loss: 0.899 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6757707595825195
Epoch: 12, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.895 Vali Acc: 0.750 Test Loss: 0.895 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6884396076202393
Epoch: 13, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.896 Vali Acc: 0.767 Test Loss: 0.896 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5410709381103516
Epoch: 14, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.897 Vali Acc: 0.767 Test Loss: 0.897 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.715819835662842
Epoch: 15, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.761 Test Loss: 0.927 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.737647771835327
Epoch: 16, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.928 Vali Acc: 0.778 Test Loss: 0.928 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5008461475372314
Epoch: 17, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.767 Test Loss: 0.943 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4205517768859863
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.767 Test Loss: 0.958 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 306438
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.383614778518677
Epoch: 1, Steps: 12 | Train Loss: 1.694 Vali Loss: 1.268 Vali Acc: 0.544 Test Loss: 1.268 Test Acc: 0.544
Validation loss decreased (inf --> -0.544432).  Saving model ...
Epoch: 2 cost time: 3.138735771179199
Epoch: 2, Steps: 12 | Train Loss: 1.018 Vali Loss: 0.835 Vali Acc: 0.611 Test Loss: 0.835 Test Acc: 0.611
Validation loss decreased (-0.544432 --> -0.611103).  Saving model ...
Epoch: 3 cost time: 2.5182933807373047
Epoch: 3, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.730 Vali Acc: 0.689 Test Loss: 0.730 Test Acc: 0.689
Validation loss decreased (-0.611103 --> -0.688882).  Saving model ...
Epoch: 4 cost time: 2.8925371170043945
Epoch: 4, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.749 Vali Acc: 0.689 Test Loss: 0.749 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2788236141204834
Epoch: 5, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.667 Vali Acc: 0.756 Test Loss: 0.667 Test Acc: 0.756
Validation loss decreased (-0.688882 --> -0.755549).  Saving model ...
Epoch: 6 cost time: 2.7803795337677
Epoch: 6, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.682 Vali Acc: 0.733 Test Loss: 0.682 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8239567279815674
Epoch: 7, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.686 Vali Acc: 0.778 Test Loss: 0.686 Test Acc: 0.778
Validation loss decreased (-0.755549 --> -0.777771).  Saving model ...
Epoch: 8 cost time: 3.003741502761841
Epoch: 8, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.760 Vali Acc: 0.739 Test Loss: 0.760 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.84053635597229
Epoch: 9, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.698 Vali Acc: 0.761 Test Loss: 0.698 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8355538845062256
Epoch: 10, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.833 Vali Acc: 0.728 Test Loss: 0.833 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.017773389816284
Epoch: 11, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.715 Vali Acc: 0.744 Test Loss: 0.715 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3903799057006836
Epoch: 12, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.885 Vali Acc: 0.750 Test Loss: 0.885 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.895754098892212
Epoch: 13, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.961 Vali Acc: 0.744 Test Loss: 0.961 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7036969661712646
Epoch: 14, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.936 Vali Acc: 0.772 Test Loss: 0.936 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.721334218978882
Epoch: 15, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.925 Vali Acc: 0.750 Test Loss: 0.925 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.649183988571167
Epoch: 16, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.907 Vali Acc: 0.756 Test Loss: 0.907 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.420337200164795
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.947 Vali Acc: 0.756 Test Loss: 0.947 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 232838
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9719889163970947
Epoch: 1, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.388 Vali Acc: 0.517 Test Loss: 1.388 Test Acc: 0.517
Validation loss decreased (inf --> -0.516653).  Saving model ...
Epoch: 2 cost time: 2.3246347904205322
Epoch: 2, Steps: 12 | Train Loss: 1.109 Vali Loss: 0.943 Vali Acc: 0.639 Test Loss: 0.943 Test Acc: 0.639
Validation loss decreased (-0.516653 --> -0.638879).  Saving model ...
Epoch: 3 cost time: 2.197146415710449
Epoch: 3, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.778 Vali Acc: 0.672 Test Loss: 0.778 Test Acc: 0.672
Validation loss decreased (-0.638879 --> -0.672214).  Saving model ...
Epoch: 4 cost time: 2.1481730937957764
Epoch: 4, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.676 Vali Acc: 0.711 Test Loss: 0.676 Test Acc: 0.711
Validation loss decreased (-0.672214 --> -0.711104).  Saving model ...
Epoch: 5 cost time: 2.164952278137207
Epoch: 5, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.770 Vali Acc: 0.728 Test Loss: 0.770 Test Acc: 0.728
Validation loss decreased (-0.711104 --> -0.727770).  Saving model ...
Epoch: 6 cost time: 2.1440789699554443
Epoch: 6, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.713 Vali Acc: 0.728 Test Loss: 0.713 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 2.3274714946746826
Epoch: 7, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.694 Vali Acc: 0.750 Test Loss: 0.694 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 2.4401376247406006
Epoch: 8, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.774 Vali Acc: 0.739 Test Loss: 0.774 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.349146604537964
Epoch: 9, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.809 Vali Acc: 0.756 Test Loss: 0.809 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 2.170907735824585
Epoch: 10, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.724 Vali Acc: 0.761 Test Loss: 0.724 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761104).  Saving model ...
Epoch: 11 cost time: 2.1281793117523193
Epoch: 11, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.761 Vali Acc: 0.750 Test Loss: 0.761 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.247802734375
Epoch: 12, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.814 Vali Acc: 0.739 Test Loss: 0.814 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0614013671875
Epoch: 13, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.796 Vali Acc: 0.767 Test Loss: 0.796 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766659).  Saving model ...
Epoch: 14 cost time: 2.020609140396118
Epoch: 14, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0371410846710205
Epoch: 15, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.854 Vali Acc: 0.767 Test Loss: 0.854 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0243756771087646
Epoch: 16, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.873 Vali Acc: 0.772 Test Loss: 0.873 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772213).  Saving model ...
Epoch: 17 cost time: 2.3207528591156006
Epoch: 17, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.975 Vali Acc: 0.778 Test Loss: 0.975 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777768).  Saving model ...
Epoch: 18 cost time: 2.2708961963653564
Epoch: 18, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.999 Vali Acc: 0.744 Test Loss: 0.999 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2944343090057373
Epoch: 19, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.036 Vali Acc: 0.756 Test Loss: 1.036 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3747618198394775
Epoch: 20, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.997 Vali Acc: 0.772 Test Loss: 0.997 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4940805435180664
Epoch: 21, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.978 Vali Acc: 0.767 Test Loss: 0.978 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.226715087890625
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.927 Vali Acc: 0.761 Test Loss: 0.927 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2816600799560547
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.934 Vali Acc: 0.767 Test Loss: 0.934 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.287567377090454
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.949 Vali Acc: 0.767 Test Loss: 0.949 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.353039503097534
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.942 Vali Acc: 0.761 Test Loss: 0.942 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.324673652648926
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.974 Vali Acc: 0.767 Test Loss: 0.974 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.3926708698272705
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.982 Vali Acc: 0.767 Test Loss: 0.982 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 186886
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7372727394104004
Epoch: 1, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.509 Vali Acc: 0.433 Test Loss: 1.509 Test Acc: 0.433
Validation loss decreased (inf --> -0.433318).  Saving model ...
Epoch: 2 cost time: 2.0965919494628906
Epoch: 2, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.046 Vali Acc: 0.594 Test Loss: 1.046 Test Acc: 0.594
Validation loss decreased (-0.433318 --> -0.594434).  Saving model ...
Epoch: 3 cost time: 2.178205966949463
Epoch: 3, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.867 Vali Acc: 0.611 Test Loss: 0.867 Test Acc: 0.611
Validation loss decreased (-0.594434 --> -0.611102).  Saving model ...
Epoch: 4 cost time: 2.0837950706481934
Epoch: 4, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.747 Vali Acc: 0.683 Test Loss: 0.747 Test Acc: 0.683
Validation loss decreased (-0.611102 --> -0.683326).  Saving model ...
Epoch: 5 cost time: 2.1612937450408936
Epoch: 5, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.666 Vali Acc: 0.744 Test Loss: 0.666 Test Acc: 0.744
Validation loss decreased (-0.683326 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 2.2612383365631104
Epoch: 6, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.648 Vali Acc: 0.733 Test Loss: 0.648 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3101437091827393
Epoch: 7, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.727 Vali Acc: 0.722 Test Loss: 0.727 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2479987144470215
Epoch: 8, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.659 Vali Acc: 0.733 Test Loss: 0.659 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2658772468566895
Epoch: 9, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.630 Vali Acc: 0.717 Test Loss: 0.630 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1433191299438477
Epoch: 10, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.753 Vali Acc: 0.744 Test Loss: 0.753 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.098505735397339
Epoch: 11, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.732 Vali Acc: 0.722 Test Loss: 0.732 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.065999746322632
Epoch: 12, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.715 Vali Acc: 0.739 Test Loss: 0.715 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2117300033569336
Epoch: 13, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.817 Vali Acc: 0.728 Test Loss: 0.817 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.043717861175537
Epoch: 14, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.775 Vali Acc: 0.739 Test Loss: 0.775 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0822317600250244
Epoch: 15, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.789 Vali Acc: 0.750 Test Loss: 0.789 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 2.1695218086242676
Epoch: 16, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.808 Vali Acc: 0.756 Test Loss: 0.808 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 17 cost time: 1.953857660293579
Epoch: 17, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.784 Vali Acc: 0.722 Test Loss: 0.784 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2732157707214355
Epoch: 18, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.828 Vali Acc: 0.744 Test Loss: 0.828 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.821641445159912
Epoch: 19, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.820 Vali Acc: 0.739 Test Loss: 0.820 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9775078296661377
Epoch: 20, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.875 Vali Acc: 0.728 Test Loss: 0.875 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0058529376983643
Epoch: 21, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.895 Vali Acc: 0.733 Test Loss: 0.895 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7593610286712646
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.844 Vali Acc: 0.739 Test Loss: 0.844 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.917891025543213
Epoch: 23, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.856 Vali Acc: 0.728 Test Loss: 0.856 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7296082973480225
Epoch: 24, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.865 Vali Acc: 0.733 Test Loss: 0.865 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9719138145446777
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.862 Vali Acc: 0.733 Test Loss: 0.862 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.694579839706421
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.872 Vali Acc: 0.739 Test Loss: 0.872 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 150214
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.398419141769409
Epoch: 1, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.511 Vali Acc: 0.467 Test Loss: 1.511 Test Acc: 0.467
Validation loss decreased (inf --> -0.466652).  Saving model ...
Epoch: 2 cost time: 1.6884615421295166
Epoch: 2, Steps: 12 | Train Loss: 1.199 Vali Loss: 1.052 Vali Acc: 0.578 Test Loss: 1.052 Test Acc: 0.578
Validation loss decreased (-0.466652 --> -0.577767).  Saving model ...
Epoch: 3 cost time: 1.9032659530639648
Epoch: 3, Steps: 12 | Train Loss: 0.860 Vali Loss: 0.863 Vali Acc: 0.611 Test Loss: 0.863 Test Acc: 0.611
Validation loss decreased (-0.577767 --> -0.611102).  Saving model ...
Epoch: 4 cost time: 1.7287414073944092
Epoch: 4, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.757 Vali Acc: 0.694 Test Loss: 0.757 Test Acc: 0.694
Validation loss decreased (-0.611102 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 1.8552513122558594
Epoch: 5, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.713 Vali Acc: 0.689 Test Loss: 0.713 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8049685955047607
Epoch: 6, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.625 Vali Acc: 0.722 Test Loss: 0.625 Test Acc: 0.722
Validation loss decreased (-0.694437 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 1.5731663703918457
Epoch: 7, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.624 Vali Acc: 0.750 Test Loss: 0.624 Test Acc: 0.750
Validation loss decreased (-0.722216 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.775766372680664
Epoch: 8, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.612 Vali Acc: 0.744 Test Loss: 0.612 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7849798202514648
Epoch: 9, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.636 Vali Acc: 0.733 Test Loss: 0.636 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9562592506408691
Epoch: 10, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.657 Vali Acc: 0.756 Test Loss: 0.657 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 11 cost time: 2.0768513679504395
Epoch: 11, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9675118923187256
Epoch: 12, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.650 Vali Acc: 0.756 Test Loss: 0.650 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 13 cost time: 1.785435676574707
Epoch: 13, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.656 Vali Acc: 0.744 Test Loss: 0.656 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8644955158233643
Epoch: 14, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.712 Vali Acc: 0.728 Test Loss: 0.712 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.869849681854248
Epoch: 15, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.820 Vali Acc: 0.761 Test Loss: 0.820 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761103).  Saving model ...
Epoch: 16 cost time: 1.799926996231079
Epoch: 16, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.745 Vali Acc: 0.778 Test Loss: 0.745 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 17 cost time: 1.7596180438995361
Epoch: 17, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.848 Vali Acc: 0.728 Test Loss: 0.848 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8396263122558594
Epoch: 18, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.769 Vali Acc: 0.761 Test Loss: 0.769 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8569068908691406
Epoch: 19, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.782 Vali Acc: 0.739 Test Loss: 0.782 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.919616460800171
Epoch: 20, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.744 Vali Acc: 0.744 Test Loss: 0.744 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.667384147644043
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.786 Vali Acc: 0.744 Test Loss: 0.786 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9060113430023193
Epoch: 22, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.783 Vali Acc: 0.767 Test Loss: 0.783 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9244353771209717
Epoch: 23, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.730 Vali Acc: 0.756 Test Loss: 0.730 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9554307460784912
Epoch: 24, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.764 Vali Acc: 0.756 Test Loss: 0.764 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.958155632019043
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.775 Vali Acc: 0.761 Test Loss: 0.775 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.928919792175293
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.752 Vali Acc: 0.761 Test Loss: 0.752 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm64_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 141126
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.882547378540039
Epoch: 1, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.247 Vali Acc: 0.494 Test Loss: 1.247 Test Acc: 0.494
Validation loss decreased (inf --> -0.494432).  Saving model ...
Epoch: 2 cost time: 1.8171896934509277
Epoch: 2, Steps: 12 | Train Loss: 0.913 Vali Loss: 0.861 Vali Acc: 0.644 Test Loss: 0.861 Test Acc: 0.644
Validation loss decreased (-0.494432 --> -0.644436).  Saving model ...
Epoch: 3 cost time: 1.6660349369049072
Epoch: 3, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.960 Vali Acc: 0.633 Test Loss: 0.960 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8481688499450684
Epoch: 4, Steps: 12 | Train Loss: 0.533 Vali Loss: 1.264 Vali Acc: 0.689 Test Loss: 1.264 Test Acc: 0.689
Validation loss decreased (-0.644436 --> -0.688876).  Saving model ...
Epoch: 5 cost time: 1.627575397491455
Epoch: 5, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.669 Vali Acc: 0.756 Test Loss: 0.669 Test Acc: 0.756
Validation loss decreased (-0.688876 --> -0.755549).  Saving model ...
Epoch: 6 cost time: 1.9832463264465332
Epoch: 6, Steps: 12 | Train Loss: 0.227 Vali Loss: 1.085 Vali Acc: 0.733 Test Loss: 1.085 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.02812123298645
Epoch: 7, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.845 Vali Acc: 0.722 Test Loss: 0.845 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8618175983428955
Epoch: 8, Steps: 12 | Train Loss: 0.156 Vali Loss: 1.098 Vali Acc: 0.756 Test Loss: 1.098 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.037490129470825
Epoch: 9, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.161 Vali Acc: 0.761 Test Loss: 1.161 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761100).  Saving model ...
Epoch: 10 cost time: 1.7667770385742188
Epoch: 10, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.134 Vali Acc: 0.739 Test Loss: 1.134 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0668039321899414
Epoch: 11, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.143 Vali Acc: 0.772 Test Loss: 1.143 Test Acc: 0.772
Validation loss decreased (-0.761100 --> -0.772211).  Saving model ...
Epoch: 12 cost time: 1.8988778591156006
Epoch: 12, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.176 Vali Acc: 0.778 Test Loss: 1.176 Test Acc: 0.778
Validation loss decreased (-0.772211 --> -0.777766).  Saving model ...
Epoch: 13 cost time: 1.9828922748565674
Epoch: 13, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.131 Vali Acc: 0.750 Test Loss: 1.131 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.80000638961792
Epoch: 14, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.027 Vali Acc: 0.750 Test Loss: 1.027 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9986703395843506
Epoch: 15, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.009 Vali Acc: 0.756 Test Loss: 1.009 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9369938373565674
Epoch: 16, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.023 Vali Acc: 0.767 Test Loss: 1.023 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.847672700881958
Epoch: 17, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.761 Test Loss: 0.990 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6776561737060547
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.767 Test Loss: 0.969 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7120609283447266
Epoch: 19, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.984 Vali Acc: 0.772 Test Loss: 0.984 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7518866062164307
Epoch: 20, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.767 Test Loss: 0.985 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.780595302581787
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.761 Test Loss: 0.995 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9922025203704834
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.761 Test Loss: 0.996 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 298214
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1622071266174316
Epoch: 1, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.437 Vali Acc: 0.539 Test Loss: 1.437 Test Acc: 0.539
Validation loss decreased (inf --> -0.538875).  Saving model ...
Epoch: 2 cost time: 1.42448091506958
Epoch: 2, Steps: 12 | Train Loss: 1.141 Vali Loss: 0.923 Vali Acc: 0.650 Test Loss: 0.923 Test Acc: 0.650
Validation loss decreased (-0.538875 --> -0.649991).  Saving model ...
Epoch: 3 cost time: 1.5373411178588867
Epoch: 3, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.789 Vali Acc: 0.656 Test Loss: 0.789 Test Acc: 0.656
Validation loss decreased (-0.649991 --> -0.655548).  Saving model ...
Epoch: 4 cost time: 1.4811830520629883
Epoch: 4, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.716 Vali Acc: 0.706 Test Loss: 0.716 Test Acc: 0.706
Validation loss decreased (-0.655548 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 1.5110671520233154
Epoch: 5, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.711 Vali Acc: 0.722 Test Loss: 0.711 Test Acc: 0.722
Validation loss decreased (-0.705548 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 1.5127944946289062
Epoch: 6, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.652 Vali Acc: 0.767 Test Loss: 0.652 Test Acc: 0.767
Validation loss decreased (-0.722215 --> -0.766660).  Saving model ...
Epoch: 7 cost time: 1.688286542892456
Epoch: 7, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.737 Vali Acc: 0.728 Test Loss: 0.737 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4711363315582275
Epoch: 8, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.657 Vali Acc: 0.733 Test Loss: 0.657 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5720078945159912
Epoch: 9, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.669 Vali Acc: 0.761 Test Loss: 0.669 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6035232543945312
Epoch: 10, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.727 Vali Acc: 0.756 Test Loss: 0.727 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5628345012664795
Epoch: 11, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.710 Vali Acc: 0.783 Test Loss: 0.710 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783326).  Saving model ...
Epoch: 12 cost time: 1.6287615299224854
Epoch: 12, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.762 Vali Acc: 0.744 Test Loss: 0.762 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6155591011047363
Epoch: 13, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.787 Vali Acc: 0.767 Test Loss: 0.787 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4232478141784668
Epoch: 14, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.805 Vali Acc: 0.739 Test Loss: 0.805 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5126206874847412
Epoch: 15, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.813 Vali Acc: 0.739 Test Loss: 0.813 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.712024450302124
Epoch: 16, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.804 Vali Acc: 0.767 Test Loss: 0.804 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4923851490020752
Epoch: 17, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.831 Vali Acc: 0.733 Test Loss: 0.831 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4940741062164307
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5109663009643555
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.824 Vali Acc: 0.756 Test Loss: 0.824 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6367173194885254
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.825 Vali Acc: 0.756 Test Loss: 0.825 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4820678234100342
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.834 Vali Acc: 0.744 Test Loss: 0.834 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 183046
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3584823608398438
Epoch: 1, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.349 Vali Acc: 0.528 Test Loss: 1.349 Test Acc: 0.528
Validation loss decreased (inf --> -0.527764).  Saving model ...
Epoch: 2 cost time: 1.5806124210357666
Epoch: 2, Steps: 12 | Train Loss: 1.105 Vali Loss: 0.914 Vali Acc: 0.594 Test Loss: 0.914 Test Acc: 0.594
Validation loss decreased (-0.527764 --> -0.594435).  Saving model ...
Epoch: 3 cost time: 1.7076125144958496
Epoch: 3, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.719 Vali Acc: 0.722 Test Loss: 0.719 Test Acc: 0.722
Validation loss decreased (-0.594435 --> -0.722215).  Saving model ...
Epoch: 4 cost time: 1.734008550643921
Epoch: 4, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.719 Vali Acc: 0.694 Test Loss: 0.719 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.652052879333496
Epoch: 5, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 1.8875198364257812
Epoch: 6, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.689 Vali Acc: 0.717 Test Loss: 0.689 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6361470222473145
Epoch: 7, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.685 Vali Acc: 0.733 Test Loss: 0.685 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7164571285247803
Epoch: 8, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.628 Vali Acc: 0.744 Test Loss: 0.628 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6813313961029053
Epoch: 9, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.699 Vali Acc: 0.739 Test Loss: 0.699 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6672475337982178
Epoch: 10, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.754 Vali Acc: 0.744 Test Loss: 0.754 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6803972721099854
Epoch: 11, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.691 Vali Acc: 0.767 Test Loss: 0.691 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766660).  Saving model ...
Epoch: 12 cost time: 1.9673411846160889
Epoch: 12, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.721 Vali Acc: 0.761 Test Loss: 0.721 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.782332420349121
Epoch: 13, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.751 Vali Acc: 0.744 Test Loss: 0.751 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7174711227416992
Epoch: 14, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.740 Vali Acc: 0.756 Test Loss: 0.740 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8589553833007812
Epoch: 15, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.825 Vali Acc: 0.739 Test Loss: 0.825 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7888493537902832
Epoch: 16, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.810 Vali Acc: 0.733 Test Loss: 0.810 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7507774829864502
Epoch: 17, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.785 Vali Acc: 0.733 Test Loss: 0.785 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8525941371917725
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.789 Vali Acc: 0.750 Test Loss: 0.789 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6976747512817383
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.828 Vali Acc: 0.750 Test Loss: 0.828 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5164518356323242
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.819 Vali Acc: 0.744 Test Loss: 0.819 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8826885223388672
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 178470
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.199549913406372
Epoch: 1, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.474 Vali Acc: 0.494 Test Loss: 1.474 Test Acc: 0.494
Validation loss decreased (inf --> -0.494430).  Saving model ...
Epoch: 2 cost time: 2.3278045654296875
Epoch: 2, Steps: 12 | Train Loss: 1.268 Vali Loss: 0.988 Vali Acc: 0.633 Test Loss: 0.988 Test Acc: 0.633
Validation loss decreased (-0.494430 --> -0.633323).  Saving model ...
Epoch: 3 cost time: 2.3098530769348145
Epoch: 3, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.823 Vali Acc: 0.672 Test Loss: 0.823 Test Acc: 0.672
Validation loss decreased (-0.633323 --> -0.672214).  Saving model ...
Epoch: 4 cost time: 2.490053176879883
Epoch: 4, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.684 Vali Acc: 0.728 Test Loss: 0.684 Test Acc: 0.728
Validation loss decreased (-0.672214 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 2.19366717338562
Epoch: 5, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 2.166037082672119
Epoch: 6, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.645 Vali Acc: 0.756 Test Loss: 0.645 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 7 cost time: 2.335134267807007
Epoch: 7, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.572 Vali Acc: 0.778 Test Loss: 0.572 Test Acc: 0.778
Validation loss decreased (-0.755549 --> -0.777772).  Saving model ...
Epoch: 8 cost time: 2.2841594219207764
Epoch: 8, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.615 Vali Acc: 0.750 Test Loss: 0.615 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3235955238342285
Epoch: 9, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.567 Vali Acc: 0.772 Test Loss: 0.567 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.084925889968872
Epoch: 10, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.722 Vali Acc: 0.756 Test Loss: 0.722 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2190191745758057
Epoch: 11, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.688 Vali Acc: 0.778 Test Loss: 0.688 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6080939769744873
Epoch: 12, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.685 Vali Acc: 0.767 Test Loss: 0.685 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3847365379333496
Epoch: 13, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.637 Vali Acc: 0.794 Test Loss: 0.637 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794438).  Saving model ...
Epoch: 14 cost time: 2.3292291164398193
Epoch: 14, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.674 Vali Acc: 0.800 Test Loss: 0.674 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 2.2829198837280273
Epoch: 15, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.659 Vali Acc: 0.794 Test Loss: 0.659 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5369646549224854
Epoch: 16, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.717 Vali Acc: 0.783 Test Loss: 0.717 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5068905353546143
Epoch: 17, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.706 Vali Acc: 0.789 Test Loss: 0.706 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3636670112609863
Epoch: 18, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.708 Vali Acc: 0.772 Test Loss: 0.708 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1936960220336914
Epoch: 19, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.794 Test Loss: 0.707 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.705486536026001
Epoch: 20, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.700 Vali Acc: 0.800 Test Loss: 0.700 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.332313299179077
Epoch: 21, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.719 Vali Acc: 0.800 Test Loss: 0.719 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0909368991851807
Epoch: 22, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.757 Vali Acc: 0.789 Test Loss: 0.757 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.210944175720215
Epoch: 23, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.756 Vali Acc: 0.794 Test Loss: 0.756 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.529088020324707
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.743 Vali Acc: 0.794 Test Loss: 0.743 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 141670
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.137782573699951
Epoch: 1, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.465 Vali Acc: 0.483 Test Loss: 1.465 Test Acc: 0.483
Validation loss decreased (inf --> -0.483319).  Saving model ...
Epoch: 2 cost time: 2.3042542934417725
Epoch: 2, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.093 Vali Acc: 0.583 Test Loss: 1.093 Test Acc: 0.583
Validation loss decreased (-0.483319 --> -0.583322).  Saving model ...
Epoch: 3 cost time: 2.3911664485931396
Epoch: 3, Steps: 12 | Train Loss: 0.982 Vali Loss: 0.913 Vali Acc: 0.628 Test Loss: 0.913 Test Acc: 0.628
Validation loss decreased (-0.583322 --> -0.627769).  Saving model ...
Epoch: 4 cost time: 2.5525012016296387
Epoch: 4, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.741 Vali Acc: 0.694 Test Loss: 0.741 Test Acc: 0.694
Validation loss decreased (-0.627769 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 2.1954896450042725
Epoch: 5, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.704 Vali Acc: 0.706 Test Loss: 0.704 Test Acc: 0.706
Validation loss decreased (-0.694437 --> -0.705549).  Saving model ...
Epoch: 6 cost time: 2.1973822116851807
Epoch: 6, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.642 Vali Acc: 0.739 Test Loss: 0.642 Test Acc: 0.739
Validation loss decreased (-0.705549 --> -0.738882).  Saving model ...
Epoch: 7 cost time: 2.3910136222839355
Epoch: 7, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.682 Vali Acc: 0.739 Test Loss: 0.682 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2548749446868896
Epoch: 8, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.625 Vali Acc: 0.733 Test Loss: 0.625 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0999386310577393
Epoch: 9, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.618 Vali Acc: 0.739 Test Loss: 0.618 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738883).  Saving model ...
Epoch: 10 cost time: 2.130136251449585
Epoch: 10, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.646 Vali Acc: 0.739 Test Loss: 0.646 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.314716100692749
Epoch: 11, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.657 Vali Acc: 0.722 Test Loss: 0.657 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.964181661605835
Epoch: 12, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.739 Vali Acc: 0.750 Test Loss: 0.739 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 2.1897647380828857
Epoch: 13, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.687 Vali Acc: 0.750 Test Loss: 0.687 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 2.2153635025024414
Epoch: 14, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.669 Vali Acc: 0.739 Test Loss: 0.669 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.194193124771118
Epoch: 15, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.666 Vali Acc: 0.750 Test Loss: 0.666 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 2.0227110385894775
Epoch: 16, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1716744899749756
Epoch: 17, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.725 Vali Acc: 0.744 Test Loss: 0.725 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4543185234069824
Epoch: 18, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.707 Vali Acc: 0.761 Test Loss: 0.707 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761104).  Saving model ...
Epoch: 19 cost time: 2.4555463790893555
Epoch: 19, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9483139514923096
Epoch: 20, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.772 Vali Acc: 0.739 Test Loss: 0.772 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1198081970214844
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.768 Vali Acc: 0.772 Test Loss: 0.768 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772215).  Saving model ...
Epoch: 22 cost time: 2.2897441387176514
Epoch: 22, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.763 Vali Acc: 0.761 Test Loss: 0.763 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1421239376068115
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.789 Vali Acc: 0.761 Test Loss: 0.789 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0975096225738525
Epoch: 24, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.777 Vali Acc: 0.750 Test Loss: 0.777 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.12221622467041
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.775 Vali Acc: 0.767 Test Loss: 0.775 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.2851223945617676
Epoch: 26, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.837 Vali Acc: 0.750 Test Loss: 0.837 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.5195603370666504
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.842 Vali Acc: 0.750 Test Loss: 0.842 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.476685047149658
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.806 Vali Acc: 0.756 Test Loss: 0.806 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.3675858974456787
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.830 Vali Acc: 0.756 Test Loss: 0.830 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.5580413341522217
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.837 Vali Acc: 0.761 Test Loss: 0.837 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.491945266723633
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.845 Vali Acc: 0.756 Test Loss: 0.845 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 118694
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.91632080078125
Epoch: 1, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.663 Vali Acc: 0.372 Test Loss: 1.663 Test Acc: 0.372
Validation loss decreased (inf --> -0.372206).  Saving model ...
Epoch: 2 cost time: 1.244098424911499
Epoch: 2, Steps: 12 | Train Loss: 1.538 Vali Loss: 1.308 Vali Acc: 0.511 Test Loss: 1.308 Test Acc: 0.511
Validation loss decreased (-0.372206 --> -0.511098).  Saving model ...
Epoch: 3 cost time: 1.1983754634857178
Epoch: 3, Steps: 12 | Train Loss: 1.148 Vali Loss: 1.059 Vali Acc: 0.556 Test Loss: 1.059 Test Acc: 0.556
Validation loss decreased (-0.511098 --> -0.555545).  Saving model ...
Epoch: 4 cost time: 1.2941627502441406
Epoch: 4, Steps: 12 | Train Loss: 0.979 Vali Loss: 0.927 Vali Acc: 0.617 Test Loss: 0.927 Test Acc: 0.617
Validation loss decreased (-0.555545 --> -0.616657).  Saving model ...
Epoch: 5 cost time: 1.4373793601989746
Epoch: 5, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.802 Vali Acc: 0.667 Test Loss: 0.802 Test Acc: 0.667
Validation loss decreased (-0.616657 --> -0.666659).  Saving model ...
Epoch: 6 cost time: 1.4865236282348633
Epoch: 6, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.762 Vali Acc: 0.689 Test Loss: 0.762 Test Acc: 0.689
Validation loss decreased (-0.666659 --> -0.688881).  Saving model ...
Epoch: 7 cost time: 1.201340675354004
Epoch: 7, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.671 Vali Acc: 0.722 Test Loss: 0.671 Test Acc: 0.722
Validation loss decreased (-0.688881 --> -0.722216).  Saving model ...
Epoch: 8 cost time: 1.4927334785461426
Epoch: 8, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.661 Vali Acc: 0.706 Test Loss: 0.661 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3937156200408936
Epoch: 9, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.642 Vali Acc: 0.728 Test Loss: 0.642 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727771).  Saving model ...
Epoch: 10 cost time: 1.2407383918762207
Epoch: 10, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.637 Vali Acc: 0.739 Test Loss: 0.637 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 11 cost time: 1.1188256740570068
Epoch: 11, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1175518035888672
Epoch: 12, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.678 Vali Acc: 0.739 Test Loss: 0.678 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.10848069190979
Epoch: 13, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.630 Vali Acc: 0.739 Test Loss: 0.630 Test Acc: 0.739
Validation loss decreased (-0.738883 --> -0.738883).  Saving model ...
Epoch: 14 cost time: 1.20607590675354
Epoch: 14, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.621 Vali Acc: 0.750 Test Loss: 0.621 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.357487440109253
Epoch: 15, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.682 Vali Acc: 0.744 Test Loss: 0.682 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.223884105682373
Epoch: 16, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.651 Vali Acc: 0.756 Test Loss: 0.651 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 17 cost time: 1.452913761138916
Epoch: 17, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.650 Vali Acc: 0.750 Test Loss: 0.650 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.240588665008545
Epoch: 18, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.686 Vali Acc: 0.750 Test Loss: 0.686 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3150403499603271
Epoch: 19, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.672 Vali Acc: 0.756 Test Loss: 0.672 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2995867729187012
Epoch: 20, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.699 Vali Acc: 0.739 Test Loss: 0.699 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2727620601654053
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.688 Vali Acc: 0.750 Test Loss: 0.688 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2137866020202637
Epoch: 22, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.676 Vali Acc: 0.761 Test Loss: 0.676 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 23 cost time: 1.3562862873077393
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2955827713012695
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.720 Vali Acc: 0.767 Test Loss: 0.720 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766659).  Saving model ...
Epoch: 25 cost time: 1.232863426208496
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.695 Vali Acc: 0.767 Test Loss: 0.695 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766660).  Saving model ...
Epoch: 26 cost time: 1.3821618556976318
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.736 Vali Acc: 0.739 Test Loss: 0.736 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1095612049102783
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.714 Vali Acc: 0.739 Test Loss: 0.714 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.281189203262329
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.713 Vali Acc: 0.744 Test Loss: 0.713 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1445841789245605
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.729 Vali Acc: 0.761 Test Loss: 0.729 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3050107955932617
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.753 Vali Acc: 0.744 Test Loss: 0.753 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3385624885559082
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.726 Vali Acc: 0.750 Test Loss: 0.726 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2911725044250488
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.754 Vali Acc: 0.739 Test Loss: 0.754 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2952914237976074
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.761 Vali Acc: 0.761 Test Loss: 0.761 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.231102466583252
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.753 Vali Acc: 0.750 Test Loss: 0.753 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3815226554870605
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.760 Vali Acc: 0.756 Test Loss: 0.760 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 100358
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8438687324523926
Epoch: 1, Steps: 12 | Train Loss: 1.849 Vali Loss: 1.638 Vali Acc: 0.311 Test Loss: 1.638 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 1.2496161460876465
Epoch: 2, Steps: 12 | Train Loss: 1.485 Vali Loss: 1.296 Vali Acc: 0.500 Test Loss: 1.296 Test Acc: 0.500
Validation loss decreased (-0.311095 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.3360333442687988
Epoch: 3, Steps: 12 | Train Loss: 1.123 Vali Loss: 1.039 Vali Acc: 0.589 Test Loss: 1.039 Test Acc: 0.589
Validation loss decreased (-0.499987 --> -0.588878).  Saving model ...
Epoch: 4 cost time: 1.351888656616211
Epoch: 4, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.912 Vali Acc: 0.644 Test Loss: 0.912 Test Acc: 0.644
Validation loss decreased (-0.588878 --> -0.644435).  Saving model ...
Epoch: 5 cost time: 1.2833285331726074
Epoch: 5, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.827 Vali Acc: 0.667 Test Loss: 0.827 Test Acc: 0.667
Validation loss decreased (-0.644435 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 1.3380184173583984
Epoch: 6, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.736 Vali Acc: 0.722 Test Loss: 0.736 Test Acc: 0.722
Validation loss decreased (-0.666658 --> -0.722215).  Saving model ...
Epoch: 7 cost time: 1.273261547088623
Epoch: 7, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.677 Vali Acc: 0.711 Test Loss: 0.677 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.212923288345337
Epoch: 8, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.688 Vali Acc: 0.711 Test Loss: 0.688 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1723899841308594
Epoch: 9, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.2078089714050293
Epoch: 10, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.611 Vali Acc: 0.750 Test Loss: 0.611 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.4035701751708984
Epoch: 11, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.633 Vali Acc: 0.761 Test Loss: 0.633 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761105).  Saving model ...
Epoch: 12 cost time: 1.327165126800537
Epoch: 12, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.620 Vali Acc: 0.750 Test Loss: 0.620 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3688538074493408
Epoch: 13, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.669 Vali Acc: 0.744 Test Loss: 0.669 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3388950824737549
Epoch: 14, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.639 Vali Acc: 0.728 Test Loss: 0.639 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3264069557189941
Epoch: 15, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.643 Vali Acc: 0.756 Test Loss: 0.643 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3379583358764648
Epoch: 16, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.675 Vali Acc: 0.722 Test Loss: 0.675 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.22892165184021
Epoch: 17, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.688 Vali Acc: 0.756 Test Loss: 0.688 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1865925788879395
Epoch: 18, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.667 Vali Acc: 0.744 Test Loss: 0.667 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3393499851226807
Epoch: 19, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.675 Vali Acc: 0.756 Test Loss: 0.675 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4115452766418457
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.689 Vali Acc: 0.733 Test Loss: 0.689 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1978416442871094
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.681 Vali Acc: 0.744 Test Loss: 0.681 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 95814
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2958457469940186
Epoch: 1, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.151 Vali Acc: 0.583 Test Loss: 1.151 Test Acc: 0.583
Validation loss decreased (inf --> -0.583322).  Saving model ...
Epoch: 2 cost time: 1.650097131729126
Epoch: 2, Steps: 12 | Train Loss: 0.976 Vali Loss: 0.954 Vali Acc: 0.617 Test Loss: 0.954 Test Acc: 0.617
Validation loss decreased (-0.583322 --> -0.616657).  Saving model ...
Epoch: 3 cost time: 1.5562806129455566
Epoch: 3, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.758 Vali Acc: 0.694 Test Loss: 0.758 Test Acc: 0.694
Validation loss decreased (-0.616657 --> -0.694437).  Saving model ...
Epoch: 4 cost time: 1.5710742473602295
Epoch: 4, Steps: 12 | Train Loss: 0.552 Vali Loss: 1.001 Vali Acc: 0.633 Test Loss: 1.001 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.453681230545044
Epoch: 5, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.722 Vali Acc: 0.772 Test Loss: 0.722 Test Acc: 0.772
Validation loss decreased (-0.694437 --> -0.772215).  Saving model ...
Epoch: 6 cost time: 1.4512810707092285
Epoch: 6, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.696 Vali Acc: 0.722 Test Loss: 0.696 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4591271877288818
Epoch: 7, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.961 Vali Acc: 0.722 Test Loss: 0.961 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6097564697265625
Epoch: 8, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.827 Vali Acc: 0.756 Test Loss: 0.827 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5665912628173828
Epoch: 9, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.790 Vali Acc: 0.756 Test Loss: 0.790 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4738695621490479
Epoch: 10, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.935 Vali Acc: 0.744 Test Loss: 0.935 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.531585454940796
Epoch: 11, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.055 Vali Acc: 0.711 Test Loss: 1.055 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5302298069000244
Epoch: 12, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.192 Vali Acc: 0.739 Test Loss: 1.192 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.595165491104126
Epoch: 13, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.191 Vali Acc: 0.739 Test Loss: 1.191 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6007921695709229
Epoch: 14, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.022 Vali Acc: 0.778 Test Loss: 1.022 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777768).  Saving model ...
Epoch: 15 cost time: 1.5725243091583252
Epoch: 15, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.119 Vali Acc: 0.761 Test Loss: 1.119 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6312623023986816
Epoch: 16, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.176 Vali Acc: 0.772 Test Loss: 1.176 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6335160732269287
Epoch: 17, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.303 Vali Acc: 0.767 Test Loss: 1.303 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.63480806350708
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.343 Vali Acc: 0.778 Test Loss: 1.343 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.66377854347229
Epoch: 19, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.345 Vali Acc: 0.750 Test Loss: 1.345 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5903098583221436
Epoch: 20, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.404 Vali Acc: 0.778 Test Loss: 1.404 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.713979959487915
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.409 Vali Acc: 0.761 Test Loss: 1.409 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5996272563934326
Epoch: 22, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.614 Vali Acc: 0.750 Test Loss: 1.614 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6605966091156006
Epoch: 23, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.953 Vali Acc: 0.739 Test Loss: 1.953 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.539172649383545
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 2.382 Vali Acc: 0.733 Test Loss: 2.382 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 273254
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9156060218811035
Epoch: 1, Steps: 12 | Train Loss: 1.852 Vali Loss: 1.456 Vali Acc: 0.544 Test Loss: 1.456 Test Acc: 0.544
Validation loss decreased (inf --> -0.544430).  Saving model ...
Epoch: 2 cost time: 1.3658115863800049
Epoch: 2, Steps: 12 | Train Loss: 1.236 Vali Loss: 0.973 Vali Acc: 0.583 Test Loss: 0.973 Test Acc: 0.583
Validation loss decreased (-0.544430 --> -0.583324).  Saving model ...
Epoch: 3 cost time: 1.2423343658447266
Epoch: 3, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.759 Vali Acc: 0.689 Test Loss: 0.759 Test Acc: 0.689
Validation loss decreased (-0.583324 --> -0.688881).  Saving model ...
Epoch: 4 cost time: 1.2945430278778076
Epoch: 4, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.715 Vali Acc: 0.711 Test Loss: 0.715 Test Acc: 0.711
Validation loss decreased (-0.688881 --> -0.711104).  Saving model ...
Epoch: 5 cost time: 1.3831686973571777
Epoch: 5, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.661 Vali Acc: 0.728 Test Loss: 0.661 Test Acc: 0.728
Validation loss decreased (-0.711104 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.282299518585205
Epoch: 6, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.642 Vali Acc: 0.728 Test Loss: 0.642 Test Acc: 0.728
Validation loss decreased (-0.727771 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 1.2853219509124756
Epoch: 7, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.671 Vali Acc: 0.761 Test Loss: 0.671 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761104).  Saving model ...
Epoch: 8 cost time: 1.3868358135223389
Epoch: 8, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.757 Vali Acc: 0.722 Test Loss: 0.757 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2497172355651855
Epoch: 9, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.708 Vali Acc: 0.733 Test Loss: 0.708 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2503132820129395
Epoch: 10, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.751 Vali Acc: 0.761 Test Loss: 0.751 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.275712251663208
Epoch: 11, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.750 Vali Acc: 0.750 Test Loss: 0.750 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2148587703704834
Epoch: 12, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.837 Vali Acc: 0.744 Test Loss: 0.837 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4462800025939941
Epoch: 13, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.796 Vali Acc: 0.761 Test Loss: 0.796 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4373042583465576
Epoch: 14, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.787 Vali Acc: 0.761 Test Loss: 0.787 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.419647216796875
Epoch: 15, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.765 Vali Acc: 0.778 Test Loss: 0.765 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777770).  Saving model ...
Epoch: 16 cost time: 1.3991470336914062
Epoch: 16, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.877 Vali Acc: 0.739 Test Loss: 0.877 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4557836055755615
Epoch: 17, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.873 Vali Acc: 0.756 Test Loss: 0.873 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4182217121124268
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3609821796417236
Epoch: 19, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.882 Vali Acc: 0.756 Test Loss: 0.882 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4344983100891113
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.756 Test Loss: 0.936 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4912166595458984
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.476863145828247
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3425993919372559
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3217015266418457
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.932 Vali Acc: 0.756 Test Loss: 0.932 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3812508583068848
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.939 Vali Acc: 0.761 Test Loss: 0.939 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 158086
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1473982334136963
Epoch: 1, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.447 Vali Acc: 0.439 Test Loss: 1.447 Test Acc: 0.439
Validation loss decreased (inf --> -0.438874).  Saving model ...
Epoch: 2 cost time: 1.4005537033081055
Epoch: 2, Steps: 12 | Train Loss: 1.115 Vali Loss: 0.899 Vali Acc: 0.600 Test Loss: 0.899 Test Acc: 0.600
Validation loss decreased (-0.438874 --> -0.599991).  Saving model ...
Epoch: 3 cost time: 1.3157780170440674
Epoch: 3, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.763 Vali Acc: 0.661 Test Loss: 0.763 Test Acc: 0.661
Validation loss decreased (-0.599991 --> -0.661103).  Saving model ...
Epoch: 4 cost time: 1.3423428535461426
Epoch: 4, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
Validation loss decreased (-0.661103 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 1.370950698852539
Epoch: 5, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.652 Vali Acc: 0.733 Test Loss: 0.652 Test Acc: 0.733
Validation loss decreased (-0.716660 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 1.366288185119629
Epoch: 6, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.641 Vali Acc: 0.722 Test Loss: 0.641 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3054440021514893
Epoch: 7, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.742 Vali Acc: 0.722 Test Loss: 0.742 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3930902481079102
Epoch: 8, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.711 Vali Acc: 0.739 Test Loss: 0.711 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738882).  Saving model ...
Epoch: 9 cost time: 1.4343042373657227
Epoch: 9, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.836 Vali Acc: 0.728 Test Loss: 0.836 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3387572765350342
Epoch: 10, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.874 Vali Acc: 0.728 Test Loss: 0.874 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1950500011444092
Epoch: 11, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.873 Vali Acc: 0.750 Test Loss: 0.873 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 1.5761427879333496
Epoch: 12, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.743 Vali Acc: 0.767 Test Loss: 0.743 Test Acc: 0.767
Validation loss decreased (-0.749991 --> -0.766659).  Saving model ...
Epoch: 13 cost time: 1.3239295482635498
Epoch: 13, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.826 Vali Acc: 0.733 Test Loss: 0.826 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.254453182220459
Epoch: 14, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.805 Vali Acc: 0.756 Test Loss: 0.805 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5019431114196777
Epoch: 15, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.823 Vali Acc: 0.767 Test Loss: 0.823 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.285372257232666
Epoch: 16, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.878 Vali Acc: 0.750 Test Loss: 0.878 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2738230228424072
Epoch: 17, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.886 Vali Acc: 0.756 Test Loss: 0.886 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3222100734710693
Epoch: 18, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1980254650115967
Epoch: 19, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.042 Vali Acc: 0.744 Test Loss: 1.042 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.318840742111206
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.954 Vali Acc: 0.772 Test Loss: 0.954 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772213).  Saving model ...
Epoch: 21 cost time: 1.3239285945892334
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.953 Vali Acc: 0.756 Test Loss: 0.953 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3862533569335938
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.955 Vali Acc: 0.756 Test Loss: 0.955 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.466127872467041
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.948 Vali Acc: 0.756 Test Loss: 0.948 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4818339347839355
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.934 Vali Acc: 0.761 Test Loss: 0.934 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.406270980834961
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4824538230895996
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.366999626159668
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.970 Vali Acc: 0.756 Test Loss: 0.970 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.316523551940918
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.756 Test Loss: 0.969 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2894511222839355
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.968 Vali Acc: 0.756 Test Loss: 0.968 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2799789905548096
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.965 Vali Acc: 0.756 Test Loss: 0.965 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 153510
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6544530391693115
Epoch: 1, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.489 Vali Acc: 0.417 Test Loss: 1.489 Test Acc: 0.417
Validation loss decreased (inf --> -0.416652).  Saving model ...
Epoch: 2 cost time: 2.1208653450012207
Epoch: 2, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.023 Vali Acc: 0.567 Test Loss: 1.023 Test Acc: 0.567
Validation loss decreased (-0.416652 --> -0.566656).  Saving model ...
Epoch: 3 cost time: 1.424861192703247
Epoch: 3, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.839 Vali Acc: 0.617 Test Loss: 0.839 Test Acc: 0.617
Validation loss decreased (-0.566656 --> -0.616658).  Saving model ...
Epoch: 4 cost time: 2.1588375568389893
Epoch: 4, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.732 Vali Acc: 0.711 Test Loss: 0.732 Test Acc: 0.711
Validation loss decreased (-0.616658 --> -0.711104).  Saving model ...
Epoch: 5 cost time: 2.2182722091674805
Epoch: 5, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.653 Vali Acc: 0.683 Test Loss: 0.653 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2131259441375732
Epoch: 6, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.646 Vali Acc: 0.733 Test Loss: 0.646 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733327).  Saving model ...
Epoch: 7 cost time: 2.0029616355895996
Epoch: 7, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.581 Vali Acc: 0.756 Test Loss: 0.581 Test Acc: 0.756
Validation loss decreased (-0.733327 --> -0.755550).  Saving model ...
Epoch: 8 cost time: 1.9904506206512451
Epoch: 8, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.561 Vali Acc: 0.761 Test Loss: 0.561 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 1.9093010425567627
Epoch: 9, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
Validation loss decreased (-0.761105 --> -0.783327).  Saving model ...
Epoch: 10 cost time: 1.9901542663574219
Epoch: 10, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.718 Vali Acc: 0.756 Test Loss: 0.718 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.184084177017212
Epoch: 11, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.605 Vali Acc: 0.767 Test Loss: 0.605 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2777132987976074
Epoch: 12, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.705 Vali Acc: 0.767 Test Loss: 0.705 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1939098834991455
Epoch: 13, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.680 Vali Acc: 0.756 Test Loss: 0.680 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7773168087005615
Epoch: 14, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.700 Vali Acc: 0.767 Test Loss: 0.700 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.169433116912842
Epoch: 15, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.719 Vali Acc: 0.772 Test Loss: 0.719 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1083881855010986
Epoch: 16, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.687 Vali Acc: 0.772 Test Loss: 0.687 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2131505012512207
Epoch: 17, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.731 Vali Acc: 0.778 Test Loss: 0.731 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.125131130218506
Epoch: 18, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.759 Vali Acc: 0.767 Test Loss: 0.759 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9272987842559814
Epoch: 19, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.792 Vali Acc: 0.789 Test Loss: 0.792 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788881).  Saving model ...
Epoch: 20 cost time: 2.173149347305298
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.772 Test Loss: 0.789 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9330828189849854
Epoch: 21, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.796 Vali Acc: 0.778 Test Loss: 0.796 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0007643699645996
Epoch: 22, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.765 Vali Acc: 0.772 Test Loss: 0.765 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9670746326446533
Epoch: 23, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.782 Vali Acc: 0.767 Test Loss: 0.782 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.91048002243042
Epoch: 24, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.806 Vali Acc: 0.778 Test Loss: 0.806 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.068525552749634
Epoch: 25, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.795 Vali Acc: 0.772 Test Loss: 0.795 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0202038288116455
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.809 Vali Acc: 0.778 Test Loss: 0.809 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.0646188259124756
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.809 Vali Acc: 0.778 Test Loss: 0.809 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.3010289669036865
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.810 Vali Acc: 0.778 Test Loss: 0.810 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9366438388824463
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.817 Vali Acc: 0.778 Test Loss: 0.817 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 116710
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.700517416000366
Epoch: 1, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.500 Vali Acc: 0.478 Test Loss: 1.500 Test Acc: 0.478
Validation loss decreased (inf --> -0.477763).  Saving model ...
Epoch: 2 cost time: 2.0477871894836426
Epoch: 2, Steps: 12 | Train Loss: 1.379 Vali Loss: 1.075 Vali Acc: 0.622 Test Loss: 1.075 Test Acc: 0.622
Validation loss decreased (-0.477763 --> -0.622211).  Saving model ...
Epoch: 3 cost time: 1.8960645198822021
Epoch: 3, Steps: 12 | Train Loss: 0.951 Vali Loss: 0.881 Vali Acc: 0.644 Test Loss: 0.881 Test Acc: 0.644
Validation loss decreased (-0.622211 --> -0.644436).  Saving model ...
Epoch: 4 cost time: 1.9464519023895264
Epoch: 4, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.733 Vali Acc: 0.650 Test Loss: 0.733 Test Acc: 0.650
Validation loss decreased (-0.644436 --> -0.649993).  Saving model ...
Epoch: 5 cost time: 2.150226354598999
Epoch: 5, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.681 Vali Acc: 0.717 Test Loss: 0.681 Test Acc: 0.717
Validation loss decreased (-0.649993 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 1.9158470630645752
Epoch: 6, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.619 Vali Acc: 0.722 Test Loss: 0.619 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 2.1048829555511475
Epoch: 7, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.622 Vali Acc: 0.761 Test Loss: 0.622 Test Acc: 0.761
Validation loss decreased (-0.722216 --> -0.761105).  Saving model ...
Epoch: 8 cost time: 2.1115801334381104
Epoch: 8, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.616 Vali Acc: 0.756 Test Loss: 0.616 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0619139671325684
Epoch: 9, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.613 Vali Acc: 0.744 Test Loss: 0.613 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0529263019561768
Epoch: 10, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.618 Vali Acc: 0.756 Test Loss: 0.618 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.042985677719116
Epoch: 11, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.638 Vali Acc: 0.756 Test Loss: 0.638 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1481614112854004
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.623 Vali Acc: 0.756 Test Loss: 0.623 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0169901847839355
Epoch: 13, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.620 Vali Acc: 0.767 Test Loss: 0.620 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 14 cost time: 2.012669086456299
Epoch: 14, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9639599323272705
Epoch: 15, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.740 Vali Acc: 0.767 Test Loss: 0.740 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.005751132965088
Epoch: 16, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.713 Vali Acc: 0.756 Test Loss: 0.713 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9224090576171875
Epoch: 17, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.706 Vali Acc: 0.761 Test Loss: 0.706 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8928000926971436
Epoch: 18, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.719 Vali Acc: 0.756 Test Loss: 0.719 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.1157515048980713
Epoch: 19, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.770 Vali Acc: 0.767 Test Loss: 0.770 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.011352777481079
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.712 Vali Acc: 0.778 Test Loss: 0.712 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 21 cost time: 1.7385623455047607
Epoch: 21, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.740 Vali Acc: 0.783 Test Loss: 0.740 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783326).  Saving model ...
Epoch: 22 cost time: 2.0857274532318115
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.767 Vali Acc: 0.778 Test Loss: 0.767 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9657211303710938
Epoch: 23, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.766 Vali Acc: 0.778 Test Loss: 0.766 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1835291385650635
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.752 Vali Acc: 0.778 Test Loss: 0.752 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.072126865386963
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.763 Vali Acc: 0.778 Test Loss: 0.763 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7546861171722412
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.781 Vali Acc: 0.772 Test Loss: 0.781 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7494349479675293
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.789 Vali Acc: 0.772 Test Loss: 0.789 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7343318462371826
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.774 Vali Acc: 0.772 Test Loss: 0.774 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.600395917892456
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.811 Vali Acc: 0.761 Test Loss: 0.811 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.682981014251709
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.802 Vali Acc: 0.778 Test Loss: 0.802 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.8199377059936523
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.810 Vali Acc: 0.767 Test Loss: 0.810 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 93734
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.979954242706299
Epoch: 1, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.579 Vali Acc: 0.400 Test Loss: 1.579 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 1.0714590549468994
Epoch: 2, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.202 Vali Acc: 0.622 Test Loss: 1.202 Test Acc: 0.622
Validation loss decreased (-0.399984 --> -0.622210).  Saving model ...
Epoch: 3 cost time: 1.1529977321624756
Epoch: 3, Steps: 12 | Train Loss: 1.067 Vali Loss: 0.961 Vali Acc: 0.628 Test Loss: 0.961 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627768).  Saving model ...
Epoch: 4 cost time: 1.0645720958709717
Epoch: 4, Steps: 12 | Train Loss: 0.895 Vali Loss: 0.833 Vali Acc: 0.656 Test Loss: 0.833 Test Acc: 0.656
Validation loss decreased (-0.627768 --> -0.655547).  Saving model ...
Epoch: 5 cost time: 1.0217039585113525
Epoch: 5, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.754 Vali Acc: 0.678 Test Loss: 0.754 Test Acc: 0.678
Validation loss decreased (-0.655547 --> -0.677770).  Saving model ...
Epoch: 6 cost time: 1.1680049896240234
Epoch: 6, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.698 Vali Acc: 0.728 Test Loss: 0.698 Test Acc: 0.728
Validation loss decreased (-0.677770 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 1.1318433284759521
Epoch: 7, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.682 Vali Acc: 0.722 Test Loss: 0.682 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0644772052764893
Epoch: 8, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.644 Vali Acc: 0.733 Test Loss: 0.644 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 1.1089985370635986
Epoch: 9, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.638 Vali Acc: 0.750 Test Loss: 0.638 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.109318494796753
Epoch: 10, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.600 Vali Acc: 0.750 Test Loss: 0.600 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.1517813205718994
Epoch: 11, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.628 Vali Acc: 0.744 Test Loss: 0.628 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.057706594467163
Epoch: 12, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.619 Vali Acc: 0.750 Test Loss: 0.619 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1037414073944092
Epoch: 13, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.612 Vali Acc: 0.761 Test Loss: 0.612 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761105).  Saving model ...
Epoch: 14 cost time: 1.128058910369873
Epoch: 14, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.607 Vali Acc: 0.750 Test Loss: 0.607 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.13883638381958
Epoch: 15, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.652 Vali Acc: 0.750 Test Loss: 0.652 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1327342987060547
Epoch: 16, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.644 Vali Acc: 0.711 Test Loss: 0.644 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1310312747955322
Epoch: 17, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.687 Vali Acc: 0.739 Test Loss: 0.687 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1637699604034424
Epoch: 18, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.671 Vali Acc: 0.739 Test Loss: 0.671 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2261412143707275
Epoch: 19, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.673 Vali Acc: 0.750 Test Loss: 0.673 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1542305946350098
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.698 Vali Acc: 0.744 Test Loss: 0.698 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1281018257141113
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.650 Vali Acc: 0.750 Test Loss: 0.650 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2177131175994873
Epoch: 22, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.710 Vali Acc: 0.728 Test Loss: 0.710 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2284033298492432
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.769 Vali Acc: 0.750 Test Loss: 0.769 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 75398
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8622992038726807
Epoch: 1, Steps: 12 | Train Loss: 1.720 Vali Loss: 1.604 Vali Acc: 0.344 Test Loss: 1.604 Test Acc: 0.344
Validation loss decreased (inf --> -0.344428).  Saving model ...
Epoch: 2 cost time: 1.1528360843658447
Epoch: 2, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.286 Vali Acc: 0.533 Test Loss: 1.286 Test Acc: 0.533
Validation loss decreased (-0.344428 --> -0.533320).  Saving model ...
Epoch: 3 cost time: 1.2454147338867188
Epoch: 3, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.047 Vali Acc: 0.628 Test Loss: 1.047 Test Acc: 0.628
Validation loss decreased (-0.533320 --> -0.627767).  Saving model ...
Epoch: 4 cost time: 1.2711241245269775
Epoch: 4, Steps: 12 | Train Loss: 0.925 Vali Loss: 0.935 Vali Acc: 0.633 Test Loss: 0.935 Test Acc: 0.633
Validation loss decreased (-0.627767 --> -0.633324).  Saving model ...
Epoch: 5 cost time: 1.1256983280181885
Epoch: 5, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.806 Vali Acc: 0.694 Test Loss: 0.806 Test Acc: 0.694
Validation loss decreased (-0.633324 --> -0.694436).  Saving model ...
Epoch: 6 cost time: 1.1596026420593262
Epoch: 6, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.736 Vali Acc: 0.733 Test Loss: 0.736 Test Acc: 0.733
Validation loss decreased (-0.694436 --> -0.733326).  Saving model ...
Epoch: 7 cost time: 1.196911096572876
Epoch: 7, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.686 Vali Acc: 0.722 Test Loss: 0.686 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.259878158569336
Epoch: 8, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.625 Vali Acc: 0.778 Test Loss: 0.625 Test Acc: 0.778
Validation loss decreased (-0.733326 --> -0.777772).  Saving model ...
Epoch: 9 cost time: 1.1043715476989746
Epoch: 9, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.602 Vali Acc: 0.750 Test Loss: 0.602 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2652149200439453
Epoch: 10, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.590 Vali Acc: 0.772 Test Loss: 0.590 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2378218173980713
Epoch: 11, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.559 Vali Acc: 0.772 Test Loss: 0.559 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2328109741210938
Epoch: 12, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.584 Vali Acc: 0.772 Test Loss: 0.584 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.200622797012329
Epoch: 13, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783327).  Saving model ...
Epoch: 14 cost time: 1.1774497032165527
Epoch: 14, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788883).  Saving model ...
Epoch: 15 cost time: 1.2266020774841309
Epoch: 15, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.602 Vali Acc: 0.767 Test Loss: 0.602 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2015495300292969
Epoch: 16, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.217322587966919
Epoch: 17, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.602 Vali Acc: 0.772 Test Loss: 0.602 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2356443405151367
Epoch: 18, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.623 Vali Acc: 0.767 Test Loss: 0.623 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.233217477798462
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.626 Vali Acc: 0.761 Test Loss: 0.626 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2136211395263672
Epoch: 20, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.623 Vali Acc: 0.772 Test Loss: 0.623 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2728943824768066
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.645 Vali Acc: 0.767 Test Loss: 0.645 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2797293663024902
Epoch: 22, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.654 Vali Acc: 0.767 Test Loss: 0.654 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.221999168395996
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.638 Vali Acc: 0.778 Test Loss: 0.638 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2603116035461426
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.654 Vali Acc: 0.778 Test Loss: 0.654 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 70854
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.737584352493286
Epoch: 1, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.209 Vali Acc: 0.550 Test Loss: 1.209 Test Acc: 0.550
Validation loss decreased (inf --> -0.549988).  Saving model ...
Epoch: 2 cost time: 2.225098133087158
Epoch: 2, Steps: 12 | Train Loss: 0.916 Vali Loss: 0.749 Vali Acc: 0.678 Test Loss: 0.749 Test Acc: 0.678
Validation loss decreased (-0.549988 --> -0.677770).  Saving model ...
Epoch: 3 cost time: 2.3172717094421387
Epoch: 3, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.819 Vali Acc: 0.700 Test Loss: 0.819 Test Acc: 0.700
Validation loss decreased (-0.677770 --> -0.699992).  Saving model ...
Epoch: 4 cost time: 2.0100791454315186
Epoch: 4, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.662 Vali Acc: 0.750 Test Loss: 0.662 Test Acc: 0.750
Validation loss decreased (-0.699992 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 1.94051194190979
Epoch: 5, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.562 Vali Acc: 0.778 Test Loss: 0.562 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777772).  Saving model ...
Epoch: 6 cost time: 2.0435972213745117
Epoch: 6, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.801 Vali Acc: 0.772 Test Loss: 0.801 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0929598808288574
Epoch: 7, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.821 Vali Acc: 0.761 Test Loss: 0.821 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0528059005737305
Epoch: 8, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.908 Vali Acc: 0.778 Test Loss: 0.908 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.148005247116089
Epoch: 9, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.829 Vali Acc: 0.767 Test Loss: 0.829 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0212721824645996
Epoch: 10, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.768 Vali Acc: 0.772 Test Loss: 0.768 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9718234539031982
Epoch: 11, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.046 Vali Acc: 0.772 Test Loss: 1.046 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4979748725891113
Epoch: 12, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.085 Vali Acc: 0.711 Test Loss: 1.085 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9054179191589355
Epoch: 13, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.411 Vali Acc: 0.772 Test Loss: 1.411 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.022382974624634
Epoch: 14, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.873 Vali Acc: 0.767 Test Loss: 0.873 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8282897472381592
Epoch: 15, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.280 Vali Acc: 0.744 Test Loss: 1.280 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 260774
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1684458255767822
Epoch: 1, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.395 Vali Acc: 0.489 Test Loss: 1.395 Test Acc: 0.489
Validation loss decreased (inf --> -0.488875).  Saving model ...
Epoch: 2 cost time: 1.4640614986419678
Epoch: 2, Steps: 12 | Train Loss: 1.222 Vali Loss: 0.911 Vali Acc: 0.606 Test Loss: 0.911 Test Acc: 0.606
Validation loss decreased (-0.488875 --> -0.605546).  Saving model ...
Epoch: 3 cost time: 1.7255573272705078
Epoch: 3, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.778 Vali Acc: 0.650 Test Loss: 0.778 Test Acc: 0.650
Validation loss decreased (-0.605546 --> -0.649992).  Saving model ...
Epoch: 4 cost time: 1.7470946311950684
Epoch: 4, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.694 Vali Acc: 0.689 Test Loss: 0.694 Test Acc: 0.689
Validation loss decreased (-0.649992 --> -0.688882).  Saving model ...
Epoch: 5 cost time: 1.638537883758545
Epoch: 5, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
Validation loss decreased (-0.688882 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 1.6712050437927246
Epoch: 6, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.617 Vali Acc: 0.733 Test Loss: 0.617 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6973235607147217
Epoch: 7, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.707 Vali Acc: 0.739 Test Loss: 0.707 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4332425594329834
Epoch: 8, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.782 Vali Acc: 0.722 Test Loss: 0.782 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2949204444885254
Epoch: 9, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.697 Vali Acc: 0.750 Test Loss: 0.697 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5223026275634766
Epoch: 10, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.752 Vali Acc: 0.756 Test Loss: 0.752 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755548).  Saving model ...
Epoch: 11 cost time: 1.61924409866333
Epoch: 11, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.660 Vali Acc: 0.761 Test Loss: 0.660 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761105).  Saving model ...
Epoch: 12 cost time: 1.4498686790466309
Epoch: 12, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.753 Vali Acc: 0.744 Test Loss: 0.753 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.760305643081665
Epoch: 13, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.702 Vali Acc: 0.772 Test Loss: 0.702 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772215).  Saving model ...
Epoch: 14 cost time: 1.8552577495574951
Epoch: 14, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.782 Vali Acc: 0.756 Test Loss: 0.782 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6175978183746338
Epoch: 15, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.829 Vali Acc: 0.772 Test Loss: 0.829 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6147069931030273
Epoch: 16, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.830 Vali Acc: 0.761 Test Loss: 0.830 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.618218183517456
Epoch: 17, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.791 Vali Acc: 0.750 Test Loss: 0.791 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.741213083267212
Epoch: 18, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.841 Vali Acc: 0.772 Test Loss: 0.841 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6667580604553223
Epoch: 19, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.046 Vali Acc: 0.750 Test Loss: 1.046 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5501601696014404
Epoch: 20, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.930 Vali Acc: 0.767 Test Loss: 0.930 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5768513679504395
Epoch: 21, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.864 Vali Acc: 0.772 Test Loss: 0.864 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6979238986968994
Epoch: 22, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.906 Vali Acc: 0.772 Test Loss: 0.906 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5587854385375977
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.915 Vali Acc: 0.778 Test Loss: 0.915 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777769).  Saving model ...
Epoch: 24 cost time: 1.4947428703308105
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.910 Vali Acc: 0.772 Test Loss: 0.910 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7983505725860596
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.899 Vali Acc: 0.772 Test Loss: 0.899 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9117021560668945
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.878 Vali Acc: 0.783 Test Loss: 0.878 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783325).  Saving model ...
Epoch: 27 cost time: 1.5741918087005615
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.896 Vali Acc: 0.772 Test Loss: 0.896 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6887779235839844
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.931 Vali Acc: 0.767 Test Loss: 0.931 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5483272075653076
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.921 Vali Acc: 0.767 Test Loss: 0.921 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7234671115875244
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.914 Vali Acc: 0.772 Test Loss: 0.914 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5934624671936035
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.778 Test Loss: 0.915 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8655121326446533
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.925 Vali Acc: 0.789 Test Loss: 0.925 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788880).  Saving model ...
Epoch: 33 cost time: 1.7700393199920654
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.949 Vali Acc: 0.761 Test Loss: 0.949 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6505942344665527
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.944 Vali Acc: 0.772 Test Loss: 0.944 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8690910339355469
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.949 Vali Acc: 0.772 Test Loss: 0.949 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7767879962921143
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.772 Test Loss: 0.954 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7557296752929688
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.767 Test Loss: 0.962 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.906219482421875
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.980 Vali Acc: 0.772 Test Loss: 0.980 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6633305549621582
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.772 Test Loss: 0.979 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.9553005695343018
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.778 Test Loss: 0.980 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.8631973266601562
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.979 Vali Acc: 0.778 Test Loss: 0.979 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.9367294311523438
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.767 Test Loss: 0.974 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 145606
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.577970266342163
Epoch: 1, Steps: 12 | Train Loss: 1.721 Vali Loss: 1.396 Vali Acc: 0.478 Test Loss: 1.396 Test Acc: 0.478
Validation loss decreased (inf --> -0.477764).  Saving model ...
Epoch: 2 cost time: 1.3102319240570068
Epoch: 2, Steps: 12 | Train Loss: 1.105 Vali Loss: 0.934 Vali Acc: 0.644 Test Loss: 0.934 Test Acc: 0.644
Validation loss decreased (-0.477764 --> -0.644435).  Saving model ...
Epoch: 3 cost time: 1.49784255027771
Epoch: 3, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.734 Vali Acc: 0.722 Test Loss: 0.734 Test Acc: 0.722
Validation loss decreased (-0.644435 --> -0.722215).  Saving model ...
Epoch: 4 cost time: 1.9858558177947998
Epoch: 4, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.676 Vali Acc: 0.711 Test Loss: 0.676 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.757547378540039
Epoch: 5, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.9562461376190186
Epoch: 6, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.593 Vali Acc: 0.750 Test Loss: 0.593 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 2.07761549949646
Epoch: 7, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0322768688201904
Epoch: 8, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.699 Vali Acc: 0.733 Test Loss: 0.699 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.03792667388916
Epoch: 9, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.733 Vali Acc: 0.744 Test Loss: 0.733 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1222503185272217
Epoch: 10, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.797 Vali Acc: 0.733 Test Loss: 0.797 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1263794898986816
Epoch: 11, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.751 Vali Acc: 0.750 Test Loss: 0.751 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.226653814315796
Epoch: 12, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.722 Vali Acc: 0.744 Test Loss: 0.722 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.921790361404419
Epoch: 13, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.755 Vali Acc: 0.761 Test Loss: 0.755 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761104).  Saving model ...
Epoch: 14 cost time: 1.7701945304870605
Epoch: 14, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.816 Vali Acc: 0.744 Test Loss: 0.816 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0297322273254395
Epoch: 15, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.773 Vali Acc: 0.756 Test Loss: 0.773 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5203874111175537
Epoch: 16, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.804 Vali Acc: 0.744 Test Loss: 0.804 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8016560077667236
Epoch: 17, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.945 Vali Acc: 0.761 Test Loss: 0.945 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8334500789642334
Epoch: 18, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.890 Vali Acc: 0.739 Test Loss: 0.890 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6402440071105957
Epoch: 19, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.848 Vali Acc: 0.772 Test Loss: 0.848 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772214).  Saving model ...
Epoch: 20 cost time: 1.608424186706543
Epoch: 20, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.915 Vali Acc: 0.744 Test Loss: 0.915 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0416533946990967
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.902 Vali Acc: 0.767 Test Loss: 0.902 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9073925018310547
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.886 Vali Acc: 0.750 Test Loss: 0.886 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9938757419586182
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.916 Vali Acc: 0.744 Test Loss: 0.916 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.883711338043213
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.902 Vali Acc: 0.744 Test Loss: 0.902 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8913593292236328
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.756 Test Loss: 0.906 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0547125339508057
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.912 Vali Acc: 0.750 Test Loss: 0.912 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8510148525238037
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.928 Vali Acc: 0.750 Test Loss: 0.928 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8920326232910156
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.940 Vali Acc: 0.744 Test Loss: 0.940 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9768943786621094
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.744 Test Loss: 0.936 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 141030
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6645658016204834
Epoch: 1, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.517 Vali Acc: 0.478 Test Loss: 1.517 Test Acc: 0.478
Validation loss decreased (inf --> -0.477763).  Saving model ...
Epoch: 2 cost time: 1.9076764583587646
Epoch: 2, Steps: 12 | Train Loss: 1.265 Vali Loss: 0.981 Vali Acc: 0.594 Test Loss: 0.981 Test Acc: 0.594
Validation loss decreased (-0.477763 --> -0.594435).  Saving model ...
Epoch: 3 cost time: 1.7476801872253418
Epoch: 3, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.805 Vali Acc: 0.644 Test Loss: 0.805 Test Acc: 0.644
Validation loss decreased (-0.594435 --> -0.644436).  Saving model ...
Epoch: 4 cost time: 1.7345006465911865
Epoch: 4, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.674 Vali Acc: 0.711 Test Loss: 0.674 Test Acc: 0.711
Validation loss decreased (-0.644436 --> -0.711104).  Saving model ...
Epoch: 5 cost time: 1.8221783638000488
Epoch: 5, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.606 Vali Acc: 0.767 Test Loss: 0.606 Test Acc: 0.767
Validation loss decreased (-0.711104 --> -0.766661).  Saving model ...
Epoch: 6 cost time: 1.9502804279327393
Epoch: 6, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.618 Vali Acc: 0.733 Test Loss: 0.618 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1626269817352295
Epoch: 7, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9295902252197266
Epoch: 8, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.567 Vali Acc: 0.767 Test Loss: 0.567 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766661).  Saving model ...
Epoch: 9 cost time: 1.948981761932373
Epoch: 9, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.601 Vali Acc: 0.767 Test Loss: 0.601 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.975398302078247
Epoch: 10, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.642 Vali Acc: 0.778 Test Loss: 0.642 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777771).  Saving model ...
Epoch: 11 cost time: 1.772958517074585
Epoch: 11, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.630 Vali Acc: 0.772 Test Loss: 0.630 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8657865524291992
Epoch: 12, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.719 Vali Acc: 0.761 Test Loss: 0.719 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8692400455474854
Epoch: 13, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 14 cost time: 1.8239080905914307
Epoch: 14, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.620 Vali Acc: 0.767 Test Loss: 0.620 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7529454231262207
Epoch: 15, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.727 Vali Acc: 0.772 Test Loss: 0.727 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8265106678009033
Epoch: 16, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.749 Vali Acc: 0.772 Test Loss: 0.749 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.806424617767334
Epoch: 17, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.958951473236084
Epoch: 18, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.735 Vali Acc: 0.778 Test Loss: 0.735 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9560730457305908
Epoch: 19, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8614635467529297
Epoch: 20, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.750 Vali Acc: 0.772 Test Loss: 0.750 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8376319408416748
Epoch: 21, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6255226135253906
Epoch: 22, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.751 Vali Acc: 0.772 Test Loss: 0.751 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8745660781860352
Epoch: 23, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.776 Vali Acc: 0.783 Test Loss: 0.776 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 104230
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6301138401031494
Epoch: 1, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.561 Vali Acc: 0.300 Test Loss: 1.561 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 2.0175509452819824
Epoch: 2, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.133 Vali Acc: 0.533 Test Loss: 1.133 Test Acc: 0.533
Validation loss decreased (-0.299984 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 2.0169870853424072
Epoch: 3, Steps: 12 | Train Loss: 0.949 Vali Loss: 0.911 Vali Acc: 0.628 Test Loss: 0.911 Test Acc: 0.628
Validation loss decreased (-0.533322 --> -0.627769).  Saving model ...
Epoch: 4 cost time: 1.8616273403167725
Epoch: 4, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.773 Vali Acc: 0.650 Test Loss: 0.773 Test Acc: 0.650
Validation loss decreased (-0.627769 --> -0.649992).  Saving model ...
Epoch: 5 cost time: 1.9130339622497559
Epoch: 5, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.739 Vali Acc: 0.661 Test Loss: 0.739 Test Acc: 0.661
Validation loss decreased (-0.649992 --> -0.661104).  Saving model ...
Epoch: 6 cost time: 1.7935340404510498
Epoch: 6, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.648 Vali Acc: 0.728 Test Loss: 0.648 Test Acc: 0.728
Validation loss decreased (-0.661104 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 1.7312452793121338
Epoch: 7, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 2.059368371963501
Epoch: 8, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.667 Vali Acc: 0.739 Test Loss: 0.667 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.964505910873413
Epoch: 9, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.653 Vali Acc: 0.739 Test Loss: 0.653 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.959507703781128
Epoch: 10, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.649 Vali Acc: 0.750 Test Loss: 0.649 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.9924941062927246
Epoch: 11, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.634 Vali Acc: 0.739 Test Loss: 0.634 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0063750743865967
Epoch: 12, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.624 Vali Acc: 0.739 Test Loss: 0.624 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9215335845947266
Epoch: 13, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.609 Vali Acc: 0.756 Test Loss: 0.609 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 2.0687406063079834
Epoch: 14, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.636 Vali Acc: 0.739 Test Loss: 0.636 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1034839153289795
Epoch: 15, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.663 Vali Acc: 0.739 Test Loss: 0.663 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0274317264556885
Epoch: 16, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.668 Vali Acc: 0.744 Test Loss: 0.668 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8800489902496338
Epoch: 17, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.686 Vali Acc: 0.750 Test Loss: 0.686 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6608588695526123
Epoch: 18, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.673 Vali Acc: 0.772 Test Loss: 0.673 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772215).  Saving model ...
Epoch: 19 cost time: 1.9080448150634766
Epoch: 19, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.719 Vali Acc: 0.744 Test Loss: 0.719 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.941927433013916
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.765 Vali Acc: 0.756 Test Loss: 0.765 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.075800895690918
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8350319862365723
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.759 Vali Acc: 0.756 Test Loss: 0.759 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8539927005767822
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.737 Vali Acc: 0.767 Test Loss: 0.737 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9070606231689453
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.768 Vali Acc: 0.744 Test Loss: 0.768 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9059202671051025
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.772 Vali Acc: 0.750 Test Loss: 0.772 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.0645320415496826
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.763 Vali Acc: 0.767 Test Loss: 0.763 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.0596261024475098
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.754 Vali Acc: 0.772 Test Loss: 0.754 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8632290363311768
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.769 Vali Acc: 0.761 Test Loss: 0.769 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 81254
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7739293575286865
Epoch: 1, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.619 Vali Acc: 0.367 Test Loss: 1.619 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 1.0911617279052734
Epoch: 2, Steps: 12 | Train Loss: 1.530 Vali Loss: 1.269 Vali Acc: 0.539 Test Loss: 1.269 Test Acc: 0.539
Validation loss decreased (-0.366650 --> -0.538876).  Saving model ...
Epoch: 3 cost time: 1.0446043014526367
Epoch: 3, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.031 Vali Acc: 0.606 Test Loss: 1.031 Test Acc: 0.606
Validation loss decreased (-0.538876 --> -0.605545).  Saving model ...
Epoch: 4 cost time: 1.0271248817443848
Epoch: 4, Steps: 12 | Train Loss: 0.892 Vali Loss: 0.896 Vali Acc: 0.622 Test Loss: 0.896 Test Acc: 0.622
Validation loss decreased (-0.605545 --> -0.622213).  Saving model ...
Epoch: 5 cost time: 1.0503365993499756
Epoch: 5, Steps: 12 | Train Loss: 0.771 Vali Loss: 0.799 Vali Acc: 0.683 Test Loss: 0.799 Test Acc: 0.683
Validation loss decreased (-0.622213 --> -0.683325).  Saving model ...
Epoch: 6 cost time: 1.1443934440612793
Epoch: 6, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.736 Vali Acc: 0.700 Test Loss: 0.736 Test Acc: 0.700
Validation loss decreased (-0.683325 --> -0.699993).  Saving model ...
Epoch: 7 cost time: 1.060847282409668
Epoch: 7, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.669 Vali Acc: 0.717 Test Loss: 0.669 Test Acc: 0.717
Validation loss decreased (-0.699993 --> -0.716660).  Saving model ...
Epoch: 8 cost time: 1.127594232559204
Epoch: 8, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.662 Vali Acc: 0.739 Test Loss: 0.662 Test Acc: 0.739
Validation loss decreased (-0.716660 --> -0.738882).  Saving model ...
Epoch: 9 cost time: 1.0682556629180908
Epoch: 9, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.637 Vali Acc: 0.733 Test Loss: 0.637 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0448236465454102
Epoch: 10, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.627 Vali Acc: 0.756 Test Loss: 0.627 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 11 cost time: 1.0260767936706543
Epoch: 11, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.610 Vali Acc: 0.756 Test Loss: 0.610 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 12 cost time: 1.1207518577575684
Epoch: 12, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.638 Vali Acc: 0.756 Test Loss: 0.638 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1903491020202637
Epoch: 13, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.585 Vali Acc: 0.756 Test Loss: 0.585 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755550).  Saving model ...
Epoch: 14 cost time: 1.0263400077819824
Epoch: 14, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2410850524902344
Epoch: 15, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1773889064788818
Epoch: 16, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.614 Vali Acc: 0.744 Test Loss: 0.614 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.085460901260376
Epoch: 17, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.680 Vali Acc: 0.750 Test Loss: 0.680 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0080809593200684
Epoch: 18, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.605 Vali Acc: 0.761 Test Loss: 0.605 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761105).  Saving model ...
Epoch: 19 cost time: 1.082719326019287
Epoch: 19, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.655 Vali Acc: 0.767 Test Loss: 0.655 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 20 cost time: 0.9948673248291016
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.651 Vali Acc: 0.756 Test Loss: 0.651 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0978262424468994
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.675 Vali Acc: 0.767 Test Loss: 0.675 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1097924709320068
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.685 Vali Acc: 0.767 Test Loss: 0.685 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0906872749328613
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.680 Vali Acc: 0.761 Test Loss: 0.680 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1511733531951904
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.672 Vali Acc: 0.767 Test Loss: 0.672 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0570032596588135
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.682 Vali Acc: 0.767 Test Loss: 0.682 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1638739109039307
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.716 Vali Acc: 0.767 Test Loss: 0.716 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2253401279449463
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.711 Vali Acc: 0.767 Test Loss: 0.711 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1449222564697266
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.733 Vali Acc: 0.772 Test Loss: 0.733 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772215).  Saving model ...
Epoch: 29 cost time: 1.142805576324463
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.707 Vali Acc: 0.778 Test Loss: 0.707 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 30 cost time: 1.26939058303833
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.704 Vali Acc: 0.778 Test Loss: 0.704 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 31 cost time: 1.08078932762146
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.731 Vali Acc: 0.778 Test Loss: 0.731 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0591983795166016
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.724 Vali Acc: 0.772 Test Loss: 0.724 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1616926193237305
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.736 Vali Acc: 0.772 Test Loss: 0.736 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.365025520324707
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.739 Vali Acc: 0.767 Test Loss: 0.739 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1880497932434082
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.693 Vali Acc: 0.789 Test Loss: 0.693 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 36 cost time: 1.210791826248169
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.727 Vali Acc: 0.789 Test Loss: 0.727 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2486228942871094
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.764 Vali Acc: 0.761 Test Loss: 0.764 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1534669399261475
Epoch: 38, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.793 Vali Acc: 0.744 Test Loss: 0.793 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0831842422485352
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.798 Vali Acc: 0.772 Test Loss: 0.798 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0894412994384766
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.793 Vali Acc: 0.756 Test Loss: 0.793 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1058454513549805
Epoch: 41, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.770 Vali Acc: 0.767 Test Loss: 0.770 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0872282981872559
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.750 Vali Acc: 0.772 Test Loss: 0.750 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1246790885925293
Epoch: 43, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.754 Vali Acc: 0.778 Test Loss: 0.754 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1642601490020752
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.778 Vali Acc: 0.767 Test Loss: 0.778 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.1947484016418457
Epoch: 45, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.780 Vali Acc: 0.772 Test Loss: 0.780 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 62918
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.022735834121704
Epoch: 1, Steps: 12 | Train Loss: 1.922 Vali Loss: 1.736 Vali Acc: 0.272 Test Loss: 1.736 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 1.1629953384399414
Epoch: 2, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.415 Vali Acc: 0.494 Test Loss: 1.415 Test Acc: 0.494
Validation loss decreased (-0.272205 --> -0.494430).  Saving model ...
Epoch: 3 cost time: 1.1833467483520508
Epoch: 3, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.121 Vali Acc: 0.572 Test Loss: 1.121 Test Acc: 0.572
Validation loss decreased (-0.494430 --> -0.572211).  Saving model ...
Epoch: 4 cost time: 1.1002051830291748
Epoch: 4, Steps: 12 | Train Loss: 1.042 Vali Loss: 0.966 Vali Acc: 0.600 Test Loss: 0.966 Test Acc: 0.600
Validation loss decreased (-0.572211 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 1.218078851699829
Epoch: 5, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.840 Vali Acc: 0.644 Test Loss: 0.840 Test Acc: 0.644
Validation loss decreased (-0.599990 --> -0.644436).  Saving model ...
Epoch: 6 cost time: 1.2048211097717285
Epoch: 6, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.761 Vali Acc: 0.672 Test Loss: 0.761 Test Acc: 0.672
Validation loss decreased (-0.644436 --> -0.672215).  Saving model ...
Epoch: 7 cost time: 1.1564435958862305
Epoch: 7, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.701 Vali Acc: 0.694 Test Loss: 0.701 Test Acc: 0.694
Validation loss decreased (-0.672215 --> -0.694437).  Saving model ...
Epoch: 8 cost time: 1.2330336570739746
Epoch: 8, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.686 Vali Acc: 0.728 Test Loss: 0.686 Test Acc: 0.728
Validation loss decreased (-0.694437 --> -0.727771).  Saving model ...
Epoch: 9 cost time: 1.2367961406707764
Epoch: 9, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.635 Vali Acc: 0.750 Test Loss: 0.635 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.041823148727417
Epoch: 10, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.625 Vali Acc: 0.761 Test Loss: 0.625 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761105).  Saving model ...
Epoch: 11 cost time: 1.107849359512329
Epoch: 11, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.614 Vali Acc: 0.756 Test Loss: 0.614 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1503489017486572
Epoch: 12, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.635 Vali Acc: 0.767 Test Loss: 0.635 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 13 cost time: 1.2008721828460693
Epoch: 13, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.609 Vali Acc: 0.756 Test Loss: 0.609 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.088282823562622
Epoch: 14, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.640 Vali Acc: 0.756 Test Loss: 0.640 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1273257732391357
Epoch: 15, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.581 Vali Acc: 0.767 Test Loss: 0.581 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766661).  Saving model ...
Epoch: 16 cost time: 1.087721824645996
Epoch: 16, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.644 Vali Acc: 0.767 Test Loss: 0.644 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1321229934692383
Epoch: 17, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.624 Vali Acc: 0.767 Test Loss: 0.624 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1753320693969727
Epoch: 18, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.642 Vali Acc: 0.761 Test Loss: 0.642 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.201066493988037
Epoch: 19, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.680 Vali Acc: 0.756 Test Loss: 0.680 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1002552509307861
Epoch: 20, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.685 Vali Acc: 0.767 Test Loss: 0.685 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1711034774780273
Epoch: 21, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.655 Vali Acc: 0.761 Test Loss: 0.655 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.13301420211792
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.684 Vali Acc: 0.756 Test Loss: 0.684 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0801727771759033
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.699 Vali Acc: 0.772 Test Loss: 0.699 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772215).  Saving model ...
Epoch: 24 cost time: 1.1030278205871582
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.696 Vali Acc: 0.761 Test Loss: 0.696 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1978557109832764
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.715 Vali Acc: 0.767 Test Loss: 0.715 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.050957202911377
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.713 Vali Acc: 0.767 Test Loss: 0.713 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.105614423751831
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.693 Vali Acc: 0.772 Test Loss: 0.693 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 28 cost time: 0.9838433265686035
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.710 Vali Acc: 0.767 Test Loss: 0.710 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0672755241394043
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.721 Vali Acc: 0.772 Test Loss: 0.721 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0749351978302002
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.734 Vali Acc: 0.767 Test Loss: 0.734 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0737032890319824
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.721 Vali Acc: 0.761 Test Loss: 0.721 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9784152507781982
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.733 Vali Acc: 0.761 Test Loss: 0.733 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.013118028640747
Epoch: 33, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.726 Vali Acc: 0.772 Test Loss: 0.726 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0338916778564453
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.728 Vali Acc: 0.761 Test Loss: 0.728 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0682730674743652
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.726 Vali Acc: 0.761 Test Loss: 0.726 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1495769023895264
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.732 Vali Acc: 0.761 Test Loss: 0.732 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0678927898406982
Epoch: 37, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.749 Vali Acc: 0.767 Test Loss: 0.749 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm32_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 58374
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6131033897399902
Epoch: 1, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.394 Vali Acc: 0.467 Test Loss: 1.394 Test Acc: 0.467
Validation loss decreased (inf --> -0.466653).  Saving model ...
Epoch: 2 cost time: 1.4673256874084473
Epoch: 2, Steps: 12 | Train Loss: 1.184 Vali Loss: 0.918 Vali Acc: 0.633 Test Loss: 0.918 Test Acc: 0.633
Validation loss decreased (-0.466653 --> -0.633324).  Saving model ...
Epoch: 3 cost time: 1.558464765548706
Epoch: 3, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.896 Vali Acc: 0.622 Test Loss: 0.896 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5370142459869385
Epoch: 4, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.666 Vali Acc: 0.739 Test Loss: 0.666 Test Acc: 0.739
Validation loss decreased (-0.633324 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 1.565561294555664
Epoch: 5, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.634 Vali Acc: 0.733 Test Loss: 0.634 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6175389289855957
Epoch: 6, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.610 Vali Acc: 0.767 Test Loss: 0.610 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 1.488095760345459
Epoch: 7, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.730 Vali Acc: 0.739 Test Loss: 0.730 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5272784233093262
Epoch: 8, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.659 Vali Acc: 0.767 Test Loss: 0.659 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.57041597366333
Epoch: 9, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.625 Vali Acc: 0.767 Test Loss: 0.625 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7104253768920898
Epoch: 10, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.753 Vali Acc: 0.744 Test Loss: 0.753 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.447916030883789
Epoch: 11, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.673 Vali Acc: 0.767 Test Loss: 0.673 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3721332550048828
Epoch: 12, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.825 Vali Acc: 0.761 Test Loss: 0.825 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7032358646392822
Epoch: 13, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.796 Vali Acc: 0.744 Test Loss: 0.796 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4850132465362549
Epoch: 14, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.761 Vali Acc: 0.778 Test Loss: 0.761 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 1.5717482566833496
Epoch: 15, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.774 Vali Acc: 0.772 Test Loss: 0.774 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7223334312438965
Epoch: 16, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.780 Vali Acc: 0.772 Test Loss: 0.780 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4723877906799316
Epoch: 17, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.784 Vali Acc: 0.783 Test Loss: 0.784 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783325).  Saving model ...
Epoch: 18 cost time: 1.3920161724090576
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.838 Vali Acc: 0.778 Test Loss: 0.838 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5694482326507568
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.816 Vali Acc: 0.767 Test Loss: 0.816 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6337506771087646
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.813 Vali Acc: 0.772 Test Loss: 0.813 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4853167533874512
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.837 Vali Acc: 0.767 Test Loss: 0.837 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3834683895111084
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.855 Vali Acc: 0.767 Test Loss: 0.855 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.657557487487793
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.852 Vali Acc: 0.772 Test Loss: 0.852 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6648025512695312
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.864 Vali Acc: 0.772 Test Loss: 0.864 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5315239429473877
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.874 Vali Acc: 0.761 Test Loss: 0.874 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.63722825050354
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.778 Test Loss: 0.853 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3455407619476318
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.863 Vali Acc: 0.767 Test Loss: 0.863 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 146422
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.170790195465088
Epoch: 1, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.545 Vali Acc: 0.433 Test Loss: 1.545 Test Acc: 0.433
Validation loss decreased (inf --> -0.433318).  Saving model ...
Epoch: 2 cost time: 1.3918423652648926
Epoch: 2, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.103 Vali Acc: 0.594 Test Loss: 1.103 Test Acc: 0.594
Validation loss decreased (-0.433318 --> -0.594433).  Saving model ...
Epoch: 3 cost time: 1.1656203269958496
Epoch: 3, Steps: 12 | Train Loss: 1.008 Vali Loss: 0.849 Vali Acc: 0.611 Test Loss: 0.849 Test Acc: 0.611
Validation loss decreased (-0.594433 --> -0.611103).  Saving model ...
Epoch: 4 cost time: 1.2720685005187988
Epoch: 4, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.785 Vali Acc: 0.667 Test Loss: 0.785 Test Acc: 0.667
Validation loss decreased (-0.611103 --> -0.666659).  Saving model ...
Epoch: 5 cost time: 1.37709379196167
Epoch: 5, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.679 Vali Acc: 0.711 Test Loss: 0.679 Test Acc: 0.711
Validation loss decreased (-0.666659 --> -0.711104).  Saving model ...
Epoch: 6 cost time: 1.2466113567352295
Epoch: 6, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.614 Vali Acc: 0.756 Test Loss: 0.614 Test Acc: 0.756
Validation loss decreased (-0.711104 --> -0.755549).  Saving model ...
Epoch: 7 cost time: 1.25537109375
Epoch: 7, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.611 Vali Acc: 0.756 Test Loss: 0.611 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 8 cost time: 1.4063215255737305
Epoch: 8, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.635 Vali Acc: 0.739 Test Loss: 0.635 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1899535655975342
Epoch: 9, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.248793601989746
Epoch: 10, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.661 Vali Acc: 0.761 Test Loss: 0.661 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 11 cost time: 1.1901514530181885
Epoch: 11, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3057477474212646
Epoch: 12, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.602 Vali Acc: 0.772 Test Loss: 0.602 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772216).  Saving model ...
Epoch: 13 cost time: 1.4440665245056152
Epoch: 13, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.645 Vali Acc: 0.772 Test Loss: 0.645 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4092655181884766
Epoch: 14, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.662 Vali Acc: 0.761 Test Loss: 0.662 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3274126052856445
Epoch: 15, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.709 Vali Acc: 0.756 Test Loss: 0.709 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2457549571990967
Epoch: 16, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.667 Vali Acc: 0.772 Test Loss: 0.667 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.282620906829834
Epoch: 17, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.715 Vali Acc: 0.772 Test Loss: 0.715 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2063422203063965
Epoch: 18, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.705 Vali Acc: 0.761 Test Loss: 0.705 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2942116260528564
Epoch: 19, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.707 Vali Acc: 0.772 Test Loss: 0.707 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2984373569488525
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.693 Vali Acc: 0.761 Test Loss: 0.693 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1895806789398193
Epoch: 21, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.748 Vali Acc: 0.744 Test Loss: 0.748 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3422253131866455
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.754 Vali Acc: 0.761 Test Loss: 0.754 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 88838
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3816471099853516
Epoch: 1, Steps: 12 | Train Loss: 1.895 Vali Loss: 1.592 Vali Acc: 0.389 Test Loss: 1.592 Test Acc: 0.389
Validation loss decreased (inf --> -0.388873).  Saving model ...
Epoch: 2 cost time: 1.4434583187103271
Epoch: 2, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.152 Vali Acc: 0.606 Test Loss: 1.152 Test Acc: 0.606
Validation loss decreased (-0.388873 --> -0.605544).  Saving model ...
Epoch: 3 cost time: 1.2511930465698242
Epoch: 3, Steps: 12 | Train Loss: 1.042 Vali Loss: 0.918 Vali Acc: 0.622 Test Loss: 0.918 Test Acc: 0.622
Validation loss decreased (-0.605544 --> -0.622213).  Saving model ...
Epoch: 4 cost time: 1.3534185886383057
Epoch: 4, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.779 Vali Acc: 0.656 Test Loss: 0.779 Test Acc: 0.656
Validation loss decreased (-0.622213 --> -0.655548).  Saving model ...
Epoch: 5 cost time: 1.3516135215759277
Epoch: 5, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.709 Vali Acc: 0.678 Test Loss: 0.709 Test Acc: 0.678
Validation loss decreased (-0.655548 --> -0.677771).  Saving model ...
Epoch: 6 cost time: 1.4230363368988037
Epoch: 6, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.695 Vali Acc: 0.700 Test Loss: 0.695 Test Acc: 0.700
Validation loss decreased (-0.677771 --> -0.699993).  Saving model ...
Epoch: 7 cost time: 1.457075834274292
Epoch: 7, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.615 Vali Acc: 0.739 Test Loss: 0.615 Test Acc: 0.739
Validation loss decreased (-0.699993 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 1.119765043258667
Epoch: 8, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.552 Vali Acc: 0.767 Test Loss: 0.552 Test Acc: 0.767
Validation loss decreased (-0.738883 --> -0.766661).  Saving model ...
Epoch: 9 cost time: 1.4966375827789307
Epoch: 9, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.672 Vali Acc: 0.739 Test Loss: 0.672 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4896345138549805
Epoch: 10, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.645 Vali Acc: 0.744 Test Loss: 0.645 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4224233627319336
Epoch: 11, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.683 Vali Acc: 0.750 Test Loss: 0.683 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5025975704193115
Epoch: 12, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.624 Vali Acc: 0.739 Test Loss: 0.624 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4843823909759521
Epoch: 13, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4588720798492432
Epoch: 14, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.699 Vali Acc: 0.756 Test Loss: 0.699 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4070641994476318
Epoch: 15, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.687 Vali Acc: 0.756 Test Loss: 0.687 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3030040264129639
Epoch: 16, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.660 Vali Acc: 0.772 Test Loss: 0.660 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 17 cost time: 1.3355355262756348
Epoch: 17, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.690 Vali Acc: 0.767 Test Loss: 0.690 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2894597053527832
Epoch: 18, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.695 Vali Acc: 0.767 Test Loss: 0.695 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3719723224639893
Epoch: 19, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.722 Vali Acc: 0.733 Test Loss: 0.722 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2981352806091309
Epoch: 20, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.727 Vali Acc: 0.761 Test Loss: 0.727 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.419313907623291
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.419224739074707
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.715 Vali Acc: 0.767 Test Loss: 0.715 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4527955055236816
Epoch: 23, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.720 Vali Acc: 0.772 Test Loss: 0.720 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.351759433746338
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.719 Vali Acc: 0.761 Test Loss: 0.719 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4412360191345215
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.704 Vali Acc: 0.772 Test Loss: 0.704 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3576319217681885
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.733 Vali Acc: 0.767 Test Loss: 0.733 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 86550
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0835981369018555
Epoch: 1, Steps: 12 | Train Loss: 1.905 Vali Loss: 1.623 Vali Acc: 0.356 Test Loss: 1.623 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 1.2118251323699951
Epoch: 2, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.233 Vali Acc: 0.589 Test Loss: 1.233 Test Acc: 0.589
Validation loss decreased (-0.355539 --> -0.588877).  Saving model ...
Epoch: 3 cost time: 1.0805411338806152
Epoch: 3, Steps: 12 | Train Loss: 1.121 Vali Loss: 0.974 Vali Acc: 0.606 Test Loss: 0.974 Test Acc: 0.606
Validation loss decreased (-0.588877 --> -0.605546).  Saving model ...
Epoch: 4 cost time: 1.17850923538208
Epoch: 4, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.833 Vali Acc: 0.678 Test Loss: 0.833 Test Acc: 0.678
Validation loss decreased (-0.605546 --> -0.677769).  Saving model ...
Epoch: 5 cost time: 1.2981226444244385
Epoch: 5, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.762 Vali Acc: 0.667 Test Loss: 0.762 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1539459228515625
Epoch: 6, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.659 Vali Acc: 0.717 Test Loss: 0.659 Test Acc: 0.717
Validation loss decreased (-0.677769 --> -0.716660).  Saving model ...
Epoch: 7 cost time: 1.286198616027832
Epoch: 7, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.616 Vali Acc: 0.744 Test Loss: 0.616 Test Acc: 0.744
Validation loss decreased (-0.716660 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 1.2258186340332031
Epoch: 8, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.628 Vali Acc: 0.744 Test Loss: 0.628 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1829957962036133
Epoch: 9, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.574 Vali Acc: 0.778 Test Loss: 0.574 Test Acc: 0.778
Validation loss decreased (-0.744438 --> -0.777772).  Saving model ...
Epoch: 10 cost time: 1.2317204475402832
Epoch: 10, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.613 Vali Acc: 0.761 Test Loss: 0.613 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1342968940734863
Epoch: 11, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.571 Vali Acc: 0.789 Test Loss: 0.571 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788883).  Saving model ...
Epoch: 12 cost time: 1.310732364654541
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.583 Vali Acc: 0.744 Test Loss: 0.583 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2398841381072998
Epoch: 13, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.581 Vali Acc: 0.778 Test Loss: 0.581 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1803569793701172
Epoch: 14, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.595 Vali Acc: 0.772 Test Loss: 0.595 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2988216876983643
Epoch: 15, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.606 Vali Acc: 0.772 Test Loss: 0.606 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2534854412078857
Epoch: 16, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.596 Vali Acc: 0.772 Test Loss: 0.596 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.327942132949829
Epoch: 17, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.610 Vali Acc: 0.772 Test Loss: 0.610 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2255985736846924
Epoch: 18, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.624 Vali Acc: 0.778 Test Loss: 0.624 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1943280696868896
Epoch: 19, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.638 Vali Acc: 0.767 Test Loss: 0.638 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1940913200378418
Epoch: 20, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.651 Vali Acc: 0.761 Test Loss: 0.651 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2325189113616943
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.658 Vali Acc: 0.761 Test Loss: 0.658 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 68150
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.865577459335327
Epoch: 1, Steps: 12 | Train Loss: 1.910 Vali Loss: 1.703 Vali Acc: 0.356 Test Loss: 1.703 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 1.1339404582977295
Epoch: 2, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.373 Vali Acc: 0.522 Test Loss: 1.373 Test Acc: 0.522
Validation loss decreased (-0.355539 --> -0.522208).  Saving model ...
Epoch: 3 cost time: 1.2127878665924072
Epoch: 3, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.102 Vali Acc: 0.583 Test Loss: 1.102 Test Acc: 0.583
Validation loss decreased (-0.522208 --> -0.583322).  Saving model ...
Epoch: 4 cost time: 1.3185651302337646
Epoch: 4, Steps: 12 | Train Loss: 1.051 Vali Loss: 0.946 Vali Acc: 0.594 Test Loss: 0.946 Test Acc: 0.594
Validation loss decreased (-0.583322 --> -0.594435).  Saving model ...
Epoch: 5 cost time: 1.2506320476531982
Epoch: 5, Steps: 12 | Train Loss: 0.853 Vali Loss: 0.844 Vali Acc: 0.639 Test Loss: 0.844 Test Acc: 0.639
Validation loss decreased (-0.594435 --> -0.638880).  Saving model ...
Epoch: 6 cost time: 1.2555463314056396
Epoch: 6, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.764 Vali Acc: 0.672 Test Loss: 0.764 Test Acc: 0.672
Validation loss decreased (-0.638880 --> -0.672215).  Saving model ...
Epoch: 7 cost time: 1.0930061340332031
Epoch: 7, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.693 Vali Acc: 0.694 Test Loss: 0.693 Test Acc: 0.694
Validation loss decreased (-0.672215 --> -0.694438).  Saving model ...
Epoch: 8 cost time: 1.3091933727264404
Epoch: 8, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.662 Vali Acc: 0.733 Test Loss: 0.662 Test Acc: 0.733
Validation loss decreased (-0.694438 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 1.4044103622436523
Epoch: 9, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.637 Vali Acc: 0.728 Test Loss: 0.637 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3765861988067627
Epoch: 10, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.615 Vali Acc: 0.700 Test Loss: 0.615 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2190346717834473
Epoch: 11, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.615 Vali Acc: 0.722 Test Loss: 0.615 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1081006526947021
Epoch: 12, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.611 Vali Acc: 0.728 Test Loss: 0.611 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1866438388824463
Epoch: 13, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.624 Vali Acc: 0.722 Test Loss: 0.624 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3212871551513672
Epoch: 14, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.602 Vali Acc: 0.711 Test Loss: 0.602 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2176685333251953
Epoch: 15, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1375339031219482
Epoch: 16, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.616 Vali Acc: 0.739 Test Loss: 0.616 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738883).  Saving model ...
Epoch: 17 cost time: 1.1908156871795654
Epoch: 17, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.649 Vali Acc: 0.739 Test Loss: 0.649 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3699078559875488
Epoch: 18, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.614 Vali Acc: 0.717 Test Loss: 0.614 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3492178916931152
Epoch: 19, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.652 Vali Acc: 0.722 Test Loss: 0.652 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.297424077987671
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.670 Vali Acc: 0.750 Test Loss: 0.670 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 1.2993967533111572
Epoch: 21, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.653 Vali Acc: 0.739 Test Loss: 0.653 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1126935482025146
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.664 Vali Acc: 0.733 Test Loss: 0.664 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3811447620391846
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.649 Vali Acc: 0.728 Test Loss: 0.649 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.283388376235962
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.688 Vali Acc: 0.744 Test Loss: 0.688 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1267333030700684
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.705 Vali Acc: 0.739 Test Loss: 0.705 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2416749000549316
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.696 Vali Acc: 0.722 Test Loss: 0.696 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1376230716705322
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.704 Vali Acc: 0.728 Test Loss: 0.704 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1476874351501465
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.721 Vali Acc: 0.739 Test Loss: 0.721 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3768212795257568
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1623528003692627
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.729 Vali Acc: 0.739 Test Loss: 0.729 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.75
model parameter : 56662
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.900115966796875
Epoch: 1, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.708 Vali Acc: 0.328 Test Loss: 1.708 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 1.1837270259857178
Epoch: 2, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.468 Vali Acc: 0.444 Test Loss: 1.468 Test Acc: 0.444
Validation loss decreased (-0.327761 --> -0.444430).  Saving model ...
Epoch: 3 cost time: 1.1627914905548096
Epoch: 3, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.245 Vali Acc: 0.494 Test Loss: 1.245 Test Acc: 0.494
Validation loss decreased (-0.444430 --> -0.494432).  Saving model ...
Epoch: 4 cost time: 1.2264111042022705
Epoch: 4, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.075 Vali Acc: 0.561 Test Loss: 1.075 Test Acc: 0.561
Validation loss decreased (-0.494432 --> -0.561100).  Saving model ...
Epoch: 5 cost time: 1.100513219833374
Epoch: 5, Steps: 12 | Train Loss: 0.995 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
Validation loss decreased (-0.561100 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 1.1736202239990234
Epoch: 6, Steps: 12 | Train Loss: 0.861 Vali Loss: 0.891 Vali Acc: 0.639 Test Loss: 0.891 Test Acc: 0.639
Validation loss decreased (-0.599990 --> -0.638880).  Saving model ...
Epoch: 7 cost time: 1.1866135597229004
Epoch: 7, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.830 Vali Acc: 0.633 Test Loss: 0.830 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0062639713287354
Epoch: 8, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.744 Vali Acc: 0.661 Test Loss: 0.744 Test Acc: 0.661
Validation loss decreased (-0.638880 --> -0.661104).  Saving model ...
Epoch: 9 cost time: 1.1377878189086914
Epoch: 9, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.722 Vali Acc: 0.683 Test Loss: 0.722 Test Acc: 0.683
Validation loss decreased (-0.661104 --> -0.683326).  Saving model ...
Epoch: 10 cost time: 1.149519681930542
Epoch: 10, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.702 Vali Acc: 0.694 Test Loss: 0.702 Test Acc: 0.694
Validation loss decreased (-0.683326 --> -0.694437).  Saving model ...
Epoch: 11 cost time: 1.1826324462890625
Epoch: 11, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.666 Vali Acc: 0.706 Test Loss: 0.666 Test Acc: 0.706
Validation loss decreased (-0.694437 --> -0.705549).  Saving model ...
Epoch: 12 cost time: 1.1027920246124268
Epoch: 12, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.657 Vali Acc: 0.711 Test Loss: 0.657 Test Acc: 0.711
Validation loss decreased (-0.705549 --> -0.711105).  Saving model ...
Epoch: 13 cost time: 1.1568901538848877
Epoch: 13, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.649 Vali Acc: 0.728 Test Loss: 0.649 Test Acc: 0.728
Validation loss decreased (-0.711105 --> -0.727771).  Saving model ...
Epoch: 14 cost time: 1.1280503273010254
Epoch: 14, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.620 Vali Acc: 0.744 Test Loss: 0.620 Test Acc: 0.744
Validation loss decreased (-0.727771 --> -0.744438).  Saving model ...
Epoch: 15 cost time: 1.1737325191497803
Epoch: 15, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.626 Vali Acc: 0.744 Test Loss: 0.626 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2067747116088867
Epoch: 16, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.623 Vali Acc: 0.728 Test Loss: 0.623 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1682851314544678
Epoch: 17, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.600 Vali Acc: 0.728 Test Loss: 0.600 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0696663856506348
Epoch: 18, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.616 Vali Acc: 0.744 Test Loss: 0.616 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 19 cost time: 1.0863258838653564
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.640 Vali Acc: 0.728 Test Loss: 0.640 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0741841793060303
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.631 Vali Acc: 0.728 Test Loss: 0.631 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.149317741394043
Epoch: 21, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.604 Vali Acc: 0.733 Test Loss: 0.604 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.150519609451294
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.636 Vali Acc: 0.733 Test Loss: 0.636 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1431033611297607
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.650 Vali Acc: 0.733 Test Loss: 0.650 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0748343467712402
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.622 Vali Acc: 0.744 Test Loss: 0.622 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1000745296478271
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.644 Vali Acc: 0.739 Test Loss: 0.644 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0497462749481201
Epoch: 26, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.669 Vali Acc: 0.744 Test Loss: 0.669 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1934680938720703
Epoch: 27, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.657 Vali Acc: 0.739 Test Loss: 0.657 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0392811298370361
Epoch: 28, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.675 Vali Acc: 0.739 Test Loss: 0.675 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 47494
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.852794647216797
Epoch: 1, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.722 Vali Acc: 0.350 Test Loss: 1.722 Test Acc: 0.350
Validation loss decreased (inf --> -0.349983).  Saving model ...
Epoch: 2 cost time: 1.1432416439056396
Epoch: 2, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.522 Vali Acc: 0.439 Test Loss: 1.522 Test Acc: 0.439
Validation loss decreased (-0.349983 --> -0.438874).  Saving model ...
Epoch: 3 cost time: 1.1681499481201172
Epoch: 3, Steps: 12 | Train Loss: 1.457 Vali Loss: 1.307 Vali Acc: 0.511 Test Loss: 1.307 Test Acc: 0.511
Validation loss decreased (-0.438874 --> -0.511098).  Saving model ...
Epoch: 4 cost time: 1.1555554866790771
Epoch: 4, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.134 Vali Acc: 0.544 Test Loss: 1.134 Test Acc: 0.544
Validation loss decreased (-0.511098 --> -0.544433).  Saving model ...
Epoch: 5 cost time: 1.1411044597625732
Epoch: 5, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.006 Vali Acc: 0.567 Test Loss: 1.006 Test Acc: 0.567
Validation loss decreased (-0.544433 --> -0.566657).  Saving model ...
Epoch: 6 cost time: 1.175119161605835
Epoch: 6, Steps: 12 | Train Loss: 0.920 Vali Loss: 0.919 Vali Acc: 0.628 Test Loss: 0.919 Test Acc: 0.628
Validation loss decreased (-0.566657 --> -0.627769).  Saving model ...
Epoch: 7 cost time: 1.1153156757354736
Epoch: 7, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.850 Vali Acc: 0.678 Test Loss: 0.850 Test Acc: 0.678
Validation loss decreased (-0.627769 --> -0.677769).  Saving model ...
Epoch: 8 cost time: 1.0455551147460938
Epoch: 8, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.750 Vali Acc: 0.711 Test Loss: 0.750 Test Acc: 0.711
Validation loss decreased (-0.677769 --> -0.711104).  Saving model ...
Epoch: 9 cost time: 1.2950572967529297
Epoch: 9, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.709 Vali Acc: 0.700 Test Loss: 0.709 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1074745655059814
Epoch: 10, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.679 Vali Acc: 0.739 Test Loss: 0.679 Test Acc: 0.739
Validation loss decreased (-0.711104 --> -0.738882).  Saving model ...
Epoch: 11 cost time: 1.191385269165039
Epoch: 11, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.638 Vali Acc: 0.756 Test Loss: 0.638 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 12 cost time: 1.1190028190612793
Epoch: 12, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.611 Vali Acc: 0.761 Test Loss: 0.611 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 13 cost time: 1.1978976726531982
Epoch: 13, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.590 Vali Acc: 0.767 Test Loss: 0.590 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 14 cost time: 1.1866159439086914
Epoch: 14, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.581 Vali Acc: 0.772 Test Loss: 0.581 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 15 cost time: 1.236570119857788
Epoch: 15, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.581 Vali Acc: 0.761 Test Loss: 0.581 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.128927230834961
Epoch: 16, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.565 Vali Acc: 0.772 Test Loss: 0.565 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772217).  Saving model ...
Epoch: 17 cost time: 1.1113359928131104
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.583 Vali Acc: 0.756 Test Loss: 0.583 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.085587501525879
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.552 Vali Acc: 0.767 Test Loss: 0.552 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1682286262512207
Epoch: 19, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.556 Vali Acc: 0.772 Test Loss: 0.556 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772217).  Saving model ...
Epoch: 20 cost time: 1.1239478588104248
Epoch: 20, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783328).  Saving model ...
Epoch: 21 cost time: 1.1099400520324707
Epoch: 21, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.583 Vali Acc: 0.761 Test Loss: 0.583 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.049210548400879
Epoch: 22, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.559 Vali Acc: 0.772 Test Loss: 0.559 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1146771907806396
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.584 Vali Acc: 0.783 Test Loss: 0.584 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0655975341796875
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.599 Vali Acc: 0.772 Test Loss: 0.599 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1562910079956055
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.580 Vali Acc: 0.772 Test Loss: 0.580 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1969389915466309
Epoch: 26, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.298762321472168
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.603 Vali Acc: 0.778 Test Loss: 0.603 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1634836196899414
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.610 Vali Acc: 0.778 Test Loss: 0.610 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1418254375457764
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.616 Vali Acc: 0.778 Test Loss: 0.616 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.125436544418335
Epoch: 30, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.617 Vali Acc: 0.778 Test Loss: 0.617 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 45222
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2016940116882324
Epoch: 1, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 1.433913230895996
Epoch: 2, Steps: 12 | Train Loss: 1.247 Vali Loss: 0.978 Vali Acc: 0.600 Test Loss: 0.978 Test Acc: 0.600
Validation loss decreased (-0.499986 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 1.3593790531158447
Epoch: 3, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.808 Vali Acc: 0.667 Test Loss: 0.808 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666659).  Saving model ...
Epoch: 4 cost time: 1.4479353427886963
Epoch: 4, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.761 Vali Acc: 0.694 Test Loss: 0.761 Test Acc: 0.694
Validation loss decreased (-0.666659 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 1.4720783233642578
Epoch: 5, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.823 Vali Acc: 0.683 Test Loss: 0.823 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4244656562805176
Epoch: 6, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.596 Vali Acc: 0.711 Test Loss: 0.596 Test Acc: 0.711
Validation loss decreased (-0.694437 --> -0.711105).  Saving model ...
Epoch: 7 cost time: 1.504112720489502
Epoch: 7, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.736 Vali Acc: 0.739 Test Loss: 0.736 Test Acc: 0.739
Validation loss decreased (-0.711105 --> -0.738882).  Saving model ...
Epoch: 8 cost time: 1.447230339050293
Epoch: 8, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.691 Vali Acc: 0.750 Test Loss: 0.691 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 1.4488375186920166
Epoch: 9, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.762 Vali Acc: 0.728 Test Loss: 0.762 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4492361545562744
Epoch: 10, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.724 Vali Acc: 0.772 Test Loss: 0.724 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772215).  Saving model ...
Epoch: 11 cost time: 1.4651336669921875
Epoch: 11, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.737 Vali Acc: 0.744 Test Loss: 0.737 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4516921043395996
Epoch: 12, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.214 Vali Acc: 0.706 Test Loss: 1.214 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4380924701690674
Epoch: 13, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.748 Vali Acc: 0.772 Test Loss: 0.748 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.322171926498413
Epoch: 14, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.859 Vali Acc: 0.744 Test Loss: 0.859 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.380897045135498
Epoch: 15, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.886 Vali Acc: 0.767 Test Loss: 0.886 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3390605449676514
Epoch: 16, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.852 Vali Acc: 0.761 Test Loss: 0.852 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3964378833770752
Epoch: 17, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.803 Vali Acc: 0.772 Test Loss: 0.803 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2981266975402832
Epoch: 18, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.821 Vali Acc: 0.767 Test Loss: 0.821 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.525817632675171
Epoch: 19, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.870 Vali Acc: 0.761 Test Loss: 0.870 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4777774810791016
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.912 Vali Acc: 0.761 Test Loss: 0.912 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 133750
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.947558879852295
Epoch: 1, Steps: 12 | Train Loss: 1.808 Vali Loss: 1.585 Vali Acc: 0.378 Test Loss: 1.585 Test Acc: 0.378
Validation loss decreased (inf --> -0.377762).  Saving model ...
Epoch: 2 cost time: 1.1128342151641846
Epoch: 2, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.141 Vali Acc: 0.600 Test Loss: 1.141 Test Acc: 0.600
Validation loss decreased (-0.377762 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 1.1802306175231934
Epoch: 3, Steps: 12 | Train Loss: 1.001 Vali Loss: 0.896 Vali Acc: 0.650 Test Loss: 0.896 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649991).  Saving model ...
Epoch: 4 cost time: 1.197108507156372
Epoch: 4, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.770 Vali Acc: 0.661 Test Loss: 0.770 Test Acc: 0.661
Validation loss decreased (-0.649991 --> -0.661103).  Saving model ...
Epoch: 5 cost time: 1.1444623470306396
Epoch: 5, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.725 Vali Acc: 0.706 Test Loss: 0.725 Test Acc: 0.706
Validation loss decreased (-0.661103 --> -0.705548).  Saving model ...
Epoch: 6 cost time: 1.2029850482940674
Epoch: 6, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.597 Vali Acc: 0.728 Test Loss: 0.597 Test Acc: 0.728
Validation loss decreased (-0.705548 --> -0.727772).  Saving model ...
Epoch: 7 cost time: 1.2684028148651123
Epoch: 7, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.653 Vali Acc: 0.722 Test Loss: 0.653 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0543797016143799
Epoch: 8, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.647 Vali Acc: 0.756 Test Loss: 0.647 Test Acc: 0.756
Validation loss decreased (-0.727772 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 1.1288433074951172
Epoch: 9, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.633 Vali Acc: 0.722 Test Loss: 0.633 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0705552101135254
Epoch: 10, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.581 Vali Acc: 0.739 Test Loss: 0.581 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0234696865081787
Epoch: 11, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.660 Vali Acc: 0.739 Test Loss: 0.660 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2944166660308838
Epoch: 12, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.616 Vali Acc: 0.756 Test Loss: 0.616 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 13 cost time: 1.009674310684204
Epoch: 13, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1414949893951416
Epoch: 14, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.674 Vali Acc: 0.750 Test Loss: 0.674 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1194422245025635
Epoch: 15, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9986145496368408
Epoch: 16, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.664 Vali Acc: 0.778 Test Loss: 0.664 Test Acc: 0.778
Validation loss decreased (-0.755549 --> -0.777771).  Saving model ...
Epoch: 17 cost time: 1.094125509262085
Epoch: 17, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.656 Vali Acc: 0.767 Test Loss: 0.656 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.093794822692871
Epoch: 18, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.650 Vali Acc: 0.778 Test Loss: 0.650 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 19 cost time: 1.054725170135498
Epoch: 19, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.658 Vali Acc: 0.772 Test Loss: 0.658 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1587998867034912
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.711 Vali Acc: 0.767 Test Loss: 0.711 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1207706928253174
Epoch: 21, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.709 Vali Acc: 0.778 Test Loss: 0.709 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1479942798614502
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.721 Vali Acc: 0.789 Test Loss: 0.721 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 23 cost time: 1.1210782527923584
Epoch: 23, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0934510231018066
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.711 Vali Acc: 0.772 Test Loss: 0.711 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1090872287750244
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.738 Vali Acc: 0.772 Test Loss: 0.738 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.066617488861084
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.729 Vali Acc: 0.783 Test Loss: 0.729 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.165407419204712
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.767 Vali Acc: 0.772 Test Loss: 0.767 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0917105674743652
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.767 Vali Acc: 0.772 Test Loss: 0.767 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.122157096862793
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.769 Vali Acc: 0.767 Test Loss: 0.769 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0901718139648438
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.756 Vali Acc: 0.789 Test Loss: 0.756 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.122107982635498
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.789 Test Loss: 0.743 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0991570949554443
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.748 Vali Acc: 0.789 Test Loss: 0.748 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 76166
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.85166597366333
Epoch: 1, Steps: 12 | Train Loss: 1.883 Vali Loss: 1.600 Vali Acc: 0.411 Test Loss: 1.600 Test Acc: 0.411
Validation loss decreased (inf --> -0.411095).  Saving model ...
Epoch: 2 cost time: 1.1872801780700684
Epoch: 2, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.199 Vali Acc: 0.594 Test Loss: 1.199 Test Acc: 0.594
Validation loss decreased (-0.411095 --> -0.594432).  Saving model ...
Epoch: 3 cost time: 1.0752997398376465
Epoch: 3, Steps: 12 | Train Loss: 1.037 Vali Loss: 0.962 Vali Acc: 0.611 Test Loss: 0.962 Test Acc: 0.611
Validation loss decreased (-0.594432 --> -0.611101).  Saving model ...
Epoch: 4 cost time: 1.2014572620391846
Epoch: 4, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.827 Vali Acc: 0.656 Test Loss: 0.827 Test Acc: 0.656
Validation loss decreased (-0.611101 --> -0.655547).  Saving model ...
Epoch: 5 cost time: 1.1070005893707275
Epoch: 5, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.813 Vali Acc: 0.628 Test Loss: 0.813 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.145512342453003
Epoch: 6, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.775 Vali Acc: 0.683 Test Loss: 0.775 Test Acc: 0.683
Validation loss decreased (-0.655547 --> -0.683326).  Saving model ...
Epoch: 7 cost time: 1.118671178817749
Epoch: 7, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
Validation loss decreased (-0.683326 --> -0.722216).  Saving model ...
Epoch: 8 cost time: 1.1145522594451904
Epoch: 8, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.619 Vali Acc: 0.739 Test Loss: 0.619 Test Acc: 0.739
Validation loss decreased (-0.722216 --> -0.738883).  Saving model ...
Epoch: 9 cost time: 1.1338653564453125
Epoch: 9, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.636 Vali Acc: 0.711 Test Loss: 0.636 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1084928512573242
Epoch: 10, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.688 Vali Acc: 0.739 Test Loss: 0.688 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0749843120574951
Epoch: 11, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.614 Vali Acc: 0.728 Test Loss: 0.614 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.161489486694336
Epoch: 12, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.676 Vali Acc: 0.756 Test Loss: 0.676 Test Acc: 0.756
Validation loss decreased (-0.738883 --> -0.755549).  Saving model ...
Epoch: 13 cost time: 1.1016302108764648
Epoch: 13, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.642 Vali Acc: 0.756 Test Loss: 0.642 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 1.01951003074646
Epoch: 14, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.722 Vali Acc: 0.767 Test Loss: 0.722 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 1.1601612567901611
Epoch: 15, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.674 Vali Acc: 0.767 Test Loss: 0.674 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766660).  Saving model ...
Epoch: 16 cost time: 1.1264081001281738
Epoch: 16, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.746 Vali Acc: 0.761 Test Loss: 0.746 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2564775943756104
Epoch: 17, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.712 Vali Acc: 0.756 Test Loss: 0.712 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1676950454711914
Epoch: 18, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.711 Vali Acc: 0.772 Test Loss: 0.711 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772215).  Saving model ...
Epoch: 19 cost time: 1.160400629043579
Epoch: 19, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.759 Vali Acc: 0.767 Test Loss: 0.759 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1527400016784668
Epoch: 20, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.750 Vali Acc: 0.778 Test Loss: 0.750 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 21 cost time: 1.0659904479980469
Epoch: 21, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.766 Vali Acc: 0.767 Test Loss: 0.766 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2156550884246826
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.770 Vali Acc: 0.767 Test Loss: 0.770 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0833935737609863
Epoch: 23, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.748 Vali Acc: 0.767 Test Loss: 0.748 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0232374668121338
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.740 Vali Acc: 0.761 Test Loss: 0.740 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.024399757385254
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.745 Vali Acc: 0.778 Test Loss: 0.745 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 26 cost time: 1.0942561626434326
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1629328727722168
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.793 Vali Acc: 0.767 Test Loss: 0.793 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0751254558563232
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.785 Vali Acc: 0.767 Test Loss: 0.785 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1161730289459229
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.776 Vali Acc: 0.778 Test Loss: 0.776 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.164426326751709
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.787 Vali Acc: 0.772 Test Loss: 0.787 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0837304592132568
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.776 Vali Acc: 0.767 Test Loss: 0.776 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1832420825958252
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.797 Vali Acc: 0.761 Test Loss: 0.797 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9905385971069336
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.798 Vali Acc: 0.767 Test Loss: 0.798 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0914232730865479
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.799 Vali Acc: 0.767 Test Loss: 0.799 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.015547275543213
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.798 Vali Acc: 0.761 Test Loss: 0.798 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 73878
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.745605707168579
Epoch: 1, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.578 Vali Acc: 0.389 Test Loss: 1.578 Test Acc: 0.389
Validation loss decreased (inf --> -0.388873).  Saving model ...
Epoch: 2 cost time: 1.0751848220825195
Epoch: 2, Steps: 12 | Train Loss: 1.420 Vali Loss: 1.219 Vali Acc: 0.539 Test Loss: 1.219 Test Acc: 0.539
Validation loss decreased (-0.388873 --> -0.538877).  Saving model ...
Epoch: 3 cost time: 1.0805068016052246
Epoch: 3, Steps: 12 | Train Loss: 1.038 Vali Loss: 0.949 Vali Acc: 0.644 Test Loss: 0.949 Test Acc: 0.644
Validation loss decreased (-0.538877 --> -0.644435).  Saving model ...
Epoch: 4 cost time: 1.1551172733306885
Epoch: 4, Steps: 12 | Train Loss: 0.857 Vali Loss: 0.814 Vali Acc: 0.678 Test Loss: 0.814 Test Acc: 0.678
Validation loss decreased (-0.644435 --> -0.677770).  Saving model ...
Epoch: 5 cost time: 1.0124759674072266
Epoch: 5, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.726 Vali Acc: 0.700 Test Loss: 0.726 Test Acc: 0.700
Validation loss decreased (-0.677770 --> -0.699993).  Saving model ...
Epoch: 6 cost time: 0.965787410736084
Epoch: 6, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.645 Vali Acc: 0.750 Test Loss: 0.645 Test Acc: 0.750
Validation loss decreased (-0.699993 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.149062156677246
Epoch: 7, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.609 Vali Acc: 0.750 Test Loss: 0.609 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.0932514667510986
Epoch: 8, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.593 Vali Acc: 0.767 Test Loss: 0.593 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766661).  Saving model ...
Epoch: 9 cost time: 1.1358959674835205
Epoch: 9, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.560 Vali Acc: 0.778 Test Loss: 0.560 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777772).  Saving model ...
Epoch: 10 cost time: 1.1226704120635986
Epoch: 10, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.560 Vali Acc: 0.772 Test Loss: 0.560 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0771443843841553
Epoch: 11, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.565 Vali Acc: 0.772 Test Loss: 0.565 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0531699657440186
Epoch: 12, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.541 Vali Acc: 0.772 Test Loss: 0.541 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1640644073486328
Epoch: 13, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.572 Vali Acc: 0.767 Test Loss: 0.572 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1217291355133057
Epoch: 14, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783328).  Saving model ...
Epoch: 15 cost time: 1.0446181297302246
Epoch: 15, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.544 Vali Acc: 0.767 Test Loss: 0.544 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.161712408065796
Epoch: 16, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.546 Vali Acc: 0.800 Test Loss: 0.546 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799995).  Saving model ...
Epoch: 17 cost time: 1.0570964813232422
Epoch: 17, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1306192874908447
Epoch: 18, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.575 Vali Acc: 0.772 Test Loss: 0.575 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.098294734954834
Epoch: 19, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.526 Vali Acc: 0.800 Test Loss: 0.526 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 20 cost time: 1.1222774982452393
Epoch: 20, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.560 Vali Acc: 0.778 Test Loss: 0.560 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.077155351638794
Epoch: 21, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.570 Vali Acc: 0.778 Test Loss: 0.570 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.181278944015503
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.571 Vali Acc: 0.794 Test Loss: 0.571 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.153773307800293
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0821928977966309
Epoch: 24, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.587 Vali Acc: 0.783 Test Loss: 0.587 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.103294849395752
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.593 Vali Acc: 0.778 Test Loss: 0.593 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1203200817108154
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.594 Vali Acc: 0.783 Test Loss: 0.594 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0905122756958008
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.593 Vali Acc: 0.778 Test Loss: 0.593 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0929734706878662
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.666 Vali Acc: 0.767 Test Loss: 0.666 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1016876697540283
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.624 Vali Acc: 0.778 Test Loss: 0.624 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 55478
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8849122524261475
Epoch: 1, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.642 Vali Acc: 0.383 Test Loss: 1.642 Test Acc: 0.383
Validation loss decreased (inf --> -0.383317).  Saving model ...
Epoch: 2 cost time: 1.092677354812622
Epoch: 2, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.373 Vali Acc: 0.478 Test Loss: 1.373 Test Acc: 0.478
Validation loss decreased (-0.383317 --> -0.477764).  Saving model ...
Epoch: 3 cost time: 1.1426429748535156
Epoch: 3, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.120 Vali Acc: 0.539 Test Loss: 1.120 Test Acc: 0.539
Validation loss decreased (-0.477764 --> -0.538878).  Saving model ...
Epoch: 4 cost time: 1.0432960987091064
Epoch: 4, Steps: 12 | Train Loss: 0.966 Vali Loss: 0.959 Vali Acc: 0.606 Test Loss: 0.959 Test Acc: 0.606
Validation loss decreased (-0.538878 --> -0.605546).  Saving model ...
Epoch: 5 cost time: 1.1411352157592773
Epoch: 5, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.862 Vali Acc: 0.639 Test Loss: 0.862 Test Acc: 0.639
Validation loss decreased (-0.605546 --> -0.638880).  Saving model ...
Epoch: 6 cost time: 1.056706428527832
Epoch: 6, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.764 Vali Acc: 0.689 Test Loss: 0.764 Test Acc: 0.689
Validation loss decreased (-0.638880 --> -0.688881).  Saving model ...
Epoch: 7 cost time: 1.0559463500976562
Epoch: 7, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.699 Vali Acc: 0.711 Test Loss: 0.699 Test Acc: 0.711
Validation loss decreased (-0.688881 --> -0.711104).  Saving model ...
Epoch: 8 cost time: 0.9917364120483398
Epoch: 8, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.709 Vali Acc: 0.717 Test Loss: 0.709 Test Acc: 0.717
Validation loss decreased (-0.711104 --> -0.716660).  Saving model ...
Epoch: 9 cost time: 1.0563507080078125
Epoch: 9, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.624 Vali Acc: 0.733 Test Loss: 0.624 Test Acc: 0.733
Validation loss decreased (-0.716660 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 1.0695648193359375
Epoch: 10, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.646 Vali Acc: 0.739 Test Loss: 0.646 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738882).  Saving model ...
Epoch: 11 cost time: 0.9838142395019531
Epoch: 11, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.622 Vali Acc: 0.733 Test Loss: 0.622 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1881122589111328
Epoch: 12, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.620 Vali Acc: 0.733 Test Loss: 0.620 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0649356842041016
Epoch: 13, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.0094058513641357
Epoch: 14, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.608 Vali Acc: 0.767 Test Loss: 0.608 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766661).  Saving model ...
Epoch: 15 cost time: 1.08233642578125
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.605 Vali Acc: 0.728 Test Loss: 0.605 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.026747226715088
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.589 Vali Acc: 0.761 Test Loss: 0.589 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0312535762786865
Epoch: 17, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.615 Vali Acc: 0.767 Test Loss: 0.615 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0050053596496582
Epoch: 18, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.606 Vali Acc: 0.756 Test Loss: 0.606 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0505142211914062
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.630 Vali Acc: 0.756 Test Loss: 0.630 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.157968521118164
Epoch: 20, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.618 Vali Acc: 0.756 Test Loss: 0.618 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0314257144927979
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0650262832641602
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.630 Vali Acc: 0.772 Test Loss: 0.630 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 23 cost time: 1.0315439701080322
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.644 Vali Acc: 0.767 Test Loss: 0.644 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0829439163208008
Epoch: 24, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.627 Vali Acc: 0.778 Test Loss: 0.627 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 25 cost time: 1.027024745941162
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.668 Vali Acc: 0.772 Test Loss: 0.668 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1242005825042725
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.653 Vali Acc: 0.767 Test Loss: 0.653 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0568821430206299
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.652 Vali Acc: 0.767 Test Loss: 0.652 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0442256927490234
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.644 Vali Acc: 0.767 Test Loss: 0.644 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0342276096343994
Epoch: 29, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.655 Vali Acc: 0.756 Test Loss: 0.655 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0738341808319092
Epoch: 30, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.683 Vali Acc: 0.761 Test Loss: 0.683 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9639608860015869
Epoch: 31, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.681 Vali Acc: 0.767 Test Loss: 0.681 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0200731754302979
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.720 Vali Acc: 0.778 Test Loss: 0.720 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0299568176269531
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.693 Vali Acc: 0.767 Test Loss: 0.693 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.095015287399292
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.704 Vali Acc: 0.772 Test Loss: 0.704 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 43990
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7912821769714355
Epoch: 1, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.758 Vali Acc: 0.194 Test Loss: 1.758 Test Acc: 0.194
Validation loss decreased (inf --> -0.194427).  Saving model ...
Epoch: 2 cost time: 1.0924065113067627
Epoch: 2, Steps: 12 | Train Loss: 1.642 Vali Loss: 1.542 Vali Acc: 0.472 Test Loss: 1.542 Test Acc: 0.472
Validation loss decreased (-0.194427 --> -0.472207).  Saving model ...
Epoch: 3 cost time: 1.0366294384002686
Epoch: 3, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.300 Vali Acc: 0.567 Test Loss: 1.300 Test Acc: 0.567
Validation loss decreased (-0.472207 --> -0.566654).  Saving model ...
Epoch: 4 cost time: 1.018080234527588
Epoch: 4, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.124 Vali Acc: 0.606 Test Loss: 1.124 Test Acc: 0.606
Validation loss decreased (-0.566654 --> -0.605544).  Saving model ...
Epoch: 5 cost time: 1.1091749668121338
Epoch: 5, Steps: 12 | Train Loss: 0.990 Vali Loss: 0.990 Vali Acc: 0.633 Test Loss: 0.990 Test Acc: 0.633
Validation loss decreased (-0.605544 --> -0.633323).  Saving model ...
Epoch: 6 cost time: 1.0331528186798096
Epoch: 6, Steps: 12 | Train Loss: 0.956 Vali Loss: 0.923 Vali Acc: 0.661 Test Loss: 0.923 Test Acc: 0.661
Validation loss decreased (-0.633323 --> -0.661102).  Saving model ...
Epoch: 7 cost time: 1.0313513278961182
Epoch: 7, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.836 Vali Acc: 0.672 Test Loss: 0.836 Test Acc: 0.672
Validation loss decreased (-0.661102 --> -0.672214).  Saving model ...
Epoch: 8 cost time: 1.0769710540771484
Epoch: 8, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.776 Vali Acc: 0.672 Test Loss: 0.776 Test Acc: 0.672
Validation loss decreased (-0.672214 --> -0.672214).  Saving model ...
Epoch: 9 cost time: 1.048011064529419
Epoch: 9, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.742 Vali Acc: 0.700 Test Loss: 0.742 Test Acc: 0.700
Validation loss decreased (-0.672214 --> -0.699993).  Saving model ...
Epoch: 10 cost time: 1.016791582107544
Epoch: 10, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.708 Vali Acc: 0.728 Test Loss: 0.708 Test Acc: 0.728
Validation loss decreased (-0.699993 --> -0.727771).  Saving model ...
Epoch: 11 cost time: 1.0744316577911377
Epoch: 11, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.684 Vali Acc: 0.744 Test Loss: 0.684 Test Acc: 0.744
Validation loss decreased (-0.727771 --> -0.744438).  Saving model ...
Epoch: 12 cost time: 1.0642104148864746
Epoch: 12, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.661 Vali Acc: 0.733 Test Loss: 0.661 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1108815670013428
Epoch: 13, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.638 Vali Acc: 0.761 Test Loss: 0.638 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761105).  Saving model ...
Epoch: 14 cost time: 1.124511480331421
Epoch: 14, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.608 Vali Acc: 0.739 Test Loss: 0.608 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0836758613586426
Epoch: 15, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.630 Vali Acc: 0.744 Test Loss: 0.630 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0768094062805176
Epoch: 16, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.643 Vali Acc: 0.756 Test Loss: 0.643 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.089108943939209
Epoch: 17, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.629 Vali Acc: 0.744 Test Loss: 0.629 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1073644161224365
Epoch: 18, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.651 Vali Acc: 0.733 Test Loss: 0.651 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0404715538024902
Epoch: 19, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.652 Vali Acc: 0.756 Test Loss: 0.652 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.072202205657959
Epoch: 20, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.663 Vali Acc: 0.750 Test Loss: 0.663 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.066103219985962
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.646 Vali Acc: 0.756 Test Loss: 0.646 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.027268648147583
Epoch: 22, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.685 Vali Acc: 0.750 Test Loss: 0.685 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1447927951812744
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.673 Vali Acc: 0.750 Test Loss: 0.673 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 34822
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.691178798675537
Epoch: 1, Steps: 12 | Train Loss: 2.006 Vali Loss: 1.865 Vali Acc: 0.183 Test Loss: 1.865 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 1.0912511348724365
Epoch: 2, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.619 Vali Acc: 0.367 Test Loss: 1.619 Test Acc: 0.367
Validation loss decreased (-0.183315 --> -0.366650).  Saving model ...
Epoch: 3 cost time: 1.0316195487976074
Epoch: 3, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.368 Vali Acc: 0.533 Test Loss: 1.368 Test Acc: 0.533
Validation loss decreased (-0.366650 --> -0.533320).  Saving model ...
Epoch: 4 cost time: 1.1183080673217773
Epoch: 4, Steps: 12 | Train Loss: 1.308 Vali Loss: 1.151 Vali Acc: 0.572 Test Loss: 1.151 Test Acc: 0.572
Validation loss decreased (-0.533320 --> -0.572211).  Saving model ...
Epoch: 5 cost time: 1.1045429706573486
Epoch: 5, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.010 Vali Acc: 0.622 Test Loss: 1.010 Test Acc: 0.622
Validation loss decreased (-0.572211 --> -0.622212).  Saving model ...
Epoch: 6 cost time: 1.0772051811218262
Epoch: 6, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.907 Vali Acc: 0.650 Test Loss: 0.907 Test Acc: 0.650
Validation loss decreased (-0.622212 --> -0.649991).  Saving model ...
Epoch: 7 cost time: 1.0089921951293945
Epoch: 7, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.841 Vali Acc: 0.683 Test Loss: 0.841 Test Acc: 0.683
Validation loss decreased (-0.649991 --> -0.683325).  Saving model ...
Epoch: 8 cost time: 1.0417490005493164
Epoch: 8, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.787 Vali Acc: 0.706 Test Loss: 0.787 Test Acc: 0.706
Validation loss decreased (-0.683325 --> -0.705548).  Saving model ...
Epoch: 9 cost time: 1.004939079284668
Epoch: 9, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.750 Vali Acc: 0.689 Test Loss: 0.750 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0201771259307861
Epoch: 10, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.730 Vali Acc: 0.689 Test Loss: 0.730 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0379815101623535
Epoch: 11, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.663 Vali Acc: 0.744 Test Loss: 0.663 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744438).  Saving model ...
Epoch: 12 cost time: 1.0795843601226807
Epoch: 12, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.0733771324157715
Epoch: 13, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 1.1437084674835205
Epoch: 14, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.648 Vali Acc: 0.756 Test Loss: 0.648 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1511447429656982
Epoch: 15, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.618 Vali Acc: 0.750 Test Loss: 0.618 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0518033504486084
Epoch: 16, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.597 Vali Acc: 0.767 Test Loss: 0.597 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766661).  Saving model ...
Epoch: 17 cost time: 1.0897316932678223
Epoch: 17, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.586 Vali Acc: 0.756 Test Loss: 0.586 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1234009265899658
Epoch: 18, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.584 Vali Acc: 0.778 Test Loss: 0.584 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777772).  Saving model ...
Epoch: 19 cost time: 1.1286957263946533
Epoch: 19, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.614 Vali Acc: 0.756 Test Loss: 0.614 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1609482765197754
Epoch: 20, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.598 Vali Acc: 0.756 Test Loss: 0.598 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0184459686279297
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.578 Vali Acc: 0.767 Test Loss: 0.578 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1330044269561768
Epoch: 22, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1389856338500977
Epoch: 23, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.604 Vali Acc: 0.750 Test Loss: 0.604 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0880472660064697
Epoch: 24, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.597 Vali Acc: 0.756 Test Loss: 0.597 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0941987037658691
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.623 Vali Acc: 0.761 Test Loss: 0.623 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.089254379272461
Epoch: 26, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0851109027862549
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.582 Vali Acc: 0.772 Test Loss: 0.582 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.244602918624878
Epoch: 28, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.642 Vali Acc: 0.761 Test Loss: 0.642 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 32550
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5732924938201904
Epoch: 1, Steps: 12 | Train Loss: 1.811 Vali Loss: 1.420 Vali Acc: 0.550 Test Loss: 1.420 Test Acc: 0.550
Validation loss decreased (inf --> -0.549986).  Saving model ...
Epoch: 2 cost time: 1.903733491897583
Epoch: 2, Steps: 12 | Train Loss: 1.202 Vali Loss: 0.933 Vali Acc: 0.622 Test Loss: 0.933 Test Acc: 0.622
Validation loss decreased (-0.549986 --> -0.622213).  Saving model ...
Epoch: 3 cost time: 1.8610618114471436
Epoch: 3, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.798 Vali Acc: 0.644 Test Loss: 0.798 Test Acc: 0.644
Validation loss decreased (-0.622213 --> -0.644436).  Saving model ...
Epoch: 4 cost time: 1.7900362014770508
Epoch: 4, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.646 Vali Acc: 0.722 Test Loss: 0.646 Test Acc: 0.722
Validation loss decreased (-0.644436 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 1.9417939186096191
Epoch: 5, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.749 Vali Acc: 0.728 Test Loss: 0.749 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727770).  Saving model ...
Epoch: 6 cost time: 1.9512841701507568
Epoch: 6, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.793 Vali Acc: 0.744 Test Loss: 0.793 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 2.058403491973877
Epoch: 7, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.868 Vali Acc: 0.694 Test Loss: 0.868 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.934917688369751
Epoch: 8, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.616 Vali Acc: 0.767 Test Loss: 0.616 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766661).  Saving model ...
Epoch: 9 cost time: 1.92423415184021
Epoch: 9, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
Validation loss decreased (-0.766661 --> -0.783327).  Saving model ...
Epoch: 10 cost time: 1.9128832817077637
Epoch: 10, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.733 Vali Acc: 0.739 Test Loss: 0.733 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1637558937072754
Epoch: 11, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.700 Vali Acc: 0.772 Test Loss: 0.700 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7401225566864014
Epoch: 12, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.672 Vali Acc: 0.756 Test Loss: 0.672 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8885619640350342
Epoch: 13, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.062 Vali Acc: 0.722 Test Loss: 1.062 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5975289344787598
Epoch: 14, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.764 Vali Acc: 0.783 Test Loss: 0.764 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5646193027496338
Epoch: 15, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.837 Vali Acc: 0.756 Test Loss: 0.837 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.707524061203003
Epoch: 16, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.872 Vali Acc: 0.756 Test Loss: 0.872 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7118265628814697
Epoch: 17, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.158 Vali Acc: 0.767 Test Loss: 1.158 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6429643630981445
Epoch: 18, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.902 Vali Acc: 0.778 Test Loss: 0.902 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.786752462387085
Epoch: 19, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.785 Vali Acc: 0.767 Test Loss: 0.785 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 127414
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0780839920043945
Epoch: 1, Steps: 12 | Train Loss: 1.849 Vali Loss: 1.596 Vali Acc: 0.400 Test Loss: 1.596 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 1.483168363571167
Epoch: 2, Steps: 12 | Train Loss: 1.390 Vali Loss: 1.131 Vali Acc: 0.583 Test Loss: 1.131 Test Acc: 0.583
Validation loss decreased (-0.399984 --> -0.583322).  Saving model ...
Epoch: 3 cost time: 1.4750006198883057
Epoch: 3, Steps: 12 | Train Loss: 0.942 Vali Loss: 0.949 Vali Acc: 0.639 Test Loss: 0.949 Test Acc: 0.639
Validation loss decreased (-0.583322 --> -0.638879).  Saving model ...
Epoch: 4 cost time: 1.121401309967041
Epoch: 4, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.805 Vali Acc: 0.678 Test Loss: 0.805 Test Acc: 0.678
Validation loss decreased (-0.638879 --> -0.677770).  Saving model ...
Epoch: 5 cost time: 1.5203371047973633
Epoch: 5, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.707 Vali Acc: 0.700 Test Loss: 0.707 Test Acc: 0.700
Validation loss decreased (-0.677770 --> -0.699993).  Saving model ...
Epoch: 6 cost time: 1.5804715156555176
Epoch: 6, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.765 Vali Acc: 0.689 Test Loss: 0.765 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.588425636291504
Epoch: 7, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.646 Vali Acc: 0.728 Test Loss: 0.646 Test Acc: 0.728
Validation loss decreased (-0.699993 --> -0.727771).  Saving model ...
Epoch: 8 cost time: 1.634838342666626
Epoch: 8, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.593 Vali Acc: 0.733 Test Loss: 0.593 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 1.6169915199279785
Epoch: 9, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.615 Vali Acc: 0.728 Test Loss: 0.615 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3067536354064941
Epoch: 10, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.653 Vali Acc: 0.739 Test Loss: 0.653 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738882).  Saving model ...
Epoch: 11 cost time: 1.2415597438812256
Epoch: 11, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.657 Vali Acc: 0.733 Test Loss: 0.657 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.346907377243042
Epoch: 12, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.764 Vali Acc: 0.744 Test Loss: 0.764 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744437).  Saving model ...
Epoch: 13 cost time: 1.4547615051269531
Epoch: 13, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.717 Vali Acc: 0.728 Test Loss: 0.717 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3488481044769287
Epoch: 14, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.689 Vali Acc: 0.733 Test Loss: 0.689 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.465791940689087
Epoch: 15, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.770 Vali Acc: 0.739 Test Loss: 0.770 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6151692867279053
Epoch: 16, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.714 Vali Acc: 0.739 Test Loss: 0.714 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5365569591522217
Epoch: 17, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.738 Vali Acc: 0.739 Test Loss: 0.738 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5071349143981934
Epoch: 18, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.778 Vali Acc: 0.728 Test Loss: 0.778 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4412143230438232
Epoch: 19, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.772 Vali Acc: 0.744 Test Loss: 0.772 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4997098445892334
Epoch: 20, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.777 Vali Acc: 0.756 Test Loss: 0.777 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 21 cost time: 1.4013698101043701
Epoch: 21, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.762 Vali Acc: 0.767 Test Loss: 0.762 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 22 cost time: 1.5263662338256836
Epoch: 22, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.806 Vali Acc: 0.744 Test Loss: 0.806 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5458595752716064
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.811 Vali Acc: 0.756 Test Loss: 0.811 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.490100383758545
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.809 Vali Acc: 0.761 Test Loss: 0.809 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.375455379486084
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.813 Vali Acc: 0.767 Test Loss: 0.813 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3808462619781494
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.804 Vali Acc: 0.767 Test Loss: 0.804 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4190967082977295
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.826 Vali Acc: 0.767 Test Loss: 0.826 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4116714000701904
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.843 Vali Acc: 0.761 Test Loss: 0.843 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.532724142074585
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.851 Vali Acc: 0.767 Test Loss: 0.851 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5777053833007812
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.834 Vali Acc: 0.767 Test Loss: 0.834 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3995251655578613
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.853 Vali Acc: 0.761 Test Loss: 0.853 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 69830
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.230734348297119
Epoch: 1, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.619 Vali Acc: 0.422 Test Loss: 1.619 Test Acc: 0.422
Validation loss decreased (inf --> -0.422206).  Saving model ...
Epoch: 2 cost time: 1.339667797088623
Epoch: 2, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.204 Vali Acc: 0.578 Test Loss: 1.204 Test Acc: 0.578
Validation loss decreased (-0.422206 --> -0.577766).  Saving model ...
Epoch: 3 cost time: 1.2907609939575195
Epoch: 3, Steps: 12 | Train Loss: 1.011 Vali Loss: 0.990 Vali Acc: 0.633 Test Loss: 0.990 Test Acc: 0.633
Validation loss decreased (-0.577766 --> -0.633323).  Saving model ...
Epoch: 4 cost time: 1.4601001739501953
Epoch: 4, Steps: 12 | Train Loss: 0.895 Vali Loss: 0.820 Vali Acc: 0.644 Test Loss: 0.820 Test Acc: 0.644
Validation loss decreased (-0.633323 --> -0.644436).  Saving model ...
Epoch: 5 cost time: 1.2913682460784912
Epoch: 5, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.746 Vali Acc: 0.678 Test Loss: 0.746 Test Acc: 0.678
Validation loss decreased (-0.644436 --> -0.677770).  Saving model ...
Epoch: 6 cost time: 1.508134365081787
Epoch: 6, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
Validation loss decreased (-0.677770 --> -0.755549).  Saving model ...
Epoch: 7 cost time: 1.491952657699585
Epoch: 7, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.733 Vali Acc: 0.728 Test Loss: 0.733 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4663798809051514
Epoch: 8, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.656 Vali Acc: 0.744 Test Loss: 0.656 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3634564876556396
Epoch: 9, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.604 Vali Acc: 0.761 Test Loss: 0.604 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 10 cost time: 1.4792723655700684
Epoch: 10, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.611 Vali Acc: 0.756 Test Loss: 0.611 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4692440032958984
Epoch: 11, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.600 Vali Acc: 0.756 Test Loss: 0.600 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6076173782348633
Epoch: 12, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.631 Vali Acc: 0.744 Test Loss: 0.631 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6123361587524414
Epoch: 13, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.610 Vali Acc: 0.761 Test Loss: 0.610 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4951879978179932
Epoch: 14, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.639 Vali Acc: 0.756 Test Loss: 0.639 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4431514739990234
Epoch: 15, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.655 Vali Acc: 0.767 Test Loss: 0.655 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 16 cost time: 1.3531010150909424
Epoch: 16, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.656 Vali Acc: 0.772 Test Loss: 0.656 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 17 cost time: 1.304499864578247
Epoch: 17, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.624 Vali Acc: 0.789 Test Loss: 0.624 Test Acc: 0.789
Validation loss decreased (-0.772216 --> -0.788883).  Saving model ...
Epoch: 18 cost time: 1.3964502811431885
Epoch: 18, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.666 Vali Acc: 0.772 Test Loss: 0.666 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3191215991973877
Epoch: 19, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.706 Vali Acc: 0.783 Test Loss: 0.706 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4325320720672607
Epoch: 20, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.670 Vali Acc: 0.789 Test Loss: 0.670 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3833601474761963
Epoch: 21, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.680 Vali Acc: 0.772 Test Loss: 0.680 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5511744022369385
Epoch: 22, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.732 Vali Acc: 0.778 Test Loss: 0.732 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6236610412597656
Epoch: 23, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.764 Vali Acc: 0.778 Test Loss: 0.764 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.659170389175415
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.772 Vali Acc: 0.772 Test Loss: 0.772 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4837501049041748
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.730 Vali Acc: 0.778 Test Loss: 0.730 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.531243085861206
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.730 Vali Acc: 0.778 Test Loss: 0.730 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5140297412872314
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.767 Test Loss: 0.789 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 67542
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9219279289245605
Epoch: 1, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.621 Vali Acc: 0.378 Test Loss: 1.621 Test Acc: 0.378
Validation loss decreased (inf --> -0.377762).  Saving model ...
Epoch: 2 cost time: 1.0907573699951172
Epoch: 2, Steps: 12 | Train Loss: 1.470 Vali Loss: 1.280 Vali Acc: 0.567 Test Loss: 1.280 Test Acc: 0.567
Validation loss decreased (-0.377762 --> -0.566654).  Saving model ...
Epoch: 3 cost time: 0.9488475322723389
Epoch: 3, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.029 Vali Acc: 0.628 Test Loss: 1.029 Test Acc: 0.628
Validation loss decreased (-0.566654 --> -0.627767).  Saving model ...
Epoch: 4 cost time: 1.0546457767486572
Epoch: 4, Steps: 12 | Train Loss: 0.933 Vali Loss: 0.906 Vali Acc: 0.650 Test Loss: 0.906 Test Acc: 0.650
Validation loss decreased (-0.627767 --> -0.649991).  Saving model ...
Epoch: 5 cost time: 1.0856666564941406
Epoch: 5, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.783 Vali Acc: 0.672 Test Loss: 0.783 Test Acc: 0.672
Validation loss decreased (-0.649991 --> -0.672214).  Saving model ...
Epoch: 6 cost time: 1.0858891010284424
Epoch: 6, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.727 Vali Acc: 0.689 Test Loss: 0.727 Test Acc: 0.689
Validation loss decreased (-0.672214 --> -0.688882).  Saving model ...
Epoch: 7 cost time: 1.0625450611114502
Epoch: 7, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.669 Vali Acc: 0.722 Test Loss: 0.669 Test Acc: 0.722
Validation loss decreased (-0.688882 --> -0.722216).  Saving model ...
Epoch: 8 cost time: 1.0957860946655273
Epoch: 8, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.644 Vali Acc: 0.744 Test Loss: 0.644 Test Acc: 0.744
Validation loss decreased (-0.722216 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 1.0941369533538818
Epoch: 9, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.624 Vali Acc: 0.744 Test Loss: 0.624 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 10 cost time: 1.0848631858825684
Epoch: 10, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.662 Vali Acc: 0.739 Test Loss: 0.662 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0917696952819824
Epoch: 11, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.593 Vali Acc: 0.761 Test Loss: 0.593 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761105).  Saving model ...
Epoch: 12 cost time: 1.153243064880371
Epoch: 12, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.600 Vali Acc: 0.739 Test Loss: 0.600 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1045746803283691
Epoch: 13, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.591 Vali Acc: 0.778 Test Loss: 0.591 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777772).  Saving model ...
Epoch: 14 cost time: 1.0386717319488525
Epoch: 14, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.603 Vali Acc: 0.750 Test Loss: 0.603 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1054561138153076
Epoch: 15, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.619 Vali Acc: 0.756 Test Loss: 0.619 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0498335361480713
Epoch: 16, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.561 Vali Acc: 0.778 Test Loss: 0.561 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777772).  Saving model ...
Epoch: 17 cost time: 1.0184118747711182
Epoch: 17, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783328).  Saving model ...
Epoch: 18 cost time: 1.1423473358154297
Epoch: 18, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.615 Vali Acc: 0.783 Test Loss: 0.615 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1888270378112793
Epoch: 19, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.610 Vali Acc: 0.767 Test Loss: 0.610 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.214054822921753
Epoch: 20, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.583 Vali Acc: 0.761 Test Loss: 0.583 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1471426486968994
Epoch: 21, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.619 Vali Acc: 0.761 Test Loss: 0.619 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1297016143798828
Epoch: 22, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.628 Vali Acc: 0.761 Test Loss: 0.628 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0194878578186035
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.648 Vali Acc: 0.761 Test Loss: 0.648 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0040619373321533
Epoch: 24, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.661 Vali Acc: 0.756 Test Loss: 0.661 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.165208101272583
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.661 Vali Acc: 0.756 Test Loss: 0.661 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1140799522399902
Epoch: 26, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.663 Vali Acc: 0.767 Test Loss: 0.663 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0203123092651367
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.670 Vali Acc: 0.756 Test Loss: 0.670 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 49142
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8852829933166504
Epoch: 1, Steps: 12 | Train Loss: 1.773 Vali Loss: 1.663 Vali Acc: 0.317 Test Loss: 1.663 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 1.0247104167938232
Epoch: 2, Steps: 12 | Train Loss: 1.515 Vali Loss: 1.364 Vali Acc: 0.539 Test Loss: 1.364 Test Acc: 0.539
Validation loss decreased (-0.316650 --> -0.538875).  Saving model ...
Epoch: 3 cost time: 0.9962821006774902
Epoch: 3, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.107 Vali Acc: 0.561 Test Loss: 1.107 Test Acc: 0.561
Validation loss decreased (-0.538875 --> -0.561100).  Saving model ...
Epoch: 4 cost time: 1.01536226272583
Epoch: 4, Steps: 12 | Train Loss: 0.981 Vali Loss: 0.956 Vali Acc: 0.606 Test Loss: 0.956 Test Acc: 0.606
Validation loss decreased (-0.561100 --> -0.605546).  Saving model ...
Epoch: 5 cost time: 1.0421369075775146
Epoch: 5, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.878 Vali Acc: 0.644 Test Loss: 0.878 Test Acc: 0.644
Validation loss decreased (-0.605546 --> -0.644436).  Saving model ...
Epoch: 6 cost time: 1.0233583450317383
Epoch: 6, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.771 Vali Acc: 0.678 Test Loss: 0.771 Test Acc: 0.678
Validation loss decreased (-0.644436 --> -0.677770).  Saving model ...
Epoch: 7 cost time: 1.0246574878692627
Epoch: 7, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.717 Vali Acc: 0.722 Test Loss: 0.717 Test Acc: 0.722
Validation loss decreased (-0.677770 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 1.0231959819793701
Epoch: 8, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.656 Vali Acc: 0.722 Test Loss: 0.656 Test Acc: 0.722
Validation loss decreased (-0.722215 --> -0.722216).  Saving model ...
Epoch: 9 cost time: 0.9640748500823975
Epoch: 9, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.628 Vali Acc: 0.733 Test Loss: 0.628 Test Acc: 0.733
Validation loss decreased (-0.722216 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 1.0858204364776611
Epoch: 10, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.603 Vali Acc: 0.739 Test Loss: 0.603 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738883).  Saving model ...
Epoch: 11 cost time: 1.0846962928771973
Epoch: 11, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.570 Vali Acc: 0.767 Test Loss: 0.570 Test Acc: 0.767
Validation loss decreased (-0.738883 --> -0.766661).  Saving model ...
Epoch: 12 cost time: 1.0717716217041016
Epoch: 12, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.594 Vali Acc: 0.750 Test Loss: 0.594 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9870426654815674
Epoch: 13, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.607 Vali Acc: 0.750 Test Loss: 0.607 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0425171852111816
Epoch: 14, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.578 Vali Acc: 0.733 Test Loss: 0.578 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0304627418518066
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.587 Vali Acc: 0.744 Test Loss: 0.587 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.032271146774292
Epoch: 16, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.562 Vali Acc: 0.750 Test Loss: 0.562 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0504631996154785
Epoch: 17, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.585 Vali Acc: 0.750 Test Loss: 0.585 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0070664882659912
Epoch: 18, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.572 Vali Acc: 0.772 Test Loss: 0.572 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 19 cost time: 1.0309562683105469
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.597 Vali Acc: 0.756 Test Loss: 0.597 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9942269325256348
Epoch: 20, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.584 Vali Acc: 0.761 Test Loss: 0.584 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0901894569396973
Epoch: 21, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.600 Vali Acc: 0.750 Test Loss: 0.600 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9920554161071777
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.605 Vali Acc: 0.761 Test Loss: 0.605 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0145246982574463
Epoch: 23, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.606 Vali Acc: 0.744 Test Loss: 0.606 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0201637744903564
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.620 Vali Acc: 0.761 Test Loss: 0.620 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1056809425354004
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1197545528411865
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.646 Vali Acc: 0.750 Test Loss: 0.646 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1021640300750732
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1526379585266113
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.642 Vali Acc: 0.744 Test Loss: 0.642 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 37654
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7292706966400146
Epoch: 1, Steps: 12 | Train Loss: 1.937 Vali Loss: 1.750 Vali Acc: 0.283 Test Loss: 1.750 Test Acc: 0.283
Validation loss decreased (inf --> -0.283316).  Saving model ...
Epoch: 2 cost time: 1.0145385265350342
Epoch: 2, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.492 Vali Acc: 0.539 Test Loss: 1.492 Test Acc: 0.539
Validation loss decreased (-0.283316 --> -0.538874).  Saving model ...
Epoch: 3 cost time: 1.0379064083099365
Epoch: 3, Steps: 12 | Train Loss: 1.447 Vali Loss: 1.235 Vali Acc: 0.639 Test Loss: 1.235 Test Acc: 0.639
Validation loss decreased (-0.538874 --> -0.638877).  Saving model ...
Epoch: 4 cost time: 0.9887499809265137
Epoch: 4, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.056 Vali Acc: 0.622 Test Loss: 1.056 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0334181785583496
Epoch: 5, Steps: 12 | Train Loss: 1.029 Vali Loss: 0.952 Vali Acc: 0.633 Test Loss: 0.952 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.997814416885376
Epoch: 6, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.852 Vali Acc: 0.661 Test Loss: 0.852 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661103).  Saving model ...
Epoch: 7 cost time: 1.1277306079864502
Epoch: 7, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.795 Vali Acc: 0.683 Test Loss: 0.795 Test Acc: 0.683
Validation loss decreased (-0.661103 --> -0.683325).  Saving model ...
Epoch: 8 cost time: 1.0359892845153809
Epoch: 8, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.764 Vali Acc: 0.689 Test Loss: 0.764 Test Acc: 0.689
Validation loss decreased (-0.683325 --> -0.688881).  Saving model ...
Epoch: 9 cost time: 1.0919229984283447
Epoch: 9, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.715 Vali Acc: 0.700 Test Loss: 0.715 Test Acc: 0.700
Validation loss decreased (-0.688881 --> -0.699993).  Saving model ...
Epoch: 10 cost time: 1.0462355613708496
Epoch: 10, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.671 Vali Acc: 0.733 Test Loss: 0.671 Test Acc: 0.733
Validation loss decreased (-0.699993 --> -0.733327).  Saving model ...
Epoch: 11 cost time: 1.144195318222046
Epoch: 11, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.663 Vali Acc: 0.733 Test Loss: 0.663 Test Acc: 0.733
Validation loss decreased (-0.733327 --> -0.733327).  Saving model ...
Epoch: 12 cost time: 1.1861469745635986
Epoch: 12, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.637 Vali Acc: 0.733 Test Loss: 0.637 Test Acc: 0.733
Validation loss decreased (-0.733327 --> -0.733327).  Saving model ...
Epoch: 13 cost time: 1.1494739055633545
Epoch: 13, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.624 Vali Acc: 0.744 Test Loss: 0.624 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744438).  Saving model ...
Epoch: 14 cost time: 1.1285698413848877
Epoch: 14, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.618 Vali Acc: 0.750 Test Loss: 0.618 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.0654714107513428
Epoch: 15, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.608 Vali Acc: 0.756 Test Loss: 0.608 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 16 cost time: 1.072831630706787
Epoch: 16, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0338990688323975
Epoch: 17, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.589 Vali Acc: 0.761 Test Loss: 0.589 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 18 cost time: 1.1855106353759766
Epoch: 18, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.600 Vali Acc: 0.756 Test Loss: 0.600 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0834150314331055
Epoch: 19, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0731184482574463
Epoch: 20, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.589 Vali Acc: 0.767 Test Loss: 0.589 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 21 cost time: 1.0980637073516846
Epoch: 21, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.605 Vali Acc: 0.744 Test Loss: 0.605 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1794004440307617
Epoch: 22, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.633 Vali Acc: 0.733 Test Loss: 0.633 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1339948177337646
Epoch: 23, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.608 Vali Acc: 0.750 Test Loss: 0.608 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0788664817810059
Epoch: 24, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.635 Vali Acc: 0.744 Test Loss: 0.635 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.105776071548462
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.111238956451416
Epoch: 26, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.639 Vali Acc: 0.744 Test Loss: 0.639 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1353769302368164
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.645 Vali Acc: 0.756 Test Loss: 0.645 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1441624164581299
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.660 Vali Acc: 0.739 Test Loss: 0.660 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1553738117218018
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.647 Vali Acc: 0.756 Test Loss: 0.647 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0699384212493896
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.655 Vali Acc: 0.756 Test Loss: 0.655 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 28486
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.835437059402466
Epoch: 1, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.792 Vali Acc: 0.133 Test Loss: 1.792 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.054178237915039
Epoch: 2, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.583 Vali Acc: 0.400 Test Loss: 1.583 Test Acc: 0.400
Validation loss decreased (-0.133315 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 1.1483798027038574
Epoch: 3, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.360 Vali Acc: 0.528 Test Loss: 1.360 Test Acc: 0.528
Validation loss decreased (-0.399984 --> -0.527764).  Saving model ...
Epoch: 4 cost time: 1.1530673503875732
Epoch: 4, Steps: 12 | Train Loss: 1.199 Vali Loss: 1.172 Vali Acc: 0.578 Test Loss: 1.172 Test Acc: 0.578
Validation loss decreased (-0.527764 --> -0.577766).  Saving model ...
Epoch: 5 cost time: 1.0870881080627441
Epoch: 5, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.030 Vali Acc: 0.611 Test Loss: 1.030 Test Acc: 0.611
Validation loss decreased (-0.577766 --> -0.611101).  Saving model ...
Epoch: 6 cost time: 1.1048247814178467
Epoch: 6, Steps: 12 | Train Loss: 0.901 Vali Loss: 0.936 Vali Acc: 0.656 Test Loss: 0.936 Test Acc: 0.656
Validation loss decreased (-0.611101 --> -0.655546).  Saving model ...
Epoch: 7 cost time: 1.0111932754516602
Epoch: 7, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.857 Vali Acc: 0.633 Test Loss: 0.857 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9675633907318115
Epoch: 8, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.794 Vali Acc: 0.661 Test Loss: 0.794 Test Acc: 0.661
Validation loss decreased (-0.655546 --> -0.661103).  Saving model ...
Epoch: 9 cost time: 0.9568119049072266
Epoch: 9, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.759 Vali Acc: 0.689 Test Loss: 0.759 Test Acc: 0.689
Validation loss decreased (-0.661103 --> -0.688881).  Saving model ...
Epoch: 10 cost time: 1.0133647918701172
Epoch: 10, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.709 Vali Acc: 0.717 Test Loss: 0.709 Test Acc: 0.717
Validation loss decreased (-0.688881 --> -0.716660).  Saving model ...
Epoch: 11 cost time: 1.121168613433838
Epoch: 11, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.664 Vali Acc: 0.750 Test Loss: 0.664 Test Acc: 0.750
Validation loss decreased (-0.716660 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.127737283706665
Epoch: 12, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.1718783378601074
Epoch: 13, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.632 Vali Acc: 0.750 Test Loss: 0.632 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.1856372356414795
Epoch: 14, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.627 Vali Acc: 0.761 Test Loss: 0.627 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761105).  Saving model ...
Epoch: 15 cost time: 1.2702429294586182
Epoch: 15, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.610 Vali Acc: 0.767 Test Loss: 0.610 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 16 cost time: 1.1846039295196533
Epoch: 16, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.584 Vali Acc: 0.772 Test Loss: 0.584 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 17 cost time: 1.147158145904541
Epoch: 17, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.610 Vali Acc: 0.767 Test Loss: 0.610 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.119109869003296
Epoch: 18, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.575 Vali Acc: 0.778 Test Loss: 0.575 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 19 cost time: 1.0592975616455078
Epoch: 19, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.566 Vali Acc: 0.767 Test Loss: 0.566 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1183218955993652
Epoch: 20, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.582 Vali Acc: 0.756 Test Loss: 0.582 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0516419410705566
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.586 Vali Acc: 0.761 Test Loss: 0.586 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1644325256347656
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783328).  Saving model ...
Epoch: 23 cost time: 1.1531991958618164
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.574 Vali Acc: 0.778 Test Loss: 0.574 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9681394100189209
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.578 Vali Acc: 0.756 Test Loss: 0.578 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9564929008483887
Epoch: 25, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.593 Vali Acc: 0.767 Test Loss: 0.593 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0100915431976318
Epoch: 26, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.592 Vali Acc: 0.761 Test Loss: 0.592 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0533738136291504
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.632 Vali Acc: 0.767 Test Loss: 0.632 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0058579444885254
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.627 Vali Acc: 0.750 Test Loss: 0.627 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0396828651428223
Epoch: 29, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.629 Vali Acc: 0.761 Test Loss: 0.629 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1242868900299072
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.623 Vali Acc: 0.756 Test Loss: 0.623 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0933325290679932
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.641 Vali Acc: 0.772 Test Loss: 0.641 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0597798824310303
Epoch: 32, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.651 Vali Acc: 0.761 Test Loss: 0.651 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el3_dm16_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 26214
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9754912853240967
Epoch: 1, Steps: 12 | Train Loss: 1.670 Vali Loss: 0.828 Vali Acc: 0.633 Test Loss: 0.828 Test Acc: 0.633
Validation loss decreased (inf --> -0.633325).  Saving model ...
Epoch: 2 cost time: 2.366487503051758
Epoch: 2, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.674 Vali Acc: 0.756 Test Loss: 0.674 Test Acc: 0.756
Validation loss decreased (-0.633325 --> -0.755549).  Saving model ...
Epoch: 3 cost time: 2.479295015335083
Epoch: 3, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.807 Vali Acc: 0.767 Test Loss: 0.807 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766659).  Saving model ...
Epoch: 4 cost time: 2.388273239135742
Epoch: 4, Steps: 12 | Train Loss: 0.284 Vali Loss: 1.263 Vali Acc: 0.750 Test Loss: 1.263 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3856585025787354
Epoch: 5, Steps: 12 | Train Loss: 0.394 Vali Loss: 1.742 Vali Acc: 0.750 Test Loss: 1.742 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3930225372314453
Epoch: 6, Steps: 12 | Train Loss: 0.648 Vali Loss: 1.702 Vali Acc: 0.711 Test Loss: 1.702 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2827494144439697
Epoch: 7, Steps: 12 | Train Loss: 0.217 Vali Loss: 2.303 Vali Acc: 0.689 Test Loss: 2.303 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2950007915496826
Epoch: 8, Steps: 12 | Train Loss: 0.250 Vali Loss: 2.587 Vali Acc: 0.711 Test Loss: 2.587 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8915703296661377
Epoch: 9, Steps: 12 | Train Loss: 0.221 Vali Loss: 2.005 Vali Acc: 0.772 Test Loss: 2.005 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772202).  Saving model ...
Epoch: 10 cost time: 2.179185152053833
Epoch: 10, Steps: 12 | Train Loss: 0.190 Vali Loss: 3.022 Vali Acc: 0.744 Test Loss: 3.022 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.47772479057312
Epoch: 11, Steps: 12 | Train Loss: 0.250 Vali Loss: 3.491 Vali Acc: 0.739 Test Loss: 3.491 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.346695899963379
Epoch: 12, Steps: 12 | Train Loss: 0.210 Vali Loss: 3.020 Vali Acc: 0.733 Test Loss: 3.020 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3356385231018066
Epoch: 13, Steps: 12 | Train Loss: 0.519 Vali Loss: 4.913 Vali Acc: 0.650 Test Loss: 4.913 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.147764205932617
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 3.507 Vali Acc: 0.728 Test Loss: 3.507 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.207986354827881
Epoch: 15, Steps: 12 | Train Loss: 0.184 Vali Loss: 3.647 Vali Acc: 0.694 Test Loss: 3.647 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.304381847381592
Epoch: 16, Steps: 12 | Train Loss: 0.237 Vali Loss: 4.776 Vali Acc: 0.733 Test Loss: 4.776 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4710679054260254
Epoch: 17, Steps: 12 | Train Loss: 0.391 Vali Loss: 4.759 Vali Acc: 0.728 Test Loss: 4.759 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3093717098236084
Epoch: 18, Steps: 12 | Train Loss: 0.241 Vali Loss: 4.493 Vali Acc: 0.761 Test Loss: 4.493 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2400295734405518
Epoch: 19, Steps: 12 | Train Loss: 0.245 Vali Loss: 4.624 Vali Acc: 0.772 Test Loss: 4.624 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 1205510
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.503523588180542
Epoch: 1, Steps: 12 | Train Loss: 1.573 Vali Loss: 1.076 Vali Acc: 0.583 Test Loss: 1.076 Test Acc: 0.583
Validation loss decreased (inf --> -0.583323).  Saving model ...
Epoch: 2 cost time: 1.8160099983215332
Epoch: 2, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
Validation loss decreased (-0.583323 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 1.7168211936950684
Epoch: 3, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.788 Vali Acc: 0.717 Test Loss: 0.788 Test Acc: 0.717
Validation loss decreased (-0.599989 --> -0.716659).  Saving model ...
Epoch: 4 cost time: 1.7322971820831299
Epoch: 4, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.774 Vali Acc: 0.744 Test Loss: 0.774 Test Acc: 0.744
Validation loss decreased (-0.716659 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 1.7422044277191162
Epoch: 5, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.896 Vali Acc: 0.756 Test Loss: 0.896 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755547).  Saving model ...
Epoch: 6 cost time: 1.904979944229126
Epoch: 6, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.341 Vali Acc: 0.739 Test Loss: 1.341 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8088412284851074
Epoch: 7, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.244 Vali Acc: 0.761 Test Loss: 1.244 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761099).  Saving model ...
Epoch: 8 cost time: 1.8004233837127686
Epoch: 8, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.781 Vali Acc: 0.694 Test Loss: 1.781 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7145507335662842
Epoch: 9, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.436 Vali Acc: 0.756 Test Loss: 1.436 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5421879291534424
Epoch: 10, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.792 Vali Acc: 0.733 Test Loss: 1.792 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7158613204956055
Epoch: 11, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.461 Vali Acc: 0.772 Test Loss: 1.461 Test Acc: 0.772
Validation loss decreased (-0.761099 --> -0.772208).  Saving model ...
Epoch: 12 cost time: 1.6463961601257324
Epoch: 12, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.426 Vali Acc: 0.744 Test Loss: 1.426 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7489345073699951
Epoch: 13, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.405 Vali Acc: 0.778 Test Loss: 1.405 Test Acc: 0.778
Validation loss decreased (-0.772208 --> -0.777764).  Saving model ...
Epoch: 14 cost time: 1.7877094745635986
Epoch: 14, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.538 Vali Acc: 0.761 Test Loss: 1.538 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7287752628326416
Epoch: 15, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.855 Vali Acc: 0.739 Test Loss: 1.855 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8068063259124756
Epoch: 16, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.848 Vali Acc: 0.750 Test Loss: 1.848 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6917743682861328
Epoch: 17, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.155 Vali Acc: 0.717 Test Loss: 2.155 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7266247272491455
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 2.436 Vali Acc: 0.739 Test Loss: 2.436 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8017632961273193
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.390 Vali Acc: 0.722 Test Loss: 2.390 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8311607837677002
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 2.273 Vali Acc: 0.733 Test Loss: 2.273 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8617799282073975
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 2.139 Vali Acc: 0.750 Test Loss: 2.139 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6936700344085693
Epoch: 22, Steps: 12 | Train Loss: 0.172 Vali Loss: 2.185 Vali Acc: 0.733 Test Loss: 2.185 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.726649284362793
Epoch: 23, Steps: 12 | Train Loss: 0.375 Vali Loss: 3.370 Vali Acc: 0.683 Test Loss: 3.370 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 744838
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.334054708480835
Epoch: 1, Steps: 12 | Train Loss: 1.637 Vali Loss: 0.960 Vali Acc: 0.583 Test Loss: 0.960 Test Acc: 0.583
Validation loss decreased (inf --> -0.583324).  Saving model ...
Epoch: 2 cost time: 1.6544034481048584
Epoch: 2, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.799 Vali Acc: 0.739 Test Loss: 0.799 Test Acc: 0.739
Validation loss decreased (-0.583324 --> -0.738881).  Saving model ...
Epoch: 3 cost time: 1.8118858337402344
Epoch: 3, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.989 Vali Acc: 0.694 Test Loss: 0.989 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7550239562988281
Epoch: 4, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.960 Vali Acc: 0.689 Test Loss: 0.960 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7200238704681396
Epoch: 5, Steps: 12 | Train Loss: 0.244 Vali Loss: 1.213 Vali Acc: 0.728 Test Loss: 1.213 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7831649780273438
Epoch: 6, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.186 Vali Acc: 0.733 Test Loss: 1.186 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.632418155670166
Epoch: 7, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.987 Vali Acc: 0.628 Test Loss: 1.987 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6681663990020752
Epoch: 8, Steps: 12 | Train Loss: 0.324 Vali Loss: 1.793 Vali Acc: 0.672 Test Loss: 1.793 Test Acc: 0.672
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7827231884002686
Epoch: 9, Steps: 12 | Train Loss: 0.194 Vali Loss: 1.564 Vali Acc: 0.694 Test Loss: 1.564 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8077356815338135
Epoch: 10, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.660 Vali Acc: 0.733 Test Loss: 1.660 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.740208387374878
Epoch: 11, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.587 Vali Acc: 0.728 Test Loss: 1.587 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7822415828704834
Epoch: 12, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.789 Vali Acc: 0.722 Test Loss: 1.789 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 726534
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2408504486083984
Epoch: 1, Steps: 12 | Train Loss: 1.532 Vali Loss: 0.956 Vali Acc: 0.639 Test Loss: 0.956 Test Acc: 0.639
Validation loss decreased (inf --> -0.638879).  Saving model ...
Epoch: 2 cost time: 1.5318050384521484
Epoch: 2, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.739 Vali Acc: 0.694 Test Loss: 0.739 Test Acc: 0.694
Validation loss decreased (-0.638879 --> -0.694437).  Saving model ...
Epoch: 3 cost time: 1.551616907119751
Epoch: 3, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.670 Vali Acc: 0.728 Test Loss: 0.670 Test Acc: 0.728
Validation loss decreased (-0.694437 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 1.4493160247802734
Epoch: 4, Steps: 12 | Train Loss: 0.284 Vali Loss: 1.021 Vali Acc: 0.706 Test Loss: 1.021 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4014863967895508
Epoch: 5, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.3692800998687744
Epoch: 6, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.916 Vali Acc: 0.733 Test Loss: 0.916 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3024935722351074
Epoch: 7, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.853 Vali Acc: 0.761 Test Loss: 0.853 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761103).  Saving model ...
Epoch: 8 cost time: 1.5409424304962158
Epoch: 8, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.957 Vali Acc: 0.772 Test Loss: 0.957 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772213).  Saving model ...
Epoch: 9 cost time: 1.4299366474151611
Epoch: 9, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.118 Vali Acc: 0.739 Test Loss: 1.118 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5483765602111816
Epoch: 10, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.323 Vali Acc: 0.722 Test Loss: 1.323 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4879999160766602
Epoch: 11, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.121 Vali Acc: 0.778 Test Loss: 1.121 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777767).  Saving model ...
Epoch: 12 cost time: 1.5637147426605225
Epoch: 12, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.550 Vali Acc: 0.722 Test Loss: 1.550 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5673823356628418
Epoch: 13, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.587 Vali Acc: 0.750 Test Loss: 1.587 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3745384216308594
Epoch: 14, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.815 Vali Acc: 0.756 Test Loss: 1.815 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.372568130493164
Epoch: 15, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.740 Vali Acc: 0.728 Test Loss: 1.740 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4147276878356934
Epoch: 16, Steps: 12 | Train Loss: 0.056 Vali Loss: 2.000 Vali Acc: 0.733 Test Loss: 2.000 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5512585639953613
Epoch: 17, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.508 Vali Acc: 0.772 Test Loss: 1.508 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4945316314697266
Epoch: 18, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.608 Vali Acc: 0.778 Test Loss: 1.608 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4220921993255615
Epoch: 19, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.521 Vali Acc: 0.783 Test Loss: 1.521 Test Acc: 0.783
Validation loss decreased (-0.777767 --> -0.783318).  Saving model ...
Epoch: 20 cost time: 1.368290662765503
Epoch: 20, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.528 Vali Acc: 0.783 Test Loss: 1.528 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.514591932296753
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.767 Test Loss: 1.585 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.938957929611206
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.599 Vali Acc: 0.761 Test Loss: 1.599 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4877948760986328
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.729 Vali Acc: 0.756 Test Loss: 1.729 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.558838129043579
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.767 Test Loss: 1.669 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7314081192016602
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.652 Vali Acc: 0.750 Test Loss: 1.652 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6659789085388184
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.756 Test Loss: 1.633 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6267330646514893
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.622 Vali Acc: 0.761 Test Loss: 1.622 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4537427425384521
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.761 Test Loss: 1.611 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5684823989868164
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.750 Test Loss: 1.604 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 579334
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9185950756073
Epoch: 1, Steps: 12 | Train Loss: 1.605 Vali Loss: 1.177 Vali Acc: 0.506 Test Loss: 1.177 Test Acc: 0.506
Validation loss decreased (inf --> -0.505544).  Saving model ...
Epoch: 2 cost time: 1.3840861320495605
Epoch: 2, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.796 Vali Acc: 0.661 Test Loss: 0.796 Test Acc: 0.661
Validation loss decreased (-0.505544 --> -0.661103).  Saving model ...
Epoch: 3 cost time: 1.3793725967407227
Epoch: 3, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.647 Vali Acc: 0.744 Test Loss: 0.647 Test Acc: 0.744
Validation loss decreased (-0.661103 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 1.3151655197143555
Epoch: 4, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.626 Vali Acc: 0.739 Test Loss: 0.626 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3497662544250488
Epoch: 5, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.813 Vali Acc: 0.717 Test Loss: 0.813 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3617682456970215
Epoch: 6, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.888 Vali Acc: 0.722 Test Loss: 0.888 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.292459487915039
Epoch: 7, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.136 Vali Acc: 0.706 Test Loss: 1.136 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3248369693756104
Epoch: 8, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.059 Vali Acc: 0.722 Test Loss: 1.059 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3375930786132812
Epoch: 9, Steps: 12 | Train Loss: 0.089 Vali Loss: 1.280 Vali Acc: 0.717 Test Loss: 1.280 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.295609474182129
Epoch: 10, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.220 Vali Acc: 0.728 Test Loss: 1.220 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3905372619628906
Epoch: 11, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.409 Vali Acc: 0.694 Test Loss: 1.409 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3404242992401123
Epoch: 12, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.077 Vali Acc: 0.750 Test Loss: 1.077 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749989).  Saving model ...
Epoch: 13 cost time: 1.350522518157959
Epoch: 13, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.145 Vali Acc: 0.772 Test Loss: 1.145 Test Acc: 0.772
Validation loss decreased (-0.749989 --> -0.772211).  Saving model ...
Epoch: 14 cost time: 1.2929339408874512
Epoch: 14, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.264 Vali Acc: 0.750 Test Loss: 1.264 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.368290901184082
Epoch: 15, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.185 Vali Acc: 0.756 Test Loss: 1.185 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4099383354187012
Epoch: 16, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.967 Vali Acc: 0.783 Test Loss: 0.967 Test Acc: 0.783
Validation loss decreased (-0.772211 --> -0.783324).  Saving model ...
Epoch: 17 cost time: 1.4280991554260254
Epoch: 17, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.071 Vali Acc: 0.778 Test Loss: 1.071 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.37613844871521
Epoch: 18, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.351 Vali Acc: 0.739 Test Loss: 1.351 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3706374168395996
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.203 Vali Acc: 0.733 Test Loss: 1.203 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4753334522247314
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.578 Vali Acc: 0.700 Test Loss: 1.578 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.404905080795288
Epoch: 21, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.474 Vali Acc: 0.706 Test Loss: 1.474 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3947207927703857
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.548 Vali Acc: 0.728 Test Loss: 1.548 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4729762077331543
Epoch: 23, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.796 Vali Acc: 0.706 Test Loss: 1.796 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5488369464874268
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.816 Vali Acc: 0.717 Test Loss: 1.816 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.467369556427002
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.832 Vali Acc: 0.750 Test Loss: 1.832 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3806686401367188
Epoch: 26, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.641 Vali Acc: 0.728 Test Loss: 1.641 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 487430
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0286014080047607
Epoch: 1, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.257 Vali Acc: 0.528 Test Loss: 1.257 Test Acc: 0.528
Validation loss decreased (inf --> -0.527765).  Saving model ...
Epoch: 2 cost time: 1.3677680492401123
Epoch: 2, Steps: 12 | Train Loss: 0.980 Vali Loss: 0.915 Vali Acc: 0.628 Test Loss: 0.915 Test Acc: 0.628
Validation loss decreased (-0.527765 --> -0.627769).  Saving model ...
Epoch: 3 cost time: 1.3080785274505615
Epoch: 3, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.842 Vali Acc: 0.672 Test Loss: 0.842 Test Acc: 0.672
Validation loss decreased (-0.627769 --> -0.672214).  Saving model ...
Epoch: 4 cost time: 1.3144657611846924
Epoch: 4, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.660 Vali Acc: 0.722 Test Loss: 0.660 Test Acc: 0.722
Validation loss decreased (-0.672214 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 1.319828987121582
Epoch: 5, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.841 Vali Acc: 0.706 Test Loss: 0.841 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.293703317642212
Epoch: 6, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.820 Vali Acc: 0.739 Test Loss: 0.820 Test Acc: 0.739
Validation loss decreased (-0.722216 --> -0.738881).  Saving model ...
Epoch: 7 cost time: 1.2777338027954102
Epoch: 7, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.758 Vali Acc: 0.711 Test Loss: 0.758 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.287482738494873
Epoch: 8, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.757 Vali Acc: 0.733 Test Loss: 0.757 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3530755043029785
Epoch: 9, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.828 Vali Acc: 0.756 Test Loss: 0.828 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 1.3408474922180176
Epoch: 10, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.776 Vali Acc: 0.750 Test Loss: 0.776 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4635272026062012
Epoch: 11, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.862 Vali Acc: 0.739 Test Loss: 0.862 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.397998571395874
Epoch: 12, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.863 Vali Acc: 0.756 Test Loss: 0.863 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3618865013122559
Epoch: 13, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.935 Vali Acc: 0.761 Test Loss: 0.935 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761102).  Saving model ...
Epoch: 14 cost time: 1.198035478591919
Epoch: 14, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.020 Vali Acc: 0.756 Test Loss: 1.020 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4221980571746826
Epoch: 15, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.904 Vali Acc: 0.761 Test Loss: 0.904 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 16 cost time: 1.350167989730835
Epoch: 16, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.959 Vali Acc: 0.761 Test Loss: 0.959 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4852488040924072
Epoch: 17, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.959 Vali Acc: 0.756 Test Loss: 0.959 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.344508409500122
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.931 Vali Acc: 0.767 Test Loss: 0.931 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766657).  Saving model ...
Epoch: 19 cost time: 1.4552826881408691
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.964 Vali Acc: 0.756 Test Loss: 0.964 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.316352128982544
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.985 Vali Acc: 0.761 Test Loss: 0.985 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2909860610961914
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.761 Test Loss: 0.990 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4290156364440918
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.988 Vali Acc: 0.756 Test Loss: 0.988 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3461785316467285
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.993 Vali Acc: 0.761 Test Loss: 0.993 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2850494384765625
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.761 Test Loss: 1.002 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.406618356704712
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.761 Test Loss: 1.000 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4070243835449219
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.761 Test Loss: 1.012 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3530733585357666
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.018 Vali Acc: 0.750 Test Loss: 1.018 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2745683193206787
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.013 Vali Acc: 0.767 Test Loss: 1.013 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 414086
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.900921583175659
Epoch: 1, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.250 Vali Acc: 0.583 Test Loss: 1.250 Test Acc: 0.583
Validation loss decreased (inf --> -0.583321).  Saving model ...
Epoch: 2 cost time: 1.3657093048095703
Epoch: 2, Steps: 12 | Train Loss: 1.018 Vali Loss: 0.831 Vali Acc: 0.650 Test Loss: 0.831 Test Acc: 0.650
Validation loss decreased (-0.583321 --> -0.649992).  Saving model ...
Epoch: 3 cost time: 1.347625494003296
Epoch: 3, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
Validation loss decreased (-0.649992 --> -0.749994).  Saving model ...
Epoch: 4 cost time: 1.301093339920044
Epoch: 4, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.708 Vali Acc: 0.744 Test Loss: 0.708 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.336277961730957
Epoch: 5, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.684 Vali Acc: 0.733 Test Loss: 0.684 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3037257194519043
Epoch: 6, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.686 Vali Acc: 0.756 Test Loss: 0.686 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 7 cost time: 1.201354742050171
Epoch: 7, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.736 Vali Acc: 0.739 Test Loss: 0.736 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3229899406433105
Epoch: 8, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.661 Vali Acc: 0.767 Test Loss: 0.661 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 9 cost time: 1.3487217426300049
Epoch: 9, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.920 Vali Acc: 0.733 Test Loss: 0.920 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.341508150100708
Epoch: 10, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.876 Vali Acc: 0.761 Test Loss: 0.876 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.410867691040039
Epoch: 11, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.893 Vali Acc: 0.744 Test Loss: 0.893 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2886784076690674
Epoch: 12, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.842 Vali Acc: 0.761 Test Loss: 0.842 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3136193752288818
Epoch: 13, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.011 Vali Acc: 0.739 Test Loss: 1.011 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2704460620880127
Epoch: 14, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.913 Vali Acc: 0.767 Test Loss: 0.913 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3592252731323242
Epoch: 15, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.027 Vali Acc: 0.739 Test Loss: 1.027 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2843787670135498
Epoch: 16, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.002 Vali Acc: 0.756 Test Loss: 1.002 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.202953815460205
Epoch: 17, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.056 Vali Acc: 0.744 Test Loss: 1.056 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2637863159179688
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.031 Vali Acc: 0.756 Test Loss: 1.031 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 395910
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8396570682525635
Epoch: 1, Steps: 12 | Train Loss: 1.540 Vali Loss: 0.992 Vali Acc: 0.606 Test Loss: 0.992 Test Acc: 0.606
Validation loss decreased (inf --> -0.605546).  Saving model ...
Epoch: 2 cost time: 2.2672207355499268
Epoch: 2, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.331 Vali Acc: 0.600 Test Loss: 1.331 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.108220338821411
Epoch: 3, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.754 Vali Acc: 0.728 Test Loss: 0.754 Test Acc: 0.728
Validation loss decreased (-0.605546 --> -0.727770).  Saving model ...
Epoch: 4 cost time: 2.075754165649414
Epoch: 4, Steps: 12 | Train Loss: 0.316 Vali Loss: 1.595 Vali Acc: 0.706 Test Loss: 1.595 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2461495399475098
Epoch: 5, Steps: 12 | Train Loss: 0.446 Vali Loss: 1.985 Vali Acc: 0.689 Test Loss: 1.985 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1810085773468018
Epoch: 6, Steps: 12 | Train Loss: 0.531 Vali Loss: 1.667 Vali Acc: 0.733 Test Loss: 1.667 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733317).  Saving model ...
Epoch: 7 cost time: 2.246433973312378
Epoch: 7, Steps: 12 | Train Loss: 0.569 Vali Loss: 3.788 Vali Acc: 0.667 Test Loss: 3.788 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3185930252075195
Epoch: 8, Steps: 12 | Train Loss: 0.361 Vali Loss: 2.334 Vali Acc: 0.678 Test Loss: 2.334 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4236128330230713
Epoch: 9, Steps: 12 | Train Loss: 0.262 Vali Loss: 2.758 Vali Acc: 0.694 Test Loss: 2.758 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.254211187362671
Epoch: 10, Steps: 12 | Train Loss: 0.367 Vali Loss: 2.585 Vali Acc: 0.728 Test Loss: 2.585 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.220059394836426
Epoch: 11, Steps: 12 | Train Loss: 0.288 Vali Loss: 3.080 Vali Acc: 0.672 Test Loss: 3.080 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.186253309249878
Epoch: 12, Steps: 12 | Train Loss: 0.350 Vali Loss: 4.343 Vali Acc: 0.706 Test Loss: 4.343 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.343303918838501
Epoch: 13, Steps: 12 | Train Loss: 0.117 Vali Loss: 3.334 Vali Acc: 0.733 Test Loss: 3.334 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.458514451980591
Epoch: 14, Steps: 12 | Train Loss: 0.003 Vali Loss: 3.467 Vali Acc: 0.756 Test Loss: 3.467 Test Acc: 0.756
Validation loss decreased (-0.733317 --> -0.755521).  Saving model ...
Epoch: 15 cost time: 2.2936460971832275
Epoch: 15, Steps: 12 | Train Loss: 0.001 Vali Loss: 3.890 Vali Acc: 0.756 Test Loss: 3.890 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.040158748626709
Epoch: 16, Steps: 12 | Train Loss: 0.076 Vali Loss: 4.134 Vali Acc: 0.767 Test Loss: 4.134 Test Acc: 0.767
Validation loss decreased (-0.755521 --> -0.766625).  Saving model ...
Epoch: 17 cost time: 2.025413990020752
Epoch: 17, Steps: 12 | Train Loss: 0.189 Vali Loss: 2.999 Vali Acc: 0.772 Test Loss: 2.999 Test Acc: 0.772
Validation loss decreased (-0.766625 --> -0.772192).  Saving model ...
Epoch: 18 cost time: 2.0420467853546143
Epoch: 18, Steps: 12 | Train Loss: 0.202 Vali Loss: 4.006 Vali Acc: 0.756 Test Loss: 4.006 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1929664611816406
Epoch: 19, Steps: 12 | Train Loss: 0.245 Vali Loss: 3.705 Vali Acc: 0.733 Test Loss: 3.705 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1466448307037354
Epoch: 20, Steps: 12 | Train Loss: 0.129 Vali Loss: 4.818 Vali Acc: 0.789 Test Loss: 4.818 Test Acc: 0.789
Validation loss decreased (-0.772192 --> -0.788841).  Saving model ...
Epoch: 21 cost time: 2.0333476066589355
Epoch: 21, Steps: 12 | Train Loss: 0.372 Vali Loss: 6.729 Vali Acc: 0.683 Test Loss: 6.729 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.042288303375244
Epoch: 22, Steps: 12 | Train Loss: 0.244 Vali Loss: 4.321 Vali Acc: 0.722 Test Loss: 4.321 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.164292097091675
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 5.208 Vali Acc: 0.717 Test Loss: 5.208 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.256453037261963
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 6.609 Vali Acc: 0.744 Test Loss: 6.609 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0792794227600098
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 5.213 Vali Acc: 0.722 Test Loss: 5.213 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.1972365379333496
Epoch: 26, Steps: 12 | Train Loss: 0.210 Vali Loss: 6.733 Vali Acc: 0.728 Test Loss: 6.733 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.1533923149108887
Epoch: 27, Steps: 12 | Train Loss: 0.340 Vali Loss: 9.169 Vali Acc: 0.706 Test Loss: 9.169 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.1805198192596436
Epoch: 28, Steps: 12 | Train Loss: 0.212 Vali Loss: 7.454 Vali Acc: 0.706 Test Loss: 7.454 Test Acc: 0.706
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.161517858505249
Epoch: 29, Steps: 12 | Train Loss: 0.554 Vali Loss: 6.278 Vali Acc: 0.750 Test Loss: 6.278 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.188450574874878
Epoch: 30, Steps: 12 | Train Loss: 0.186 Vali Loss: 4.768 Vali Acc: 0.744 Test Loss: 4.768 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 1139718
model size : 6.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1460487842559814
Epoch: 1, Steps: 12 | Train Loss: 1.481 Vali Loss: 0.983 Vali Acc: 0.606 Test Loss: 0.983 Test Acc: 0.606
Validation loss decreased (inf --> -0.605546).  Saving model ...
Epoch: 2 cost time: 1.470334529876709
Epoch: 2, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.783 Vali Acc: 0.678 Test Loss: 0.783 Test Acc: 0.678
Validation loss decreased (-0.605546 --> -0.677770).  Saving model ...
Epoch: 3 cost time: 1.4892206192016602
Epoch: 3, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.531 Vali Acc: 0.756 Test Loss: 0.531 Test Acc: 0.756
Validation loss decreased (-0.677770 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 1.485069990158081
Epoch: 4, Steps: 12 | Train Loss: 0.196 Vali Loss: 1.111 Vali Acc: 0.683 Test Loss: 1.111 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.448859691619873
Epoch: 5, Steps: 12 | Train Loss: 0.260 Vali Loss: 1.183 Vali Acc: 0.722 Test Loss: 1.183 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4786853790283203
Epoch: 6, Steps: 12 | Train Loss: 0.194 Vali Loss: 2.221 Vali Acc: 0.672 Test Loss: 2.221 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4324612617492676
Epoch: 7, Steps: 12 | Train Loss: 0.411 Vali Loss: 1.724 Vali Acc: 0.706 Test Loss: 1.724 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4937396049499512
Epoch: 8, Steps: 12 | Train Loss: 0.289 Vali Loss: 1.801 Vali Acc: 0.650 Test Loss: 1.801 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.550994873046875
Epoch: 9, Steps: 12 | Train Loss: 0.295 Vali Loss: 2.241 Vali Acc: 0.711 Test Loss: 2.241 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4539332389831543
Epoch: 10, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.531 Vali Acc: 0.728 Test Loss: 1.531 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4365053176879883
Epoch: 11, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.924 Vali Acc: 0.706 Test Loss: 1.924 Test Acc: 0.706
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4845268726348877
Epoch: 12, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.474 Vali Acc: 0.772 Test Loss: 1.474 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772207).  Saving model ...
Epoch: 13 cost time: 1.4698059558868408
Epoch: 13, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.809 Vali Acc: 0.728 Test Loss: 1.809 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5786693096160889
Epoch: 14, Steps: 12 | Train Loss: 0.026 Vali Loss: 2.026 Vali Acc: 0.717 Test Loss: 2.026 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6138534545898438
Epoch: 15, Steps: 12 | Train Loss: 0.019 Vali Loss: 2.160 Vali Acc: 0.728 Test Loss: 2.160 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5432376861572266
Epoch: 16, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.898 Vali Acc: 0.744 Test Loss: 1.898 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5260865688323975
Epoch: 17, Steps: 12 | Train Loss: 0.067 Vali Loss: 3.267 Vali Acc: 0.694 Test Loss: 3.267 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5954492092132568
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 2.611 Vali Acc: 0.750 Test Loss: 2.611 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5434682369232178
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 2.538 Vali Acc: 0.722 Test Loss: 2.538 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4840245246887207
Epoch: 20, Steps: 12 | Train Loss: 0.103 Vali Loss: 2.452 Vali Acc: 0.722 Test Loss: 2.452 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4296634197235107
Epoch: 21, Steps: 12 | Train Loss: 0.092 Vali Loss: 3.252 Vali Acc: 0.706 Test Loss: 3.252 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4065964221954346
Epoch: 22, Steps: 12 | Train Loss: 0.029 Vali Loss: 3.749 Vali Acc: 0.711 Test Loss: 3.749 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 679046
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.034329652786255
Epoch: 1, Steps: 12 | Train Loss: 1.681 Vali Loss: 0.990 Vali Acc: 0.561 Test Loss: 0.990 Test Acc: 0.561
Validation loss decreased (inf --> -0.561101).  Saving model ...
Epoch: 2 cost time: 1.5016684532165527
Epoch: 2, Steps: 12 | Train Loss: 0.765 Vali Loss: 1.002 Vali Acc: 0.628 Test Loss: 1.002 Test Acc: 0.628
Validation loss decreased (-0.561101 --> -0.627768).  Saving model ...
Epoch: 3 cost time: 1.5664513111114502
Epoch: 3, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.757 Vali Acc: 0.733 Test Loss: 0.757 Test Acc: 0.733
Validation loss decreased (-0.627768 --> -0.733326).  Saving model ...
Epoch: 4 cost time: 1.6616647243499756
Epoch: 4, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.873 Vali Acc: 0.711 Test Loss: 0.873 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6046783924102783
Epoch: 5, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.837 Vali Acc: 0.733 Test Loss: 0.837 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4904797077178955
Epoch: 6, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.664 Vali Acc: 0.683 Test Loss: 1.664 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.544196605682373
Epoch: 7, Steps: 12 | Train Loss: 0.529 Vali Loss: 1.847 Vali Acc: 0.694 Test Loss: 1.847 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4095726013183594
Epoch: 8, Steps: 12 | Train Loss: 0.218 Vali Loss: 1.613 Vali Acc: 0.689 Test Loss: 1.613 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5108914375305176
Epoch: 9, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.624 Vali Acc: 0.706 Test Loss: 1.624 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5593235492706299
Epoch: 10, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.535 Vali Acc: 0.728 Test Loss: 1.535 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5193612575531006
Epoch: 11, Steps: 12 | Train Loss: 0.095 Vali Loss: 2.069 Vali Acc: 0.717 Test Loss: 2.069 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7037572860717773
Epoch: 12, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.632 Vali Acc: 0.756 Test Loss: 1.632 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755539).  Saving model ...
Epoch: 13 cost time: 1.499572992324829
Epoch: 13, Steps: 12 | Train Loss: 0.229 Vali Loss: 2.030 Vali Acc: 0.700 Test Loss: 2.030 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.634272813796997
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 1.823 Vali Acc: 0.767 Test Loss: 1.823 Test Acc: 0.767
Validation loss decreased (-0.755539 --> -0.766648).  Saving model ...
Epoch: 15 cost time: 1.6205298900604248
Epoch: 15, Steps: 12 | Train Loss: 0.056 Vali Loss: 2.889 Vali Acc: 0.706 Test Loss: 2.889 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4985918998718262
Epoch: 16, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.739 Vali Acc: 0.761 Test Loss: 1.739 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4726619720458984
Epoch: 17, Steps: 12 | Train Loss: 0.061 Vali Loss: 2.213 Vali Acc: 0.750 Test Loss: 2.213 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6648097038269043
Epoch: 18, Steps: 12 | Train Loss: 0.011 Vali Loss: 2.839 Vali Acc: 0.722 Test Loss: 2.839 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6392617225646973
Epoch: 19, Steps: 12 | Train Loss: 0.019 Vali Loss: 2.486 Vali Acc: 0.728 Test Loss: 2.486 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5359482765197754
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 2.521 Vali Acc: 0.717 Test Loss: 2.521 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6972064971923828
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 2.678 Vali Acc: 0.733 Test Loss: 2.678 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.560992956161499
Epoch: 22, Steps: 12 | Train Loss: 0.004 Vali Loss: 2.363 Vali Acc: 0.717 Test Loss: 2.363 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.461519479751587
Epoch: 23, Steps: 12 | Train Loss: 0.009 Vali Loss: 2.745 Vali Acc: 0.728 Test Loss: 2.745 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5110743045806885
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 2.957 Vali Acc: 0.700 Test Loss: 2.957 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 660742
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1279678344726562
Epoch: 1, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.065 Vali Acc: 0.572 Test Loss: 1.065 Test Acc: 0.572
Validation loss decreased (inf --> -0.572212).  Saving model ...
Epoch: 2 cost time: 1.4948253631591797
Epoch: 2, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.756 Vali Acc: 0.683 Test Loss: 0.756 Test Acc: 0.683
Validation loss decreased (-0.572212 --> -0.683326).  Saving model ...
Epoch: 3 cost time: 1.7447524070739746
Epoch: 3, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.778 Vali Acc: 0.694 Test Loss: 0.778 Test Acc: 0.694
Validation loss decreased (-0.683326 --> -0.694437).  Saving model ...
Epoch: 4 cost time: 1.616258144378662
Epoch: 4, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.683 Vali Acc: 0.728 Test Loss: 0.683 Test Acc: 0.728
Validation loss decreased (-0.694437 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 1.6180834770202637
Epoch: 5, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.813 Vali Acc: 0.733 Test Loss: 0.813 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733325).  Saving model ...
Epoch: 6 cost time: 1.4787557125091553
Epoch: 6, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.953 Vali Acc: 0.722 Test Loss: 0.953 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4945454597473145
Epoch: 7, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.756 Vali Acc: 0.767 Test Loss: 0.756 Test Acc: 0.767
Validation loss decreased (-0.733325 --> -0.766659).  Saving model ...
Epoch: 8 cost time: 1.5290932655334473
Epoch: 8, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.169 Vali Acc: 0.744 Test Loss: 1.169 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.520312786102295
Epoch: 9, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.037 Vali Acc: 0.761 Test Loss: 1.037 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3577134609222412
Epoch: 10, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.403 Vali Acc: 0.728 Test Loss: 1.403 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4210307598114014
Epoch: 11, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.241 Vali Acc: 0.739 Test Loss: 1.241 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2815518379211426
Epoch: 12, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.820 Vali Acc: 0.722 Test Loss: 1.820 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3189702033996582
Epoch: 13, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.429 Vali Acc: 0.750 Test Loss: 1.429 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4202263355255127
Epoch: 14, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.929 Vali Acc: 0.717 Test Loss: 1.929 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2629570960998535
Epoch: 15, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.835 Vali Acc: 0.728 Test Loss: 1.835 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3741974830627441
Epoch: 16, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.585 Vali Acc: 0.750 Test Loss: 1.585 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5181188583374023
Epoch: 17, Steps: 12 | Train Loss: 0.242 Vali Loss: 2.315 Vali Acc: 0.689 Test Loss: 2.315 Test Acc: 0.689
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 513542
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1303513050079346
Epoch: 1, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.226 Vali Acc: 0.556 Test Loss: 1.226 Test Acc: 0.556
Validation loss decreased (inf --> -0.555543).  Saving model ...
Epoch: 2 cost time: 1.418137550354004
Epoch: 2, Steps: 12 | Train Loss: 0.922 Vali Loss: 0.917 Vali Acc: 0.639 Test Loss: 0.917 Test Acc: 0.639
Validation loss decreased (-0.555543 --> -0.638880).  Saving model ...
Epoch: 3 cost time: 1.5037105083465576
Epoch: 3, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.750 Vali Acc: 0.722 Test Loss: 0.750 Test Acc: 0.722
Validation loss decreased (-0.638880 --> -0.722215).  Saving model ...
Epoch: 4 cost time: 1.4659109115600586
Epoch: 4, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.745 Vali Acc: 0.744 Test Loss: 0.745 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 1.4203121662139893
Epoch: 5, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.825 Vali Acc: 0.711 Test Loss: 0.825 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.338895320892334
Epoch: 6, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.716 Vali Acc: 0.744 Test Loss: 0.716 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 1.3747427463531494
Epoch: 7, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.889 Vali Acc: 0.744 Test Loss: 0.889 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.357776403427124
Epoch: 8, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.892 Vali Acc: 0.739 Test Loss: 0.892 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.452491044998169
Epoch: 9, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.183 Vali Acc: 0.739 Test Loss: 1.183 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.386366367340088
Epoch: 10, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.106 Vali Acc: 0.728 Test Loss: 1.106 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3936412334442139
Epoch: 11, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.299 Vali Acc: 0.733 Test Loss: 1.299 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4396164417266846
Epoch: 12, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.749 Vali Acc: 0.722 Test Loss: 1.749 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4308385848999023
Epoch: 13, Steps: 12 | Train Loss: 0.212 Vali Loss: 1.361 Vali Acc: 0.750 Test Loss: 1.361 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749986).  Saving model ...
Epoch: 14 cost time: 1.467167615890503
Epoch: 14, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.166 Vali Acc: 0.744 Test Loss: 1.166 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.382946252822876
Epoch: 15, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.292 Vali Acc: 0.750 Test Loss: 1.292 Test Acc: 0.750
Validation loss decreased (-0.749986 --> -0.749987).  Saving model ...
Epoch: 16 cost time: 1.3755548000335693
Epoch: 16, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.372 Vali Acc: 0.756 Test Loss: 1.372 Test Acc: 0.756
Validation loss decreased (-0.749987 --> -0.755542).  Saving model ...
Epoch: 17 cost time: 1.385573387145996
Epoch: 17, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.376 Vali Acc: 0.761 Test Loss: 1.376 Test Acc: 0.761
Validation loss decreased (-0.755542 --> -0.761097).  Saving model ...
Epoch: 18 cost time: 1.3812651634216309
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.327 Vali Acc: 0.767 Test Loss: 1.327 Test Acc: 0.767
Validation loss decreased (-0.761097 --> -0.766653).  Saving model ...
Epoch: 19 cost time: 1.3883254528045654
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.325 Vali Acc: 0.783 Test Loss: 1.325 Test Acc: 0.783
Validation loss decreased (-0.766653 --> -0.783320).  Saving model ...
Epoch: 20 cost time: 1.3681695461273193
Epoch: 20, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.306 Vali Acc: 0.772 Test Loss: 1.306 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5772621631622314
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.772 Test Loss: 1.310 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3578486442565918
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.772 Test Loss: 1.321 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.321434497833252
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.778 Test Loss: 1.330 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3880274295806885
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.778 Test Loss: 1.332 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4175240993499756
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.778 Test Loss: 1.328 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4473814964294434
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.772 Test Loss: 1.336 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4543428421020508
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.772 Test Loss: 1.343 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3936817646026611
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.778 Test Loss: 1.346 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.368511438369751
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.778 Test Loss: 1.346 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 421638
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.766089677810669
Epoch: 1, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.339 Vali Acc: 0.450 Test Loss: 1.339 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.310689926147461
Epoch: 2, Steps: 12 | Train Loss: 1.032 Vali Loss: 0.965 Vali Acc: 0.611 Test Loss: 0.965 Test Acc: 0.611
Validation loss decreased (-0.449987 --> -0.611101).  Saving model ...
Epoch: 3 cost time: 1.2121171951293945
Epoch: 3, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.761 Vali Acc: 0.706 Test Loss: 0.761 Test Acc: 0.706
Validation loss decreased (-0.611101 --> -0.705548).  Saving model ...
Epoch: 4 cost time: 1.3996367454528809
Epoch: 4, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.692 Vali Acc: 0.733 Test Loss: 0.692 Test Acc: 0.733
Validation loss decreased (-0.705548 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 1.322171926498413
Epoch: 5, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.656 Vali Acc: 0.750 Test Loss: 0.656 Test Acc: 0.750
Validation loss decreased (-0.733326 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.4550909996032715
Epoch: 6, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.823 Vali Acc: 0.722 Test Loss: 0.823 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.406294345855713
Epoch: 7, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.774 Vali Acc: 0.739 Test Loss: 0.774 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4175951480865479
Epoch: 8, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.742 Vali Acc: 0.767 Test Loss: 0.742 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766659).  Saving model ...
Epoch: 9 cost time: 1.4500648975372314
Epoch: 9, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.801 Vali Acc: 0.744 Test Loss: 0.801 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3764233589172363
Epoch: 10, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3019134998321533
Epoch: 11, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2657394409179688
Epoch: 12, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.101 Vali Acc: 0.733 Test Loss: 1.101 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2710940837860107
Epoch: 13, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.913 Vali Acc: 0.761 Test Loss: 0.913 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3152432441711426
Epoch: 14, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.058 Vali Acc: 0.761 Test Loss: 1.058 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.264462947845459
Epoch: 15, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.032 Vali Acc: 0.744 Test Loss: 1.032 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3490846157073975
Epoch: 16, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.021 Vali Acc: 0.772 Test Loss: 1.021 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772212).  Saving model ...
Epoch: 17 cost time: 1.4436817169189453
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.025 Vali Acc: 0.750 Test Loss: 1.025 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3408145904541016
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.001 Vali Acc: 0.756 Test Loss: 1.001 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3809356689453125
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.125 Vali Acc: 0.750 Test Loss: 1.125 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.341986894607544
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.011 Vali Acc: 0.761 Test Loss: 1.011 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1947448253631592
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.995 Vali Acc: 0.778 Test Loss: 0.995 Test Acc: 0.778
Validation loss decreased (-0.772212 --> -0.777768).  Saving model ...
Epoch: 22 cost time: 1.259728193283081
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.962 Vali Acc: 0.772 Test Loss: 0.962 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2659084796905518
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.761 Test Loss: 1.030 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3322844505310059
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.126 Vali Acc: 0.750 Test Loss: 1.126 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4177610874176025
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.062 Vali Acc: 0.772 Test Loss: 1.062 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3379817008972168
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.025 Vali Acc: 0.778 Test Loss: 1.025 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.312554121017456
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.023 Vali Acc: 0.778 Test Loss: 1.023 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2911088466644287
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.041 Vali Acc: 0.778 Test Loss: 1.041 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3535370826721191
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.048 Vali Acc: 0.772 Test Loss: 1.048 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3198204040527344
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.772 Test Loss: 1.050 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2904775142669678
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.038 Vali Acc: 0.783 Test Loss: 1.038 Test Acc: 0.783
Validation loss decreased (-0.777768 --> -0.783323).  Saving model ...
Epoch: 32 cost time: 1.3502047061920166
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.778 Test Loss: 1.037 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3937833309173584
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.772 Test Loss: 1.049 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3276751041412354
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.772 Test Loss: 1.052 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3772084712982178
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.767 Test Loss: 1.050 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3395752906799316
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.772 Test Loss: 1.045 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3460252285003662
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.767 Test Loss: 1.068 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3271663188934326
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.767 Test Loss: 1.078 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3023700714111328
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.772 Test Loss: 1.069 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2899484634399414
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.772 Test Loss: 1.070 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4347813129425049
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.088 Vali Acc: 0.767 Test Loss: 1.088 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 348294
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9979398250579834
Epoch: 1, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.356 Vali Acc: 0.517 Test Loss: 1.356 Test Acc: 0.517
Validation loss decreased (inf --> -0.516653).  Saving model ...
Epoch: 2 cost time: 1.362102746963501
Epoch: 2, Steps: 12 | Train Loss: 1.042 Vali Loss: 0.924 Vali Acc: 0.617 Test Loss: 0.924 Test Acc: 0.617
Validation loss decreased (-0.516653 --> -0.616657).  Saving model ...
Epoch: 3 cost time: 1.3723149299621582
Epoch: 3, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.809 Vali Acc: 0.694 Test Loss: 0.809 Test Acc: 0.694
Validation loss decreased (-0.616657 --> -0.694436).  Saving model ...
Epoch: 4 cost time: 1.3822243213653564
Epoch: 4, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.703 Vali Acc: 0.728 Test Loss: 0.703 Test Acc: 0.728
Validation loss decreased (-0.694436 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 1.2914507389068604
Epoch: 5, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.758 Vali Acc: 0.733 Test Loss: 0.758 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 1.3247451782226562
Epoch: 6, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.793 Vali Acc: 0.711 Test Loss: 0.793 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2280128002166748
Epoch: 7, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.733 Vali Acc: 0.750 Test Loss: 0.733 Test Acc: 0.750
Validation loss decreased (-0.733326 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 1.2484345436096191
Epoch: 8, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.759 Vali Acc: 0.750 Test Loss: 0.759 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2794380187988281
Epoch: 9, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.930 Vali Acc: 0.739 Test Loss: 0.930 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2717556953430176
Epoch: 10, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.797 Vali Acc: 0.767 Test Loss: 0.797 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766659).  Saving model ...
Epoch: 11 cost time: 1.3147687911987305
Epoch: 11, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.876 Vali Acc: 0.761 Test Loss: 0.876 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2157032489776611
Epoch: 12, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.939 Vali Acc: 0.750 Test Loss: 0.939 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2755191326141357
Epoch: 13, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.993 Vali Acc: 0.744 Test Loss: 0.993 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2241122722625732
Epoch: 14, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.069 Vali Acc: 0.739 Test Loss: 1.069 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.356886386871338
Epoch: 15, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.977 Vali Acc: 0.756 Test Loss: 0.977 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3693218231201172
Epoch: 16, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.138 Vali Acc: 0.739 Test Loss: 1.138 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4070243835449219
Epoch: 17, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.081 Vali Acc: 0.733 Test Loss: 1.081 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6360890865325928
Epoch: 18, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.080 Vali Acc: 0.739 Test Loss: 1.080 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7917439937591553
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.086 Vali Acc: 0.750 Test Loss: 1.086 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7055611610412598
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.069 Vali Acc: 0.761 Test Loss: 1.069 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 330118
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8409812450408936
Epoch: 1, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.282 Vali Acc: 0.572 Test Loss: 1.282 Test Acc: 0.572
Validation loss decreased (inf --> -0.572209).  Saving model ...
Epoch: 2 cost time: 2.285076379776001
Epoch: 2, Steps: 12 | Train Loss: 0.773 Vali Loss: 1.797 Vali Acc: 0.639 Test Loss: 1.797 Test Acc: 0.639
Validation loss decreased (-0.572209 --> -0.638871).  Saving model ...
Epoch: 3 cost time: 2.2154300212860107
Epoch: 3, Steps: 12 | Train Loss: 0.704 Vali Loss: 1.383 Vali Acc: 0.683 Test Loss: 1.383 Test Acc: 0.683
Validation loss decreased (-0.638871 --> -0.683320).  Saving model ...
Epoch: 4 cost time: 2.1029176712036133
Epoch: 4, Steps: 12 | Train Loss: 0.359 Vali Loss: 1.311 Vali Acc: 0.711 Test Loss: 1.311 Test Acc: 0.711
Validation loss decreased (-0.683320 --> -0.711098).  Saving model ...
Epoch: 5 cost time: 2.363492965698242
Epoch: 5, Steps: 12 | Train Loss: 0.392 Vali Loss: 2.344 Vali Acc: 0.667 Test Loss: 2.344 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.173603057861328
Epoch: 6, Steps: 12 | Train Loss: 0.492 Vali Loss: 1.799 Vali Acc: 0.711 Test Loss: 1.799 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.326786756515503
Epoch: 7, Steps: 12 | Train Loss: 0.278 Vali Loss: 2.181 Vali Acc: 0.700 Test Loss: 2.181 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.445167303085327
Epoch: 8, Steps: 12 | Train Loss: 0.561 Vali Loss: 2.455 Vali Acc: 0.767 Test Loss: 2.455 Test Acc: 0.767
Validation loss decreased (-0.711098 --> -0.766642).  Saving model ...
Epoch: 9 cost time: 2.3559653759002686
Epoch: 9, Steps: 12 | Train Loss: 0.463 Vali Loss: 2.259 Vali Acc: 0.722 Test Loss: 2.259 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.505110025405884
Epoch: 10, Steps: 12 | Train Loss: 0.271 Vali Loss: 2.593 Vali Acc: 0.717 Test Loss: 2.593 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3408987522125244
Epoch: 11, Steps: 12 | Train Loss: 0.105 Vali Loss: 3.594 Vali Acc: 0.717 Test Loss: 3.594 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2687337398529053
Epoch: 12, Steps: 12 | Train Loss: 0.228 Vali Loss: 3.803 Vali Acc: 0.700 Test Loss: 3.803 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3954312801361084
Epoch: 13, Steps: 12 | Train Loss: 0.110 Vali Loss: 3.584 Vali Acc: 0.661 Test Loss: 3.584 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2536540031433105
Epoch: 14, Steps: 12 | Train Loss: 0.104 Vali Loss: 2.859 Vali Acc: 0.733 Test Loss: 2.859 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.380200147628784
Epoch: 15, Steps: 12 | Train Loss: 0.105 Vali Loss: 3.629 Vali Acc: 0.689 Test Loss: 3.629 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1692495346069336
Epoch: 16, Steps: 12 | Train Loss: 0.210 Vali Loss: 6.783 Vali Acc: 0.600 Test Loss: 6.783 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.209352731704712
Epoch: 17, Steps: 12 | Train Loss: 0.613 Vali Loss: 6.927 Vali Acc: 0.700 Test Loss: 6.927 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2981696128845215
Epoch: 18, Steps: 12 | Train Loss: 0.583 Vali Loss: 5.959 Vali Acc: 0.733 Test Loss: 5.959 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 1106822
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1397218704223633
Epoch: 1, Steps: 12 | Train Loss: 1.626 Vali Loss: 0.920 Vali Acc: 0.617 Test Loss: 0.920 Test Acc: 0.617
Validation loss decreased (inf --> -0.616657).  Saving model ...
Epoch: 2 cost time: 1.70859956741333
Epoch: 2, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.950 Vali Acc: 0.639 Test Loss: 0.950 Test Acc: 0.639
Validation loss decreased (-0.616657 --> -0.638879).  Saving model ...
Epoch: 3 cost time: 1.7444324493408203
Epoch: 3, Steps: 12 | Train Loss: 0.455 Vali Loss: 1.057 Vali Acc: 0.661 Test Loss: 1.057 Test Acc: 0.661
Validation loss decreased (-0.638879 --> -0.661101).  Saving model ...
Epoch: 4 cost time: 1.7375295162200928
Epoch: 4, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.963 Vali Acc: 0.733 Test Loss: 0.963 Test Acc: 0.733
Validation loss decreased (-0.661101 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 1.7143492698669434
Epoch: 5, Steps: 12 | Train Loss: 0.234 Vali Loss: 1.082 Vali Acc: 0.694 Test Loss: 1.082 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5378944873809814
Epoch: 6, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.939 Vali Acc: 0.750 Test Loss: 0.939 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 1.448836326599121
Epoch: 7, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.025 Vali Acc: 0.772 Test Loss: 1.025 Test Acc: 0.772
Validation loss decreased (-0.749991 --> -0.772212).  Saving model ...
Epoch: 8 cost time: 1.5784881114959717
Epoch: 8, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.023 Vali Acc: 0.756 Test Loss: 1.023 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5660419464111328
Epoch: 9, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.431 Vali Acc: 0.694 Test Loss: 1.431 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.584268569946289
Epoch: 10, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.338 Vali Acc: 0.711 Test Loss: 1.338 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6211109161376953
Epoch: 11, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.547 Vali Acc: 0.772 Test Loss: 1.547 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3206863403320312
Epoch: 12, Steps: 12 | Train Loss: 0.176 Vali Loss: 2.098 Vali Acc: 0.728 Test Loss: 2.098 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6461055278778076
Epoch: 13, Steps: 12 | Train Loss: 0.242 Vali Loss: 1.702 Vali Acc: 0.739 Test Loss: 1.702 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6227302551269531
Epoch: 14, Steps: 12 | Train Loss: 0.085 Vali Loss: 2.141 Vali Acc: 0.728 Test Loss: 2.141 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5804202556610107
Epoch: 15, Steps: 12 | Train Loss: 0.072 Vali Loss: 2.425 Vali Acc: 0.733 Test Loss: 2.425 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5857133865356445
Epoch: 16, Steps: 12 | Train Loss: 0.037 Vali Loss: 2.947 Vali Acc: 0.728 Test Loss: 2.947 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.739983320236206
Epoch: 17, Steps: 12 | Train Loss: 0.079 Vali Loss: 2.145 Vali Acc: 0.756 Test Loss: 2.145 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 646150
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.103015661239624
Epoch: 1, Steps: 12 | Train Loss: 1.677 Vali Loss: 0.991 Vali Acc: 0.606 Test Loss: 0.991 Test Acc: 0.606
Validation loss decreased (inf --> -0.605546).  Saving model ...
Epoch: 2 cost time: 1.5556869506835938
Epoch: 2, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.821 Vali Acc: 0.667 Test Loss: 0.821 Test Acc: 0.667
Validation loss decreased (-0.605546 --> -0.666658).  Saving model ...
Epoch: 3 cost time: 1.5142841339111328
Epoch: 3, Steps: 12 | Train Loss: 0.403 Vali Loss: 1.139 Vali Acc: 0.672 Test Loss: 1.139 Test Acc: 0.672
Validation loss decreased (-0.666658 --> -0.672211).  Saving model ...
Epoch: 4 cost time: 1.4567832946777344
Epoch: 4, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.859 Vali Acc: 0.739 Test Loss: 0.859 Test Acc: 0.739
Validation loss decreased (-0.672211 --> -0.738880).  Saving model ...
Epoch: 5 cost time: 1.6078693866729736
Epoch: 5, Steps: 12 | Train Loss: 0.212 Vali Loss: 1.039 Vali Acc: 0.672 Test Loss: 1.039 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.568469762802124
Epoch: 6, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.352 Vali Acc: 0.644 Test Loss: 1.352 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.644160270690918
Epoch: 7, Steps: 12 | Train Loss: 0.132 Vali Loss: 1.628 Vali Acc: 0.728 Test Loss: 1.628 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.756103515625
Epoch: 8, Steps: 12 | Train Loss: 0.254 Vali Loss: 1.276 Vali Acc: 0.756 Test Loss: 1.276 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755543).  Saving model ...
Epoch: 9 cost time: 1.5927209854125977
Epoch: 9, Steps: 12 | Train Loss: 0.251 Vali Loss: 1.682 Vali Acc: 0.706 Test Loss: 1.682 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6638765335083008
Epoch: 10, Steps: 12 | Train Loss: 0.146 Vali Loss: 2.549 Vali Acc: 0.633 Test Loss: 2.549 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6062207221984863
Epoch: 11, Steps: 12 | Train Loss: 0.192 Vali Loss: 1.794 Vali Acc: 0.717 Test Loss: 1.794 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6462631225585938
Epoch: 12, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.968 Vali Acc: 0.728 Test Loss: 1.968 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6118748188018799
Epoch: 13, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.914 Vali Acc: 0.739 Test Loss: 1.914 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5402703285217285
Epoch: 14, Steps: 12 | Train Loss: 0.043 Vali Loss: 2.485 Vali Acc: 0.733 Test Loss: 2.485 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.421924114227295
Epoch: 15, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.031 Vali Acc: 0.739 Test Loss: 2.031 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5399901866912842
Epoch: 16, Steps: 12 | Train Loss: 0.007 Vali Loss: 2.729 Vali Acc: 0.706 Test Loss: 2.729 Test Acc: 0.706
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5055463314056396
Epoch: 17, Steps: 12 | Train Loss: 0.044 Vali Loss: 2.615 Vali Acc: 0.733 Test Loss: 2.615 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4227650165557861
Epoch: 18, Steps: 12 | Train Loss: 0.009 Vali Loss: 2.603 Vali Acc: 0.750 Test Loss: 2.603 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 627846
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2900478839874268
Epoch: 1, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.090 Vali Acc: 0.572 Test Loss: 1.090 Test Acc: 0.572
Validation loss decreased (inf --> -0.572211).  Saving model ...
Epoch: 2 cost time: 1.6729955673217773
Epoch: 2, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.977 Vali Acc: 0.617 Test Loss: 0.977 Test Acc: 0.617
Validation loss decreased (-0.572211 --> -0.616657).  Saving model ...
Epoch: 3 cost time: 1.7415862083435059
Epoch: 3, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.860 Vali Acc: 0.656 Test Loss: 0.860 Test Acc: 0.656
Validation loss decreased (-0.616657 --> -0.655547).  Saving model ...
Epoch: 4 cost time: 1.6015501022338867
Epoch: 4, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
Validation loss decreased (-0.655547 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 1.6305599212646484
Epoch: 5, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.739 Vali Acc: 0.761 Test Loss: 0.739 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761104).  Saving model ...
Epoch: 6 cost time: 1.6585807800292969
Epoch: 6, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.870 Vali Acc: 0.728 Test Loss: 0.870 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5360445976257324
Epoch: 7, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.792 Vali Acc: 0.744 Test Loss: 0.792 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3844423294067383
Epoch: 8, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.112 Vali Acc: 0.722 Test Loss: 1.112 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9150748252868652
Epoch: 9, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.244 Vali Acc: 0.711 Test Loss: 1.244 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7102482318878174
Epoch: 10, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.984 Vali Acc: 0.750 Test Loss: 0.984 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7133715152740479
Epoch: 11, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.222 Vali Acc: 0.750 Test Loss: 1.222 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7980010509490967
Epoch: 12, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.232 Vali Acc: 0.744 Test Loss: 1.232 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6625826358795166
Epoch: 13, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.108 Vali Acc: 0.772 Test Loss: 1.108 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772211).  Saving model ...
Epoch: 14 cost time: 1.744497299194336
Epoch: 14, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.118 Vali Acc: 0.767 Test Loss: 1.118 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6139838695526123
Epoch: 15, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.594 Vali Acc: 0.733 Test Loss: 1.594 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2667109966278076
Epoch: 16, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.589 Vali Acc: 0.744 Test Loss: 1.589 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3025617599487305
Epoch: 17, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.204 Vali Acc: 0.756 Test Loss: 1.204 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7313508987426758
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.514 Vali Acc: 0.733 Test Loss: 1.514 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.372591495513916
Epoch: 19, Steps: 12 | Train Loss: 0.011 Vali Loss: 2.293 Vali Acc: 0.700 Test Loss: 2.293 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7159669399261475
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.779 Vali Acc: 0.733 Test Loss: 1.779 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8444874286651611
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.834 Vali Acc: 0.733 Test Loss: 1.834 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7190320491790771
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.078 Vali Acc: 0.706 Test Loss: 2.078 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8549435138702393
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.007 Vali Acc: 0.750 Test Loss: 2.007 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 480646
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.174224615097046
Epoch: 1, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.121 Vali Acc: 0.561 Test Loss: 1.121 Test Acc: 0.561
Validation loss decreased (inf --> -0.561100).  Saving model ...
Epoch: 2 cost time: 1.5521626472473145
Epoch: 2, Steps: 12 | Train Loss: 0.832 Vali Loss: 0.784 Vali Acc: 0.650 Test Loss: 0.784 Test Acc: 0.650
Validation loss decreased (-0.561100 --> -0.649992).  Saving model ...
Epoch: 3 cost time: 1.4407401084899902
Epoch: 3, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.755 Vali Acc: 0.711 Test Loss: 0.755 Test Acc: 0.711
Validation loss decreased (-0.649992 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.430382251739502
Epoch: 4, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.723 Vali Acc: 0.733 Test Loss: 0.723 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 1.4560027122497559
Epoch: 5, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.960 Vali Acc: 0.717 Test Loss: 0.960 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2186980247497559
Epoch: 6, Steps: 12 | Train Loss: 0.144 Vali Loss: 1.052 Vali Acc: 0.733 Test Loss: 1.052 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4437708854675293
Epoch: 7, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.876 Vali Acc: 0.733 Test Loss: 0.876 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3986642360687256
Epoch: 8, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.945 Vali Acc: 0.744 Test Loss: 0.945 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744435).  Saving model ...
Epoch: 9 cost time: 1.7204303741455078
Epoch: 9, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.122 Vali Acc: 0.744 Test Loss: 1.122 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7465403079986572
Epoch: 10, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.979 Vali Acc: 0.744 Test Loss: 0.979 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7550714015960693
Epoch: 11, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.962 Vali Acc: 0.728 Test Loss: 0.962 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8877637386322021
Epoch: 12, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.212 Vali Acc: 0.722 Test Loss: 1.212 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6248869895935059
Epoch: 13, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.089 Vali Acc: 0.761 Test Loss: 1.089 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761100).  Saving model ...
Epoch: 14 cost time: 1.699903964996338
Epoch: 14, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.399 Vali Acc: 0.739 Test Loss: 1.399 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7346596717834473
Epoch: 15, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.035 Vali Acc: 0.750 Test Loss: 1.035 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.636944055557251
Epoch: 16, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.097 Vali Acc: 0.728 Test Loss: 1.097 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6459119319915771
Epoch: 17, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.149 Vali Acc: 0.767 Test Loss: 1.149 Test Acc: 0.767
Validation loss decreased (-0.761100 --> -0.766655).  Saving model ...
Epoch: 18 cost time: 1.4395248889923096
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.529 Vali Acc: 0.767 Test Loss: 1.529 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5407347679138184
Epoch: 19, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.597 Vali Acc: 0.739 Test Loss: 1.597 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6592676639556885
Epoch: 20, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.241 Vali Acc: 0.767 Test Loss: 1.241 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.583829402923584
Epoch: 21, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.177 Vali Acc: 0.767 Test Loss: 1.177 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6221644878387451
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.403 Vali Acc: 0.750 Test Loss: 1.403 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7047929763793945
Epoch: 23, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.361 Vali Acc: 0.733 Test Loss: 1.361 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.64231276512146
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.750 Test Loss: 1.330 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.774242639541626
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.744 Test Loss: 1.323 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7049214839935303
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.761 Test Loss: 1.351 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6272273063659668
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.744 Test Loss: 1.355 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 388742
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.309251070022583
Epoch: 1, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.263 Vali Acc: 0.522 Test Loss: 1.263 Test Acc: 0.522
Validation loss decreased (inf --> -0.522210).  Saving model ...
Epoch: 2 cost time: 1.606616497039795
Epoch: 2, Steps: 12 | Train Loss: 1.063 Vali Loss: 0.925 Vali Acc: 0.578 Test Loss: 0.925 Test Acc: 0.578
Validation loss decreased (-0.522210 --> -0.577769).  Saving model ...
Epoch: 3 cost time: 1.5811405181884766
Epoch: 3, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.736 Vali Acc: 0.683 Test Loss: 0.736 Test Acc: 0.683
Validation loss decreased (-0.577769 --> -0.683326).  Saving model ...
Epoch: 4 cost time: 1.692397117614746
Epoch: 4, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.697 Vali Acc: 0.722 Test Loss: 0.697 Test Acc: 0.722
Validation loss decreased (-0.683326 --> -0.722215).  Saving model ...
Epoch: 5 cost time: 1.650693655014038
Epoch: 5, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.725 Vali Acc: 0.728 Test Loss: 0.725 Test Acc: 0.728
Validation loss decreased (-0.722215 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.6056551933288574
Epoch: 6, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.684 Vali Acc: 0.739 Test Loss: 0.684 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738882).  Saving model ...
Epoch: 7 cost time: 1.5303339958190918
Epoch: 7, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.685 Vali Acc: 0.744 Test Loss: 0.685 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 1.728245496749878
Epoch: 8, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.818 Vali Acc: 0.744 Test Loss: 0.818 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6871311664581299
Epoch: 9, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.826 Vali Acc: 0.733 Test Loss: 0.826 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.896578073501587
Epoch: 10, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.913 Vali Acc: 0.728 Test Loss: 0.913 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8657023906707764
Epoch: 11, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.860 Vali Acc: 0.717 Test Loss: 0.860 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7889525890350342
Epoch: 12, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.077 Vali Acc: 0.728 Test Loss: 1.077 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7234761714935303
Epoch: 13, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.833 Vali Acc: 0.756 Test Loss: 0.833 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 1.8210220336914062
Epoch: 14, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.035 Vali Acc: 0.728 Test Loss: 1.035 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.795576810836792
Epoch: 15, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.972 Vali Acc: 0.756 Test Loss: 0.972 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7390177249908447
Epoch: 16, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.000 Vali Acc: 0.739 Test Loss: 1.000 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8432283401489258
Epoch: 17, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.995 Vali Acc: 0.778 Test Loss: 0.995 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777768).  Saving model ...
Epoch: 18 cost time: 1.6153573989868164
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.017 Vali Acc: 0.744 Test Loss: 1.017 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.709695816040039
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.059 Vali Acc: 0.744 Test Loss: 1.059 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6628608703613281
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.034 Vali Acc: 0.750 Test Loss: 1.034 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.701927661895752
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.750 Test Loss: 1.011 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5715749263763428
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.027 Vali Acc: 0.750 Test Loss: 1.027 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6853153705596924
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.041 Vali Acc: 0.744 Test Loss: 1.041 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6120054721832275
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.031 Vali Acc: 0.744 Test Loss: 1.031 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6608386039733887
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.043 Vali Acc: 0.744 Test Loss: 1.043 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.700275182723999
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.750 Test Loss: 1.046 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.781822919845581
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.041 Vali Acc: 0.756 Test Loss: 1.041 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 315398
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3070499897003174
Epoch: 1, Steps: 12 | Train Loss: 1.707 Vali Loss: 1.303 Vali Acc: 0.533 Test Loss: 1.303 Test Acc: 0.533
Validation loss decreased (inf --> -0.533320).  Saving model ...
Epoch: 2 cost time: 1.6775684356689453
Epoch: 2, Steps: 12 | Train Loss: 1.033 Vali Loss: 0.957 Vali Acc: 0.606 Test Loss: 0.957 Test Acc: 0.606
Validation loss decreased (-0.533320 --> -0.605546).  Saving model ...
Epoch: 3 cost time: 1.415769338607788
Epoch: 3, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.811 Vali Acc: 0.633 Test Loss: 0.811 Test Acc: 0.633
Validation loss decreased (-0.605546 --> -0.633325).  Saving model ...
Epoch: 4 cost time: 1.5378000736236572
Epoch: 4, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.779 Vali Acc: 0.711 Test Loss: 0.779 Test Acc: 0.711
Validation loss decreased (-0.633325 --> -0.711103).  Saving model ...
Epoch: 5 cost time: 1.5556244850158691
Epoch: 5, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.795 Vali Acc: 0.711 Test Loss: 0.795 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3979535102844238
Epoch: 6, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.657 Vali Acc: 0.728 Test Loss: 0.657 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 1.4039363861083984
Epoch: 7, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.721 Vali Acc: 0.750 Test Loss: 0.721 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 1.596219539642334
Epoch: 8, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.763 Vali Acc: 0.744 Test Loss: 0.763 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.609501600265503
Epoch: 9, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.825 Vali Acc: 0.744 Test Loss: 0.825 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5416314601898193
Epoch: 10, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.860 Vali Acc: 0.728 Test Loss: 0.860 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7619662284851074
Epoch: 11, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.872 Vali Acc: 0.739 Test Loss: 0.872 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6212451457977295
Epoch: 12, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.983 Vali Acc: 0.767 Test Loss: 0.983 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766657).  Saving model ...
Epoch: 13 cost time: 1.5000388622283936
Epoch: 13, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.920 Vali Acc: 0.761 Test Loss: 0.920 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6501374244689941
Epoch: 14, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5509965419769287
Epoch: 15, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.884 Vali Acc: 0.750 Test Loss: 0.884 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6699256896972656
Epoch: 16, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.926 Vali Acc: 0.761 Test Loss: 0.926 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.705676555633545
Epoch: 17, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.971 Vali Acc: 0.756 Test Loss: 0.971 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.792731761932373
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.958 Vali Acc: 0.761 Test Loss: 0.958 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6999552249908447
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.967 Vali Acc: 0.756 Test Loss: 0.967 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6598658561706543
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.992 Vali Acc: 0.761 Test Loss: 0.992 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.694413423538208
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.956 Vali Acc: 0.767 Test Loss: 0.956 Test Acc: 0.767
Validation loss decreased (-0.766657 --> -0.766657).  Saving model ...
Epoch: 22 cost time: 1.447927474975586
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.934 Vali Acc: 0.767 Test Loss: 0.934 Test Acc: 0.767
Validation loss decreased (-0.766657 --> -0.766657).  Saving model ...
Epoch: 23 cost time: 1.715977668762207
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.965 Vali Acc: 0.767 Test Loss: 0.965 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5800533294677734
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.001 Vali Acc: 0.767 Test Loss: 1.001 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6126368045806885
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.986 Vali Acc: 0.767 Test Loss: 0.986 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4659759998321533
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.761 Test Loss: 0.990 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7925896644592285
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.772 Test Loss: 0.995 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772212).  Saving model ...
Epoch: 28 cost time: 1.6602866649627686
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.996 Vali Acc: 0.767 Test Loss: 0.996 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7226555347442627
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.767 Test Loss: 1.006 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7729661464691162
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.761 Test Loss: 1.000 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.681579828262329
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.761 Test Loss: 0.983 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.754413366317749
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.013 Vali Acc: 0.761 Test Loss: 1.013 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7686595916748047
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.772 Test Loss: 1.030 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6340117454528809
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.029 Vali Acc: 0.772 Test Loss: 1.029 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4492204189300537
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.772 Test Loss: 1.024 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4731433391571045
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.022 Vali Acc: 0.778 Test Loss: 1.022 Test Acc: 0.778
Validation loss decreased (-0.772212 --> -0.777768).  Saving model ...
Epoch: 37 cost time: 1.6653366088867188
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.029 Vali Acc: 0.767 Test Loss: 1.029 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4469337463378906
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.767 Test Loss: 1.036 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.6120171546936035
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.772 Test Loss: 1.032 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.728515386581421
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.772 Test Loss: 1.033 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.6078600883483887
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.772 Test Loss: 1.037 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.543013572692871
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.029 Vali Acc: 0.761 Test Loss: 1.029 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.7699756622314453
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.778 Test Loss: 1.013 Test Acc: 0.778
Validation loss decreased (-0.777768 --> -0.777768).  Saving model ...
Epoch: 44 cost time: 1.6795506477355957
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.767 Test Loss: 1.026 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7102408409118652
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.778 Test Loss: 1.031 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6147940158843994
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.772 Test Loss: 1.030 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6757540702819824
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.772 Test Loss: 1.020 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6837248802185059
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.778 Test Loss: 1.015 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.6923704147338867
Epoch: 49, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.027 Vali Acc: 0.772 Test Loss: 1.027 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.6631286144256592
Epoch: 50, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.772 Test Loss: 1.033 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.597343921661377
Epoch: 51, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.772 Test Loss: 1.033 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.6157820224761963
Epoch: 52, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.778 Test Loss: 1.031 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.6715059280395508
Epoch: 53, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.778 Test Loss: 1.030 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm128_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 297222
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.042089939117432
Epoch: 1, Steps: 12 | Train Loss: 1.500 Vali Loss: 1.168 Vali Acc: 0.489 Test Loss: 1.168 Test Acc: 0.489
Validation loss decreased (inf --> -0.488877).  Saving model ...
Epoch: 2 cost time: 2.4284133911132812
Epoch: 2, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.791 Vali Acc: 0.694 Test Loss: 0.791 Test Acc: 0.694
Validation loss decreased (-0.488877 --> -0.694437).  Saving model ...
Epoch: 3 cost time: 2.562004566192627
Epoch: 3, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
Validation loss decreased (-0.694437 --> -0.783327).  Saving model ...
Epoch: 4 cost time: 2.463984966278076
Epoch: 4, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.728 Vali Acc: 0.733 Test Loss: 0.728 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.569988965988159
Epoch: 5, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.955 Vali Acc: 0.739 Test Loss: 0.955 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4785807132720947
Epoch: 6, Steps: 12 | Train Loss: 0.200 Vali Loss: 1.054 Vali Acc: 0.739 Test Loss: 1.054 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.494250535964966
Epoch: 7, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.092 Vali Acc: 0.750 Test Loss: 1.092 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.501208543777466
Epoch: 8, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.485 Vali Acc: 0.733 Test Loss: 1.485 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2354371547698975
Epoch: 9, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.472 Vali Acc: 0.728 Test Loss: 1.472 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.424381732940674
Epoch: 10, Steps: 12 | Train Loss: 0.240 Vali Loss: 1.365 Vali Acc: 0.750 Test Loss: 1.365 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3805928230285645
Epoch: 11, Steps: 12 | Train Loss: 0.291 Vali Loss: 3.126 Vali Acc: 0.672 Test Loss: 3.126 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3974392414093018
Epoch: 12, Steps: 12 | Train Loss: 0.303 Vali Loss: 2.062 Vali Acc: 0.733 Test Loss: 2.062 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.531236171722412
Epoch: 13, Steps: 12 | Train Loss: 0.147 Vali Loss: 2.482 Vali Acc: 0.744 Test Loss: 2.482 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 570246
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.476569890975952
Epoch: 1, Steps: 12 | Train Loss: 1.626 Vali Loss: 1.113 Vali Acc: 0.589 Test Loss: 1.113 Test Acc: 0.589
Validation loss decreased (inf --> -0.588878).  Saving model ...
Epoch: 2 cost time: 1.7725999355316162
Epoch: 2, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.177 Vali Acc: 0.550 Test Loss: 1.177 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7426598072052002
Epoch: 3, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.742 Vali Acc: 0.689 Test Loss: 0.742 Test Acc: 0.689
Validation loss decreased (-0.588878 --> -0.688881).  Saving model ...
Epoch: 4 cost time: 1.7891242504119873
Epoch: 4, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.788 Vali Acc: 0.717 Test Loss: 0.788 Test Acc: 0.717
Validation loss decreased (-0.688881 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 1.7412519454956055
Epoch: 5, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.738 Vali Acc: 0.739 Test Loss: 0.738 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 1.8138470649719238
Epoch: 6, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.943 Vali Acc: 0.744 Test Loss: 0.943 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 1.8577377796173096
Epoch: 7, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.697 Vali Acc: 0.761 Test Loss: 0.697 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761104).  Saving model ...
Epoch: 8 cost time: 1.7646071910858154
Epoch: 8, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.780 Vali Acc: 0.756 Test Loss: 0.780 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8116281032562256
Epoch: 9, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.818 Vali Acc: 0.767 Test Loss: 0.818 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766658).  Saving model ...
Epoch: 10 cost time: 1.7048139572143555
Epoch: 10, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.972 Vali Acc: 0.744 Test Loss: 0.972 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7047417163848877
Epoch: 11, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.942 Vali Acc: 0.789 Test Loss: 0.942 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788879).  Saving model ...
Epoch: 12 cost time: 1.6144130229949951
Epoch: 12, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.925 Vali Acc: 0.772 Test Loss: 0.925 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5711138248443604
Epoch: 13, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.147 Vali Acc: 0.767 Test Loss: 1.147 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.851106882095337
Epoch: 14, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.139 Vali Acc: 0.761 Test Loss: 1.139 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8874166011810303
Epoch: 15, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.263 Vali Acc: 0.778 Test Loss: 1.263 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.871980905532837
Epoch: 16, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.215 Vali Acc: 0.767 Test Loss: 1.215 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7747995853424072
Epoch: 17, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.165 Vali Acc: 0.772 Test Loss: 1.165 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8587620258331299
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.562 Vali Acc: 0.744 Test Loss: 1.562 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9019029140472412
Epoch: 19, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.474 Vali Acc: 0.739 Test Loss: 1.474 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8197405338287354
Epoch: 20, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.277 Vali Acc: 0.761 Test Loss: 1.277 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.83984375
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.744 Test Loss: 1.486 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 339910
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3935091495513916
Epoch: 1, Steps: 12 | Train Loss: 1.660 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 1.809452772140503
Epoch: 2, Steps: 12 | Train Loss: 0.885 Vali Loss: 0.855 Vali Acc: 0.628 Test Loss: 0.855 Test Acc: 0.628
Validation loss decreased (-0.533322 --> -0.627769).  Saving model ...
Epoch: 3 cost time: 1.7568340301513672
Epoch: 3, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.712 Vali Acc: 0.717 Test Loss: 0.712 Test Acc: 0.717
Validation loss decreased (-0.627769 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 1.8118939399719238
Epoch: 4, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.747 Vali Acc: 0.711 Test Loss: 0.747 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.796926498413086
Epoch: 5, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.727 Vali Acc: 0.717 Test Loss: 0.727 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8056960105895996
Epoch: 6, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.828 Vali Acc: 0.756 Test Loss: 0.828 Test Acc: 0.756
Validation loss decreased (-0.716660 --> -0.755547).  Saving model ...
Epoch: 7 cost time: 1.6481680870056152
Epoch: 7, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.938 Vali Acc: 0.728 Test Loss: 0.938 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6980984210968018
Epoch: 8, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.049 Vali Acc: 0.767 Test Loss: 1.049 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766656).  Saving model ...
Epoch: 9 cost time: 1.6322166919708252
Epoch: 9, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.869 Vali Acc: 0.767 Test Loss: 0.869 Test Acc: 0.767
Validation loss decreased (-0.766656 --> -0.766658).  Saving model ...
Epoch: 10 cost time: 1.6517250537872314
Epoch: 10, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.927 Vali Acc: 0.744 Test Loss: 0.927 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5934398174285889
Epoch: 11, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.986 Vali Acc: 0.761 Test Loss: 0.986 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7478046417236328
Epoch: 12, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.016 Vali Acc: 0.750 Test Loss: 1.016 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7094898223876953
Epoch: 13, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.980 Vali Acc: 0.778 Test Loss: 0.980 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777768).  Saving model ...
Epoch: 14 cost time: 1.8037199974060059
Epoch: 14, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.980 Vali Acc: 0.761 Test Loss: 0.980 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7520644664764404
Epoch: 15, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.767 Test Loss: 0.985 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6930701732635498
Epoch: 16, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.998 Vali Acc: 0.778 Test Loss: 0.998 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5327916145324707
Epoch: 17, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.767 Test Loss: 1.002 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5097887516021729
Epoch: 18, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.778 Test Loss: 1.001 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4404268264770508
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.772 Test Loss: 0.995 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7213175296783447
Epoch: 20, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.783 Test Loss: 1.000 Test Acc: 0.783
Validation loss decreased (-0.777768 --> -0.783323).  Saving model ...
Epoch: 21 cost time: 1.818988561630249
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.783 Test Loss: 1.003 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8173766136169434
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.778 Test Loss: 1.003 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.778104543685913
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.783 Test Loss: 1.020 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.840665340423584
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.772 Test Loss: 1.034 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8386619091033936
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.772 Test Loss: 1.042 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6081926822662354
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.783 Test Loss: 1.046 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8467278480529785
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.783 Test Loss: 1.044 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6089820861816406
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.778 Test Loss: 1.044 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4723730087280273
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.783 Test Loss: 1.033 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.562157154083252
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.778 Test Loss: 1.044 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 330758
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4957289695739746
Epoch: 1, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.298 Vali Acc: 0.472 Test Loss: 1.298 Test Acc: 0.472
Validation loss decreased (inf --> -0.472209).  Saving model ...
Epoch: 2 cost time: 1.856053113937378
Epoch: 2, Steps: 12 | Train Loss: 1.014 Vali Loss: 0.967 Vali Acc: 0.589 Test Loss: 0.967 Test Acc: 0.589
Validation loss decreased (-0.472209 --> -0.588879).  Saving model ...
Epoch: 3 cost time: 1.7351772785186768
Epoch: 3, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.701 Vali Acc: 0.706 Test Loss: 0.701 Test Acc: 0.706
Validation loss decreased (-0.588879 --> -0.705549).  Saving model ...
Epoch: 4 cost time: 1.9191391468048096
Epoch: 4, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.708 Vali Acc: 0.739 Test Loss: 0.708 Test Acc: 0.739
Validation loss decreased (-0.705549 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 1.9430716037750244
Epoch: 5, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.609 Vali Acc: 0.728 Test Loss: 0.609 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9198739528656006
Epoch: 6, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.687 Vali Acc: 0.750 Test Loss: 0.687 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 1.6917321681976318
Epoch: 7, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.680 Vali Acc: 0.733 Test Loss: 0.680 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7235713005065918
Epoch: 8, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.891 Vali Acc: 0.744 Test Loss: 0.891 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.687837839126587
Epoch: 9, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.772 Vali Acc: 0.733 Test Loss: 0.772 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6563324928283691
Epoch: 10, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.732 Vali Acc: 0.750 Test Loss: 0.732 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8508760929107666
Epoch: 11, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.895 Vali Acc: 0.761 Test Loss: 0.895 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761102).  Saving model ...
Epoch: 12 cost time: 1.7086560726165771
Epoch: 12, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.895 Vali Acc: 0.772 Test Loss: 0.895 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772213).  Saving model ...
Epoch: 13 cost time: 1.8026933670043945
Epoch: 13, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.912 Vali Acc: 0.750 Test Loss: 0.912 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7239174842834473
Epoch: 14, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.941 Vali Acc: 0.761 Test Loss: 0.941 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9049718379974365
Epoch: 15, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.992 Vali Acc: 0.744 Test Loss: 0.992 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.092524528503418
Epoch: 16, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.989 Vali Acc: 0.767 Test Loss: 0.989 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9584648609161377
Epoch: 17, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.004 Vali Acc: 0.767 Test Loss: 1.004 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9873361587524414
Epoch: 18, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.007 Vali Acc: 0.756 Test Loss: 1.007 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8328604698181152
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.981 Vali Acc: 0.756 Test Loss: 0.981 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7621819972991943
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.976 Vali Acc: 0.761 Test Loss: 0.976 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7756903171539307
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.978 Vali Acc: 0.767 Test Loss: 0.978 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8107736110687256
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.999 Vali Acc: 0.761 Test Loss: 0.999 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 257158
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.183992862701416
Epoch: 1, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.286 Vali Acc: 0.550 Test Loss: 1.286 Test Acc: 0.550
Validation loss decreased (inf --> -0.549987).  Saving model ...
Epoch: 2 cost time: 1.769744634628296
Epoch: 2, Steps: 12 | Train Loss: 1.092 Vali Loss: 0.864 Vali Acc: 0.633 Test Loss: 0.864 Test Acc: 0.633
Validation loss decreased (-0.549987 --> -0.633325).  Saving model ...
Epoch: 3 cost time: 1.701831340789795
Epoch: 3, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.733 Vali Acc: 0.706 Test Loss: 0.733 Test Acc: 0.706
Validation loss decreased (-0.633325 --> -0.705548).  Saving model ...
Epoch: 4 cost time: 1.7381134033203125
Epoch: 4, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.623 Vali Acc: 0.744 Test Loss: 0.623 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744438).  Saving model ...
Epoch: 5 cost time: 1.4987061023712158
Epoch: 5, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.604 Vali Acc: 0.739 Test Loss: 0.604 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3906667232513428
Epoch: 6, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.617 Vali Acc: 0.756 Test Loss: 0.617 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 7 cost time: 1.5188000202178955
Epoch: 7, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.567 Vali Acc: 0.767 Test Loss: 0.567 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 1.6560847759246826
Epoch: 8, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7117562294006348
Epoch: 9, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.681 Vali Acc: 0.761 Test Loss: 0.681 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6815218925476074
Epoch: 10, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.660 Vali Acc: 0.772 Test Loss: 0.660 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 11 cost time: 1.4571585655212402
Epoch: 11, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.681 Vali Acc: 0.783 Test Loss: 0.681 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783327).  Saving model ...
Epoch: 12 cost time: 1.51395845413208
Epoch: 12, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.777 Vali Acc: 0.767 Test Loss: 0.777 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1956982612609863
Epoch: 13, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.834 Vali Acc: 0.789 Test Loss: 0.834 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788881).  Saving model ...
Epoch: 14 cost time: 1.48637056350708
Epoch: 14, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.782 Vali Acc: 0.761 Test Loss: 0.782 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6322426795959473
Epoch: 15, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.816 Vali Acc: 0.761 Test Loss: 0.816 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2408483028411865
Epoch: 16, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.861 Vali Acc: 0.761 Test Loss: 0.861 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6414153575897217
Epoch: 17, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.857 Vali Acc: 0.778 Test Loss: 0.857 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5658295154571533
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.916 Vali Acc: 0.744 Test Loss: 0.916 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.397352695465088
Epoch: 19, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.920 Vali Acc: 0.767 Test Loss: 0.920 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2523789405822754
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.922 Vali Acc: 0.761 Test Loss: 0.922 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3700926303863525
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.916 Vali Acc: 0.767 Test Loss: 0.916 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4571969509124756
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.906 Vali Acc: 0.778 Test Loss: 0.906 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.396265983581543
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.914 Vali Acc: 0.772 Test Loss: 0.914 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 211206
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8037221431732178
Epoch: 1, Steps: 12 | Train Loss: 1.826 Vali Loss: 1.453 Vali Acc: 0.506 Test Loss: 1.453 Test Acc: 0.506
Validation loss decreased (inf --> -0.505541).  Saving model ...
Epoch: 2 cost time: 1.3496198654174805
Epoch: 2, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.029 Vali Acc: 0.650 Test Loss: 1.029 Test Acc: 0.650
Validation loss decreased (-0.505541 --> -0.649990).  Saving model ...
Epoch: 3 cost time: 1.2922358512878418
Epoch: 3, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.893 Vali Acc: 0.628 Test Loss: 0.893 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1251325607299805
Epoch: 4, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.735 Vali Acc: 0.717 Test Loss: 0.735 Test Acc: 0.717
Validation loss decreased (-0.649990 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 1.190772294998169
Epoch: 5, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.675 Vali Acc: 0.717 Test Loss: 0.675 Test Acc: 0.717
Validation loss decreased (-0.716659 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 1.0922863483428955
Epoch: 6, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.699 Vali Acc: 0.733 Test Loss: 0.699 Test Acc: 0.733
Validation loss decreased (-0.716660 --> -0.733326).  Saving model ...
Epoch: 7 cost time: 1.4845476150512695
Epoch: 7, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.702 Vali Acc: 0.717 Test Loss: 0.702 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2957208156585693
Epoch: 8, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.660 Vali Acc: 0.733 Test Loss: 0.660 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 1.279125690460205
Epoch: 9, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.734 Vali Acc: 0.717 Test Loss: 0.734 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.401475191116333
Epoch: 10, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.760 Vali Acc: 0.717 Test Loss: 0.760 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1268055438995361
Epoch: 11, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.734 Vali Acc: 0.750 Test Loss: 0.734 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.3402719497680664
Epoch: 12, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.885 Vali Acc: 0.717 Test Loss: 0.885 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3683488368988037
Epoch: 13, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.811 Vali Acc: 0.711 Test Loss: 0.811 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2928824424743652
Epoch: 14, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.794 Vali Acc: 0.733 Test Loss: 0.794 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.327284336090088
Epoch: 15, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.825 Vali Acc: 0.717 Test Loss: 0.825 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.221280813217163
Epoch: 16, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.827 Vali Acc: 0.722 Test Loss: 0.827 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2345919609069824
Epoch: 17, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.861 Vali Acc: 0.744 Test Loss: 0.861 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3636655807495117
Epoch: 18, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.886 Vali Acc: 0.717 Test Loss: 0.886 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4374127388000488
Epoch: 19, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.901 Vali Acc: 0.728 Test Loss: 0.901 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5719168186187744
Epoch: 20, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.890 Vali Acc: 0.728 Test Loss: 0.890 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.45438814163208
Epoch: 21, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.928 Vali Acc: 0.706 Test Loss: 0.928 Test Acc: 0.706
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.75
model parameter : 174534
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8518574237823486
Epoch: 1, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.538 Vali Acc: 0.422 Test Loss: 1.538 Test Acc: 0.422
Validation loss decreased (inf --> -0.422207).  Saving model ...
Epoch: 2 cost time: 1.406374216079712
Epoch: 2, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.073 Vali Acc: 0.589 Test Loss: 1.073 Test Acc: 0.589
Validation loss decreased (-0.422207 --> -0.588878).  Saving model ...
Epoch: 3 cost time: 1.372870683670044
Epoch: 3, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.892 Vali Acc: 0.650 Test Loss: 0.892 Test Acc: 0.650
Validation loss decreased (-0.588878 --> -0.649991).  Saving model ...
Epoch: 4 cost time: 1.4138989448547363
Epoch: 4, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.741 Vali Acc: 0.689 Test Loss: 0.741 Test Acc: 0.689
Validation loss decreased (-0.649991 --> -0.688881).  Saving model ...
Epoch: 5 cost time: 1.3509626388549805
Epoch: 5, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.690 Vali Acc: 0.722 Test Loss: 0.690 Test Acc: 0.722
Validation loss decreased (-0.688881 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 1.1779811382293701
Epoch: 6, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.619 Vali Acc: 0.761 Test Loss: 0.619 Test Acc: 0.761
Validation loss decreased (-0.722215 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 1.3802852630615234
Epoch: 7, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.658 Vali Acc: 0.733 Test Loss: 0.658 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4335432052612305
Epoch: 8, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.673 Vali Acc: 0.756 Test Loss: 0.673 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3382420539855957
Epoch: 9, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3192193508148193
Epoch: 10, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.756 Vali Acc: 0.733 Test Loss: 0.756 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4535222053527832
Epoch: 11, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.863 Vali Acc: 0.722 Test Loss: 0.863 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4519219398498535
Epoch: 12, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4631919860839844
Epoch: 13, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.687 Vali Acc: 0.767 Test Loss: 0.687 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 14 cost time: 1.414731502532959
Epoch: 14, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.708 Vali Acc: 0.772 Test Loss: 0.708 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772215).  Saving model ...
Epoch: 15 cost time: 1.455495834350586
Epoch: 15, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.828 Vali Acc: 0.761 Test Loss: 0.828 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3135488033294678
Epoch: 16, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.832 Vali Acc: 0.767 Test Loss: 0.832 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4043779373168945
Epoch: 17, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.785 Vali Acc: 0.756 Test Loss: 0.785 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.340266227722168
Epoch: 18, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.868 Vali Acc: 0.744 Test Loss: 0.868 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3224513530731201
Epoch: 19, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.825 Vali Acc: 0.761 Test Loss: 0.825 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3876268863677979
Epoch: 20, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.787 Vali Acc: 0.756 Test Loss: 0.787 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.277360200881958
Epoch: 21, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.814 Vali Acc: 0.772 Test Loss: 0.814 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5206286907196045
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.826 Vali Acc: 0.783 Test Loss: 0.826 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783325).  Saving model ...
Epoch: 23 cost time: 1.413215160369873
Epoch: 23, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.843 Vali Acc: 0.761 Test Loss: 0.843 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3646612167358398
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.833 Vali Acc: 0.772 Test Loss: 0.833 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.398618221282959
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.860 Vali Acc: 0.778 Test Loss: 0.860 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.365968942642212
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.865 Vali Acc: 0.772 Test Loss: 0.865 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4648878574371338
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.849 Vali Acc: 0.772 Test Loss: 0.849 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.676781177520752
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.879 Vali Acc: 0.778 Test Loss: 0.879 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.475205898284912
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.878 Vali Acc: 0.778 Test Loss: 0.878 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3173913955688477
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.902 Vali Acc: 0.756 Test Loss: 0.902 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4636192321777344
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.893 Vali Acc: 0.761 Test Loss: 0.893 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3815484046936035
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.914 Vali Acc: 0.767 Test Loss: 0.914 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 165446
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4541447162628174
Epoch: 1, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.036 Vali Acc: 0.567 Test Loss: 1.036 Test Acc: 0.567
Validation loss decreased (inf --> -0.566656).  Saving model ...
Epoch: 2 cost time: 1.6545403003692627
Epoch: 2, Steps: 12 | Train Loss: 0.905 Vali Loss: 0.697 Vali Acc: 0.711 Test Loss: 0.697 Test Acc: 0.711
Validation loss decreased (-0.566656 --> -0.711104).  Saving model ...
Epoch: 3 cost time: 1.6716291904449463
Epoch: 3, Steps: 12 | Train Loss: 0.496 Vali Loss: 1.684 Vali Acc: 0.644 Test Loss: 1.684 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6551151275634766
Epoch: 4, Steps: 12 | Train Loss: 0.825 Vali Loss: 1.006 Vali Acc: 0.706 Test Loss: 1.006 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8171775341033936
Epoch: 5, Steps: 12 | Train Loss: 0.392 Vali Loss: 1.226 Vali Acc: 0.683 Test Loss: 1.226 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7754647731781006
Epoch: 6, Steps: 12 | Train Loss: 0.221 Vali Loss: 1.262 Vali Acc: 0.728 Test Loss: 1.262 Test Acc: 0.728
Validation loss decreased (-0.711104 --> -0.727765).  Saving model ...
Epoch: 7 cost time: 1.705176591873169
Epoch: 7, Steps: 12 | Train Loss: 0.223 Vali Loss: 1.582 Vali Acc: 0.717 Test Loss: 1.582 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.707063913345337
Epoch: 8, Steps: 12 | Train Loss: 0.241 Vali Loss: 1.783 Vali Acc: 0.706 Test Loss: 1.783 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8342468738555908
Epoch: 9, Steps: 12 | Train Loss: 0.371 Vali Loss: 1.941 Vali Acc: 0.683 Test Loss: 1.941 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8128936290740967
Epoch: 10, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.455 Vali Acc: 0.756 Test Loss: 1.455 Test Acc: 0.756
Validation loss decreased (-0.727765 --> -0.755541).  Saving model ...
Epoch: 11 cost time: 1.8022642135620117
Epoch: 11, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.194 Vali Acc: 0.744 Test Loss: 1.194 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6804583072662354
Epoch: 12, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.617 Vali Acc: 0.744 Test Loss: 1.617 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8039829730987549
Epoch: 13, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.658 Vali Acc: 0.756 Test Loss: 1.658 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8272416591644287
Epoch: 14, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.851 Vali Acc: 0.744 Test Loss: 1.851 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8890442848205566
Epoch: 15, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.750 Vali Acc: 0.722 Test Loss: 1.750 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8169357776641846
Epoch: 16, Steps: 12 | Train Loss: 0.007 Vali Loss: 2.494 Vali Acc: 0.706 Test Loss: 2.494 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7852206230163574
Epoch: 17, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.980 Vali Acc: 0.744 Test Loss: 1.980 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.809837818145752
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 2.056 Vali Acc: 0.772 Test Loss: 2.056 Test Acc: 0.772
Validation loss decreased (-0.755541 --> -0.772202).  Saving model ...
Epoch: 19 cost time: 1.804896354675293
Epoch: 19, Steps: 12 | Train Loss: 0.016 Vali Loss: 2.117 Vali Acc: 0.783 Test Loss: 2.117 Test Acc: 0.783
Validation loss decreased (-0.772202 --> -0.783312).  Saving model ...
Epoch: 20 cost time: 1.6892881393432617
Epoch: 20, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.982 Vali Acc: 0.772 Test Loss: 1.982 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8790347576141357
Epoch: 21, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.789 Vali Acc: 0.772 Test Loss: 1.789 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8695638179779053
Epoch: 22, Steps: 12 | Train Loss: 0.005 Vali Loss: 2.675 Vali Acc: 0.739 Test Loss: 2.675 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.850980281829834
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 2.558 Vali Acc: 0.739 Test Loss: 2.558 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7877132892608643
Epoch: 24, Steps: 12 | Train Loss: 0.331 Vali Loss: 2.992 Vali Acc: 0.711 Test Loss: 2.992 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7966697216033936
Epoch: 25, Steps: 12 | Train Loss: 0.130 Vali Loss: 6.311 Vali Acc: 0.667 Test Loss: 6.311 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8766632080078125
Epoch: 26, Steps: 12 | Train Loss: 0.568 Vali Loss: 4.338 Vali Acc: 0.678 Test Loss: 4.338 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9599249362945557
Epoch: 27, Steps: 12 | Train Loss: 0.274 Vali Loss: 3.970 Vali Acc: 0.756 Test Loss: 3.970 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8898651599884033
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 3.626 Vali Acc: 0.761 Test Loss: 3.626 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8727338314056396
Epoch: 29, Steps: 12 | Train Loss: 0.042 Vali Loss: 3.350 Vali Acc: 0.739 Test Loss: 3.350 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 537222
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8358547687530518
Epoch: 1, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.156 Vali Acc: 0.556 Test Loss: 1.156 Test Acc: 0.556
Validation loss decreased (inf --> -0.555544).  Saving model ...
Epoch: 2 cost time: 1.4281160831451416
Epoch: 2, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.818 Vali Acc: 0.656 Test Loss: 0.818 Test Acc: 0.656
Validation loss decreased (-0.555544 --> -0.655547).  Saving model ...
Epoch: 3 cost time: 1.4882218837738037
Epoch: 3, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.649 Vali Acc: 0.744 Test Loss: 0.649 Test Acc: 0.744
Validation loss decreased (-0.655547 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 1.5377986431121826
Epoch: 4, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.614 Vali Acc: 0.744 Test Loss: 0.614 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 5 cost time: 1.499523639678955
Epoch: 5, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.851 Vali Acc: 0.700 Test Loss: 0.851 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4013054370880127
Epoch: 6, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.662 Vali Acc: 0.744 Test Loss: 0.662 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.431274175643921
Epoch: 7, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.769 Vali Acc: 0.728 Test Loss: 0.769 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.466010332107544
Epoch: 8, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.841 Vali Acc: 0.761 Test Loss: 0.841 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 1.4560821056365967
Epoch: 9, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.009 Vali Acc: 0.750 Test Loss: 1.009 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4001948833465576
Epoch: 10, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.044 Vali Acc: 0.744 Test Loss: 1.044 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.471062183380127
Epoch: 11, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.054 Vali Acc: 0.744 Test Loss: 1.054 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4736347198486328
Epoch: 12, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.013 Vali Acc: 0.739 Test Loss: 1.013 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.560060739517212
Epoch: 13, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.033 Vali Acc: 0.772 Test Loss: 1.033 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772212).  Saving model ...
Epoch: 14 cost time: 1.5078542232513428
Epoch: 14, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.219 Vali Acc: 0.744 Test Loss: 1.219 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.547018051147461
Epoch: 15, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.043 Vali Acc: 0.783 Test Loss: 1.043 Test Acc: 0.783
Validation loss decreased (-0.772212 --> -0.783323).  Saving model ...
Epoch: 16 cost time: 1.4158353805541992
Epoch: 16, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.933 Vali Acc: 0.789 Test Loss: 0.933 Test Acc: 0.789
Validation loss decreased (-0.783323 --> -0.788880).  Saving model ...
Epoch: 17 cost time: 1.371025562286377
Epoch: 17, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.149 Vali Acc: 0.756 Test Loss: 1.149 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.407362699508667
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.180 Vali Acc: 0.761 Test Loss: 1.180 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.514171838760376
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.173 Vali Acc: 0.767 Test Loss: 1.173 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5791068077087402
Epoch: 20, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.767 Test Loss: 1.183 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3333017826080322
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.170 Vali Acc: 0.772 Test Loss: 1.170 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5755600929260254
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.148 Vali Acc: 0.772 Test Loss: 1.148 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4882514476776123
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.133 Vali Acc: 0.778 Test Loss: 1.133 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4715442657470703
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.130 Vali Acc: 0.778 Test Loss: 1.130 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3746163845062256
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.126 Vali Acc: 0.778 Test Loss: 1.126 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4539985656738281
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.111 Vali Acc: 0.778 Test Loss: 1.111 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 306886
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8933589458465576
Epoch: 1, Steps: 12 | Train Loss: 1.703 Vali Loss: 1.193 Vali Acc: 0.494 Test Loss: 1.193 Test Acc: 0.494
Validation loss decreased (inf --> -0.494433).  Saving model ...
Epoch: 2 cost time: 1.4220161437988281
Epoch: 2, Steps: 12 | Train Loss: 0.887 Vali Loss: 1.087 Vali Acc: 0.606 Test Loss: 1.087 Test Acc: 0.606
Validation loss decreased (-0.494433 --> -0.605545).  Saving model ...
Epoch: 3 cost time: 1.4804484844207764
Epoch: 3, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.914 Vali Acc: 0.633 Test Loss: 0.914 Test Acc: 0.633
Validation loss decreased (-0.605545 --> -0.633324).  Saving model ...
Epoch: 4 cost time: 1.4588675498962402
Epoch: 4, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.648 Vali Acc: 0.739 Test Loss: 0.648 Test Acc: 0.739
Validation loss decreased (-0.633324 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 1.3592898845672607
Epoch: 5, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.684 Vali Acc: 0.717 Test Loss: 0.684 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4292430877685547
Epoch: 6, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.706 Vali Acc: 0.761 Test Loss: 0.706 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761104).  Saving model ...
Epoch: 7 cost time: 1.4744088649749756
Epoch: 7, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.899 Vali Acc: 0.722 Test Loss: 0.899 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3063886165618896
Epoch: 8, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.852 Vali Acc: 0.761 Test Loss: 0.852 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4463350772857666
Epoch: 9, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.802 Vali Acc: 0.761 Test Loss: 0.802 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3386387825012207
Epoch: 10, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.962 Vali Acc: 0.761 Test Loss: 0.962 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.408005714416504
Epoch: 11, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.849 Vali Acc: 0.772 Test Loss: 0.849 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772214).  Saving model ...
Epoch: 12 cost time: 1.3874690532684326
Epoch: 12, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.013 Vali Acc: 0.767 Test Loss: 1.013 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.389796495437622
Epoch: 13, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.138 Vali Acc: 0.744 Test Loss: 1.138 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4281527996063232
Epoch: 14, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.066 Vali Acc: 0.789 Test Loss: 1.066 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788878).  Saving model ...
Epoch: 15 cost time: 1.4431796073913574
Epoch: 15, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.592 Vali Acc: 0.683 Test Loss: 1.592 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5316963195800781
Epoch: 16, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.201 Vali Acc: 0.761 Test Loss: 1.201 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3411998748779297
Epoch: 17, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.110 Vali Acc: 0.744 Test Loss: 1.110 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3495824337005615
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.360 Vali Acc: 0.744 Test Loss: 1.360 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4626946449279785
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.357 Vali Acc: 0.744 Test Loss: 1.357 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3977904319763184
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.362 Vali Acc: 0.761 Test Loss: 1.362 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5167791843414307
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.767 Test Loss: 1.283 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4517014026641846
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.772 Test Loss: 1.256 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4041407108306885
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.778 Test Loss: 1.242 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3754031658172607
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.778 Test Loss: 1.239 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 297734
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0846850872039795
Epoch: 1, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.283 Vali Acc: 0.489 Test Loss: 1.283 Test Acc: 0.489
Validation loss decreased (inf --> -0.488876).  Saving model ...
Epoch: 2 cost time: 1.4467723369598389
Epoch: 2, Steps: 12 | Train Loss: 0.977 Vali Loss: 0.847 Vali Acc: 0.661 Test Loss: 0.847 Test Acc: 0.661
Validation loss decreased (-0.488876 --> -0.661103).  Saving model ...
Epoch: 3 cost time: 1.608323097229004
Epoch: 3, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.747 Vali Acc: 0.672 Test Loss: 0.747 Test Acc: 0.672
Validation loss decreased (-0.661103 --> -0.672215).  Saving model ...
Epoch: 4 cost time: 1.7809412479400635
Epoch: 4, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.643 Vali Acc: 0.733 Test Loss: 0.643 Test Acc: 0.733
Validation loss decreased (-0.672215 --> -0.733327).  Saving model ...
Epoch: 5 cost time: 1.7828853130340576
Epoch: 5, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.678 Vali Acc: 0.733 Test Loss: 0.678 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6635050773620605
Epoch: 6, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.733 Vali Acc: 0.739 Test Loss: 0.733 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738882).  Saving model ...
Epoch: 7 cost time: 1.7791388034820557
Epoch: 7, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 1.6995646953582764
Epoch: 8, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.760 Vali Acc: 0.739 Test Loss: 0.760 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6369545459747314
Epoch: 9, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.756 Vali Acc: 0.756 Test Loss: 0.756 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755548).  Saving model ...
Epoch: 10 cost time: 1.5951154232025146
Epoch: 10, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.700 Vali Acc: 0.778 Test Loss: 0.700 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777771).  Saving model ...
Epoch: 11 cost time: 1.6821088790893555
Epoch: 11, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.142 Vali Acc: 0.733 Test Loss: 1.142 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6713716983795166
Epoch: 12, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.926 Vali Acc: 0.717 Test Loss: 0.926 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6569688320159912
Epoch: 13, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.902 Vali Acc: 0.756 Test Loss: 0.902 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6041476726531982
Epoch: 14, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.975 Vali Acc: 0.733 Test Loss: 0.975 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6349852085113525
Epoch: 15, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.941 Vali Acc: 0.750 Test Loss: 0.941 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6128530502319336
Epoch: 16, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.924 Vali Acc: 0.761 Test Loss: 0.924 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7127206325531006
Epoch: 17, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.885 Vali Acc: 0.778 Test Loss: 0.885 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8835334777832031
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.789 Test Loss: 0.936 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788880).  Saving model ...
Epoch: 19 cost time: 1.8015825748443604
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.953 Vali Acc: 0.756 Test Loss: 0.953 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6374249458312988
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.935 Vali Acc: 0.778 Test Loss: 0.935 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6888515949249268
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.952 Vali Acc: 0.772 Test Loss: 0.952 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5417358875274658
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.973 Vali Acc: 0.778 Test Loss: 0.973 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8170292377471924
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.951 Vali Acc: 0.778 Test Loss: 0.951 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7445309162139893
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.783 Test Loss: 0.958 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6078882217407227
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.977 Vali Acc: 0.778 Test Loss: 0.977 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4360570907592773
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.783 Test Loss: 0.979 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5254104137420654
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.980 Vali Acc: 0.789 Test Loss: 0.980 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.460540533065796
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.778 Test Loss: 0.983 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 224134
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.053945302963257
Epoch: 1, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.431 Vali Acc: 0.478 Test Loss: 1.431 Test Acc: 0.478
Validation loss decreased (inf --> -0.477763).  Saving model ...
Epoch: 2 cost time: 1.512028694152832
Epoch: 2, Steps: 12 | Train Loss: 1.149 Vali Loss: 0.909 Vali Acc: 0.611 Test Loss: 0.909 Test Acc: 0.611
Validation loss decreased (-0.477763 --> -0.611102).  Saving model ...
Epoch: 3 cost time: 1.6129059791564941
Epoch: 3, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.755 Vali Acc: 0.694 Test Loss: 0.755 Test Acc: 0.694
Validation loss decreased (-0.611102 --> -0.694437).  Saving model ...
Epoch: 4 cost time: 1.502528190612793
Epoch: 4, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.699 Vali Acc: 0.728 Test Loss: 0.699 Test Acc: 0.728
Validation loss decreased (-0.694437 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 1.4041779041290283
Epoch: 5, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.607 Vali Acc: 0.767 Test Loss: 0.607 Test Acc: 0.767
Validation loss decreased (-0.727771 --> -0.766661).  Saving model ...
Epoch: 6 cost time: 1.457244873046875
Epoch: 6, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.688 Vali Acc: 0.733 Test Loss: 0.688 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3998205661773682
Epoch: 7, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.706 Vali Acc: 0.739 Test Loss: 0.706 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.236828327178955
Epoch: 8, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.724 Vali Acc: 0.744 Test Loss: 0.724 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2964510917663574
Epoch: 9, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.694 Vali Acc: 0.756 Test Loss: 0.694 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3771655559539795
Epoch: 10, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.760 Vali Acc: 0.739 Test Loss: 0.760 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1794230937957764
Epoch: 11, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.727 Vali Acc: 0.789 Test Loss: 0.727 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788882).  Saving model ...
Epoch: 12 cost time: 1.3255977630615234
Epoch: 12, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.478663682937622
Epoch: 13, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.813 Vali Acc: 0.756 Test Loss: 0.813 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.520552158355713
Epoch: 14, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.830 Vali Acc: 0.761 Test Loss: 0.830 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5350821018218994
Epoch: 15, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.893 Vali Acc: 0.756 Test Loss: 0.893 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2877326011657715
Epoch: 16, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.942 Vali Acc: 0.756 Test Loss: 0.942 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1766340732574463
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.965 Vali Acc: 0.744 Test Loss: 0.965 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3458781242370605
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.930 Vali Acc: 0.756 Test Loss: 0.930 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5064373016357422
Epoch: 19, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.897 Vali Acc: 0.772 Test Loss: 0.897 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5406150817871094
Epoch: 20, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.912 Vali Acc: 0.772 Test Loss: 0.912 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6107728481292725
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.920 Vali Acc: 0.783 Test Loss: 0.920 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 178182
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5949349403381348
Epoch: 1, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.458 Vali Acc: 0.433 Test Loss: 1.458 Test Acc: 0.433
Validation loss decreased (inf --> -0.433319).  Saving model ...
Epoch: 2 cost time: 1.1919941902160645
Epoch: 2, Steps: 12 | Train Loss: 1.277 Vali Loss: 1.009 Vali Acc: 0.600 Test Loss: 1.009 Test Acc: 0.600
Validation loss decreased (-0.433319 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 1.216043472290039
Epoch: 3, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.870 Vali Acc: 0.633 Test Loss: 0.870 Test Acc: 0.633
Validation loss decreased (-0.599990 --> -0.633325).  Saving model ...
Epoch: 4 cost time: 1.330418586730957
Epoch: 4, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.722 Vali Acc: 0.717 Test Loss: 0.722 Test Acc: 0.717
Validation loss decreased (-0.633325 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 1.21559476852417
Epoch: 5, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
Validation loss decreased (-0.716659 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 1.3467767238616943
Epoch: 6, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.682 Vali Acc: 0.728 Test Loss: 0.682 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 1.2614519596099854
Epoch: 7, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3192963600158691
Epoch: 8, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.643 Vali Acc: 0.739 Test Loss: 0.643 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738882).  Saving model ...
Epoch: 9 cost time: 1.1680386066436768
Epoch: 9, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.689 Vali Acc: 0.761 Test Loss: 0.689 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761104).  Saving model ...
Epoch: 10 cost time: 1.2257707118988037
Epoch: 10, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.674 Vali Acc: 0.722 Test Loss: 0.674 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2095813751220703
Epoch: 11, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.720 Vali Acc: 0.744 Test Loss: 0.720 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1745574474334717
Epoch: 12, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.682 Vali Acc: 0.739 Test Loss: 0.682 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9491968154907227
Epoch: 13, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.844 Vali Acc: 0.728 Test Loss: 0.844 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3149101734161377
Epoch: 14, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.899 Vali Acc: 0.756 Test Loss: 0.899 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3066380023956299
Epoch: 15, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.954 Vali Acc: 0.717 Test Loss: 0.954 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3036916255950928
Epoch: 16, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.885 Vali Acc: 0.761 Test Loss: 0.885 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2405445575714111
Epoch: 17, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.859 Vali Acc: 0.728 Test Loss: 0.859 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3504502773284912
Epoch: 18, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.893 Vali Acc: 0.711 Test Loss: 0.893 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6652491092681885
Epoch: 19, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.876 Vali Acc: 0.756 Test Loss: 0.876 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 141510
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1910932064056396
Epoch: 1, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.504 Vali Acc: 0.394 Test Loss: 1.504 Test Acc: 0.394
Validation loss decreased (inf --> -0.394429).  Saving model ...
Epoch: 2 cost time: 1.397066593170166
Epoch: 2, Steps: 12 | Train Loss: 1.209 Vali Loss: 1.069 Vali Acc: 0.589 Test Loss: 1.069 Test Acc: 0.589
Validation loss decreased (-0.394429 --> -0.588878).  Saving model ...
Epoch: 3 cost time: 1.517582893371582
Epoch: 3, Steps: 12 | Train Loss: 0.872 Vali Loss: 0.864 Vali Acc: 0.628 Test Loss: 0.864 Test Acc: 0.628
Validation loss decreased (-0.588878 --> -0.627769).  Saving model ...
Epoch: 4 cost time: 1.523045539855957
Epoch: 4, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.732 Vali Acc: 0.706 Test Loss: 0.732 Test Acc: 0.706
Validation loss decreased (-0.627769 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 1.4845092296600342
Epoch: 5, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
Validation loss decreased (-0.705548 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 1.4774866104125977
Epoch: 6, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.685 Vali Acc: 0.739 Test Loss: 0.685 Test Acc: 0.739
Validation loss decreased (-0.716660 --> -0.738882).  Saving model ...
Epoch: 7 cost time: 1.5218822956085205
Epoch: 7, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.614 Vali Acc: 0.756 Test Loss: 0.614 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 8 cost time: 1.450652837753296
Epoch: 8, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.593 Vali Acc: 0.761 Test Loss: 0.593 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 1.4572265148162842
Epoch: 9, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.687 Vali Acc: 0.733 Test Loss: 0.687 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4329032897949219
Epoch: 10, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.565 Vali Acc: 0.772 Test Loss: 0.565 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772217).  Saving model ...
Epoch: 11 cost time: 1.3734207153320312
Epoch: 11, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.633 Vali Acc: 0.756 Test Loss: 0.633 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3928887844085693
Epoch: 12, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.632 Vali Acc: 0.739 Test Loss: 0.632 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5490329265594482
Epoch: 13, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.614 Vali Acc: 0.772 Test Loss: 0.614 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.561917781829834
Epoch: 14, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.712 Vali Acc: 0.761 Test Loss: 0.712 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4691224098205566
Epoch: 15, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.719 Vali Acc: 0.756 Test Loss: 0.719 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.595510721206665
Epoch: 16, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.674 Vali Acc: 0.767 Test Loss: 0.674 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.546060562133789
Epoch: 17, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.724 Vali Acc: 0.750 Test Loss: 0.724 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4201359748840332
Epoch: 18, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.771 Vali Acc: 0.767 Test Loss: 0.771 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.514045000076294
Epoch: 19, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.757 Vali Acc: 0.756 Test Loss: 0.757 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.571946382522583
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.785 Vali Acc: 0.744 Test Loss: 0.785 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 132422
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6481223106384277
Epoch: 1, Steps: 12 | Train Loss: 1.537 Vali Loss: 0.982 Vali Acc: 0.567 Test Loss: 0.982 Test Acc: 0.567
Validation loss decreased (inf --> -0.566657).  Saving model ...
Epoch: 2 cost time: 1.760768175125122
Epoch: 2, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.810 Vali Acc: 0.689 Test Loss: 0.810 Test Acc: 0.689
Validation loss decreased (-0.566657 --> -0.688881).  Saving model ...
Epoch: 3 cost time: 1.9664640426635742
Epoch: 3, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.781 Vali Acc: 0.689 Test Loss: 0.781 Test Acc: 0.689
Validation loss decreased (-0.688881 --> -0.688881).  Saving model ...
Epoch: 4 cost time: 2.390789270401001
Epoch: 4, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.910 Vali Acc: 0.706 Test Loss: 0.910 Test Acc: 0.706
Validation loss decreased (-0.688881 --> -0.705546).  Saving model ...
Epoch: 5 cost time: 2.353626251220703
Epoch: 5, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.951 Vali Acc: 0.722 Test Loss: 0.951 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 6 cost time: 2.2632949352264404
Epoch: 6, Steps: 12 | Train Loss: 0.206 Vali Loss: 1.504 Vali Acc: 0.706 Test Loss: 1.504 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1993870735168457
Epoch: 7, Steps: 12 | Train Loss: 0.235 Vali Loss: 1.072 Vali Acc: 0.750 Test Loss: 1.072 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749989).  Saving model ...
Epoch: 8 cost time: 2.156024932861328
Epoch: 8, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.049 Vali Acc: 0.783 Test Loss: 1.049 Test Acc: 0.783
Validation loss decreased (-0.749989 --> -0.783323).  Saving model ...
Epoch: 9 cost time: 2.291872978210449
Epoch: 9, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.178 Vali Acc: 0.756 Test Loss: 1.178 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.167832374572754
Epoch: 10, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.289 Vali Acc: 0.767 Test Loss: 1.289 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.074913263320923
Epoch: 11, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.315 Vali Acc: 0.750 Test Loss: 1.315 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1105611324310303
Epoch: 12, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.246 Vali Acc: 0.778 Test Loss: 1.246 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2259726524353027
Epoch: 13, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.937 Vali Acc: 0.717 Test Loss: 1.937 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3456356525421143
Epoch: 14, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.844 Vali Acc: 0.711 Test Loss: 1.844 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.323948383331299
Epoch: 15, Steps: 12 | Train Loss: 0.105 Vali Loss: 2.014 Vali Acc: 0.744 Test Loss: 2.014 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.244755983352661
Epoch: 16, Steps: 12 | Train Loss: 0.208 Vali Loss: 2.135 Vali Acc: 0.683 Test Loss: 2.135 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.128087043762207
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 2.792 Vali Acc: 0.706 Test Loss: 2.792 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3469886779785156
Epoch: 18, Steps: 12 | Train Loss: 0.173 Vali Loss: 1.966 Vali Acc: 0.761 Test Loss: 1.966 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 520710
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3364381790161133
Epoch: 1, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.222 Vali Acc: 0.533 Test Loss: 1.222 Test Acc: 0.533
Validation loss decreased (inf --> -0.533321).  Saving model ...
Epoch: 2 cost time: 1.9322402477264404
Epoch: 2, Steps: 12 | Train Loss: 0.957 Vali Loss: 0.995 Vali Acc: 0.606 Test Loss: 0.995 Test Acc: 0.606
Validation loss decreased (-0.533321 --> -0.605546).  Saving model ...
Epoch: 3 cost time: 1.93220853805542
Epoch: 3, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.721 Vali Acc: 0.694 Test Loss: 0.721 Test Acc: 0.694
Validation loss decreased (-0.605546 --> -0.694437).  Saving model ...
Epoch: 4 cost time: 1.9788918495178223
Epoch: 4, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.818 Vali Acc: 0.711 Test Loss: 0.818 Test Acc: 0.711
Validation loss decreased (-0.694437 --> -0.711103).  Saving model ...
Epoch: 5 cost time: 1.9455511569976807
Epoch: 5, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.629 Vali Acc: 0.750 Test Loss: 0.629 Test Acc: 0.750
Validation loss decreased (-0.711103 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 1.9829168319702148
Epoch: 6, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.847 Vali Acc: 0.722 Test Loss: 0.847 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8097598552703857
Epoch: 7, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.762 Vali Acc: 0.744 Test Loss: 0.762 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9216957092285156
Epoch: 8, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.684 Vali Acc: 0.783 Test Loss: 0.684 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783326).  Saving model ...
Epoch: 9 cost time: 1.8938827514648438
Epoch: 9, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.388 Vali Acc: 0.722 Test Loss: 1.388 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0283501148223877
Epoch: 10, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.975 Vali Acc: 0.761 Test Loss: 0.975 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9935526847839355
Epoch: 11, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.123 Vali Acc: 0.756 Test Loss: 1.123 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9850244522094727
Epoch: 12, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.195 Vali Acc: 0.733 Test Loss: 1.195 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.01118803024292
Epoch: 13, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.486 Vali Acc: 0.711 Test Loss: 1.486 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.009737253189087
Epoch: 14, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.103 Vali Acc: 0.767 Test Loss: 1.103 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9604437351226807
Epoch: 15, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.279 Vali Acc: 0.761 Test Loss: 1.279 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9847168922424316
Epoch: 16, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.351 Vali Acc: 0.728 Test Loss: 1.351 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9433565139770508
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.277 Vali Acc: 0.756 Test Loss: 1.277 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.841329574584961
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.304 Vali Acc: 0.772 Test Loss: 1.304 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 290374
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4328248500823975
Epoch: 1, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.258 Vali Acc: 0.478 Test Loss: 1.258 Test Acc: 0.478
Validation loss decreased (inf --> -0.477765).  Saving model ...
Epoch: 2 cost time: 1.7227940559387207
Epoch: 2, Steps: 12 | Train Loss: 0.879 Vali Loss: 0.922 Vali Acc: 0.633 Test Loss: 0.922 Test Acc: 0.633
Validation loss decreased (-0.477765 --> -0.633324).  Saving model ...
Epoch: 3 cost time: 1.7371466159820557
Epoch: 3, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.606 Vali Acc: 0.744 Test Loss: 0.606 Test Acc: 0.744
Validation loss decreased (-0.633324 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 1.8490793704986572
Epoch: 4, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.704 Vali Acc: 0.722 Test Loss: 0.704 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.905992031097412
Epoch: 5, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.707 Vali Acc: 0.733 Test Loss: 0.707 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.940887689590454
Epoch: 6, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.773 Vali Acc: 0.733 Test Loss: 0.773 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8668396472930908
Epoch: 7, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.815 Vali Acc: 0.739 Test Loss: 0.815 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.837404727935791
Epoch: 8, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.002 Vali Acc: 0.733 Test Loss: 1.002 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7805509567260742
Epoch: 9, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.895 Vali Acc: 0.756 Test Loss: 0.895 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 1.8319339752197266
Epoch: 10, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.007 Vali Acc: 0.722 Test Loss: 1.007 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8650243282318115
Epoch: 11, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.962 Vali Acc: 0.783 Test Loss: 0.962 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783324).  Saving model ...
Epoch: 12 cost time: 2.0668821334838867
Epoch: 12, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.058 Vali Acc: 0.761 Test Loss: 1.058 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9427399635314941
Epoch: 13, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.966 Vali Acc: 0.767 Test Loss: 0.966 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9333815574645996
Epoch: 14, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.915 Vali Acc: 0.778 Test Loss: 0.915 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.963440179824829
Epoch: 15, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.900 Vali Acc: 0.778 Test Loss: 0.900 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8133115768432617
Epoch: 16, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.772 Test Loss: 0.991 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.902608871459961
Epoch: 17, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.934 Vali Acc: 0.789 Test Loss: 0.934 Test Acc: 0.789
Validation loss decreased (-0.783324 --> -0.788880).  Saving model ...
Epoch: 18 cost time: 1.7781405448913574
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.952 Vali Acc: 0.778 Test Loss: 0.952 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8838753700256348
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.772 Test Loss: 0.979 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8615882396697998
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.999 Vali Acc: 0.783 Test Loss: 0.999 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.844925880432129
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.966 Vali Acc: 0.778 Test Loss: 0.966 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9490926265716553
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.767 Test Loss: 1.006 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8735136985778809
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.772 Test Loss: 1.012 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.748368740081787
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.789 Test Loss: 0.997 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9094977378845215
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.778 Test Loss: 0.995 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8958189487457275
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.992 Vali Acc: 0.772 Test Loss: 0.992 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8667314052581787
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.761 Test Loss: 1.038 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 281222
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.089047431945801
Epoch: 1, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.273 Vali Acc: 0.572 Test Loss: 1.273 Test Acc: 0.572
Validation loss decreased (inf --> -0.572209).  Saving model ...
Epoch: 2 cost time: 1.6732373237609863
Epoch: 2, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.904 Vali Acc: 0.622 Test Loss: 0.904 Test Acc: 0.622
Validation loss decreased (-0.572209 --> -0.622213).  Saving model ...
Epoch: 3 cost time: 1.784102439880371
Epoch: 3, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.684 Vali Acc: 0.728 Test Loss: 0.684 Test Acc: 0.728
Validation loss decreased (-0.622213 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 1.7044873237609863
Epoch: 4, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.680 Vali Acc: 0.706 Test Loss: 0.680 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7484784126281738
Epoch: 5, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.746 Vali Acc: 0.744 Test Loss: 0.746 Test Acc: 0.744
Validation loss decreased (-0.727771 --> -0.744437).  Saving model ...
Epoch: 6 cost time: 1.8079330921173096
Epoch: 6, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.726 Vali Acc: 0.750 Test Loss: 0.726 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 1.7865991592407227
Epoch: 7, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.666 Vali Acc: 0.761 Test Loss: 0.666 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761104).  Saving model ...
Epoch: 8 cost time: 1.7723939418792725
Epoch: 8, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.663 Vali Acc: 0.756 Test Loss: 0.663 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8941154479980469
Epoch: 9, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.739 Vali Acc: 0.789 Test Loss: 0.739 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788881).  Saving model ...
Epoch: 10 cost time: 1.9685618877410889
Epoch: 10, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.837 Vali Acc: 0.789 Test Loss: 0.837 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8520503044128418
Epoch: 11, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.886 Vali Acc: 0.744 Test Loss: 0.886 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9024412631988525
Epoch: 12, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.005 Vali Acc: 0.756 Test Loss: 1.005 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.853283405303955
Epoch: 13, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.862 Vali Acc: 0.756 Test Loss: 0.862 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7039644718170166
Epoch: 14, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.020 Vali Acc: 0.733 Test Loss: 1.020 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7703161239624023
Epoch: 15, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.964 Vali Acc: 0.761 Test Loss: 0.964 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8754987716674805
Epoch: 16, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.053 Vali Acc: 0.756 Test Loss: 1.053 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8080267906188965
Epoch: 17, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.973 Vali Acc: 0.767 Test Loss: 0.973 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.585064172744751
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.873 Vali Acc: 0.778 Test Loss: 0.873 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6417956352233887
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.772 Test Loss: 0.992 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 207622
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2214298248291016
Epoch: 1, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.343 Vali Acc: 0.544 Test Loss: 1.343 Test Acc: 0.544
Validation loss decreased (inf --> -0.544431).  Saving model ...
Epoch: 2 cost time: 1.7614316940307617
Epoch: 2, Steps: 12 | Train Loss: 1.099 Vali Loss: 0.907 Vali Acc: 0.606 Test Loss: 0.907 Test Acc: 0.606
Validation loss decreased (-0.544431 --> -0.605546).  Saving model ...
Epoch: 3 cost time: 1.6838717460632324
Epoch: 3, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.777 Vali Acc: 0.683 Test Loss: 0.777 Test Acc: 0.683
Validation loss decreased (-0.605546 --> -0.683326).  Saving model ...
Epoch: 4 cost time: 1.8030147552490234
Epoch: 4, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.733 Vali Acc: 0.700 Test Loss: 0.733 Test Acc: 0.700
Validation loss decreased (-0.683326 --> -0.699993).  Saving model ...
Epoch: 5 cost time: 1.6820008754730225
Epoch: 5, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.643 Vali Acc: 0.744 Test Loss: 0.643 Test Acc: 0.744
Validation loss decreased (-0.699993 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 1.8346500396728516
Epoch: 6, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.722 Vali Acc: 0.733 Test Loss: 0.722 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.807194709777832
Epoch: 7, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.768 Vali Acc: 0.750 Test Loss: 0.768 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 1.47141432762146
Epoch: 8, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.661 Vali Acc: 0.756 Test Loss: 0.661 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 1.4534237384796143
Epoch: 9, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.748 Vali Acc: 0.728 Test Loss: 0.748 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5048325061798096
Epoch: 10, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.875 Vali Acc: 0.728 Test Loss: 0.875 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3782835006713867
Epoch: 11, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.812 Vali Acc: 0.728 Test Loss: 0.812 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4951584339141846
Epoch: 12, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.904 Vali Acc: 0.761 Test Loss: 0.904 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761102).  Saving model ...
Epoch: 13 cost time: 1.5056898593902588
Epoch: 13, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.873 Vali Acc: 0.744 Test Loss: 0.873 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.54713773727417
Epoch: 14, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.961 Vali Acc: 0.767 Test Loss: 0.961 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766657).  Saving model ...
Epoch: 15 cost time: 1.4957075119018555
Epoch: 15, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.036 Vali Acc: 0.756 Test Loss: 1.036 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.589796543121338
Epoch: 16, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.101 Vali Acc: 0.750 Test Loss: 1.101 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5554375648498535
Epoch: 17, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.938 Vali Acc: 0.756 Test Loss: 0.938 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.643890380859375
Epoch: 18, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.054 Vali Acc: 0.722 Test Loss: 1.054 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6453700065612793
Epoch: 19, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.018 Vali Acc: 0.772 Test Loss: 1.018 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772212).  Saving model ...
Epoch: 20 cost time: 1.5854027271270752
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.998 Vali Acc: 0.756 Test Loss: 0.998 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5795950889587402
Epoch: 21, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.029 Vali Acc: 0.772 Test Loss: 1.029 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.64705228805542
Epoch: 22, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.026 Vali Acc: 0.783 Test Loss: 1.026 Test Acc: 0.783
Validation loss decreased (-0.772212 --> -0.783323).  Saving model ...
Epoch: 23 cost time: 1.705695390701294
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.046 Vali Acc: 0.772 Test Loss: 1.046 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6442396640777588
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.062 Vali Acc: 0.767 Test Loss: 1.062 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.668565273284912
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.079 Vali Acc: 0.767 Test Loss: 1.079 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6369550228118896
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.073 Vali Acc: 0.772 Test Loss: 1.073 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6136112213134766
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.064 Vali Acc: 0.761 Test Loss: 1.064 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3504836559295654
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.082 Vali Acc: 0.761 Test Loss: 1.082 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5435495376586914
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.076 Vali Acc: 0.767 Test Loss: 1.076 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.290980339050293
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.084 Vali Acc: 0.767 Test Loss: 1.084 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4874982833862305
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.772 Test Loss: 1.079 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4537353515625
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.083 Vali Acc: 0.772 Test Loss: 1.083 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 161670
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.078733205795288
Epoch: 1, Steps: 12 | Train Loss: 1.945 Vali Loss: 1.543 Vali Acc: 0.478 Test Loss: 1.543 Test Acc: 0.478
Validation loss decreased (inf --> -0.477762).  Saving model ...
Epoch: 2 cost time: 1.6439423561096191
Epoch: 2, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.020 Vali Acc: 0.617 Test Loss: 1.020 Test Acc: 0.617
Validation loss decreased (-0.477762 --> -0.616656).  Saving model ...
Epoch: 3 cost time: 1.6000258922576904
Epoch: 3, Steps: 12 | Train Loss: 0.887 Vali Loss: 0.862 Vali Acc: 0.639 Test Loss: 0.862 Test Acc: 0.639
Validation loss decreased (-0.616656 --> -0.638880).  Saving model ...
Epoch: 4 cost time: 1.5755817890167236
Epoch: 4, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.733 Vali Acc: 0.700 Test Loss: 0.733 Test Acc: 0.700
Validation loss decreased (-0.638880 --> -0.699993).  Saving model ...
Epoch: 5 cost time: 1.5432274341583252
Epoch: 5, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.678 Vali Acc: 0.722 Test Loss: 0.678 Test Acc: 0.722
Validation loss decreased (-0.699993 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 1.455066204071045
Epoch: 6, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.628 Vali Acc: 0.739 Test Loss: 0.628 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 1.4687590599060059
Epoch: 7, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.666 Vali Acc: 0.728 Test Loss: 0.666 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5566799640655518
Epoch: 8, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.667 Vali Acc: 0.756 Test Loss: 0.667 Test Acc: 0.756
Validation loss decreased (-0.738883 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 1.5869643688201904
Epoch: 9, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.659 Vali Acc: 0.739 Test Loss: 0.659 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5216593742370605
Epoch: 10, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.677 Vali Acc: 0.750 Test Loss: 0.677 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4014794826507568
Epoch: 11, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.687 Vali Acc: 0.728 Test Loss: 0.687 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4283175468444824
Epoch: 12, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4351251125335693
Epoch: 13, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.858 Vali Acc: 0.722 Test Loss: 0.858 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5996246337890625
Epoch: 14, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.783 Vali Acc: 0.761 Test Loss: 0.783 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761103).  Saving model ...
Epoch: 15 cost time: 1.6912543773651123
Epoch: 15, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.757 Vali Acc: 0.756 Test Loss: 0.757 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.636286735534668
Epoch: 16, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6492319107055664
Epoch: 17, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.825 Vali Acc: 0.750 Test Loss: 0.825 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5455994606018066
Epoch: 18, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5439019203186035
Epoch: 19, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.839 Vali Acc: 0.744 Test Loss: 0.839 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5689952373504639
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.842 Vali Acc: 0.761 Test Loss: 0.842 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5311768054962158
Epoch: 21, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.847 Vali Acc: 0.761 Test Loss: 0.847 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5074794292449951
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.879 Vali Acc: 0.739 Test Loss: 0.879 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4957084655761719
Epoch: 23, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.905 Vali Acc: 0.744 Test Loss: 0.905 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.614015817642212
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.892 Vali Acc: 0.744 Test Loss: 0.892 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 124998
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1933341026306152
Epoch: 1, Steps: 12 | Train Loss: 1.837 Vali Loss: 1.612 Vali Acc: 0.367 Test Loss: 1.612 Test Acc: 0.367
Validation loss decreased (inf --> -0.366651).  Saving model ...
Epoch: 2 cost time: 1.5406107902526855
Epoch: 2, Steps: 12 | Train Loss: 1.351 Vali Loss: 1.125 Vali Acc: 0.550 Test Loss: 1.125 Test Acc: 0.550
Validation loss decreased (-0.366651 --> -0.549989).  Saving model ...
Epoch: 3 cost time: 1.031067132949829
Epoch: 3, Steps: 12 | Train Loss: 0.905 Vali Loss: 0.915 Vali Acc: 0.633 Test Loss: 0.915 Test Acc: 0.633
Validation loss decreased (-0.549989 --> -0.633324).  Saving model ...
Epoch: 4 cost time: 1.4735174179077148
Epoch: 4, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.787 Vali Acc: 0.650 Test Loss: 0.787 Test Acc: 0.650
Validation loss decreased (-0.633324 --> -0.649992).  Saving model ...
Epoch: 5 cost time: 1.4329712390899658
Epoch: 5, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.710 Vali Acc: 0.700 Test Loss: 0.710 Test Acc: 0.700
Validation loss decreased (-0.649992 --> -0.699993).  Saving model ...
Epoch: 6 cost time: 1.1962287425994873
Epoch: 6, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.657 Vali Acc: 0.744 Test Loss: 0.657 Test Acc: 0.744
Validation loss decreased (-0.699993 --> -0.744438).  Saving model ...
Epoch: 7 cost time: 1.4390435218811035
Epoch: 7, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.623 Vali Acc: 0.744 Test Loss: 0.623 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 1.5746378898620605
Epoch: 8, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.661 Vali Acc: 0.756 Test Loss: 0.661 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 1.4937217235565186
Epoch: 9, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.687 Vali Acc: 0.739 Test Loss: 0.687 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3817739486694336
Epoch: 10, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.704 Vali Acc: 0.750 Test Loss: 0.704 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4206459522247314
Epoch: 11, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.697 Vali Acc: 0.767 Test Loss: 0.697 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 12 cost time: 1.3686964511871338
Epoch: 12, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.667 Vali Acc: 0.750 Test Loss: 0.667 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5871343612670898
Epoch: 13, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.698 Vali Acc: 0.772 Test Loss: 0.698 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772215).  Saving model ...
Epoch: 14 cost time: 1.5117735862731934
Epoch: 14, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.708 Vali Acc: 0.761 Test Loss: 0.708 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6351454257965088
Epoch: 15, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.706 Vali Acc: 0.767 Test Loss: 0.706 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3981564044952393
Epoch: 16, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.783 Vali Acc: 0.767 Test Loss: 0.783 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3155810832977295
Epoch: 17, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.790 Vali Acc: 0.744 Test Loss: 0.790 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1605401039123535
Epoch: 18, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.850 Vali Acc: 0.767 Test Loss: 0.850 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1971235275268555
Epoch: 19, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.842 Vali Acc: 0.761 Test Loss: 0.842 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3178372383117676
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.807 Vali Acc: 0.772 Test Loss: 0.807 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4822423458099365
Epoch: 21, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.846 Vali Acc: 0.739 Test Loss: 0.846 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4775843620300293
Epoch: 22, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.897 Vali Acc: 0.761 Test Loss: 0.897 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5034713745117188
Epoch: 23, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.849 Vali Acc: 0.744 Test Loss: 0.849 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm64_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 115910
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9559836387634277
Epoch: 1, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.150 Vali Acc: 0.561 Test Loss: 1.150 Test Acc: 0.561
Validation loss decreased (inf --> -0.561100).  Saving model ...
Epoch: 2 cost time: 1.3777403831481934
Epoch: 2, Steps: 12 | Train Loss: 0.984 Vali Loss: 0.936 Vali Acc: 0.617 Test Loss: 0.936 Test Acc: 0.617
Validation loss decreased (-0.561100 --> -0.616657).  Saving model ...
Epoch: 3 cost time: 1.3486628532409668
Epoch: 3, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.703 Vali Acc: 0.717 Test Loss: 0.703 Test Acc: 0.717
Validation loss decreased (-0.616657 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 1.2898693084716797
Epoch: 4, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.716 Vali Acc: 0.722 Test Loss: 0.716 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722215).  Saving model ...
Epoch: 5 cost time: 1.258850336074829
Epoch: 5, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.713 Vali Acc: 0.744 Test Loss: 0.713 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744437).  Saving model ...
Epoch: 6 cost time: 1.0880532264709473
Epoch: 6, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.728 Vali Acc: 0.772 Test Loss: 0.728 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772215).  Saving model ...
Epoch: 7 cost time: 1.2584686279296875
Epoch: 7, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.901 Vali Acc: 0.744 Test Loss: 0.901 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3950860500335693
Epoch: 8, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.997 Vali Acc: 0.733 Test Loss: 0.997 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3090157508850098
Epoch: 9, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.913 Vali Acc: 0.761 Test Loss: 0.913 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2555720806121826
Epoch: 10, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.078 Vali Acc: 0.733 Test Loss: 1.078 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2290210723876953
Epoch: 11, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.022 Vali Acc: 0.767 Test Loss: 1.022 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3270487785339355
Epoch: 12, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.941 Vali Acc: 0.733 Test Loss: 0.941 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.305919885635376
Epoch: 13, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.133 Vali Acc: 0.739 Test Loss: 1.133 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4235565662384033
Epoch: 14, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.094 Vali Acc: 0.772 Test Loss: 1.094 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4336566925048828
Epoch: 15, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.303 Vali Acc: 0.744 Test Loss: 1.303 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3314361572265625
Epoch: 16, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.540 Vali Acc: 0.711 Test Loss: 1.540 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 277190
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.768217086791992
Epoch: 1, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.413 Vali Acc: 0.494 Test Loss: 1.413 Test Acc: 0.494
Validation loss decreased (inf --> -0.494430).  Saving model ...
Epoch: 2 cost time: 1.2086398601531982
Epoch: 2, Steps: 12 | Train Loss: 1.192 Vali Loss: 0.935 Vali Acc: 0.628 Test Loss: 0.935 Test Acc: 0.628
Validation loss decreased (-0.494430 --> -0.627768).  Saving model ...
Epoch: 3 cost time: 1.0799739360809326
Epoch: 3, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.835 Vali Acc: 0.661 Test Loss: 0.835 Test Acc: 0.661
Validation loss decreased (-0.627768 --> -0.661103).  Saving model ...
Epoch: 4 cost time: 1.1008801460266113
Epoch: 4, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.732 Vali Acc: 0.678 Test Loss: 0.732 Test Acc: 0.678
Validation loss decreased (-0.661103 --> -0.677770).  Saving model ...
Epoch: 5 cost time: 0.9857263565063477
Epoch: 5, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.700 Vali Acc: 0.728 Test Loss: 0.700 Test Acc: 0.728
Validation loss decreased (-0.677770 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.0732614994049072
Epoch: 6, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.644 Vali Acc: 0.722 Test Loss: 0.644 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1853246688842773
Epoch: 7, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 1.0076236724853516
Epoch: 8, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.826 Vali Acc: 0.750 Test Loss: 0.826 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0485403537750244
Epoch: 9, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.722 Vali Acc: 0.756 Test Loss: 0.722 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 10 cost time: 1.1890220642089844
Epoch: 10, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.758 Vali Acc: 0.756 Test Loss: 0.758 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0801115036010742
Epoch: 11, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.731 Vali Acc: 0.744 Test Loss: 0.731 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.101215124130249
Epoch: 12, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.846 Vali Acc: 0.733 Test Loss: 0.846 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0989594459533691
Epoch: 13, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.777 Vali Acc: 0.756 Test Loss: 0.777 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.194627285003662
Epoch: 14, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1581857204437256
Epoch: 15, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.813 Vali Acc: 0.756 Test Loss: 0.813 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1462774276733398
Epoch: 16, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.797 Vali Acc: 0.778 Test Loss: 0.797 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777770).  Saving model ...
Epoch: 17 cost time: 1.060133695602417
Epoch: 17, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.832 Vali Acc: 0.772 Test Loss: 0.832 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1973888874053955
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.836 Vali Acc: 0.761 Test Loss: 0.836 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0840544700622559
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.827 Vali Acc: 0.772 Test Loss: 0.827 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1093788146972656
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.839 Vali Acc: 0.772 Test Loss: 0.839 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1362576484680176
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.848 Vali Acc: 0.761 Test Loss: 0.848 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.058497428894043
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.850 Vali Acc: 0.767 Test Loss: 0.850 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1171154975891113
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.855 Vali Acc: 0.772 Test Loss: 0.855 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.153125286102295
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.862 Vali Acc: 0.772 Test Loss: 0.862 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0892486572265625
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.772 Test Loss: 0.859 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1668782234191895
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.783 Test Loss: 0.866 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783325).  Saving model ...
Epoch: 27 cost time: 1.1771056652069092
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.876 Vali Acc: 0.778 Test Loss: 0.876 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0998756885528564
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.896 Vali Acc: 0.772 Test Loss: 0.896 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2109105587005615
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.772 Test Loss: 0.891 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1537196636199951
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.898 Vali Acc: 0.772 Test Loss: 0.898 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1688768863677979
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.772 Test Loss: 0.916 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1722989082336426
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.927 Vali Acc: 0.772 Test Loss: 0.927 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.176891565322876
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.772 Test Loss: 0.930 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0696732997894287
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.925 Vali Acc: 0.767 Test Loss: 0.925 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1496460437774658
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.931 Vali Acc: 0.772 Test Loss: 0.931 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.175478458404541
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.772 Test Loss: 0.936 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 162022
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9936792850494385
Epoch: 1, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.299 Vali Acc: 0.606 Test Loss: 1.299 Test Acc: 0.606
Validation loss decreased (inf --> -0.605543).  Saving model ...
Epoch: 2 cost time: 1.2362430095672607
Epoch: 2, Steps: 12 | Train Loss: 1.059 Vali Loss: 0.888 Vali Acc: 0.650 Test Loss: 0.888 Test Acc: 0.650
Validation loss decreased (-0.605543 --> -0.649991).  Saving model ...
Epoch: 3 cost time: 1.0827255249023438
Epoch: 3, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.731 Vali Acc: 0.683 Test Loss: 0.731 Test Acc: 0.683
Validation loss decreased (-0.649991 --> -0.683326).  Saving model ...
Epoch: 4 cost time: 1.1254162788391113
Epoch: 4, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.600 Vali Acc: 0.761 Test Loss: 0.600 Test Acc: 0.761
Validation loss decreased (-0.683326 --> -0.761105).  Saving model ...
Epoch: 5 cost time: 1.1947376728057861
Epoch: 5, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.672 Vali Acc: 0.778 Test Loss: 0.672 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777771).  Saving model ...
Epoch: 6 cost time: 1.1445822715759277
Epoch: 6, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.675 Vali Acc: 0.744 Test Loss: 0.675 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2106378078460693
Epoch: 7, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.707 Vali Acc: 0.717 Test Loss: 0.707 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1204521656036377
Epoch: 8, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.678 Vali Acc: 0.756 Test Loss: 0.678 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1508300304412842
Epoch: 9, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.715 Vali Acc: 0.772 Test Loss: 0.715 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1883800029754639
Epoch: 10, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.716 Vali Acc: 0.772 Test Loss: 0.716 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2295920848846436
Epoch: 11, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.688 Vali Acc: 0.761 Test Loss: 0.688 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.148681879043579
Epoch: 12, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.763 Vali Acc: 0.761 Test Loss: 0.763 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2672133445739746
Epoch: 13, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.734 Vali Acc: 0.783 Test Loss: 0.734 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783326).  Saving model ...
Epoch: 14 cost time: 1.170990228652954
Epoch: 14, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.792 Vali Acc: 0.750 Test Loss: 0.792 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1023149490356445
Epoch: 15, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.829 Vali Acc: 0.778 Test Loss: 0.829 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2247586250305176
Epoch: 16, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.783 Vali Acc: 0.756 Test Loss: 0.783 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.142547607421875
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.857 Vali Acc: 0.761 Test Loss: 0.857 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0346379280090332
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.826 Vali Acc: 0.767 Test Loss: 0.826 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.143061876296997
Epoch: 19, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.867 Vali Acc: 0.772 Test Loss: 0.867 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9925339221954346
Epoch: 20, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.035 Vali Acc: 0.744 Test Loss: 1.035 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.056786060333252
Epoch: 21, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.043 Vali Acc: 0.756 Test Loss: 1.043 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8252279758453369
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.956 Vali Acc: 0.761 Test Loss: 0.956 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0898585319519043
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.929 Vali Acc: 0.767 Test Loss: 0.929 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 157446
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.84131121635437
Epoch: 1, Steps: 12 | Train Loss: 1.705 Vali Loss: 1.402 Vali Acc: 0.544 Test Loss: 1.402 Test Acc: 0.544
Validation loss decreased (inf --> -0.544430).  Saving model ...
Epoch: 2 cost time: 1.4124772548675537
Epoch: 2, Steps: 12 | Train Loss: 1.200 Vali Loss: 0.967 Vali Acc: 0.628 Test Loss: 0.967 Test Acc: 0.628
Validation loss decreased (-0.544430 --> -0.627768).  Saving model ...
Epoch: 3 cost time: 1.3714401721954346
Epoch: 3, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.809 Vali Acc: 0.706 Test Loss: 0.809 Test Acc: 0.706
Validation loss decreased (-0.627768 --> -0.705547).  Saving model ...
Epoch: 4 cost time: 1.3738813400268555
Epoch: 4, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.700 Vali Acc: 0.733 Test Loss: 0.700 Test Acc: 0.733
Validation loss decreased (-0.705547 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 1.335740089416504
Epoch: 5, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3249812126159668
Epoch: 6, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.741 Vali Acc: 0.728 Test Loss: 0.741 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4184834957122803
Epoch: 7, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.704 Vali Acc: 0.728 Test Loss: 0.704 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4506990909576416
Epoch: 8, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.620 Vali Acc: 0.778 Test Loss: 0.620 Test Acc: 0.778
Validation loss decreased (-0.733326 --> -0.777772).  Saving model ...
Epoch: 9 cost time: 1.3037145137786865
Epoch: 9, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.787 Vali Acc: 0.739 Test Loss: 0.787 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.384545087814331
Epoch: 10, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.694 Vali Acc: 0.761 Test Loss: 0.694 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3978562355041504
Epoch: 11, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.659 Vali Acc: 0.767 Test Loss: 0.659 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4517982006072998
Epoch: 12, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.650 Vali Acc: 0.767 Test Loss: 0.650 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4071946144104004
Epoch: 13, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.736 Vali Acc: 0.756 Test Loss: 0.736 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.477506160736084
Epoch: 14, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.732 Vali Acc: 0.761 Test Loss: 0.732 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3534495830535889
Epoch: 15, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.807 Vali Acc: 0.767 Test Loss: 0.807 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2983880043029785
Epoch: 16, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.726 Vali Acc: 0.761 Test Loss: 0.726 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4139044284820557
Epoch: 17, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.779 Vali Acc: 0.767 Test Loss: 0.779 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3880949020385742
Epoch: 18, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.758 Vali Acc: 0.761 Test Loss: 0.758 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 120646
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.908155679702759
Epoch: 1, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.444 Vali Acc: 0.494 Test Loss: 1.444 Test Acc: 0.494
Validation loss decreased (inf --> -0.494430).  Saving model ...
Epoch: 2 cost time: 1.325242519378662
Epoch: 2, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.056 Vali Acc: 0.633 Test Loss: 1.056 Test Acc: 0.633
Validation loss decreased (-0.494430 --> -0.633323).  Saving model ...
Epoch: 3 cost time: 1.441333293914795
Epoch: 3, Steps: 12 | Train Loss: 0.906 Vali Loss: 0.861 Vali Acc: 0.650 Test Loss: 0.861 Test Acc: 0.650
Validation loss decreased (-0.633323 --> -0.649991).  Saving model ...
Epoch: 4 cost time: 1.4443070888519287
Epoch: 4, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.751 Vali Acc: 0.689 Test Loss: 0.751 Test Acc: 0.689
Validation loss decreased (-0.649991 --> -0.688881).  Saving model ...
Epoch: 5 cost time: 1.3728187084197998
Epoch: 5, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.647 Vali Acc: 0.744 Test Loss: 0.647 Test Acc: 0.744
Validation loss decreased (-0.688881 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 1.285426378250122
Epoch: 6, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.603 Vali Acc: 0.733 Test Loss: 0.603 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2869858741760254
Epoch: 7, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.600 Vali Acc: 0.750 Test Loss: 0.600 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.3614485263824463
Epoch: 8, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.598 Vali Acc: 0.750 Test Loss: 0.598 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.3251888751983643
Epoch: 9, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.666 Vali Acc: 0.756 Test Loss: 0.666 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 10 cost time: 1.4767940044403076
Epoch: 10, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 11 cost time: 1.3633580207824707
Epoch: 11, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2438266277313232
Epoch: 12, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.593 Vali Acc: 0.767 Test Loss: 0.593 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 13 cost time: 1.4635028839111328
Epoch: 13, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.584 Vali Acc: 0.767 Test Loss: 0.584 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766661).  Saving model ...
Epoch: 14 cost time: 1.483396053314209
Epoch: 14, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.673 Vali Acc: 0.761 Test Loss: 0.673 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.468578815460205
Epoch: 15, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.685 Vali Acc: 0.756 Test Loss: 0.685 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4645895957946777
Epoch: 16, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.693 Vali Acc: 0.761 Test Loss: 0.693 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4477040767669678
Epoch: 17, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.667 Vali Acc: 0.767 Test Loss: 0.667 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4551119804382324
Epoch: 18, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.737 Vali Acc: 0.733 Test Loss: 0.737 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.392564296722412
Epoch: 19, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.710 Vali Acc: 0.761 Test Loss: 0.710 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3756840229034424
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.713 Vali Acc: 0.761 Test Loss: 0.713 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.42836594581604
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.764 Vali Acc: 0.761 Test Loss: 0.764 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4369080066680908
Epoch: 22, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.751 Vali Acc: 0.767 Test Loss: 0.751 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.376983404159546
Epoch: 23, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.777 Vali Acc: 0.750 Test Loss: 0.777 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 97670
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.261357307434082
Epoch: 1, Steps: 12 | Train Loss: 1.879 Vali Loss: 1.691 Vali Acc: 0.317 Test Loss: 1.691 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 0.8503642082214355
Epoch: 2, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.281 Vali Acc: 0.528 Test Loss: 1.281 Test Acc: 0.528
Validation loss decreased (-0.316650 --> -0.527765).  Saving model ...
Epoch: 3 cost time: 0.8416199684143066
Epoch: 3, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
Validation loss decreased (-0.527765 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.8642668724060059
Epoch: 4, Steps: 12 | Train Loss: 0.903 Vali Loss: 0.871 Vali Acc: 0.639 Test Loss: 0.871 Test Acc: 0.639
Validation loss decreased (-0.599990 --> -0.638880).  Saving model ...
Epoch: 5 cost time: 0.8453013896942139
Epoch: 5, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.778 Vali Acc: 0.678 Test Loss: 0.778 Test Acc: 0.678
Validation loss decreased (-0.638880 --> -0.677770).  Saving model ...
Epoch: 6 cost time: 0.8323569297790527
Epoch: 6, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.698 Vali Acc: 0.717 Test Loss: 0.698 Test Acc: 0.717
Validation loss decreased (-0.677770 --> -0.716660).  Saving model ...
Epoch: 7 cost time: 0.7988853454589844
Epoch: 7, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.673 Vali Acc: 0.733 Test Loss: 0.673 Test Acc: 0.733
Validation loss decreased (-0.716660 --> -0.733327).  Saving model ...
Epoch: 8 cost time: 0.7832784652709961
Epoch: 8, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.636 Vali Acc: 0.733 Test Loss: 0.636 Test Acc: 0.733
Validation loss decreased (-0.733327 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 0.8437838554382324
Epoch: 9, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.617 Vali Acc: 0.744 Test Loss: 0.617 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744438).  Saving model ...
Epoch: 10 cost time: 0.8648741245269775
Epoch: 10, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.620 Vali Acc: 0.756 Test Loss: 0.620 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 11 cost time: 0.9345567226409912
Epoch: 11, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.623 Vali Acc: 0.722 Test Loss: 0.623 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9053618907928467
Epoch: 12, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.646 Vali Acc: 0.728 Test Loss: 0.646 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9156827926635742
Epoch: 13, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.638 Vali Acc: 0.739 Test Loss: 0.638 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8469648361206055
Epoch: 14, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.653 Vali Acc: 0.744 Test Loss: 0.653 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8895974159240723
Epoch: 15, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.671 Vali Acc: 0.744 Test Loss: 0.671 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9066965579986572
Epoch: 16, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.652 Vali Acc: 0.733 Test Loss: 0.652 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8077130317687988
Epoch: 17, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.701 Vali Acc: 0.761 Test Loss: 0.701 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 18 cost time: 0.8419716358184814
Epoch: 18, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.696 Vali Acc: 0.744 Test Loss: 0.696 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8604540824890137
Epoch: 19, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.663 Vali Acc: 0.739 Test Loss: 0.663 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8809723854064941
Epoch: 20, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.710 Vali Acc: 0.750 Test Loss: 0.710 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7766828536987305
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.732 Vali Acc: 0.728 Test Loss: 0.732 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8469452857971191
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.755 Vali Acc: 0.739 Test Loss: 0.755 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8006813526153564
Epoch: 23, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.832 Vali Acc: 0.733 Test Loss: 0.832 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8037023544311523
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.769 Vali Acc: 0.750 Test Loss: 0.769 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8377573490142822
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.752 Vali Acc: 0.756 Test Loss: 0.752 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8484065532684326
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.758 Vali Acc: 0.750 Test Loss: 0.758 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8860781192779541
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.777 Vali Acc: 0.744 Test Loss: 0.777 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 79334
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.403383731842041
Epoch: 1, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.623 Vali Acc: 0.394 Test Loss: 1.623 Test Acc: 0.394
Validation loss decreased (inf --> -0.394428).  Saving model ...
Epoch: 2 cost time: 0.8891699314117432
Epoch: 2, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.320 Vali Acc: 0.528 Test Loss: 1.320 Test Acc: 0.528
Validation loss decreased (-0.394428 --> -0.527765).  Saving model ...
Epoch: 3 cost time: 1.015355110168457
Epoch: 3, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.065 Vali Acc: 0.578 Test Loss: 1.065 Test Acc: 0.578
Validation loss decreased (-0.527765 --> -0.577767).  Saving model ...
Epoch: 4 cost time: 0.9099264144897461
Epoch: 4, Steps: 12 | Train Loss: 0.931 Vali Loss: 0.953 Vali Acc: 0.639 Test Loss: 0.953 Test Acc: 0.639
Validation loss decreased (-0.577767 --> -0.638879).  Saving model ...
Epoch: 5 cost time: 0.8371303081512451
Epoch: 5, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.847 Vali Acc: 0.661 Test Loss: 0.847 Test Acc: 0.661
Validation loss decreased (-0.638879 --> -0.661103).  Saving model ...
Epoch: 6 cost time: 0.7894272804260254
Epoch: 6, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.759 Vali Acc: 0.717 Test Loss: 0.759 Test Acc: 0.717
Validation loss decreased (-0.661103 --> -0.716659).  Saving model ...
Epoch: 7 cost time: 0.8329088687896729
Epoch: 7, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.690 Vali Acc: 0.706 Test Loss: 0.690 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8720645904541016
Epoch: 8, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.644 Vali Acc: 0.756 Test Loss: 0.644 Test Acc: 0.756
Validation loss decreased (-0.716659 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 0.848442554473877
Epoch: 9, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.662 Vali Acc: 0.750 Test Loss: 0.662 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9328193664550781
Epoch: 10, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8398349285125732
Epoch: 11, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.618 Vali Acc: 0.744 Test Loss: 0.618 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9092509746551514
Epoch: 12, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.639 Vali Acc: 0.756 Test Loss: 0.639 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 13 cost time: 0.9432668685913086
Epoch: 13, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.599 Vali Acc: 0.767 Test Loss: 0.599 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766661).  Saving model ...
Epoch: 14 cost time: 0.8697769641876221
Epoch: 14, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.637 Vali Acc: 0.767 Test Loss: 0.637 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9682650566101074
Epoch: 15, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.642 Vali Acc: 0.728 Test Loss: 0.642 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9313755035400391
Epoch: 16, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.702 Vali Acc: 0.756 Test Loss: 0.702 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9000532627105713
Epoch: 17, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.698 Vali Acc: 0.733 Test Loss: 0.698 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8818295001983643
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.677 Vali Acc: 0.767 Test Loss: 0.677 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8813645839691162
Epoch: 19, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.701 Vali Acc: 0.767 Test Loss: 0.701 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8467521667480469
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.684 Vali Acc: 0.756 Test Loss: 0.684 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.797722339630127
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.698 Vali Acc: 0.772 Test Loss: 0.698 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772215).  Saving model ...
Epoch: 22 cost time: 0.9197292327880859
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.732 Vali Acc: 0.767 Test Loss: 0.732 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8833441734313965
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.703 Vali Acc: 0.761 Test Loss: 0.703 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8498811721801758
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.708 Vali Acc: 0.772 Test Loss: 0.708 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9432728290557861
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.741 Vali Acc: 0.761 Test Loss: 0.741 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9301142692565918
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.751 Vali Acc: 0.756 Test Loss: 0.751 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8391592502593994
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.756 Vali Acc: 0.767 Test Loss: 0.756 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9283032417297363
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.734 Vali Acc: 0.761 Test Loss: 0.734 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9282360076904297
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.764 Vali Acc: 0.778 Test Loss: 0.764 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 30 cost time: 1.0114023685455322
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.776 Vali Acc: 0.772 Test Loss: 0.776 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9421558380126953
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.777 Vali Acc: 0.767 Test Loss: 0.777 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8683450222015381
Epoch: 32, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.772 Vali Acc: 0.772 Test Loss: 0.772 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8543143272399902
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.762 Vali Acc: 0.772 Test Loss: 0.762 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8758089542388916
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.789 Vali Acc: 0.767 Test Loss: 0.789 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8676779270172119
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.797 Vali Acc: 0.767 Test Loss: 0.797 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.879957914352417
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.778 Vali Acc: 0.761 Test Loss: 0.778 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8512818813323975
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.779 Vali Acc: 0.761 Test Loss: 0.779 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8532593250274658
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.798 Vali Acc: 0.761 Test Loss: 0.798 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9859378337860107
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.829 Vali Acc: 0.772 Test Loss: 0.829 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 74790
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6336231231689453
Epoch: 1, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.210 Vali Acc: 0.544 Test Loss: 1.210 Test Acc: 0.544
Validation loss decreased (inf --> -0.544432).  Saving model ...
Epoch: 2 cost time: 1.1831684112548828
Epoch: 2, Steps: 12 | Train Loss: 0.980 Vali Loss: 0.911 Vali Acc: 0.594 Test Loss: 0.911 Test Acc: 0.594
Validation loss decreased (-0.544432 --> -0.594435).  Saving model ...
Epoch: 3 cost time: 1.0761361122131348
Epoch: 3, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.816 Vali Acc: 0.683 Test Loss: 0.816 Test Acc: 0.683
Validation loss decreased (-0.594435 --> -0.683325).  Saving model ...
Epoch: 4 cost time: 1.097339153289795
Epoch: 4, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.901 Vali Acc: 0.722 Test Loss: 0.901 Test Acc: 0.722
Validation loss decreased (-0.683325 --> -0.722213).  Saving model ...
Epoch: 5 cost time: 1.1385273933410645
Epoch: 5, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.720 Vali Acc: 0.722 Test Loss: 0.720 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 1.1367623805999756
Epoch: 6, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.868 Vali Acc: 0.694 Test Loss: 0.868 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1594278812408447
Epoch: 7, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.105 Vali Acc: 0.739 Test Loss: 1.105 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738878).  Saving model ...
Epoch: 8 cost time: 1.1335928440093994
Epoch: 8, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.966 Vali Acc: 0.739 Test Loss: 0.966 Test Acc: 0.739
Validation loss decreased (-0.738878 --> -0.738879).  Saving model ...
Epoch: 9 cost time: 1.2339117527008057
Epoch: 9, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.215 Vali Acc: 0.639 Test Loss: 1.215 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1275908946990967
Epoch: 10, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.111 Vali Acc: 0.728 Test Loss: 1.111 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1559908390045166
Epoch: 11, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.273 Vali Acc: 0.722 Test Loss: 1.273 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1882641315460205
Epoch: 12, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.919 Vali Acc: 0.778 Test Loss: 0.919 Test Acc: 0.778
Validation loss decreased (-0.738879 --> -0.777769).  Saving model ...
Epoch: 13 cost time: 1.115774393081665
Epoch: 13, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.245 Vali Acc: 0.761 Test Loss: 1.245 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2040488719940186
Epoch: 14, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.075 Vali Acc: 0.772 Test Loss: 1.075 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.105309247970581
Epoch: 15, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.209 Vali Acc: 0.756 Test Loss: 1.209 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1721429824829102
Epoch: 16, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.244 Vali Acc: 0.750 Test Loss: 1.244 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1367273330688477
Epoch: 17, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.218 Vali Acc: 0.750 Test Loss: 1.218 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1360194683074951
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.241 Vali Acc: 0.739 Test Loss: 1.241 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.183854103088379
Epoch: 19, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.744 Test Loss: 1.262 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9963703155517578
Epoch: 20, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.744 Test Loss: 1.260 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.036607027053833
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.744 Test Loss: 1.249 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0164227485656738
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.750 Test Loss: 1.237 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 260550
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.574216365814209
Epoch: 1, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.430 Vali Acc: 0.472 Test Loss: 1.430 Test Acc: 0.472
Validation loss decreased (inf --> -0.472208).  Saving model ...
Epoch: 2 cost time: 1.0326721668243408
Epoch: 2, Steps: 12 | Train Loss: 1.250 Vali Loss: 0.944 Vali Acc: 0.578 Test Loss: 0.944 Test Acc: 0.578
Validation loss decreased (-0.472208 --> -0.577768).  Saving model ...
Epoch: 3 cost time: 0.9472551345825195
Epoch: 3, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.812 Vali Acc: 0.644 Test Loss: 0.812 Test Acc: 0.644
Validation loss decreased (-0.577768 --> -0.644436).  Saving model ...
Epoch: 4 cost time: 0.9215824604034424
Epoch: 4, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.627 Vali Acc: 0.728 Test Loss: 0.627 Test Acc: 0.728
Validation loss decreased (-0.644436 --> -0.727772).  Saving model ...
Epoch: 5 cost time: 0.9243659973144531
Epoch: 5, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.635 Vali Acc: 0.761 Test Loss: 0.635 Test Acc: 0.761
Validation loss decreased (-0.727772 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 0.916886568069458
Epoch: 6, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.628 Vali Acc: 0.761 Test Loss: 0.628 Test Acc: 0.761
Validation loss decreased (-0.761105 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 1.0041227340698242
Epoch: 7, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.593 Vali Acc: 0.756 Test Loss: 0.593 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9972612857818604
Epoch: 8, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.757 Vali Acc: 0.739 Test Loss: 0.757 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9511985778808594
Epoch: 9, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.626 Vali Acc: 0.767 Test Loss: 0.626 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 10 cost time: 1.02052640914917
Epoch: 10, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.790 Vali Acc: 0.733 Test Loss: 0.790 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9524068832397461
Epoch: 11, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.682 Vali Acc: 0.772 Test Loss: 0.682 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772215).  Saving model ...
Epoch: 12 cost time: 0.9327130317687988
Epoch: 12, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.785 Vali Acc: 0.756 Test Loss: 0.785 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9494855403900146
Epoch: 13, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.783 Vali Acc: 0.772 Test Loss: 0.783 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0172126293182373
Epoch: 14, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.885 Vali Acc: 0.750 Test Loss: 0.885 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9502160549163818
Epoch: 15, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.903 Vali Acc: 0.761 Test Loss: 0.903 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9506564140319824
Epoch: 16, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.881 Vali Acc: 0.733 Test Loss: 0.881 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9497778415679932
Epoch: 17, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.858 Vali Acc: 0.767 Test Loss: 0.858 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9178967475891113
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.866 Vali Acc: 0.761 Test Loss: 0.866 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.947465181350708
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.868 Vali Acc: 0.767 Test Loss: 0.868 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9147424697875977
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.884 Vali Acc: 0.767 Test Loss: 0.884 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9506552219390869
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.909 Vali Acc: 0.756 Test Loss: 0.909 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 145382
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.382094383239746
Epoch: 1, Steps: 12 | Train Loss: 1.659 Vali Loss: 1.387 Vali Acc: 0.483 Test Loss: 1.387 Test Acc: 0.483
Validation loss decreased (inf --> -0.483319).  Saving model ...
Epoch: 2 cost time: 0.9601552486419678
Epoch: 2, Steps: 12 | Train Loss: 1.107 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
Validation loss decreased (-0.483319 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 1.0097241401672363
Epoch: 3, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.862 Vali Acc: 0.644 Test Loss: 0.862 Test Acc: 0.644
Validation loss decreased (-0.599990 --> -0.644436).  Saving model ...
Epoch: 4 cost time: 0.9582469463348389
Epoch: 4, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.801 Vali Acc: 0.672 Test Loss: 0.801 Test Acc: 0.672
Validation loss decreased (-0.644436 --> -0.672214).  Saving model ...
Epoch: 5 cost time: 0.9253931045532227
Epoch: 5, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.761 Vali Acc: 0.706 Test Loss: 0.761 Test Acc: 0.706
Validation loss decreased (-0.672214 --> -0.705548).  Saving model ...
Epoch: 6 cost time: 0.9695484638214111
Epoch: 6, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.606 Vali Acc: 0.744 Test Loss: 0.606 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744438).  Saving model ...
Epoch: 7 cost time: 0.9652590751647949
Epoch: 7, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.737 Vali Acc: 0.733 Test Loss: 0.737 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0385057926177979
Epoch: 8, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.634 Vali Acc: 0.761 Test Loss: 0.634 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 1.0086708068847656
Epoch: 9, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9949157238006592
Epoch: 10, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.791 Vali Acc: 0.722 Test Loss: 0.791 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.000124454498291
Epoch: 11, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.773 Vali Acc: 0.750 Test Loss: 0.773 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9656062126159668
Epoch: 12, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.857 Vali Acc: 0.739 Test Loss: 0.857 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0102002620697021
Epoch: 13, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.831 Vali Acc: 0.761 Test Loss: 0.831 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.002676248550415
Epoch: 14, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.800 Vali Acc: 0.767 Test Loss: 0.800 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 0.977379322052002
Epoch: 15, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.818 Vali Acc: 0.767 Test Loss: 0.818 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9454693794250488
Epoch: 16, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.803 Vali Acc: 0.783 Test Loss: 0.803 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 1.0287392139434814
Epoch: 17, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.820 Vali Acc: 0.767 Test Loss: 0.820 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9631490707397461
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.818 Vali Acc: 0.789 Test Loss: 0.818 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788881).  Saving model ...
Epoch: 19 cost time: 0.8998677730560303
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.814 Vali Acc: 0.778 Test Loss: 0.814 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.031348705291748
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.832 Vali Acc: 0.789 Test Loss: 0.832 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9143245220184326
Epoch: 21, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.836 Vali Acc: 0.772 Test Loss: 0.836 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9346446990966797
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.862 Vali Acc: 0.778 Test Loss: 0.862 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9284365177154541
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.891 Vali Acc: 0.778 Test Loss: 0.891 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0108349323272705
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.883 Vali Acc: 0.783 Test Loss: 0.883 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9471466541290283
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.881 Vali Acc: 0.778 Test Loss: 0.881 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9219744205474854
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.882 Vali Acc: 0.789 Test Loss: 0.882 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0471901893615723
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.892 Vali Acc: 0.783 Test Loss: 0.892 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0317878723144531
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.772 Test Loss: 0.903 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 140806
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8038830757141113
Epoch: 1, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.519 Vali Acc: 0.489 Test Loss: 1.519 Test Acc: 0.489
Validation loss decreased (inf --> -0.488874).  Saving model ...
Epoch: 2 cost time: 1.2251207828521729
Epoch: 2, Steps: 12 | Train Loss: 1.255 Vali Loss: 1.014 Vali Acc: 0.622 Test Loss: 1.014 Test Acc: 0.622
Validation loss decreased (-0.488874 --> -0.622212).  Saving model ...
Epoch: 3 cost time: 1.1487464904785156
Epoch: 3, Steps: 12 | Train Loss: 0.896 Vali Loss: 0.819 Vali Acc: 0.656 Test Loss: 0.819 Test Acc: 0.656
Validation loss decreased (-0.622212 --> -0.655547).  Saving model ...
Epoch: 4 cost time: 1.071319818496704
Epoch: 4, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.695 Vali Acc: 0.689 Test Loss: 0.695 Test Acc: 0.689
Validation loss decreased (-0.655547 --> -0.688882).  Saving model ...
Epoch: 5 cost time: 1.1079661846160889
Epoch: 5, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.620 Vali Acc: 0.756 Test Loss: 0.620 Test Acc: 0.756
Validation loss decreased (-0.688882 --> -0.755549).  Saving model ...
Epoch: 6 cost time: 1.2087433338165283
Epoch: 6, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.616 Vali Acc: 0.744 Test Loss: 0.616 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1428141593933105
Epoch: 7, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.595 Vali Acc: 0.767 Test Loss: 0.595 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 1.2507386207580566
Epoch: 8, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.574 Vali Acc: 0.772 Test Loss: 0.574 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 9 cost time: 1.3337006568908691
Epoch: 9, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.664 Vali Acc: 0.744 Test Loss: 0.664 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.23598313331604
Epoch: 10, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.693 Vali Acc: 0.767 Test Loss: 0.693 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1761486530303955
Epoch: 11, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.590 Vali Acc: 0.750 Test Loss: 0.590 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.20090651512146
Epoch: 12, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.665 Vali Acc: 0.778 Test Loss: 0.665 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777771).  Saving model ...
Epoch: 13 cost time: 1.268050193786621
Epoch: 13, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.666 Vali Acc: 0.772 Test Loss: 0.666 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.299778699874878
Epoch: 14, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.706 Vali Acc: 0.761 Test Loss: 0.706 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2928109169006348
Epoch: 15, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.802 Vali Acc: 0.761 Test Loss: 0.802 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3195381164550781
Epoch: 16, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 17 cost time: 1.3264796733856201
Epoch: 17, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.699 Vali Acc: 0.778 Test Loss: 0.699 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3221523761749268
Epoch: 18, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.758 Vali Acc: 0.789 Test Loss: 0.758 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788881).  Saving model ...
Epoch: 19 cost time: 1.3361623287200928
Epoch: 19, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.779 Vali Acc: 0.761 Test Loss: 0.779 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3486664295196533
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.775 Vali Acc: 0.778 Test Loss: 0.775 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.151686668395996
Epoch: 21, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.799 Vali Acc: 0.761 Test Loss: 0.799 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2185964584350586
Epoch: 22, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.811 Vali Acc: 0.778 Test Loss: 0.811 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1973040103912354
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.771 Vali Acc: 0.783 Test Loss: 0.771 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1962647438049316
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.772 Vali Acc: 0.767 Test Loss: 0.772 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1810710430145264
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.795 Vali Acc: 0.772 Test Loss: 0.795 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3588478565216064
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.803 Vali Acc: 0.772 Test Loss: 0.803 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2128536701202393
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.819 Vali Acc: 0.772 Test Loss: 0.819 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.322585105895996
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.820 Vali Acc: 0.778 Test Loss: 0.820 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 104006
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.882906913757324
Epoch: 1, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.517 Vali Acc: 0.456 Test Loss: 1.517 Test Acc: 0.456
Validation loss decreased (inf --> -0.455540).  Saving model ...
Epoch: 2 cost time: 1.2231783866882324
Epoch: 2, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.117 Vali Acc: 0.633 Test Loss: 1.117 Test Acc: 0.633
Validation loss decreased (-0.455540 --> -0.633322).  Saving model ...
Epoch: 3 cost time: 1.2436988353729248
Epoch: 3, Steps: 12 | Train Loss: 0.962 Vali Loss: 0.898 Vali Acc: 0.656 Test Loss: 0.898 Test Acc: 0.656
Validation loss decreased (-0.633322 --> -0.655547).  Saving model ...
Epoch: 4 cost time: 1.253523588180542
Epoch: 4, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.774 Vali Acc: 0.678 Test Loss: 0.774 Test Acc: 0.678
Validation loss decreased (-0.655547 --> -0.677770).  Saving model ...
Epoch: 5 cost time: 1.2437856197357178
Epoch: 5, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.705 Vali Acc: 0.722 Test Loss: 0.705 Test Acc: 0.722
Validation loss decreased (-0.677770 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 1.2989020347595215
Epoch: 6, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.693 Vali Acc: 0.744 Test Loss: 0.693 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 7 cost time: 1.2416913509368896
Epoch: 7, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.630 Vali Acc: 0.728 Test Loss: 0.630 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2470545768737793
Epoch: 8, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.703 Vali Acc: 0.756 Test Loss: 0.703 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 1.241067886352539
Epoch: 9, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8930072784423828
Epoch: 10, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.610 Vali Acc: 0.750 Test Loss: 0.610 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.414219617843628
Epoch: 11, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.690 Vali Acc: 0.733 Test Loss: 0.690 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.439408302307129
Epoch: 12, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.697 Vali Acc: 0.756 Test Loss: 0.697 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 13 cost time: 1.48582124710083
Epoch: 13, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.601 Vali Acc: 0.778 Test Loss: 0.601 Test Acc: 0.778
Validation loss decreased (-0.755549 --> -0.777772).  Saving model ...
Epoch: 14 cost time: 1.4042632579803467
Epoch: 14, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.744 Vali Acc: 0.756 Test Loss: 0.744 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3296239376068115
Epoch: 15, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.681 Vali Acc: 0.744 Test Loss: 0.681 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3516738414764404
Epoch: 16, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3508968353271484
Epoch: 17, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.692 Vali Acc: 0.761 Test Loss: 0.692 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3338520526885986
Epoch: 18, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.784 Vali Acc: 0.761 Test Loss: 0.784 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3820602893829346
Epoch: 19, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.787 Vali Acc: 0.756 Test Loss: 0.787 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4274752140045166
Epoch: 20, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.811 Vali Acc: 0.767 Test Loss: 0.811 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4755923748016357
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.812 Vali Acc: 0.761 Test Loss: 0.812 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3165063858032227
Epoch: 22, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.803 Vali Acc: 0.756 Test Loss: 0.803 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3632373809814453
Epoch: 23, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.833 Vali Acc: 0.756 Test Loss: 0.833 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 81030
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.250699281692505
Epoch: 1, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.575 Vali Acc: 0.383 Test Loss: 1.575 Test Acc: 0.383
Validation loss decreased (inf --> -0.383318).  Saving model ...
Epoch: 2 cost time: 0.8242905139923096
Epoch: 2, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.220 Vali Acc: 0.522 Test Loss: 1.220 Test Acc: 0.522
Validation loss decreased (-0.383318 --> -0.522210).  Saving model ...
Epoch: 3 cost time: 0.8076317310333252
Epoch: 3, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.027 Vali Acc: 0.594 Test Loss: 1.027 Test Acc: 0.594
Validation loss decreased (-0.522210 --> -0.594434).  Saving model ...
Epoch: 4 cost time: 0.808748722076416
Epoch: 4, Steps: 12 | Train Loss: 0.910 Vali Loss: 0.890 Vali Acc: 0.644 Test Loss: 0.890 Test Acc: 0.644
Validation loss decreased (-0.594434 --> -0.644436).  Saving model ...
Epoch: 5 cost time: 0.8352468013763428
Epoch: 5, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.812 Vali Acc: 0.689 Test Loss: 0.812 Test Acc: 0.689
Validation loss decreased (-0.644436 --> -0.688881).  Saving model ...
Epoch: 6 cost time: 0.8639400005340576
Epoch: 6, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.757 Vali Acc: 0.683 Test Loss: 0.757 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8719351291656494
Epoch: 7, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.707 Vali Acc: 0.694 Test Loss: 0.707 Test Acc: 0.694
Validation loss decreased (-0.688881 --> -0.694437).  Saving model ...
Epoch: 8 cost time: 0.8324985504150391
Epoch: 8, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.682 Vali Acc: 0.728 Test Loss: 0.682 Test Acc: 0.728
Validation loss decreased (-0.694437 --> -0.727771).  Saving model ...
Epoch: 9 cost time: 0.8368666172027588
Epoch: 9, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.646 Vali Acc: 0.733 Test Loss: 0.646 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 0.8462967872619629
Epoch: 10, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.657 Vali Acc: 0.722 Test Loss: 0.657 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8894386291503906
Epoch: 11, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.655 Vali Acc: 0.722 Test Loss: 0.655 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9501760005950928
Epoch: 12, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.656 Vali Acc: 0.744 Test Loss: 0.656 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744438).  Saving model ...
Epoch: 13 cost time: 0.8220102787017822
Epoch: 13, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.621 Vali Acc: 0.744 Test Loss: 0.621 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 14 cost time: 0.9115488529205322
Epoch: 14, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.676 Vali Acc: 0.733 Test Loss: 0.676 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8855302333831787
Epoch: 15, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.645 Vali Acc: 0.761 Test Loss: 0.645 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761105).  Saving model ...
Epoch: 16 cost time: 0.8912694454193115
Epoch: 16, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.714 Vali Acc: 0.756 Test Loss: 0.714 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8649308681488037
Epoch: 17, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.727 Vali Acc: 0.756 Test Loss: 0.727 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.895533561706543
Epoch: 18, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.701 Vali Acc: 0.761 Test Loss: 0.701 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.859006404876709
Epoch: 19, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.705 Vali Acc: 0.744 Test Loss: 0.705 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9435627460479736
Epoch: 20, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.729 Vali Acc: 0.739 Test Loss: 0.729 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.877171516418457
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.728 Vali Acc: 0.761 Test Loss: 0.728 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9456639289855957
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.703 Vali Acc: 0.756 Test Loss: 0.703 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8513317108154297
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.730 Vali Acc: 0.761 Test Loss: 0.730 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9197020530700684
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.756 Vali Acc: 0.739 Test Loss: 0.756 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.83689284324646
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.756 Vali Acc: 0.750 Test Loss: 0.756 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 62694
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5117783546447754
Epoch: 1, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.673 Vali Acc: 0.367 Test Loss: 1.673 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 0.7992889881134033
Epoch: 2, Steps: 12 | Train Loss: 1.539 Vali Loss: 1.315 Vali Acc: 0.550 Test Loss: 1.315 Test Acc: 0.550
Validation loss decreased (-0.366650 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 0.8334090709686279
Epoch: 3, Steps: 12 | Train Loss: 1.167 Vali Loss: 1.050 Vali Acc: 0.611 Test Loss: 1.050 Test Acc: 0.611
Validation loss decreased (-0.549987 --> -0.611101).  Saving model ...
Epoch: 4 cost time: 0.8460450172424316
Epoch: 4, Steps: 12 | Train Loss: 0.968 Vali Loss: 0.930 Vali Acc: 0.617 Test Loss: 0.930 Test Acc: 0.617
Validation loss decreased (-0.611101 --> -0.616657).  Saving model ...
Epoch: 5 cost time: 0.8801238536834717
Epoch: 5, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.817 Vali Acc: 0.672 Test Loss: 0.817 Test Acc: 0.672
Validation loss decreased (-0.616657 --> -0.672214).  Saving model ...
Epoch: 6 cost time: 0.8655781745910645
Epoch: 6, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.731 Vali Acc: 0.700 Test Loss: 0.731 Test Acc: 0.700
Validation loss decreased (-0.672214 --> -0.699993).  Saving model ...
Epoch: 7 cost time: 0.8129959106445312
Epoch: 7, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.685 Vali Acc: 0.733 Test Loss: 0.685 Test Acc: 0.733
Validation loss decreased (-0.699993 --> -0.733326).  Saving model ...
Epoch: 8 cost time: 0.8235466480255127
Epoch: 8, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.648 Vali Acc: 0.728 Test Loss: 0.648 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8270456790924072
Epoch: 9, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.618 Vali Acc: 0.767 Test Loss: 0.618 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766660).  Saving model ...
Epoch: 10 cost time: 0.8154044151306152
Epoch: 10, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.649 Vali Acc: 0.728 Test Loss: 0.649 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8097107410430908
Epoch: 11, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.591 Vali Acc: 0.767 Test Loss: 0.591 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766661).  Saving model ...
Epoch: 12 cost time: 0.8348731994628906
Epoch: 12, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.640 Vali Acc: 0.744 Test Loss: 0.640 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8608758449554443
Epoch: 13, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.613 Vali Acc: 0.772 Test Loss: 0.613 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 14 cost time: 0.85654616355896
Epoch: 14, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.632 Vali Acc: 0.756 Test Loss: 0.632 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8507645130157471
Epoch: 15, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.606 Vali Acc: 0.756 Test Loss: 0.606 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8447914123535156
Epoch: 16, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.660 Vali Acc: 0.761 Test Loss: 0.660 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8549330234527588
Epoch: 17, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.642 Vali Acc: 0.772 Test Loss: 0.642 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9122500419616699
Epoch: 18, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.617 Vali Acc: 0.767 Test Loss: 0.617 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8431227207183838
Epoch: 19, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.657 Vali Acc: 0.767 Test Loss: 0.657 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8566269874572754
Epoch: 20, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.683 Vali Acc: 0.767 Test Loss: 0.683 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8268218040466309
Epoch: 21, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.626 Vali Acc: 0.794 Test Loss: 0.626 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794438).  Saving model ...
Epoch: 22 cost time: 0.8716075420379639
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.635 Vali Acc: 0.761 Test Loss: 0.635 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8717694282531738
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.655 Vali Acc: 0.778 Test Loss: 0.655 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7917475700378418
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.670 Vali Acc: 0.756 Test Loss: 0.670 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8443465232849121
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.679 Vali Acc: 0.772 Test Loss: 0.679 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8385009765625
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.698 Vali Acc: 0.772 Test Loss: 0.698 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8672654628753662
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.684 Vali Acc: 0.761 Test Loss: 0.684 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8873467445373535
Epoch: 28, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7287411689758301
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.707 Vali Acc: 0.756 Test Loss: 0.707 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7836568355560303
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.706 Vali Acc: 0.761 Test Loss: 0.706 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8012714385986328
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.707 Vali Acc: 0.767 Test Loss: 0.707 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 58150
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.046738624572754
Epoch: 1, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.230 Vali Acc: 0.533 Test Loss: 1.230 Test Acc: 0.533
Validation loss decreased (inf --> -0.533321).  Saving model ...
Epoch: 2 cost time: 1.4659931659698486
Epoch: 2, Steps: 12 | Train Loss: 0.888 Vali Loss: 0.728 Vali Acc: 0.683 Test Loss: 0.728 Test Acc: 0.683
Validation loss decreased (-0.533321 --> -0.683326).  Saving model ...
Epoch: 3 cost time: 1.4827024936676025
Epoch: 3, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.765 Vali Acc: 0.683 Test Loss: 0.765 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4996280670166016
Epoch: 4, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.671 Vali Acc: 0.761 Test Loss: 0.671 Test Acc: 0.761
Validation loss decreased (-0.683326 --> -0.761104).  Saving model ...
Epoch: 5 cost time: 1.5007739067077637
Epoch: 5, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.964 Vali Acc: 0.706 Test Loss: 0.964 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4961888790130615
Epoch: 6, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.772 Vali Acc: 0.761 Test Loss: 0.772 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4225456714630127
Epoch: 7, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.624 Vali Acc: 0.772 Test Loss: 0.624 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772216).  Saving model ...
Epoch: 8 cost time: 1.5366885662078857
Epoch: 8, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.945 Vali Acc: 0.744 Test Loss: 0.945 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.501633644104004
Epoch: 9, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.829 Vali Acc: 0.778 Test Loss: 0.829 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777769).  Saving model ...
Epoch: 10 cost time: 1.5657017230987549
Epoch: 10, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.140 Vali Acc: 0.728 Test Loss: 1.140 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.506976842880249
Epoch: 11, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.499 Vali Acc: 0.672 Test Loss: 1.499 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4712231159210205
Epoch: 12, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.122 Vali Acc: 0.722 Test Loss: 1.122 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5437476634979248
Epoch: 13, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.080 Vali Acc: 0.733 Test Loss: 1.080 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4449357986450195
Epoch: 14, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.277 Vali Acc: 0.728 Test Loss: 1.277 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4719455242156982
Epoch: 15, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.094 Vali Acc: 0.756 Test Loss: 1.094 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5189225673675537
Epoch: 16, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.076 Vali Acc: 0.772 Test Loss: 1.076 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.537724256515503
Epoch: 17, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.276 Vali Acc: 0.778 Test Loss: 1.276 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4183361530303955
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.603 Vali Acc: 0.739 Test Loss: 1.603 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5061097145080566
Epoch: 19, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.354 Vali Acc: 0.772 Test Loss: 1.354 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 252230
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.86683988571167
Epoch: 1, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.346 Vali Acc: 0.522 Test Loss: 1.346 Test Acc: 0.522
Validation loss decreased (inf --> -0.522209).  Saving model ...
Epoch: 2 cost time: 1.4666385650634766
Epoch: 2, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.013 Vali Acc: 0.583 Test Loss: 1.013 Test Acc: 0.583
Validation loss decreased (-0.522209 --> -0.583323).  Saving model ...
Epoch: 3 cost time: 1.4206597805023193
Epoch: 3, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.797 Vali Acc: 0.672 Test Loss: 0.797 Test Acc: 0.672
Validation loss decreased (-0.583323 --> -0.672214).  Saving model ...
Epoch: 4 cost time: 1.4356632232666016
Epoch: 4, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.813 Vali Acc: 0.678 Test Loss: 0.813 Test Acc: 0.678
Validation loss decreased (-0.672214 --> -0.677770).  Saving model ...
Epoch: 5 cost time: 1.44004487991333
Epoch: 5, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (-0.677770 --> -0.722216).  Saving model ...
Epoch: 6 cost time: 1.3979108333587646
Epoch: 6, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.702 Vali Acc: 0.739 Test Loss: 0.702 Test Acc: 0.739
Validation loss decreased (-0.722216 --> -0.738882).  Saving model ...
Epoch: 7 cost time: 1.4523603916168213
Epoch: 7, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.660 Vali Acc: 0.733 Test Loss: 0.660 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4007303714752197
Epoch: 8, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.632 Vali Acc: 0.744 Test Loss: 0.632 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 1.3631727695465088
Epoch: 9, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.630 Vali Acc: 0.750 Test Loss: 0.630 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.4021880626678467
Epoch: 10, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.859 Vali Acc: 0.739 Test Loss: 0.859 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4692230224609375
Epoch: 11, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.750 Vali Acc: 0.728 Test Loss: 0.750 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.508443832397461
Epoch: 12, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.753 Vali Acc: 0.767 Test Loss: 0.753 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766659).  Saving model ...
Epoch: 13 cost time: 1.4349174499511719
Epoch: 13, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.035 Vali Acc: 0.728 Test Loss: 1.035 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4610564708709717
Epoch: 14, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.720 Vali Acc: 0.750 Test Loss: 0.720 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4822955131530762
Epoch: 15, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.926 Vali Acc: 0.739 Test Loss: 0.926 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.416853666305542
Epoch: 16, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.826 Vali Acc: 0.767 Test Loss: 0.826 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3583776950836182
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.802 Vali Acc: 0.767 Test Loss: 0.802 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3393738269805908
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.831 Vali Acc: 0.772 Test Loss: 0.831 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772214).  Saving model ...
Epoch: 19 cost time: 1.3486871719360352
Epoch: 19, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.875 Vali Acc: 0.767 Test Loss: 0.875 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4050836563110352
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.874 Vali Acc: 0.761 Test Loss: 0.874 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3483083248138428
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.873 Vali Acc: 0.778 Test Loss: 0.873 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777769).  Saving model ...
Epoch: 22 cost time: 1.4553449153900146
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.878 Vali Acc: 0.767 Test Loss: 0.878 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4314930438995361
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.879 Vali Acc: 0.761 Test Loss: 0.879 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4498486518859863
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.873 Vali Acc: 0.761 Test Loss: 0.873 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.446234941482544
Epoch: 25, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.767 Test Loss: 0.863 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4587502479553223
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.866 Vali Acc: 0.778 Test Loss: 0.866 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777769).  Saving model ...
Epoch: 27 cost time: 1.439734697341919
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.887 Vali Acc: 0.778 Test Loss: 0.887 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4065604209899902
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.778 Test Loss: 0.899 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4701001644134521
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.902 Vali Acc: 0.772 Test Loss: 0.902 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.404280424118042
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.888 Vali Acc: 0.772 Test Loss: 0.888 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4702870845794678
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.896 Vali Acc: 0.778 Test Loss: 0.896 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5559611320495605
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.905 Vali Acc: 0.778 Test Loss: 0.905 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.5147981643676758
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.913 Vali Acc: 0.767 Test Loss: 0.913 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.4840929508209229
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.912 Vali Acc: 0.778 Test Loss: 0.912 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.422163724899292
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.772 Test Loss: 0.918 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.359797716140747
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.929 Vali Acc: 0.767 Test Loss: 0.929 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 137062
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.920886516571045
Epoch: 1, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.305 Vali Acc: 0.583 Test Loss: 1.305 Test Acc: 0.583
Validation loss decreased (inf --> -0.583320).  Saving model ...
Epoch: 2 cost time: 1.4439644813537598
Epoch: 2, Steps: 12 | Train Loss: 1.131 Vali Loss: 0.882 Vali Acc: 0.689 Test Loss: 0.882 Test Acc: 0.689
Validation loss decreased (-0.583320 --> -0.688880).  Saving model ...
Epoch: 3 cost time: 1.368910789489746
Epoch: 3, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.739 Vali Acc: 0.683 Test Loss: 0.739 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3872978687286377
Epoch: 4, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.683 Vali Acc: 0.678 Test Loss: 0.683 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.555844783782959
Epoch: 5, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.636 Vali Acc: 0.728 Test Loss: 0.636 Test Acc: 0.728
Validation loss decreased (-0.688880 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.3761847019195557
Epoch: 6, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.598 Vali Acc: 0.744 Test Loss: 0.598 Test Acc: 0.744
Validation loss decreased (-0.727771 --> -0.744438).  Saving model ...
Epoch: 7 cost time: 1.4338982105255127
Epoch: 7, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.704 Vali Acc: 0.744 Test Loss: 0.704 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.465496301651001
Epoch: 8, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.682 Vali Acc: 0.761 Test Loss: 0.682 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761104).  Saving model ...
Epoch: 9 cost time: 1.3263828754425049
Epoch: 9, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.688 Vali Acc: 0.744 Test Loss: 0.688 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3277108669281006
Epoch: 10, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.804 Vali Acc: 0.744 Test Loss: 0.804 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.398094654083252
Epoch: 11, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.778 Vali Acc: 0.756 Test Loss: 0.778 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4451303482055664
Epoch: 12, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.789 Vali Acc: 0.767 Test Loss: 0.789 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766659).  Saving model ...
Epoch: 13 cost time: 1.3901410102844238
Epoch: 13, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.715 Vali Acc: 0.772 Test Loss: 0.715 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 14 cost time: 1.4850914478302002
Epoch: 14, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.857 Vali Acc: 0.772 Test Loss: 0.857 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3738386631011963
Epoch: 15, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.808 Vali Acc: 0.778 Test Loss: 0.808 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 16 cost time: 1.3083434104919434
Epoch: 16, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.835 Vali Acc: 0.756 Test Loss: 0.835 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.35386061668396
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.818 Vali Acc: 0.772 Test Loss: 0.818 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2307980060577393
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.851 Vali Acc: 0.767 Test Loss: 0.851 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1540861129760742
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.857 Vali Acc: 0.767 Test Loss: 0.857 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3897547721862793
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.772 Test Loss: 0.878 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3392794132232666
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.884 Vali Acc: 0.767 Test Loss: 0.884 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.260221004486084
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.895 Vali Acc: 0.761 Test Loss: 0.895 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2268719673156738
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2289767265319824
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.906 Vali Acc: 0.756 Test Loss: 0.906 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2859785556793213
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.898 Vali Acc: 0.767 Test Loss: 0.898 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 132486
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9060566425323486
Epoch: 1, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.444 Vali Acc: 0.467 Test Loss: 1.444 Test Acc: 0.467
Validation loss decreased (inf --> -0.466652).  Saving model ...
Epoch: 2 cost time: 1.151749849319458
Epoch: 2, Steps: 12 | Train Loss: 1.141 Vali Loss: 0.957 Vali Acc: 0.633 Test Loss: 0.957 Test Acc: 0.633
Validation loss decreased (-0.466652 --> -0.633324).  Saving model ...
Epoch: 3 cost time: 1.3760778903961182
Epoch: 3, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.787 Vali Acc: 0.650 Test Loss: 0.787 Test Acc: 0.650
Validation loss decreased (-0.633324 --> -0.649992).  Saving model ...
Epoch: 4 cost time: 1.321073293685913
Epoch: 4, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.714 Vali Acc: 0.694 Test Loss: 0.714 Test Acc: 0.694
Validation loss decreased (-0.649992 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 1.2214510440826416
Epoch: 5, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.628 Vali Acc: 0.756 Test Loss: 0.628 Test Acc: 0.756
Validation loss decreased (-0.694437 --> -0.755549).  Saving model ...
Epoch: 6 cost time: 1.2703156471252441
Epoch: 6, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.594 Vali Acc: 0.744 Test Loss: 0.594 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.199427843093872
Epoch: 7, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.630 Vali Acc: 0.722 Test Loss: 0.630 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.309311866760254
Epoch: 8, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.651 Vali Acc: 0.744 Test Loss: 0.651 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3366420269012451
Epoch: 9, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.724 Vali Acc: 0.744 Test Loss: 0.724 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.261308193206787
Epoch: 10, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.707 Vali Acc: 0.744 Test Loss: 0.707 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3296902179718018
Epoch: 11, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.757 Vali Acc: 0.728 Test Loss: 0.757 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2145342826843262
Epoch: 12, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.708 Vali Acc: 0.750 Test Loss: 0.708 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2519750595092773
Epoch: 13, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.707 Vali Acc: 0.756 Test Loss: 0.707 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.453653335571289
Epoch: 14, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.738 Vali Acc: 0.789 Test Loss: 0.738 Test Acc: 0.789
Validation loss decreased (-0.755549 --> -0.788882).  Saving model ...
Epoch: 15 cost time: 1.3159849643707275
Epoch: 15, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3293898105621338
Epoch: 16, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.794 Vali Acc: 0.750 Test Loss: 0.794 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2303204536437988
Epoch: 17, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.761 Vali Acc: 0.772 Test Loss: 0.761 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.226362943649292
Epoch: 18, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.812 Vali Acc: 0.767 Test Loss: 0.812 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2735390663146973
Epoch: 19, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.816 Vali Acc: 0.761 Test Loss: 0.816 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3579657077789307
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.801 Vali Acc: 0.778 Test Loss: 0.801 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.354203462600708
Epoch: 21, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.804 Vali Acc: 0.767 Test Loss: 0.804 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3652865886688232
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.856 Vali Acc: 0.767 Test Loss: 0.856 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2185895442962646
Epoch: 23, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.853 Vali Acc: 0.772 Test Loss: 0.853 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2240071296691895
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.866 Vali Acc: 0.772 Test Loss: 0.866 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 95686
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.717161178588867
Epoch: 1, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.590 Vali Acc: 0.289 Test Loss: 1.590 Test Acc: 0.289
Validation loss decreased (inf --> -0.288873).  Saving model ...
Epoch: 2 cost time: 1.3459534645080566
Epoch: 2, Steps: 12 | Train Loss: 1.371 Vali Loss: 1.090 Vali Acc: 0.606 Test Loss: 1.090 Test Acc: 0.606
Validation loss decreased (-0.288873 --> -0.605545).  Saving model ...
Epoch: 3 cost time: 1.2654836177825928
Epoch: 3, Steps: 12 | Train Loss: 0.959 Vali Loss: 0.877 Vali Acc: 0.644 Test Loss: 0.877 Test Acc: 0.644
Validation loss decreased (-0.605545 --> -0.644436).  Saving model ...
Epoch: 4 cost time: 1.3539047241210938
Epoch: 4, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.787 Vali Acc: 0.656 Test Loss: 0.787 Test Acc: 0.656
Validation loss decreased (-0.644436 --> -0.655548).  Saving model ...
Epoch: 5 cost time: 1.2417759895324707
Epoch: 5, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.706 Vali Acc: 0.706 Test Loss: 0.706 Test Acc: 0.706
Validation loss decreased (-0.655548 --> -0.705549).  Saving model ...
Epoch: 6 cost time: 1.34700345993042
Epoch: 6, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.657 Vali Acc: 0.722 Test Loss: 0.657 Test Acc: 0.722
Validation loss decreased (-0.705549 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 1.3879601955413818
Epoch: 7, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.638 Vali Acc: 0.717 Test Loss: 0.638 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8100574016571045
Epoch: 8, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.647 Vali Acc: 0.733 Test Loss: 0.647 Test Acc: 0.733
Validation loss decreased (-0.722216 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 1.2447009086608887
Epoch: 9, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.592 Vali Acc: 0.756 Test Loss: 0.592 Test Acc: 0.756
Validation loss decreased (-0.733327 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 1.2708463668823242
Epoch: 10, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.609 Vali Acc: 0.744 Test Loss: 0.609 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3947689533233643
Epoch: 11, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.633 Vali Acc: 0.722 Test Loss: 0.633 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3099772930145264
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.719 Vali Acc: 0.761 Test Loss: 0.719 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761104).  Saving model ...
Epoch: 13 cost time: 1.2519829273223877
Epoch: 13, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.779 Vali Acc: 0.717 Test Loss: 0.779 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2949950695037842
Epoch: 14, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.737 Vali Acc: 0.778 Test Loss: 0.737 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 1.1570394039154053
Epoch: 15, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.673 Vali Acc: 0.744 Test Loss: 0.673 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3273727893829346
Epoch: 16, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.751 Vali Acc: 0.744 Test Loss: 0.751 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2647583484649658
Epoch: 17, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.879 Vali Acc: 0.744 Test Loss: 0.879 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4257142543792725
Epoch: 18, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.691 Vali Acc: 0.750 Test Loss: 0.691 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3720839023590088
Epoch: 19, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.778 Vali Acc: 0.767 Test Loss: 0.778 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4632070064544678
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.846 Vali Acc: 0.739 Test Loss: 0.846 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2028589248657227
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.865 Vali Acc: 0.783 Test Loss: 0.865 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783325).  Saving model ...
Epoch: 22 cost time: 1.2973120212554932
Epoch: 22, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.758 Vali Acc: 0.767 Test Loss: 0.758 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2692782878875732
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.823 Vali Acc: 0.756 Test Loss: 0.823 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2693746089935303
Epoch: 24, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.840 Vali Acc: 0.767 Test Loss: 0.840 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1769344806671143
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.822 Vali Acc: 0.750 Test Loss: 0.822 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2745487689971924
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2174694538116455
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.854 Vali Acc: 0.750 Test Loss: 0.854 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2207427024841309
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.866 Vali Acc: 0.756 Test Loss: 0.866 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.211069107055664
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.901 Vali Acc: 0.744 Test Loss: 0.901 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2942650318145752
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.850 Vali Acc: 0.772 Test Loss: 0.850 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2818512916564941
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.921 Vali Acc: 0.744 Test Loss: 0.921 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 72710
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3793728351593018
Epoch: 1, Steps: 12 | Train Loss: 1.882 Vali Loss: 1.681 Vali Acc: 0.222 Test Loss: 1.681 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 0.8193180561065674
Epoch: 2, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.320 Vali Acc: 0.489 Test Loss: 1.320 Test Acc: 0.489
Validation loss decreased (-0.222205 --> -0.488876).  Saving model ...
Epoch: 3 cost time: 0.8038835525512695
Epoch: 3, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.061 Vali Acc: 0.578 Test Loss: 1.061 Test Acc: 0.578
Validation loss decreased (-0.488876 --> -0.577767).  Saving model ...
Epoch: 4 cost time: 0.7538249492645264
Epoch: 4, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.947 Vali Acc: 0.611 Test Loss: 0.947 Test Acc: 0.611
Validation loss decreased (-0.577767 --> -0.611102).  Saving model ...
Epoch: 5 cost time: 0.8080856800079346
Epoch: 5, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.832 Vali Acc: 0.650 Test Loss: 0.832 Test Acc: 0.650
Validation loss decreased (-0.611102 --> -0.649992).  Saving model ...
Epoch: 6 cost time: 0.8623521327972412
Epoch: 6, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.745 Vali Acc: 0.683 Test Loss: 0.745 Test Acc: 0.683
Validation loss decreased (-0.649992 --> -0.683326).  Saving model ...
Epoch: 7 cost time: 0.8965234756469727
Epoch: 7, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.687 Vali Acc: 0.711 Test Loss: 0.687 Test Acc: 0.711
Validation loss decreased (-0.683326 --> -0.711104).  Saving model ...
Epoch: 8 cost time: 0.9086799621582031
Epoch: 8, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.688 Vali Acc: 0.744 Test Loss: 0.688 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 0.8302035331726074
Epoch: 9, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.643 Vali Acc: 0.744 Test Loss: 0.643 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 10 cost time: 0.8088905811309814
Epoch: 10, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.634 Vali Acc: 0.739 Test Loss: 0.634 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8909053802490234
Epoch: 11, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.652 Vali Acc: 0.728 Test Loss: 0.652 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7949464321136475
Epoch: 12, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.640 Vali Acc: 0.733 Test Loss: 0.640 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9136879444122314
Epoch: 13, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.621 Vali Acc: 0.744 Test Loss: 0.621 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 14 cost time: 0.8026013374328613
Epoch: 14, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.684 Vali Acc: 0.722 Test Loss: 0.684 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.837273120880127
Epoch: 15, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.657 Vali Acc: 0.756 Test Loss: 0.657 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 16 cost time: 0.7632596492767334
Epoch: 16, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.678 Vali Acc: 0.722 Test Loss: 0.678 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7640087604522705
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.704 Vali Acc: 0.744 Test Loss: 0.704 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7655024528503418
Epoch: 18, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.676 Vali Acc: 0.744 Test Loss: 0.676 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7914843559265137
Epoch: 19, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.678 Vali Acc: 0.750 Test Loss: 0.678 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7695298194885254
Epoch: 20, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.730 Vali Acc: 0.722 Test Loss: 0.730 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8198018074035645
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.709 Vali Acc: 0.739 Test Loss: 0.709 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8548586368560791
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.711 Vali Acc: 0.756 Test Loss: 0.711 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9010214805603027
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.701 Vali Acc: 0.756 Test Loss: 0.701 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8910617828369141
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.730 Vali Acc: 0.744 Test Loss: 0.730 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9273979663848877
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.748 Vali Acc: 0.761 Test Loss: 0.748 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 26 cost time: 0.8498656749725342
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.745 Vali Acc: 0.728 Test Loss: 0.745 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8976278305053711
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.763 Vali Acc: 0.744 Test Loss: 0.763 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8913333415985107
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8607630729675293
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.791 Vali Acc: 0.739 Test Loss: 0.791 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7869107723236084
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.785 Vali Acc: 0.772 Test Loss: 0.785 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772214).  Saving model ...
Epoch: 31 cost time: 0.8754844665527344
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.781 Vali Acc: 0.756 Test Loss: 0.781 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8705539703369141
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.818 Vali Acc: 0.767 Test Loss: 0.818 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.807171106338501
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.828 Vali Acc: 0.744 Test Loss: 0.828 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8593704700469971
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.829 Vali Acc: 0.733 Test Loss: 0.829 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8401956558227539
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.839 Vali Acc: 0.744 Test Loss: 0.839 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9197571277618408
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8703551292419434
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.834 Vali Acc: 0.750 Test Loss: 0.834 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8273694515228271
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.849 Vali Acc: 0.739 Test Loss: 0.849 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8412678241729736
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.861 Vali Acc: 0.744 Test Loss: 0.861 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8597304821014404
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.857 Vali Acc: 0.733 Test Loss: 0.857 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 54374
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.383289098739624
Epoch: 1, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.700 Vali Acc: 0.222 Test Loss: 1.700 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 0.8884255886077881
Epoch: 2, Steps: 12 | Train Loss: 1.575 Vali Loss: 1.379 Vali Acc: 0.483 Test Loss: 1.379 Test Acc: 0.483
Validation loss decreased (-0.222205 --> -0.483320).  Saving model ...
Epoch: 3 cost time: 0.8707787990570068
Epoch: 3, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.125 Vali Acc: 0.556 Test Loss: 1.125 Test Acc: 0.556
Validation loss decreased (-0.483320 --> -0.555544).  Saving model ...
Epoch: 4 cost time: 0.9017603397369385
Epoch: 4, Steps: 12 | Train Loss: 0.962 Vali Loss: 0.971 Vali Acc: 0.611 Test Loss: 0.971 Test Acc: 0.611
Validation loss decreased (-0.555544 --> -0.611101).  Saving model ...
Epoch: 5 cost time: 0.7800400257110596
Epoch: 5, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.876 Vali Acc: 0.656 Test Loss: 0.876 Test Acc: 0.656
Validation loss decreased (-0.611101 --> -0.655547).  Saving model ...
Epoch: 6 cost time: 0.83601975440979
Epoch: 6, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.784 Vali Acc: 0.689 Test Loss: 0.784 Test Acc: 0.689
Validation loss decreased (-0.655547 --> -0.688881).  Saving model ...
Epoch: 7 cost time: 0.8414971828460693
Epoch: 7, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.714 Vali Acc: 0.733 Test Loss: 0.714 Test Acc: 0.733
Validation loss decreased (-0.688881 --> -0.733326).  Saving model ...
Epoch: 8 cost time: 0.8868458271026611
Epoch: 8, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.683 Vali Acc: 0.733 Test Loss: 0.683 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 0.8921761512756348
Epoch: 9, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.667 Vali Acc: 0.728 Test Loss: 0.667 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7353761196136475
Epoch: 10, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.637 Vali Acc: 0.722 Test Loss: 0.637 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8545775413513184
Epoch: 11, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.630 Vali Acc: 0.750 Test Loss: 0.630 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 0.8558166027069092
Epoch: 12, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.614 Vali Acc: 0.728 Test Loss: 0.614 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7891695499420166
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.636 Vali Acc: 0.750 Test Loss: 0.636 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.873319149017334
Epoch: 14, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.635 Vali Acc: 0.733 Test Loss: 0.635 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8691182136535645
Epoch: 15, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.615 Vali Acc: 0.761 Test Loss: 0.615 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761105).  Saving model ...
Epoch: 16 cost time: 0.8312222957611084
Epoch: 16, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.628 Vali Acc: 0.756 Test Loss: 0.628 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8659789562225342
Epoch: 17, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.646 Vali Acc: 0.739 Test Loss: 0.646 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8152852058410645
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.650 Vali Acc: 0.761 Test Loss: 0.650 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8134481906890869
Epoch: 19, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.665 Vali Acc: 0.772 Test Loss: 0.665 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772216).  Saving model ...
Epoch: 20 cost time: 0.8406887054443359
Epoch: 20, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.685 Vali Acc: 0.744 Test Loss: 0.685 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8144283294677734
Epoch: 21, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.716 Vali Acc: 0.739 Test Loss: 0.716 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8205058574676514
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.708 Vali Acc: 0.750 Test Loss: 0.708 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8557868003845215
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.685 Vali Acc: 0.750 Test Loss: 0.685 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8336567878723145
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.735 Vali Acc: 0.733 Test Loss: 0.735 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8236145973205566
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.738 Vali Acc: 0.756 Test Loss: 0.738 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7976303100585938
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.743 Vali Acc: 0.750 Test Loss: 0.743 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7992708683013916
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.737 Vali Acc: 0.744 Test Loss: 0.737 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9025101661682129
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.735 Vali Acc: 0.761 Test Loss: 0.735 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9162795543670654
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.758 Vali Acc: 0.756 Test Loss: 0.758 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm32_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 49830
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.532317638397217
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.435 Vali Acc: 0.422 Test Loss: 1.435 Test Acc: 0.422
Validation loss decreased (inf --> -0.422208).  Saving model ...
Epoch: 2 cost time: 1.095888614654541
Epoch: 2, Steps: 12 | Train Loss: 1.197 Vali Loss: 0.944 Vali Acc: 0.606 Test Loss: 0.944 Test Acc: 0.606
Validation loss decreased (-0.422208 --> -0.605546).  Saving model ...
Epoch: 3 cost time: 1.1293237209320068
Epoch: 3, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.739 Vali Acc: 0.689 Test Loss: 0.739 Test Acc: 0.689
Validation loss decreased (-0.605546 --> -0.688881).  Saving model ...
Epoch: 4 cost time: 1.132096529006958
Epoch: 4, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.695 Vali Acc: 0.706 Test Loss: 0.695 Test Acc: 0.706
Validation loss decreased (-0.688881 --> -0.705549).  Saving model ...
Epoch: 5 cost time: 1.1387836933135986
Epoch: 5, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.675 Vali Acc: 0.733 Test Loss: 0.675 Test Acc: 0.733
Validation loss decreased (-0.705549 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 1.1205317974090576
Epoch: 6, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.753 Vali Acc: 0.689 Test Loss: 0.753 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1323590278625488
Epoch: 7, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.673 Vali Acc: 0.750 Test Loss: 0.673 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 1.1183998584747314
Epoch: 8, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.761 Vali Acc: 0.761 Test Loss: 0.761 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761104).  Saving model ...
Epoch: 9 cost time: 1.1705081462860107
Epoch: 9, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.592 Vali Acc: 0.772 Test Loss: 0.592 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772216).  Saving model ...
Epoch: 10 cost time: 1.18910813331604
Epoch: 10, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.649 Vali Acc: 0.756 Test Loss: 0.649 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.170898199081421
Epoch: 11, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.675 Vali Acc: 0.767 Test Loss: 0.675 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1372044086456299
Epoch: 12, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.877 Vali Acc: 0.722 Test Loss: 0.877 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.15753173828125
Epoch: 13, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.715 Vali Acc: 0.778 Test Loss: 0.715 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777771).  Saving model ...
Epoch: 14 cost time: 1.1077501773834229
Epoch: 14, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.925 Vali Acc: 0.750 Test Loss: 0.925 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.258915662765503
Epoch: 15, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.758 Vali Acc: 0.761 Test Loss: 0.758 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.023822546005249
Epoch: 16, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.806 Vali Acc: 0.756 Test Loss: 0.806 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0734472274780273
Epoch: 17, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.776 Vali Acc: 0.767 Test Loss: 0.776 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0712018013000488
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.809 Vali Acc: 0.761 Test Loss: 0.809 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.051828145980835
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.805 Vali Acc: 0.772 Test Loss: 0.805 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.104705810546875
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.806 Vali Acc: 0.750 Test Loss: 0.806 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1835706233978271
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.805 Vali Acc: 0.756 Test Loss: 0.805 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0989031791687012
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.800 Vali Acc: 0.772 Test Loss: 0.800 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.072756290435791
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.821 Vali Acc: 0.756 Test Loss: 0.821 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 136806
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3623907566070557
Epoch: 1, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.619 Vali Acc: 0.311 Test Loss: 1.619 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 0.9788739681243896
Epoch: 2, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.094 Vali Acc: 0.611 Test Loss: 1.094 Test Acc: 0.611
Validation loss decreased (-0.311095 --> -0.611100).  Saving model ...
Epoch: 3 cost time: 0.9707226753234863
Epoch: 3, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.854 Vali Acc: 0.667 Test Loss: 0.854 Test Acc: 0.667
Validation loss decreased (-0.611100 --> -0.666658).  Saving model ...
Epoch: 4 cost time: 1.0335166454315186
Epoch: 4, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.719 Vali Acc: 0.694 Test Loss: 0.719 Test Acc: 0.694
Validation loss decreased (-0.666658 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 1.007542371749878
Epoch: 5, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.639 Vali Acc: 0.722 Test Loss: 0.639 Test Acc: 0.722
Validation loss decreased (-0.694437 --> -0.722216).  Saving model ...
Epoch: 6 cost time: 1.0448312759399414
Epoch: 6, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.601 Vali Acc: 0.739 Test Loss: 0.601 Test Acc: 0.739
Validation loss decreased (-0.722216 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 1.0708248615264893
Epoch: 7, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.0665733814239502
Epoch: 8, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.640 Vali Acc: 0.728 Test Loss: 0.640 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9917879104614258
Epoch: 9, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.668 Vali Acc: 0.744 Test Loss: 0.668 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.008082628250122
Epoch: 10, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.611 Vali Acc: 0.739 Test Loss: 0.611 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0496201515197754
Epoch: 11, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.625 Vali Acc: 0.739 Test Loss: 0.625 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9805445671081543
Epoch: 12, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.656 Vali Acc: 0.739 Test Loss: 0.656 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9653587341308594
Epoch: 13, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.661 Vali Acc: 0.739 Test Loss: 0.661 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9778451919555664
Epoch: 14, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.646 Vali Acc: 0.750 Test Loss: 0.646 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0465023517608643
Epoch: 15, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.753 Vali Acc: 0.739 Test Loss: 0.753 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9490582942962646
Epoch: 16, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.725 Vali Acc: 0.750 Test Loss: 0.725 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9067332744598389
Epoch: 17, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.740 Vali Acc: 0.767 Test Loss: 0.740 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766659).  Saving model ...
Epoch: 18 cost time: 0.9624276161193848
Epoch: 18, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.805 Vali Acc: 0.756 Test Loss: 0.805 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0179364681243896
Epoch: 19, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.762 Vali Acc: 0.761 Test Loss: 0.762 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9891974925994873
Epoch: 20, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.755 Vali Acc: 0.744 Test Loss: 0.755 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0284993648529053
Epoch: 21, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.766 Vali Acc: 0.761 Test Loss: 0.766 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0290958881378174
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.779 Vali Acc: 0.750 Test Loss: 0.779 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9830069541931152
Epoch: 23, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.774 Vali Acc: 0.750 Test Loss: 0.774 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9672181606292725
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.781 Vali Acc: 0.744 Test Loss: 0.781 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.040834903717041
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.787 Vali Acc: 0.761 Test Loss: 0.787 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0413401126861572
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.786 Vali Acc: 0.756 Test Loss: 0.786 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9900479316711426
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.812 Vali Acc: 0.739 Test Loss: 0.812 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 79222
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.466796875
Epoch: 1, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.627 Vali Acc: 0.317 Test Loss: 1.627 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 1.000040054321289
Epoch: 2, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.201 Vali Acc: 0.572 Test Loss: 1.201 Test Acc: 0.572
Validation loss decreased (-0.316650 --> -0.572210).  Saving model ...
Epoch: 3 cost time: 1.0690202713012695
Epoch: 3, Steps: 12 | Train Loss: 1.009 Vali Loss: 0.953 Vali Acc: 0.617 Test Loss: 0.953 Test Acc: 0.617
Validation loss decreased (-0.572210 --> -0.616657).  Saving model ...
Epoch: 4 cost time: 1.0910625457763672
Epoch: 4, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.814 Vali Acc: 0.633 Test Loss: 0.814 Test Acc: 0.633
Validation loss decreased (-0.616657 --> -0.633325).  Saving model ...
Epoch: 5 cost time: 0.95265793800354
Epoch: 5, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.728 Vali Acc: 0.667 Test Loss: 0.728 Test Acc: 0.667
Validation loss decreased (-0.633325 --> -0.666659).  Saving model ...
Epoch: 6 cost time: 1.0122392177581787
Epoch: 6, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.648 Vali Acc: 0.750 Test Loss: 0.648 Test Acc: 0.750
Validation loss decreased (-0.666659 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.0235497951507568
Epoch: 7, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.701 Vali Acc: 0.733 Test Loss: 0.701 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9467072486877441
Epoch: 8, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.622 Vali Acc: 0.739 Test Loss: 0.622 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0413329601287842
Epoch: 9, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.664 Vali Acc: 0.733 Test Loss: 0.664 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9888238906860352
Epoch: 10, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.578 Vali Acc: 0.767 Test Loss: 0.578 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766661).  Saving model ...
Epoch: 11 cost time: 1.0089733600616455
Epoch: 11, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.683 Vali Acc: 0.728 Test Loss: 0.683 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.009354591369629
Epoch: 12, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.702 Vali Acc: 0.756 Test Loss: 0.702 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0324959754943848
Epoch: 13, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.670 Vali Acc: 0.750 Test Loss: 0.670 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.053126573562622
Epoch: 14, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.671 Vali Acc: 0.733 Test Loss: 0.671 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.020883321762085
Epoch: 15, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.641 Vali Acc: 0.761 Test Loss: 0.641 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1096513271331787
Epoch: 16, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.694 Vali Acc: 0.767 Test Loss: 0.694 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9803211688995361
Epoch: 17, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.723 Vali Acc: 0.772 Test Loss: 0.723 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772215).  Saving model ...
Epoch: 18 cost time: 1.01741361618042
Epoch: 18, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.744 Vali Acc: 0.761 Test Loss: 0.744 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0016975402832031
Epoch: 19, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.722 Vali Acc: 0.761 Test Loss: 0.722 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9866907596588135
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.729 Vali Acc: 0.772 Test Loss: 0.729 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9874551296234131
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.761 Vali Acc: 0.761 Test Loss: 0.761 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0667154788970947
Epoch: 22, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.746 Vali Acc: 0.767 Test Loss: 0.746 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0374836921691895
Epoch: 23, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.759 Vali Acc: 0.778 Test Loss: 0.759 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 24 cost time: 0.9958591461181641
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.770 Vali Acc: 0.756 Test Loss: 0.770 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0389835834503174
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.758 Vali Acc: 0.761 Test Loss: 0.758 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0167052745819092
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.752 Vali Acc: 0.767 Test Loss: 0.752 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9938108921051025
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.767 Vali Acc: 0.761 Test Loss: 0.767 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9853990077972412
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.774 Vali Acc: 0.761 Test Loss: 0.774 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.074000358581543
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.790 Vali Acc: 0.761 Test Loss: 0.790 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0329179763793945
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0884699821472168
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.770 Vali Acc: 0.778 Test Loss: 0.770 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0825512409210205
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.776 Vali Acc: 0.767 Test Loss: 0.776 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0237250328063965
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.798 Vali Acc: 0.767 Test Loss: 0.798 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 76934
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2272796630859375
Epoch: 1, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.587 Vali Acc: 0.411 Test Loss: 1.587 Test Acc: 0.411
Validation loss decreased (inf --> -0.411095).  Saving model ...
Epoch: 2 cost time: 0.8903002738952637
Epoch: 2, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.222 Vali Acc: 0.600 Test Loss: 1.222 Test Acc: 0.600
Validation loss decreased (-0.411095 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 0.8041238784790039
Epoch: 3, Steps: 12 | Train Loss: 1.081 Vali Loss: 0.979 Vali Acc: 0.628 Test Loss: 0.979 Test Acc: 0.628
Validation loss decreased (-0.599988 --> -0.627768).  Saving model ...
Epoch: 4 cost time: 0.8366696834564209
Epoch: 4, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.847 Vali Acc: 0.633 Test Loss: 0.847 Test Acc: 0.633
Validation loss decreased (-0.627768 --> -0.633325).  Saving model ...
Epoch: 5 cost time: 0.8170902729034424
Epoch: 5, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.726 Vali Acc: 0.694 Test Loss: 0.726 Test Acc: 0.694
Validation loss decreased (-0.633325 --> -0.694437).  Saving model ...
Epoch: 6 cost time: 0.876305103302002
Epoch: 6, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.673 Vali Acc: 0.711 Test Loss: 0.673 Test Acc: 0.711
Validation loss decreased (-0.694437 --> -0.711104).  Saving model ...
Epoch: 7 cost time: 0.8927745819091797
Epoch: 7, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.653 Vali Acc: 0.728 Test Loss: 0.653 Test Acc: 0.728
Validation loss decreased (-0.711104 --> -0.727771).  Saving model ...
Epoch: 8 cost time: 0.9142343997955322
Epoch: 8, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.595 Vali Acc: 0.739 Test Loss: 0.595 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 9 cost time: 0.919008731842041
Epoch: 9, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 0.8230700492858887
Epoch: 10, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.582 Vali Acc: 0.767 Test Loss: 0.582 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766661).  Saving model ...
Epoch: 11 cost time: 0.8764572143554688
Epoch: 11, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.609 Vali Acc: 0.739 Test Loss: 0.609 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9097845554351807
Epoch: 12, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.599 Vali Acc: 0.733 Test Loss: 0.599 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8580265045166016
Epoch: 13, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.615 Vali Acc: 0.739 Test Loss: 0.615 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9162547588348389
Epoch: 14, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9004414081573486
Epoch: 15, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.608 Vali Acc: 0.750 Test Loss: 0.608 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8753769397735596
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.633 Vali Acc: 0.756 Test Loss: 0.633 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8470580577850342
Epoch: 17, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.614 Vali Acc: 0.761 Test Loss: 0.614 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8290839195251465
Epoch: 18, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.634 Vali Acc: 0.744 Test Loss: 0.634 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8521409034729004
Epoch: 19, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.624 Vali Acc: 0.750 Test Loss: 0.624 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8502819538116455
Epoch: 20, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.672 Vali Acc: 0.756 Test Loss: 0.672 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 58534
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.087738513946533
Epoch: 1, Steps: 12 | Train Loss: 1.905 Vali Loss: 1.692 Vali Acc: 0.322 Test Loss: 1.692 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 0.7878472805023193
Epoch: 2, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.410 Vali Acc: 0.517 Test Loss: 1.410 Test Acc: 0.517
Validation loss decreased (-0.322205 --> -0.516653).  Saving model ...
Epoch: 3 cost time: 0.7606964111328125
Epoch: 3, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.132 Vali Acc: 0.578 Test Loss: 1.132 Test Acc: 0.578
Validation loss decreased (-0.516653 --> -0.577766).  Saving model ...
Epoch: 4 cost time: 0.7800390720367432
Epoch: 4, Steps: 12 | Train Loss: 0.999 Vali Loss: 0.979 Vali Acc: 0.611 Test Loss: 0.979 Test Acc: 0.611
Validation loss decreased (-0.577766 --> -0.611101).  Saving model ...
Epoch: 5 cost time: 0.785395622253418
Epoch: 5, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.863 Vali Acc: 0.656 Test Loss: 0.863 Test Acc: 0.656
Validation loss decreased (-0.611101 --> -0.655547).  Saving model ...
Epoch: 6 cost time: 0.7969064712524414
Epoch: 6, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.788 Vali Acc: 0.678 Test Loss: 0.788 Test Acc: 0.678
Validation loss decreased (-0.655547 --> -0.677770).  Saving model ...
Epoch: 7 cost time: 0.8290927410125732
Epoch: 7, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.760 Vali Acc: 0.706 Test Loss: 0.760 Test Acc: 0.706
Validation loss decreased (-0.677770 --> -0.705548).  Saving model ...
Epoch: 8 cost time: 0.8235018253326416
Epoch: 8, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.673 Vali Acc: 0.728 Test Loss: 0.673 Test Acc: 0.728
Validation loss decreased (-0.705548 --> -0.727771).  Saving model ...
Epoch: 9 cost time: 0.766331672668457
Epoch: 9, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.660 Vali Acc: 0.739 Test Loss: 0.660 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738882).  Saving model ...
Epoch: 10 cost time: 0.8024494647979736
Epoch: 10, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.655 Vali Acc: 0.750 Test Loss: 0.655 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 0.8122255802154541
Epoch: 11, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.637 Vali Acc: 0.744 Test Loss: 0.637 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.906494140625
Epoch: 12, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.610 Vali Acc: 0.756 Test Loss: 0.610 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 13 cost time: 0.705477237701416
Epoch: 13, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.649 Vali Acc: 0.733 Test Loss: 0.649 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8372220993041992
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.649 Vali Acc: 0.728 Test Loss: 0.649 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8163607120513916
Epoch: 15, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.625 Vali Acc: 0.733 Test Loss: 0.625 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7690134048461914
Epoch: 16, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.650 Vali Acc: 0.739 Test Loss: 0.650 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.828955888748169
Epoch: 17, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.679 Vali Acc: 0.728 Test Loss: 0.679 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7985272407531738
Epoch: 18, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7606241703033447
Epoch: 19, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.646 Vali Acc: 0.739 Test Loss: 0.646 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7913331985473633
Epoch: 20, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.662 Vali Acc: 0.744 Test Loss: 0.662 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8043296337127686
Epoch: 21, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.682 Vali Acc: 0.733 Test Loss: 0.682 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8354594707489014
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.686 Vali Acc: 0.744 Test Loss: 0.686 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 47046
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4725096225738525
Epoch: 1, Steps: 12 | Train Loss: 1.956 Vali Loss: 1.858 Vali Acc: 0.200 Test Loss: 1.858 Test Acc: 0.200
Validation loss decreased (inf --> -0.199981).  Saving model ...
Epoch: 2 cost time: 0.7884306907653809
Epoch: 2, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.605 Vali Acc: 0.372 Test Loss: 1.605 Test Acc: 0.372
Validation loss decreased (-0.199981 --> -0.372206).  Saving model ...
Epoch: 3 cost time: 0.8186793327331543
Epoch: 3, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.359 Vali Acc: 0.489 Test Loss: 1.359 Test Acc: 0.489
Validation loss decreased (-0.372206 --> -0.488875).  Saving model ...
Epoch: 4 cost time: 0.8254609107971191
Epoch: 4, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.164 Vali Acc: 0.544 Test Loss: 1.164 Test Acc: 0.544
Validation loss decreased (-0.488875 --> -0.544433).  Saving model ...
Epoch: 5 cost time: 0.863060474395752
Epoch: 5, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.043 Vali Acc: 0.589 Test Loss: 1.043 Test Acc: 0.589
Validation loss decreased (-0.544433 --> -0.588878).  Saving model ...
Epoch: 6 cost time: 0.825110912322998
Epoch: 6, Steps: 12 | Train Loss: 0.915 Vali Loss: 0.929 Vali Acc: 0.606 Test Loss: 0.929 Test Acc: 0.606
Validation loss decreased (-0.588878 --> -0.605546).  Saving model ...
Epoch: 7 cost time: 0.8177399635314941
Epoch: 7, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.868 Vali Acc: 0.639 Test Loss: 0.868 Test Acc: 0.639
Validation loss decreased (-0.605546 --> -0.638880).  Saving model ...
Epoch: 8 cost time: 0.8386075496673584
Epoch: 8, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.810 Vali Acc: 0.650 Test Loss: 0.810 Test Acc: 0.650
Validation loss decreased (-0.638880 --> -0.649992).  Saving model ...
Epoch: 9 cost time: 0.7653892040252686
Epoch: 9, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.742 Vali Acc: 0.678 Test Loss: 0.742 Test Acc: 0.678
Validation loss decreased (-0.649992 --> -0.677770).  Saving model ...
Epoch: 10 cost time: 0.7834830284118652
Epoch: 10, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.719 Vali Acc: 0.700 Test Loss: 0.719 Test Acc: 0.700
Validation loss decreased (-0.677770 --> -0.699993).  Saving model ...
Epoch: 11 cost time: 0.7885518074035645
Epoch: 11, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.706 Vali Acc: 0.728 Test Loss: 0.706 Test Acc: 0.728
Validation loss decreased (-0.699993 --> -0.727771).  Saving model ...
Epoch: 12 cost time: 0.7930440902709961
Epoch: 12, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.695 Vali Acc: 0.706 Test Loss: 0.695 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8114407062530518
Epoch: 13, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.653 Vali Acc: 0.750 Test Loss: 0.653 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 0.8257100582122803
Epoch: 14, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8719239234924316
Epoch: 15, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8072488307952881
Epoch: 16, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.645 Vali Acc: 0.733 Test Loss: 0.645 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7738590240478516
Epoch: 17, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 18 cost time: 0.8190522193908691
Epoch: 18, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.656 Vali Acc: 0.722 Test Loss: 0.656 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9222674369812012
Epoch: 19, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.622 Vali Acc: 0.739 Test Loss: 0.622 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7947428226470947
Epoch: 20, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.647 Vali Acc: 0.728 Test Loss: 0.647 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8060932159423828
Epoch: 21, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.674 Vali Acc: 0.728 Test Loss: 0.674 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7698509693145752
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.661 Vali Acc: 0.744 Test Loss: 0.661 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7598340511322021
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.672 Vali Acc: 0.722 Test Loss: 0.672 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7794709205627441
Epoch: 24, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.675 Vali Acc: 0.722 Test Loss: 0.675 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8550972938537598
Epoch: 25, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.698 Vali Acc: 0.733 Test Loss: 0.698 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8460323810577393
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.684 Vali Acc: 0.717 Test Loss: 0.684 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.72540283203125
Epoch: 27, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.685 Vali Acc: 0.733 Test Loss: 0.685 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.75
model parameter : 37878
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.230109930038452
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.774 Vali Acc: 0.222 Test Loss: 1.774 Test Acc: 0.222
Validation loss decreased (inf --> -0.222204).  Saving model ...
Epoch: 2 cost time: 0.7612028121948242
Epoch: 2, Steps: 12 | Train Loss: 1.660 Vali Loss: 1.580 Vali Acc: 0.411 Test Loss: 1.580 Test Acc: 0.411
Validation loss decreased (-0.222204 --> -0.411095).  Saving model ...
Epoch: 3 cost time: 0.8159477710723877
Epoch: 3, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.366 Vali Acc: 0.528 Test Loss: 1.366 Test Acc: 0.528
Validation loss decreased (-0.411095 --> -0.527764).  Saving model ...
Epoch: 4 cost time: 0.8158445358276367
Epoch: 4, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.184 Vali Acc: 0.550 Test Loss: 1.184 Test Acc: 0.550
Validation loss decreased (-0.527764 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.7656779289245605
Epoch: 5, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.048 Vali Acc: 0.594 Test Loss: 1.048 Test Acc: 0.594
Validation loss decreased (-0.549988 --> -0.594434).  Saving model ...
Epoch: 6 cost time: 0.749755859375
Epoch: 6, Steps: 12 | Train Loss: 0.922 Vali Loss: 0.934 Vali Acc: 0.633 Test Loss: 0.934 Test Acc: 0.633
Validation loss decreased (-0.594434 --> -0.633324).  Saving model ...
Epoch: 7 cost time: 0.7253797054290771
Epoch: 7, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.858 Vali Acc: 0.661 Test Loss: 0.858 Test Acc: 0.661
Validation loss decreased (-0.633324 --> -0.661103).  Saving model ...
Epoch: 8 cost time: 0.8027365207672119
Epoch: 8, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.808 Vali Acc: 0.672 Test Loss: 0.808 Test Acc: 0.672
Validation loss decreased (-0.661103 --> -0.672214).  Saving model ...
Epoch: 9 cost time: 0.8171987533569336
Epoch: 9, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.749 Vali Acc: 0.694 Test Loss: 0.749 Test Acc: 0.694
Validation loss decreased (-0.672214 --> -0.694437).  Saving model ...
Epoch: 10 cost time: 0.826869010925293
Epoch: 10, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.708 Vali Acc: 0.711 Test Loss: 0.708 Test Acc: 0.711
Validation loss decreased (-0.694437 --> -0.711104).  Saving model ...
Epoch: 11 cost time: 0.7999789714813232
Epoch: 11, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.677 Vali Acc: 0.739 Test Loss: 0.677 Test Acc: 0.739
Validation loss decreased (-0.711104 --> -0.738882).  Saving model ...
Epoch: 12 cost time: 0.8814175128936768
Epoch: 12, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.666 Vali Acc: 0.722 Test Loss: 0.666 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7691266536712646
Epoch: 13, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.638 Vali Acc: 0.722 Test Loss: 0.638 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7704892158508301
Epoch: 14, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.618 Vali Acc: 0.728 Test Loss: 0.618 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7935118675231934
Epoch: 15, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.597 Vali Acc: 0.728 Test Loss: 0.597 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7415330410003662
Epoch: 16, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.606 Vali Acc: 0.739 Test Loss: 0.606 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738883).  Saving model ...
Epoch: 17 cost time: 0.7271318435668945
Epoch: 17, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.596 Vali Acc: 0.767 Test Loss: 0.596 Test Acc: 0.767
Validation loss decreased (-0.738883 --> -0.766661).  Saving model ...
Epoch: 18 cost time: 0.8329224586486816
Epoch: 18, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.603 Vali Acc: 0.739 Test Loss: 0.603 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8258240222930908
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.593 Vali Acc: 0.750 Test Loss: 0.593 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8268318176269531
Epoch: 20, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.594 Vali Acc: 0.744 Test Loss: 0.594 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7965936660766602
Epoch: 21, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.586 Vali Acc: 0.767 Test Loss: 0.586 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766661).  Saving model ...
Epoch: 22 cost time: 0.8071157932281494
Epoch: 22, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8149561882019043
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.609 Vali Acc: 0.761 Test Loss: 0.609 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8281011581420898
Epoch: 24, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.607 Vali Acc: 0.761 Test Loss: 0.607 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8227047920227051
Epoch: 25, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.595 Vali Acc: 0.761 Test Loss: 0.595 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7572011947631836
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.633 Vali Acc: 0.772 Test Loss: 0.633 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 27 cost time: 0.8132438659667969
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.636 Vali Acc: 0.772 Test Loss: 0.636 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7911818027496338
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.653 Vali Acc: 0.761 Test Loss: 0.653 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5997531414031982
Epoch: 29, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.626 Vali Acc: 0.767 Test Loss: 0.626 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8272354602813721
Epoch: 30, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7579617500305176
Epoch: 31, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.670 Vali Acc: 0.761 Test Loss: 0.670 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7700631618499756
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.620 Vali Acc: 0.772 Test Loss: 0.620 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772216).  Saving model ...
Epoch: 33 cost time: 0.7460055351257324
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.634 Vali Acc: 0.772 Test Loss: 0.634 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8715465068817139
Epoch: 34, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.654 Vali Acc: 0.761 Test Loss: 0.654 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7850847244262695
Epoch: 35, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.667 Vali Acc: 0.767 Test Loss: 0.667 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7892587184906006
Epoch: 36, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.675 Vali Acc: 0.772 Test Loss: 0.675 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8427078723907471
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8060452938079834
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.663 Vali Acc: 0.767 Test Loss: 0.663 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7977161407470703
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.671 Vali Acc: 0.772 Test Loss: 0.671 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8077466487884521
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.692 Vali Acc: 0.767 Test Loss: 0.692 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.803706169128418
Epoch: 41, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.692 Vali Acc: 0.772 Test Loss: 0.692 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7780108451843262
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.669 Vali Acc: 0.767 Test Loss: 0.669 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 35606
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6630077362060547
Epoch: 1, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.640 Vali Acc: 0.372 Test Loss: 1.640 Test Acc: 0.372
Validation loss decreased (inf --> -0.372206).  Saving model ...
Epoch: 2 cost time: 1.0133955478668213
Epoch: 2, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.021 Vali Acc: 0.583 Test Loss: 1.021 Test Acc: 0.583
Validation loss decreased (-0.372206 --> -0.583323).  Saving model ...
Epoch: 3 cost time: 1.0385284423828125
Epoch: 3, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.879 Vali Acc: 0.617 Test Loss: 0.879 Test Acc: 0.617
Validation loss decreased (-0.583323 --> -0.616658).  Saving model ...
Epoch: 4 cost time: 1.0434918403625488
Epoch: 4, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.634 Vali Acc: 0.722 Test Loss: 0.634 Test Acc: 0.722
Validation loss decreased (-0.616658 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 1.0495407581329346
Epoch: 5, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.630 Vali Acc: 0.722 Test Loss: 0.630 Test Acc: 0.722
Validation loss decreased (-0.722216 --> -0.722216).  Saving model ...
Epoch: 6 cost time: 1.0090832710266113
Epoch: 6, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.649 Vali Acc: 0.717 Test Loss: 0.649 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.993661642074585
Epoch: 7, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.638 Vali Acc: 0.756 Test Loss: 0.638 Test Acc: 0.756
Validation loss decreased (-0.722216 --> -0.755549).  Saving model ...
Epoch: 8 cost time: 1.0103552341461182
Epoch: 8, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.738 Vali Acc: 0.756 Test Loss: 0.738 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.103668451309204
Epoch: 9, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.723 Vali Acc: 0.744 Test Loss: 0.723 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.015491247177124
Epoch: 10, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.963 Vali Acc: 0.739 Test Loss: 0.963 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9980528354644775
Epoch: 11, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.719 Vali Acc: 0.739 Test Loss: 0.719 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9970786571502686
Epoch: 12, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.714 Vali Acc: 0.761 Test Loss: 0.714 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 13 cost time: 1.0906922817230225
Epoch: 13, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.669 Vali Acc: 0.761 Test Loss: 0.669 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761104).  Saving model ...
Epoch: 14 cost time: 1.0229201316833496
Epoch: 14, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.769 Vali Acc: 0.756 Test Loss: 0.769 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0456695556640625
Epoch: 15, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.986 Vali Acc: 0.772 Test Loss: 0.986 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772212).  Saving model ...
Epoch: 16 cost time: 1.0885083675384521
Epoch: 16, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.768 Vali Acc: 0.744 Test Loss: 0.768 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1749131679534912
Epoch: 17, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.826 Vali Acc: 0.756 Test Loss: 0.826 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.043147087097168
Epoch: 18, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.888 Vali Acc: 0.756 Test Loss: 0.888 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9385409355163574
Epoch: 19, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.890 Vali Acc: 0.750 Test Loss: 0.890 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0096104145050049
Epoch: 20, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.854 Vali Acc: 0.750 Test Loss: 0.854 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1409149169921875
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.840 Vali Acc: 0.761 Test Loss: 0.840 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.077479362487793
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.851 Vali Acc: 0.761 Test Loss: 0.851 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2081694602966309
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.885 Vali Acc: 0.772 Test Loss: 0.885 Test Acc: 0.772
Validation loss decreased (-0.772212 --> -0.772213).  Saving model ...
Epoch: 24 cost time: 1.025386095046997
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.875 Vali Acc: 0.750 Test Loss: 0.875 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9673871994018555
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.894 Vali Acc: 0.778 Test Loss: 0.894 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777769).  Saving model ...
Epoch: 26 cost time: 0.828615665435791
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.879 Vali Acc: 0.756 Test Loss: 0.879 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8498733043670654
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.756 Test Loss: 0.891 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8156790733337402
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.756 Test Loss: 0.906 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8364298343658447
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.908 Vali Acc: 0.750 Test Loss: 0.908 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7819786071777344
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.756 Test Loss: 0.906 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.733597993850708
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.761 Test Loss: 0.906 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7328100204467773
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.750 Test Loss: 0.917 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7863674163818359
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.756 Test Loss: 0.916 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7829456329345703
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.928 Vali Acc: 0.772 Test Loss: 0.928 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8159966468811035
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.767 Test Loss: 0.926 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 128358
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3707659244537354
Epoch: 1, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.562 Vali Acc: 0.372 Test Loss: 1.562 Test Acc: 0.372
Validation loss decreased (inf --> -0.372207).  Saving model ...
Epoch: 2 cost time: 0.9537563323974609
Epoch: 2, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.121 Vali Acc: 0.578 Test Loss: 1.121 Test Acc: 0.578
Validation loss decreased (-0.372207 --> -0.577767).  Saving model ...
Epoch: 3 cost time: 0.8620808124542236
Epoch: 3, Steps: 12 | Train Loss: 0.973 Vali Loss: 0.907 Vali Acc: 0.606 Test Loss: 0.907 Test Acc: 0.606
Validation loss decreased (-0.577767 --> -0.605546).  Saving model ...
Epoch: 4 cost time: 0.8482506275177002
Epoch: 4, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.812 Vali Acc: 0.650 Test Loss: 0.812 Test Acc: 0.650
Validation loss decreased (-0.605546 --> -0.649992).  Saving model ...
Epoch: 5 cost time: 0.9334466457366943
Epoch: 5, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.658 Vali Acc: 0.711 Test Loss: 0.658 Test Acc: 0.711
Validation loss decreased (-0.649992 --> -0.711105).  Saving model ...
Epoch: 6 cost time: 0.9166462421417236
Epoch: 6, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.637 Vali Acc: 0.717 Test Loss: 0.637 Test Acc: 0.717
Validation loss decreased (-0.711105 --> -0.716660).  Saving model ...
Epoch: 7 cost time: 1.0207321643829346
Epoch: 7, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.616 Vali Acc: 0.700 Test Loss: 0.616 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9531347751617432
Epoch: 8, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (-0.716660 --> -0.716661).  Saving model ...
Epoch: 9 cost time: 0.9170262813568115
Epoch: 9, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
Validation loss decreased (-0.716661 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.0091469287872314
Epoch: 10, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.634 Vali Acc: 0.733 Test Loss: 0.634 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9740333557128906
Epoch: 11, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.624 Vali Acc: 0.722 Test Loss: 0.624 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9836487770080566
Epoch: 12, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.643 Vali Acc: 0.744 Test Loss: 0.643 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9851727485656738
Epoch: 13, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.677 Vali Acc: 0.744 Test Loss: 0.677 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0747473239898682
Epoch: 14, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.717 Vali Acc: 0.722 Test Loss: 0.717 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9628534317016602
Epoch: 15, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.674 Vali Acc: 0.739 Test Loss: 0.674 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.944434404373169
Epoch: 16, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.761 Vali Acc: 0.750 Test Loss: 0.761 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0838661193847656
Epoch: 17, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.736 Vali Acc: 0.744 Test Loss: 0.736 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9429900646209717
Epoch: 18, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.795 Vali Acc: 0.756 Test Loss: 0.795 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755548).  Saving model ...
Epoch: 19 cost time: 0.9945600032806396
Epoch: 19, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.766 Vali Acc: 0.733 Test Loss: 0.766 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9064195156097412
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.784 Vali Acc: 0.756 Test Loss: 0.784 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 21 cost time: 0.9959316253662109
Epoch: 21, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.762 Vali Acc: 0.756 Test Loss: 0.762 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 22 cost time: 0.9783761501312256
Epoch: 22, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.762 Vali Acc: 0.756 Test Loss: 0.762 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 23 cost time: 0.9177896976470947
Epoch: 23, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.739 Vali Acc: 0.750 Test Loss: 0.739 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9453585147857666
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.766 Vali Acc: 0.750 Test Loss: 0.766 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9678487777709961
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.784 Vali Acc: 0.750 Test Loss: 0.784 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9806373119354248
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.784 Vali Acc: 0.756 Test Loss: 0.784 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9399981498718262
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.797 Vali Acc: 0.750 Test Loss: 0.797 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9122076034545898
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.804 Vali Acc: 0.744 Test Loss: 0.804 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9434571266174316
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.992006778717041
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.803 Vali Acc: 0.750 Test Loss: 0.803 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9494733810424805
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.813 Vali Acc: 0.744 Test Loss: 0.813 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9656379222869873
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.812 Vali Acc: 0.750 Test Loss: 0.812 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 70774
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5433692932128906
Epoch: 1, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.573 Vali Acc: 0.428 Test Loss: 1.573 Test Acc: 0.428
Validation loss decreased (inf --> -0.427762).  Saving model ...
Epoch: 2 cost time: 0.9224836826324463
Epoch: 2, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.183 Vali Acc: 0.578 Test Loss: 1.183 Test Acc: 0.578
Validation loss decreased (-0.427762 --> -0.577766).  Saving model ...
Epoch: 3 cost time: 0.8698606491088867
Epoch: 3, Steps: 12 | Train Loss: 0.973 Vali Loss: 0.891 Vali Acc: 0.656 Test Loss: 0.891 Test Acc: 0.656
Validation loss decreased (-0.577766 --> -0.655547).  Saving model ...
Epoch: 4 cost time: 0.9118883609771729
Epoch: 4, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.816 Vali Acc: 0.656 Test Loss: 0.816 Test Acc: 0.656
Validation loss decreased (-0.655547 --> -0.655547).  Saving model ...
Epoch: 5 cost time: 0.9642622470855713
Epoch: 5, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.712 Vali Acc: 0.700 Test Loss: 0.712 Test Acc: 0.700
Validation loss decreased (-0.655547 --> -0.699993).  Saving model ...
Epoch: 6 cost time: 0.9352502822875977
Epoch: 6, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.670 Vali Acc: 0.694 Test Loss: 0.670 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9351053237915039
Epoch: 7, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.696 Vali Acc: 0.717 Test Loss: 0.696 Test Acc: 0.717
Validation loss decreased (-0.699993 --> -0.716660).  Saving model ...
Epoch: 8 cost time: 0.8585605621337891
Epoch: 8, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.623 Vali Acc: 0.728 Test Loss: 0.623 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727772).  Saving model ...
Epoch: 9 cost time: 0.8716094493865967
Epoch: 9, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.601 Vali Acc: 0.756 Test Loss: 0.601 Test Acc: 0.756
Validation loss decreased (-0.727772 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 0.8437654972076416
Epoch: 10, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.714 Vali Acc: 0.739 Test Loss: 0.714 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8727524280548096
Epoch: 11, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.624 Vali Acc: 0.761 Test Loss: 0.624 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761105).  Saving model ...
Epoch: 12 cost time: 1.0270378589630127
Epoch: 12, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.577 Vali Acc: 0.756 Test Loss: 0.577 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9161872863769531
Epoch: 13, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9429388046264648
Epoch: 14, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.674 Vali Acc: 0.739 Test Loss: 0.674 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8799731731414795
Epoch: 15, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.613 Vali Acc: 0.756 Test Loss: 0.613 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8867766857147217
Epoch: 16, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.724 Vali Acc: 0.739 Test Loss: 0.724 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9548099040985107
Epoch: 17, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.722 Vali Acc: 0.761 Test Loss: 0.722 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8636820316314697
Epoch: 18, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.736 Vali Acc: 0.756 Test Loss: 0.736 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8715381622314453
Epoch: 19, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.704 Vali Acc: 0.767 Test Loss: 0.704 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 20 cost time: 0.8916194438934326
Epoch: 20, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.689 Vali Acc: 0.767 Test Loss: 0.689 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 21 cost time: 0.8976109027862549
Epoch: 21, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.737 Vali Acc: 0.767 Test Loss: 0.737 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9472100734710693
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.737 Vali Acc: 0.783 Test Loss: 0.737 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783326).  Saving model ...
Epoch: 23 cost time: 0.9306366443634033
Epoch: 23, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.749 Vali Acc: 0.778 Test Loss: 0.749 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9448220729827881
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.814 Vali Acc: 0.772 Test Loss: 0.814 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.926567554473877
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.732 Vali Acc: 0.778 Test Loss: 0.732 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0059735774993896
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.736 Vali Acc: 0.772 Test Loss: 0.736 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8772227764129639
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.757 Vali Acc: 0.772 Test Loss: 0.757 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.940269947052002
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.786 Vali Acc: 0.783 Test Loss: 0.786 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9272599220275879
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.789 Vali Acc: 0.778 Test Loss: 0.789 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9005284309387207
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.768 Vali Acc: 0.783 Test Loss: 0.768 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9136877059936523
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.791 Vali Acc: 0.772 Test Loss: 0.791 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9256496429443359
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.806 Vali Acc: 0.772 Test Loss: 0.806 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 68486
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.44313907623291
Epoch: 1, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.548 Vali Acc: 0.433 Test Loss: 1.548 Test Acc: 0.433
Validation loss decreased (inf --> -0.433318).  Saving model ...
Epoch: 2 cost time: 0.8019042015075684
Epoch: 2, Steps: 12 | Train Loss: 1.407 Vali Loss: 1.213 Vali Acc: 0.611 Test Loss: 1.213 Test Acc: 0.611
Validation loss decreased (-0.433318 --> -0.611099).  Saving model ...
Epoch: 3 cost time: 0.7827332019805908
Epoch: 3, Steps: 12 | Train Loss: 1.092 Vali Loss: 0.954 Vali Acc: 0.633 Test Loss: 0.954 Test Acc: 0.633
Validation loss decreased (-0.611099 --> -0.633324).  Saving model ...
Epoch: 4 cost time: 0.7850565910339355
Epoch: 4, Steps: 12 | Train Loss: 0.912 Vali Loss: 0.848 Vali Acc: 0.672 Test Loss: 0.848 Test Acc: 0.672
Validation loss decreased (-0.633324 --> -0.672214).  Saving model ...
Epoch: 5 cost time: 0.7973875999450684
Epoch: 5, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.755 Vali Acc: 0.672 Test Loss: 0.755 Test Acc: 0.672
Validation loss decreased (-0.672214 --> -0.672215).  Saving model ...
Epoch: 6 cost time: 0.8020117282867432
Epoch: 6, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.668 Vali Acc: 0.756 Test Loss: 0.668 Test Acc: 0.756
Validation loss decreased (-0.672215 --> -0.755549).  Saving model ...
Epoch: 7 cost time: 0.8374543190002441
Epoch: 7, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.619 Vali Acc: 0.772 Test Loss: 0.619 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772216).  Saving model ...
Epoch: 8 cost time: 0.8216037750244141
Epoch: 8, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8564088344573975
Epoch: 9, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 0.8119173049926758
Epoch: 10, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.607 Vali Acc: 0.761 Test Loss: 0.607 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7997972965240479
Epoch: 11, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.564 Vali Acc: 0.772 Test Loss: 0.564 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7868554592132568
Epoch: 12, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.562 Vali Acc: 0.756 Test Loss: 0.562 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7561631202697754
Epoch: 13, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.593 Vali Acc: 0.778 Test Loss: 0.593 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.763948917388916
Epoch: 14, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.601 Vali Acc: 0.772 Test Loss: 0.601 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.847423791885376
Epoch: 15, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.600 Vali Acc: 0.778 Test Loss: 0.600 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7857308387756348
Epoch: 16, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.611 Vali Acc: 0.778 Test Loss: 0.611 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8547694683074951
Epoch: 17, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.561 Vali Acc: 0.778 Test Loss: 0.561 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8684492111206055
Epoch: 18, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.601 Vali Acc: 0.767 Test Loss: 0.601 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.818352460861206
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.607 Vali Acc: 0.778 Test Loss: 0.607 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 50086
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.301151752471924
Epoch: 1, Steps: 12 | Train Loss: 1.849 Vali Loss: 1.701 Vali Acc: 0.289 Test Loss: 1.701 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 0.7846238613128662
Epoch: 2, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.397 Vali Acc: 0.528 Test Loss: 1.397 Test Acc: 0.528
Validation loss decreased (-0.288872 --> -0.527764).  Saving model ...
Epoch: 3 cost time: 0.9278638362884521
Epoch: 3, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.118 Vali Acc: 0.583 Test Loss: 1.118 Test Acc: 0.583
Validation loss decreased (-0.527764 --> -0.583322).  Saving model ...
Epoch: 4 cost time: 0.7587783336639404
Epoch: 4, Steps: 12 | Train Loss: 1.024 Vali Loss: 0.971 Vali Acc: 0.617 Test Loss: 0.971 Test Acc: 0.617
Validation loss decreased (-0.583322 --> -0.616657).  Saving model ...
Epoch: 5 cost time: 0.8043897151947021
Epoch: 5, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.888 Vali Acc: 0.644 Test Loss: 0.888 Test Acc: 0.644
Validation loss decreased (-0.616657 --> -0.644436).  Saving model ...
Epoch: 6 cost time: 0.7819466590881348
Epoch: 6, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.810 Vali Acc: 0.667 Test Loss: 0.810 Test Acc: 0.667
Validation loss decreased (-0.644436 --> -0.666659).  Saving model ...
Epoch: 7 cost time: 0.7546772956848145
Epoch: 7, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.724 Vali Acc: 0.694 Test Loss: 0.724 Test Acc: 0.694
Validation loss decreased (-0.666659 --> -0.694437).  Saving model ...
Epoch: 8 cost time: 0.7740559577941895
Epoch: 8, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.721 Vali Acc: 0.722 Test Loss: 0.721 Test Acc: 0.722
Validation loss decreased (-0.694437 --> -0.722215).  Saving model ...
Epoch: 9 cost time: 0.8329911231994629
Epoch: 9, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.686 Vali Acc: 0.717 Test Loss: 0.686 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.799375057220459
Epoch: 10, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.649 Vali Acc: 0.728 Test Loss: 0.649 Test Acc: 0.728
Validation loss decreased (-0.722215 --> -0.727771).  Saving model ...
Epoch: 11 cost time: 0.7755022048950195
Epoch: 11, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.650 Vali Acc: 0.733 Test Loss: 0.650 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 12 cost time: 0.7817752361297607
Epoch: 12, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.643 Vali Acc: 0.722 Test Loss: 0.643 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8013277053833008
Epoch: 13, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.641 Vali Acc: 0.728 Test Loss: 0.641 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8533163070678711
Epoch: 14, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.820462703704834
Epoch: 15, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.640 Vali Acc: 0.739 Test Loss: 0.640 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738882).  Saving model ...
Epoch: 16 cost time: 0.7410242557525635
Epoch: 16, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.645 Vali Acc: 0.722 Test Loss: 0.645 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7003383636474609
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.668 Vali Acc: 0.750 Test Loss: 0.668 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749993).  Saving model ...
Epoch: 18 cost time: 0.7467494010925293
Epoch: 18, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.657 Vali Acc: 0.744 Test Loss: 0.657 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6807160377502441
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.675 Vali Acc: 0.739 Test Loss: 0.675 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7200479507446289
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.694 Vali Acc: 0.733 Test Loss: 0.694 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.726893424987793
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.698 Vali Acc: 0.750 Test Loss: 0.698 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.738821268081665
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.678 Vali Acc: 0.750 Test Loss: 0.678 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7477264404296875
Epoch: 23, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.706 Vali Acc: 0.744 Test Loss: 0.706 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7501258850097656
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.697 Vali Acc: 0.756 Test Loss: 0.697 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 25 cost time: 0.7264008522033691
Epoch: 25, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.748 Vali Acc: 0.756 Test Loss: 0.748 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7861812114715576
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.716 Vali Acc: 0.761 Test Loss: 0.716 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 27 cost time: 0.7766108512878418
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.727 Vali Acc: 0.750 Test Loss: 0.727 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.757117748260498
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.732 Vali Acc: 0.756 Test Loss: 0.732 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7657217979431152
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.747 Vali Acc: 0.733 Test Loss: 0.747 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7417080402374268
Epoch: 30, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.749 Vali Acc: 0.744 Test Loss: 0.749 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7810273170471191
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7777395248413086
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.755 Vali Acc: 0.750 Test Loss: 0.755 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7438528537750244
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.730 Vali Acc: 0.750 Test Loss: 0.730 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9017529487609863
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.741 Vali Acc: 0.756 Test Loss: 0.741 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7717394828796387
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.775 Vali Acc: 0.728 Test Loss: 0.775 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7589635848999023
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.801 Vali Acc: 0.733 Test Loss: 0.801 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 38598
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3345680236816406
Epoch: 1, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.726 Vali Acc: 0.289 Test Loss: 1.726 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 0.7440788745880127
Epoch: 2, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.508 Vali Acc: 0.428 Test Loss: 1.508 Test Acc: 0.428
Validation loss decreased (-0.288872 --> -0.427763).  Saving model ...
Epoch: 3 cost time: 0.7661688327789307
Epoch: 3, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.284 Vali Acc: 0.522 Test Loss: 1.284 Test Acc: 0.522
Validation loss decreased (-0.427763 --> -0.522209).  Saving model ...
Epoch: 4 cost time: 0.7464900016784668
Epoch: 4, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.107 Vali Acc: 0.572 Test Loss: 1.107 Test Acc: 0.572
Validation loss decreased (-0.522209 --> -0.572211).  Saving model ...
Epoch: 5 cost time: 0.8249595165252686
Epoch: 5, Steps: 12 | Train Loss: 0.982 Vali Loss: 0.998 Vali Acc: 0.594 Test Loss: 0.998 Test Acc: 0.594
Validation loss decreased (-0.572211 --> -0.594434).  Saving model ...
Epoch: 6 cost time: 0.7511694431304932
Epoch: 6, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.911 Vali Acc: 0.611 Test Loss: 0.911 Test Acc: 0.611
Validation loss decreased (-0.594434 --> -0.611102).  Saving model ...
Epoch: 7 cost time: 0.7236778736114502
Epoch: 7, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.838 Vali Acc: 0.667 Test Loss: 0.838 Test Acc: 0.667
Validation loss decreased (-0.611102 --> -0.666658).  Saving model ...
Epoch: 8 cost time: 0.8303792476654053
Epoch: 8, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.786 Vali Acc: 0.650 Test Loss: 0.786 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7841410636901855
Epoch: 9, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.746 Vali Acc: 0.661 Test Loss: 0.746 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7381026744842529
Epoch: 10, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.719 Vali Acc: 0.700 Test Loss: 0.719 Test Acc: 0.700
Validation loss decreased (-0.666658 --> -0.699993).  Saving model ...
Epoch: 11 cost time: 0.7615804672241211
Epoch: 11, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.705 Vali Acc: 0.717 Test Loss: 0.705 Test Acc: 0.717
Validation loss decreased (-0.699993 --> -0.716660).  Saving model ...
Epoch: 12 cost time: 0.7866473197937012
Epoch: 12, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.681 Vali Acc: 0.717 Test Loss: 0.681 Test Acc: 0.717
Validation loss decreased (-0.716660 --> -0.716660).  Saving model ...
Epoch: 13 cost time: 0.8248193264007568
Epoch: 13, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.668 Vali Acc: 0.711 Test Loss: 0.668 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7836394309997559
Epoch: 14, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.700 Vali Acc: 0.744 Test Loss: 0.700 Test Acc: 0.744
Validation loss decreased (-0.716660 --> -0.744437).  Saving model ...
Epoch: 15 cost time: 0.7456066608428955
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.648 Vali Acc: 0.728 Test Loss: 0.648 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8536992073059082
Epoch: 16, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.670 Vali Acc: 0.733 Test Loss: 0.670 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7257442474365234
Epoch: 17, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.651 Vali Acc: 0.728 Test Loss: 0.651 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7483584880828857
Epoch: 18, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.663 Vali Acc: 0.728 Test Loss: 0.663 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7344520092010498
Epoch: 19, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.666 Vali Acc: 0.722 Test Loss: 0.666 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7645723819732666
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.670 Vali Acc: 0.744 Test Loss: 0.670 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744438).  Saving model ...
Epoch: 21 cost time: 0.7355055809020996
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.682 Vali Acc: 0.722 Test Loss: 0.682 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7476437091827393
Epoch: 22, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.673 Vali Acc: 0.728 Test Loss: 0.673 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7656979560852051
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.693 Vali Acc: 0.733 Test Loss: 0.693 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8154764175415039
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.670 Vali Acc: 0.739 Test Loss: 0.670 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7280232906341553
Epoch: 25, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.678 Vali Acc: 0.733 Test Loss: 0.678 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8207368850708008
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.703 Vali Acc: 0.744 Test Loss: 0.703 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7580487728118896
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.704 Vali Acc: 0.728 Test Loss: 0.704 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7246568202972412
Epoch: 28, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.727 Vali Acc: 0.733 Test Loss: 0.727 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7451672554016113
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.702 Vali Acc: 0.744 Test Loss: 0.702 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.80615234375
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.758 Vali Acc: 0.733 Test Loss: 0.758 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 29430
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2318344116210938
Epoch: 1, Steps: 12 | Train Loss: 1.906 Vali Loss: 1.723 Vali Acc: 0.278 Test Loss: 1.723 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 0.8112661838531494
Epoch: 2, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.513 Vali Acc: 0.500 Test Loss: 1.513 Test Acc: 0.500
Validation loss decreased (-0.277761 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 0.7629344463348389
Epoch: 3, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.309 Vali Acc: 0.539 Test Loss: 1.309 Test Acc: 0.539
Validation loss decreased (-0.499985 --> -0.538876).  Saving model ...
Epoch: 4 cost time: 0.8029398918151855
Epoch: 4, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.143 Vali Acc: 0.583 Test Loss: 1.143 Test Acc: 0.583
Validation loss decreased (-0.538876 --> -0.583322).  Saving model ...
Epoch: 5 cost time: 0.8655591011047363
Epoch: 5, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.029 Vali Acc: 0.628 Test Loss: 1.029 Test Acc: 0.628
Validation loss decreased (-0.583322 --> -0.627767).  Saving model ...
Epoch: 6 cost time: 0.8222887516021729
Epoch: 6, Steps: 12 | Train Loss: 0.951 Vali Loss: 0.947 Vali Acc: 0.650 Test Loss: 0.947 Test Acc: 0.650
Validation loss decreased (-0.627767 --> -0.649991).  Saving model ...
Epoch: 7 cost time: 0.7932031154632568
Epoch: 7, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.850 Vali Acc: 0.661 Test Loss: 0.850 Test Acc: 0.661
Validation loss decreased (-0.649991 --> -0.661103).  Saving model ...
Epoch: 8 cost time: 0.8220562934875488
Epoch: 8, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.780 Vali Acc: 0.700 Test Loss: 0.780 Test Acc: 0.700
Validation loss decreased (-0.661103 --> -0.699992).  Saving model ...
Epoch: 9 cost time: 0.8135876655578613
Epoch: 9, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.754 Vali Acc: 0.700 Test Loss: 0.754 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 10 cost time: 0.7362127304077148
Epoch: 10, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.703 Vali Acc: 0.722 Test Loss: 0.703 Test Acc: 0.722
Validation loss decreased (-0.699992 --> -0.722215).  Saving model ...
Epoch: 11 cost time: 0.7550258636474609
Epoch: 11, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.675 Vali Acc: 0.722 Test Loss: 0.675 Test Acc: 0.722
Validation loss decreased (-0.722215 --> -0.722215).  Saving model ...
Epoch: 12 cost time: 0.7909762859344482
Epoch: 12, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.649 Vali Acc: 0.750 Test Loss: 0.649 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 0.7363252639770508
Epoch: 13, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.640 Vali Acc: 0.756 Test Loss: 0.640 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 0.7722592353820801
Epoch: 14, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.606 Vali Acc: 0.767 Test Loss: 0.606 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766661).  Saving model ...
Epoch: 15 cost time: 0.8995730876922607
Epoch: 15, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
Validation loss decreased (-0.766661 --> -0.783328).  Saving model ...
Epoch: 16 cost time: 0.8640916347503662
Epoch: 16, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.594 Vali Acc: 0.783 Test Loss: 0.594 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.839634895324707
Epoch: 17, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788883).  Saving model ...
Epoch: 18 cost time: 0.8002142906188965
Epoch: 18, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7707600593566895
Epoch: 19, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.584 Vali Acc: 0.761 Test Loss: 0.584 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8123259544372559
Epoch: 20, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.601 Vali Acc: 0.772 Test Loss: 0.601 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8560962677001953
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 22 cost time: 0.8493444919586182
Epoch: 22, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.586 Vali Acc: 0.772 Test Loss: 0.586 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8691394329071045
Epoch: 23, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.582 Vali Acc: 0.778 Test Loss: 0.582 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8891041278839111
Epoch: 24, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8417172431945801
Epoch: 25, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.627 Vali Acc: 0.761 Test Loss: 0.627 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9432897567749023
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8123288154602051
Epoch: 27, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.609 Vali Acc: 0.794 Test Loss: 0.609 Test Acc: 0.794
Validation loss decreased (-0.788883 --> -0.794438).  Saving model ...
Epoch: 28 cost time: 0.8469007015228271
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.623 Vali Acc: 0.794 Test Loss: 0.623 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8694057464599609
Epoch: 29, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.633 Vali Acc: 0.761 Test Loss: 0.633 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7893450260162354
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8239963054656982
Epoch: 31, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8391337394714355
Epoch: 32, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8654146194458008
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.615 Vali Acc: 0.783 Test Loss: 0.615 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.826453685760498
Epoch: 34, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.652 Vali Acc: 0.783 Test Loss: 0.652 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8731424808502197
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.651 Vali Acc: 0.789 Test Loss: 0.651 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.860175371170044
Epoch: 36, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8302593231201172
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.647 Vali Acc: 0.772 Test Loss: 0.647 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 27158
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9524106979370117
Epoch: 1, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.449 Vali Acc: 0.506 Test Loss: 1.449 Test Acc: 0.506
Validation loss decreased (inf --> -0.505541).  Saving model ...
Epoch: 2 cost time: 1.2159419059753418
Epoch: 2, Steps: 12 | Train Loss: 1.185 Vali Loss: 0.959 Vali Acc: 0.589 Test Loss: 0.959 Test Acc: 0.589
Validation loss decreased (-0.505541 --> -0.588879).  Saving model ...
Epoch: 3 cost time: 1.4278724193572998
Epoch: 3, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.772 Vali Acc: 0.711 Test Loss: 0.772 Test Acc: 0.711
Validation loss decreased (-0.588879 --> -0.711103).  Saving model ...
Epoch: 4 cost time: 1.3660917282104492
Epoch: 4, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.631 Vali Acc: 0.728 Test Loss: 0.631 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 1.4045755863189697
Epoch: 5, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.809 Vali Acc: 0.706 Test Loss: 0.809 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2804453372955322
Epoch: 6, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.599 Vali Acc: 0.761 Test Loss: 0.599 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 1.3695590496063232
Epoch: 7, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.678 Vali Acc: 0.733 Test Loss: 0.678 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4502973556518555
Epoch: 8, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.638 Vali Acc: 0.744 Test Loss: 0.638 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3842768669128418
Epoch: 9, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.887 Vali Acc: 0.706 Test Loss: 0.887 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.412421464920044
Epoch: 10, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.633 Vali Acc: 0.733 Test Loss: 0.633 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5295991897583008
Epoch: 11, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.853 Vali Acc: 0.739 Test Loss: 0.853 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4767394065856934
Epoch: 12, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.013 Vali Acc: 0.728 Test Loss: 1.013 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.296966314315796
Epoch: 13, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.812 Vali Acc: 0.733 Test Loss: 0.812 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3590152263641357
Epoch: 14, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.793 Vali Acc: 0.756 Test Loss: 0.793 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.452453374862671
Epoch: 15, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4392385482788086
Epoch: 16, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.904 Vali Acc: 0.756 Test Loss: 0.904 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 124134
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.141183376312256
Epoch: 1, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.565 Vali Acc: 0.383 Test Loss: 1.565 Test Acc: 0.383
Validation loss decreased (inf --> -0.383318).  Saving model ...
Epoch: 2 cost time: 1.3645381927490234
Epoch: 2, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.109 Vali Acc: 0.617 Test Loss: 1.109 Test Acc: 0.617
Validation loss decreased (-0.383318 --> -0.616656).  Saving model ...
Epoch: 3 cost time: 1.3570232391357422
Epoch: 3, Steps: 12 | Train Loss: 0.985 Vali Loss: 0.903 Vali Acc: 0.622 Test Loss: 0.903 Test Acc: 0.622
Validation loss decreased (-0.616656 --> -0.622213).  Saving model ...
Epoch: 4 cost time: 1.306056022644043
Epoch: 4, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.778 Vali Acc: 0.650 Test Loss: 0.778 Test Acc: 0.650
Validation loss decreased (-0.622213 --> -0.649992).  Saving model ...
Epoch: 5 cost time: 1.2863564491271973
Epoch: 5, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.702 Vali Acc: 0.700 Test Loss: 0.702 Test Acc: 0.700
Validation loss decreased (-0.649992 --> -0.699993).  Saving model ...
Epoch: 6 cost time: 1.3450243473052979
Epoch: 6, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.656 Vali Acc: 0.706 Test Loss: 0.656 Test Acc: 0.706
Validation loss decreased (-0.699993 --> -0.705549).  Saving model ...
Epoch: 7 cost time: 1.4942901134490967
Epoch: 7, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.620 Vali Acc: 0.728 Test Loss: 0.620 Test Acc: 0.728
Validation loss decreased (-0.705549 --> -0.727772).  Saving model ...
Epoch: 8 cost time: 1.4295845031738281
Epoch: 8, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.645 Vali Acc: 0.728 Test Loss: 0.645 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3718764781951904
Epoch: 9, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.634 Vali Acc: 0.744 Test Loss: 0.634 Test Acc: 0.744
Validation loss decreased (-0.727772 --> -0.744438).  Saving model ...
Epoch: 10 cost time: 1.3754441738128662
Epoch: 10, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.635 Vali Acc: 0.739 Test Loss: 0.635 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3980903625488281
Epoch: 11, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.670 Vali Acc: 0.728 Test Loss: 0.670 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4146943092346191
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.615 Vali Acc: 0.750 Test Loss: 0.615 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.3726179599761963
Epoch: 13, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.434711217880249
Epoch: 14, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.719 Vali Acc: 0.739 Test Loss: 0.719 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4655768871307373
Epoch: 15, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.674 Vali Acc: 0.767 Test Loss: 0.674 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766660).  Saving model ...
Epoch: 16 cost time: 1.4778978824615479
Epoch: 16, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.757 Vali Acc: 0.750 Test Loss: 0.757 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5199792385101318
Epoch: 17, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.724 Vali Acc: 0.756 Test Loss: 0.724 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4297783374786377
Epoch: 18, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.443037509918213
Epoch: 19, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.717 Vali Acc: 0.761 Test Loss: 0.717 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5849008560180664
Epoch: 20, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.849 Vali Acc: 0.761 Test Loss: 0.849 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4251999855041504
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.433910608291626
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.856 Vali Acc: 0.767 Test Loss: 0.856 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4074089527130127
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.826 Vali Acc: 0.750 Test Loss: 0.826 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.584256649017334
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.855 Vali Acc: 0.744 Test Loss: 0.855 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4901847839355469
Epoch: 25, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.851 Vali Acc: 0.756 Test Loss: 0.851 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 66550
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8325278759002686
Epoch: 1, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.573 Vali Acc: 0.383 Test Loss: 1.573 Test Acc: 0.383
Validation loss decreased (inf --> -0.383318).  Saving model ...
Epoch: 2 cost time: 1.5323748588562012
Epoch: 2, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.157 Vali Acc: 0.572 Test Loss: 1.157 Test Acc: 0.572
Validation loss decreased (-0.383318 --> -0.572211).  Saving model ...
Epoch: 3 cost time: 1.2627906799316406
Epoch: 3, Steps: 12 | Train Loss: 1.075 Vali Loss: 0.966 Vali Acc: 0.600 Test Loss: 0.966 Test Acc: 0.600
Validation loss decreased (-0.572211 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 1.4054017066955566
Epoch: 4, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.820 Vali Acc: 0.650 Test Loss: 0.820 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649992).  Saving model ...
Epoch: 5 cost time: 1.3660995960235596
Epoch: 5, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.779 Vali Acc: 0.661 Test Loss: 0.779 Test Acc: 0.661
Validation loss decreased (-0.649992 --> -0.661103).  Saving model ...
Epoch: 6 cost time: 1.3845489025115967
Epoch: 6, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.695 Vali Acc: 0.706 Test Loss: 0.695 Test Acc: 0.706
Validation loss decreased (-0.661103 --> -0.705549).  Saving model ...
Epoch: 7 cost time: 1.5179028511047363
Epoch: 7, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.634 Vali Acc: 0.722 Test Loss: 0.634 Test Acc: 0.722
Validation loss decreased (-0.705549 --> -0.722216).  Saving model ...
Epoch: 8 cost time: 1.5080409049987793
Epoch: 8, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.631 Vali Acc: 0.750 Test Loss: 0.631 Test Acc: 0.750
Validation loss decreased (-0.722216 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.4125561714172363
Epoch: 9, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.627 Vali Acc: 0.733 Test Loss: 0.627 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3339612483978271
Epoch: 10, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.725 Vali Acc: 0.728 Test Loss: 0.725 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3674471378326416
Epoch: 11, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.616 Vali Acc: 0.778 Test Loss: 0.616 Test Acc: 0.778
Validation loss decreased (-0.749994 --> -0.777772).  Saving model ...
Epoch: 12 cost time: 1.3627023696899414
Epoch: 12, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.730 Vali Acc: 0.767 Test Loss: 0.730 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.442852258682251
Epoch: 13, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.671 Vali Acc: 0.739 Test Loss: 0.671 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6932933330535889
Epoch: 14, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.633 Vali Acc: 0.756 Test Loss: 0.633 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5222296714782715
Epoch: 15, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.657 Vali Acc: 0.756 Test Loss: 0.657 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3228743076324463
Epoch: 16, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.694 Vali Acc: 0.767 Test Loss: 0.694 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3576970100402832
Epoch: 17, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.655 Vali Acc: 0.761 Test Loss: 0.655 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3287224769592285
Epoch: 18, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.695 Vali Acc: 0.750 Test Loss: 0.695 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5228185653686523
Epoch: 19, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.692 Vali Acc: 0.750 Test Loss: 0.692 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5292370319366455
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3839635848999023
Epoch: 21, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.741 Vali Acc: 0.756 Test Loss: 0.741 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 64262
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3957226276397705
Epoch: 1, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.712 Vali Acc: 0.261 Test Loss: 1.712 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 0.8286793231964111
Epoch: 2, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.337 Vali Acc: 0.506 Test Loss: 1.337 Test Acc: 0.506
Validation loss decreased (-0.261094 --> -0.505542).  Saving model ...
Epoch: 3 cost time: 0.907191276550293
Epoch: 3, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.046 Vali Acc: 0.583 Test Loss: 1.046 Test Acc: 0.583
Validation loss decreased (-0.505542 --> -0.583323).  Saving model ...
Epoch: 4 cost time: 0.8620035648345947
Epoch: 4, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.868 Vali Acc: 0.611 Test Loss: 0.868 Test Acc: 0.611
Validation loss decreased (-0.583323 --> -0.611102).  Saving model ...
Epoch: 5 cost time: 0.7235510349273682
Epoch: 5, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.754 Vali Acc: 0.672 Test Loss: 0.754 Test Acc: 0.672
Validation loss decreased (-0.611102 --> -0.672215).  Saving model ...
Epoch: 6 cost time: 0.9237644672393799
Epoch: 6, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.691 Vali Acc: 0.678 Test Loss: 0.691 Test Acc: 0.678
Validation loss decreased (-0.672215 --> -0.677771).  Saving model ...
Epoch: 7 cost time: 0.7452361583709717
Epoch: 7, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.641 Vali Acc: 0.717 Test Loss: 0.641 Test Acc: 0.717
Validation loss decreased (-0.677771 --> -0.716660).  Saving model ...
Epoch: 8 cost time: 0.8350775241851807
Epoch: 8, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.607 Vali Acc: 0.761 Test Loss: 0.607 Test Acc: 0.761
Validation loss decreased (-0.716660 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 0.8517043590545654
Epoch: 9, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.611 Vali Acc: 0.750 Test Loss: 0.611 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.724865198135376
Epoch: 10, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.574 Vali Acc: 0.756 Test Loss: 0.574 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.780315637588501
Epoch: 11, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.569 Vali Acc: 0.744 Test Loss: 0.569 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7557415962219238
Epoch: 12, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.555 Vali Acc: 0.761 Test Loss: 0.555 Test Acc: 0.761
Validation loss decreased (-0.761105 --> -0.761106).  Saving model ...
Epoch: 13 cost time: 0.7921195030212402
Epoch: 13, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.576 Vali Acc: 0.750 Test Loss: 0.576 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7833504676818848
Epoch: 14, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.627 Vali Acc: 0.744 Test Loss: 0.627 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8078484535217285
Epoch: 15, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.545 Vali Acc: 0.767 Test Loss: 0.545 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766661).  Saving model ...
Epoch: 16 cost time: 0.807379961013794
Epoch: 16, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.575 Vali Acc: 0.750 Test Loss: 0.575 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8547964096069336
Epoch: 17, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.565 Vali Acc: 0.778 Test Loss: 0.565 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777772).  Saving model ...
Epoch: 18 cost time: 0.8501439094543457
Epoch: 18, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.604 Vali Acc: 0.761 Test Loss: 0.604 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.787914514541626
Epoch: 19, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.583 Vali Acc: 0.772 Test Loss: 0.583 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8160972595214844
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.649 Vali Acc: 0.733 Test Loss: 0.649 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8343229293823242
Epoch: 21, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7327477931976318
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.634 Vali Acc: 0.767 Test Loss: 0.634 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9993140697479248
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.662 Vali Acc: 0.756 Test Loss: 0.662 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8327977657318115
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.683 Vali Acc: 0.756 Test Loss: 0.683 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7548153400421143
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.658 Vali Acc: 0.761 Test Loss: 0.658 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8295626640319824
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.660 Vali Acc: 0.767 Test Loss: 0.660 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7740919589996338
Epoch: 27, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.688 Vali Acc: 0.761 Test Loss: 0.688 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 45862
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.425117015838623
Epoch: 1, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.658 Vali Acc: 0.389 Test Loss: 1.658 Test Acc: 0.389
Validation loss decreased (inf --> -0.388872).  Saving model ...
Epoch: 2 cost time: 0.9298202991485596
Epoch: 2, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.376 Vali Acc: 0.544 Test Loss: 1.376 Test Acc: 0.544
Validation loss decreased (-0.388872 --> -0.544431).  Saving model ...
Epoch: 3 cost time: 0.7790942192077637
Epoch: 3, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.129 Vali Acc: 0.583 Test Loss: 1.129 Test Acc: 0.583
Validation loss decreased (-0.544431 --> -0.583322).  Saving model ...
Epoch: 4 cost time: 0.7581593990325928
Epoch: 4, Steps: 12 | Train Loss: 1.042 Vali Loss: 0.976 Vali Acc: 0.617 Test Loss: 0.976 Test Acc: 0.617
Validation loss decreased (-0.583322 --> -0.616657).  Saving model ...
Epoch: 5 cost time: 0.9034452438354492
Epoch: 5, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.857 Vali Acc: 0.656 Test Loss: 0.857 Test Acc: 0.656
Validation loss decreased (-0.616657 --> -0.655547).  Saving model ...
Epoch: 6 cost time: 0.8113501071929932
Epoch: 6, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.785 Vali Acc: 0.711 Test Loss: 0.785 Test Acc: 0.711
Validation loss decreased (-0.655547 --> -0.711103).  Saving model ...
Epoch: 7 cost time: 0.8358638286590576
Epoch: 7, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.739 Vali Acc: 0.706 Test Loss: 0.739 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8854031562805176
Epoch: 8, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.676 Vali Acc: 0.744 Test Loss: 0.676 Test Acc: 0.744
Validation loss decreased (-0.711103 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 0.7825660705566406
Epoch: 9, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.668 Vali Acc: 0.728 Test Loss: 0.668 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8757190704345703
Epoch: 10, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.640 Vali Acc: 0.722 Test Loss: 0.640 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8473758697509766
Epoch: 11, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.632 Vali Acc: 0.739 Test Loss: 0.632 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8143808841705322
Epoch: 12, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.627 Vali Acc: 0.722 Test Loss: 0.627 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.769381046295166
Epoch: 13, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 0.8189654350280762
Epoch: 14, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.609 Vali Acc: 0.728 Test Loss: 0.609 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8579938411712646
Epoch: 15, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.626 Vali Acc: 0.739 Test Loss: 0.626 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.867257833480835
Epoch: 16, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.588 Vali Acc: 0.733 Test Loss: 0.588 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8894779682159424
Epoch: 17, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.590 Vali Acc: 0.739 Test Loss: 0.590 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8025996685028076
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.615 Vali Acc: 0.733 Test Loss: 0.615 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8314251899719238
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.633 Vali Acc: 0.744 Test Loss: 0.633 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8163576126098633
Epoch: 20, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.617 Vali Acc: 0.744 Test Loss: 0.617 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7817902565002441
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8747282028198242
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.632 Vali Acc: 0.733 Test Loss: 0.632 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7516911029815674
Epoch: 23, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.636 Vali Acc: 0.744 Test Loss: 0.636 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 34374
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.212552309036255
Epoch: 1, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.595 Vali Acc: 0.439 Test Loss: 1.595 Test Acc: 0.439
Validation loss decreased (inf --> -0.438873).  Saving model ...
Epoch: 2 cost time: 0.7640659809112549
Epoch: 2, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.376 Vali Acc: 0.561 Test Loss: 1.376 Test Acc: 0.561
Validation loss decreased (-0.438873 --> -0.561097).  Saving model ...
Epoch: 3 cost time: 0.7238461971282959
Epoch: 3, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.163 Vali Acc: 0.600 Test Loss: 1.163 Test Acc: 0.600
Validation loss decreased (-0.561097 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 0.817913293838501
Epoch: 4, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.016 Vali Acc: 0.622 Test Loss: 1.016 Test Acc: 0.622
Validation loss decreased (-0.599988 --> -0.622212).  Saving model ...
Epoch: 5 cost time: 0.7912778854370117
Epoch: 5, Steps: 12 | Train Loss: 0.964 Vali Loss: 0.917 Vali Acc: 0.656 Test Loss: 0.917 Test Acc: 0.656
Validation loss decreased (-0.622212 --> -0.655546).  Saving model ...
Epoch: 6 cost time: 0.7464926242828369
Epoch: 6, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.849 Vali Acc: 0.672 Test Loss: 0.849 Test Acc: 0.672
Validation loss decreased (-0.655546 --> -0.672214).  Saving model ...
Epoch: 7 cost time: 0.7831339836120605
Epoch: 7, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.803 Vali Acc: 0.672 Test Loss: 0.803 Test Acc: 0.672
Validation loss decreased (-0.672214 --> -0.672214).  Saving model ...
Epoch: 8 cost time: 0.8259696960449219
Epoch: 8, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.760 Vali Acc: 0.683 Test Loss: 0.760 Test Acc: 0.683
Validation loss decreased (-0.672214 --> -0.683326).  Saving model ...
Epoch: 9 cost time: 0.8473484516143799
Epoch: 9, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.723 Vali Acc: 0.689 Test Loss: 0.723 Test Acc: 0.689
Validation loss decreased (-0.683326 --> -0.688882).  Saving model ...
Epoch: 10 cost time: 0.8110194206237793
Epoch: 10, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.683 Vali Acc: 0.722 Test Loss: 0.683 Test Acc: 0.722
Validation loss decreased (-0.688882 --> -0.722215).  Saving model ...
Epoch: 11 cost time: 0.7796318531036377
Epoch: 11, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.688 Vali Acc: 0.722 Test Loss: 0.688 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8008546829223633
Epoch: 12, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.678 Vali Acc: 0.711 Test Loss: 0.678 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8312478065490723
Epoch: 13, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.634 Vali Acc: 0.744 Test Loss: 0.634 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 14 cost time: 0.7532315254211426
Epoch: 14, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.631 Vali Acc: 0.750 Test Loss: 0.631 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 0.7926959991455078
Epoch: 15, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.617 Vali Acc: 0.744 Test Loss: 0.617 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8104739189147949
Epoch: 16, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.622 Vali Acc: 0.744 Test Loss: 0.622 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8216598033905029
Epoch: 17, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.617 Vali Acc: 0.744 Test Loss: 0.617 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.775604248046875
Epoch: 18, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8453636169433594
Epoch: 19, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.644 Vali Acc: 0.739 Test Loss: 0.644 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7693092823028564
Epoch: 20, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.640 Vali Acc: 0.739 Test Loss: 0.640 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.824101448059082
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.652 Vali Acc: 0.744 Test Loss: 0.652 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8618197441101074
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.663 Vali Acc: 0.728 Test Loss: 0.663 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7295410633087158
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.675 Vali Acc: 0.733 Test Loss: 0.675 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7758316993713379
Epoch: 24, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.660 Vali Acc: 0.744 Test Loss: 0.660 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.75
model parameter : 25206
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.335463523864746
Epoch: 1, Steps: 12 | Train Loss: 1.879 Vali Loss: 1.708 Vali Acc: 0.267 Test Loss: 1.708 Test Acc: 0.267
Validation loss decreased (inf --> -0.266650).  Saving model ...
Epoch: 2 cost time: 0.8609015941619873
Epoch: 2, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.532 Vali Acc: 0.372 Test Loss: 1.532 Test Acc: 0.372
Validation loss decreased (-0.266650 --> -0.372207).  Saving model ...
Epoch: 3 cost time: 0.8294098377227783
Epoch: 3, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.342 Vali Acc: 0.444 Test Loss: 1.342 Test Acc: 0.444
Validation loss decreased (-0.372207 --> -0.444431).  Saving model ...
Epoch: 4 cost time: 0.8128612041473389
Epoch: 4, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.195 Vali Acc: 0.506 Test Loss: 1.195 Test Acc: 0.506
Validation loss decreased (-0.444431 --> -0.505544).  Saving model ...
Epoch: 5 cost time: 0.7918341159820557
Epoch: 5, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.081 Vali Acc: 0.544 Test Loss: 1.081 Test Acc: 0.544
Validation loss decreased (-0.505544 --> -0.544434).  Saving model ...
Epoch: 6 cost time: 0.8246908187866211
Epoch: 6, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.000 Vali Acc: 0.600 Test Loss: 1.000 Test Acc: 0.600
Validation loss decreased (-0.544434 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.840320348739624
Epoch: 7, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.938 Vali Acc: 0.628 Test Loss: 0.938 Test Acc: 0.628
Validation loss decreased (-0.599990 --> -0.627768).  Saving model ...
Epoch: 8 cost time: 0.8194336891174316
Epoch: 8, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.865 Vali Acc: 0.617 Test Loss: 0.865 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8700482845306396
Epoch: 9, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.803 Vali Acc: 0.650 Test Loss: 0.803 Test Acc: 0.650
Validation loss decreased (-0.627768 --> -0.649992).  Saving model ...
Epoch: 10 cost time: 0.8813130855560303
Epoch: 10, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.777 Vali Acc: 0.683 Test Loss: 0.777 Test Acc: 0.683
Validation loss decreased (-0.649992 --> -0.683326).  Saving model ...
Epoch: 11 cost time: 0.8269796371459961
Epoch: 11, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.731 Vali Acc: 0.706 Test Loss: 0.731 Test Acc: 0.706
Validation loss decreased (-0.683326 --> -0.705548).  Saving model ...
Epoch: 12 cost time: 0.8284356594085693
Epoch: 12, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.705 Vali Acc: 0.717 Test Loss: 0.705 Test Acc: 0.717
Validation loss decreased (-0.705548 --> -0.716660).  Saving model ...
Epoch: 13 cost time: 0.7989940643310547
Epoch: 13, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.682 Vali Acc: 0.722 Test Loss: 0.682 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722215).  Saving model ...
Epoch: 14 cost time: 0.8291985988616943
Epoch: 14, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.661 Vali Acc: 0.733 Test Loss: 0.661 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733327).  Saving model ...
Epoch: 15 cost time: 0.8763539791107178
Epoch: 15, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.646 Vali Acc: 0.744 Test Loss: 0.646 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744438).  Saving model ...
Epoch: 16 cost time: 0.8310132026672363
Epoch: 16, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.634 Vali Acc: 0.750 Test Loss: 0.634 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 17 cost time: 0.9181563854217529
Epoch: 17, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.620 Vali Acc: 0.750 Test Loss: 0.620 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 18 cost time: 0.8168644905090332
Epoch: 18, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.634 Vali Acc: 0.744 Test Loss: 0.634 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.93048095703125
Epoch: 19, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.619 Vali Acc: 0.761 Test Loss: 0.619 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761105).  Saving model ...
Epoch: 20 cost time: 0.9183177947998047
Epoch: 20, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.618 Vali Acc: 0.756 Test Loss: 0.618 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8598206043243408
Epoch: 21, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.615 Vali Acc: 0.778 Test Loss: 0.615 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777772).  Saving model ...
Epoch: 22 cost time: 0.9161772727966309
Epoch: 22, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.610 Vali Acc: 0.756 Test Loss: 0.610 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8425002098083496
Epoch: 23, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.625 Vali Acc: 0.761 Test Loss: 0.625 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9152207374572754
Epoch: 24, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.640 Vali Acc: 0.761 Test Loss: 0.640 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9034950733184814
Epoch: 25, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9092867374420166
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.616 Vali Acc: 0.767 Test Loss: 0.616 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.875194787979126
Epoch: 27, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.624 Vali Acc: 0.750 Test Loss: 0.624 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8096227645874023
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.654 Vali Acc: 0.761 Test Loss: 0.654 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9376904964447021
Epoch: 29, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8612375259399414
Epoch: 30, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.644 Vali Acc: 0.756 Test Loss: 0.644 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9240295886993408
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.674 Vali Acc: 0.756 Test Loss: 0.674 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el2_dm16_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 22934
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0417892932891846
Epoch: 1, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.361 Vali Acc: 0.539 Test Loss: 1.361 Test Acc: 0.539
Validation loss decreased (inf --> -0.538875).  Saving model ...
Epoch: 2 cost time: 1.5555691719055176
Epoch: 2, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.027 Vali Acc: 0.644 Test Loss: 1.027 Test Acc: 0.644
Validation loss decreased (-0.538875 --> -0.644434).  Saving model ...
Epoch: 3 cost time: 1.6083955764770508
Epoch: 3, Steps: 12 | Train Loss: 0.640 Vali Loss: 1.169 Vali Acc: 0.717 Test Loss: 1.169 Test Acc: 0.717
Validation loss decreased (-0.644434 --> -0.716655).  Saving model ...
Epoch: 4 cost time: 1.5756897926330566
Epoch: 4, Steps: 12 | Train Loss: 0.325 Vali Loss: 1.430 Vali Acc: 0.717 Test Loss: 1.430 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5193111896514893
Epoch: 5, Steps: 12 | Train Loss: 0.530 Vali Loss: 1.693 Vali Acc: 0.667 Test Loss: 1.693 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6409506797790527
Epoch: 6, Steps: 12 | Train Loss: 0.330 Vali Loss: 1.827 Vali Acc: 0.739 Test Loss: 1.827 Test Acc: 0.739
Validation loss decreased (-0.716655 --> -0.738871).  Saving model ...
Epoch: 7 cost time: 1.4763364791870117
Epoch: 7, Steps: 12 | Train Loss: 0.366 Vali Loss: 1.769 Vali Acc: 0.756 Test Loss: 1.769 Test Acc: 0.756
Validation loss decreased (-0.738871 --> -0.755538).  Saving model ...
Epoch: 8 cost time: 1.5754435062408447
Epoch: 8, Steps: 12 | Train Loss: 0.429 Vali Loss: 2.656 Vali Acc: 0.739 Test Loss: 2.656 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5769693851470947
Epoch: 9, Steps: 12 | Train Loss: 0.389 Vali Loss: 4.121 Vali Acc: 0.628 Test Loss: 4.121 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4750349521636963
Epoch: 10, Steps: 12 | Train Loss: 0.387 Vali Loss: 2.525 Vali Acc: 0.733 Test Loss: 2.525 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.494004726409912
Epoch: 11, Steps: 12 | Train Loss: 0.450 Vali Loss: 3.702 Vali Acc: 0.739 Test Loss: 3.702 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4711940288543701
Epoch: 12, Steps: 12 | Train Loss: 0.691 Vali Loss: 4.027 Vali Acc: 0.733 Test Loss: 4.027 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5843009948730469
Epoch: 13, Steps: 12 | Train Loss: 0.083 Vali Loss: 3.162 Vali Acc: 0.733 Test Loss: 3.162 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5753602981567383
Epoch: 14, Steps: 12 | Train Loss: 0.098 Vali Loss: 4.127 Vali Acc: 0.739 Test Loss: 4.127 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.430079698562622
Epoch: 15, Steps: 12 | Train Loss: 0.208 Vali Loss: 4.510 Vali Acc: 0.739 Test Loss: 4.510 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6109609603881836
Epoch: 16, Steps: 12 | Train Loss: 0.294 Vali Loss: 3.873 Vali Acc: 0.756 Test Loss: 3.873 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5189366340637207
Epoch: 17, Steps: 12 | Train Loss: 0.294 Vali Loss: 4.547 Vali Acc: 0.761 Test Loss: 4.547 Test Acc: 0.761
Validation loss decreased (-0.755538 --> -0.761066).  Saving model ...
Epoch: 18 cost time: 1.6086957454681396
Epoch: 18, Steps: 12 | Train Loss: 0.122 Vali Loss: 4.302 Vali Acc: 0.772 Test Loss: 4.302 Test Acc: 0.772
Validation loss decreased (-0.761066 --> -0.772179).  Saving model ...
Epoch: 19 cost time: 1.586024522781372
Epoch: 19, Steps: 12 | Train Loss: 0.352 Vali Loss: 5.423 Vali Acc: 0.728 Test Loss: 5.423 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5095112323760986
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 7.167 Vali Acc: 0.683 Test Loss: 7.167 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4982335567474365
Epoch: 21, Steps: 12 | Train Loss: 0.358 Vali Loss: 7.666 Vali Acc: 0.678 Test Loss: 7.666 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.594768762588501
Epoch: 22, Steps: 12 | Train Loss: 0.795 Vali Loss: 6.370 Vali Acc: 0.694 Test Loss: 6.370 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5206403732299805
Epoch: 23, Steps: 12 | Train Loss: 0.087 Vali Loss: 6.132 Vali Acc: 0.711 Test Loss: 6.132 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6247835159301758
Epoch: 24, Steps: 12 | Train Loss: 0.155 Vali Loss: 7.662 Vali Acc: 0.722 Test Loss: 7.662 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.575263261795044
Epoch: 25, Steps: 12 | Train Loss: 0.617 Vali Loss: 6.458 Vali Acc: 0.717 Test Loss: 6.458 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6604912281036377
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 7.363 Vali Acc: 0.717 Test Loss: 7.363 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5760583877563477
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 8.802 Vali Acc: 0.694 Test Loss: 8.802 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5808117389678955
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 8.408 Vali Acc: 0.711 Test Loss: 8.408 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 1073030
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8414523601531982
Epoch: 1, Steps: 12 | Train Loss: 1.578 Vali Loss: 1.106 Vali Acc: 0.522 Test Loss: 1.106 Test Acc: 0.522
Validation loss decreased (inf --> -0.522211).  Saving model ...
Epoch: 2 cost time: 1.1795003414154053
Epoch: 2, Steps: 12 | Train Loss: 1.000 Vali Loss: 0.907 Vali Acc: 0.639 Test Loss: 0.907 Test Acc: 0.639
Validation loss decreased (-0.522211 --> -0.638880).  Saving model ...
Epoch: 3 cost time: 1.27052640914917
Epoch: 3, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.679 Vali Acc: 0.750 Test Loss: 0.679 Test Acc: 0.750
Validation loss decreased (-0.638880 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 1.3062031269073486
Epoch: 4, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.660 Vali Acc: 0.750 Test Loss: 0.660 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 1.3050689697265625
Epoch: 5, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.960 Vali Acc: 0.750 Test Loss: 0.960 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3891725540161133
Epoch: 6, Steps: 12 | Train Loss: 0.207 Vali Loss: 1.524 Vali Acc: 0.711 Test Loss: 1.524 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2474124431610107
Epoch: 7, Steps: 12 | Train Loss: 0.326 Vali Loss: 1.651 Vali Acc: 0.717 Test Loss: 1.651 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.359807014465332
Epoch: 8, Steps: 12 | Train Loss: 0.200 Vali Loss: 1.895 Vali Acc: 0.722 Test Loss: 1.895 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.255401611328125
Epoch: 9, Steps: 12 | Train Loss: 0.209 Vali Loss: 1.221 Vali Acc: 0.739 Test Loss: 1.221 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1735107898712158
Epoch: 10, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.724 Vali Acc: 0.728 Test Loss: 1.724 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3153820037841797
Epoch: 11, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.927 Vali Acc: 0.739 Test Loss: 1.927 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3471953868865967
Epoch: 12, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.690 Vali Acc: 0.761 Test Loss: 1.690 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761094).  Saving model ...
Epoch: 13 cost time: 1.314265251159668
Epoch: 13, Steps: 12 | Train Loss: 0.006 Vali Loss: 2.243 Vali Acc: 0.711 Test Loss: 2.243 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2871170043945312
Epoch: 14, Steps: 12 | Train Loss: 0.007 Vali Loss: 2.342 Vali Acc: 0.656 Test Loss: 2.342 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2698264122009277
Epoch: 15, Steps: 12 | Train Loss: 0.092 Vali Loss: 2.285 Vali Acc: 0.711 Test Loss: 2.285 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3205037117004395
Epoch: 16, Steps: 12 | Train Loss: 0.051 Vali Loss: 2.687 Vali Acc: 0.728 Test Loss: 2.687 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2635064125061035
Epoch: 17, Steps: 12 | Train Loss: 0.091 Vali Loss: 2.728 Vali Acc: 0.706 Test Loss: 2.728 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3033709526062012
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 2.595 Vali Acc: 0.706 Test Loss: 2.595 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3115170001983643
Epoch: 19, Steps: 12 | Train Loss: 0.063 Vali Loss: 3.050 Vali Acc: 0.717 Test Loss: 3.050 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2315971851348877
Epoch: 20, Steps: 12 | Train Loss: 0.036 Vali Loss: 3.150 Vali Acc: 0.717 Test Loss: 3.150 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2756216526031494
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 3.145 Vali Acc: 0.722 Test Loss: 3.145 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2859249114990234
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 3.200 Vali Acc: 0.711 Test Loss: 3.200 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 612358
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7544214725494385
Epoch: 1, Steps: 12 | Train Loss: 1.535 Vali Loss: 0.989 Vali Acc: 0.589 Test Loss: 0.989 Test Acc: 0.589
Validation loss decreased (inf --> -0.588879).  Saving model ...
Epoch: 2 cost time: 1.2120649814605713
Epoch: 2, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.735 Vali Acc: 0.700 Test Loss: 0.735 Test Acc: 0.700
Validation loss decreased (-0.588879 --> -0.699993).  Saving model ...
Epoch: 3 cost time: 1.2347402572631836
Epoch: 3, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.813 Vali Acc: 0.733 Test Loss: 0.813 Test Acc: 0.733
Validation loss decreased (-0.699993 --> -0.733325).  Saving model ...
Epoch: 4 cost time: 1.1250543594360352
Epoch: 4, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.694 Vali Acc: 0.733 Test Loss: 0.694 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 1.281334638595581
Epoch: 5, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.968 Vali Acc: 0.733 Test Loss: 0.968 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1918399333953857
Epoch: 6, Steps: 12 | Train Loss: 0.326 Vali Loss: 1.246 Vali Acc: 0.717 Test Loss: 1.246 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0848345756530762
Epoch: 7, Steps: 12 | Train Loss: 0.193 Vali Loss: 1.157 Vali Acc: 0.761 Test Loss: 1.157 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761100).  Saving model ...
Epoch: 8 cost time: 1.1783802509307861
Epoch: 8, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.604 Vali Acc: 0.700 Test Loss: 1.604 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2114148139953613
Epoch: 9, Steps: 12 | Train Loss: 0.174 Vali Loss: 3.362 Vali Acc: 0.578 Test Loss: 3.362 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1852211952209473
Epoch: 10, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.826 Vali Acc: 0.672 Test Loss: 1.826 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1383051872253418
Epoch: 11, Steps: 12 | Train Loss: 0.123 Vali Loss: 1.378 Vali Acc: 0.733 Test Loss: 1.378 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2552990913391113
Epoch: 12, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.559 Vali Acc: 0.728 Test Loss: 1.559 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2117180824279785
Epoch: 13, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.851 Vali Acc: 0.733 Test Loss: 1.851 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1891670227050781
Epoch: 14, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.988 Vali Acc: 0.711 Test Loss: 1.988 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2133727073669434
Epoch: 15, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.785 Vali Acc: 0.733 Test Loss: 1.785 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1303298473358154
Epoch: 16, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.782 Vali Acc: 0.772 Test Loss: 1.782 Test Acc: 0.772
Validation loss decreased (-0.761100 --> -0.772204).  Saving model ...
Epoch: 17 cost time: 1.188500165939331
Epoch: 17, Steps: 12 | Train Loss: 0.009 Vali Loss: 2.154 Vali Acc: 0.739 Test Loss: 2.154 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1999890804290771
Epoch: 18, Steps: 12 | Train Loss: 0.028 Vali Loss: 2.202 Vali Acc: 0.761 Test Loss: 2.202 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2743604183197021
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.962 Vali Acc: 0.772 Test Loss: 1.962 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2082514762878418
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.957 Vali Acc: 0.750 Test Loss: 1.957 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.241323709487915
Epoch: 21, Steps: 12 | Train Loss: 0.017 Vali Loss: 2.474 Vali Acc: 0.750 Test Loss: 2.474 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.241180181503296
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 2.955 Vali Acc: 0.728 Test Loss: 2.955 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2176709175109863
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 2.574 Vali Acc: 0.750 Test Loss: 2.574 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2876489162445068
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 2.612 Vali Acc: 0.772 Test Loss: 2.612 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.304337739944458
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 2.200 Vali Acc: 0.778 Test Loss: 2.200 Test Acc: 0.778
Validation loss decreased (-0.772204 --> -0.777756).  Saving model ...
Epoch: 26 cost time: 1.2835047245025635
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 2.700 Vali Acc: 0.772 Test Loss: 2.700 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2964725494384766
Epoch: 27, Steps: 12 | Train Loss: 0.154 Vali Loss: 3.021 Vali Acc: 0.744 Test Loss: 3.021 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.263185739517212
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 2.893 Vali Acc: 0.750 Test Loss: 2.893 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2297987937927246
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 3.235 Vali Acc: 0.750 Test Loss: 3.235 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2265470027923584
Epoch: 30, Steps: 12 | Train Loss: 0.201 Vali Loss: 3.523 Vali Acc: 0.700 Test Loss: 3.523 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.361504316329956
Epoch: 31, Steps: 12 | Train Loss: 0.019 Vali Loss: 4.038 Vali Acc: 0.711 Test Loss: 4.038 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1104331016540527
Epoch: 32, Steps: 12 | Train Loss: 0.158 Vali Loss: 3.553 Vali Acc: 0.689 Test Loss: 3.553 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.223677396774292
Epoch: 33, Steps: 12 | Train Loss: 0.237 Vali Loss: 3.181 Vali Acc: 0.761 Test Loss: 3.181 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2647171020507812
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 3.932 Vali Acc: 0.711 Test Loss: 3.932 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3182215690612793
Epoch: 35, Steps: 12 | Train Loss: 0.022 Vali Loss: 4.107 Vali Acc: 0.739 Test Loss: 4.107 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 594054
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5562021732330322
Epoch: 1, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.099 Vali Acc: 0.539 Test Loss: 1.099 Test Acc: 0.539
Validation loss decreased (inf --> -0.538878).  Saving model ...
Epoch: 2 cost time: 0.9948010444641113
Epoch: 2, Steps: 12 | Train Loss: 0.920 Vali Loss: 0.860 Vali Acc: 0.656 Test Loss: 0.860 Test Acc: 0.656
Validation loss decreased (-0.538878 --> -0.655547).  Saving model ...
Epoch: 3 cost time: 1.0143861770629883
Epoch: 3, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.675 Vali Acc: 0.722 Test Loss: 0.675 Test Acc: 0.722
Validation loss decreased (-0.655547 --> -0.722215).  Saving model ...
Epoch: 4 cost time: 1.0804598331451416
Epoch: 4, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.920 Vali Acc: 0.706 Test Loss: 0.920 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0341072082519531
Epoch: 5, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.996 Vali Acc: 0.706 Test Loss: 0.996 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0641884803771973
Epoch: 6, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.820 Vali Acc: 0.767 Test Loss: 0.820 Test Acc: 0.767
Validation loss decreased (-0.722215 --> -0.766658).  Saving model ...
Epoch: 7 cost time: 1.0445547103881836
Epoch: 7, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.002 Vali Acc: 0.728 Test Loss: 1.002 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.082458257675171
Epoch: 8, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.008 Vali Acc: 0.717 Test Loss: 1.008 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1118929386138916
Epoch: 9, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.083 Vali Acc: 0.767 Test Loss: 1.083 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0614955425262451
Epoch: 10, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.160 Vali Acc: 0.761 Test Loss: 1.160 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0952157974243164
Epoch: 11, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.162 Vali Acc: 0.767 Test Loss: 1.162 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0932319164276123
Epoch: 12, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.145 Vali Acc: 0.728 Test Loss: 1.145 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.020430088043213
Epoch: 13, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.378 Vali Acc: 0.739 Test Loss: 1.378 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0384318828582764
Epoch: 14, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.315 Vali Acc: 0.739 Test Loss: 1.315 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0387647151947021
Epoch: 15, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.289 Vali Acc: 0.756 Test Loss: 1.289 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9713921546936035
Epoch: 16, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.761 Test Loss: 1.318 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 446854
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2375640869140625
Epoch: 1, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.200 Vali Acc: 0.517 Test Loss: 1.200 Test Acc: 0.517
Validation loss decreased (inf --> -0.516655).  Saving model ...
Epoch: 2 cost time: 0.9804494380950928
Epoch: 2, Steps: 12 | Train Loss: 0.900 Vali Loss: 0.913 Vali Acc: 0.594 Test Loss: 0.913 Test Acc: 0.594
Validation loss decreased (-0.516655 --> -0.594435).  Saving model ...
Epoch: 3 cost time: 0.9606914520263672
Epoch: 3, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.675 Vali Acc: 0.711 Test Loss: 0.675 Test Acc: 0.711
Validation loss decreased (-0.594435 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 0.9166555404663086
Epoch: 4, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.726 Vali Acc: 0.722 Test Loss: 0.726 Test Acc: 0.722
Validation loss decreased (-0.711104 --> -0.722215).  Saving model ...
Epoch: 5 cost time: 0.9106519222259521
Epoch: 5, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.795 Vali Acc: 0.711 Test Loss: 0.795 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.83677077293396
Epoch: 6, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.802 Vali Acc: 0.728 Test Loss: 0.802 Test Acc: 0.728
Validation loss decreased (-0.722215 --> -0.727770).  Saving model ...
Epoch: 7 cost time: 0.9399118423461914
Epoch: 7, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.056 Vali Acc: 0.744 Test Loss: 1.056 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744434).  Saving model ...
Epoch: 8 cost time: 0.9045588970184326
Epoch: 8, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.140 Vali Acc: 0.711 Test Loss: 1.140 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9626355171203613
Epoch: 9, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.242 Vali Acc: 0.706 Test Loss: 1.242 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8548338413238525
Epoch: 10, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.408 Vali Acc: 0.722 Test Loss: 1.408 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.865424394607544
Epoch: 11, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.450 Vali Acc: 0.717 Test Loss: 1.450 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9237699508666992
Epoch: 12, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.320 Vali Acc: 0.717 Test Loss: 1.320 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9077897071838379
Epoch: 13, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.363 Vali Acc: 0.728 Test Loss: 1.363 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9015505313873291
Epoch: 14, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.247 Vali Acc: 0.733 Test Loss: 1.247 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.905461311340332
Epoch: 15, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.367 Vali Acc: 0.722 Test Loss: 1.367 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9105474948883057
Epoch: 16, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.332 Vali Acc: 0.744 Test Loss: 1.332 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8949978351593018
Epoch: 17, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.341 Vali Acc: 0.733 Test Loss: 1.341 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 354950
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3534560203552246
Epoch: 1, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.278 Vali Acc: 0.522 Test Loss: 1.278 Test Acc: 0.522
Validation loss decreased (inf --> -0.522209).  Saving model ...
Epoch: 2 cost time: 0.9644410610198975
Epoch: 2, Steps: 12 | Train Loss: 0.970 Vali Loss: 0.903 Vali Acc: 0.589 Test Loss: 0.903 Test Acc: 0.589
Validation loss decreased (-0.522209 --> -0.588880).  Saving model ...
Epoch: 3 cost time: 1.0771543979644775
Epoch: 3, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.842 Vali Acc: 0.689 Test Loss: 0.842 Test Acc: 0.689
Validation loss decreased (-0.588880 --> -0.688880).  Saving model ...
Epoch: 4 cost time: 0.9446232318878174
Epoch: 4, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.752 Vali Acc: 0.706 Test Loss: 0.752 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 0.9060804843902588
Epoch: 5, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.703 Vali Acc: 0.739 Test Loss: 0.703 Test Acc: 0.739
Validation loss decreased (-0.705548 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 0.9561436176300049
Epoch: 6, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.723 Vali Acc: 0.711 Test Loss: 0.723 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0007352828979492
Epoch: 7, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.779 Vali Acc: 0.722 Test Loss: 0.779 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.919518232345581
Epoch: 8, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.904 Vali Acc: 0.739 Test Loss: 0.904 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9277195930480957
Epoch: 9, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.808 Vali Acc: 0.744 Test Loss: 0.808 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 0.8965144157409668
Epoch: 10, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.885 Vali Acc: 0.728 Test Loss: 0.885 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9682090282440186
Epoch: 11, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.848 Vali Acc: 0.761 Test Loss: 0.848 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 12 cost time: 0.9238543510437012
Epoch: 12, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.259 Vali Acc: 0.728 Test Loss: 1.259 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9941995143890381
Epoch: 13, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.873 Vali Acc: 0.756 Test Loss: 0.873 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9437682628631592
Epoch: 14, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.054 Vali Acc: 0.733 Test Loss: 1.054 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9475114345550537
Epoch: 15, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.924 Vali Acc: 0.750 Test Loss: 0.924 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9973907470703125
Epoch: 16, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.904 Vali Acc: 0.733 Test Loss: 0.904 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9400014877319336
Epoch: 17, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.982 Vali Acc: 0.733 Test Loss: 0.982 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.945702075958252
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.023 Vali Acc: 0.739 Test Loss: 1.023 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9638378620147705
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.030 Vali Acc: 0.744 Test Loss: 1.030 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9988317489624023
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.032 Vali Acc: 0.744 Test Loss: 1.032 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9945547580718994
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.051 Vali Acc: 0.739 Test Loss: 1.051 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 281606
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4018666744232178
Epoch: 1, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.295 Vali Acc: 0.478 Test Loss: 1.295 Test Acc: 0.478
Validation loss decreased (inf --> -0.477765).  Saving model ...
Epoch: 2 cost time: 1.016423225402832
Epoch: 2, Steps: 12 | Train Loss: 1.081 Vali Loss: 0.910 Vali Acc: 0.606 Test Loss: 0.910 Test Acc: 0.606
Validation loss decreased (-0.477765 --> -0.605546).  Saving model ...
Epoch: 3 cost time: 1.0993177890777588
Epoch: 3, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.737 Vali Acc: 0.722 Test Loss: 0.737 Test Acc: 0.722
Validation loss decreased (-0.605546 --> -0.722215).  Saving model ...
Epoch: 4 cost time: 1.0278184413909912
Epoch: 4, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.718 Vali Acc: 0.683 Test Loss: 0.718 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0266664028167725
Epoch: 5, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.702 Vali Acc: 0.744 Test Loss: 0.702 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744437).  Saving model ...
Epoch: 6 cost time: 0.949836015701294
Epoch: 6, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.723 Vali Acc: 0.750 Test Loss: 0.723 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 1.0019879341125488
Epoch: 7, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.832 Vali Acc: 0.739 Test Loss: 0.832 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9262905120849609
Epoch: 8, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.754 Vali Acc: 0.744 Test Loss: 0.754 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8987267017364502
Epoch: 9, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.792 Vali Acc: 0.761 Test Loss: 0.792 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761103).  Saving model ...
Epoch: 10 cost time: 0.9573605060577393
Epoch: 10, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.885 Vali Acc: 0.750 Test Loss: 0.885 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9067375659942627
Epoch: 11, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.957 Vali Acc: 0.750 Test Loss: 0.957 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.029142141342163
Epoch: 12, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.008 Vali Acc: 0.756 Test Loss: 1.008 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9751684665679932
Epoch: 13, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.914 Vali Acc: 0.772 Test Loss: 0.914 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772213).  Saving model ...
Epoch: 14 cost time: 0.9257245063781738
Epoch: 14, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.186 Vali Acc: 0.750 Test Loss: 1.186 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9177448749542236
Epoch: 15, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.237 Vali Acc: 0.744 Test Loss: 1.237 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9822328090667725
Epoch: 16, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.016 Vali Acc: 0.772 Test Loss: 1.016 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.022702693939209
Epoch: 17, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.041 Vali Acc: 0.750 Test Loss: 1.041 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.937981367111206
Epoch: 18, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.116 Vali Acc: 0.761 Test Loss: 1.116 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9329288005828857
Epoch: 19, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.136 Vali Acc: 0.767 Test Loss: 1.136 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9625790119171143
Epoch: 20, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.117 Vali Acc: 0.756 Test Loss: 1.117 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9484367370605469
Epoch: 21, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.135 Vali Acc: 0.761 Test Loss: 1.135 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8913648128509521
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.203 Vali Acc: 0.756 Test Loss: 1.203 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.002150297164917
Epoch: 23, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.136 Vali Acc: 0.767 Test Loss: 1.136 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 263430
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.120826244354248
Epoch: 1, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.519 Vali Acc: 0.500 Test Loss: 1.519 Test Acc: 0.500
Validation loss decreased (inf --> -0.499985).  Saving model ...
Epoch: 2 cost time: 1.5561752319335938
Epoch: 2, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.277 Vali Acc: 0.644 Test Loss: 1.277 Test Acc: 0.644
Validation loss decreased (-0.499985 --> -0.644432).  Saving model ...
Epoch: 3 cost time: 1.518949031829834
Epoch: 3, Steps: 12 | Train Loss: 0.825 Vali Loss: 1.643 Vali Acc: 0.672 Test Loss: 1.643 Test Acc: 0.672
Validation loss decreased (-0.644432 --> -0.672206).  Saving model ...
Epoch: 4 cost time: 1.47646164894104
Epoch: 4, Steps: 12 | Train Loss: 0.606 Vali Loss: 1.855 Vali Acc: 0.700 Test Loss: 1.855 Test Acc: 0.700
Validation loss decreased (-0.672206 --> -0.699981).  Saving model ...
Epoch: 5 cost time: 1.4836180210113525
Epoch: 5, Steps: 12 | Train Loss: 0.411 Vali Loss: 1.316 Vali Acc: 0.711 Test Loss: 1.316 Test Acc: 0.711
Validation loss decreased (-0.699981 --> -0.711098).  Saving model ...
Epoch: 6 cost time: 1.535050868988037
Epoch: 6, Steps: 12 | Train Loss: 0.176 Vali Loss: 2.898 Vali Acc: 0.633 Test Loss: 2.898 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4639480113983154
Epoch: 7, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.850 Vali Acc: 0.678 Test Loss: 1.850 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4765992164611816
Epoch: 8, Steps: 12 | Train Loss: 0.303 Vali Loss: 3.669 Vali Acc: 0.683 Test Loss: 3.669 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4578189849853516
Epoch: 9, Steps: 12 | Train Loss: 0.303 Vali Loss: 2.502 Vali Acc: 0.706 Test Loss: 2.502 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4566290378570557
Epoch: 10, Steps: 12 | Train Loss: 0.073 Vali Loss: 4.216 Vali Acc: 0.711 Test Loss: 4.216 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4788563251495361
Epoch: 11, Steps: 12 | Train Loss: 1.033 Vali Loss: 3.684 Vali Acc: 0.683 Test Loss: 3.684 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.469404697418213
Epoch: 12, Steps: 12 | Train Loss: 0.358 Vali Loss: 4.734 Vali Acc: 0.728 Test Loss: 4.734 Test Acc: 0.728
Validation loss decreased (-0.711098 --> -0.727730).  Saving model ...
Epoch: 13 cost time: 1.42209792137146
Epoch: 13, Steps: 12 | Train Loss: 0.059 Vali Loss: 4.410 Vali Acc: 0.694 Test Loss: 4.410 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5540826320648193
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 3.410 Vali Acc: 0.756 Test Loss: 3.410 Test Acc: 0.756
Validation loss decreased (-0.727730 --> -0.755521).  Saving model ...
Epoch: 15 cost time: 1.5267767906188965
Epoch: 15, Steps: 12 | Train Loss: 0.134 Vali Loss: 4.602 Vali Acc: 0.728 Test Loss: 4.602 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.54661226272583
Epoch: 16, Steps: 12 | Train Loss: 0.227 Vali Loss: 4.903 Vali Acc: 0.739 Test Loss: 4.903 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5446176528930664
Epoch: 17, Steps: 12 | Train Loss: 0.191 Vali Loss: 3.594 Vali Acc: 0.767 Test Loss: 3.594 Test Acc: 0.767
Validation loss decreased (-0.755521 --> -0.766631).  Saving model ...
Epoch: 18 cost time: 1.6349186897277832
Epoch: 18, Steps: 12 | Train Loss: 0.094 Vali Loss: 4.200 Vali Acc: 0.789 Test Loss: 4.200 Test Acc: 0.789
Validation loss decreased (-0.766631 --> -0.788847).  Saving model ...
Epoch: 19 cost time: 1.4083027839660645
Epoch: 19, Steps: 12 | Train Loss: 0.111 Vali Loss: 5.162 Vali Acc: 0.756 Test Loss: 5.162 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5754075050354004
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 5.710 Vali Acc: 0.761 Test Loss: 5.710 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6175870895385742
Epoch: 21, Steps: 12 | Train Loss: 0.162 Vali Loss: 4.500 Vali Acc: 0.772 Test Loss: 4.500 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5868604183197021
Epoch: 22, Steps: 12 | Train Loss: 0.355 Vali Loss: 7.515 Vali Acc: 0.772 Test Loss: 7.515 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4501621723175049
Epoch: 23, Steps: 12 | Train Loss: 0.188 Vali Loss: 5.805 Vali Acc: 0.756 Test Loss: 5.805 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4453577995300293
Epoch: 24, Steps: 12 | Train Loss: 0.121 Vali Loss: 5.905 Vali Acc: 0.756 Test Loss: 5.905 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5130350589752197
Epoch: 25, Steps: 12 | Train Loss: 0.277 Vali Loss: 7.448 Vali Acc: 0.678 Test Loss: 7.448 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6368322372436523
Epoch: 26, Steps: 12 | Train Loss: 0.192 Vali Loss: 7.025 Vali Acc: 0.761 Test Loss: 7.025 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5619077682495117
Epoch: 27, Steps: 12 | Train Loss: 0.350 Vali Loss: 7.457 Vali Acc: 0.706 Test Loss: 7.457 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5333406925201416
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 6.380 Vali Acc: 0.722 Test Loss: 6.380 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 1040134
model size : 6.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.685620069503784
Epoch: 1, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.273 Vali Acc: 0.528 Test Loss: 1.273 Test Acc: 0.528
Validation loss decreased (inf --> -0.527765).  Saving model ...
Epoch: 2 cost time: 1.3063616752624512
Epoch: 2, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.166 Vali Acc: 0.589 Test Loss: 1.166 Test Acc: 0.589
Validation loss decreased (-0.527765 --> -0.588877).  Saving model ...
Epoch: 3 cost time: 1.2547576427459717
Epoch: 3, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.810 Vali Acc: 0.711 Test Loss: 0.810 Test Acc: 0.711
Validation loss decreased (-0.588877 --> -0.711103).  Saving model ...
Epoch: 4 cost time: 1.090543270111084
Epoch: 4, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.674 Vali Acc: 0.772 Test Loss: 0.674 Test Acc: 0.772
Validation loss decreased (-0.711103 --> -0.772215).  Saving model ...
Epoch: 5 cost time: 1.1554498672485352
Epoch: 5, Steps: 12 | Train Loss: 0.225 Vali Loss: 1.397 Vali Acc: 0.628 Test Loss: 1.397 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2090904712677002
Epoch: 6, Steps: 12 | Train Loss: 0.232 Vali Loss: 1.385 Vali Acc: 0.711 Test Loss: 1.385 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.263845443725586
Epoch: 7, Steps: 12 | Train Loss: 0.306 Vali Loss: 1.447 Vali Acc: 0.689 Test Loss: 1.447 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.263484001159668
Epoch: 8, Steps: 12 | Train Loss: 0.235 Vali Loss: 1.782 Vali Acc: 0.700 Test Loss: 1.782 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1900205612182617
Epoch: 9, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.630 Vali Acc: 0.717 Test Loss: 1.630 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1635172367095947
Epoch: 10, Steps: 12 | Train Loss: 0.168 Vali Loss: 1.653 Vali Acc: 0.711 Test Loss: 1.653 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1087408065795898
Epoch: 11, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.838 Vali Acc: 0.733 Test Loss: 1.838 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1658544540405273
Epoch: 12, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.713 Vali Acc: 0.711 Test Loss: 1.713 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1056058406829834
Epoch: 13, Steps: 12 | Train Loss: 0.024 Vali Loss: 2.203 Vali Acc: 0.717 Test Loss: 2.203 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.168097972869873
Epoch: 14, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.842 Vali Acc: 0.706 Test Loss: 1.842 Test Acc: 0.706
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 579462
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.616947650909424
Epoch: 1, Steps: 12 | Train Loss: 1.567 Vali Loss: 0.991 Vali Acc: 0.583 Test Loss: 0.991 Test Acc: 0.583
Validation loss decreased (inf --> -0.583323).  Saving model ...
Epoch: 2 cost time: 1.1700613498687744
Epoch: 2, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.814 Vali Acc: 0.650 Test Loss: 0.814 Test Acc: 0.650
Validation loss decreased (-0.583323 --> -0.649992).  Saving model ...
Epoch: 3 cost time: 1.2180330753326416
Epoch: 3, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.822 Vali Acc: 0.689 Test Loss: 0.822 Test Acc: 0.689
Validation loss decreased (-0.649992 --> -0.688881).  Saving model ...
Epoch: 4 cost time: 1.2042570114135742
Epoch: 4, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.991 Vali Acc: 0.689 Test Loss: 0.991 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2513232231140137
Epoch: 5, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.997 Vali Acc: 0.733 Test Loss: 0.997 Test Acc: 0.733
Validation loss decreased (-0.688881 --> -0.733323).  Saving model ...
Epoch: 6 cost time: 1.2500481605529785
Epoch: 6, Steps: 12 | Train Loss: 0.226 Vali Loss: 1.356 Vali Acc: 0.728 Test Loss: 1.356 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1320312023162842
Epoch: 7, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.553 Vali Acc: 0.678 Test Loss: 1.553 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2261037826538086
Epoch: 8, Steps: 12 | Train Loss: 0.155 Vali Loss: 1.459 Vali Acc: 0.761 Test Loss: 1.459 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761097).  Saving model ...
Epoch: 9 cost time: 1.2689976692199707
Epoch: 9, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.450 Vali Acc: 0.694 Test Loss: 1.450 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2611615657806396
Epoch: 10, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.852 Vali Acc: 0.689 Test Loss: 1.852 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3090541362762451
Epoch: 11, Steps: 12 | Train Loss: 0.234 Vali Loss: 1.925 Vali Acc: 0.739 Test Loss: 1.925 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2401938438415527
Epoch: 12, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.923 Vali Acc: 0.739 Test Loss: 1.923 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2376976013183594
Epoch: 13, Steps: 12 | Train Loss: 0.206 Vali Loss: 2.101 Vali Acc: 0.739 Test Loss: 2.101 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.127770185470581
Epoch: 14, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.422 Vali Acc: 0.783 Test Loss: 1.422 Test Acc: 0.783
Validation loss decreased (-0.761097 --> -0.783319).  Saving model ...
Epoch: 15 cost time: 1.1790273189544678
Epoch: 15, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.969 Vali Acc: 0.728 Test Loss: 1.969 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1955609321594238
Epoch: 16, Steps: 12 | Train Loss: 0.047 Vali Loss: 2.125 Vali Acc: 0.756 Test Loss: 2.125 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2212848663330078
Epoch: 17, Steps: 12 | Train Loss: 0.021 Vali Loss: 2.615 Vali Acc: 0.717 Test Loss: 2.615 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0818603038787842
Epoch: 18, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.900 Vali Acc: 0.744 Test Loss: 1.900 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0889816284179688
Epoch: 19, Steps: 12 | Train Loss: 0.053 Vali Loss: 2.484 Vali Acc: 0.683 Test Loss: 2.484 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0987579822540283
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 2.007 Vali Acc: 0.750 Test Loss: 2.007 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1145684719085693
Epoch: 21, Steps: 12 | Train Loss: 0.042 Vali Loss: 2.252 Vali Acc: 0.733 Test Loss: 2.252 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1162402629852295
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.957 Vali Acc: 0.744 Test Loss: 1.957 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1573753356933594
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.497 Vali Acc: 0.706 Test Loss: 2.497 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1583240032196045
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 3.088 Vali Acc: 0.711 Test Loss: 3.088 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 561158
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7383511066436768
Epoch: 1, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.031 Vali Acc: 0.578 Test Loss: 1.031 Test Acc: 0.578
Validation loss decreased (inf --> -0.577767).  Saving model ...
Epoch: 2 cost time: 1.2190887928009033
Epoch: 2, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.694 Vali Acc: 0.722 Test Loss: 0.694 Test Acc: 0.722
Validation loss decreased (-0.577767 --> -0.722215).  Saving model ...
Epoch: 3 cost time: 1.2732272148132324
Epoch: 3, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.695 Vali Acc: 0.728 Test Loss: 0.695 Test Acc: 0.728
Validation loss decreased (-0.722215 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 1.230926513671875
Epoch: 4, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.826 Vali Acc: 0.706 Test Loss: 0.826 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2166109085083008
Epoch: 5, Steps: 12 | Train Loss: 0.210 Vali Loss: 1.076 Vali Acc: 0.700 Test Loss: 1.076 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2538838386535645
Epoch: 6, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.869 Vali Acc: 0.733 Test Loss: 0.869 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733325).  Saving model ...
Epoch: 7 cost time: 1.1539287567138672
Epoch: 7, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.189 Vali Acc: 0.739 Test Loss: 1.189 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738877).  Saving model ...
Epoch: 8 cost time: 1.134922742843628
Epoch: 8, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.981 Vali Acc: 0.767 Test Loss: 0.981 Test Acc: 0.767
Validation loss decreased (-0.738877 --> -0.766657).  Saving model ...
Epoch: 9 cost time: 1.1590452194213867
Epoch: 9, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.276 Vali Acc: 0.722 Test Loss: 1.276 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.226837396621704
Epoch: 10, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.541 Vali Acc: 0.733 Test Loss: 1.541 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1425411701202393
Epoch: 11, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.356 Vali Acc: 0.722 Test Loss: 1.356 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.132265329360962
Epoch: 12, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.339 Vali Acc: 0.750 Test Loss: 1.339 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1690545082092285
Epoch: 13, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.414 Vali Acc: 0.694 Test Loss: 1.414 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9433510303497314
Epoch: 14, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.654 Vali Acc: 0.694 Test Loss: 1.654 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0946159362792969
Epoch: 15, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.477 Vali Acc: 0.744 Test Loss: 1.477 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0665221214294434
Epoch: 16, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.866 Vali Acc: 0.733 Test Loss: 1.866 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0885326862335205
Epoch: 17, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.859 Vali Acc: 0.717 Test Loss: 1.859 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1217646598815918
Epoch: 18, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.766 Vali Acc: 0.728 Test Loss: 1.766 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 413958
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.657150983810425
Epoch: 1, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.208 Vali Acc: 0.511 Test Loss: 1.208 Test Acc: 0.511
Validation loss decreased (inf --> -0.511099).  Saving model ...
Epoch: 2 cost time: 1.0424444675445557
Epoch: 2, Steps: 12 | Train Loss: 0.839 Vali Loss: 0.792 Vali Acc: 0.672 Test Loss: 0.792 Test Acc: 0.672
Validation loss decreased (-0.511099 --> -0.672214).  Saving model ...
Epoch: 3 cost time: 1.0390985012054443
Epoch: 3, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.784 Vali Acc: 0.683 Test Loss: 0.784 Test Acc: 0.683
Validation loss decreased (-0.672214 --> -0.683325).  Saving model ...
Epoch: 4 cost time: 1.0010650157928467
Epoch: 4, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.785 Vali Acc: 0.717 Test Loss: 0.785 Test Acc: 0.717
Validation loss decreased (-0.683325 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 1.0503246784210205
Epoch: 5, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.738 Vali Acc: 0.717 Test Loss: 0.738 Test Acc: 0.717
Validation loss decreased (-0.716659 --> -0.716659).  Saving model ...
Epoch: 6 cost time: 1.0709311962127686
Epoch: 6, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.776 Vali Acc: 0.744 Test Loss: 0.776 Test Acc: 0.744
Validation loss decreased (-0.716659 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 1.069908857345581
Epoch: 7, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.009 Vali Acc: 0.744 Test Loss: 1.009 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.139127492904663
Epoch: 8, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.004 Vali Acc: 0.728 Test Loss: 1.004 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.985529899597168
Epoch: 9, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.948 Vali Acc: 0.711 Test Loss: 0.948 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0430572032928467
Epoch: 10, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.079 Vali Acc: 0.739 Test Loss: 1.079 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9788546562194824
Epoch: 11, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.089 Vali Acc: 0.750 Test Loss: 1.089 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749989).  Saving model ...
Epoch: 12 cost time: 0.9895823001861572
Epoch: 12, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.023 Vali Acc: 0.761 Test Loss: 1.023 Test Acc: 0.761
Validation loss decreased (-0.749989 --> -0.761101).  Saving model ...
Epoch: 13 cost time: 0.9106755256652832
Epoch: 13, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.372 Vali Acc: 0.739 Test Loss: 1.372 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0863237380981445
Epoch: 14, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.196 Vali Acc: 0.733 Test Loss: 1.196 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9667136669158936
Epoch: 15, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.524 Vali Acc: 0.722 Test Loss: 1.524 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.006117343902588
Epoch: 16, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.308 Vali Acc: 0.733 Test Loss: 1.308 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.015902042388916
Epoch: 17, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.365 Vali Acc: 0.756 Test Loss: 1.365 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9004175662994385
Epoch: 18, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.454 Vali Acc: 0.728 Test Loss: 1.454 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0121850967407227
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.442 Vali Acc: 0.722 Test Loss: 1.442 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9638617038726807
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.387 Vali Acc: 0.772 Test Loss: 1.387 Test Acc: 0.772
Validation loss decreased (-0.761101 --> -0.772208).  Saving model ...
Epoch: 21 cost time: 0.9260540008544922
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.387 Vali Acc: 0.761 Test Loss: 1.387 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9354150295257568
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.761 Test Loss: 1.404 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0100924968719482
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.387 Vali Acc: 0.767 Test Loss: 1.387 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8787310123443604
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.379 Vali Acc: 0.772 Test Loss: 1.379 Test Acc: 0.772
Validation loss decreased (-0.772208 --> -0.772208).  Saving model ...
Epoch: 25 cost time: 1.05283522605896
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.394 Vali Acc: 0.772 Test Loss: 1.394 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9089181423187256
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.756 Test Loss: 1.405 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9495227336883545
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.767 Test Loss: 1.410 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9130427837371826
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.767 Test Loss: 1.419 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8949005603790283
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.761 Test Loss: 1.408 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8713555335998535
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.761 Test Loss: 1.399 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9331800937652588
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.761 Test Loss: 1.396 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9838695526123047
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.756 Test Loss: 1.400 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0230138301849365
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.767 Test Loss: 1.418 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9720823764801025
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.761 Test Loss: 1.422 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 322054
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.420146942138672
Epoch: 1, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.223 Vali Acc: 0.533 Test Loss: 1.223 Test Acc: 0.533
Validation loss decreased (inf --> -0.533321).  Saving model ...
Epoch: 2 cost time: 0.8325886726379395
Epoch: 2, Steps: 12 | Train Loss: 1.007 Vali Loss: 0.962 Vali Acc: 0.606 Test Loss: 0.962 Test Acc: 0.606
Validation loss decreased (-0.533321 --> -0.605546).  Saving model ...
Epoch: 3 cost time: 0.8550541400909424
Epoch: 3, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.684 Vali Acc: 0.700 Test Loss: 0.684 Test Acc: 0.700
Validation loss decreased (-0.605546 --> -0.699993).  Saving model ...
Epoch: 4 cost time: 0.9487297534942627
Epoch: 4, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.735 Vali Acc: 0.717 Test Loss: 0.735 Test Acc: 0.717
Validation loss decreased (-0.699993 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 0.8913657665252686
Epoch: 5, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.779 Vali Acc: 0.711 Test Loss: 0.779 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8959462642669678
Epoch: 6, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.757 Vali Acc: 0.706 Test Loss: 0.757 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8219499588012695
Epoch: 7, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.730 Vali Acc: 0.750 Test Loss: 0.730 Test Acc: 0.750
Validation loss decreased (-0.716659 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 0.8854351043701172
Epoch: 8, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.883 Vali Acc: 0.706 Test Loss: 0.883 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8684053421020508
Epoch: 9, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.784 Vali Acc: 0.711 Test Loss: 0.784 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8944520950317383
Epoch: 10, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.821 Vali Acc: 0.739 Test Loss: 0.821 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9157974720001221
Epoch: 11, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.023 Vali Acc: 0.711 Test Loss: 1.023 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9672935009002686
Epoch: 12, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.966 Vali Acc: 0.733 Test Loss: 0.966 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7651240825653076
Epoch: 13, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.952 Vali Acc: 0.733 Test Loss: 0.952 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9250154495239258
Epoch: 14, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.076 Vali Acc: 0.750 Test Loss: 1.076 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8740777969360352
Epoch: 15, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.040 Vali Acc: 0.750 Test Loss: 1.040 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8815591335296631
Epoch: 16, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.052 Vali Acc: 0.728 Test Loss: 1.052 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8821110725402832
Epoch: 17, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.072 Vali Acc: 0.761 Test Loss: 1.072 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761100).  Saving model ...
Epoch: 18 cost time: 0.8667042255401611
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.101 Vali Acc: 0.744 Test Loss: 1.101 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8491287231445312
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.067 Vali Acc: 0.756 Test Loss: 1.067 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9079432487487793
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.744 Test Loss: 1.052 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0022051334381104
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.074 Vali Acc: 0.750 Test Loss: 1.074 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9121296405792236
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.096 Vali Acc: 0.739 Test Loss: 1.096 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9472908973693848
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.104 Vali Acc: 0.739 Test Loss: 1.104 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8339197635650635
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.090 Vali Acc: 0.761 Test Loss: 1.090 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8524525165557861
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.101 Vali Acc: 0.750 Test Loss: 1.101 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9429998397827148
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.106 Vali Acc: 0.744 Test Loss: 1.106 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9196908473968506
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.110 Vali Acc: 0.744 Test Loss: 1.110 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 248710
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4097681045532227
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.312 Vali Acc: 0.522 Test Loss: 1.312 Test Acc: 0.522
Validation loss decreased (inf --> -0.522209).  Saving model ...
Epoch: 2 cost time: 1.059471845626831
Epoch: 2, Steps: 12 | Train Loss: 1.041 Vali Loss: 0.931 Vali Acc: 0.622 Test Loss: 0.931 Test Acc: 0.622
Validation loss decreased (-0.522209 --> -0.622213).  Saving model ...
Epoch: 3 cost time: 1.1220943927764893
Epoch: 3, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.716 Vali Acc: 0.694 Test Loss: 0.716 Test Acc: 0.694
Validation loss decreased (-0.622213 --> -0.694437).  Saving model ...
Epoch: 4 cost time: 0.9845006465911865
Epoch: 4, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.706 Vali Acc: 0.711 Test Loss: 0.706 Test Acc: 0.711
Validation loss decreased (-0.694437 --> -0.711104).  Saving model ...
Epoch: 5 cost time: 0.9498453140258789
Epoch: 5, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.647 Vali Acc: 0.744 Test Loss: 0.647 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 0.9915680885314941
Epoch: 6, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.682 Vali Acc: 0.750 Test Loss: 0.682 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 0.948185920715332
Epoch: 7, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.760 Vali Acc: 0.733 Test Loss: 0.760 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.874791145324707
Epoch: 8, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.794 Vali Acc: 0.750 Test Loss: 0.794 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9753046035766602
Epoch: 9, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.942 Vali Acc: 0.722 Test Loss: 0.942 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9595034122467041
Epoch: 10, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.873 Vali Acc: 0.761 Test Loss: 0.873 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761102).  Saving model ...
Epoch: 11 cost time: 0.9852344989776611
Epoch: 11, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.831 Vali Acc: 0.728 Test Loss: 0.831 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9683611392974854
Epoch: 12, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.949 Vali Acc: 0.728 Test Loss: 0.949 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9536314010620117
Epoch: 13, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.904 Vali Acc: 0.756 Test Loss: 0.904 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0209269523620605
Epoch: 14, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.973 Vali Acc: 0.728 Test Loss: 0.973 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9224600791931152
Epoch: 15, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.971 Vali Acc: 0.761 Test Loss: 0.971 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.021934986114502
Epoch: 16, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.992 Vali Acc: 0.739 Test Loss: 0.992 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9829044342041016
Epoch: 17, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.015 Vali Acc: 0.750 Test Loss: 1.015 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0644502639770508
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.010 Vali Acc: 0.761 Test Loss: 1.010 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.064270257949829
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.009 Vali Acc: 0.756 Test Loss: 1.009 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0153539180755615
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.045 Vali Acc: 0.761 Test Loss: 1.045 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 230534
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0195839405059814
Epoch: 1, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.098 Vali Acc: 0.594 Test Loss: 1.098 Test Acc: 0.594
Validation loss decreased (inf --> -0.594433).  Saving model ...
Epoch: 2 cost time: 1.5198752880096436
Epoch: 2, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.009 Vali Acc: 0.633 Test Loss: 1.009 Test Acc: 0.633
Validation loss decreased (-0.594433 --> -0.633323).  Saving model ...
Epoch: 3 cost time: 1.5677742958068848
Epoch: 3, Steps: 12 | Train Loss: 0.647 Vali Loss: 1.240 Vali Acc: 0.722 Test Loss: 1.240 Test Acc: 0.722
Validation loss decreased (-0.633323 --> -0.722210).  Saving model ...
Epoch: 4 cost time: 1.508305549621582
Epoch: 4, Steps: 12 | Train Loss: 0.606 Vali Loss: 1.978 Vali Acc: 0.678 Test Loss: 1.978 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4880683422088623
Epoch: 5, Steps: 12 | Train Loss: 0.569 Vali Loss: 1.269 Vali Acc: 0.739 Test Loss: 1.269 Test Acc: 0.739
Validation loss decreased (-0.722210 --> -0.738876).  Saving model ...
Epoch: 6 cost time: 1.457977056503296
Epoch: 6, Steps: 12 | Train Loss: 0.472 Vali Loss: 2.216 Vali Acc: 0.717 Test Loss: 2.216 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4248614311218262
Epoch: 7, Steps: 12 | Train Loss: 0.223 Vali Loss: 2.609 Vali Acc: 0.711 Test Loss: 2.609 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4285008907318115
Epoch: 8, Steps: 12 | Train Loss: 0.205 Vali Loss: 2.082 Vali Acc: 0.744 Test Loss: 2.082 Test Acc: 0.744
Validation loss decreased (-0.738876 --> -0.744424).  Saving model ...
Epoch: 9 cost time: 1.478316307067871
Epoch: 9, Steps: 12 | Train Loss: 0.103 Vali Loss: 2.500 Vali Acc: 0.667 Test Loss: 2.500 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4383447170257568
Epoch: 10, Steps: 12 | Train Loss: 0.281 Vali Loss: 3.291 Vali Acc: 0.722 Test Loss: 3.291 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.451216459274292
Epoch: 11, Steps: 12 | Train Loss: 0.301 Vali Loss: 3.751 Vali Acc: 0.728 Test Loss: 3.751 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4966437816619873
Epoch: 12, Steps: 12 | Train Loss: 0.261 Vali Loss: 4.166 Vali Acc: 0.700 Test Loss: 4.166 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5730969905853271
Epoch: 13, Steps: 12 | Train Loss: 0.436 Vali Loss: 3.975 Vali Acc: 0.711 Test Loss: 3.975 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4513447284698486
Epoch: 14, Steps: 12 | Train Loss: 0.240 Vali Loss: 4.994 Vali Acc: 0.706 Test Loss: 4.994 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4691779613494873
Epoch: 15, Steps: 12 | Train Loss: 0.012 Vali Loss: 4.808 Vali Acc: 0.733 Test Loss: 4.808 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4253880977630615
Epoch: 16, Steps: 12 | Train Loss: 0.182 Vali Loss: 4.225 Vali Acc: 0.694 Test Loss: 4.225 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5514965057373047
Epoch: 17, Steps: 12 | Train Loss: 1.136 Vali Loss: 7.268 Vali Acc: 0.661 Test Loss: 7.268 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5087156295776367
Epoch: 18, Steps: 12 | Train Loss: 0.883 Vali Loss: 8.984 Vali Acc: 0.728 Test Loss: 8.984 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 1023686
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.747314691543579
Epoch: 1, Steps: 12 | Train Loss: 1.694 Vali Loss: 0.981 Vali Acc: 0.589 Test Loss: 0.981 Test Acc: 0.589
Validation loss decreased (inf --> -0.588879).  Saving model ...
Epoch: 2 cost time: 1.1905300617218018
Epoch: 2, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.734 Vali Acc: 0.728 Test Loss: 0.734 Test Acc: 0.728
Validation loss decreased (-0.588879 --> -0.727770).  Saving model ...
Epoch: 3 cost time: 1.1639373302459717
Epoch: 3, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.711 Vali Acc: 0.733 Test Loss: 0.711 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733326).  Saving model ...
Epoch: 4 cost time: 1.2109382152557373
Epoch: 4, Steps: 12 | Train Loss: 0.514 Vali Loss: 1.387 Vali Acc: 0.678 Test Loss: 1.387 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1644697189331055
Epoch: 5, Steps: 12 | Train Loss: 0.296 Vali Loss: 1.345 Vali Acc: 0.700 Test Loss: 1.345 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2012310028076172
Epoch: 6, Steps: 12 | Train Loss: 0.177 Vali Loss: 1.048 Vali Acc: 0.756 Test Loss: 1.048 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755545).  Saving model ...
Epoch: 7 cost time: 1.1520094871520996
Epoch: 7, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.114 Vali Acc: 0.750 Test Loss: 1.114 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1407151222229004
Epoch: 8, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.987 Vali Acc: 0.661 Test Loss: 1.987 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.104537010192871
Epoch: 9, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.549 Vali Acc: 0.722 Test Loss: 1.549 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1574668884277344
Epoch: 10, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.653 Vali Acc: 0.711 Test Loss: 1.653 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2328331470489502
Epoch: 11, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.466 Vali Acc: 0.750 Test Loss: 1.466 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.137831687927246
Epoch: 12, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.823 Vali Acc: 0.733 Test Loss: 1.823 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.101576566696167
Epoch: 13, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.793 Vali Acc: 0.728 Test Loss: 1.793 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1584057807922363
Epoch: 14, Steps: 12 | Train Loss: 0.166 Vali Loss: 4.007 Vali Acc: 0.667 Test Loss: 4.007 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1788628101348877
Epoch: 15, Steps: 12 | Train Loss: 0.217 Vali Loss: 2.862 Vali Acc: 0.667 Test Loss: 2.862 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2059612274169922
Epoch: 16, Steps: 12 | Train Loss: 0.057 Vali Loss: 2.749 Vali Acc: 0.694 Test Loss: 2.749 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 563014
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.485293388366699
Epoch: 1, Steps: 12 | Train Loss: 1.684 Vali Loss: 1.034 Vali Acc: 0.594 Test Loss: 1.034 Test Acc: 0.594
Validation loss decreased (inf --> -0.594434).  Saving model ...
Epoch: 2 cost time: 1.1008567810058594
Epoch: 2, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.762 Vali Acc: 0.694 Test Loss: 0.762 Test Acc: 0.694
Validation loss decreased (-0.594434 --> -0.694437).  Saving model ...
Epoch: 3 cost time: 1.1184701919555664
Epoch: 3, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.741 Vali Acc: 0.744 Test Loss: 0.741 Test Acc: 0.744
Validation loss decreased (-0.694437 --> -0.744437).  Saving model ...
Epoch: 4 cost time: 1.1828632354736328
Epoch: 4, Steps: 12 | Train Loss: 0.174 Vali Loss: 1.077 Vali Acc: 0.644 Test Loss: 1.077 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0997614860534668
Epoch: 5, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.993 Vali Acc: 0.711 Test Loss: 0.993 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1194913387298584
Epoch: 6, Steps: 12 | Train Loss: 0.176 Vali Loss: 1.062 Vali Acc: 0.722 Test Loss: 1.062 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1728591918945312
Epoch: 7, Steps: 12 | Train Loss: 0.206 Vali Loss: 1.300 Vali Acc: 0.711 Test Loss: 1.300 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1700387001037598
Epoch: 8, Steps: 12 | Train Loss: 0.180 Vali Loss: 1.613 Vali Acc: 0.711 Test Loss: 1.613 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1753554344177246
Epoch: 9, Steps: 12 | Train Loss: 0.150 Vali Loss: 1.758 Vali Acc: 0.700 Test Loss: 1.758 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1275196075439453
Epoch: 10, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.489 Vali Acc: 0.717 Test Loss: 1.489 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.100621223449707
Epoch: 11, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.719 Vali Acc: 0.700 Test Loss: 1.719 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1401383876800537
Epoch: 12, Steps: 12 | Train Loss: 0.121 Vali Loss: 2.245 Vali Acc: 0.711 Test Loss: 2.245 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1099357604980469
Epoch: 13, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.784 Vali Acc: 0.733 Test Loss: 1.784 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 544710
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.632561206817627
Epoch: 1, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.035 Vali Acc: 0.561 Test Loss: 1.035 Test Acc: 0.561
Validation loss decreased (inf --> -0.561101).  Saving model ...
Epoch: 2 cost time: 1.1121854782104492
Epoch: 2, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.846 Vali Acc: 0.656 Test Loss: 0.846 Test Acc: 0.656
Validation loss decreased (-0.561101 --> -0.655547).  Saving model ...
Epoch: 3 cost time: 1.212967872619629
Epoch: 3, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.674 Vali Acc: 0.711 Test Loss: 0.674 Test Acc: 0.711
Validation loss decreased (-0.655547 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.0966243743896484
Epoch: 4, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.800 Vali Acc: 0.722 Test Loss: 0.800 Test Acc: 0.722
Validation loss decreased (-0.711104 --> -0.722214).  Saving model ...
Epoch: 5 cost time: 1.1589419841766357
Epoch: 5, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.890 Vali Acc: 0.733 Test Loss: 0.890 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733324).  Saving model ...
Epoch: 6 cost time: 1.1937780380249023
Epoch: 6, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.852 Vali Acc: 0.739 Test Loss: 0.852 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 1.1934351921081543
Epoch: 7, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.906 Vali Acc: 0.739 Test Loss: 0.906 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1362180709838867
Epoch: 8, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.109 Vali Acc: 0.722 Test Loss: 1.109 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.094573736190796
Epoch: 9, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.192 Vali Acc: 0.739 Test Loss: 1.192 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0608954429626465
Epoch: 10, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.203 Vali Acc: 0.744 Test Loss: 1.203 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744432).  Saving model ...
Epoch: 11 cost time: 1.076951265335083
Epoch: 11, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.037 Vali Acc: 0.772 Test Loss: 1.037 Test Acc: 0.772
Validation loss decreased (-0.744432 --> -0.772212).  Saving model ...
Epoch: 12 cost time: 1.1567869186401367
Epoch: 12, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.303 Vali Acc: 0.767 Test Loss: 1.303 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.137634515762329
Epoch: 13, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.247 Vali Acc: 0.750 Test Loss: 1.247 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1708948612213135
Epoch: 14, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.289 Vali Acc: 0.756 Test Loss: 1.289 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1457998752593994
Epoch: 15, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.211 Vali Acc: 0.750 Test Loss: 1.211 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0674347877502441
Epoch: 16, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.284 Vali Acc: 0.733 Test Loss: 1.284 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.133265733718872
Epoch: 17, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.412 Vali Acc: 0.739 Test Loss: 1.412 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1897461414337158
Epoch: 18, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.656 Vali Acc: 0.706 Test Loss: 1.656 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1695823669433594
Epoch: 19, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.996 Vali Acc: 0.700 Test Loss: 1.996 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.222311019897461
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 2.364 Vali Acc: 0.633 Test Loss: 2.364 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.11710524559021
Epoch: 21, Steps: 12 | Train Loss: 0.020 Vali Loss: 2.259 Vali Acc: 0.700 Test Loss: 2.259 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 397510
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5839617252349854
Epoch: 1, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.207 Vali Acc: 0.528 Test Loss: 1.207 Test Acc: 0.528
Validation loss decreased (inf --> -0.527766).  Saving model ...
Epoch: 2 cost time: 0.9994666576385498
Epoch: 2, Steps: 12 | Train Loss: 1.000 Vali Loss: 0.808 Vali Acc: 0.672 Test Loss: 0.808 Test Acc: 0.672
Validation loss decreased (-0.527766 --> -0.672214).  Saving model ...
Epoch: 3 cost time: 0.9652297496795654
Epoch: 3, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.984 Vali Acc: 0.667 Test Loss: 0.984 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9398462772369385
Epoch: 4, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.724 Vali Acc: 0.739 Test Loss: 0.724 Test Acc: 0.739
Validation loss decreased (-0.672214 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 0.9497785568237305
Epoch: 5, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.706 Vali Acc: 0.756 Test Loss: 0.706 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755548).  Saving model ...
Epoch: 6 cost time: 0.993109941482544
Epoch: 6, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.803 Vali Acc: 0.722 Test Loss: 0.803 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0812551975250244
Epoch: 7, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.987 Vali Acc: 0.733 Test Loss: 0.987 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9803199768066406
Epoch: 8, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.934 Vali Acc: 0.739 Test Loss: 0.934 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0084106922149658
Epoch: 9, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.905 Vali Acc: 0.739 Test Loss: 0.905 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.004716157913208
Epoch: 10, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.022 Vali Acc: 0.728 Test Loss: 1.022 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9423530101776123
Epoch: 11, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.173 Vali Acc: 0.733 Test Loss: 1.173 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0336315631866455
Epoch: 12, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.082 Vali Acc: 0.739 Test Loss: 1.082 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8122720718383789
Epoch: 13, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.166 Vali Acc: 0.728 Test Loss: 1.166 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8993771076202393
Epoch: 14, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.388 Vali Acc: 0.733 Test Loss: 1.388 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9447965621948242
Epoch: 15, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.109 Vali Acc: 0.761 Test Loss: 1.109 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761100).  Saving model ...
Epoch: 16 cost time: 0.9054780006408691
Epoch: 16, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.150 Vali Acc: 0.744 Test Loss: 1.150 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9841632843017578
Epoch: 17, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.208 Vali Acc: 0.744 Test Loss: 1.208 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9856672286987305
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.252 Vali Acc: 0.739 Test Loss: 1.252 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9077374935150146
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.269 Vali Acc: 0.733 Test Loss: 1.269 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8724479675292969
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.260 Vali Acc: 0.744 Test Loss: 1.260 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9426369667053223
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.750 Test Loss: 1.239 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.892864465713501
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.234 Vali Acc: 0.744 Test Loss: 1.234 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9523696899414062
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.750 Test Loss: 1.238 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9288473129272461
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.756 Test Loss: 1.213 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9421424865722656
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.761 Test Loss: 1.227 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 305606
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3743953704833984
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.334 Vali Acc: 0.522 Test Loss: 1.334 Test Acc: 0.522
Validation loss decreased (inf --> -0.522209).  Saving model ...
Epoch: 2 cost time: 0.9029016494750977
Epoch: 2, Steps: 12 | Train Loss: 1.030 Vali Loss: 0.890 Vali Acc: 0.611 Test Loss: 0.890 Test Acc: 0.611
Validation loss decreased (-0.522209 --> -0.611102).  Saving model ...
Epoch: 3 cost time: 0.827003002166748
Epoch: 3, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.821 Vali Acc: 0.672 Test Loss: 0.821 Test Acc: 0.672
Validation loss decreased (-0.611102 --> -0.672214).  Saving model ...
Epoch: 4 cost time: 0.8396940231323242
Epoch: 4, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.635 Vali Acc: 0.722 Test Loss: 0.635 Test Acc: 0.722
Validation loss decreased (-0.672214 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 0.8585026264190674
Epoch: 5, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.767 Vali Acc: 0.728 Test Loss: 0.767 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727770).  Saving model ...
Epoch: 6 cost time: 0.8665065765380859
Epoch: 6, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.774 Vali Acc: 0.744 Test Loss: 0.774 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 0.7616806030273438
Epoch: 7, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.847 Vali Acc: 0.717 Test Loss: 0.847 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8888709545135498
Epoch: 8, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.812 Vali Acc: 0.744 Test Loss: 0.812 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8212637901306152
Epoch: 9, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.774 Vali Acc: 0.750 Test Loss: 0.774 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 1.0120518207550049
Epoch: 10, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.941 Vali Acc: 0.756 Test Loss: 0.941 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755546).  Saving model ...
Epoch: 11 cost time: 0.8355727195739746
Epoch: 11, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.050 Vali Acc: 0.728 Test Loss: 1.050 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0081734657287598
Epoch: 12, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.938913106918335
Epoch: 13, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.962 Vali Acc: 0.717 Test Loss: 0.962 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9280762672424316
Epoch: 14, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.092 Vali Acc: 0.733 Test Loss: 1.092 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8240451812744141
Epoch: 15, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.139 Vali Acc: 0.733 Test Loss: 1.139 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9893510341644287
Epoch: 16, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.089 Vali Acc: 0.756 Test Loss: 1.089 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8866174221038818
Epoch: 17, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.069 Vali Acc: 0.739 Test Loss: 1.069 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8701183795928955
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.084 Vali Acc: 0.750 Test Loss: 1.084 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8767344951629639
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.103 Vali Acc: 0.744 Test Loss: 1.103 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8144304752349854
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.083 Vali Acc: 0.756 Test Loss: 1.083 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 232262
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4272119998931885
Epoch: 1, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.300 Vali Acc: 0.500 Test Loss: 1.300 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.724381685256958
Epoch: 2, Steps: 12 | Train Loss: 1.028 Vali Loss: 0.900 Vali Acc: 0.622 Test Loss: 0.900 Test Acc: 0.622
Validation loss decreased (-0.499987 --> -0.622213).  Saving model ...
Epoch: 3 cost time: 0.8489542007446289
Epoch: 3, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.741 Vali Acc: 0.678 Test Loss: 0.741 Test Acc: 0.678
Validation loss decreased (-0.622213 --> -0.677770).  Saving model ...
Epoch: 4 cost time: 0.8670790195465088
Epoch: 4, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.665 Vali Acc: 0.733 Test Loss: 0.665 Test Acc: 0.733
Validation loss decreased (-0.677770 --> -0.733327).  Saving model ...
Epoch: 5 cost time: 0.8663043975830078
Epoch: 5, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.658 Vali Acc: 0.717 Test Loss: 0.658 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9424140453338623
Epoch: 6, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.705 Vali Acc: 0.711 Test Loss: 0.705 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9091958999633789
Epoch: 7, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 0.855194091796875
Epoch: 8, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.726 Vali Acc: 0.756 Test Loss: 0.726 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755548).  Saving model ...
Epoch: 9 cost time: 0.8343408107757568
Epoch: 9, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.948 Vali Acc: 0.706 Test Loss: 0.948 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8295047283172607
Epoch: 10, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.843 Vali Acc: 0.728 Test Loss: 0.843 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8191630840301514
Epoch: 11, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.775 Vali Acc: 0.767 Test Loss: 0.775 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 12 cost time: 0.8598508834838867
Epoch: 12, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.854 Vali Acc: 0.739 Test Loss: 0.854 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8404884338378906
Epoch: 13, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.859 Vali Acc: 0.744 Test Loss: 0.859 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8357625007629395
Epoch: 14, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.940 Vali Acc: 0.756 Test Loss: 0.940 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9015278816223145
Epoch: 15, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.994 Vali Acc: 0.756 Test Loss: 0.994 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8626923561096191
Epoch: 16, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.909 Vali Acc: 0.761 Test Loss: 0.909 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8758049011230469
Epoch: 17, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.982 Vali Acc: 0.750 Test Loss: 0.982 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9109690189361572
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.996 Vali Acc: 0.739 Test Loss: 0.996 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9033336639404297
Epoch: 19, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.008 Vali Acc: 0.756 Test Loss: 1.008 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9781351089477539
Epoch: 20, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.998 Vali Acc: 0.761 Test Loss: 0.998 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9626760482788086
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.996 Vali Acc: 0.756 Test Loss: 0.996 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm128_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 214086
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.923349618911743
Epoch: 1, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.129 Vali Acc: 0.517 Test Loss: 1.129 Test Acc: 0.517
Validation loss decreased (inf --> -0.516655).  Saving model ...
Epoch: 2 cost time: 1.5289578437805176
Epoch: 2, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.934 Vali Acc: 0.639 Test Loss: 0.934 Test Acc: 0.639
Validation loss decreased (-0.516655 --> -0.638880).  Saving model ...
Epoch: 3 cost time: 1.4845685958862305
Epoch: 3, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.890 Vali Acc: 0.717 Test Loss: 0.890 Test Acc: 0.717
Validation loss decreased (-0.638880 --> -0.716658).  Saving model ...
Epoch: 4 cost time: 1.3907511234283447
Epoch: 4, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.863 Vali Acc: 0.739 Test Loss: 0.863 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738880).  Saving model ...
Epoch: 5 cost time: 1.3175101280212402
Epoch: 5, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.937 Vali Acc: 0.700 Test Loss: 0.937 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3034961223602295
Epoch: 6, Steps: 12 | Train Loss: 0.208 Vali Loss: 1.002 Vali Acc: 0.739 Test Loss: 1.002 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2910118103027344
Epoch: 7, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.743 Vali Acc: 0.683 Test Loss: 1.743 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2668795585632324
Epoch: 8, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.639 Vali Acc: 0.717 Test Loss: 1.639 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2619102001190186
Epoch: 9, Steps: 12 | Train Loss: 0.146 Vali Loss: 2.307 Vali Acc: 0.644 Test Loss: 2.307 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3594269752502441
Epoch: 10, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.473 Vali Acc: 0.750 Test Loss: 1.473 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749985).  Saving model ...
Epoch: 11 cost time: 1.3685805797576904
Epoch: 11, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.585 Vali Acc: 0.750 Test Loss: 1.585 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4475133419036865
Epoch: 12, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.565 Vali Acc: 0.744 Test Loss: 1.565 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4531242847442627
Epoch: 13, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.876 Vali Acc: 0.722 Test Loss: 1.876 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5180213451385498
Epoch: 14, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.853 Vali Acc: 0.717 Test Loss: 1.853 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4344172477722168
Epoch: 15, Steps: 12 | Train Loss: 0.050 Vali Loss: 2.206 Vali Acc: 0.728 Test Loss: 2.206 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3607966899871826
Epoch: 16, Steps: 12 | Train Loss: 0.052 Vali Loss: 2.494 Vali Acc: 0.739 Test Loss: 2.494 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4281413555145264
Epoch: 17, Steps: 12 | Train Loss: 0.119 Vali Loss: 2.284 Vali Acc: 0.733 Test Loss: 2.284 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3572990894317627
Epoch: 18, Steps: 12 | Train Loss: 0.073 Vali Loss: 2.269 Vali Acc: 0.772 Test Loss: 2.269 Test Acc: 0.772
Validation loss decreased (-0.749985 --> -0.772200).  Saving model ...
Epoch: 19 cost time: 1.3869314193725586
Epoch: 19, Steps: 12 | Train Loss: 0.092 Vali Loss: 2.143 Vali Acc: 0.750 Test Loss: 2.143 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.537353754043579
Epoch: 20, Steps: 12 | Train Loss: 0.083 Vali Loss: 2.642 Vali Acc: 0.739 Test Loss: 2.642 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5124483108520508
Epoch: 21, Steps: 12 | Train Loss: 0.171 Vali Loss: 3.876 Vali Acc: 0.717 Test Loss: 3.876 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4751904010772705
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 2.687 Vali Acc: 0.728 Test Loss: 2.687 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.492337942123413
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 2.759 Vali Acc: 0.744 Test Loss: 2.759 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3849661350250244
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 2.751 Vali Acc: 0.761 Test Loss: 2.751 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5126588344573975
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 2.751 Vali Acc: 0.750 Test Loss: 2.751 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.483712911605835
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 2.791 Vali Acc: 0.733 Test Loss: 2.791 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4675135612487793
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 3.922 Vali Acc: 0.717 Test Loss: 3.922 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4542148113250732
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 3.371 Vali Acc: 0.706 Test Loss: 3.371 Test Acc: 0.706
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 520262
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5181334018707275
Epoch: 1, Steps: 12 | Train Loss: 1.660 Vali Loss: 1.156 Vali Acc: 0.578 Test Loss: 1.156 Test Acc: 0.578
Validation loss decreased (inf --> -0.577766).  Saving model ...
Epoch: 2 cost time: 1.16318941116333
Epoch: 2, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.815 Vali Acc: 0.667 Test Loss: 0.815 Test Acc: 0.667
Validation loss decreased (-0.577766 --> -0.666659).  Saving model ...
Epoch: 3 cost time: 1.0533485412597656
Epoch: 3, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.726 Vali Acc: 0.678 Test Loss: 0.726 Test Acc: 0.678
Validation loss decreased (-0.666659 --> -0.677771).  Saving model ...
Epoch: 4 cost time: 1.0809764862060547
Epoch: 4, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.763 Vali Acc: 0.706 Test Loss: 0.763 Test Acc: 0.706
Validation loss decreased (-0.677771 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 1.1650149822235107
Epoch: 5, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.668 Vali Acc: 0.744 Test Loss: 0.668 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 1.0564968585968018
Epoch: 6, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.848 Vali Acc: 0.694 Test Loss: 0.848 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0171563625335693
Epoch: 7, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.127 Vali Acc: 0.733 Test Loss: 1.127 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1335368156433105
Epoch: 8, Steps: 12 | Train Loss: 0.128 Vali Loss: 1.049 Vali Acc: 0.728 Test Loss: 1.049 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0918219089508057
Epoch: 9, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.855 Vali Acc: 0.767 Test Loss: 0.855 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766658).  Saving model ...
Epoch: 10 cost time: 1.0229403972625732
Epoch: 10, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.844 Vali Acc: 0.767 Test Loss: 0.844 Test Acc: 0.767
Validation loss decreased (-0.766658 --> -0.766658).  Saving model ...
Epoch: 11 cost time: 1.067284345626831
Epoch: 11, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.078 Vali Acc: 0.733 Test Loss: 1.078 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.973097562789917
Epoch: 12, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.190 Vali Acc: 0.728 Test Loss: 1.190 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9723930358886719
Epoch: 13, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.379 Vali Acc: 0.739 Test Loss: 1.379 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0342113971710205
Epoch: 14, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.150 Vali Acc: 0.761 Test Loss: 1.150 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0375499725341797
Epoch: 15, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.622 Vali Acc: 0.739 Test Loss: 1.622 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0711109638214111
Epoch: 16, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.522 Vali Acc: 0.733 Test Loss: 1.522 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0985426902770996
Epoch: 17, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.361 Vali Acc: 0.756 Test Loss: 1.361 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0532207489013672
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.318 Vali Acc: 0.761 Test Loss: 1.318 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1193642616271973
Epoch: 19, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.295 Vali Acc: 0.761 Test Loss: 1.295 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1786398887634277
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.271 Vali Acc: 0.750 Test Loss: 1.271 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 289926
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4933385848999023
Epoch: 1, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.154 Vali Acc: 0.594 Test Loss: 1.154 Test Acc: 0.594
Validation loss decreased (inf --> -0.594433).  Saving model ...
Epoch: 2 cost time: 1.0703387260437012
Epoch: 2, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.748 Vali Acc: 0.694 Test Loss: 0.748 Test Acc: 0.694
Validation loss decreased (-0.594433 --> -0.694437).  Saving model ...
Epoch: 3 cost time: 1.075390100479126
Epoch: 3, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.629 Vali Acc: 0.728 Test Loss: 0.629 Test Acc: 0.728
Validation loss decreased (-0.694437 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 1.0273582935333252
Epoch: 4, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.755 Vali Acc: 0.706 Test Loss: 0.755 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0339419841766357
Epoch: 5, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.679 Vali Acc: 0.761 Test Loss: 0.679 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761104).  Saving model ...
Epoch: 6 cost time: 0.978989839553833
Epoch: 6, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.728 Vali Acc: 0.767 Test Loss: 0.728 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766659).  Saving model ...
Epoch: 7 cost time: 1.0164356231689453
Epoch: 7, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.810 Vali Acc: 0.744 Test Loss: 0.810 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1288800239562988
Epoch: 8, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.820 Vali Acc: 0.761 Test Loss: 0.820 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1077196598052979
Epoch: 9, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.869 Vali Acc: 0.761 Test Loss: 0.869 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0996673107147217
Epoch: 10, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.910 Vali Acc: 0.761 Test Loss: 0.910 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0903234481811523
Epoch: 11, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.065 Vali Acc: 0.750 Test Loss: 1.065 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1081852912902832
Epoch: 12, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.054 Vali Acc: 0.744 Test Loss: 1.054 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0489559173583984
Epoch: 13, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.990 Vali Acc: 0.756 Test Loss: 0.990 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0351338386535645
Epoch: 14, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.031 Vali Acc: 0.750 Test Loss: 1.031 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9866094589233398
Epoch: 15, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.054 Vali Acc: 0.744 Test Loss: 1.054 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0831842422485352
Epoch: 16, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.093 Vali Acc: 0.761 Test Loss: 1.093 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 280774
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.599270820617676
Epoch: 1, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.254 Vali Acc: 0.522 Test Loss: 1.254 Test Acc: 0.522
Validation loss decreased (inf --> -0.522210).  Saving model ...
Epoch: 2 cost time: 1.124922752380371
Epoch: 2, Steps: 12 | Train Loss: 0.967 Vali Loss: 0.855 Vali Acc: 0.639 Test Loss: 0.855 Test Acc: 0.639
Validation loss decreased (-0.522210 --> -0.638880).  Saving model ...
Epoch: 3 cost time: 1.088519811630249
Epoch: 3, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.668 Vali Acc: 0.744 Test Loss: 0.668 Test Acc: 0.744
Validation loss decreased (-0.638880 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 1.2011148929595947
Epoch: 4, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.661 Vali Acc: 0.783 Test Loss: 0.661 Test Acc: 0.783
Validation loss decreased (-0.744438 --> -0.783327).  Saving model ...
Epoch: 5 cost time: 1.0795001983642578
Epoch: 5, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.880 Vali Acc: 0.689 Test Loss: 0.880 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.108726978302002
Epoch: 6, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.673 Vali Acc: 0.733 Test Loss: 0.673 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0711345672607422
Epoch: 7, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.820 Vali Acc: 0.744 Test Loss: 0.820 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0562353134155273
Epoch: 8, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.686 Vali Acc: 0.750 Test Loss: 0.686 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1232554912567139
Epoch: 9, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.796 Vali Acc: 0.739 Test Loss: 0.796 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1008491516113281
Epoch: 10, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.901 Vali Acc: 0.761 Test Loss: 0.901 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0783507823944092
Epoch: 11, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.978 Vali Acc: 0.739 Test Loss: 0.978 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.045583963394165
Epoch: 12, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.967 Vali Acc: 0.778 Test Loss: 0.967 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2303869724273682
Epoch: 13, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.988 Vali Acc: 0.750 Test Loss: 0.988 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1058039665222168
Epoch: 14, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 207174
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6162109375
Epoch: 1, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.397 Vali Acc: 0.456 Test Loss: 1.397 Test Acc: 0.456
Validation loss decreased (inf --> -0.455542).  Saving model ...
Epoch: 2 cost time: 0.9299149513244629
Epoch: 2, Steps: 12 | Train Loss: 1.040 Vali Loss: 0.913 Vali Acc: 0.589 Test Loss: 0.913 Test Acc: 0.589
Validation loss decreased (-0.455542 --> -0.588880).  Saving model ...
Epoch: 3 cost time: 1.0028061866760254
Epoch: 3, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.799 Vali Acc: 0.650 Test Loss: 0.799 Test Acc: 0.650
Validation loss decreased (-0.588880 --> -0.649992).  Saving model ...
Epoch: 4 cost time: 0.9390122890472412
Epoch: 4, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.668 Vali Acc: 0.722 Test Loss: 0.668 Test Acc: 0.722
Validation loss decreased (-0.649992 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 0.9296243190765381
Epoch: 5, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.665 Vali Acc: 0.744 Test Loss: 0.665 Test Acc: 0.744
Validation loss decreased (-0.722216 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 0.9712991714477539
Epoch: 6, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.613 Vali Acc: 0.761 Test Loss: 0.613 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 0.9045183658599854
Epoch: 7, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.674 Vali Acc: 0.722 Test Loss: 0.674 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9398195743560791
Epoch: 8, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.784 Vali Acc: 0.778 Test Loss: 0.784 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777770).  Saving model ...
Epoch: 9 cost time: 1.0191547870635986
Epoch: 9, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.665 Vali Acc: 0.778 Test Loss: 0.665 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777771).  Saving model ...
Epoch: 10 cost time: 1.08998703956604
Epoch: 10, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.829 Vali Acc: 0.744 Test Loss: 0.829 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0407116413116455
Epoch: 11, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.790 Vali Acc: 0.739 Test Loss: 0.790 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.033233642578125
Epoch: 12, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.819 Vali Acc: 0.761 Test Loss: 0.819 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0017778873443604
Epoch: 13, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.923 Vali Acc: 0.744 Test Loss: 0.923 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1013715267181396
Epoch: 14, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.900 Vali Acc: 0.744 Test Loss: 0.900 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0308690071105957
Epoch: 15, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.910 Vali Acc: 0.756 Test Loss: 0.910 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0911872386932373
Epoch: 16, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.936 Vali Acc: 0.739 Test Loss: 0.936 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0714218616485596
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0556864738464355
Epoch: 18, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.944 Vali Acc: 0.739 Test Loss: 0.944 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9938108921051025
Epoch: 19, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.934 Vali Acc: 0.756 Test Loss: 0.934 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 161222
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.246056079864502
Epoch: 1, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.452 Vali Acc: 0.444 Test Loss: 1.452 Test Acc: 0.444
Validation loss decreased (inf --> -0.444430).  Saving model ...
Epoch: 2 cost time: 0.9404401779174805
Epoch: 2, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.027 Vali Acc: 0.611 Test Loss: 1.027 Test Acc: 0.611
Validation loss decreased (-0.444430 --> -0.611101).  Saving model ...
Epoch: 3 cost time: 0.9876353740692139
Epoch: 3, Steps: 12 | Train Loss: 0.853 Vali Loss: 0.850 Vali Acc: 0.656 Test Loss: 0.850 Test Acc: 0.656
Validation loss decreased (-0.611101 --> -0.655547).  Saving model ...
Epoch: 4 cost time: 0.9610052108764648
Epoch: 4, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.737 Vali Acc: 0.683 Test Loss: 0.737 Test Acc: 0.683
Validation loss decreased (-0.655547 --> -0.683326).  Saving model ...
Epoch: 5 cost time: 0.9538700580596924
Epoch: 5, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.671 Vali Acc: 0.728 Test Loss: 0.671 Test Acc: 0.728
Validation loss decreased (-0.683326 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.0066962242126465
Epoch: 6, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.669 Vali Acc: 0.694 Test Loss: 0.669 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0140767097473145
Epoch: 7, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.685 Vali Acc: 0.728 Test Loss: 0.685 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8987772464752197
Epoch: 8, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.701 Vali Acc: 0.739 Test Loss: 0.701 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738882).  Saving model ...
Epoch: 9 cost time: 0.8550429344177246
Epoch: 9, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.728 Vali Acc: 0.744 Test Loss: 0.728 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744437).  Saving model ...
Epoch: 10 cost time: 0.8568623065948486
Epoch: 10, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.713 Vali Acc: 0.728 Test Loss: 0.713 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9136898517608643
Epoch: 11, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.771 Vali Acc: 0.722 Test Loss: 0.771 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9370291233062744
Epoch: 12, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.734 Vali Acc: 0.750 Test Loss: 0.734 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 0.8576288223266602
Epoch: 13, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.790 Vali Acc: 0.744 Test Loss: 0.790 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8956856727600098
Epoch: 14, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.782 Vali Acc: 0.739 Test Loss: 0.782 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9058713912963867
Epoch: 15, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.857 Vali Acc: 0.733 Test Loss: 0.857 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8918955326080322
Epoch: 16, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.933 Vali Acc: 0.739 Test Loss: 0.933 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9217345714569092
Epoch: 17, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9091496467590332
Epoch: 18, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.855 Vali Acc: 0.744 Test Loss: 0.855 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9443538188934326
Epoch: 19, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.875 Vali Acc: 0.739 Test Loss: 0.875 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9063124656677246
Epoch: 20, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.888 Vali Acc: 0.733 Test Loss: 0.888 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9121639728546143
Epoch: 21, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.948 Vali Acc: 0.728 Test Loss: 0.948 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8966827392578125
Epoch: 22, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.953 Vali Acc: 0.728 Test Loss: 0.953 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.75
model parameter : 124550
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2972335815429688
Epoch: 1, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.427 Vali Acc: 0.461 Test Loss: 1.427 Test Acc: 0.461
Validation loss decreased (inf --> -0.461097).  Saving model ...
Epoch: 2 cost time: 0.8520212173461914
Epoch: 2, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
Validation loss decreased (-0.461097 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.8953800201416016
Epoch: 3, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.846 Vali Acc: 0.683 Test Loss: 0.846 Test Acc: 0.683
Validation loss decreased (-0.599990 --> -0.683325).  Saving model ...
Epoch: 4 cost time: 0.9181389808654785
Epoch: 4, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.723 Vali Acc: 0.717 Test Loss: 0.723 Test Acc: 0.717
Validation loss decreased (-0.683325 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 0.8326663970947266
Epoch: 5, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.656 Vali Acc: 0.739 Test Loss: 0.656 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 0.7506310939788818
Epoch: 6, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.644 Vali Acc: 0.739 Test Loss: 0.644 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 7 cost time: 0.9131245613098145
Epoch: 7, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.626 Vali Acc: 0.761 Test Loss: 0.626 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761105).  Saving model ...
Epoch: 8 cost time: 0.8969895839691162
Epoch: 8, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.639 Vali Acc: 0.744 Test Loss: 0.639 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9522590637207031
Epoch: 9, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.644 Vali Acc: 0.744 Test Loss: 0.644 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8381645679473877
Epoch: 10, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.666 Vali Acc: 0.739 Test Loss: 0.666 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8702843189239502
Epoch: 11, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.678 Vali Acc: 0.739 Test Loss: 0.678 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9364135265350342
Epoch: 12, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.725 Vali Acc: 0.767 Test Loss: 0.725 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766659).  Saving model ...
Epoch: 13 cost time: 0.8603851795196533
Epoch: 13, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.722 Vali Acc: 0.739 Test Loss: 0.722 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8189284801483154
Epoch: 14, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.735 Vali Acc: 0.756 Test Loss: 0.735 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9262161254882812
Epoch: 15, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.716 Vali Acc: 0.761 Test Loss: 0.716 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8472805023193359
Epoch: 16, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.785 Vali Acc: 0.756 Test Loss: 0.785 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8127946853637695
Epoch: 17, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.765 Vali Acc: 0.756 Test Loss: 0.765 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8818252086639404
Epoch: 18, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.820 Vali Acc: 0.767 Test Loss: 0.820 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8247594833374023
Epoch: 19, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6563708782196045
Epoch: 20, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.815 Vali Acc: 0.772 Test Loss: 0.815 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772214).  Saving model ...
Epoch: 21 cost time: 0.7691090106964111
Epoch: 21, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.831 Vali Acc: 0.756 Test Loss: 0.831 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8222346305847168
Epoch: 22, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.806 Vali Acc: 0.761 Test Loss: 0.806 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9289631843566895
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8638896942138672
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.850 Vali Acc: 0.756 Test Loss: 0.850 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9305274486541748
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.867 Vali Acc: 0.778 Test Loss: 0.867 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777769).  Saving model ...
Epoch: 26 cost time: 0.7883801460266113
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.866 Vali Acc: 0.750 Test Loss: 0.866 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7822206020355225
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.876 Vali Acc: 0.756 Test Loss: 0.876 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8613779544830322
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.902 Vali Acc: 0.756 Test Loss: 0.902 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8978493213653564
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.908 Vali Acc: 0.756 Test Loss: 0.908 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.858454704284668
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.937 Vali Acc: 0.761 Test Loss: 0.937 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8133351802825928
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.931 Vali Acc: 0.756 Test Loss: 0.931 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8464095592498779
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.899 Vali Acc: 0.761 Test Loss: 0.899 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9175350666046143
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.915 Vali Acc: 0.761 Test Loss: 0.915 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8445777893066406
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.938 Vali Acc: 0.767 Test Loss: 0.938 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7290453910827637
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.943 Vali Acc: 0.767 Test Loss: 0.943 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 115462
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5617129802703857
Epoch: 1, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.026 Vali Acc: 0.572 Test Loss: 1.026 Test Acc: 0.572
Validation loss decreased (inf --> -0.572212).  Saving model ...
Epoch: 2 cost time: 1.0843679904937744
Epoch: 2, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.033 Vali Acc: 0.628 Test Loss: 1.033 Test Acc: 0.628
Validation loss decreased (-0.572212 --> -0.627767).  Saving model ...
Epoch: 3 cost time: 1.1575117111206055
Epoch: 3, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.867 Vali Acc: 0.689 Test Loss: 0.867 Test Acc: 0.689
Validation loss decreased (-0.627767 --> -0.688880).  Saving model ...
Epoch: 4 cost time: 1.1264002323150635
Epoch: 4, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.808 Vali Acc: 0.728 Test Loss: 0.808 Test Acc: 0.728
Validation loss decreased (-0.688880 --> -0.727770).  Saving model ...
Epoch: 5 cost time: 1.0719664096832275
Epoch: 5, Steps: 12 | Train Loss: 0.316 Vali Loss: 1.222 Vali Acc: 0.689 Test Loss: 1.222 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.111229419708252
Epoch: 6, Steps: 12 | Train Loss: 0.193 Vali Loss: 1.057 Vali Acc: 0.678 Test Loss: 1.057 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1400949954986572
Epoch: 7, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.322 Vali Acc: 0.661 Test Loss: 1.322 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1702101230621338
Epoch: 8, Steps: 12 | Train Loss: 0.228 Vali Loss: 1.601 Vali Acc: 0.739 Test Loss: 1.601 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738873).  Saving model ...
Epoch: 9 cost time: 1.099625587463379
Epoch: 9, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.500 Vali Acc: 0.733 Test Loss: 1.500 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0518574714660645
Epoch: 10, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.660 Vali Acc: 0.739 Test Loss: 1.660 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1994733810424805
Epoch: 11, Steps: 12 | Train Loss: 0.089 Vali Loss: 1.810 Vali Acc: 0.706 Test Loss: 1.810 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1217117309570312
Epoch: 12, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.470 Vali Acc: 0.733 Test Loss: 1.470 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1606075763702393
Epoch: 13, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.889 Vali Acc: 0.744 Test Loss: 1.889 Test Acc: 0.744
Validation loss decreased (-0.738873 --> -0.744426).  Saving model ...
Epoch: 14 cost time: 1.2002198696136475
Epoch: 14, Steps: 12 | Train Loss: 0.050 Vali Loss: 2.194 Vali Acc: 0.706 Test Loss: 2.194 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1337506771087646
Epoch: 15, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.773 Vali Acc: 0.778 Test Loss: 1.773 Test Acc: 0.778
Validation loss decreased (-0.744426 --> -0.777760).  Saving model ...
Epoch: 16 cost time: 1.0727818012237549
Epoch: 16, Steps: 12 | Train Loss: 0.069 Vali Loss: 2.027 Vali Acc: 0.706 Test Loss: 2.027 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0323772430419922
Epoch: 17, Steps: 12 | Train Loss: 0.038 Vali Loss: 2.505 Vali Acc: 0.694 Test Loss: 2.505 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1484713554382324
Epoch: 18, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.893 Vali Acc: 0.772 Test Loss: 1.893 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0046968460083008
Epoch: 19, Steps: 12 | Train Loss: 0.014 Vali Loss: 2.346 Vali Acc: 0.744 Test Loss: 2.346 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.190572738647461
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 4.645 Vali Acc: 0.661 Test Loss: 4.645 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1352345943450928
Epoch: 21, Steps: 12 | Train Loss: 0.334 Vali Loss: 2.934 Vali Acc: 0.750 Test Loss: 2.934 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2147901058197021
Epoch: 22, Steps: 12 | Train Loss: 0.169 Vali Loss: 3.594 Vali Acc: 0.744 Test Loss: 3.594 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1453073024749756
Epoch: 23, Steps: 12 | Train Loss: 0.487 Vali Loss: 4.371 Vali Acc: 0.700 Test Loss: 4.371 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1406440734863281
Epoch: 24, Steps: 12 | Train Loss: 0.125 Vali Loss: 3.402 Vali Acc: 0.767 Test Loss: 3.402 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1075100898742676
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 4.210 Vali Acc: 0.733 Test Loss: 4.210 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 503750
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4397571086883545
Epoch: 1, Steps: 12 | Train Loss: 1.521 Vali Loss: 1.108 Vali Acc: 0.567 Test Loss: 1.108 Test Acc: 0.567
Validation loss decreased (inf --> -0.566656).  Saving model ...
Epoch: 2 cost time: 1.0007696151733398
Epoch: 2, Steps: 12 | Train Loss: 0.865 Vali Loss: 0.899 Vali Acc: 0.622 Test Loss: 0.899 Test Acc: 0.622
Validation loss decreased (-0.566656 --> -0.622213).  Saving model ...
Epoch: 3 cost time: 1.0013196468353271
Epoch: 3, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.745 Vali Acc: 0.711 Test Loss: 0.745 Test Acc: 0.711
Validation loss decreased (-0.622213 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.0203301906585693
Epoch: 4, Steps: 12 | Train Loss: 0.384 Vali Loss: 1.226 Vali Acc: 0.650 Test Loss: 1.226 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0666792392730713
Epoch: 5, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.736 Vali Acc: 0.756 Test Loss: 0.736 Test Acc: 0.756
Validation loss decreased (-0.711104 --> -0.755548).  Saving model ...
Epoch: 6 cost time: 1.0030031204223633
Epoch: 6, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.720 Vali Acc: 0.750 Test Loss: 0.720 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9410345554351807
Epoch: 7, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.061 Vali Acc: 0.694 Test Loss: 1.061 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9360239505767822
Epoch: 8, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.915 Vali Acc: 0.761 Test Loss: 0.915 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761102).  Saving model ...
Epoch: 9 cost time: 0.9268088340759277
Epoch: 9, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.948 Vali Acc: 0.722 Test Loss: 0.948 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9931924343109131
Epoch: 10, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.203 Vali Acc: 0.744 Test Loss: 1.203 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9758040904998779
Epoch: 11, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.206 Vali Acc: 0.744 Test Loss: 1.206 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0294184684753418
Epoch: 12, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.988 Vali Acc: 0.767 Test Loss: 0.988 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766657).  Saving model ...
Epoch: 13 cost time: 0.9387340545654297
Epoch: 13, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.235 Vali Acc: 0.733 Test Loss: 1.235 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9767751693725586
Epoch: 14, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.188 Vali Acc: 0.756 Test Loss: 1.188 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9785013198852539
Epoch: 15, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.187 Vali Acc: 0.750 Test Loss: 1.187 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0045785903930664
Epoch: 16, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.149 Vali Acc: 0.761 Test Loss: 1.149 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9743514060974121
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.257 Vali Acc: 0.750 Test Loss: 1.257 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9643237590789795
Epoch: 18, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.302 Vali Acc: 0.733 Test Loss: 1.302 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9936189651489258
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.232 Vali Acc: 0.761 Test Loss: 1.232 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.024653434753418
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.302 Vali Acc: 0.750 Test Loss: 1.302 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9111979007720947
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.744 Test Loss: 1.401 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0152430534362793
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.728 Test Loss: 1.352 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 273414
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3543193340301514
Epoch: 1, Steps: 12 | Train Loss: 1.907 Vali Loss: 1.181 Vali Acc: 0.594 Test Loss: 1.181 Test Acc: 0.594
Validation loss decreased (inf --> -0.594433).  Saving model ...
Epoch: 2 cost time: 0.9815981388092041
Epoch: 2, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.797 Vali Acc: 0.678 Test Loss: 0.797 Test Acc: 0.678
Validation loss decreased (-0.594433 --> -0.677770).  Saving model ...
Epoch: 3 cost time: 0.9831089973449707
Epoch: 3, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
Validation loss decreased (-0.677770 --> -0.722216).  Saving model ...
Epoch: 4 cost time: 1.031921625137329
Epoch: 4, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.782 Vali Acc: 0.728 Test Loss: 0.782 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727770).  Saving model ...
Epoch: 5 cost time: 1.0773131847381592
Epoch: 5, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.633 Vali Acc: 0.783 Test Loss: 0.633 Test Acc: 0.783
Validation loss decreased (-0.727770 --> -0.783327).  Saving model ...
Epoch: 6 cost time: 1.1484930515289307
Epoch: 6, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.884 Vali Acc: 0.717 Test Loss: 0.884 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.19789457321167
Epoch: 7, Steps: 12 | Train Loss: 0.327 Vali Loss: 1.358 Vali Acc: 0.711 Test Loss: 1.358 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1686131954193115
Epoch: 8, Steps: 12 | Train Loss: 0.254 Vali Loss: 1.067 Vali Acc: 0.728 Test Loss: 1.067 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0660409927368164
Epoch: 9, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.010 Vali Acc: 0.733 Test Loss: 1.010 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1139805316925049
Epoch: 10, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.960 Vali Acc: 0.767 Test Loss: 0.960 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1060402393341064
Epoch: 11, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.987 Vali Acc: 0.761 Test Loss: 0.987 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0078327655792236
Epoch: 12, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.114 Vali Acc: 0.772 Test Loss: 1.114 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0747151374816895
Epoch: 13, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.233 Vali Acc: 0.750 Test Loss: 1.233 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0460877418518066
Epoch: 14, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.224 Vali Acc: 0.728 Test Loss: 1.224 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0408072471618652
Epoch: 15, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.186 Vali Acc: 0.744 Test Loss: 1.186 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 264262
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.575589895248413
Epoch: 1, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.310 Vali Acc: 0.567 Test Loss: 1.310 Test Acc: 0.567
Validation loss decreased (inf --> -0.566654).  Saving model ...
Epoch: 2 cost time: 1.1505041122436523
Epoch: 2, Steps: 12 | Train Loss: 0.931 Vali Loss: 0.906 Vali Acc: 0.606 Test Loss: 0.906 Test Acc: 0.606
Validation loss decreased (-0.566654 --> -0.605546).  Saving model ...
Epoch: 3 cost time: 1.1089112758636475
Epoch: 3, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.840 Vali Acc: 0.650 Test Loss: 0.840 Test Acc: 0.650
Validation loss decreased (-0.605546 --> -0.649992).  Saving model ...
Epoch: 4 cost time: 1.0886528491973877
Epoch: 4, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.682 Vali Acc: 0.728 Test Loss: 0.682 Test Acc: 0.728
Validation loss decreased (-0.649992 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 1.1854760646820068
Epoch: 5, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.639 Vali Acc: 0.717 Test Loss: 0.639 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0764753818511963
Epoch: 6, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.728 Vali Acc: 0.761 Test Loss: 0.728 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761104).  Saving model ...
Epoch: 7 cost time: 1.0858592987060547
Epoch: 7, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.822 Vali Acc: 0.739 Test Loss: 0.822 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.102829933166504
Epoch: 8, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.746 Vali Acc: 0.761 Test Loss: 0.746 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0643696784973145
Epoch: 9, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.094 Vali Acc: 0.717 Test Loss: 1.094 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0924794673919678
Epoch: 10, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.881 Vali Acc: 0.750 Test Loss: 0.881 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0859572887420654
Epoch: 11, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.883 Vali Acc: 0.744 Test Loss: 0.883 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.053980827331543
Epoch: 12, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.218 Vali Acc: 0.744 Test Loss: 1.218 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1474931240081787
Epoch: 13, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.025 Vali Acc: 0.756 Test Loss: 1.025 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1344192028045654
Epoch: 14, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.141 Vali Acc: 0.750 Test Loss: 1.141 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1012535095214844
Epoch: 15, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.961 Vali Acc: 0.761 Test Loss: 0.961 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2091608047485352
Epoch: 16, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.043 Vali Acc: 0.744 Test Loss: 1.043 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 190662
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3297290802001953
Epoch: 1, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.392 Vali Acc: 0.544 Test Loss: 1.392 Test Acc: 0.544
Validation loss decreased (inf --> -0.544431).  Saving model ...
Epoch: 2 cost time: 0.9223453998565674
Epoch: 2, Steps: 12 | Train Loss: 1.093 Vali Loss: 0.919 Vali Acc: 0.678 Test Loss: 0.919 Test Acc: 0.678
Validation loss decreased (-0.544431 --> -0.677769).  Saving model ...
Epoch: 3 cost time: 0.9108624458312988
Epoch: 3, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.805 Vali Acc: 0.700 Test Loss: 0.805 Test Acc: 0.700
Validation loss decreased (-0.677769 --> -0.699992).  Saving model ...
Epoch: 4 cost time: 0.954268217086792
Epoch: 4, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.702 Vali Acc: 0.717 Test Loss: 0.702 Test Acc: 0.717
Validation loss decreased (-0.699992 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 0.9432454109191895
Epoch: 5, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.598 Vali Acc: 0.767 Test Loss: 0.598 Test Acc: 0.767
Validation loss decreased (-0.716660 --> -0.766661).  Saving model ...
Epoch: 6 cost time: 0.9315626621246338
Epoch: 6, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.665 Vali Acc: 0.744 Test Loss: 0.665 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8620219230651855
Epoch: 7, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.682 Vali Acc: 0.739 Test Loss: 0.682 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0083541870117188
Epoch: 8, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.844 Vali Acc: 0.744 Test Loss: 0.844 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9789671897888184
Epoch: 9, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.705 Vali Acc: 0.756 Test Loss: 0.705 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.04323148727417
Epoch: 10, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.780 Vali Acc: 0.739 Test Loss: 0.780 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9807732105255127
Epoch: 11, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.826 Vali Acc: 0.733 Test Loss: 0.826 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0642564296722412
Epoch: 12, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.910 Vali Acc: 0.722 Test Loss: 0.910 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0273220539093018
Epoch: 13, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.831 Vali Acc: 0.761 Test Loss: 0.831 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9418118000030518
Epoch: 14, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.014 Vali Acc: 0.744 Test Loss: 1.014 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0070536136627197
Epoch: 15, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.898 Vali Acc: 0.739 Test Loss: 0.898 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 144710
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.352184772491455
Epoch: 1, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.501 Vali Acc: 0.472 Test Loss: 1.501 Test Acc: 0.472
Validation loss decreased (inf --> -0.472207).  Saving model ...
Epoch: 2 cost time: 0.9379019737243652
Epoch: 2, Steps: 12 | Train Loss: 1.270 Vali Loss: 1.042 Vali Acc: 0.611 Test Loss: 1.042 Test Acc: 0.611
Validation loss decreased (-0.472207 --> -0.611101).  Saving model ...
Epoch: 3 cost time: 0.879784345626831
Epoch: 3, Steps: 12 | Train Loss: 0.901 Vali Loss: 0.887 Vali Acc: 0.628 Test Loss: 0.887 Test Acc: 0.628
Validation loss decreased (-0.611101 --> -0.627769).  Saving model ...
Epoch: 4 cost time: 0.9076752662658691
Epoch: 4, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.791 Vali Acc: 0.706 Test Loss: 0.791 Test Acc: 0.706
Validation loss decreased (-0.627769 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 0.9805638790130615
Epoch: 5, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.671 Vali Acc: 0.717 Test Loss: 0.671 Test Acc: 0.717
Validation loss decreased (-0.705548 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 0.9417970180511475
Epoch: 6, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.667 Vali Acc: 0.722 Test Loss: 0.667 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 0.855363130569458
Epoch: 7, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.716 Vali Acc: 0.717 Test Loss: 0.716 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9808945655822754
Epoch: 8, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.655 Vali Acc: 0.750 Test Loss: 0.655 Test Acc: 0.750
Validation loss decreased (-0.722216 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 0.9892411231994629
Epoch: 9, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.731 Vali Acc: 0.722 Test Loss: 0.731 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8644630908966064
Epoch: 10, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.731 Vali Acc: 0.756 Test Loss: 0.731 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755548).  Saving model ...
Epoch: 11 cost time: 1.0608675479888916
Epoch: 11, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.701 Vali Acc: 0.750 Test Loss: 0.701 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.963848352432251
Epoch: 12, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.743 Vali Acc: 0.728 Test Loss: 0.743 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8782944679260254
Epoch: 13, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.776 Vali Acc: 0.733 Test Loss: 0.776 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7657742500305176
Epoch: 14, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.898 Vali Acc: 0.728 Test Loss: 0.898 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7998256683349609
Epoch: 15, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.858 Vali Acc: 0.728 Test Loss: 0.858 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7919008731842041
Epoch: 16, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.897 Vali Acc: 0.717 Test Loss: 0.897 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7992281913757324
Epoch: 17, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.883 Vali Acc: 0.733 Test Loss: 0.883 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7897801399230957
Epoch: 18, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.912 Vali Acc: 0.728 Test Loss: 0.912 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7217020988464355
Epoch: 19, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.929 Vali Acc: 0.722 Test Loss: 0.929 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8673214912414551
Epoch: 20, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.926 Vali Acc: 0.733 Test Loss: 0.926 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 108038
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.280801296234131
Epoch: 1, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.447 Vali Acc: 0.489 Test Loss: 1.447 Test Acc: 0.489
Validation loss decreased (inf --> -0.488874).  Saving model ...
Epoch: 2 cost time: 0.718285083770752
Epoch: 2, Steps: 12 | Train Loss: 1.208 Vali Loss: 1.029 Vali Acc: 0.628 Test Loss: 1.029 Test Acc: 0.628
Validation loss decreased (-0.488874 --> -0.627767).  Saving model ...
Epoch: 3 cost time: 0.7319672107696533
Epoch: 3, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.842 Vali Acc: 0.661 Test Loss: 0.842 Test Acc: 0.661
Validation loss decreased (-0.627767 --> -0.661103).  Saving model ...
Epoch: 4 cost time: 0.8071906566619873
Epoch: 4, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.769 Vali Acc: 0.700 Test Loss: 0.769 Test Acc: 0.700
Validation loss decreased (-0.661103 --> -0.699992).  Saving model ...
Epoch: 5 cost time: 0.7554824352264404
Epoch: 5, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.681 Vali Acc: 0.756 Test Loss: 0.681 Test Acc: 0.756
Validation loss decreased (-0.699992 --> -0.755549).  Saving model ...
Epoch: 6 cost time: 0.7536308765411377
Epoch: 6, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.657 Vali Acc: 0.739 Test Loss: 0.657 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8502466678619385
Epoch: 7, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.625 Vali Acc: 0.728 Test Loss: 0.625 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7723603248596191
Epoch: 8, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.639 Vali Acc: 0.744 Test Loss: 0.639 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7515668869018555
Epoch: 9, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.662 Vali Acc: 0.744 Test Loss: 0.662 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7917447090148926
Epoch: 10, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.667 Vali Acc: 0.750 Test Loss: 0.667 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7815356254577637
Epoch: 11, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.692 Vali Acc: 0.728 Test Loss: 0.692 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7274770736694336
Epoch: 12, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.709 Vali Acc: 0.728 Test Loss: 0.709 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7789862155914307
Epoch: 13, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.708 Vali Acc: 0.739 Test Loss: 0.708 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7091021537780762
Epoch: 14, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.793 Vali Acc: 0.733 Test Loss: 0.793 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7988464832305908
Epoch: 15, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.726 Vali Acc: 0.756 Test Loss: 0.726 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 98950
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.608083963394165
Epoch: 1, Steps: 12 | Train Loss: 1.509 Vali Loss: 1.407 Vali Acc: 0.567 Test Loss: 1.407 Test Acc: 0.567
Validation loss decreased (inf --> -0.566653).  Saving model ...
Epoch: 2 cost time: 1.0968453884124756
Epoch: 2, Steps: 12 | Train Loss: 0.916 Vali Loss: 0.822 Vali Acc: 0.683 Test Loss: 0.822 Test Acc: 0.683
Validation loss decreased (-0.566653 --> -0.683325).  Saving model ...
Epoch: 3 cost time: 1.0746519565582275
Epoch: 3, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.615 Vali Acc: 0.744 Test Loss: 0.615 Test Acc: 0.744
Validation loss decreased (-0.683325 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 1.2012677192687988
Epoch: 4, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.923 Vali Acc: 0.683 Test Loss: 0.923 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0430099964141846
Epoch: 5, Steps: 12 | Train Loss: 0.241 Vali Loss: 1.170 Vali Acc: 0.722 Test Loss: 1.170 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.125976800918579
Epoch: 6, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.923 Vali Acc: 0.744 Test Loss: 0.923 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9559147357940674
Epoch: 7, Steps: 12 | Train Loss: 0.261 Vali Loss: 1.294 Vali Acc: 0.717 Test Loss: 1.294 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0794250965118408
Epoch: 8, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.178 Vali Acc: 0.772 Test Loss: 1.178 Test Acc: 0.772
Validation loss decreased (-0.744438 --> -0.772210).  Saving model ...
Epoch: 9 cost time: 1.0466434955596924
Epoch: 9, Steps: 12 | Train Loss: 0.095 Vali Loss: 2.584 Vali Acc: 0.711 Test Loss: 2.584 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0756239891052246
Epoch: 10, Steps: 12 | Train Loss: 0.527 Vali Loss: 2.465 Vali Acc: 0.661 Test Loss: 2.465 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1229565143585205
Epoch: 11, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.624 Vali Acc: 0.722 Test Loss: 1.624 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.042937994003296
Epoch: 12, Steps: 12 | Train Loss: 0.202 Vali Loss: 2.862 Vali Acc: 0.678 Test Loss: 2.862 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.066303014755249
Epoch: 13, Steps: 12 | Train Loss: 0.265 Vali Loss: 2.598 Vali Acc: 0.728 Test Loss: 2.598 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9858992099761963
Epoch: 14, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.432 Vali Acc: 0.767 Test Loss: 1.432 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.117851734161377
Epoch: 15, Steps: 12 | Train Loss: 0.172 Vali Loss: 2.922 Vali Acc: 0.756 Test Loss: 2.922 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1426129341125488
Epoch: 16, Steps: 12 | Train Loss: 0.078 Vali Loss: 2.795 Vali Acc: 0.694 Test Loss: 2.795 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1158835887908936
Epoch: 17, Steps: 12 | Train Loss: 0.010 Vali Loss: 2.248 Vali Acc: 0.728 Test Loss: 2.248 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1545989513397217
Epoch: 18, Steps: 12 | Train Loss: 0.026 Vali Loss: 2.627 Vali Acc: 0.728 Test Loss: 2.627 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 495494
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4681272506713867
Epoch: 1, Steps: 12 | Train Loss: 1.677 Vali Loss: 1.129 Vali Acc: 0.606 Test Loss: 1.129 Test Acc: 0.606
Validation loss decreased (inf --> -0.605544).  Saving model ...
Epoch: 2 cost time: 0.9270024299621582
Epoch: 2, Steps: 12 | Train Loss: 0.859 Vali Loss: 0.742 Vali Acc: 0.683 Test Loss: 0.742 Test Acc: 0.683
Validation loss decreased (-0.605544 --> -0.683326).  Saving model ...
Epoch: 3 cost time: 0.9431915283203125
Epoch: 3, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.732 Vali Acc: 0.728 Test Loss: 0.732 Test Acc: 0.728
Validation loss decreased (-0.683326 --> -0.727770).  Saving model ...
Epoch: 4 cost time: 0.8513712882995605
Epoch: 4, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.755 Vali Acc: 0.728 Test Loss: 0.755 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9626264572143555
Epoch: 5, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.732 Vali Acc: 0.739 Test Loss: 0.732 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 0.9577653408050537
Epoch: 6, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.782 Vali Acc: 0.722 Test Loss: 0.782 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.896014928817749
Epoch: 7, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.806 Vali Acc: 0.750 Test Loss: 0.806 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 0.8695549964904785
Epoch: 8, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.798 Vali Acc: 0.722 Test Loss: 0.798 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9487318992614746
Epoch: 9, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.073 Vali Acc: 0.706 Test Loss: 1.073 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9938206672668457
Epoch: 10, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.791 Vali Acc: 0.756 Test Loss: 0.791 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 11 cost time: 0.9255523681640625
Epoch: 11, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.419 Vali Acc: 0.739 Test Loss: 1.419 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8454298973083496
Epoch: 12, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.112 Vali Acc: 0.772 Test Loss: 1.112 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772211).  Saving model ...
Epoch: 13 cost time: 0.8122684955596924
Epoch: 13, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.130 Vali Acc: 0.750 Test Loss: 1.130 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8580822944641113
Epoch: 14, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.103 Vali Acc: 0.756 Test Loss: 1.103 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.121750831604004
Epoch: 15, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.193 Vali Acc: 0.761 Test Loss: 1.193 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9806976318359375
Epoch: 16, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.155 Vali Acc: 0.761 Test Loss: 1.155 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9946870803833008
Epoch: 17, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.181 Vali Acc: 0.761 Test Loss: 1.181 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9498963356018066
Epoch: 18, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.163 Vali Acc: 0.761 Test Loss: 1.163 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.991490364074707
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.134 Vali Acc: 0.756 Test Loss: 1.134 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0043649673461914
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.155 Vali Acc: 0.756 Test Loss: 1.155 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0099480152130127
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.165 Vali Acc: 0.756 Test Loss: 1.165 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0080347061157227
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.756 Test Loss: 1.175 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 265158
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5234906673431396
Epoch: 1, Steps: 12 | Train Loss: 1.588 Vali Loss: 1.079 Vali Acc: 0.617 Test Loss: 1.079 Test Acc: 0.617
Validation loss decreased (inf --> -0.616656).  Saving model ...
Epoch: 2 cost time: 1.0032203197479248
Epoch: 2, Steps: 12 | Train Loss: 0.921 Vali Loss: 0.855 Vali Acc: 0.644 Test Loss: 0.855 Test Acc: 0.644
Validation loss decreased (-0.616656 --> -0.644436).  Saving model ...
Epoch: 3 cost time: 1.1167795658111572
Epoch: 3, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.954 Vali Acc: 0.644 Test Loss: 0.954 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1173005104064941
Epoch: 4, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.685 Vali Acc: 0.733 Test Loss: 0.685 Test Acc: 0.733
Validation loss decreased (-0.644436 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 1.1169939041137695
Epoch: 5, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.733 Vali Acc: 0.739 Test Loss: 0.733 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 1.0835802555084229
Epoch: 6, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.842 Vali Acc: 0.733 Test Loss: 0.842 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2039315700531006
Epoch: 7, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.785 Vali Acc: 0.711 Test Loss: 0.785 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.019219160079956
Epoch: 8, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.194 Vali Acc: 0.733 Test Loss: 1.194 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.021740436553955
Epoch: 9, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.934 Vali Acc: 0.733 Test Loss: 0.934 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0513973236083984
Epoch: 10, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.945 Vali Acc: 0.761 Test Loss: 0.945 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761102).  Saving model ...
Epoch: 11 cost time: 1.0099656581878662
Epoch: 11, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.091 Vali Acc: 0.733 Test Loss: 1.091 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1313650608062744
Epoch: 12, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.110 Vali Acc: 0.733 Test Loss: 1.110 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1147050857543945
Epoch: 13, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.095 Vali Acc: 0.756 Test Loss: 1.095 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.181244134902954
Epoch: 14, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.105 Vali Acc: 0.744 Test Loss: 1.105 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1017639636993408
Epoch: 15, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.503 Vali Acc: 0.722 Test Loss: 1.503 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9738132953643799
Epoch: 16, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.367 Vali Acc: 0.750 Test Loss: 1.367 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1166877746582031
Epoch: 17, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.200 Vali Acc: 0.756 Test Loss: 1.200 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1243581771850586
Epoch: 18, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.338 Vali Acc: 0.772 Test Loss: 1.338 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772209).  Saving model ...
Epoch: 19 cost time: 1.0367045402526855
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.372 Vali Acc: 0.739 Test Loss: 1.372 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.033280611038208
Epoch: 20, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.476 Vali Acc: 0.750 Test Loss: 1.476 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0581283569335938
Epoch: 21, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.470 Vali Acc: 0.722 Test Loss: 1.470 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0064995288848877
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.232 Vali Acc: 0.783 Test Loss: 1.232 Test Acc: 0.783
Validation loss decreased (-0.772209 --> -0.783321).  Saving model ...
Epoch: 23 cost time: 0.9675209522247314
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.283 Vali Acc: 0.767 Test Loss: 1.283 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0154433250427246
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.761 Test Loss: 1.367 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.107874870300293
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.767 Test Loss: 1.423 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0913829803466797
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.772 Test Loss: 1.440 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1024365425109863
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.761 Test Loss: 1.435 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0627260208129883
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.767 Test Loss: 1.422 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1128389835357666
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.778 Test Loss: 1.404 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0727944374084473
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.772 Test Loss: 1.405 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0765373706817627
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.772 Test Loss: 1.405 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.112025499343872
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.772 Test Loss: 1.406 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 256006
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3645689487457275
Epoch: 1, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.230 Vali Acc: 0.533 Test Loss: 1.230 Test Acc: 0.533
Validation loss decreased (inf --> -0.533321).  Saving model ...
Epoch: 2 cost time: 1.0773425102233887
Epoch: 2, Steps: 12 | Train Loss: 0.977 Vali Loss: 0.864 Vali Acc: 0.628 Test Loss: 0.864 Test Acc: 0.628
Validation loss decreased (-0.533321 --> -0.627769).  Saving model ...
Epoch: 3 cost time: 1.0029830932617188
Epoch: 3, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.770 Vali Acc: 0.650 Test Loss: 0.770 Test Acc: 0.650
Validation loss decreased (-0.627769 --> -0.649992).  Saving model ...
Epoch: 4 cost time: 1.006319284439087
Epoch: 4, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.657 Vali Acc: 0.733 Test Loss: 0.657 Test Acc: 0.733
Validation loss decreased (-0.649992 --> -0.733327).  Saving model ...
Epoch: 5 cost time: 1.0151660442352295
Epoch: 5, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.698 Vali Acc: 0.722 Test Loss: 0.698 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9735851287841797
Epoch: 6, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.694 Vali Acc: 0.744 Test Loss: 0.694 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744438).  Saving model ...
Epoch: 7 cost time: 1.0272507667541504
Epoch: 7, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.633 Vali Acc: 0.739 Test Loss: 0.633 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0929832458496094
Epoch: 8, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.732 Vali Acc: 0.717 Test Loss: 0.732 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.01139235496521
Epoch: 9, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.788 Vali Acc: 0.728 Test Loss: 0.788 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9853036403656006
Epoch: 10, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.883 Vali Acc: 0.728 Test Loss: 0.883 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9891753196716309
Epoch: 11, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.968 Vali Acc: 0.739 Test Loss: 0.968 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9003329277038574
Epoch: 12, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.927 Vali Acc: 0.761 Test Loss: 0.927 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761102).  Saving model ...
Epoch: 13 cost time: 0.9577376842498779
Epoch: 13, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.865 Vali Acc: 0.761 Test Loss: 0.865 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 14 cost time: 0.9619848728179932
Epoch: 14, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.901 Vali Acc: 0.744 Test Loss: 0.901 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.978064775466919
Epoch: 15, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.964 Vali Acc: 0.739 Test Loss: 0.964 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1208889484405518
Epoch: 16, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.996 Vali Acc: 0.744 Test Loss: 0.996 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9465012550354004
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.984 Vali Acc: 0.739 Test Loss: 0.984 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9909899234771729
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.949 Vali Acc: 0.739 Test Loss: 0.949 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9627530574798584
Epoch: 19, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.017 Vali Acc: 0.744 Test Loss: 1.017 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.960900068283081
Epoch: 20, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.035 Vali Acc: 0.761 Test Loss: 1.035 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9920134544372559
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.068 Vali Acc: 0.744 Test Loss: 1.068 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0045585632324219
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.047 Vali Acc: 0.733 Test Loss: 1.047 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9826107025146484
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.039 Vali Acc: 0.750 Test Loss: 1.039 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 182406
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4266140460968018
Epoch: 1, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.411 Vali Acc: 0.494 Test Loss: 1.411 Test Acc: 0.494
Validation loss decreased (inf --> -0.494430).  Saving model ...
Epoch: 2 cost time: 0.9020748138427734
Epoch: 2, Steps: 12 | Train Loss: 1.073 Vali Loss: 0.990 Vali Acc: 0.606 Test Loss: 0.990 Test Acc: 0.606
Validation loss decreased (-0.494430 --> -0.605546).  Saving model ...
Epoch: 3 cost time: 0.9905433654785156
Epoch: 3, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.758 Vali Acc: 0.694 Test Loss: 0.758 Test Acc: 0.694
Validation loss decreased (-0.605546 --> -0.694437).  Saving model ...
Epoch: 4 cost time: 0.9424147605895996
Epoch: 4, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.682 Vali Acc: 0.717 Test Loss: 0.682 Test Acc: 0.717
Validation loss decreased (-0.694437 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 0.9603960514068604
Epoch: 5, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.625 Vali Acc: 0.744 Test Loss: 0.625 Test Acc: 0.744
Validation loss decreased (-0.716660 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 0.9660844802856445
Epoch: 6, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.659 Vali Acc: 0.728 Test Loss: 0.659 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9235241413116455
Epoch: 7, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.689 Vali Acc: 0.728 Test Loss: 0.689 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8789429664611816
Epoch: 8, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 0.9437897205352783
Epoch: 9, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.839 Vali Acc: 0.733 Test Loss: 0.839 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9135019779205322
Epoch: 10, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.719 Vali Acc: 0.767 Test Loss: 0.719 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766659).  Saving model ...
Epoch: 11 cost time: 0.9403581619262695
Epoch: 11, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.974 Vali Acc: 0.733 Test Loss: 0.974 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8947043418884277
Epoch: 12, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.784 Vali Acc: 0.744 Test Loss: 0.784 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8663086891174316
Epoch: 13, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.892 Vali Acc: 0.744 Test Loss: 0.892 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0109550952911377
Epoch: 14, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.865 Vali Acc: 0.744 Test Loss: 0.865 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9832034111022949
Epoch: 15, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.964 Vali Acc: 0.750 Test Loss: 0.964 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9956924915313721
Epoch: 16, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.902 Vali Acc: 0.744 Test Loss: 0.902 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.049623727798462
Epoch: 17, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.914 Vali Acc: 0.744 Test Loss: 0.914 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9595649242401123
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.935 Vali Acc: 0.739 Test Loss: 0.935 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9570095539093018
Epoch: 19, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.969 Vali Acc: 0.739 Test Loss: 0.969 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9864099025726318
Epoch: 20, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.977 Vali Acc: 0.744 Test Loss: 0.977 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 136454
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4067811965942383
Epoch: 1, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.435 Vali Acc: 0.528 Test Loss: 1.435 Test Acc: 0.528
Validation loss decreased (inf --> -0.527763).  Saving model ...
Epoch: 2 cost time: 0.9249536991119385
Epoch: 2, Steps: 12 | Train Loss: 1.237 Vali Loss: 0.993 Vali Acc: 0.683 Test Loss: 0.993 Test Acc: 0.683
Validation loss decreased (-0.527763 --> -0.683323).  Saving model ...
Epoch: 3 cost time: 0.9005804061889648
Epoch: 3, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.856 Vali Acc: 0.672 Test Loss: 0.856 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9381923675537109
Epoch: 4, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.741 Vali Acc: 0.694 Test Loss: 0.741 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 1.0192933082580566
Epoch: 5, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.725 Vali Acc: 0.722 Test Loss: 0.725 Test Acc: 0.722
Validation loss decreased (-0.694437 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 0.9113337993621826
Epoch: 6, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.658 Vali Acc: 0.733 Test Loss: 0.658 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733327).  Saving model ...
Epoch: 7 cost time: 1.0069773197174072
Epoch: 7, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.667 Vali Acc: 0.750 Test Loss: 0.667 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 0.7091836929321289
Epoch: 8, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.796 Vali Acc: 0.739 Test Loss: 0.796 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8746140003204346
Epoch: 9, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.729 Vali Acc: 0.739 Test Loss: 0.729 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8537888526916504
Epoch: 10, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.840 Vali Acc: 0.722 Test Loss: 0.840 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8713395595550537
Epoch: 11, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.863 Vali Acc: 0.739 Test Loss: 0.863 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8421196937561035
Epoch: 12, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.886 Vali Acc: 0.733 Test Loss: 0.886 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8592793941497803
Epoch: 13, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.885 Vali Acc: 0.733 Test Loss: 0.885 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8901162147521973
Epoch: 14, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.873 Vali Acc: 0.722 Test Loss: 0.873 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8659243583679199
Epoch: 15, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.847 Vali Acc: 0.728 Test Loss: 0.847 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8595640659332275
Epoch: 16, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.871 Vali Acc: 0.744 Test Loss: 0.871 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8508706092834473
Epoch: 17, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.859 Vali Acc: 0.733 Test Loss: 0.859 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.75
model parameter : 99782
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2723641395568848
Epoch: 1, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.452 Vali Acc: 0.494 Test Loss: 1.452 Test Acc: 0.494
Validation loss decreased (inf --> -0.494430).  Saving model ...
Epoch: 2 cost time: 0.7990503311157227
Epoch: 2, Steps: 12 | Train Loss: 1.195 Vali Loss: 1.040 Vali Acc: 0.633 Test Loss: 1.040 Test Acc: 0.633
Validation loss decreased (-0.494430 --> -0.633323).  Saving model ...
Epoch: 3 cost time: 0.788597583770752
Epoch: 3, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.876 Vali Acc: 0.644 Test Loss: 0.876 Test Acc: 0.644
Validation loss decreased (-0.633323 --> -0.644436).  Saving model ...
Epoch: 4 cost time: 0.8181302547454834
Epoch: 4, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.749 Vali Acc: 0.672 Test Loss: 0.749 Test Acc: 0.672
Validation loss decreased (-0.644436 --> -0.672215).  Saving model ...
Epoch: 5 cost time: 0.8012392520904541
Epoch: 5, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.677 Vali Acc: 0.717 Test Loss: 0.677 Test Acc: 0.717
Validation loss decreased (-0.672215 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 0.7821598052978516
Epoch: 6, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.684 Vali Acc: 0.728 Test Loss: 0.684 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 0.7546908855438232
Epoch: 7, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.656 Vali Acc: 0.739 Test Loss: 0.656 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738882).  Saving model ...
Epoch: 8 cost time: 0.8168818950653076
Epoch: 8, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.668 Vali Acc: 0.756 Test Loss: 0.668 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 0.7925505638122559
Epoch: 9, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.627 Vali Acc: 0.767 Test Loss: 0.627 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 10 cost time: 0.901726484298706
Epoch: 10, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.676 Vali Acc: 0.733 Test Loss: 0.676 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7624390125274658
Epoch: 11, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.720 Vali Acc: 0.750 Test Loss: 0.720 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7943511009216309
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.658 Vali Acc: 0.756 Test Loss: 0.658 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9611532688140869
Epoch: 13, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.727 Vali Acc: 0.744 Test Loss: 0.727 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8606057167053223
Epoch: 14, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.717 Vali Acc: 0.767 Test Loss: 0.717 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8030061721801758
Epoch: 15, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.770 Vali Acc: 0.750 Test Loss: 0.770 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8931608200073242
Epoch: 16, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7634491920471191
Epoch: 17, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.793 Vali Acc: 0.778 Test Loss: 0.793 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777770).  Saving model ...
Epoch: 18 cost time: 0.8271517753601074
Epoch: 18, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.791 Vali Acc: 0.767 Test Loss: 0.791 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8058884143829346
Epoch: 19, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.865 Vali Acc: 0.750 Test Loss: 0.865 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8447024822235107
Epoch: 20, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.835 Vali Acc: 0.761 Test Loss: 0.835 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8463313579559326
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.853 Vali Acc: 0.761 Test Loss: 0.853 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8484079837799072
Epoch: 22, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.886 Vali Acc: 0.750 Test Loss: 0.886 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9021022319793701
Epoch: 23, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.872 Vali Acc: 0.767 Test Loss: 0.872 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7752487659454346
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.915 Vali Acc: 0.744 Test Loss: 0.915 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8356263637542725
Epoch: 25, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.912 Vali Acc: 0.750 Test Loss: 0.912 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7714738845825195
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.893 Vali Acc: 0.761 Test Loss: 0.893 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8205554485321045
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.900 Vali Acc: 0.761 Test Loss: 0.900 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm64_nh16_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 90694
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.430690288543701
Epoch: 1, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.166 Vali Acc: 0.544 Test Loss: 1.166 Test Acc: 0.544
Validation loss decreased (inf --> -0.544433).  Saving model ...
Epoch: 2 cost time: 0.9177122116088867
Epoch: 2, Steps: 12 | Train Loss: 0.889 Vali Loss: 0.820 Vali Acc: 0.650 Test Loss: 0.820 Test Acc: 0.650
Validation loss decreased (-0.544433 --> -0.649992).  Saving model ...
Epoch: 3 cost time: 0.9841907024383545
Epoch: 3, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.842 Vali Acc: 0.694 Test Loss: 0.842 Test Acc: 0.694
Validation loss decreased (-0.649992 --> -0.694436).  Saving model ...
Epoch: 4 cost time: 0.9504971504211426
Epoch: 4, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.670 Vali Acc: 0.739 Test Loss: 0.670 Test Acc: 0.739
Validation loss decreased (-0.694436 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 0.8512389659881592
Epoch: 5, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.710 Vali Acc: 0.733 Test Loss: 0.710 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0084152221679688
Epoch: 6, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.628 Vali Acc: 0.767 Test Loss: 0.628 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766660).  Saving model ...
Epoch: 7 cost time: 0.8454611301422119
Epoch: 7, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.832 Vali Acc: 0.744 Test Loss: 0.832 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8300211429595947
Epoch: 8, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.861 Vali Acc: 0.767 Test Loss: 0.861 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8502919673919678
Epoch: 9, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.242 Vali Acc: 0.728 Test Loss: 1.242 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8283343315124512
Epoch: 10, Steps: 12 | Train Loss: 0.199 Vali Loss: 1.051 Vali Acc: 0.750 Test Loss: 1.051 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9292902946472168
Epoch: 11, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.068 Vali Acc: 0.761 Test Loss: 1.068 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8741226196289062
Epoch: 12, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.293 Vali Acc: 0.756 Test Loss: 1.293 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9324111938476562
Epoch: 13, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.999 Vali Acc: 0.761 Test Loss: 0.999 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9730479717254639
Epoch: 14, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.141 Vali Acc: 0.761 Test Loss: 1.141 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.854733943939209
Epoch: 15, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.426 Vali Acc: 0.756 Test Loss: 1.426 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.960421085357666
Epoch: 16, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.057 Vali Acc: 0.767 Test Loss: 1.057 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 256166
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.283482789993286
Epoch: 1, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.400 Vali Acc: 0.517 Test Loss: 1.400 Test Acc: 0.517
Validation loss decreased (inf --> -0.516653).  Saving model ...
Epoch: 2 cost time: 0.9962937831878662
Epoch: 2, Steps: 12 | Train Loss: 1.080 Vali Loss: 0.970 Vali Acc: 0.600 Test Loss: 0.970 Test Acc: 0.600
Validation loss decreased (-0.516653 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.8083670139312744
Epoch: 3, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.755 Vali Acc: 0.650 Test Loss: 0.755 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649992).  Saving model ...
Epoch: 4 cost time: 0.8936994075775146
Epoch: 4, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.724 Vali Acc: 0.694 Test Loss: 0.724 Test Acc: 0.694
Validation loss decreased (-0.649992 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 0.900822639465332
Epoch: 5, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.672 Vali Acc: 0.733 Test Loss: 0.672 Test Acc: 0.733
Validation loss decreased (-0.694437 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 0.7040004730224609
Epoch: 6, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.645 Vali Acc: 0.744 Test Loss: 0.645 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744438).  Saving model ...
Epoch: 7 cost time: 0.9173955917358398
Epoch: 7, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.816 Vali Acc: 0.739 Test Loss: 0.816 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9287991523742676
Epoch: 8, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.770 Vali Acc: 0.750 Test Loss: 0.770 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 0.9299216270446777
Epoch: 9, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.700 Vali Acc: 0.744 Test Loss: 0.700 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9544856548309326
Epoch: 10, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.929318904876709
Epoch: 11, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.057 Vali Acc: 0.717 Test Loss: 1.057 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8991625308990479
Epoch: 12, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.749 Vali Acc: 0.756 Test Loss: 0.749 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 0.9114410877227783
Epoch: 13, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.831 Vali Acc: 0.761 Test Loss: 0.831 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761103).  Saving model ...
Epoch: 14 cost time: 0.8921494483947754
Epoch: 14, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.847 Vali Acc: 0.761 Test Loss: 0.847 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9213788509368896
Epoch: 15, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.975 Vali Acc: 0.733 Test Loss: 0.975 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.947002649307251
Epoch: 16, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.906 Vali Acc: 0.767 Test Loss: 0.906 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766658).  Saving model ...
Epoch: 17 cost time: 0.9990749359130859
Epoch: 17, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.047 Vali Acc: 0.733 Test Loss: 1.047 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9815704822540283
Epoch: 18, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.960 Vali Acc: 0.761 Test Loss: 0.960 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9518191814422607
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.985 Vali Acc: 0.750 Test Loss: 0.985 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.949753999710083
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.967 Vali Acc: 0.756 Test Loss: 0.967 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9312441349029541
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.951 Vali Acc: 0.756 Test Loss: 0.951 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9280276298522949
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.975 Vali Acc: 0.767 Test Loss: 0.975 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9642543792724609
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.973 Vali Acc: 0.761 Test Loss: 0.973 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9431354999542236
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.962 Vali Acc: 0.756 Test Loss: 0.962 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9759137630462646
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.965 Vali Acc: 0.756 Test Loss: 0.965 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8833537101745605
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.980 Vali Acc: 0.761 Test Loss: 0.980 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 140998
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4069528579711914
Epoch: 1, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.235 Vali Acc: 0.567 Test Loss: 1.235 Test Acc: 0.567
Validation loss decreased (inf --> -0.566654).  Saving model ...
Epoch: 2 cost time: 0.7962396144866943
Epoch: 2, Steps: 12 | Train Loss: 0.982 Vali Loss: 0.928 Vali Acc: 0.639 Test Loss: 0.928 Test Acc: 0.639
Validation loss decreased (-0.566654 --> -0.638880).  Saving model ...
Epoch: 3 cost time: 0.8763916492462158
Epoch: 3, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.809 Vali Acc: 0.667 Test Loss: 0.809 Test Acc: 0.667
Validation loss decreased (-0.638880 --> -0.666659).  Saving model ...
Epoch: 4 cost time: 0.9926893711090088
Epoch: 4, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.651 Vali Acc: 0.733 Test Loss: 0.651 Test Acc: 0.733
Validation loss decreased (-0.666659 --> -0.733327).  Saving model ...
Epoch: 5 cost time: 0.8228752613067627
Epoch: 5, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.606 Vali Acc: 0.761 Test Loss: 0.606 Test Acc: 0.761
Validation loss decreased (-0.733327 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 0.8260657787322998
Epoch: 6, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.602 Vali Acc: 0.772 Test Loss: 0.602 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772216).  Saving model ...
Epoch: 7 cost time: 0.9526214599609375
Epoch: 7, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9524586200714111
Epoch: 8, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.751 Vali Acc: 0.761 Test Loss: 0.751 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8919398784637451
Epoch: 9, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.745 Vali Acc: 0.733 Test Loss: 0.745 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8960704803466797
Epoch: 10, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.658 Vali Acc: 0.739 Test Loss: 0.658 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9234490394592285
Epoch: 11, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.792 Vali Acc: 0.739 Test Loss: 0.792 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8958430290222168
Epoch: 12, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.727 Vali Acc: 0.756 Test Loss: 0.727 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8499815464019775
Epoch: 13, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.739 Vali Acc: 0.750 Test Loss: 0.739 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9546222686767578
Epoch: 14, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.823 Vali Acc: 0.761 Test Loss: 0.823 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8655133247375488
Epoch: 15, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.939 Vali Acc: 0.761 Test Loss: 0.939 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8510122299194336
Epoch: 16, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.881 Vali Acc: 0.739 Test Loss: 0.881 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 136422
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3290271759033203
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.552 Vali Acc: 0.428 Test Loss: 1.552 Test Acc: 0.428
Validation loss decreased (inf --> -0.427762).  Saving model ...
Epoch: 2 cost time: 0.8647387027740479
Epoch: 2, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.040 Vali Acc: 0.583 Test Loss: 1.040 Test Acc: 0.583
Validation loss decreased (-0.427762 --> -0.583323).  Saving model ...
Epoch: 3 cost time: 0.827080488204956
Epoch: 3, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.837 Vali Acc: 0.633 Test Loss: 0.837 Test Acc: 0.633
Validation loss decreased (-0.583323 --> -0.633325).  Saving model ...
Epoch: 4 cost time: 0.9179484844207764
Epoch: 4, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.758 Vali Acc: 0.672 Test Loss: 0.758 Test Acc: 0.672
Validation loss decreased (-0.633325 --> -0.672215).  Saving model ...
Epoch: 5 cost time: 0.9214510917663574
Epoch: 5, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.674 Vali Acc: 0.728 Test Loss: 0.674 Test Acc: 0.728
Validation loss decreased (-0.672215 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 0.9600286483764648
Epoch: 6, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.715 Vali Acc: 0.711 Test Loss: 0.715 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8742046356201172
Epoch: 7, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.690 Vali Acc: 0.744 Test Loss: 0.690 Test Acc: 0.744
Validation loss decreased (-0.727771 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 0.9019875526428223
Epoch: 8, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.691 Vali Acc: 0.744 Test Loss: 0.691 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9204938411712646
Epoch: 9, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.637 Vali Acc: 0.744 Test Loss: 0.637 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 10 cost time: 0.8023226261138916
Epoch: 10, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.670 Vali Acc: 0.756 Test Loss: 0.670 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 11 cost time: 0.9848623275756836
Epoch: 11, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.700 Vali Acc: 0.761 Test Loss: 0.700 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 12 cost time: 0.9078497886657715
Epoch: 12, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.822 Vali Acc: 0.728 Test Loss: 0.822 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.936546802520752
Epoch: 13, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.723 Vali Acc: 0.750 Test Loss: 0.723 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9589493274688721
Epoch: 14, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.722 Vali Acc: 0.778 Test Loss: 0.722 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 15 cost time: 0.927361249923706
Epoch: 15, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.750 Vali Acc: 0.767 Test Loss: 0.750 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9486541748046875
Epoch: 16, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.717 Vali Acc: 0.767 Test Loss: 0.717 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9581522941589355
Epoch: 17, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.690 Vali Acc: 0.767 Test Loss: 0.690 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9015758037567139
Epoch: 18, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.769 Vali Acc: 0.761 Test Loss: 0.769 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9203658103942871
Epoch: 19, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.783 Vali Acc: 0.767 Test Loss: 0.783 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9537897109985352
Epoch: 20, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.741 Vali Acc: 0.767 Test Loss: 0.741 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8390109539031982
Epoch: 21, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.730 Vali Acc: 0.767 Test Loss: 0.730 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9061717987060547
Epoch: 22, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.768 Vali Acc: 0.761 Test Loss: 0.768 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9746668338775635
Epoch: 23, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.779 Vali Acc: 0.767 Test Loss: 0.779 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9563140869140625
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.794 Vali Acc: 0.772 Test Loss: 0.794 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 99622
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3589460849761963
Epoch: 1, Steps: 12 | Train Loss: 1.850 Vali Loss: 1.575 Vali Acc: 0.422 Test Loss: 1.575 Test Acc: 0.422
Validation loss decreased (inf --> -0.422206).  Saving model ...
Epoch: 2 cost time: 0.9085586071014404
Epoch: 2, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.103 Vali Acc: 0.600 Test Loss: 1.103 Test Acc: 0.600
Validation loss decreased (-0.422206 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.9258935451507568
Epoch: 3, Steps: 12 | Train Loss: 0.957 Vali Loss: 0.920 Vali Acc: 0.611 Test Loss: 0.920 Test Acc: 0.611
Validation loss decreased (-0.599989 --> -0.611102).  Saving model ...
Epoch: 4 cost time: 0.9076948165893555
Epoch: 4, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.754 Vali Acc: 0.706 Test Loss: 0.754 Test Acc: 0.706
Validation loss decreased (-0.611102 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 0.8064210414886475
Epoch: 5, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.673 Vali Acc: 0.744 Test Loss: 0.673 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 0.9888489246368408
Epoch: 6, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.628 Vali Acc: 0.761 Test Loss: 0.628 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 0.9148058891296387
Epoch: 7, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.594 Vali Acc: 0.767 Test Loss: 0.594 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 0.975121021270752
Epoch: 8, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.653 Vali Acc: 0.756 Test Loss: 0.653 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8875851631164551
Epoch: 9, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.594 Vali Acc: 0.761 Test Loss: 0.594 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9843246936798096
Epoch: 10, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.699 Vali Acc: 0.711 Test Loss: 0.699 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9469678401947021
Epoch: 11, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.701 Vali Acc: 0.756 Test Loss: 0.701 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.901071310043335
Epoch: 12, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.638 Vali Acc: 0.756 Test Loss: 0.638 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9775691032409668
Epoch: 13, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.634 Vali Acc: 0.761 Test Loss: 0.634 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8457820415496826
Epoch: 14, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.718 Vali Acc: 0.761 Test Loss: 0.718 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7864844799041748
Epoch: 15, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.698 Vali Acc: 0.744 Test Loss: 0.698 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8542602062225342
Epoch: 16, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.726 Vali Acc: 0.756 Test Loss: 0.726 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8686122894287109
Epoch: 17, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.736 Vali Acc: 0.767 Test Loss: 0.736 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 76646
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1719141006469727
Epoch: 1, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.646 Vali Acc: 0.344 Test Loss: 1.646 Test Acc: 0.344
Validation loss decreased (inf --> -0.344428).  Saving model ...
Epoch: 2 cost time: 0.6932699680328369
Epoch: 2, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.268 Vali Acc: 0.561 Test Loss: 1.268 Test Acc: 0.561
Validation loss decreased (-0.344428 --> -0.561098).  Saving model ...
Epoch: 3 cost time: 0.6871261596679688
Epoch: 3, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.029 Vali Acc: 0.633 Test Loss: 1.029 Test Acc: 0.633
Validation loss decreased (-0.561098 --> -0.633323).  Saving model ...
Epoch: 4 cost time: 0.7196915149688721
Epoch: 4, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.885 Vali Acc: 0.622 Test Loss: 0.885 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7445535659790039
Epoch: 5, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.784 Vali Acc: 0.711 Test Loss: 0.784 Test Acc: 0.711
Validation loss decreased (-0.633323 --> -0.711103).  Saving model ...
Epoch: 6 cost time: 0.6868736743927002
Epoch: 6, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.733 Vali Acc: 0.706 Test Loss: 0.733 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6696619987487793
Epoch: 7, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.678 Vali Acc: 0.733 Test Loss: 0.678 Test Acc: 0.733
Validation loss decreased (-0.711103 --> -0.733327).  Saving model ...
Epoch: 8 cost time: 0.7316205501556396
Epoch: 8, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.670 Vali Acc: 0.733 Test Loss: 0.670 Test Acc: 0.733
Validation loss decreased (-0.733327 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 0.7311327457427979
Epoch: 9, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.660 Vali Acc: 0.733 Test Loss: 0.660 Test Acc: 0.733
Validation loss decreased (-0.733327 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 0.6827161312103271
Epoch: 10, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.679 Vali Acc: 0.744 Test Loss: 0.679 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744438).  Saving model ...
Epoch: 11 cost time: 0.7556767463684082
Epoch: 11, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.665 Vali Acc: 0.728 Test Loss: 0.665 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7357807159423828
Epoch: 12, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.630 Vali Acc: 0.728 Test Loss: 0.630 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6380314826965332
Epoch: 13, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.658 Vali Acc: 0.728 Test Loss: 0.658 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6238863468170166
Epoch: 14, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.690 Vali Acc: 0.728 Test Loss: 0.690 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7473866939544678
Epoch: 15, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.670 Vali Acc: 0.739 Test Loss: 0.670 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7071011066436768
Epoch: 16, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749993).  Saving model ...
Epoch: 17 cost time: 0.6506807804107666
Epoch: 17, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.705 Vali Acc: 0.739 Test Loss: 0.705 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6769764423370361
Epoch: 18, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.763 Vali Acc: 0.744 Test Loss: 0.763 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.710900068283081
Epoch: 19, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.731 Vali Acc: 0.717 Test Loss: 0.731 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7381651401519775
Epoch: 20, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.774 Vali Acc: 0.717 Test Loss: 0.774 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7217519283294678
Epoch: 21, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.762 Vali Acc: 0.733 Test Loss: 0.762 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.644035816192627
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.760 Vali Acc: 0.739 Test Loss: 0.760 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.733349084854126
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.775 Vali Acc: 0.744 Test Loss: 0.775 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7506299018859863
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.789 Vali Acc: 0.739 Test Loss: 0.789 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6793045997619629
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.793 Vali Acc: 0.744 Test Loss: 0.793 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7173709869384766
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.788 Vali Acc: 0.739 Test Loss: 0.788 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.75
model parameter : 58310
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0833256244659424
Epoch: 1, Steps: 12 | Train Loss: 2.032 Vali Loss: 1.804 Vali Acc: 0.167 Test Loss: 1.804 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.695258617401123
Epoch: 2, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.434 Vali Acc: 0.417 Test Loss: 1.434 Test Acc: 0.417
Validation loss decreased (-0.166649 --> -0.416652).  Saving model ...
Epoch: 3 cost time: 0.8097720146179199
Epoch: 3, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.130 Vali Acc: 0.556 Test Loss: 1.130 Test Acc: 0.556
Validation loss decreased (-0.416652 --> -0.555544).  Saving model ...
Epoch: 4 cost time: 0.7799072265625
Epoch: 4, Steps: 12 | Train Loss: 1.001 Vali Loss: 0.975 Vali Acc: 0.589 Test Loss: 0.975 Test Acc: 0.589
Validation loss decreased (-0.555544 --> -0.588879).  Saving model ...
Epoch: 5 cost time: 0.7814500331878662
Epoch: 5, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.860 Vali Acc: 0.622 Test Loss: 0.860 Test Acc: 0.622
Validation loss decreased (-0.588879 --> -0.622214).  Saving model ...
Epoch: 6 cost time: 0.75840163230896
Epoch: 6, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.772 Vali Acc: 0.689 Test Loss: 0.772 Test Acc: 0.689
Validation loss decreased (-0.622214 --> -0.688881).  Saving model ...
Epoch: 7 cost time: 0.6907124519348145
Epoch: 7, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.697 Vali Acc: 0.717 Test Loss: 0.697 Test Acc: 0.717
Validation loss decreased (-0.688881 --> -0.716660).  Saving model ...
Epoch: 8 cost time: 0.7009491920471191
Epoch: 8, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.672 Vali Acc: 0.739 Test Loss: 0.672 Test Acc: 0.739
Validation loss decreased (-0.716660 --> -0.738882).  Saving model ...
Epoch: 9 cost time: 0.7428207397460938
Epoch: 9, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.655 Vali Acc: 0.756 Test Loss: 0.655 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 10 cost time: 0.682408332824707
Epoch: 10, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.616 Vali Acc: 0.750 Test Loss: 0.616 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6773757934570312
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.628 Vali Acc: 0.739 Test Loss: 0.628 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7216818332672119
Epoch: 12, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.644 Vali Acc: 0.744 Test Loss: 0.644 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6814172267913818
Epoch: 13, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.669 Vali Acc: 0.750 Test Loss: 0.669 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7458844184875488
Epoch: 14, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.659 Vali Acc: 0.750 Test Loss: 0.659 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6932549476623535
Epoch: 15, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.639 Vali Acc: 0.739 Test Loss: 0.639 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7421958446502686
Epoch: 16, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.668 Vali Acc: 0.744 Test Loss: 0.668 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6881141662597656
Epoch: 17, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.693 Vali Acc: 0.744 Test Loss: 0.693 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7886242866516113
Epoch: 18, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.679 Vali Acc: 0.744 Test Loss: 0.679 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6970810890197754
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.705 Vali Acc: 0.756 Test Loss: 0.705 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 53766
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1324172019958496
Epoch: 1, Steps: 12 | Train Loss: 1.549 Vali Loss: 1.108 Vali Acc: 0.539 Test Loss: 1.108 Test Acc: 0.539
Validation loss decreased (inf --> -0.538878).  Saving model ...
Epoch: 2 cost time: 0.8597192764282227
Epoch: 2, Steps: 12 | Train Loss: 0.831 Vali Loss: 0.866 Vali Acc: 0.639 Test Loss: 0.866 Test Acc: 0.639
Validation loss decreased (-0.538878 --> -0.638880).  Saving model ...
Epoch: 3 cost time: 0.8765950202941895
Epoch: 3, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.789 Vali Acc: 0.683 Test Loss: 0.789 Test Acc: 0.683
Validation loss decreased (-0.638880 --> -0.683325).  Saving model ...
Epoch: 4 cost time: 0.806300163269043
Epoch: 4, Steps: 12 | Train Loss: 0.423 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
Validation loss decreased (-0.683325 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 0.868863582611084
Epoch: 5, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.726 Vali Acc: 0.733 Test Loss: 0.726 Test Acc: 0.733
Validation loss decreased (-0.699989 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 0.9043080806732178
Epoch: 6, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.704 Vali Acc: 0.739 Test Loss: 0.704 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 7 cost time: 0.8761062622070312
Epoch: 7, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.717 Vali Acc: 0.750 Test Loss: 0.717 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 0.8759338855743408
Epoch: 8, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.020 Vali Acc: 0.722 Test Loss: 1.020 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9257588386535645
Epoch: 9, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.922 Vali Acc: 0.728 Test Loss: 0.922 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8474600315093994
Epoch: 10, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.923 Vali Acc: 0.728 Test Loss: 0.923 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8820557594299316
Epoch: 11, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.896 Vali Acc: 0.761 Test Loss: 0.896 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761102).  Saving model ...
Epoch: 12 cost time: 0.8280367851257324
Epoch: 12, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.845 Vali Acc: 0.756 Test Loss: 0.845 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7827651500701904
Epoch: 13, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.420 Vali Acc: 0.694 Test Loss: 1.420 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8506350517272949
Epoch: 14, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.151 Vali Acc: 0.739 Test Loss: 1.151 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8249127864837646
Epoch: 15, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.133 Vali Acc: 0.733 Test Loss: 1.133 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8248052597045898
Epoch: 16, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.256 Vali Acc: 0.733 Test Loss: 1.256 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8642113208770752
Epoch: 17, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.534 Vali Acc: 0.700 Test Loss: 1.534 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0349915027618408
Epoch: 18, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.473 Vali Acc: 0.722 Test Loss: 1.473 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8709449768066406
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.356 Vali Acc: 0.728 Test Loss: 1.356 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9205317497253418
Epoch: 20, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.378 Vali Acc: 0.711 Test Loss: 1.378 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8136599063873291
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.293 Vali Acc: 0.739 Test Loss: 1.293 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 247846
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6104724407196045
Epoch: 1, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.418 Vali Acc: 0.489 Test Loss: 1.418 Test Acc: 0.489
Validation loss decreased (inf --> -0.488875).  Saving model ...
Epoch: 2 cost time: 0.8298053741455078
Epoch: 2, Steps: 12 | Train Loss: 1.124 Vali Loss: 0.930 Vali Acc: 0.589 Test Loss: 0.930 Test Acc: 0.589
Validation loss decreased (-0.488875 --> -0.588880).  Saving model ...
Epoch: 3 cost time: 0.7665987014770508
Epoch: 3, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.012 Vali Acc: 0.550 Test Loss: 1.012 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8545644283294678
Epoch: 4, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.743 Vali Acc: 0.717 Test Loss: 0.743 Test Acc: 0.717
Validation loss decreased (-0.588880 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 0.8000097274780273
Epoch: 5, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.733 Vali Acc: 0.744 Test Loss: 0.733 Test Acc: 0.744
Validation loss decreased (-0.716659 --> -0.744437).  Saving model ...
Epoch: 6 cost time: 0.8037757873535156
Epoch: 6, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.689 Vali Acc: 0.728 Test Loss: 0.689 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7184054851531982
Epoch: 7, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.648 Vali Acc: 0.733 Test Loss: 0.648 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8246183395385742
Epoch: 8, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 9 cost time: 0.7856612205505371
Epoch: 9, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.785 Vali Acc: 0.733 Test Loss: 0.785 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7814078330993652
Epoch: 10, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.786 Vali Acc: 0.739 Test Loss: 0.786 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8418035507202148
Epoch: 11, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.907 Vali Acc: 0.733 Test Loss: 0.907 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7873144149780273
Epoch: 12, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.970 Vali Acc: 0.722 Test Loss: 0.970 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.868964672088623
Epoch: 13, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.881 Vali Acc: 0.739 Test Loss: 0.881 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7918579578399658
Epoch: 14, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.828 Vali Acc: 0.750 Test Loss: 0.828 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8835010528564453
Epoch: 15, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.905 Vali Acc: 0.744 Test Loss: 0.905 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8202061653137207
Epoch: 16, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.895 Vali Acc: 0.750 Test Loss: 0.895 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8015189170837402
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7743334770202637
Epoch: 18, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.830 Vali Acc: 0.767 Test Loss: 0.830 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766658).  Saving model ...
Epoch: 19 cost time: 0.8161423206329346
Epoch: 19, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.935 Vali Acc: 0.756 Test Loss: 0.935 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7839126586914062
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.964 Vali Acc: 0.750 Test Loss: 0.964 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8259570598602295
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.963 Vali Acc: 0.756 Test Loss: 0.963 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8461840152740479
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.958 Vali Acc: 0.756 Test Loss: 0.958 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8554496765136719
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.963 Vali Acc: 0.756 Test Loss: 0.963 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7622594833374023
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.950 Vali Acc: 0.761 Test Loss: 0.950 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7857348918914795
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.928 Vali Acc: 0.756 Test Loss: 0.928 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7949979305267334
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.951 Vali Acc: 0.756 Test Loss: 0.951 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8073329925537109
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.947 Vali Acc: 0.767 Test Loss: 0.947 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8411037921905518
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.953 Vali Acc: 0.767 Test Loss: 0.953 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 132678
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3804831504821777
Epoch: 1, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.326 Vali Acc: 0.550 Test Loss: 1.326 Test Acc: 0.550
Validation loss decreased (inf --> -0.549987).  Saving model ...
Epoch: 2 cost time: 0.6995866298675537
Epoch: 2, Steps: 12 | Train Loss: 1.059 Vali Loss: 0.895 Vali Acc: 0.633 Test Loss: 0.895 Test Acc: 0.633
Validation loss decreased (-0.549987 --> -0.633324).  Saving model ...
Epoch: 3 cost time: 0.8088319301605225
Epoch: 3, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.795 Vali Acc: 0.661 Test Loss: 0.795 Test Acc: 0.661
Validation loss decreased (-0.633324 --> -0.661103).  Saving model ...
Epoch: 4 cost time: 0.782902717590332
Epoch: 4, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.664 Vali Acc: 0.733 Test Loss: 0.664 Test Acc: 0.733
Validation loss decreased (-0.661103 --> -0.733327).  Saving model ...
Epoch: 5 cost time: 0.815589189529419
Epoch: 5, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.665 Vali Acc: 0.733 Test Loss: 0.665 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.801821231842041
Epoch: 6, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.617 Vali Acc: 0.750 Test Loss: 0.617 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 0.816953182220459
Epoch: 7, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.677 Vali Acc: 0.756 Test Loss: 0.677 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 8 cost time: 0.8145015239715576
Epoch: 8, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.650 Vali Acc: 0.756 Test Loss: 0.650 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 0.7757933139801025
Epoch: 9, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.691 Vali Acc: 0.756 Test Loss: 0.691 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8218498229980469
Epoch: 10, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.716 Vali Acc: 0.744 Test Loss: 0.716 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.759465217590332
Epoch: 11, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.810 Vali Acc: 0.767 Test Loss: 0.810 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766659).  Saving model ...
Epoch: 12 cost time: 0.718146562576294
Epoch: 12, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.772 Vali Acc: 0.772 Test Loss: 0.772 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772214).  Saving model ...
Epoch: 13 cost time: 0.8352200984954834
Epoch: 13, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.820 Vali Acc: 0.761 Test Loss: 0.820 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8205132484436035
Epoch: 14, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.777 Vali Acc: 0.761 Test Loss: 0.777 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8202593326568604
Epoch: 15, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.859 Vali Acc: 0.756 Test Loss: 0.859 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.812610387802124
Epoch: 16, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.798 Vali Acc: 0.778 Test Loss: 0.798 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 17 cost time: 0.8588194847106934
Epoch: 17, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7963821887969971
Epoch: 18, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.856 Vali Acc: 0.772 Test Loss: 0.856 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7993464469909668
Epoch: 19, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.842 Vali Acc: 0.767 Test Loss: 0.842 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8208596706390381
Epoch: 20, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.822258472442627
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.947 Vali Acc: 0.767 Test Loss: 0.947 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8005061149597168
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.936 Vali Acc: 0.756 Test Loss: 0.936 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7636728286743164
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.939 Vali Acc: 0.761 Test Loss: 0.939 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7515289783477783
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.946 Vali Acc: 0.756 Test Loss: 0.946 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8113284111022949
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7433056831359863
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.954 Vali Acc: 0.767 Test Loss: 0.954 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 128102
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2038261890411377
Epoch: 1, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.478 Vali Acc: 0.444 Test Loss: 1.478 Test Acc: 0.444
Validation loss decreased (inf --> -0.444430).  Saving model ...
Epoch: 2 cost time: 0.855766773223877
Epoch: 2, Steps: 12 | Train Loss: 1.293 Vali Loss: 0.968 Vali Acc: 0.622 Test Loss: 0.968 Test Acc: 0.622
Validation loss decreased (-0.444430 --> -0.622213).  Saving model ...
Epoch: 3 cost time: 0.8789033889770508
Epoch: 3, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.785 Vali Acc: 0.694 Test Loss: 0.785 Test Acc: 0.694
Validation loss decreased (-0.622213 --> -0.694437).  Saving model ...
Epoch: 4 cost time: 0.9085679054260254
Epoch: 4, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.664 Vali Acc: 0.706 Test Loss: 0.664 Test Acc: 0.706
Validation loss decreased (-0.694437 --> -0.705549).  Saving model ...
Epoch: 5 cost time: 0.908491849899292
Epoch: 5, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.605 Vali Acc: 0.756 Test Loss: 0.605 Test Acc: 0.756
Validation loss decreased (-0.705549 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 0.8905489444732666
Epoch: 6, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.576 Vali Acc: 0.767 Test Loss: 0.576 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 0.9176425933837891
Epoch: 7, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.624 Vali Acc: 0.744 Test Loss: 0.624 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8099887371063232
Epoch: 8, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9480698108673096
Epoch: 9, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.585 Vali Acc: 0.772 Test Loss: 0.585 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 10 cost time: 0.8886027336120605
Epoch: 10, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.615 Vali Acc: 0.750 Test Loss: 0.615 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9074532985687256
Epoch: 11, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.699 Vali Acc: 0.772 Test Loss: 0.699 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8941183090209961
Epoch: 12, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.768 Vali Acc: 0.739 Test Loss: 0.768 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9309687614440918
Epoch: 13, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.698 Vali Acc: 0.778 Test Loss: 0.698 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777771).  Saving model ...
Epoch: 14 cost time: 0.9642322063446045
Epoch: 14, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8644790649414062
Epoch: 15, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.611 Vali Acc: 0.778 Test Loss: 0.611 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777772).  Saving model ...
Epoch: 16 cost time: 0.9835197925567627
Epoch: 16, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.740 Vali Acc: 0.767 Test Loss: 0.740 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8974299430847168
Epoch: 17, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.784 Vali Acc: 0.756 Test Loss: 0.784 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9148778915405273
Epoch: 18, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.693 Vali Acc: 0.778 Test Loss: 0.693 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9122011661529541
Epoch: 19, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.687 Vali Acc: 0.778 Test Loss: 0.687 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8331735134124756
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783326).  Saving model ...
Epoch: 21 cost time: 0.909935474395752
Epoch: 21, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8871841430664062
Epoch: 22, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.728 Vali Acc: 0.778 Test Loss: 0.728 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9991981983184814
Epoch: 23, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.726 Vali Acc: 0.778 Test Loss: 0.726 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8217558860778809
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.743 Vali Acc: 0.783 Test Loss: 0.743 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9865274429321289
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.748 Vali Acc: 0.778 Test Loss: 0.748 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9115533828735352
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.774 Vali Acc: 0.778 Test Loss: 0.774 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9402024745941162
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.786 Vali Acc: 0.778 Test Loss: 0.786 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9102039337158203
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.790 Vali Acc: 0.778 Test Loss: 0.790 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9208722114562988
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.786 Vali Acc: 0.778 Test Loss: 0.786 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.922419548034668
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.786 Vali Acc: 0.772 Test Loss: 0.786 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 91302
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5121259689331055
Epoch: 1, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.541 Vali Acc: 0.400 Test Loss: 1.541 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 0.9118266105651855
Epoch: 2, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.114 Vali Acc: 0.556 Test Loss: 1.114 Test Acc: 0.556
Validation loss decreased (-0.399985 --> -0.555544).  Saving model ...
Epoch: 3 cost time: 0.8673064708709717
Epoch: 3, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.918 Vali Acc: 0.617 Test Loss: 0.918 Test Acc: 0.617
Validation loss decreased (-0.555544 --> -0.616657).  Saving model ...
Epoch: 4 cost time: 0.9421477317810059
Epoch: 4, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.839 Vali Acc: 0.650 Test Loss: 0.839 Test Acc: 0.650
Validation loss decreased (-0.616657 --> -0.649992).  Saving model ...
Epoch: 5 cost time: 0.9312598705291748
Epoch: 5, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.717 Vali Acc: 0.711 Test Loss: 0.717 Test Acc: 0.711
Validation loss decreased (-0.649992 --> -0.711104).  Saving model ...
Epoch: 6 cost time: 0.960003137588501
Epoch: 6, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.695 Vali Acc: 0.700 Test Loss: 0.695 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.884840726852417
Epoch: 7, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.687 Vali Acc: 0.717 Test Loss: 0.687 Test Acc: 0.717
Validation loss decreased (-0.711104 --> -0.716660).  Saving model ...
Epoch: 8 cost time: 0.9115123748779297
Epoch: 8, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.642 Vali Acc: 0.722 Test Loss: 0.642 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722216).  Saving model ...
Epoch: 9 cost time: 0.879608154296875
Epoch: 9, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.642 Vali Acc: 0.756 Test Loss: 0.642 Test Acc: 0.756
Validation loss decreased (-0.722216 --> -0.755549).  Saving model ...
Epoch: 10 cost time: 0.9386286735534668
Epoch: 10, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.684 Vali Acc: 0.728 Test Loss: 0.684 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0055136680603027
Epoch: 11, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.656 Vali Acc: 0.750 Test Loss: 0.656 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9047396183013916
Epoch: 12, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9299240112304688
Epoch: 13, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.729 Vali Acc: 0.722 Test Loss: 0.729 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9219813346862793
Epoch: 14, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.755 Vali Acc: 0.739 Test Loss: 0.755 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9155745506286621
Epoch: 15, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.776 Vali Acc: 0.744 Test Loss: 0.776 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9428107738494873
Epoch: 16, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.842 Vali Acc: 0.728 Test Loss: 0.842 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8287835121154785
Epoch: 17, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.766 Vali Acc: 0.767 Test Loss: 0.766 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766659).  Saving model ...
Epoch: 18 cost time: 0.9364464282989502
Epoch: 18, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.871 Vali Acc: 0.728 Test Loss: 0.871 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9170792102813721
Epoch: 19, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.850 Vali Acc: 0.733 Test Loss: 0.850 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9710803031921387
Epoch: 20, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.817 Vali Acc: 0.739 Test Loss: 0.817 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9372215270996094
Epoch: 21, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.780 Vali Acc: 0.744 Test Loss: 0.780 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9305534362792969
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.828 Vali Acc: 0.744 Test Loss: 0.828 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8981881141662598
Epoch: 23, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.847 Vali Acc: 0.733 Test Loss: 0.847 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9016740322113037
Epoch: 24, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9508965015411377
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.862 Vali Acc: 0.761 Test Loss: 0.862 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8677208423614502
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.863 Vali Acc: 0.750 Test Loss: 0.863 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9297647476196289
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.860 Vali Acc: 0.744 Test Loss: 0.860 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 68326
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1448655128479004
Epoch: 1, Steps: 12 | Train Loss: 1.912 Vali Loss: 1.628 Vali Acc: 0.283 Test Loss: 1.628 Test Acc: 0.283
Validation loss decreased (inf --> -0.283317).  Saving model ...
Epoch: 2 cost time: 0.6818027496337891
Epoch: 2, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.252 Vali Acc: 0.572 Test Loss: 1.252 Test Acc: 0.572
Validation loss decreased (-0.283317 --> -0.572210).  Saving model ...
Epoch: 3 cost time: 0.7228636741638184
Epoch: 3, Steps: 12 | Train Loss: 1.171 Vali Loss: 0.994 Vali Acc: 0.622 Test Loss: 0.994 Test Acc: 0.622
Validation loss decreased (-0.572210 --> -0.622212).  Saving model ...
Epoch: 4 cost time: 0.7112522125244141
Epoch: 4, Steps: 12 | Train Loss: 0.853 Vali Loss: 0.876 Vali Acc: 0.644 Test Loss: 0.876 Test Acc: 0.644
Validation loss decreased (-0.622212 --> -0.644436).  Saving model ...
Epoch: 5 cost time: 0.6460726261138916
Epoch: 5, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.838 Vali Acc: 0.661 Test Loss: 0.838 Test Acc: 0.661
Validation loss decreased (-0.644436 --> -0.661103).  Saving model ...
Epoch: 6 cost time: 0.6694850921630859
Epoch: 6, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.724 Vali Acc: 0.706 Test Loss: 0.724 Test Acc: 0.706
Validation loss decreased (-0.661103 --> -0.705548).  Saving model ...
Epoch: 7 cost time: 0.6149017810821533
Epoch: 7, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.703 Vali Acc: 0.728 Test Loss: 0.703 Test Acc: 0.728
Validation loss decreased (-0.705548 --> -0.727771).  Saving model ...
Epoch: 8 cost time: 0.6542351245880127
Epoch: 8, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.656 Vali Acc: 0.733 Test Loss: 0.656 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 0.690631628036499
Epoch: 9, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.657 Vali Acc: 0.733 Test Loss: 0.657 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6682393550872803
Epoch: 10, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.646 Vali Acc: 0.739 Test Loss: 0.646 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738882).  Saving model ...
Epoch: 11 cost time: 0.628596305847168
Epoch: 11, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.676 Vali Acc: 0.756 Test Loss: 0.676 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 12 cost time: 0.6695592403411865
Epoch: 12, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.694429874420166
Epoch: 13, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.641 Vali Acc: 0.739 Test Loss: 0.641 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6670973300933838
Epoch: 14, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.644 Vali Acc: 0.761 Test Loss: 0.644 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 15 cost time: 0.7000763416290283
Epoch: 15, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.655 Vali Acc: 0.761 Test Loss: 0.655 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6925833225250244
Epoch: 16, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.692 Vali Acc: 0.750 Test Loss: 0.692 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7397770881652832
Epoch: 17, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.697 Vali Acc: 0.767 Test Loss: 0.697 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 18 cost time: 0.6954905986785889
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.715 Vali Acc: 0.750 Test Loss: 0.715 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6667766571044922
Epoch: 19, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.730 Vali Acc: 0.744 Test Loss: 0.730 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6452560424804688
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.693 Vali Acc: 0.744 Test Loss: 0.693 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6350126266479492
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.711 Vali Acc: 0.761 Test Loss: 0.711 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6446366310119629
Epoch: 22, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6456243991851807
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.738 Vali Acc: 0.756 Test Loss: 0.738 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6348264217376709
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.743 Vali Acc: 0.733 Test Loss: 0.743 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7170641422271729
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.789 Vali Acc: 0.756 Test Loss: 0.789 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6790578365325928
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.781 Vali Acc: 0.744 Test Loss: 0.781 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.714301586151123
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.787 Vali Acc: 0.756 Test Loss: 0.787 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 49990
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.246044397354126
Epoch: 1, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.604 Vali Acc: 0.422 Test Loss: 1.604 Test Acc: 0.422
Validation loss decreased (inf --> -0.422206).  Saving model ...
Epoch: 2 cost time: 0.6238317489624023
Epoch: 2, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.271 Vali Acc: 0.594 Test Loss: 1.271 Test Acc: 0.594
Validation loss decreased (-0.422206 --> -0.594432).  Saving model ...
Epoch: 3 cost time: 0.637972354888916
Epoch: 3, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.027 Vali Acc: 0.639 Test Loss: 1.027 Test Acc: 0.639
Validation loss decreased (-0.594432 --> -0.638879).  Saving model ...
Epoch: 4 cost time: 0.675102949142456
Epoch: 4, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.886 Vali Acc: 0.694 Test Loss: 0.886 Test Acc: 0.694
Validation loss decreased (-0.638879 --> -0.694436).  Saving model ...
Epoch: 5 cost time: 0.6682872772216797
Epoch: 5, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.797 Vali Acc: 0.678 Test Loss: 0.797 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6538913249969482
Epoch: 6, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.722 Vali Acc: 0.744 Test Loss: 0.722 Test Acc: 0.744
Validation loss decreased (-0.694436 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 0.700951099395752
Epoch: 7, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.673 Vali Acc: 0.728 Test Loss: 0.673 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.70145583152771
Epoch: 8, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.636 Vali Acc: 0.761 Test Loss: 0.636 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 0.8006851673126221
Epoch: 9, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.638 Vali Acc: 0.750 Test Loss: 0.638 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.746394157409668
Epoch: 10, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.623 Vali Acc: 0.750 Test Loss: 0.623 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6926665306091309
Epoch: 11, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.610 Vali Acc: 0.767 Test Loss: 0.610 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 12 cost time: 0.6875121593475342
Epoch: 12, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.611 Vali Acc: 0.750 Test Loss: 0.611 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6389768123626709
Epoch: 13, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.602 Vali Acc: 0.767 Test Loss: 0.602 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766661).  Saving model ...
Epoch: 14 cost time: 0.6488327980041504
Epoch: 14, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.621 Vali Acc: 0.750 Test Loss: 0.621 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6662540435791016
Epoch: 15, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.642 Vali Acc: 0.756 Test Loss: 0.642 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6341631412506104
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.671 Vali Acc: 0.739 Test Loss: 0.671 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6674189567565918
Epoch: 17, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.666 Vali Acc: 0.756 Test Loss: 0.666 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6707785129547119
Epoch: 18, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.646 Vali Acc: 0.750 Test Loss: 0.646 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6875848770141602
Epoch: 19, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.672 Vali Acc: 0.744 Test Loss: 0.672 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6966121196746826
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.667 Vali Acc: 0.756 Test Loss: 0.667 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6700625419616699
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.684 Vali Acc: 0.750 Test Loss: 0.684 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6810996532440186
Epoch: 22, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.726 Vali Acc: 0.756 Test Loss: 0.726 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.672713041305542
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.688 Vali Acc: 0.756 Test Loss: 0.688 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 45446
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3275389671325684
Epoch: 1, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.208 Vali Acc: 0.567 Test Loss: 1.208 Test Acc: 0.567
Validation loss decreased (inf --> -0.566655).  Saving model ...
Epoch: 2 cost time: 0.8955984115600586
Epoch: 2, Steps: 12 | Train Loss: 0.961 Vali Loss: 0.788 Vali Acc: 0.667 Test Loss: 0.788 Test Acc: 0.667
Validation loss decreased (-0.566655 --> -0.666659).  Saving model ...
Epoch: 3 cost time: 0.7740583419799805
Epoch: 3, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.714 Vali Acc: 0.706 Test Loss: 0.714 Test Acc: 0.706
Validation loss decreased (-0.666659 --> -0.705548).  Saving model ...
Epoch: 4 cost time: 0.7896132469177246
Epoch: 4, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.885 Vali Acc: 0.672 Test Loss: 0.885 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9167742729187012
Epoch: 5, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.577 Vali Acc: 0.761 Test Loss: 0.577 Test Acc: 0.761
Validation loss decreased (-0.705548 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 0.9105584621429443
Epoch: 6, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.741 Vali Acc: 0.744 Test Loss: 0.741 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8372840881347656
Epoch: 7, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.785 Vali Acc: 0.728 Test Loss: 0.785 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8304705619812012
Epoch: 8, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.955 Vali Acc: 0.717 Test Loss: 0.955 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9219503402709961
Epoch: 9, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.907 Vali Acc: 0.778 Test Loss: 0.907 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777769).  Saving model ...
Epoch: 10 cost time: 0.9322295188903809
Epoch: 10, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.827 Vali Acc: 0.767 Test Loss: 0.827 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.973135232925415
Epoch: 11, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9027400016784668
Epoch: 12, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.909 Vali Acc: 0.783 Test Loss: 0.909 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783324).  Saving model ...
Epoch: 13 cost time: 0.9658758640289307
Epoch: 13, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.542 Vali Acc: 0.711 Test Loss: 1.542 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8592517375946045
Epoch: 14, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.168 Vali Acc: 0.778 Test Loss: 1.168 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8792839050292969
Epoch: 15, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.100 Vali Acc: 0.778 Test Loss: 1.100 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.796419620513916
Epoch: 16, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.241 Vali Acc: 0.761 Test Loss: 1.241 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7715475559234619
Epoch: 17, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.309 Vali Acc: 0.744 Test Loss: 1.309 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9358823299407959
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.242 Vali Acc: 0.756 Test Loss: 1.242 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.87345290184021
Epoch: 19, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.756 Test Loss: 1.296 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7545328140258789
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.284 Vali Acc: 0.767 Test Loss: 1.284 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9673969745635986
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.308 Vali Acc: 0.750 Test Loss: 1.308 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.005953073501587
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.744 Test Loss: 1.335 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 243686
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3391432762145996
Epoch: 1, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.456 Vali Acc: 0.467 Test Loss: 1.456 Test Acc: 0.467
Validation loss decreased (inf --> -0.466652).  Saving model ...
Epoch: 2 cost time: 0.9512243270874023
Epoch: 2, Steps: 12 | Train Loss: 1.184 Vali Loss: 0.954 Vali Acc: 0.606 Test Loss: 0.954 Test Acc: 0.606
Validation loss decreased (-0.466652 --> -0.605546).  Saving model ...
Epoch: 3 cost time: 0.9696412086486816
Epoch: 3, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.746 Vali Acc: 0.689 Test Loss: 0.746 Test Acc: 0.689
Validation loss decreased (-0.605546 --> -0.688881).  Saving model ...
Epoch: 4 cost time: 0.9341468811035156
Epoch: 4, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.689 Vali Acc: 0.711 Test Loss: 0.689 Test Acc: 0.711
Validation loss decreased (-0.688881 --> -0.711104).  Saving model ...
Epoch: 5 cost time: 0.9464201927185059
Epoch: 5, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.627 Vali Acc: 0.744 Test Loss: 0.627 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 0.9516463279724121
Epoch: 6, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.682 Vali Acc: 0.750 Test Loss: 0.682 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 0.9310648441314697
Epoch: 7, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.693 Vali Acc: 0.733 Test Loss: 0.693 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8618075847625732
Epoch: 8, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.799 Vali Acc: 0.706 Test Loss: 0.799 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7869009971618652
Epoch: 9, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.746 Vali Acc: 0.722 Test Loss: 0.746 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8858747482299805
Epoch: 10, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.784 Vali Acc: 0.767 Test Loss: 0.784 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766659).  Saving model ...
Epoch: 11 cost time: 0.8695666790008545
Epoch: 11, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.838 Vali Acc: 0.744 Test Loss: 0.838 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8926217555999756
Epoch: 12, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.763 Vali Acc: 0.756 Test Loss: 0.763 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8877720832824707
Epoch: 13, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.794 Vali Acc: 0.761 Test Loss: 0.794 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9002561569213867
Epoch: 14, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.877 Vali Acc: 0.739 Test Loss: 0.877 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8735322952270508
Epoch: 15, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8789010047912598
Epoch: 16, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.890 Vali Acc: 0.744 Test Loss: 0.890 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9743719100952148
Epoch: 17, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.976 Vali Acc: 0.750 Test Loss: 0.976 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9069867134094238
Epoch: 18, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.857 Vali Acc: 0.767 Test Loss: 0.857 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9144117832183838
Epoch: 19, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.935 Vali Acc: 0.761 Test Loss: 0.935 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9198789596557617
Epoch: 20, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.144 Vali Acc: 0.744 Test Loss: 1.144 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 128518
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.244140625
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.395 Vali Acc: 0.456 Test Loss: 1.395 Test Acc: 0.456
Validation loss decreased (inf --> -0.455542).  Saving model ...
Epoch: 2 cost time: 0.902925968170166
Epoch: 2, Steps: 12 | Train Loss: 1.144 Vali Loss: 0.896 Vali Acc: 0.639 Test Loss: 0.896 Test Acc: 0.639
Validation loss decreased (-0.455542 --> -0.638880).  Saving model ...
Epoch: 3 cost time: 0.8777451515197754
Epoch: 3, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.739 Vali Acc: 0.700 Test Loss: 0.739 Test Acc: 0.700
Validation loss decreased (-0.638880 --> -0.699993).  Saving model ...
Epoch: 4 cost time: 0.8792624473571777
Epoch: 4, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.678 Vali Acc: 0.717 Test Loss: 0.678 Test Acc: 0.717
Validation loss decreased (-0.699993 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 0.8644673824310303
Epoch: 5, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.677 Vali Acc: 0.733 Test Loss: 0.677 Test Acc: 0.733
Validation loss decreased (-0.716660 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 0.8286750316619873
Epoch: 6, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.792 Vali Acc: 0.717 Test Loss: 0.792 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.857363224029541
Epoch: 7, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.626 Vali Acc: 0.728 Test Loss: 0.626 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9306085109710693
Epoch: 8, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.714 Vali Acc: 0.739 Test Loss: 0.714 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738882).  Saving model ...
Epoch: 9 cost time: 0.8920223712921143
Epoch: 9, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.813 Vali Acc: 0.761 Test Loss: 0.813 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761103).  Saving model ...
Epoch: 10 cost time: 0.9060564041137695
Epoch: 10, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.743 Vali Acc: 0.744 Test Loss: 0.743 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8629720211029053
Epoch: 11, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.834 Vali Acc: 0.744 Test Loss: 0.834 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8605771064758301
Epoch: 12, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.757 Vali Acc: 0.772 Test Loss: 0.757 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772215).  Saving model ...
Epoch: 13 cost time: 0.9325313568115234
Epoch: 13, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.804 Vali Acc: 0.756 Test Loss: 0.804 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.908104658126831
Epoch: 14, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.781 Vali Acc: 0.761 Test Loss: 0.781 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9350264072418213
Epoch: 15, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.906 Vali Acc: 0.761 Test Loss: 0.906 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.923473596572876
Epoch: 16, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.910 Vali Acc: 0.744 Test Loss: 0.910 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8667676448822021
Epoch: 17, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.831 Vali Acc: 0.767 Test Loss: 0.831 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8601233959197998
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.895 Vali Acc: 0.750 Test Loss: 0.895 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8750503063201904
Epoch: 19, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.910 Vali Acc: 0.761 Test Loss: 0.910 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.845834493637085
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.912 Vali Acc: 0.756 Test Loss: 0.912 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8763506412506104
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.914 Vali Acc: 0.767 Test Loss: 0.914 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8368391990661621
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.904 Vali Acc: 0.756 Test Loss: 0.904 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 123942
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4175033569335938
Epoch: 1, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.406 Vali Acc: 0.561 Test Loss: 1.406 Test Acc: 0.561
Validation loss decreased (inf --> -0.561097).  Saving model ...
Epoch: 2 cost time: 0.8541398048400879
Epoch: 2, Steps: 12 | Train Loss: 1.255 Vali Loss: 0.947 Vali Acc: 0.672 Test Loss: 0.947 Test Acc: 0.672
Validation loss decreased (-0.561097 --> -0.672213).  Saving model ...
Epoch: 3 cost time: 0.8982961177825928
Epoch: 3, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.785 Vali Acc: 0.700 Test Loss: 0.785 Test Acc: 0.700
Validation loss decreased (-0.672213 --> -0.699992).  Saving model ...
Epoch: 4 cost time: 0.8912358283996582
Epoch: 4, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.695 Vali Acc: 0.706 Test Loss: 0.695 Test Acc: 0.706
Validation loss decreased (-0.699992 --> -0.705549).  Saving model ...
Epoch: 5 cost time: 0.8667480945587158
Epoch: 5, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.603 Vali Acc: 0.756 Test Loss: 0.603 Test Acc: 0.756
Validation loss decreased (-0.705549 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 0.856330394744873
Epoch: 6, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.659 Vali Acc: 0.756 Test Loss: 0.659 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9271512031555176
Epoch: 7, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.582 Vali Acc: 0.772 Test Loss: 0.582 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772216).  Saving model ...
Epoch: 8 cost time: 0.910808801651001
Epoch: 8, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9060323238372803
Epoch: 9, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.567 Vali Acc: 0.761 Test Loss: 0.567 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9196524620056152
Epoch: 10, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.602 Vali Acc: 0.739 Test Loss: 0.602 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8950645923614502
Epoch: 11, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.627 Vali Acc: 0.761 Test Loss: 0.627 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8601675033569336
Epoch: 12, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.718 Vali Acc: 0.744 Test Loss: 0.718 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9455227851867676
Epoch: 13, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.626 Vali Acc: 0.761 Test Loss: 0.626 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8313479423522949
Epoch: 14, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.721 Vali Acc: 0.767 Test Loss: 0.721 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8831651210784912
Epoch: 15, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.729 Vali Acc: 0.761 Test Loss: 0.729 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.879936933517456
Epoch: 16, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.688 Vali Acc: 0.756 Test Loss: 0.688 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8499898910522461
Epoch: 17, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.739 Vali Acc: 0.750 Test Loss: 0.739 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 87142
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.282886505126953
Epoch: 1, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.540 Vali Acc: 0.406 Test Loss: 1.540 Test Acc: 0.406
Validation loss decreased (inf --> -0.405540).  Saving model ...
Epoch: 2 cost time: 0.8146286010742188
Epoch: 2, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.090 Vali Acc: 0.617 Test Loss: 1.090 Test Acc: 0.617
Validation loss decreased (-0.405540 --> -0.616656).  Saving model ...
Epoch: 3 cost time: 0.7861242294311523
Epoch: 3, Steps: 12 | Train Loss: 0.902 Vali Loss: 0.910 Vali Acc: 0.644 Test Loss: 0.910 Test Acc: 0.644
Validation loss decreased (-0.616656 --> -0.644435).  Saving model ...
Epoch: 4 cost time: 0.9381401538848877
Epoch: 4, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.773 Vali Acc: 0.700 Test Loss: 0.773 Test Acc: 0.700
Validation loss decreased (-0.644435 --> -0.699992).  Saving model ...
Epoch: 5 cost time: 0.9105136394500732
Epoch: 5, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.698 Vali Acc: 0.717 Test Loss: 0.698 Test Acc: 0.717
Validation loss decreased (-0.699992 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 0.9079909324645996
Epoch: 6, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.713 Vali Acc: 0.750 Test Loss: 0.713 Test Acc: 0.750
Validation loss decreased (-0.716660 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 0.8596222400665283
Epoch: 7, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.635 Vali Acc: 0.744 Test Loss: 0.635 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8756437301635742
Epoch: 8, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.668 Vali Acc: 0.750 Test Loss: 0.668 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 0.9025278091430664
Epoch: 9, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 0.8587830066680908
Epoch: 10, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.611 Vali Acc: 0.756 Test Loss: 0.611 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 11 cost time: 0.893341064453125
Epoch: 11, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.700 Vali Acc: 0.728 Test Loss: 0.700 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8592991828918457
Epoch: 12, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.663 Vali Acc: 0.750 Test Loss: 0.663 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9094669818878174
Epoch: 13, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.752 Vali Acc: 0.744 Test Loss: 0.752 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8570389747619629
Epoch: 14, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.715 Vali Acc: 0.744 Test Loss: 0.715 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.95340895652771
Epoch: 15, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.735 Vali Acc: 0.733 Test Loss: 0.735 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.90486741065979
Epoch: 16, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.722 Vali Acc: 0.739 Test Loss: 0.722 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.948336124420166
Epoch: 17, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.737 Vali Acc: 0.739 Test Loss: 0.737 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9259605407714844
Epoch: 18, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.741 Vali Acc: 0.756 Test Loss: 0.741 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8955891132354736
Epoch: 19, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.807 Vali Acc: 0.756 Test Loss: 0.807 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8940815925598145
Epoch: 20, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.818 Vali Acc: 0.744 Test Loss: 0.818 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 64166
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1672966480255127
Epoch: 1, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.738 Vali Acc: 0.239 Test Loss: 1.738 Test Acc: 0.239
Validation loss decreased (inf --> -0.238872).  Saving model ...
Epoch: 2 cost time: 0.7322311401367188
Epoch: 2, Steps: 12 | Train Loss: 1.523 Vali Loss: 1.343 Vali Acc: 0.511 Test Loss: 1.343 Test Acc: 0.511
Validation loss decreased (-0.238872 --> -0.511098).  Saving model ...
Epoch: 3 cost time: 0.6957619190216064
Epoch: 3, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.078 Vali Acc: 0.611 Test Loss: 1.078 Test Acc: 0.611
Validation loss decreased (-0.511098 --> -0.611100).  Saving model ...
Epoch: 4 cost time: 0.6770668029785156
Epoch: 4, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.909 Vali Acc: 0.611 Test Loss: 0.909 Test Acc: 0.611
Validation loss decreased (-0.611100 --> -0.611102).  Saving model ...
Epoch: 5 cost time: 0.6751570701599121
Epoch: 5, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.819 Vali Acc: 0.683 Test Loss: 0.819 Test Acc: 0.683
Validation loss decreased (-0.611102 --> -0.683325).  Saving model ...
Epoch: 6 cost time: 0.6192500591278076
Epoch: 6, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.770 Vali Acc: 0.689 Test Loss: 0.770 Test Acc: 0.689
Validation loss decreased (-0.683325 --> -0.688881).  Saving model ...
Epoch: 7 cost time: 0.7271945476531982
Epoch: 7, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.689 Vali Acc: 0.728 Test Loss: 0.689 Test Acc: 0.728
Validation loss decreased (-0.688881 --> -0.727771).  Saving model ...
Epoch: 8 cost time: 0.7015461921691895
Epoch: 8, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6576688289642334
Epoch: 9, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.653 Vali Acc: 0.728 Test Loss: 0.653 Test Acc: 0.728
Validation loss decreased (-0.727771 --> -0.727771).  Saving model ...
Epoch: 10 cost time: 0.6155719757080078
Epoch: 10, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.637 Vali Acc: 0.739 Test Loss: 0.637 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 11 cost time: 0.6717538833618164
Epoch: 11, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6827850341796875
Epoch: 12, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.626 Vali Acc: 0.744 Test Loss: 0.626 Test Acc: 0.744
Validation loss decreased (-0.738883 --> -0.744438).  Saving model ...
Epoch: 13 cost time: 0.6673808097839355
Epoch: 13, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.639 Vali Acc: 0.739 Test Loss: 0.639 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6911501884460449
Epoch: 14, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.666 Vali Acc: 0.761 Test Loss: 0.666 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 0.682220458984375
Epoch: 15, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.700 Vali Acc: 0.717 Test Loss: 0.700 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6866304874420166
Epoch: 16, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.683 Vali Acc: 0.728 Test Loss: 0.683 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7171154022216797
Epoch: 17, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.706 Vali Acc: 0.744 Test Loss: 0.706 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6395263671875
Epoch: 18, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.722 Vali Acc: 0.722 Test Loss: 0.722 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6518266201019287
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.719 Vali Acc: 0.739 Test Loss: 0.719 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6591475009918213
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.759 Vali Acc: 0.717 Test Loss: 0.759 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7655234336853027
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.743 Vali Acc: 0.728 Test Loss: 0.743 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6515662670135498
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.772 Vali Acc: 0.733 Test Loss: 0.772 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6407222747802734
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.801 Vali Acc: 0.711 Test Loss: 0.801 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6615674495697021
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.789 Vali Acc: 0.739 Test Loss: 0.789 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 45830
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2246947288513184
Epoch: 1, Steps: 12 | Train Loss: 1.906 Vali Loss: 1.736 Vali Acc: 0.222 Test Loss: 1.736 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 0.7041440010070801
Epoch: 2, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.397 Vali Acc: 0.500 Test Loss: 1.397 Test Acc: 0.500
Validation loss decreased (-0.222205 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 0.6607670783996582
Epoch: 3, Steps: 12 | Train Loss: 1.195 Vali Loss: 1.126 Vali Acc: 0.594 Test Loss: 1.126 Test Acc: 0.594
Validation loss decreased (-0.499986 --> -0.594433).  Saving model ...
Epoch: 4 cost time: 0.6354289054870605
Epoch: 4, Steps: 12 | Train Loss: 0.966 Vali Loss: 0.975 Vali Acc: 0.617 Test Loss: 0.975 Test Acc: 0.617
Validation loss decreased (-0.594433 --> -0.616657).  Saving model ...
Epoch: 5 cost time: 0.6626381874084473
Epoch: 5, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.901 Vali Acc: 0.622 Test Loss: 0.901 Test Acc: 0.622
Validation loss decreased (-0.616657 --> -0.622213).  Saving model ...
Epoch: 6 cost time: 0.6838304996490479
Epoch: 6, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.832 Vali Acc: 0.661 Test Loss: 0.832 Test Acc: 0.661
Validation loss decreased (-0.622213 --> -0.661103).  Saving model ...
Epoch: 7 cost time: 0.6343226432800293
Epoch: 7, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.744 Vali Acc: 0.711 Test Loss: 0.744 Test Acc: 0.711
Validation loss decreased (-0.661103 --> -0.711104).  Saving model ...
Epoch: 8 cost time: 0.6530592441558838
Epoch: 8, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.725 Vali Acc: 0.694 Test Loss: 0.725 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6938621997833252
Epoch: 9, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.693 Vali Acc: 0.733 Test Loss: 0.693 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733326).  Saving model ...
Epoch: 10 cost time: 0.7365508079528809
Epoch: 10, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.669 Vali Acc: 0.722 Test Loss: 0.669 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7076387405395508
Epoch: 11, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.656 Vali Acc: 0.739 Test Loss: 0.656 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 12 cost time: 0.5991899967193604
Epoch: 12, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.635 Vali Acc: 0.750 Test Loss: 0.635 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 0.6739470958709717
Epoch: 13, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.664 Vali Acc: 0.744 Test Loss: 0.664 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6594946384429932
Epoch: 14, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.704 Vali Acc: 0.744 Test Loss: 0.704 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6717324256896973
Epoch: 15, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.659 Vali Acc: 0.739 Test Loss: 0.659 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6875460147857666
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.678 Vali Acc: 0.739 Test Loss: 0.678 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7173938751220703
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.702 Vali Acc: 0.733 Test Loss: 0.702 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7998394966125488
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.716 Vali Acc: 0.744 Test Loss: 0.716 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6378312110900879
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.685 Vali Acc: 0.767 Test Loss: 0.685 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766660).  Saving model ...
Epoch: 20 cost time: 0.6870453357696533
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.728 Vali Acc: 0.739 Test Loss: 0.728 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7083799839019775
Epoch: 21, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.732 Vali Acc: 0.756 Test Loss: 0.732 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7231531143188477
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.755 Vali Acc: 0.744 Test Loss: 0.755 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7289538383483887
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.752 Vali Acc: 0.756 Test Loss: 0.752 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.64402174949646
Epoch: 24, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6969943046569824
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.773 Vali Acc: 0.767 Test Loss: 0.773 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7227756977081299
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.803 Vali Acc: 0.767 Test Loss: 0.803 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6600582599639893
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.816 Vali Acc: 0.744 Test Loss: 0.816 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6589350700378418
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.811 Vali Acc: 0.761 Test Loss: 0.811 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7540678977966309
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.817 Vali Acc: 0.767 Test Loss: 0.817 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm32_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 41286
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2544195652008057
Epoch: 1, Steps: 12 | Train Loss: 1.750 Vali Loss: 1.459 Vali Acc: 0.411 Test Loss: 1.459 Test Acc: 0.411
Validation loss decreased (inf --> -0.411097).  Saving model ...
Epoch: 2 cost time: 0.7624483108520508
Epoch: 2, Steps: 12 | Train Loss: 1.137 Vali Loss: 0.965 Vali Acc: 0.594 Test Loss: 0.965 Test Acc: 0.594
Validation loss decreased (-0.411097 --> -0.594435).  Saving model ...
Epoch: 3 cost time: 0.7467026710510254
Epoch: 3, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.924 Vali Acc: 0.600 Test Loss: 0.924 Test Acc: 0.600
Validation loss decreased (-0.594435 --> -0.599991).  Saving model ...
Epoch: 4 cost time: 0.7600498199462891
Epoch: 4, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.616 Vali Acc: 0.744 Test Loss: 0.616 Test Acc: 0.744
Validation loss decreased (-0.599991 --> -0.744438).  Saving model ...
Epoch: 5 cost time: 0.7720472812652588
Epoch: 5, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
Validation loss decreased (-0.744438 --> -0.788883).  Saving model ...
Epoch: 6 cost time: 0.7339916229248047
Epoch: 6, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.667 Vali Acc: 0.733 Test Loss: 0.667 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9251317977905273
Epoch: 7, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.675 Vali Acc: 0.750 Test Loss: 0.675 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8764200210571289
Epoch: 8, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.624 Vali Acc: 0.744 Test Loss: 0.624 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8798344135284424
Epoch: 9, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.653 Vali Acc: 0.744 Test Loss: 0.653 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9086554050445557
Epoch: 10, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.835 Vali Acc: 0.750 Test Loss: 0.835 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.856518030166626
Epoch: 11, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.918 Vali Acc: 0.756 Test Loss: 0.918 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9041056632995605
Epoch: 12, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.700 Vali Acc: 0.739 Test Loss: 0.700 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8683440685272217
Epoch: 13, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8947782516479492
Epoch: 14, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.829 Vali Acc: 0.756 Test Loss: 0.829 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8970887660980225
Epoch: 15, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.783 Vali Acc: 0.778 Test Loss: 0.783 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 127190
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1489436626434326
Epoch: 1, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.587 Vali Acc: 0.361 Test Loss: 1.587 Test Acc: 0.361
Validation loss decreased (inf --> -0.361095).  Saving model ...
Epoch: 2 cost time: 0.7614288330078125
Epoch: 2, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.123 Vali Acc: 0.628 Test Loss: 1.123 Test Acc: 0.628
Validation loss decreased (-0.361095 --> -0.627767).  Saving model ...
Epoch: 3 cost time: 0.7426073551177979
Epoch: 3, Steps: 12 | Train Loss: 0.943 Vali Loss: 0.893 Vali Acc: 0.656 Test Loss: 0.893 Test Acc: 0.656
Validation loss decreased (-0.627767 --> -0.655547).  Saving model ...
Epoch: 4 cost time: 0.7893521785736084
Epoch: 4, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.792 Vali Acc: 0.672 Test Loss: 0.792 Test Acc: 0.672
Validation loss decreased (-0.655547 --> -0.672214).  Saving model ...
Epoch: 5 cost time: 0.7720122337341309
Epoch: 5, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.720 Vali Acc: 0.689 Test Loss: 0.720 Test Acc: 0.689
Validation loss decreased (-0.672214 --> -0.688882).  Saving model ...
Epoch: 6 cost time: 0.7925436496734619
Epoch: 6, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.685 Vali Acc: 0.728 Test Loss: 0.685 Test Acc: 0.728
Validation loss decreased (-0.688882 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 0.7988824844360352
Epoch: 7, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.704 Vali Acc: 0.717 Test Loss: 0.704 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8192243576049805
Epoch: 8, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7561566829681396
Epoch: 9, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.601 Vali Acc: 0.767 Test Loss: 0.601 Test Acc: 0.767
Validation loss decreased (-0.727771 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 0.7358770370483398
Epoch: 10, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.642 Vali Acc: 0.750 Test Loss: 0.642 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8072478771209717
Epoch: 11, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.736 Vali Acc: 0.722 Test Loss: 0.736 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8470554351806641
Epoch: 12, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.702 Vali Acc: 0.756 Test Loss: 0.702 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7634046077728271
Epoch: 13, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.671 Vali Acc: 0.761 Test Loss: 0.671 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8958024978637695
Epoch: 14, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.657 Vali Acc: 0.756 Test Loss: 0.657 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8490340709686279
Epoch: 15, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.862 Vali Acc: 0.728 Test Loss: 0.862 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.792306661605835
Epoch: 16, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.680 Vali Acc: 0.750 Test Loss: 0.680 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7784922122955322
Epoch: 17, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.689 Vali Acc: 0.756 Test Loss: 0.689 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7704834938049316
Epoch: 18, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7653567790985107
Epoch: 19, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.770 Vali Acc: 0.744 Test Loss: 0.770 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 69606
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0766522884368896
Epoch: 1, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.564 Vali Acc: 0.350 Test Loss: 1.564 Test Acc: 0.350
Validation loss decreased (inf --> -0.349984).  Saving model ...
Epoch: 2 cost time: 0.8552703857421875
Epoch: 2, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.146 Vali Acc: 0.583 Test Loss: 1.146 Test Acc: 0.583
Validation loss decreased (-0.349984 --> -0.583322).  Saving model ...
Epoch: 3 cost time: 0.8155407905578613
Epoch: 3, Steps: 12 | Train Loss: 1.046 Vali Loss: 0.905 Vali Acc: 0.606 Test Loss: 0.905 Test Acc: 0.606
Validation loss decreased (-0.583322 --> -0.605547).  Saving model ...
Epoch: 4 cost time: 0.8312277793884277
Epoch: 4, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.768 Vali Acc: 0.694 Test Loss: 0.768 Test Acc: 0.694
Validation loss decreased (-0.605547 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 0.8004245758056641
Epoch: 5, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.663 Vali Acc: 0.739 Test Loss: 0.663 Test Acc: 0.739
Validation loss decreased (-0.694437 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 0.834200382232666
Epoch: 6, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.658 Vali Acc: 0.717 Test Loss: 0.658 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7509686946868896
Epoch: 7, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.616 Vali Acc: 0.728 Test Loss: 0.616 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7905027866363525
Epoch: 8, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.600 Vali Acc: 0.761 Test Loss: 0.600 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 0.7600667476654053
Epoch: 9, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.609 Vali Acc: 0.761 Test Loss: 0.609 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7626471519470215
Epoch: 10, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.616 Vali Acc: 0.728 Test Loss: 0.616 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7970383167266846
Epoch: 11, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.625 Vali Acc: 0.761 Test Loss: 0.625 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7778637409210205
Epoch: 12, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.609 Vali Acc: 0.756 Test Loss: 0.609 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7893140316009521
Epoch: 13, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.737 Vali Acc: 0.744 Test Loss: 0.737 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7912347316741943
Epoch: 14, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.657 Vali Acc: 0.761 Test Loss: 0.657 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.798353910446167
Epoch: 15, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.707 Vali Acc: 0.750 Test Loss: 0.707 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7925171852111816
Epoch: 16, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.694 Vali Acc: 0.767 Test Loss: 0.694 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 17 cost time: 0.8692111968994141
Epoch: 17, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.697 Vali Acc: 0.761 Test Loss: 0.697 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8203940391540527
Epoch: 18, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.711 Vali Acc: 0.772 Test Loss: 0.711 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772215).  Saving model ...
Epoch: 19 cost time: 0.8179447650909424
Epoch: 19, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.760 Vali Acc: 0.756 Test Loss: 0.760 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7661356925964355
Epoch: 20, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.723 Vali Acc: 0.756 Test Loss: 0.723 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7382142543792725
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.696 Vali Acc: 0.756 Test Loss: 0.696 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.750969648361206
Epoch: 22, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.719 Vali Acc: 0.756 Test Loss: 0.719 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7284646034240723
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.762 Vali Acc: 0.761 Test Loss: 0.762 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7632937431335449
Epoch: 24, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.775 Vali Acc: 0.756 Test Loss: 0.775 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7351479530334473
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.779 Vali Acc: 0.756 Test Loss: 0.779 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7332501411437988
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.778 Vali Acc: 0.772 Test Loss: 0.778 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8077034950256348
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.758 Vali Acc: 0.772 Test Loss: 0.758 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8235220909118652
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.771 Vali Acc: 0.772 Test Loss: 0.771 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 67318
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2312793731689453
Epoch: 1, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.572 Vali Acc: 0.367 Test Loss: 1.572 Test Acc: 0.367
Validation loss decreased (inf --> -0.366651).  Saving model ...
Epoch: 2 cost time: 0.7135767936706543
Epoch: 2, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.218 Vali Acc: 0.561 Test Loss: 1.218 Test Acc: 0.561
Validation loss decreased (-0.366651 --> -0.561099).  Saving model ...
Epoch: 3 cost time: 0.8321328163146973
Epoch: 3, Steps: 12 | Train Loss: 1.018 Vali Loss: 0.983 Vali Acc: 0.622 Test Loss: 0.983 Test Acc: 0.622
Validation loss decreased (-0.561099 --> -0.622212).  Saving model ...
Epoch: 4 cost time: 0.7880353927612305
Epoch: 4, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.850 Vali Acc: 0.644 Test Loss: 0.850 Test Acc: 0.644
Validation loss decreased (-0.622212 --> -0.644436).  Saving model ...
Epoch: 5 cost time: 0.8252499103546143
Epoch: 5, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.757 Vali Acc: 0.689 Test Loss: 0.757 Test Acc: 0.689
Validation loss decreased (-0.644436 --> -0.688881).  Saving model ...
Epoch: 6 cost time: 0.8820891380310059
Epoch: 6, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.708 Vali Acc: 0.711 Test Loss: 0.708 Test Acc: 0.711
Validation loss decreased (-0.688881 --> -0.711104).  Saving model ...
Epoch: 7 cost time: 0.7513468265533447
Epoch: 7, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.631 Vali Acc: 0.778 Test Loss: 0.631 Test Acc: 0.778
Validation loss decreased (-0.711104 --> -0.777771).  Saving model ...
Epoch: 8 cost time: 0.719851016998291
Epoch: 8, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.634 Vali Acc: 0.744 Test Loss: 0.634 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8036770820617676
Epoch: 9, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.645 Vali Acc: 0.728 Test Loss: 0.645 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7509503364562988
Epoch: 10, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.603 Vali Acc: 0.756 Test Loss: 0.603 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7615671157836914
Epoch: 11, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.616 Vali Acc: 0.756 Test Loss: 0.616 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8251473903656006
Epoch: 12, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.582 Vali Acc: 0.767 Test Loss: 0.582 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.845081090927124
Epoch: 13, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.580 Vali Acc: 0.778 Test Loss: 0.580 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777772).  Saving model ...
Epoch: 14 cost time: 0.7997071743011475
Epoch: 14, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.590 Vali Acc: 0.767 Test Loss: 0.590 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8868696689605713
Epoch: 15, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.605 Vali Acc: 0.761 Test Loss: 0.605 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7623505592346191
Epoch: 16, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.606 Vali Acc: 0.767 Test Loss: 0.606 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7837164402008057
Epoch: 17, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.593 Vali Acc: 0.772 Test Loss: 0.593 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.707125186920166
Epoch: 18, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.644 Vali Acc: 0.767 Test Loss: 0.644 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7001235485076904
Epoch: 19, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.634 Vali Acc: 0.756 Test Loss: 0.634 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7958621978759766
Epoch: 20, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7722516059875488
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.645 Vali Acc: 0.761 Test Loss: 0.645 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7893240451812744
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.679 Vali Acc: 0.772 Test Loss: 0.679 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7088277339935303
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.656 Vali Acc: 0.772 Test Loss: 0.656 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 48918
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.100006580352783
Epoch: 1, Steps: 12 | Train Loss: 1.901 Vali Loss: 1.665 Vali Acc: 0.300 Test Loss: 1.665 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 0.6204705238342285
Epoch: 2, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.359 Vali Acc: 0.511 Test Loss: 1.359 Test Acc: 0.511
Validation loss decreased (-0.299983 --> -0.511098).  Saving model ...
Epoch: 3 cost time: 0.666022777557373
Epoch: 3, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.082 Vali Acc: 0.572 Test Loss: 1.082 Test Acc: 0.572
Validation loss decreased (-0.511098 --> -0.572211).  Saving model ...
Epoch: 4 cost time: 0.5995168685913086
Epoch: 4, Steps: 12 | Train Loss: 0.966 Vali Loss: 0.934 Vali Acc: 0.617 Test Loss: 0.934 Test Acc: 0.617
Validation loss decreased (-0.572211 --> -0.616657).  Saving model ...
Epoch: 5 cost time: 0.6207106113433838
Epoch: 5, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.831 Vali Acc: 0.667 Test Loss: 0.831 Test Acc: 0.667
Validation loss decreased (-0.616657 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 0.664989709854126
Epoch: 6, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.769 Vali Acc: 0.667 Test Loss: 0.769 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666659).  Saving model ...
Epoch: 7 cost time: 0.6102209091186523
Epoch: 7, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.725 Vali Acc: 0.689 Test Loss: 0.725 Test Acc: 0.689
Validation loss decreased (-0.666659 --> -0.688882).  Saving model ...
Epoch: 8 cost time: 0.6488223075866699
Epoch: 8, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.651 Vali Acc: 0.728 Test Loss: 0.651 Test Acc: 0.728
Validation loss decreased (-0.688882 --> -0.727771).  Saving model ...
Epoch: 9 cost time: 0.7130355834960938
Epoch: 9, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.640 Vali Acc: 0.739 Test Loss: 0.640 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738882).  Saving model ...
Epoch: 10 cost time: 0.6316301822662354
Epoch: 10, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.615 Vali Acc: 0.711 Test Loss: 0.615 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6436161994934082
Epoch: 11, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.614 Vali Acc: 0.744 Test Loss: 0.614 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 12 cost time: 0.6585135459899902
Epoch: 12, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.592 Vali Acc: 0.733 Test Loss: 0.592 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6572661399841309
Epoch: 13, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6256706714630127
Epoch: 14, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.588 Vali Acc: 0.744 Test Loss: 0.588 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744439).  Saving model ...
Epoch: 15 cost time: 0.7222914695739746
Epoch: 15, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.597 Vali Acc: 0.733 Test Loss: 0.597 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7064263820648193
Epoch: 16, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.619 Vali Acc: 0.733 Test Loss: 0.619 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6768872737884521
Epoch: 17, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.598 Vali Acc: 0.739 Test Loss: 0.598 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6780598163604736
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.605 Vali Acc: 0.744 Test Loss: 0.605 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6994435787200928
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.631 Vali Acc: 0.733 Test Loss: 0.631 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6387150287628174
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.594 Vali Acc: 0.750 Test Loss: 0.594 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749994).  Saving model ...
Epoch: 21 cost time: 0.6821558475494385
Epoch: 21, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.617 Vali Acc: 0.744 Test Loss: 0.617 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6857442855834961
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.649 Vali Acc: 0.733 Test Loss: 0.649 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6619961261749268
Epoch: 23, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.656 Vali Acc: 0.739 Test Loss: 0.656 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.642545223236084
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.680 Vali Acc: 0.744 Test Loss: 0.680 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6350667476654053
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.649 Vali Acc: 0.744 Test Loss: 0.649 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6741676330566406
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.686 Vali Acc: 0.756 Test Loss: 0.686 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 27 cost time: 0.6523637771606445
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.709 Vali Acc: 0.733 Test Loss: 0.709 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7145705223083496
Epoch: 28, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.692 Vali Acc: 0.739 Test Loss: 0.692 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6398718357086182
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.667 Vali Acc: 0.750 Test Loss: 0.667 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6574833393096924
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.663 Vali Acc: 0.744 Test Loss: 0.663 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6713168621063232
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.695 Vali Acc: 0.744 Test Loss: 0.695 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6507828235626221
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.706 Vali Acc: 0.744 Test Loss: 0.706 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6654808521270752
Epoch: 33, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.705 Vali Acc: 0.744 Test Loss: 0.705 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6322448253631592
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.688 Vali Acc: 0.750 Test Loss: 0.688 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.665055513381958
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.705 Vali Acc: 0.744 Test Loss: 0.705 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5676143169403076
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.708 Vali Acc: 0.744 Test Loss: 0.708 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 37430
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.168412685394287
Epoch: 1, Steps: 12 | Train Loss: 1.919 Vali Loss: 1.727 Vali Acc: 0.289 Test Loss: 1.727 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 0.6950068473815918
Epoch: 2, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.502 Vali Acc: 0.456 Test Loss: 1.502 Test Acc: 0.456
Validation loss decreased (-0.288872 --> -0.455541).  Saving model ...
Epoch: 3 cost time: 0.6801605224609375
Epoch: 3, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.264 Vali Acc: 0.539 Test Loss: 1.264 Test Acc: 0.539
Validation loss decreased (-0.455541 --> -0.538876).  Saving model ...
Epoch: 4 cost time: 0.6834478378295898
Epoch: 4, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
Validation loss decreased (-0.538876 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.6921305656433105
Epoch: 5, Steps: 12 | Train Loss: 1.036 Vali Loss: 0.984 Vali Acc: 0.617 Test Loss: 0.984 Test Acc: 0.617
Validation loss decreased (-0.599989 --> -0.616657).  Saving model ...
Epoch: 6 cost time: 0.725698709487915
Epoch: 6, Steps: 12 | Train Loss: 0.881 Vali Loss: 0.889 Vali Acc: 0.622 Test Loss: 0.889 Test Acc: 0.622
Validation loss decreased (-0.616657 --> -0.622213).  Saving model ...
Epoch: 7 cost time: 0.6826212406158447
Epoch: 7, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.849 Vali Acc: 0.639 Test Loss: 0.849 Test Acc: 0.639
Validation loss decreased (-0.622213 --> -0.638880).  Saving model ...
Epoch: 8 cost time: 0.6588215827941895
Epoch: 8, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.778 Vali Acc: 0.672 Test Loss: 0.778 Test Acc: 0.672
Validation loss decreased (-0.638880 --> -0.672214).  Saving model ...
Epoch: 9 cost time: 0.6757845878601074
Epoch: 9, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.746 Vali Acc: 0.700 Test Loss: 0.746 Test Acc: 0.700
Validation loss decreased (-0.672214 --> -0.699993).  Saving model ...
Epoch: 10 cost time: 0.6644320487976074
Epoch: 10, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.719 Vali Acc: 0.706 Test Loss: 0.719 Test Acc: 0.706
Validation loss decreased (-0.699993 --> -0.705548).  Saving model ...
Epoch: 11 cost time: 0.677558183670044
Epoch: 11, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.699 Vali Acc: 0.711 Test Loss: 0.699 Test Acc: 0.711
Validation loss decreased (-0.705548 --> -0.711104).  Saving model ...
Epoch: 12 cost time: 0.6899125576019287
Epoch: 12, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.685 Vali Acc: 0.733 Test Loss: 0.685 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733326).  Saving model ...
Epoch: 13 cost time: 0.6636233329772949
Epoch: 13, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.665 Vali Acc: 0.728 Test Loss: 0.665 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6000576019287109
Epoch: 14, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.692 Vali Acc: 0.728 Test Loss: 0.692 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6170153617858887
Epoch: 15, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.666 Vali Acc: 0.750 Test Loss: 0.666 Test Acc: 0.750
Validation loss decreased (-0.733326 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 0.6790354251861572
Epoch: 16, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.675 Vali Acc: 0.744 Test Loss: 0.675 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6832244396209717
Epoch: 17, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.651 Vali Acc: 0.761 Test Loss: 0.651 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761105).  Saving model ...
Epoch: 18 cost time: 0.6501009464263916
Epoch: 18, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.646 Vali Acc: 0.744 Test Loss: 0.646 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6613900661468506
Epoch: 19, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.678 Vali Acc: 0.744 Test Loss: 0.678 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6248176097869873
Epoch: 20, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.688 Vali Acc: 0.733 Test Loss: 0.688 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5684831142425537
Epoch: 21, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.667 Vali Acc: 0.750 Test Loss: 0.667 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6702368259429932
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.720 Vali Acc: 0.750 Test Loss: 0.720 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6853585243225098
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.696 Vali Acc: 0.750 Test Loss: 0.696 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6333134174346924
Epoch: 24, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.698 Vali Acc: 0.739 Test Loss: 0.698 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6841106414794922
Epoch: 25, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.687 Vali Acc: 0.750 Test Loss: 0.687 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6152231693267822
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.710 Vali Acc: 0.744 Test Loss: 0.710 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.683326244354248
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.733 Vali Acc: 0.739 Test Loss: 0.733 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 28262
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9653141498565674
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.634 Vali Acc: 0.361 Test Loss: 1.634 Test Acc: 0.361
Validation loss decreased (inf --> -0.361095).  Saving model ...
Epoch: 2 cost time: 0.7228446006774902
Epoch: 2, Steps: 12 | Train Loss: 1.626 Vali Loss: 1.448 Vali Acc: 0.467 Test Loss: 1.448 Test Acc: 0.467
Validation loss decreased (-0.361095 --> -0.466652).  Saving model ...
Epoch: 3 cost time: 0.7006134986877441
Epoch: 3, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.279 Vali Acc: 0.528 Test Loss: 1.279 Test Acc: 0.528
Validation loss decreased (-0.466652 --> -0.527765).  Saving model ...
Epoch: 4 cost time: 0.5986170768737793
Epoch: 4, Steps: 12 | Train Loss: 1.216 Vali Loss: 1.132 Vali Acc: 0.589 Test Loss: 1.132 Test Acc: 0.589
Validation loss decreased (-0.527765 --> -0.588878).  Saving model ...
Epoch: 5 cost time: 0.6911845207214355
Epoch: 5, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.588878 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.720564603805542
Epoch: 6, Steps: 12 | Train Loss: 0.914 Vali Loss: 0.950 Vali Acc: 0.650 Test Loss: 0.950 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649991).  Saving model ...
Epoch: 7 cost time: 0.6778066158294678
Epoch: 7, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.878 Vali Acc: 0.672 Test Loss: 0.878 Test Acc: 0.672
Validation loss decreased (-0.649991 --> -0.672213).  Saving model ...
Epoch: 8 cost time: 0.6720097064971924
Epoch: 8, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.827 Vali Acc: 0.667 Test Loss: 0.827 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6456220149993896
Epoch: 9, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.758 Vali Acc: 0.717 Test Loss: 0.758 Test Acc: 0.717
Validation loss decreased (-0.672213 --> -0.716659).  Saving model ...
Epoch: 10 cost time: 0.6218481063842773
Epoch: 10, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.729 Vali Acc: 0.694 Test Loss: 0.729 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6532719135284424
Epoch: 11, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.691 Vali Acc: 0.761 Test Loss: 0.691 Test Acc: 0.761
Validation loss decreased (-0.716659 --> -0.761104).  Saving model ...
Epoch: 12 cost time: 0.6794767379760742
Epoch: 12, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.693 Vali Acc: 0.711 Test Loss: 0.693 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6581907272338867
Epoch: 13, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.674 Vali Acc: 0.728 Test Loss: 0.674 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.593496561050415
Epoch: 14, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.621 Vali Acc: 0.767 Test Loss: 0.621 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 15 cost time: 0.7160930633544922
Epoch: 15, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6773390769958496
Epoch: 16, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.614 Vali Acc: 0.761 Test Loss: 0.614 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6542048454284668
Epoch: 17, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.610 Vali Acc: 0.772 Test Loss: 0.610 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 18 cost time: 0.7326750755310059
Epoch: 18, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.611 Vali Acc: 0.767 Test Loss: 0.611 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.75730299949646
Epoch: 19, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.607 Vali Acc: 0.750 Test Loss: 0.607 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6083614826202393
Epoch: 20, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.596 Vali Acc: 0.767 Test Loss: 0.596 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.704636812210083
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.614 Vali Acc: 0.761 Test Loss: 0.614 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7210330963134766
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.624 Vali Acc: 0.750 Test Loss: 0.624 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7175326347351074
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.612 Vali Acc: 0.750 Test Loss: 0.612 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6910083293914795
Epoch: 24, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.618 Vali Acc: 0.750 Test Loss: 0.618 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7098169326782227
Epoch: 25, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.629 Vali Acc: 0.767 Test Loss: 0.629 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.620673418045044
Epoch: 26, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.672 Vali Acc: 0.744 Test Loss: 0.672 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6637368202209473
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.660 Vali Acc: 0.750 Test Loss: 0.660 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df256_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 25990
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2036492824554443
Epoch: 1, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.407 Vali Acc: 0.511 Test Loss: 1.407 Test Acc: 0.511
Validation loss decreased (inf --> -0.511097).  Saving model ...
Epoch: 2 cost time: 0.7770810127258301
Epoch: 2, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.031 Vali Acc: 0.556 Test Loss: 1.031 Test Acc: 0.556
Validation loss decreased (-0.511097 --> -0.555545).  Saving model ...
Epoch: 3 cost time: 0.802645206451416
Epoch: 3, Steps: 12 | Train Loss: 0.796 Vali Loss: 0.783 Vali Acc: 0.667 Test Loss: 0.783 Test Acc: 0.667
Validation loss decreased (-0.555545 --> -0.666659).  Saving model ...
Epoch: 4 cost time: 0.8206756114959717
Epoch: 4, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.861 Vali Acc: 0.661 Test Loss: 0.861 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8120877742767334
Epoch: 5, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.678 Vali Acc: 0.711 Test Loss: 0.678 Test Acc: 0.711
Validation loss decreased (-0.666659 --> -0.711104).  Saving model ...
Epoch: 6 cost time: 0.7565531730651855
Epoch: 6, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.754 Vali Acc: 0.689 Test Loss: 0.754 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7450637817382812
Epoch: 7, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.665 Vali Acc: 0.733 Test Loss: 0.665 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733327).  Saving model ...
Epoch: 8 cost time: 0.6579084396362305
Epoch: 8, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.834 Vali Acc: 0.750 Test Loss: 0.834 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 0.8092925548553467
Epoch: 9, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.847 Vali Acc: 0.706 Test Loss: 0.847 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8174207210540771
Epoch: 10, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.830 Vali Acc: 0.739 Test Loss: 0.830 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7689712047576904
Epoch: 11, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.761 Vali Acc: 0.728 Test Loss: 0.761 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.803673267364502
Epoch: 12, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.865 Vali Acc: 0.728 Test Loss: 0.865 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7624521255493164
Epoch: 13, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.828 Vali Acc: 0.756 Test Loss: 0.828 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 0.8419101238250732
Epoch: 14, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8412768840789795
Epoch: 15, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.799 Vali Acc: 0.761 Test Loss: 0.799 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 16 cost time: 0.8560669422149658
Epoch: 16, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.029 Vali Acc: 0.750 Test Loss: 1.029 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7948882579803467
Epoch: 17, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.844 Vali Acc: 0.783 Test Loss: 0.844 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783325).  Saving model ...
Epoch: 18 cost time: 0.8669209480285645
Epoch: 18, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.086 Vali Acc: 0.733 Test Loss: 1.086 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8149867057800293
Epoch: 19, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.963 Vali Acc: 0.756 Test Loss: 0.963 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7744483947753906
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.006 Vali Acc: 0.739 Test Loss: 1.006 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8082244396209717
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.986 Vali Acc: 0.778 Test Loss: 0.986 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8361639976501465
Epoch: 22, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.914 Vali Acc: 0.767 Test Loss: 0.914 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8257536888122559
Epoch: 23, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.926 Vali Acc: 0.756 Test Loss: 0.926 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7950348854064941
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.962 Vali Acc: 0.772 Test Loss: 0.962 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8769862651824951
Epoch: 25, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.948 Vali Acc: 0.761 Test Loss: 0.948 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8026950359344482
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.972 Vali Acc: 0.767 Test Loss: 0.972 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8095593452453613
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.039 Vali Acc: 0.767 Test Loss: 1.039 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 122966
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1919705867767334
Epoch: 1, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.499 Vali Acc: 0.456 Test Loss: 1.499 Test Acc: 0.456
Validation loss decreased (inf --> -0.455541).  Saving model ...
Epoch: 2 cost time: 0.7946453094482422
Epoch: 2, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.066 Vali Acc: 0.611 Test Loss: 1.066 Test Acc: 0.611
Validation loss decreased (-0.455541 --> -0.611100).  Saving model ...
Epoch: 3 cost time: 0.8915162086486816
Epoch: 3, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.872 Vali Acc: 0.617 Test Loss: 0.872 Test Acc: 0.617
Validation loss decreased (-0.611100 --> -0.616658).  Saving model ...
Epoch: 4 cost time: 0.850820779800415
Epoch: 4, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.749 Vali Acc: 0.689 Test Loss: 0.749 Test Acc: 0.689
Validation loss decreased (-0.616658 --> -0.688881).  Saving model ...
Epoch: 5 cost time: 0.8208839893341064
Epoch: 5, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.643 Vali Acc: 0.733 Test Loss: 0.643 Test Acc: 0.733
Validation loss decreased (-0.688881 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 0.8125772476196289
Epoch: 6, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.655 Vali Acc: 0.733 Test Loss: 0.655 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8278570175170898
Epoch: 7, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.675 Vali Acc: 0.733 Test Loss: 0.675 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8043851852416992
Epoch: 8, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.607 Vali Acc: 0.728 Test Loss: 0.607 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.830773115158081
Epoch: 9, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.635 Vali Acc: 0.733 Test Loss: 0.635 Test Acc: 0.733
Validation loss decreased (-0.733327 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 0.7798411846160889
Epoch: 10, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.764 Vali Acc: 0.717 Test Loss: 0.764 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7527339458465576
Epoch: 11, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.575 Vali Acc: 0.761 Test Loss: 0.575 Test Acc: 0.761
Validation loss decreased (-0.733327 --> -0.761105).  Saving model ...
Epoch: 12 cost time: 0.7797839641571045
Epoch: 12, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.646 Vali Acc: 0.750 Test Loss: 0.646 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7227897644042969
Epoch: 13, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.597 Vali Acc: 0.756 Test Loss: 0.597 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7939214706420898
Epoch: 14, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.733 Vali Acc: 0.778 Test Loss: 0.733 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 0.7693791389465332
Epoch: 15, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.716 Vali Acc: 0.744 Test Loss: 0.716 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8818111419677734
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.652 Vali Acc: 0.778 Test Loss: 0.652 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777771).  Saving model ...
Epoch: 17 cost time: 0.8361623287200928
Epoch: 17, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.699 Vali Acc: 0.761 Test Loss: 0.699 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8386592864990234
Epoch: 18, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.725 Vali Acc: 0.772 Test Loss: 0.725 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8900570869445801
Epoch: 19, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.798 Vali Acc: 0.767 Test Loss: 0.798 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.801741361618042
Epoch: 20, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.730 Vali Acc: 0.761 Test Loss: 0.730 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8119411468505859
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.810 Vali Acc: 0.761 Test Loss: 0.810 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7701637744903564
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.743 Vali Acc: 0.772 Test Loss: 0.743 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8722574710845947
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.746 Vali Acc: 0.767 Test Loss: 0.746 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8040339946746826
Epoch: 24, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.744 Vali Acc: 0.778 Test Loss: 0.744 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8200945854187012
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.800 Vali Acc: 0.767 Test Loss: 0.800 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7987895011901855
Epoch: 26, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.802 Vali Acc: 0.778 Test Loss: 0.802 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 65382
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.384042263031006
Epoch: 1, Steps: 12 | Train Loss: 1.831 Vali Loss: 1.548 Vali Acc: 0.456 Test Loss: 1.548 Test Acc: 0.456
Validation loss decreased (inf --> -0.455540).  Saving model ...
Epoch: 2 cost time: 0.8412830829620361
Epoch: 2, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.166 Vali Acc: 0.589 Test Loss: 1.166 Test Acc: 0.589
Validation loss decreased (-0.455540 --> -0.588877).  Saving model ...
Epoch: 3 cost time: 0.814164400100708
Epoch: 3, Steps: 12 | Train Loss: 1.062 Vali Loss: 0.932 Vali Acc: 0.633 Test Loss: 0.932 Test Acc: 0.633
Validation loss decreased (-0.588877 --> -0.633324).  Saving model ...
Epoch: 4 cost time: 0.8442997932434082
Epoch: 4, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.793 Vali Acc: 0.656 Test Loss: 0.793 Test Acc: 0.656
Validation loss decreased (-0.633324 --> -0.655548).  Saving model ...
Epoch: 5 cost time: 0.7986226081848145
Epoch: 5, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.745 Vali Acc: 0.700 Test Loss: 0.745 Test Acc: 0.700
Validation loss decreased (-0.655548 --> -0.699993).  Saving model ...
Epoch: 6 cost time: 1.034217119216919
Epoch: 6, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.662 Vali Acc: 0.744 Test Loss: 0.662 Test Acc: 0.744
Validation loss decreased (-0.699993 --> -0.744438).  Saving model ...
Epoch: 7 cost time: 0.8939840793609619
Epoch: 7, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.619 Vali Acc: 0.750 Test Loss: 0.619 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 0.810523509979248
Epoch: 8, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7907721996307373
Epoch: 9, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.577 Vali Acc: 0.761 Test Loss: 0.577 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761105).  Saving model ...
Epoch: 10 cost time: 0.7913806438446045
Epoch: 10, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.684 Vali Acc: 0.728 Test Loss: 0.684 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8161954879760742
Epoch: 11, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.772758960723877
Epoch: 12, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.649 Vali Acc: 0.761 Test Loss: 0.649 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7752342224121094
Epoch: 13, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.667 Vali Acc: 0.744 Test Loss: 0.667 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7579522132873535
Epoch: 14, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.641 Vali Acc: 0.772 Test Loss: 0.641 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772216).  Saving model ...
Epoch: 15 cost time: 0.7769453525543213
Epoch: 15, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.671 Vali Acc: 0.733 Test Loss: 0.671 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7900760173797607
Epoch: 16, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.645 Vali Acc: 0.772 Test Loss: 0.645 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7793838977813721
Epoch: 17, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.687 Vali Acc: 0.772 Test Loss: 0.687 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.759739875793457
Epoch: 18, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.701 Vali Acc: 0.733 Test Loss: 0.701 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.796959400177002
Epoch: 19, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.674 Vali Acc: 0.767 Test Loss: 0.674 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8299450874328613
Epoch: 20, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.701 Vali Acc: 0.761 Test Loss: 0.701 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.780921220779419
Epoch: 21, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.739 Vali Acc: 0.767 Test Loss: 0.739 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7851288318634033
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.696 Vali Acc: 0.761 Test Loss: 0.696 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8495707511901855
Epoch: 23, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.727 Vali Acc: 0.767 Test Loss: 0.727 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8072769641876221
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.754 Vali Acc: 0.761 Test Loss: 0.754 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 63094
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0143721103668213
Epoch: 1, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.689 Vali Acc: 0.300 Test Loss: 1.689 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 0.7826855182647705
Epoch: 2, Steps: 12 | Train Loss: 1.501 Vali Loss: 1.341 Vali Acc: 0.461 Test Loss: 1.341 Test Acc: 0.461
Validation loss decreased (-0.299983 --> -0.461098).  Saving model ...
Epoch: 3 cost time: 0.76194167137146
Epoch: 3, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.052 Vali Acc: 0.617 Test Loss: 1.052 Test Acc: 0.617
Validation loss decreased (-0.461098 --> -0.616656).  Saving model ...
Epoch: 4 cost time: 0.7379436492919922
Epoch: 4, Steps: 12 | Train Loss: 0.900 Vali Loss: 0.914 Vali Acc: 0.611 Test Loss: 0.914 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7631549835205078
Epoch: 5, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.800 Vali Acc: 0.672 Test Loss: 0.800 Test Acc: 0.672
Validation loss decreased (-0.616656 --> -0.672214).  Saving model ...
Epoch: 6 cost time: 0.7545654773712158
Epoch: 6, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.717 Vali Acc: 0.700 Test Loss: 0.717 Test Acc: 0.700
Validation loss decreased (-0.672214 --> -0.699993).  Saving model ...
Epoch: 7 cost time: 0.6785221099853516
Epoch: 7, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.654 Vali Acc: 0.739 Test Loss: 0.654 Test Acc: 0.739
Validation loss decreased (-0.699993 --> -0.738882).  Saving model ...
Epoch: 8 cost time: 0.6720726490020752
Epoch: 8, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.656 Vali Acc: 0.739 Test Loss: 0.656 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6761481761932373
Epoch: 9, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.655 Vali Acc: 0.750 Test Loss: 0.655 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 0.6656653881072998
Epoch: 10, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.600 Vali Acc: 0.756 Test Loss: 0.600 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755550).  Saving model ...
Epoch: 11 cost time: 0.6743261814117432
Epoch: 11, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.598 Vali Acc: 0.733 Test Loss: 0.598 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6858279705047607
Epoch: 12, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.582 Vali Acc: 0.761 Test Loss: 0.582 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761105).  Saving model ...
Epoch: 13 cost time: 0.702639102935791
Epoch: 13, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7139620780944824
Epoch: 14, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.582 Vali Acc: 0.767 Test Loss: 0.582 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 15 cost time: 0.6943745613098145
Epoch: 15, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7270998954772949
Epoch: 16, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.612 Vali Acc: 0.756 Test Loss: 0.612 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7678310871124268
Epoch: 17, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.613 Vali Acc: 0.744 Test Loss: 0.613 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6968894004821777
Epoch: 18, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.655 Vali Acc: 0.744 Test Loss: 0.655 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6637797355651855
Epoch: 19, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.662 Vali Acc: 0.744 Test Loss: 0.662 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.736443042755127
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.629 Vali Acc: 0.756 Test Loss: 0.629 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7953217029571533
Epoch: 21, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.634 Vali Acc: 0.756 Test Loss: 0.634 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7061572074890137
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.643 Vali Acc: 0.767 Test Loss: 0.643 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6840677261352539
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.657 Vali Acc: 0.767 Test Loss: 0.657 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7315194606781006
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.665 Vali Acc: 0.761 Test Loss: 0.665 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 44694
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.121746063232422
Epoch: 1, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.677 Vali Acc: 0.383 Test Loss: 1.677 Test Acc: 0.383
Validation loss decreased (inf --> -0.383317).  Saving model ...
Epoch: 2 cost time: 0.6707913875579834
Epoch: 2, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.363 Vali Acc: 0.578 Test Loss: 1.363 Test Acc: 0.578
Validation loss decreased (-0.383317 --> -0.577764).  Saving model ...
Epoch: 3 cost time: 0.6768910884857178
Epoch: 3, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.103 Vali Acc: 0.628 Test Loss: 1.103 Test Acc: 0.628
Validation loss decreased (-0.577764 --> -0.627767).  Saving model ...
Epoch: 4 cost time: 0.7137317657470703
Epoch: 4, Steps: 12 | Train Loss: 1.016 Vali Loss: 0.965 Vali Acc: 0.639 Test Loss: 0.965 Test Acc: 0.639
Validation loss decreased (-0.627767 --> -0.638879).  Saving model ...
Epoch: 5 cost time: 0.7552783489227295
Epoch: 5, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.863 Vali Acc: 0.678 Test Loss: 0.863 Test Acc: 0.678
Validation loss decreased (-0.638879 --> -0.677769).  Saving model ...
Epoch: 6 cost time: 0.7725391387939453
Epoch: 6, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.806 Vali Acc: 0.700 Test Loss: 0.806 Test Acc: 0.700
Validation loss decreased (-0.677769 --> -0.699992).  Saving model ...
Epoch: 7 cost time: 0.6690583229064941
Epoch: 7, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.746 Vali Acc: 0.706 Test Loss: 0.746 Test Acc: 0.706
Validation loss decreased (-0.699992 --> -0.705548).  Saving model ...
Epoch: 8 cost time: 0.7295618057250977
Epoch: 8, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.699 Vali Acc: 0.733 Test Loss: 0.699 Test Acc: 0.733
Validation loss decreased (-0.705548 --> -0.733326).  Saving model ...
Epoch: 9 cost time: 0.6867458820343018
Epoch: 9, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.684 Vali Acc: 0.767 Test Loss: 0.684 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766660).  Saving model ...
Epoch: 10 cost time: 0.7070672512054443
Epoch: 10, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.683 Vali Acc: 0.761 Test Loss: 0.683 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6507360935211182
Epoch: 11, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.639 Vali Acc: 0.744 Test Loss: 0.639 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6494433879852295
Epoch: 12, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.627 Vali Acc: 0.744 Test Loss: 0.627 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6543049812316895
Epoch: 13, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.672 Vali Acc: 0.733 Test Loss: 0.672 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6906092166900635
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.660 Vali Acc: 0.744 Test Loss: 0.660 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6576657295227051
Epoch: 15, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6537256240844727
Epoch: 16, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.649 Vali Acc: 0.739 Test Loss: 0.649 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7085311412811279
Epoch: 17, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.658 Vali Acc: 0.744 Test Loss: 0.658 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6877243518829346
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.663 Vali Acc: 0.756 Test Loss: 0.663 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.738243579864502
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.662 Vali Acc: 0.744 Test Loss: 0.662 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 33206
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1418333053588867
Epoch: 1, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.718 Vali Acc: 0.272 Test Loss: 1.718 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 0.656686544418335
Epoch: 2, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.505 Vali Acc: 0.433 Test Loss: 1.505 Test Acc: 0.433
Validation loss decreased (-0.272205 --> -0.433318).  Saving model ...
Epoch: 3 cost time: 0.6483173370361328
Epoch: 3, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.287 Vali Acc: 0.539 Test Loss: 1.287 Test Acc: 0.539
Validation loss decreased (-0.433318 --> -0.538876).  Saving model ...
Epoch: 4 cost time: 0.7141594886779785
Epoch: 4, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.114 Vali Acc: 0.556 Test Loss: 1.114 Test Acc: 0.556
Validation loss decreased (-0.538876 --> -0.555544).  Saving model ...
Epoch: 5 cost time: 0.6655805110931396
Epoch: 5, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.007 Vali Acc: 0.617 Test Loss: 1.007 Test Acc: 0.617
Validation loss decreased (-0.555544 --> -0.616657).  Saving model ...
Epoch: 6 cost time: 0.647904634475708
Epoch: 6, Steps: 12 | Train Loss: 0.891 Vali Loss: 0.932 Vali Acc: 0.622 Test Loss: 0.932 Test Acc: 0.622
Validation loss decreased (-0.616657 --> -0.622213).  Saving model ...
Epoch: 7 cost time: 0.6682043075561523
Epoch: 7, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.848 Vali Acc: 0.628 Test Loss: 0.848 Test Acc: 0.628
Validation loss decreased (-0.622213 --> -0.627769).  Saving model ...
Epoch: 8 cost time: 0.6301212310791016
Epoch: 8, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.795 Vali Acc: 0.661 Test Loss: 0.795 Test Acc: 0.661
Validation loss decreased (-0.627769 --> -0.661103).  Saving model ...
Epoch: 9 cost time: 0.6362478733062744
Epoch: 9, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.754 Vali Acc: 0.694 Test Loss: 0.754 Test Acc: 0.694
Validation loss decreased (-0.661103 --> -0.694437).  Saving model ...
Epoch: 10 cost time: 0.6592671871185303
Epoch: 10, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.740 Vali Acc: 0.689 Test Loss: 0.740 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6844742298126221
Epoch: 11, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.688 Vali Acc: 0.700 Test Loss: 0.688 Test Acc: 0.700
Validation loss decreased (-0.694437 --> -0.699993).  Saving model ...
Epoch: 12 cost time: 0.6371126174926758
Epoch: 12, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.669 Vali Acc: 0.711 Test Loss: 0.669 Test Acc: 0.711
Validation loss decreased (-0.699993 --> -0.711104).  Saving model ...
Epoch: 13 cost time: 0.6836793422698975
Epoch: 13, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.660 Vali Acc: 0.717 Test Loss: 0.660 Test Acc: 0.717
Validation loss decreased (-0.711104 --> -0.716660).  Saving model ...
Epoch: 14 cost time: 0.6748199462890625
Epoch: 14, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.656 Vali Acc: 0.728 Test Loss: 0.656 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727771).  Saving model ...
Epoch: 15 cost time: 0.6393585205078125
Epoch: 15, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.631 Vali Acc: 0.733 Test Loss: 0.631 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 16 cost time: 0.7461280822753906
Epoch: 16, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.654 Vali Acc: 0.744 Test Loss: 0.654 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744438).  Saving model ...
Epoch: 17 cost time: 0.6391777992248535
Epoch: 17, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.629 Vali Acc: 0.756 Test Loss: 0.629 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 18 cost time: 0.6997833251953125
Epoch: 18, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.612 Vali Acc: 0.733 Test Loss: 0.612 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6048309803009033
Epoch: 19, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.628 Vali Acc: 0.739 Test Loss: 0.628 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6751482486724854
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.638 Vali Acc: 0.750 Test Loss: 0.638 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6809020042419434
Epoch: 21, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.656 Vali Acc: 0.739 Test Loss: 0.656 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6429238319396973
Epoch: 22, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.722487211227417
Epoch: 23, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.648 Vali Acc: 0.750 Test Loss: 0.648 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6912326812744141
Epoch: 24, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.682 Vali Acc: 0.744 Test Loss: 0.682 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.67130446434021
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.658 Vali Acc: 0.744 Test Loss: 0.658 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6951894760131836
Epoch: 26, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.688 Vali Acc: 0.739 Test Loss: 0.688 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6844587326049805
Epoch: 27, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.709 Vali Acc: 0.756 Test Loss: 0.709 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 24038
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.250976324081421
Epoch: 1, Steps: 12 | Train Loss: 1.886 Vali Loss: 1.789 Vali Acc: 0.233 Test Loss: 1.789 Test Acc: 0.233
Validation loss decreased (inf --> -0.233315).  Saving model ...
Epoch: 2 cost time: 0.6921019554138184
Epoch: 2, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.569 Vali Acc: 0.400 Test Loss: 1.569 Test Acc: 0.400
Validation loss decreased (-0.233315 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 0.6722080707550049
Epoch: 3, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.346 Vali Acc: 0.528 Test Loss: 1.346 Test Acc: 0.528
Validation loss decreased (-0.399984 --> -0.527764).  Saving model ...
Epoch: 4 cost time: 0.6969509124755859
Epoch: 4, Steps: 12 | Train Loss: 1.244 Vali Loss: 1.168 Vali Acc: 0.578 Test Loss: 1.168 Test Acc: 0.578
Validation loss decreased (-0.527764 --> -0.577766).  Saving model ...
Epoch: 5 cost time: 0.6598794460296631
Epoch: 5, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.057 Vali Acc: 0.606 Test Loss: 1.057 Test Acc: 0.606
Validation loss decreased (-0.577766 --> -0.605545).  Saving model ...
Epoch: 6 cost time: 0.6770365238189697
Epoch: 6, Steps: 12 | Train Loss: 0.916 Vali Loss: 0.962 Vali Acc: 0.633 Test Loss: 0.962 Test Acc: 0.633
Validation loss decreased (-0.605545 --> -0.633324).  Saving model ...
Epoch: 7 cost time: 0.659874677658081
Epoch: 7, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.873 Vali Acc: 0.661 Test Loss: 0.873 Test Acc: 0.661
Validation loss decreased (-0.633324 --> -0.661102).  Saving model ...
Epoch: 8 cost time: 0.7235009670257568
Epoch: 8, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.813 Vali Acc: 0.661 Test Loss: 0.813 Test Acc: 0.661
Validation loss decreased (-0.661102 --> -0.661103).  Saving model ...
Epoch: 9 cost time: 0.6190314292907715
Epoch: 9, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.761 Vali Acc: 0.694 Test Loss: 0.761 Test Acc: 0.694
Validation loss decreased (-0.661103 --> -0.694437).  Saving model ...
Epoch: 10 cost time: 0.673753023147583
Epoch: 10, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.742 Vali Acc: 0.717 Test Loss: 0.742 Test Acc: 0.717
Validation loss decreased (-0.694437 --> -0.716659).  Saving model ...
Epoch: 11 cost time: 0.741797924041748
Epoch: 11, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.704 Vali Acc: 0.711 Test Loss: 0.704 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6736881732940674
Epoch: 12, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.684 Vali Acc: 0.711 Test Loss: 0.684 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6600370407104492
Epoch: 13, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.690 Vali Acc: 0.728 Test Loss: 0.690 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727771).  Saving model ...
Epoch: 14 cost time: 0.5630078315734863
Epoch: 14, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.635 Vali Acc: 0.728 Test Loss: 0.635 Test Acc: 0.728
Validation loss decreased (-0.727771 --> -0.727771).  Saving model ...
Epoch: 15 cost time: 0.6649246215820312
Epoch: 15, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.653 Vali Acc: 0.733 Test Loss: 0.653 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 16 cost time: 0.6950032711029053
Epoch: 16, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.621 Vali Acc: 0.728 Test Loss: 0.621 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.642946720123291
Epoch: 17, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.631 Vali Acc: 0.744 Test Loss: 0.631 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744438).  Saving model ...
Epoch: 18 cost time: 0.7063174247741699
Epoch: 18, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.609 Vali Acc: 0.750 Test Loss: 0.609 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 19 cost time: 0.6179533004760742
Epoch: 19, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.624 Vali Acc: 0.733 Test Loss: 0.624 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7555930614471436
Epoch: 20, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.640 Vali Acc: 0.739 Test Loss: 0.640 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.735727071762085
Epoch: 21, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.607 Vali Acc: 0.750 Test Loss: 0.607 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 22 cost time: 0.6488184928894043
Epoch: 22, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.607 Vali Acc: 0.739 Test Loss: 0.607 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6378016471862793
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.646 Vali Acc: 0.717 Test Loss: 0.646 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.676964282989502
Epoch: 24, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.629 Vali Acc: 0.728 Test Loss: 0.629 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7228503227233887
Epoch: 25, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.624 Vali Acc: 0.744 Test Loss: 0.624 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7114543914794922
Epoch: 26, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.656 Vali Acc: 0.728 Test Loss: 0.656 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.666393518447876
Epoch: 27, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.643 Vali Acc: 0.728 Test Loss: 0.643 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6582095623016357
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.652 Vali Acc: 0.728 Test Loss: 0.652 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6494240760803223
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.666 Vali Acc: 0.739 Test Loss: 0.666 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6352260112762451
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.673 Vali Acc: 0.733 Test Loss: 0.673 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6754975318908691
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.681 Vali Acc: 0.750 Test Loss: 0.681 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df128_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.75
model parameter : 21766
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3959243297576904
Epoch: 1, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.365 Vali Acc: 0.450 Test Loss: 1.365 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.8389933109283447
Epoch: 2, Steps: 12 | Train Loss: 1.128 Vali Loss: 0.947 Vali Acc: 0.600 Test Loss: 0.947 Test Acc: 0.600
Validation loss decreased (-0.449986 --> -0.599991).  Saving model ...
Epoch: 3 cost time: 0.8618335723876953
Epoch: 3, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.879 Vali Acc: 0.644 Test Loss: 0.879 Test Acc: 0.644
Validation loss decreased (-0.599991 --> -0.644436).  Saving model ...
Epoch: 4 cost time: 0.8856058120727539
Epoch: 4, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.667 Vali Acc: 0.706 Test Loss: 0.667 Test Acc: 0.706
Validation loss decreased (-0.644436 --> -0.705549).  Saving model ...
Epoch: 5 cost time: 0.9901723861694336
Epoch: 5, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.685 Vali Acc: 0.722 Test Loss: 0.685 Test Acc: 0.722
Validation loss decreased (-0.705549 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 0.890141487121582
Epoch: 6, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.699 Vali Acc: 0.739 Test Loss: 0.699 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738882).  Saving model ...
Epoch: 7 cost time: 0.86456298828125
Epoch: 7, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.611 Vali Acc: 0.739 Test Loss: 0.611 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 0.8373417854309082
Epoch: 8, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.616 Vali Acc: 0.733 Test Loss: 0.616 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8562729358673096
Epoch: 9, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8305864334106445
Epoch: 10, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.915 Vali Acc: 0.728 Test Loss: 0.915 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8449468612670898
Epoch: 11, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 0.9399137496948242
Epoch: 12, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.755 Vali Acc: 0.733 Test Loss: 0.755 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8651022911071777
Epoch: 13, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 1.09257173538208
Epoch: 14, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.860 Vali Acc: 0.772 Test Loss: 0.860 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772214).  Saving model ...
Epoch: 15 cost time: 0.7898843288421631
Epoch: 15, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.733 Vali Acc: 0.761 Test Loss: 0.733 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8845603466033936
Epoch: 16, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.983 Vali Acc: 0.761 Test Loss: 0.983 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8553345203399658
Epoch: 17, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.904 Vali Acc: 0.756 Test Loss: 0.904 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9577689170837402
Epoch: 18, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.797 Vali Acc: 0.750 Test Loss: 0.797 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.871351957321167
Epoch: 19, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6693501472473145
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.023 Vali Acc: 0.756 Test Loss: 1.023 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9786732196807861
Epoch: 21, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.012 Vali Acc: 0.756 Test Loss: 1.012 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9707951545715332
Epoch: 22, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.989 Vali Acc: 0.756 Test Loss: 0.989 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9835014343261719
Epoch: 23, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.126 Vali Acc: 0.744 Test Loss: 1.126 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.97406005859375
Epoch: 24, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.041 Vali Acc: 0.744 Test Loss: 1.041 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 120854
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.323822021484375
Epoch: 1, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.542 Vali Acc: 0.461 Test Loss: 1.542 Test Acc: 0.461
Validation loss decreased (inf --> -0.461096).  Saving model ...
Epoch: 2 cost time: 0.9450240135192871
Epoch: 2, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.113 Vali Acc: 0.572 Test Loss: 1.113 Test Acc: 0.572
Validation loss decreased (-0.461096 --> -0.572211).  Saving model ...
Epoch: 3 cost time: 0.8716347217559814
Epoch: 3, Steps: 12 | Train Loss: 0.938 Vali Loss: 0.907 Vali Acc: 0.578 Test Loss: 0.907 Test Acc: 0.578
Validation loss decreased (-0.572211 --> -0.577769).  Saving model ...
Epoch: 4 cost time: 0.8975522518157959
Epoch: 4, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.801 Vali Acc: 0.661 Test Loss: 0.801 Test Acc: 0.661
Validation loss decreased (-0.577769 --> -0.661103).  Saving model ...
Epoch: 5 cost time: 0.9086201190948486
Epoch: 5, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.726 Vali Acc: 0.683 Test Loss: 0.726 Test Acc: 0.683
Validation loss decreased (-0.661103 --> -0.683326).  Saving model ...
Epoch: 6 cost time: 0.8538038730621338
Epoch: 6, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.670 Vali Acc: 0.717 Test Loss: 0.670 Test Acc: 0.717
Validation loss decreased (-0.683326 --> -0.716660).  Saving model ...
Epoch: 7 cost time: 0.9544525146484375
Epoch: 7, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.627 Vali Acc: 0.711 Test Loss: 0.627 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.985926628112793
Epoch: 8, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.649 Vali Acc: 0.739 Test Loss: 0.649 Test Acc: 0.739
Validation loss decreased (-0.716660 --> -0.738882).  Saving model ...
Epoch: 9 cost time: 0.8456063270568848
Epoch: 9, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.671 Vali Acc: 0.733 Test Loss: 0.671 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9741370677947998
Epoch: 10, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.684 Vali Acc: 0.733 Test Loss: 0.684 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9646623134613037
Epoch: 11, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 0.9997057914733887
Epoch: 12, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.662 Vali Acc: 0.756 Test Loss: 0.662 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 13 cost time: 0.9678487777709961
Epoch: 13, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.705 Vali Acc: 0.744 Test Loss: 0.705 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9091567993164062
Epoch: 14, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.620 Vali Acc: 0.767 Test Loss: 0.620 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 15 cost time: 0.9135277271270752
Epoch: 15, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.690 Vali Acc: 0.750 Test Loss: 0.690 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9279839992523193
Epoch: 16, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.693 Vali Acc: 0.756 Test Loss: 0.693 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9027440547943115
Epoch: 17, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.720 Vali Acc: 0.750 Test Loss: 0.720 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9769496917724609
Epoch: 18, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.766 Vali Acc: 0.756 Test Loss: 0.766 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9130215644836426
Epoch: 19, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8965311050415039
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.745 Vali Acc: 0.756 Test Loss: 0.745 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9349985122680664
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.765 Vali Acc: 0.750 Test Loss: 0.765 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9666702747344971
Epoch: 22, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.774 Vali Acc: 0.756 Test Loss: 0.774 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.961829662322998
Epoch: 23, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.742 Vali Acc: 0.767 Test Loss: 0.742 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9077346324920654
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.784 Vali Acc: 0.744 Test Loss: 0.784 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 63270
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.474932909011841
Epoch: 1, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.569 Vali Acc: 0.406 Test Loss: 1.569 Test Acc: 0.406
Validation loss decreased (inf --> -0.405540).  Saving model ...
Epoch: 2 cost time: 1.002145528793335
Epoch: 2, Steps: 12 | Train Loss: 1.406 Vali Loss: 1.162 Vali Acc: 0.633 Test Loss: 1.162 Test Acc: 0.633
Validation loss decreased (-0.405540 --> -0.633322).  Saving model ...
Epoch: 3 cost time: 0.9425144195556641
Epoch: 3, Steps: 12 | Train Loss: 0.973 Vali Loss: 0.930 Vali Acc: 0.639 Test Loss: 0.930 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638880).  Saving model ...
Epoch: 4 cost time: 0.9715745449066162
Epoch: 4, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.817 Vali Acc: 0.650 Test Loss: 0.817 Test Acc: 0.650
Validation loss decreased (-0.638880 --> -0.649992).  Saving model ...
Epoch: 5 cost time: 0.9312348365783691
Epoch: 5, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.761 Vali Acc: 0.689 Test Loss: 0.761 Test Acc: 0.689
Validation loss decreased (-0.649992 --> -0.688881).  Saving model ...
Epoch: 6 cost time: 0.9882016181945801
Epoch: 6, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.734 Vali Acc: 0.689 Test Loss: 0.734 Test Acc: 0.689
Validation loss decreased (-0.688881 --> -0.688882).  Saving model ...
Epoch: 7 cost time: 0.9221789836883545
Epoch: 7, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
Validation loss decreased (-0.688882 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 0.8602645397186279
Epoch: 8, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.632 Vali Acc: 0.750 Test Loss: 0.632 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 0.950753927230835
Epoch: 9, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.674 Vali Acc: 0.722 Test Loss: 0.674 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9540181159973145
Epoch: 10, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.642 Vali Acc: 0.739 Test Loss: 0.642 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8694884777069092
Epoch: 11, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.668 Vali Acc: 0.728 Test Loss: 0.668 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9403223991394043
Epoch: 12, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.679 Vali Acc: 0.744 Test Loss: 0.679 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9458858966827393
Epoch: 13, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.635 Vali Acc: 0.756 Test Loss: 0.635 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 0.896190881729126
Epoch: 14, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.733 Vali Acc: 0.750 Test Loss: 0.733 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0158348083496094
Epoch: 15, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.705 Vali Acc: 0.761 Test Loss: 0.705 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 16 cost time: 0.8694007396697998
Epoch: 16, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.664 Vali Acc: 0.750 Test Loss: 0.664 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.915179967880249
Epoch: 17, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.706 Vali Acc: 0.761 Test Loss: 0.706 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9593546390533447
Epoch: 18, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.744 Vali Acc: 0.750 Test Loss: 0.744 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.93263840675354
Epoch: 19, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.759 Vali Acc: 0.750 Test Loss: 0.759 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9344379901885986
Epoch: 20, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.771 Vali Acc: 0.767 Test Loss: 0.771 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766659).  Saving model ...
Epoch: 21 cost time: 0.8697042465209961
Epoch: 21, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.776 Vali Acc: 0.756 Test Loss: 0.776 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8649816513061523
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.777 Vali Acc: 0.761 Test Loss: 0.777 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9050350189208984
Epoch: 23, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.794 Vali Acc: 0.767 Test Loss: 0.794 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8585152626037598
Epoch: 24, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.852 Vali Acc: 0.733 Test Loss: 0.852 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8809623718261719
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.825 Vali Acc: 0.761 Test Loss: 0.825 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9283874034881592
Epoch: 26, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.859 Vali Acc: 0.756 Test Loss: 0.859 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0914700031280518
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.872 Vali Acc: 0.767 Test Loss: 0.872 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8743913173675537
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.835 Vali Acc: 0.756 Test Loss: 0.835 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0159718990325928
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.833 Vali Acc: 0.772 Test Loss: 0.833 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772214).  Saving model ...
Epoch: 30 cost time: 1.0188698768615723
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.858 Vali Acc: 0.761 Test Loss: 0.858 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9673340320587158
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.874 Vali Acc: 0.744 Test Loss: 0.874 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9140527248382568
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.878 Vali Acc: 0.756 Test Loss: 0.878 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9459748268127441
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.896 Vali Acc: 0.756 Test Loss: 0.896 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9970369338989258
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.909 Vali Acc: 0.756 Test Loss: 0.909 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0040013790130615
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.921 Vali Acc: 0.756 Test Loss: 0.921 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.92753005027771
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.898 Vali Acc: 0.761 Test Loss: 0.898 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0990798473358154
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.911 Vali Acc: 0.767 Test Loss: 0.911 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0975868701934814
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.926 Vali Acc: 0.761 Test Loss: 0.926 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.025033950805664
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.936 Vali Acc: 0.750 Test Loss: 0.936 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 60982
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1973929405212402
Epoch: 1, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.600 Vali Acc: 0.339 Test Loss: 1.600 Test Acc: 0.339
Validation loss decreased (inf --> -0.338873).  Saving model ...
Epoch: 2 cost time: 0.8223042488098145
Epoch: 2, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.260 Vali Acc: 0.561 Test Loss: 1.260 Test Acc: 0.561
Validation loss decreased (-0.338873 --> -0.561099).  Saving model ...
Epoch: 3 cost time: 0.6886918544769287
Epoch: 3, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (-0.561099 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.686204195022583
Epoch: 4, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.873 Vali Acc: 0.656 Test Loss: 0.873 Test Acc: 0.656
Validation loss decreased (-0.599990 --> -0.655547).  Saving model ...
Epoch: 5 cost time: 0.7108044624328613
Epoch: 5, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.802 Vali Acc: 0.644 Test Loss: 0.802 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7953152656555176
Epoch: 6, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.730 Vali Acc: 0.689 Test Loss: 0.730 Test Acc: 0.689
Validation loss decreased (-0.655547 --> -0.688882).  Saving model ...
Epoch: 7 cost time: 0.696852445602417
Epoch: 7, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.694 Vali Acc: 0.706 Test Loss: 0.694 Test Acc: 0.706
Validation loss decreased (-0.688882 --> -0.705549).  Saving model ...
Epoch: 8 cost time: 0.7510724067687988
Epoch: 8, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.665 Vali Acc: 0.733 Test Loss: 0.665 Test Acc: 0.733
Validation loss decreased (-0.705549 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 0.7081151008605957
Epoch: 9, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.638 Vali Acc: 0.722 Test Loss: 0.638 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6690559387207031
Epoch: 10, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.649 Vali Acc: 0.739 Test Loss: 0.649 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738882).  Saving model ...
Epoch: 11 cost time: 0.7458364963531494
Epoch: 11, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.607 Vali Acc: 0.744 Test Loss: 0.607 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 12 cost time: 0.6909866333007812
Epoch: 12, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.629 Vali Acc: 0.750 Test Loss: 0.629 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 0.6675364971160889
Epoch: 13, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.593 Vali Acc: 0.750 Test Loss: 0.593 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 0.700153112411499
Epoch: 14, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.640 Vali Acc: 0.756 Test Loss: 0.640 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 15 cost time: 0.6785426139831543
Epoch: 15, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.624 Vali Acc: 0.761 Test Loss: 0.624 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 16 cost time: 0.8269789218902588
Epoch: 16, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.621 Vali Acc: 0.767 Test Loss: 0.621 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 17 cost time: 0.6919255256652832
Epoch: 17, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.679 Vali Acc: 0.778 Test Loss: 0.679 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 18 cost time: 0.7585828304290771
Epoch: 18, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.623 Vali Acc: 0.750 Test Loss: 0.623 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7196781635284424
Epoch: 19, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.659 Vali Acc: 0.756 Test Loss: 0.659 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6856575012207031
Epoch: 20, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.707 Vali Acc: 0.756 Test Loss: 0.707 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7424256801605225
Epoch: 21, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.666 Vali Acc: 0.767 Test Loss: 0.666 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.783275842666626
Epoch: 22, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.671 Vali Acc: 0.767 Test Loss: 0.671 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7691292762756348
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.661 Vali Acc: 0.761 Test Loss: 0.661 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7371199131011963
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.697 Vali Acc: 0.761 Test Loss: 0.697 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7764136791229248
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.698 Vali Acc: 0.761 Test Loss: 0.698 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7154214382171631
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.690 Vali Acc: 0.756 Test Loss: 0.690 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7233202457427979
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.704 Vali Acc: 0.761 Test Loss: 0.704 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 42582
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.155700922012329
Epoch: 1, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.746 Vali Acc: 0.222 Test Loss: 1.746 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 0.6794679164886475
Epoch: 2, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.425 Vali Acc: 0.433 Test Loss: 1.425 Test Acc: 0.433
Validation loss decreased (-0.222205 --> -0.433319).  Saving model ...
Epoch: 3 cost time: 0.7315657138824463
Epoch: 3, Steps: 12 | Train Loss: 1.265 Vali Loss: 1.152 Vali Acc: 0.550 Test Loss: 1.152 Test Acc: 0.550
Validation loss decreased (-0.433319 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 0.7147040367126465
Epoch: 4, Steps: 12 | Train Loss: 1.023 Vali Loss: 0.989 Vali Acc: 0.622 Test Loss: 0.989 Test Acc: 0.622
Validation loss decreased (-0.549988 --> -0.622212).  Saving model ...
Epoch: 5 cost time: 0.7021799087524414
Epoch: 5, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.898 Vali Acc: 0.639 Test Loss: 0.898 Test Acc: 0.639
Validation loss decreased (-0.622212 --> -0.638880).  Saving model ...
Epoch: 6 cost time: 0.726966142654419
Epoch: 6, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.811 Vali Acc: 0.661 Test Loss: 0.811 Test Acc: 0.661
Validation loss decreased (-0.638880 --> -0.661103).  Saving model ...
Epoch: 7 cost time: 0.7435715198516846
Epoch: 7, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.759 Vali Acc: 0.694 Test Loss: 0.759 Test Acc: 0.694
Validation loss decreased (-0.661103 --> -0.694437).  Saving model ...
Epoch: 8 cost time: 0.7079460620880127
Epoch: 8, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.715 Vali Acc: 0.700 Test Loss: 0.715 Test Acc: 0.700
Validation loss decreased (-0.694437 --> -0.699993).  Saving model ...
Epoch: 9 cost time: 0.7326993942260742
Epoch: 9, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.679 Vali Acc: 0.706 Test Loss: 0.679 Test Acc: 0.706
Validation loss decreased (-0.699993 --> -0.705549).  Saving model ...
Epoch: 10 cost time: 0.6780838966369629
Epoch: 10, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
Validation loss decreased (-0.705549 --> -0.716660).  Saving model ...
Epoch: 11 cost time: 0.6943974494934082
Epoch: 11, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.626 Vali Acc: 0.733 Test Loss: 0.626 Test Acc: 0.733
Validation loss decreased (-0.716660 --> -0.733327).  Saving model ...
Epoch: 12 cost time: 0.7200562953948975
Epoch: 12, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.630 Vali Acc: 0.717 Test Loss: 0.630 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6800956726074219
Epoch: 13, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.658 Vali Acc: 0.739 Test Loss: 0.658 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738882).  Saving model ...
Epoch: 14 cost time: 0.6614823341369629
Epoch: 14, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.640 Vali Acc: 0.722 Test Loss: 0.640 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6495444774627686
Epoch: 15, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.641 Vali Acc: 0.728 Test Loss: 0.641 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6456389427185059
Epoch: 16, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.649 Vali Acc: 0.733 Test Loss: 0.649 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7433087825775146
Epoch: 17, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.632 Vali Acc: 0.728 Test Loss: 0.632 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6953470706939697
Epoch: 18, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.655 Vali Acc: 0.728 Test Loss: 0.655 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7258422374725342
Epoch: 19, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.634 Vali Acc: 0.744 Test Loss: 0.634 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 20 cost time: 0.6238493919372559
Epoch: 20, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.679 Vali Acc: 0.739 Test Loss: 0.679 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7408483028411865
Epoch: 21, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.663 Vali Acc: 0.739 Test Loss: 0.663 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.672093391418457
Epoch: 22, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.698 Vali Acc: 0.744 Test Loss: 0.698 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7342498302459717
Epoch: 23, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.667 Vali Acc: 0.739 Test Loss: 0.667 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7149627208709717
Epoch: 24, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.690 Vali Acc: 0.739 Test Loss: 0.690 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7025966644287109
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.716 Vali Acc: 0.739 Test Loss: 0.716 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7033898830413818
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.711 Vali Acc: 0.728 Test Loss: 0.711 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6951451301574707
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.713 Vali Acc: 0.733 Test Loss: 0.713 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7217581272125244
Epoch: 28, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.697 Vali Acc: 0.744 Test Loss: 0.697 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6880688667297363
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.718 Vali Acc: 0.739 Test Loss: 0.718 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 31094
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.148409843444824
Epoch: 1, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.748 Vali Acc: 0.244 Test Loss: 1.748 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.6969485282897949
Epoch: 2, Steps: 12 | Train Loss: 1.677 Vali Loss: 1.532 Vali Acc: 0.372 Test Loss: 1.532 Test Acc: 0.372
Validation loss decreased (-0.244427 --> -0.372207).  Saving model ...
Epoch: 3 cost time: 0.6805458068847656
Epoch: 3, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.309 Vali Acc: 0.478 Test Loss: 1.309 Test Acc: 0.478
Validation loss decreased (-0.372207 --> -0.477765).  Saving model ...
Epoch: 4 cost time: 0.7759125232696533
Epoch: 4, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.131 Vali Acc: 0.556 Test Loss: 1.131 Test Acc: 0.556
Validation loss decreased (-0.477765 --> -0.555544).  Saving model ...
Epoch: 5 cost time: 0.6826579570770264
Epoch: 5, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.009 Vali Acc: 0.611 Test Loss: 1.009 Test Acc: 0.611
Validation loss decreased (-0.555544 --> -0.611101).  Saving model ...
Epoch: 6 cost time: 0.7188687324523926
Epoch: 6, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.941 Vali Acc: 0.628 Test Loss: 0.941 Test Acc: 0.628
Validation loss decreased (-0.611101 --> -0.627768).  Saving model ...
Epoch: 7 cost time: 0.7447717189788818
Epoch: 7, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.879 Vali Acc: 0.622 Test Loss: 0.879 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6946878433227539
Epoch: 8, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.827 Vali Acc: 0.661 Test Loss: 0.827 Test Acc: 0.661
Validation loss decreased (-0.627768 --> -0.661103).  Saving model ...
Epoch: 9 cost time: 0.7297935485839844
Epoch: 9, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.788 Vali Acc: 0.667 Test Loss: 0.788 Test Acc: 0.667
Validation loss decreased (-0.661103 --> -0.666659).  Saving model ...
Epoch: 10 cost time: 0.7760167121887207
Epoch: 10, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.780 Vali Acc: 0.672 Test Loss: 0.780 Test Acc: 0.672
Validation loss decreased (-0.666659 --> -0.672214).  Saving model ...
Epoch: 11 cost time: 0.6757545471191406
Epoch: 11, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.746 Vali Acc: 0.689 Test Loss: 0.746 Test Acc: 0.689
Validation loss decreased (-0.672214 --> -0.688881).  Saving model ...
Epoch: 12 cost time: 0.7469544410705566
Epoch: 12, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.724 Vali Acc: 0.667 Test Loss: 0.724 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6123034954071045
Epoch: 13, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.699 Vali Acc: 0.694 Test Loss: 0.699 Test Acc: 0.694
Validation loss decreased (-0.688881 --> -0.694437).  Saving model ...
Epoch: 14 cost time: 0.5857195854187012
Epoch: 14, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.685 Vali Acc: 0.706 Test Loss: 0.685 Test Acc: 0.706
Validation loss decreased (-0.694437 --> -0.705549).  Saving model ...
Epoch: 15 cost time: 0.6279165744781494
Epoch: 15, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.673 Vali Acc: 0.728 Test Loss: 0.673 Test Acc: 0.728
Validation loss decreased (-0.705549 --> -0.727771).  Saving model ...
Epoch: 16 cost time: 0.6760213375091553
Epoch: 16, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.654 Vali Acc: 0.728 Test Loss: 0.654 Test Acc: 0.728
Validation loss decreased (-0.727771 --> -0.727771).  Saving model ...
Epoch: 17 cost time: 0.647162914276123
Epoch: 17, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.667 Vali Acc: 0.728 Test Loss: 0.667 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6611816883087158
Epoch: 18, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.656 Vali Acc: 0.728 Test Loss: 0.656 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6931283473968506
Epoch: 19, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.683 Vali Acc: 0.706 Test Loss: 0.683 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7311697006225586
Epoch: 20, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.667 Vali Acc: 0.728 Test Loss: 0.667 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7179427146911621
Epoch: 21, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7022750377655029
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.704 Vali Acc: 0.739 Test Loss: 0.704 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738882).  Saving model ...
Epoch: 23 cost time: 0.6842961311340332
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.697 Vali Acc: 0.739 Test Loss: 0.697 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 24 cost time: 0.7941856384277344
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.683 Vali Acc: 0.728 Test Loss: 0.683 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7249906063079834
Epoch: 25, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.711 Vali Acc: 0.733 Test Loss: 0.711 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6306207180023193
Epoch: 26, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.753 Vali Acc: 0.711 Test Loss: 0.753 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6524128913879395
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.705 Vali Acc: 0.739 Test Loss: 0.705 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6865808963775635
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.715 Vali Acc: 0.722 Test Loss: 0.715 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6956102848052979
Epoch: 29, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.745 Vali Acc: 0.722 Test Loss: 0.745 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.662999153137207
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.749 Vali Acc: 0.733 Test Loss: 0.749 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7355551719665527
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.766 Vali Acc: 0.739 Test Loss: 0.766 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7459511756896973
Epoch: 32, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.766 Vali Acc: 0.733 Test Loss: 0.766 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.784564733505249
Epoch: 33, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.777 Vali Acc: 0.733 Test Loss: 0.777 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 21926
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.197120428085327
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.752 Vali Acc: 0.228 Test Loss: 1.752 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 0.6139857769012451
Epoch: 2, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.549 Vali Acc: 0.450 Test Loss: 1.549 Test Acc: 0.450
Validation loss decreased (-0.227760 --> -0.449985).  Saving model ...
Epoch: 3 cost time: 0.628671407699585
Epoch: 3, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.329 Vali Acc: 0.561 Test Loss: 1.329 Test Acc: 0.561
Validation loss decreased (-0.449985 --> -0.561098).  Saving model ...
Epoch: 4 cost time: 0.6016392707824707
Epoch: 4, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.149 Vali Acc: 0.567 Test Loss: 1.149 Test Acc: 0.567
Validation loss decreased (-0.561098 --> -0.566655).  Saving model ...
Epoch: 5 cost time: 0.6633090972900391
Epoch: 5, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.037 Vali Acc: 0.578 Test Loss: 1.037 Test Acc: 0.578
Validation loss decreased (-0.566655 --> -0.577767).  Saving model ...
Epoch: 6 cost time: 0.5952749252319336
Epoch: 6, Steps: 12 | Train Loss: 0.889 Vali Loss: 0.956 Vali Acc: 0.594 Test Loss: 0.956 Test Acc: 0.594
Validation loss decreased (-0.577767 --> -0.594435).  Saving model ...
Epoch: 7 cost time: 0.5916538238525391
Epoch: 7, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.886 Vali Acc: 0.622 Test Loss: 0.886 Test Acc: 0.622
Validation loss decreased (-0.594435 --> -0.622213).  Saving model ...
Epoch: 8 cost time: 0.6206204891204834
Epoch: 8, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.820 Vali Acc: 0.667 Test Loss: 0.820 Test Acc: 0.667
Validation loss decreased (-0.622213 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 0.6429131031036377
Epoch: 9, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.756 Vali Acc: 0.694 Test Loss: 0.756 Test Acc: 0.694
Validation loss decreased (-0.666658 --> -0.694437).  Saving model ...
Epoch: 10 cost time: 0.6308653354644775
Epoch: 10, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.732 Vali Acc: 0.711 Test Loss: 0.732 Test Acc: 0.711
Validation loss decreased (-0.694437 --> -0.711104).  Saving model ...
Epoch: 11 cost time: 0.6551103591918945
Epoch: 11, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.705 Vali Acc: 0.700 Test Loss: 0.705 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6102111339569092
Epoch: 12, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.684 Vali Acc: 0.733 Test Loss: 0.684 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733326).  Saving model ...
Epoch: 13 cost time: 0.591480016708374
Epoch: 13, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.649 Vali Acc: 0.739 Test Loss: 0.649 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 14 cost time: 0.6383814811706543
Epoch: 14, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 0.6726071834564209
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.626 Vali Acc: 0.756 Test Loss: 0.626 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755549).  Saving model ...
Epoch: 16 cost time: 0.6415860652923584
Epoch: 16, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.616 Vali Acc: 0.761 Test Loss: 0.616 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 17 cost time: 0.710648775100708
Epoch: 17, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.619 Vali Acc: 0.761 Test Loss: 0.619 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6915984153747559
Epoch: 18, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.620 Vali Acc: 0.750 Test Loss: 0.620 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6994967460632324
Epoch: 19, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.588 Vali Acc: 0.772 Test Loss: 0.588 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772216).  Saving model ...
Epoch: 20 cost time: 0.6574254035949707
Epoch: 20, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.600 Vali Acc: 0.767 Test Loss: 0.600 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6236841678619385
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.608 Vali Acc: 0.772 Test Loss: 0.608 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6164722442626953
Epoch: 22, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.619 Vali Acc: 0.761 Test Loss: 0.619 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6243205070495605
Epoch: 23, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.607 Vali Acc: 0.778 Test Loss: 0.607 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 24 cost time: 0.6753528118133545
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.607 Vali Acc: 0.778 Test Loss: 0.607 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6275520324707031
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.613 Vali Acc: 0.756 Test Loss: 0.613 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5905129909515381
Epoch: 26, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.644 Vali Acc: 0.767 Test Loss: 0.644 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6266632080078125
Epoch: 27, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.616 Vali Acc: 0.772 Test Loss: 0.616 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6125540733337402
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.630 Vali Acc: 0.767 Test Loss: 0.630 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5852913856506348
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.635 Vali Acc: 0.761 Test Loss: 0.635 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5163331031799316
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.637 Vali Acc: 0.761 Test Loss: 0.637 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6647446155548096
Epoch: 31, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.643 Vali Acc: 0.767 Test Loss: 0.643 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6854414939880371
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.646 Vali Acc: 0.778 Test Loss: 0.646 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6623194217681885
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.663 Vali Acc: 0.772 Test Loss: 0.663 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_PatchTST_UEA_ftM_sl51_ll0_pl0_el1_dm16_nh4_df64_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 19654
model size : 0.39MB
